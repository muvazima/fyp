@&#MAIN-TITLE@&#A semiparametric Bayesian approach to the analysis of financial time series with applications to value at risk estimation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop a Bayesian semiparametric approach to GARCH-type models.


                        
                        
                           
                           The innovations follow the class of scale mixtures of Gaussian distributions with a Dirichlet process prior in the mixing distribution.


                        
                        
                           
                           It is also shown how to undertake Bayesian prediction of the Value at Risk (VaR).


                        
                        
                           
                           We have obtained significant differences in the predictive distribution of the returns, especially in the tails.


                        
                        
                           
                           We have observed different results in the VaR estimation with different specifications.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Finance

Bayesian nonparametrics

Dirichlet process mixtures

GARCH models

Risk management

Value at risk

@&#ABSTRACT@&#


               
               
                  GARCH models are commonly used for describing, estimating and predicting the dynamics of financial returns. Here, we relax the usual parametric distributional assumptions of GARCH models and develop a Bayesian semiparametric approach based on modeling the innovations using the class of scale mixtures of Gaussian distributions with a Dirichlet process prior on the mixing distribution. The proposed specification allows for greater flexibility in capturing the usual patterns observed in financial returns. It is also shown how to undertake Bayesian prediction of the Value at Risk (VaR). The performance of the proposed semiparametric method is illustrated using simulated and real data from the Hang Seng Index (HSI) and Bombay Stock Exchange index (BSE30).
               
            

@&#INTRODUCTION@&#

Financial time series analysis gives practical and theoretical understanding of data collected on financial markets, such as stock and commodity prices, exchange rates or bond yields. Financial data usually consists of a time series of prices of a certain asset for a given period of time. However, most of the financial analysis consider asset returns, which measures the relative changes in prices, as they have more attractive statistical properties. Investors and financial managers need to understand the behavior of asset returns to have good expectations about future returns and the risks to which they will be exposed. Although forecasting is an essential component of any interesting activity, it is usually very difficult to obtain accurate predictions. Since the prediction methods inherently depends on the underlying distributions assumed, it appears to be more appropriate to gain insights into the assumed probability distributions to obtain better predictions for future values. Correctly specifying the distribution is also important as it provides with a measure of investment risk.

Financial market returns exhibit several interesting and complicated features such as volatility clustering and high kurtosis, which make their modeling a challenging task. Engle (1982) introduced the autoregressive conditional heteroskedasticity (ARCH) model to describe these features. Since then, many alternative specifications have been proposed including the stochastic volatility (SV) model (Taylor, 1982), the generalized autoregressive conditional heteroskedasticity (GARCH) model (Bollerslev, 1986), the exponential generalized autoregressive conditional heteroskedasticity (EGARCH) model (Nelson, 1991) and the GJR-GARCH model (Glosten, Jaganathan, & Runkle, 1993), among many others. In order to derive the probability distributions of future returns implied by GARCH-type models, it is necessary to specify the distribution of the innovations. The simplest and most routinely used assumption is that the innovations are Gaussian distributed. However, GARCH models with Gaussian innovations are inconsistent with the excess kurtosis frequently observed in both the conditional and unconditional distributions of returns. Alternative approaches are the Student-t distribution (Bollerslev, 1987), the generalized error distribution (Nelson, 1991), a mixture of two zero mean Gaussian distributions (Bai, Rusell, & Tiao, 2003 and Ausín & Galeano, 2007) or the Pearson’s type IV distribution (Bhattacharyya, Chaudhary, & Yadav, 2008).

In this paper, we consider a semiparametric Bayesian approach to the analysis of financial time series. The usual parametric distributional assumptions on the innovations of GARCH models are relaxed by using the class of Gaussian scale mixtures which is a broad class that includes, among others, the Gaussian, Student-t, logistic, double exponential, Cauchy and generalized hyperbolic distributions. Then, we further assume that the scale mixing distribution follows a Dirichlet process (DP) prior (Ferguson, 1973), which results in a DP mixture (DPM) model (Antoniak, 1974). DPM models are included in the area referred to as “Bayesian nonparametrics”, which actually deal with infinite-dimensional sets of parameters, see e.g. Gershman and Blei (2012) for a recent overview. Models of this type allow for greater flexibility in capturing the usual patterns usually observed in financial returns.

Although new to the GARCH framework, DPM models have an extensive literature in Bayesian analysis and provide a broad and flexible class of distributions in many different settings, see, for instance, Ishwaran and Zarepour (2002); Basu and Chib (2003); Damien, Galenko, Popova, and Hanson (2007) and Ghosh, Basu, and Tiwari (2009) and the references therein. In the context of stochastic volatility models, semiparametric Bayesian approaches have been developed recently by Jensen and Maheu (2010) and Delatola and Griffin (2011). These papers have shown, for instance, that estimates of volatility using the semiparametric Bayesian approach can differ dramatically from those using a Gaussian return distribution if there is evidence of a heavy-tailed return distribution.

Extreme price movements in financial markets are unusual, but important. Recently, the large daily price movements have pointed out the need of reliable investment risk measures. Value at Risk (VaR) has become the most widely used measure of market risk, see Jorion (2006). VaR indicates the potential loss associated with an unfavorable movement in market prices over a given time period at a certain confidence level. Statistically speaking, VaR is a quantile of the conditional distribution of the returns. Thus, its calculation strongly depends on the assumptions made for the innovation distribution. Indeed, one of the main criticisms to the use of VaR as a risk measure is the inaccuracy of the VaR estimates produced by standard models, due to the inappropriate specification of the return distribution, see e.g. Kiesel and Kleinow (2002). As the semiparametric approach that we propose is based on a flexible specification of the innovation distribution, it is expected that more accurate VaR estimates can be obtained. In order to illustrate this, we will show how to obtain predictive distributions of future returns which give us the VaR estimates.

The rest of this paper is organized as follows. Section 2 introduces the proposed class of models which shall be referred to as DPM-GARCH models. Section 3 shows how to implement Bayesian inference for these models by developing a Markov Chain Monte Carlo (MCMC) algorithm to sample from the joint posterior distribution. The proposed algorithm combines the ideas of the retrospective sampling proposed in Papaspiliopoulos and Roberts (2008) and the slice sampling approach of Walker (2007). Then, Section 4 explains how to estimate the predictive distribution of the returns and addresses the problem of VaR estimation. Section 5 presents a brief Monte Carlo experiment which illustrates the accuracy in parameter estimation, prediction of returns and VaR estimation. Section 6 analyzes real data from the Hang Seng Index (HSI) and Bombay Stock Exchange index (BSE30), finally, Section 7 concludes.

The usual structure of GARCH-type models assumes that a return series, denoted by r
                     
                        t
                     , can be written as follows:
                        
                           (1)
                           
                              
                                 
                                    r
                                 
                                 
                                    t
                                 
                              
                              =
                              μ
                              +
                              
                                 
                                    h
                                 
                                 
                                    t
                                 
                                 
                                    1
                                    /
                                    2
                                 
                              
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                              
                              ,
                           
                        
                     where μ is the unconditional mean of r
                     
                        t
                     , which is constant over time, h
                     
                        t
                      is the conditional variance of r
                     
                        t
                      given the past history, 
                        
                           
                              
                                 F
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           =
                           {
                           
                              
                                 r
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 r
                              
                              
                                 t
                                 -
                                 2
                              
                           
                           ,
                           …
                           }
                        
                     , commonly called the conditional volatility, and ∊
                     
                        t
                      is a sequence of independent and identically distributed random variables with zero mean and unit variance.

GARCH-type models describe the conditional volatility h
                     
                        t
                      as an exact function of the past. For instance, the GJR-GARCH (p,
                     q) model proposed by Glosten et al. (1993) assumes that 
                        
                           
                              
                                 h
                              
                              
                                 t
                              
                           
                           =
                           ω
                           +
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           
                              
                                 I
                              
                              
                                 t
                                 -
                                 i
                              
                           
                           )
                           
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       t
                                       -
                                       i
                                    
                                 
                                 -
                                 μ
                                 )
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 q
                              
                           
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           
                              
                                 h
                              
                              
                                 t
                                 -
                                 j
                              
                           
                        
                     , where I
                     
                        t−i
                      is equal to 1 if r
                     
                        t−i
                     
                     <
                     μ, and 0 otherwise. Here ω
                     >0, α
                     
                        i
                     
                     ⩾0 and α
                     
                        i
                     
                     +
                     ϕ
                     
                        i
                     
                     ⩾0 for i
                     =1,…,
                     p, and β
                     
                        j
                     
                     ⩾0, for j
                     =1,…,
                     q, to ensure nonnegativity of h
                     
                        t
                      and 
                        
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           /
                           2
                           )
                           +
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 q
                              
                           
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           <
                           1
                        
                      to ensure covariance stationarity of r
                     
                        t
                     . If ϕ
                     1
                     =⋯=
                     ϕ
                     
                        p
                     
                     =0, the GJR-GARCH model reduces to the GARCH model. Moreover, if β
                     1
                     =⋯=
                     β
                     
                        q
                     
                     =0, the GARCH model reduces to the ARCH model.

As mentioned previously, typical models for the innovation distribution include the Gaussian, Student-t, Gaussian mixture, generalized error or the Pearson’s type IV distributions, among others. The aim of this paper is to construct a robust alternative to these usual distributional assumptions. Therefore, we assume that ∊
                     
                        t
                      follows an unknown distribution with zero mean and unit variance. However, in general, the unit variance restriction will make it difficult to undertake semiparametric Bayesian inference. Thus, in order to avoid it, we propose rescaling the model defined in Eq. (1) as follows,
                        
                           (2)
                           
                              
                                 
                                    r
                                 
                                 
                                    t
                                 
                              
                              =
                              μ
                              +
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    1
                                    /
                                    2
                                 
                              
                              
                                 
                                    ξ
                                 
                                 
                                    t
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 h
                              
                              
                                 t
                              
                           
                           /
                           ω
                        
                      is a rescaled volatility. For instance, in the particular case of the GJR-GARCH model, 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      is given by,
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              1
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       p
                                    
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    I
                                 
                                 
                                    t
                                    -
                                    i
                                 
                              
                              )
                              
                                 
                                    (
                                    
                                       
                                          r
                                       
                                       
                                          t
                                          -
                                          i
                                       
                                    
                                    -
                                    μ
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       q
                                    
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                    -
                                    j
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           /
                           ω
                           ,
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           /
                           ω
                        
                      and ξ
                     
                        t
                     
                     =
                     ω
                     1/2
                     ∊
                     
                        t
                      is a sequence of independent and identically distributed random variables with zero mean and variance ω.

Now, in order to impose a flexible zero mean distribution on the rescaled innovations, ξ
                     
                        t
                     , we propose using the broad class of Gaussian scale mixtures, with density function (with respect to Lebesgue measure) given by,
                        
                           (4)
                           
                              
                                 
                                    f
                                 
                                 
                                    ξ
                                 
                              
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    t
                                 
                              
                              |
                              G
                              )
                              =
                              ∫
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       0
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                          
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              dG
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             t
                                          
                                          
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           ϕ
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          t
                                       
                                    
                                    |
                                    0
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          t
                                       
                                       
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                        
                      denotes the density function of the Gaussian distribution with zero mean and variance 
                        
                           
                              
                                 λ
                              
                              
                                 t
                              
                              
                                 -
                                 1
                              
                           
                        
                     , and G is the scale mixing distribution. The key feature of the proposed semiparametric approach is that we assume that the scale mixing distribution, G, is unknown and modeled by a DP, resulting in a DPM model, which can be written hierarchically as follows,
                        
                           (5)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                t
                                             
                                          
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                          
                                          ∼
                                          N
                                          
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                t
                                             
                                          
                                          |
                                          G
                                          ∼
                                          G
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          G
                                          |
                                          ν
                                          ,
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                          ∼
                                          DP
                                          (
                                          ν
                                          ,
                                          
                                             
                                                G
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ν
                                          ∼
                                          π
                                          (
                                          ν
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where ν is a concentration parameter, with prior density π, and G
                     0 is the baseline probability measure of the Dirichlet process. Also, the DP provides a conjugate family of priors over distributions such that, given a set of independent draws from G, the posterior distribution is given by,
                        
                           
                              G
                              |
                              
                                 
                                    {
                                    
                                       
                                          λ
                                       
                                       
                                          t
                                       
                                    
                                    }
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                 
                              
                              ∼
                              DP
                              
                                 
                                    
                                       ν
                                       +
                                       T
                                       ,
                                       
                                          
                                             ν
                                          
                                          
                                             ν
                                             +
                                             T
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             T
                                          
                                          
                                             ν
                                             +
                                             T
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 G
                              
                              
                                 ^
                              
                           
                        
                      is the empirical distribution for the sample 
                        
                           
                              
                                 {
                                 
                                    
                                       λ
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                        
                     . In what follows, the GARCH-type models previously given, assuming that ξ
                     
                        t
                      follows the density function in Eq. (4) and the scale mixing distribution G is modeled by a DP prior as defined above, will be called Dirichlet Process Mixture GARCH-type models, i.e. DPM-ARCH, DPM-GARCH and DPM-GJR-GARCH models, respectively.

It can be shown that, with probability one, G is a discrete distribution with infinite support. Therefore, the scale mixture in Eq. (4) can be interpreted as an infinite Gaussian mixture, which is the alternative representation of the model in Eq. (5) based on the stick-breaking construction of Sethuraman (1994),
                        
                           (6)
                           
                              f
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    t
                                 
                              
                              |
                              ρ
                              ,
                              λ
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    s
                                 
                              
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       0
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             s
                                          
                                          
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        ρ
                     
                     =(ρ
                     1,
                     ρ
                     2,…), 
                        λ
                     
                     =(λ
                     1,
                     λ
                     2,…), and the weights are reparameterized as,
                        
                           
                              
                                 
                                    ρ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    ρ
                                 
                                 
                                    s
                                 
                              
                              =
                              (
                              1
                              -
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              )
                              ⋯
                              (
                              1
                              -
                              
                                 
                                    η
                                 
                                 
                                    s
                                    -
                                    1
                                 
                              
                              )
                              
                                 
                                    η
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                              for
                              
                              s
                              =
                              2
                              ,
                              3
                              ,
                              …
                           
                        
                     the η
                     
                        s
                      are independent and identically distributed from a Beta distribution, Be(1,
                     ν), and the λ
                     
                        s
                      are independent and identically distributed as G
                     0, for s
                     =1,2,… In particular, we assume a conjugate model where G
                     0 is a Gamma distribution, 
                        
                           Gamma
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     , and further assume a Gamma hyperprior distribution on the concentration parameter, ν
                     ∼
                     Gamma(a
                     0,
                     b
                     0).

Observe that, given the infinite mixture in Eq. (6), ωis the variance of ξ
                     
                        t
                     ,
                        
                           (7)
                           
                              ω
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    s
                                 
                                 
                                    -
                                    1
                                 
                              
                              .
                           
                        
                     Also note that the innovations and the returns inherit infinite mixture distributions given respectively by,
                        
                           
                              f
                              (
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                              
                              |
                              ρ
                              ,
                              λ
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    s
                                 
                              
                              ϕ
                              (
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                              
                              |
                              0
                              ,
                              
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          s
                                       
                                    
                                    ω
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              )
                           
                        
                     and
                        
                           
                              f
                              (
                              
                                 
                                    r
                                 
                                 
                                    t
                                 
                              
                              |
                              μ
                              ,
                              ρ
                              ,
                              λ
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    s
                                 
                              
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       μ
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

Finally, in order to complete the Bayesian formulation of the model, we also need to define prior distributions for the parameters in the volatility equations of the DPM-GARCH-type models. In particular, uniform prior distributions restricted to the corresponding stationary region are assumed for these parameters, i.e., a uniform prior on 
                        
                           ω
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 p
                              
                           
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           <
                           1
                        
                      for the DPM-ARCH model, a uniform prior on 
                        
                           ω
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 p
                              
                           
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 q
                              
                           
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           <
                           1
                        
                      for the DPM-GARCH model and a uniform prior on 
                        
                           ω
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 i
                              
                           
                           /
                           2
                           )
                           +
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 q
                              
                           
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           <
                           1
                        
                      for the DPM-GJR-GARCH model.

This section describes how to perform Bayesian inference for DPM-GARCH-type models. Given an observed time series, r
                     ={r
                     1,…,
                     r
                     
                        T
                     } and the priors defined in the previous section, the joint posterior distribution of the model parameters does not have a closed analytical expression. However, we may undertake Bayesian inference using MCMC methods (see e.g. Robert & Casella, 2004) which produce samples from a Markov chain whose stationary distribution is the joint posterior distribution of the model parameters.

Firstly, in order to facilitate the posterior sampling, we introduce two sets of latent variables which allow for a simplification of the likelihood. These ideas are based on those proposed in Walker (2007); Papaspiliopoulos and Roberts (2008) and Papaspiliopoulos (2008). For simplicity, we present the algorithm for the particular case of the DPM-GJR-GARCHmodel. Inference on the DPM-ARCH and DPM-GARCH models is obtained by discarding the unnecessary parameters.

Let 
                        
                           θ
                           =
                           (
                           ν
                           ,
                           η
                           ,
                           λ
                           ,
                           μ
                           ,
                           
                              
                                 α
                              
                              
                                 ̃
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 ̃
                              
                           
                           ,
                           β
                           )
                        
                     , where 
                        η
                     
                     =(η
                     1,
                     η
                     2,…),
                     
                        λ
                     
                     =(λ
                     1,
                     λ
                     2,…), 
                        
                           
                              
                                 α
                              
                              
                                 ̃
                              
                           
                           =
                           (
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 p
                              
                           
                           )
                        
                     , 
                        
                           
                              
                                 ϕ
                              
                              
                                 ̃
                              
                           
                           =
                           (
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 p
                              
                           
                           )
                        
                      and 
                        β
                     
                     =(β
                     1,…,
                     β
                     
                        q
                     ) be the model parameters. Due to the infinity of the set of model parameters, it would seem that an infinite number of values need to be sampled at each step of the MCMC algorithm. However, this can be avoided by following the ideas proposed in Walker (2007), which are based on slice sampling schemes (Damien, Wakefield, & Walker, 1999). To this end, we introduce a latent variable u
                     
                        t
                     , that follows a uniform distribution in the interval (0,1), such that,
                        
                           (8)
                           
                              f
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              |
                              ρ
                              ,
                              λ
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       ∞
                                    
                                 
                              
                              I
                              (
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              <
                              
                                 
                                    ρ
                                 
                                 
                                    s
                                 
                              
                              )
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       0
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             s
                                          
                                          
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where I(·) is an indicator function. Observe that integrating the density in Eq. (8) over u
                     
                        t
                      leads to the marginal density in Eq. (6). Also, note that, given u
                     
                        t
                     , the number of mixture components is finite. Moreover,
                        
                           
                              f
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              ,
                              ρ
                              ,
                              λ
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             ρ
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                 
                              
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       0
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             s
                                          
                                          
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where A
                     
                        ρ
                     (u
                     
                        t
                     )={s:ρ
                     
                        s
                     
                     >
                     u
                     
                        t
                     } which is a finite set of size 
                        
                           
                              
                                 N
                              
                              
                                 
                                    
                                       u
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        
                     .

Now, as it is usually done in mixture models, we introduce a further indicator latent variable, z
                     
                        t
                     , which identifies the component of the mixture from which ξ
                     
                        t
                      is to be taken, i.e.,
                        
                           
                              
                                 
                                    ξ
                                 
                                 
                                    t
                                 
                              
                              |
                              (
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              =
                              s
                              ,
                              λ
                              )
                              ∼
                              N
                              
                                 
                                    
                                       0
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             s
                                          
                                          
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              Pr
                              (
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              =
                              s
                              |
                              ρ
                              )
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                              for
                              
                              s
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                           
                        
                     such that the joint distribution of ξ
                     
                        t
                     , u
                     
                        t
                      and z
                     
                        t
                      is given by,
                        
                           (9)
                           
                              f
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              |
                              ρ
                              ,
                              λ
                              )
                              =
                              I
                              (
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              <
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              )
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       0
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             -
                                             1
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     With the two sets of missing data, 
                        u
                     
                     =(u
                     1,…,
                     u
                     
                        T
                     ) and 
                        z
                     
                     =(z
                     1,…,
                     z
                     
                        T
                     ), the complete likelihood function for 
                        ξ
                     
                     =(ξ
                     1,…,
                     ξ
                     
                        T
                     ) is simply the product of the T terms given in Eq. (9) and consequently, the complete likelihood function for the observed returns, 
                        r
                     
                     =(r
                     1,…,
                     r
                     
                        T
                     ), is given by,
                        
                           
                              f
                              (
                              r
                              ,
                              u
                              ,
                              z
                              |
                              η
                              ,
                              λ
                              ,
                              μ
                              ,
                              
                                 
                                    α
                                 
                                 
                                    ̃
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    ̃
                                 
                              
                              ,
                              β
                              )
                              ∝
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              I
                              (
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              <
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              )
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       μ
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Given this complete likelihood and the priors, we define the following MCMC algorithm to sample from the joint posterior of {
                        θ
                     ,
                     
                        u
                     ,
                     
                        z
                     }. The algorithm is carried out by sampling repeatedly from the distribution of each parameter conditional on the remaining parameters. The details of each step are described in the Appendix.
                        
                           1.
                           
                              Set initial values for 
                              
                                 
                                    ν
                                    ,
                                    μ
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          ̃
                                       
                                    
                                    ,
                                    
                                       
                                          ϕ
                                       
                                       
                                          ̃
                                       
                                    
                                    ,
                                    β
                                    ,
                                    z
                                 
                              .
                                 
                                    
                                       Iterate through the following steps:
                                    


                              Sample from 
                              ν∣
                                 z
                              .


                              Sample from (
                                 η
                              ,
                                 u
                              )∣
                                 z
                              .


                              Sample from 
                              
                                 λ
                              ∣
                                 z
                              ,
                                 ξ
                              .


                              Sample from 
                              
                                 z
                              ∣
                                 η
                              ,
                                 λ
                              ,
                                 u
                              ,
                                 ξ
                              ,.


                              Sample from 
                              
                                 
                                    μ
                                    |
                                    r
                                    ,
                                    λ
                                    ,
                                    z
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          ̃
                                       
                                    
                                    ,
                                    
                                       
                                          ϕ
                                       
                                       
                                          ̃
                                       
                                    
                                    ,
                                    β
                                 
                              .


                              Sample from 
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ̃
                                       
                                    
                                    |
                                    r
                                    ,
                                    λ
                                    ,
                                    z
                                    ,
                                    μ
                                    ,
                                    
                                       
                                          ϕ
                                       
                                       
                                          ̃
                                       
                                    
                                    ,
                                    β
                                 
                              .


                              Sample from 
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ̃
                                       
                                    
                                    |
                                    r
                                    ,
                                    λ
                                    ,
                                    z
                                    ,
                                    μ
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          ̃
                                       
                                    
                                    ,
                                    ϕ
                                 
                              .


                              Sample from 
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ̃
                                       
                                    
                                    |
                                    r
                                    ,
                                    λ
                                    ,
                                    z
                                    ,
                                    μ
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          ̃
                                       
                                    
                                    ,
                                    β
                                 
                              .

The measurement and management of risks have become one of the most challenging tasks in financial modeling because of the existence of extreme price movements in financial markets. However, it is very difficult to obtain accurate return predictions making not possible to predict the existence of large movements. Alternatively, several kinds of financial risk measures have been proposed including the VaR, expected shortfall and the spectral measures of risk, see Embrechts, Mikosch, and Kluppelberg (1997). As VaR has been adopted by private banks for analyzing capital adequacy, VaR has become the most widely used measure of market risk. Broadly speaking, VaR indicates the potential loss of an asset over a certain time horizon at a certain risk level associated with an unfavorable movement in market prices. From the statistical point of view, given a certain probability level π, the t-period VaR at risk level π of a return series is defined as the value such that the probability that the losses at time t exceed this value is π. In other words, the t-period VaR at risk level π of a return series is given by the π-quantile of the conditional distribution of the return at time t,
                        
                           (10)
                           
                              π
                              =
                              Pr
                              (
                              
                                 
                                    r
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    VaR
                                 
                                 
                                    π
                                    ,
                                    t
                                 
                              
                              |
                              
                                 
                                    F
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              )
                              .
                           
                        
                     Therefore, given the observed series, 
                        r
                     , the one-step-ahead VaR at level π, denoted by VaR
                        π,T+1, can be estimated using the π-quantile of the one-step-ahead predictive return distribution f(r
                     
                        T+1∣
                        r
                     ). Observe that calculation of the VaR in Eq. (10) strongly depends on the assumption made for the innovation distribution. Thus a misspecified distribution can give a wrong estimate of VaR. Our semiparametric approach, viz., DPM-GARCH-type model, however, is robust to misspecified distributions and thus appropriate for robust VaR estimation. Given the draws from an MCMC sample,
                        
                           
                              {
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              }
                              =
                              {
                              
                                 
                                    ν
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    η
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              }
                              ,
                           
                        
                     for k
                     =1,…,
                     K, where K is the MCMC sample size, we can approximate the predictive density of the one-step-ahead return using,
                        
                           (11)
                           
                              f
                              (
                              
                                 
                                    r
                                 
                                 
                                    T
                                    +
                                    1
                                 
                              
                              |
                              r
                              )
                              ≈
                              
                                 
                                    1
                                 
                                 
                                    K
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              f
                              (
                              
                                 
                                    r
                                 
                                 
                                    T
                                    +
                                    1
                                 
                              
                              |
                              r
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              )
                              ,
                           
                        
                     where
                        
                           
                              f
                              (
                              
                                 
                                    r
                                 
                                 
                                    T
                                    +
                                    1
                                 
                              
                              |
                              r
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          ν
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          ν
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    +
                                    T
                                 
                              
                              τ
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             T
                                             +
                                             1
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             a
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             T
                                             +
                                             1
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ,
                                       a
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             z
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          s
                                       
                                    
                                 
                                 
                                    
                                       
                                          ν
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    +
                                    T
                                 
                              
                              ϕ
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             T
                                             +
                                             1
                                          
                                       
                                       |
                                       
                                          
                                             μ
                                          
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   T
                                                   +
                                                   1
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   s
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     where τ(·∣m,
                     v,
                     a) denotes the density function of a Student-t distribution with mean m and variance av/(a
                     −2). One-step-ahead VaR can be estimated using the corresponding quantiles of this predictive density.

In this section, the proposed methodology is illustrated using an artificial time series of size T
                     =3000, simulated from a GJR-GARCH (1,1) model with,
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          0.01
                                          +
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∊
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          0.01
                                          +
                                          (
                                          0.1
                                          +
                                          0.05
                                          
                                             
                                                I
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                                -
                                                0.01
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          0.8
                                          
                                             
                                                h
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where the standardized innovation process follows the mixture distribution,
                        
                           (12)
                           
                              
                                 
                                    ∊
                                 
                                 
                                    t
                                 
                              
                              ∼
                              0.9
                              N
                              (
                              0
                              ,
                              0.6
                              )
                              +
                              0.1
                              N
                              (
                              0
                              ,
                              4.6
                              )
                              ,
                           
                        
                     which implies E[∊
                     
                        t
                     ]=0 and V[∊
                     
                        t
                     ]=1. Observe that this specification leads to a long tailed distribution as is usually observed in financial returns. The set of hyperparameters has been set to a
                     0
                     =2, b
                     0
                     =8, a
                     =3 and b
                     =0.01 which leads to a rather non-informative prior. Robustness with respect to this choice is discussed later on.

In order to perform model choice, we first make use of the log marginal likelihood which is given by,
                        
                           
                              LML
                              =
                              log
                              f
                              (
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              log
                              f
                              (
                              
                                 
                                    r
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    r
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              )
                              ,
                           
                        
                     where the predictive density f(r
                     
                        t
                     ∣r
                     1,…,
                     r
                     
                        t−1) can be approximated using Eq. (11). Note that the LML that we are using is just a transformation of the average log predictive score used for example in Delatola and Griffin (2011). Larger values of LML imply a better fit.

Also, we consider the Deviance Information criteria (DIC) introduced by Spiegelhalter, Best, Carlin, and van der Linde (2002). As we are dealing with missing data models, we compute the DIC3 criterion proposed by Celeux, Forbes, Robert, and Titterington (2006), which has been shown to perform adequately in this context and is given by,
                        
                           
                              DIC
                              =
                              -
                              4
                              
                                 
                                    E
                                 
                                 
                                    θ
                                 
                              
                              [
                              log
                              f
                              (
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              |
                              θ
                              )
                              |
                              r
                              ]
                              +
                              2
                              log
                              f
                              (
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              )
                              ,
                           
                        
                     where the first term can be approximated by computing the sample mean of the loglikelihood evaluated at the parameter values obtained for each MCMC iteration and the second term can be approximated as before using the estimated predictive density given in Eq. (11). Smaller values of DIC imply a better fit.

The proposed MCMC algorithm described in Section 3 is then run for a GJR-GARCH (1,1) model using 20,000 iterations and discarding the initial 10,000 iterations as burn-in iterations. Convergence has been checked using Geweke convergence diagnostic, see Geweke (1992). Table 1
                      shows the posterior means and standard deviations of the model parameters and the estimated LML and DIC for the proposed semiparametric approach. Observe that the posterior sample of α and ϕ have been obtained by evaluating 
                        
                           
                              
                                 α
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           =
                           
                              
                                 ω
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 (
                                 k
                                 )
                              
                           
                        
                      and 
                        
                           
                              
                                 ϕ
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           =
                           
                              
                                 ω
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 (
                                 k
                                 )
                              
                           
                        
                     , for k
                     =1,…,
                     K, where ω
                     (k) is obtained using Eq. (18) for each MCMC iteration. The results are compared with a Gaussian distribution, a Student-t distribution and a mixture of two zero mean Gaussian distributions, which is the true innovation distribution. Observe that the parameter estimation results are apparently very similar for the four specifications and close to the theoretical values. Both the LML and DIC for the four models indicate that the proposed DPM-GARCH model is as good as the true generating model. The remarkable point is that the proposed semiparametric approach does not specify the true generating model to get as good results as the true generating model.


                     Fig. 1
                      (top) and (bottom) illustrates the predictive and log predictive densities of the one-step-ahead returns, given in Eq. (11), obtained for the four models. These are compared with the true one-step-ahead predictive and log predictive densities which can be calculated explicitly given the model parameters. Note that the true, DPM and finite mixture predictive and log predictive densities are almost identical in all the interval, while the Gaussian does not fit well the tails and the Student-t has problems to describe the center of the true predictive density.


                     Table 2
                      shows the one-step-ahead, VaR
                        T+1,π
                     , for the four specifications and three different levels of π. These are obtained as the π-quantiles of the predictive densities shown in the top of Fig. 1. The estimated values for VaR
                        T+1,π
                      are compared with their true values which are known given the data and model parameters. Observe that in all cases, the DPM specification provides the better approximation of the one-step-ahead VaR, even better than the true generating model. Obviously, the differences increase as π decreases.

Finally, we carried out a sensitivity analysis to the choice of prior parameters. Table 3
                      shows the parameter estimation obtained for six different prior specifications. “Prior 1” repeats the results obtained with the first prior choice to facilitate the comparison. “Priors 2 and 3” assume different gamma priors for the concentration parameter, ν, with means E[ν]=0.005 and E[ν]=1, respectively. Observe that they lead to a smaller and larger posterior mean of ν, respectively, but note that the estimation results for the mean and volatility parameters are very close to the results obtained before. “Priors 4, 5 and 6” analyze sensitivity to the prior choice for the mixture component precisions, λ
                     
                        s
                     . Observe that this choice clearly affects the prior information about the volatility parameter, ω, which is the variance mixture, see Eq. (7). Therefore, note that the parameter estimates are not affected when we assume noninformative gamma priors for λ
                     
                        s
                      with the mass distributed along the positive real line, as for “Priors 4 and 5”. However, this is not the case if the gamma prior concentrates the mass around a large number as in the case of “Prior 6” which is a very informative prior that is not reasonable in practice. Finally, note also that the parameter a of this gamma prior should be always chosen to be larger than 2 so that the value of ω in Eq. (18) is finite.

In this section, we illustrate the proposed semiparametric approach by analyzing two important stock market indexes in Asia: the Hang Seng Index (HSI) and the Bombay Stock Exchange Index (BSE30).

The HSI index is a free float-adjusted market capitalization-weighted stock market index composed of 45 companies of the Hong Kong Stock Exchange. Fig. 2
                         shows the time plot of the log-returns (in percentages) of the daily closing prices adjusted for dividends and splits of the index, for the period from January 2000 until December 2011, leading to 2992 log-returns. Observe that the log-returns appear to vary more in the last part of the series, which is the period corresponding to the recent financial crisis. Also, observe the large peaks in the HSI log-returns corresponding to October 27 and 28, 2008, where this index first decreased and after increased around a 13.5%, primarily due to the fear of a world recession. Finally, the sample mean, standard deviation, skewness and excess kurtosis of the log-returns are 0.002, 1.658, −0.059 and 10.337, respectively. Observe that the time series is almost symmetric and the kurtosis is rather larger than 3, indicating that the distributions have higher peaks and heavier tails than a normal distribution with the same variance.

In order to develop semiparametric Bayesian inference for the HSI log-return series, the MCMC algorithm described in Section 3 is run for a GJR-GARCH (1,1) model using 20,000 iterations and discarding the first 10,000 as burn-in iterations. We focus on a GJR-GARCH model in order to capture asymmetric effects on the conditional volatility of the HSI log-returns. As in the simulated time series, the Geweke z-scores were used to assess convergence. Table 4
                         shows the posterior means and standard deviations for the main model parameters using the proposed semiparametric approach and compares these estimates with those obtained using a Gaussian distribution, a Student-t distribution and a mixture of two zero mean Gaussian distributions for the innovation distribution. Observe that the parameter estimates of the four models are very close, as in the simulated example. However, it can be seen that the proposed DPM model outperforms the alternative models according to both the LML and DIC criteria. Fig. 3
                         (top) and (bottom) illustrates the predictive and log predictive densities, respectively, of the one-step-ahead return, r
                        
                           T+1, obtained using Eq. (11), for the four specifications. Observe that the DPM predictive density is very close to the finite mixture predictive density in the mode of the density, and the DPM predictive density is very close to the Student-t predictive density in the tails. However, the Student-t has a similar behavior than the Gaussian distribution in the center, while the finite mixture seems to have problems to match the long tails of the return predictive distribution. Note that this behavior is somehow similar to the results in the simulated example suggesting that, even if the true predictive distribution is unknown, the DPM specification appears to provide with a good estimation in both the center and the tails of the predictive density.


                        Fig. 4
                         shows the VaR estimates for the log-return corresponding to January, 3, 2012, with the four analyzed specifications and for values of π ranging from 0 to 0.05. Unfortunately, in this case the true value of the one-step-ahead VaR is unknown, so it is not possible to know which specification provides the better approximation. However, observe that for values close to 0.05, all the specifications lead to similar VaR estimations while for small values of π, the Student-t and the DPM specifications predict smaller VaR values than the other models. This is in agreement with the predictive densities observed in Fig. 3. Finally, we compare these VaR estimations with those obtained using the stochastic volatility model proposed in Delatola and Griffin (2011), which also considers a DPM model for a transformation of the innovation distribution. Although this is a completely different specification, we can observe that the VaR estimations are rather close to those obtained using the Student-t and DPM GARCH models.

The BSE30 index is a value-weighted index composed of the 30 largest stocks, representative of various sectors, of the Bombay Stock Exchange. Fig. 5
                         shows the time plot of the log-returns (in percentages) of the daily closing prices adjusted for dividends and splits of the index, for the period from January 2000 until December 2011, leading to 2970 log-returns. Note how the log-returns behavior is similar to the one of HSI log-returns. Also, observe the large peaks in the BSE30 log-returns corresponding to May 18, 2009, where the index increased around a 16%, primarily due to the victory of the United Progressive Alliance (UPA) in the Indian general elections. Finally, the sample mean, standard deviation, skewness and excess kurtosis of the log-returns are 0.035, 1.703, −0.177 and 5.977, respectively. Again, the time series is almost symmetric and the kurtosis is rather larger than 3, indicating that the distributions have higher peaks and heavier tails than a normal distribution with the same variance.


                        Table 5
                         shows the parameter estimation results for the BSE30 log-returns using the proposed methodology and, as in the previous example, we compare the results with those obtained using a Gaussian, a Student-t and a mixture of two zero mean Gaussian distributions for the innovations. Observe that again in this case the parameter estimates of the four models are rather close but both the LML and DIC criteria select the proposed DPM model. Fig. 6
                         (top) and (bottom) illustrates the predictive and log predictive densities, respectively, of the one-step-ahead return, r
                        
                           T+1, obtained using Eq. (11), for the four specifications. Observe that in this case the DPM predictive density is rather close to both the finite mixture and Student-t predictive densities in the mode and the tails of the distribution, although the tails under a Student-t are slightly shorter. As before, the Gaussian specification seems to have problems to capture the long-tailed behavior.


                        Fig. 7
                         shows the VaR estimates for the log-return of the BSE30 index corresponding to January, 3, 2012, with the four analyzed specifications and for values of π ranging from 0 to 0.05. Observe that, as in the previous case, all the specifications lead to similar VaR estimations when π is close to 0.05. However, in this case, the finite mixture and DPM specification predicts larger VaR values than the other ones for very small values of π. Therefore, it seems that this effect is due to the flexibility of the DPM specification in capturing the shape of the one-step ahead predictive return distribution. We have also compared these VaR estimations with those obtained with the stochastic volatility model of Delatola and Griffin (2011). Again, the VaR estimations are close to those obtained with the GARCH specifications, although in this case the long-tail behavior can only be appreciated for very small values of π.

@&#CONCLUSIONS@&#

In this article, a semiparametric Bayesian approach to make inference and prediction for univariate GARCH-type models has been developed. The innovation distribution has been modeled using a scale mixture of Gaussians model with a Dirichlet process prior for the mixing distribution. An MCMC algorithm based on the combination of retrospective and slice sampling have been constructed to obtain samples from posterior distributions of model parameters and Bayesian prediction for VaR has been carried out. The proposed methodology has been illustrated using simulated data and a real time series data taken from the HSI and BSE30 indices. Our results have been also compared with a Gaussian, a Student-t and a mixture of two zero mean Gaussian distributions. Although the parameter estimation results are in general rather similar for the four specifications, we have obtained significant differences in the predictive distribution of the returns, especially in the tails. Also, we have observed different results in the VaR estimation with the four specifications.

Finally, it would be very interesting to generalize the proposed approach to the multivariate setting. An adequate description of the multivariate innovation distribution is essential in multivariate time varying volatility models. For example, it is well known that the VaR of a portfolio of assets strongly depends on the multivariate distribution of the innovation process, see Galeano and Ausín (2010). The theory and implementation of these issues are currently under research.

@&#ACKNOWLEDGMENTS@&#

The authors thanks Michael P. Wiper for helpful comments. The first author acknowledges financial support by Ministerio de Economía y Competitividad Grants ECO2011-25706. The second author acknowledges financial support by Ministerio de Economía y Competitividad Grants MTM2008-03010 and ECO2012-38442. The third author acknowledges financial support by a seed grant from Indian Institute of Management, Bangalore.

In this Appendix, we explain how to sample from the conditional distributions of the model parameters in each step of the MCMC algorithm presented in Section 3.
                        
                           
                              Step 2:
                           
                           Draws from the conditional posterior distribution of ν can be made, as explained in Escobar and West (1995), by first sampling an auxiliary variable, ζ, from a beta distribution, ζ
                              ∼
                              Be(ν
                              +1,
                              T), and then, sampling ν from a gamma mixture,
                                 
                                    (13)
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ζ
                                          
                                       
                                       G
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             0
                                          
                                       
                                       -
                                       log
                                       ζ
                                       )
                                       +
                                       (
                                       1
                                       -
                                       
                                          
                                             π
                                          
                                          
                                             ζ
                                          
                                       
                                       )
                                       G
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       1
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             0
                                          
                                       
                                       -
                                       log
                                       ζ
                                       )
                                       ,
                                    
                                 
                              where 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    max
                                    
                                       
                                          {
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          }
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                               and π
                              
                                 ζ
                              /(1−
                              π
                              
                                 ζ
                              )= (a
                              0
                              +
                              z
                              ∗
                              −1)/(T(b
                              0
                              −log
                              ζ)).

As suggested in Papaspiliopoulos (2008), the conditional posterior of (
                                 η
                              ,
                              
                                 u
                              ) can be sampled jointly using f(
                                 η
                              ,
                              
                                 u
                              ∣·)=
                              f(
                                 u
                              ∣
                                 η
                              ,·)f(
                                 η
                              ∣·). The conditional posterior distribution of u
                              
                                 t
                               given 
                                 
                                    (
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          η
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    )
                                 
                               follows a uniform density on the interval 
                                 
                                    (
                                    0
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    )
                                 
                              , for t
                              =1,…,
                              T, where 
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    =
                                    (
                                    1
                                    -
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    …
                                    (
                                    1
                                    -
                                    
                                       
                                          η
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          η
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                              . And the conditional posterior of η
                              
                                 s
                               given 
                                 z
                               follows a beta distribution,
                                 
                                    (14)
                                    
                                       
                                          
                                             η
                                          
                                          
                                             s
                                          
                                       
                                       |
                                       z
                                       ∼
                                       Be
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      s
                                                   
                                                
                                                +
                                                1
                                                ,
                                                T
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      l
                                                   
                                                
                                                +
                                                ν
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    I
                                    (
                                    
                                       
                                          z
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    s
                                    )
                                 
                               is the number of observations assigned to the s-th mixture component.

The conditional posterior distribution of 
                                 λ
                               is conjugate and given by,
                                 
                                    (15)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             s
                                          
                                       
                                       |
                                       z
                                       ,
                                       μ
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                       β
                                       ,
                                       ξ
                                       ∼
                                       Gamma
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                      +
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               t
                                                               :
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               =
                                                               s
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

The conditional posterior distribution of 
                                 z
                               is given by,
                                 
                                    (16)
                                    
                                       Pr
                                       (
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       s
                                       |
                                       η
                                       ,
                                       λ
                                       ,
                                       u
                                       ,
                                       ξ
                                       )
                                       ∝
                                       I
                                       (
                                       s
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             ρ
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       )
                                       ϕ
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      t
                                                   
                                                
                                                |
                                                0
                                                ,
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      s
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              Recall that A
                              
                                 ρ
                              (u
                              
                                 t
                              ) is a finite set. Then, as explained in Walker (2007), we need to sample all the values of ρ
                              
                                 s
                               which are larger than u
                              
                                 t
                              . For this, it is enough to find the smallest s
                              ∗ such that,
                                 
                                    (17)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                s
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             s
                                          
                                       
                                       >
                                       1
                                       -
                                       
                                          
                                             u
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                    
                                 
                              where u
                              ∗
                              =min{u
                              1,…,
                              u
                              
                                 T
                              }.

Note that, at this stage of the algorithm, we can compute the variance of ξ
                              
                                 t
                               which, given the model parameters and the observed data, is given by,
                                 
                                    (18)
                                    
                                       ω
                                       =
                                       
                                          
                                             ν
                                          
                                          
                                             ν
                                             +
                                             T
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             (
                                             a
                                             -
                                             2
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                s
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          
                                             ν
                                             +
                                             T
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             s
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

The conditional posterior distributions of μ is not of a standard form and its kernel is given by,
                                 
                                    (19)
                                    
                                       k
                                       (
                                       μ
                                       |
                                       r
                                       ,
                                       λ
                                       ,
                                       z
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                       β
                                       )
                                       =
                                       
                                          
                                             
                                                ∏
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     ̃
                                                                  
                                                               
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             -
                                             1
                                             /
                                             2
                                          
                                       
                                       exp
                                       
                                          
                                             
                                                -
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            -
                                                            μ
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              restricted to the corresponding stationary region. Although random values cannot be generated in a straightforward way, it is possible to use the random walk Metropolis–Hastings algorithm, see e.g. Robert and Casella (2004), which is a rather standard approach in the Bayesian literature. In this type of algorithms, candidate values are usually sampled from a Gaussian distribution with mean equal to the current value and are accepted with certain probability. The variance of the Gaussian proposal density is tuned to obtain a good acceptance rate.

Clearly, the kernel of the conditional posterior distributions of 
                                 
                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                 
                              , for i
                              =1,…,
                              p, and β
                              
                                 j
                              , for j
                              =1,…,
                              q, have the same expression as the given in Eq. (19) and analogously, the RWMH algorithm can be used to sample from these.

@&#REFERENCES@&#

