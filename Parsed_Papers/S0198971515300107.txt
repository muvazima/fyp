@&#MAIN-TITLE@&#Size, connectivity, and tipping in spatial networks: Theory and empirics

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A theoretical model of urban networks is developed linking connectivity to city sizes.


                        
                        
                           
                           The theoretical model predicts inter-city links scale linearly while same-city connections exhibit super-linear scaling.


                        
                        
                           
                           The data for the U.S., New England, and South Korea support the theoretical model’s predictions.


                        
                        
                           
                           Agent-based simulations are conducted to identify the conditions that preserve the diversity of norms in scale-free networks.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Network

Scaling

Size distribution

Tipping

Agent-based simulation

@&#ABSTRACT@&#


               
               
                  We study the impact of settlement sizes on network connectivity in a spatial setting. First, we develop a model of geometric urban networks that posits a positive relationship between connectivity and size. Empirical evidence is then presented validating the model prediction that local links exhibit super-linear scaling with the exponent greater than 1, while long-range connections scale linearly with the unit exponent. The scaling exponents thus suggest that the impact of population size on connectivity is stronger within cities than between cities. We next combine the geometric framework with a computational model of interacting agents to generate a realistic settlement distribution and urban networks from the bottom-up. Calibrated simulation results demonstrate the consistency between hierarchical rank-size distribution and scale-free connectivity. Finally, coupling the spatial network with a tipping diffusion model allows us to consolidate the evolution of network connectivity, city sizes, and social practices in a unified computational framework.
               
            

@&#INTRODUCTION@&#

Cities have become the main medium of information exchange in today's highly interconnected world, where the typical citizen is directly linked to over 200 others (McCarty, Killworth, Bernard, Johnsen, & Shelley, 2001). The clustering of social contacts in cities suggests an intense pattern of interconnectedness. A prime example is collaborations among same-city creative workers (Florida, 2002) that lead to innovations that flourish because density promotes the type of face-to-face contacts that create new ideas (Lobo & Strumsky, 2008) and facilitate the transmission of new knowledge (Henderson, 2007). Larger cities also create better matches between employers and employees due to the extensive labor market connections (Rosenthal & Strange, 2001). Outside the workplace, we are connected, for example, through interpersonal relationships within the circles of local contacts (Zachary, 1977).

Connections naturally lead to networks, which pervade complex biological, social, environmental and technological systems (Newman, 2003). This study draws on a previously developed agent-based model to investigate the effect of size and spatial distribution on network connectivity. There is solid evidence that dense and large cities, as measured by population size, are more affluent than smaller settlements (Bettencourt, Lobo, Helbing, Kühnert, & West, 2007; Glaeser, Scheinkman, & Shleifer, 1995). It appears that large cities facilitate human interactions, and these in turn spur productivity (Granovetter, 2005). The positive impact of size implies that the geographic underpinning of networks plays an important role in shaping urban economies. Indeed, sheer size is generally regarded as a natural prerequisite for complex networks (Vega-Redondo, 2007). Connections, however, are rarely linked to the generative process in which human desires, urban agglomerations, and spatial proximity are intertwined.

In an influential article, Batty (2008) articulates the need to integrate spatial interaction theory with network science to analyze the reliance of connectivity on size. We take up the challenge in this paper by developing a model of a networked urban system where connectivity is a function of both the size and distribution of human settlements. Because most social activities can be understood only by reference to the spatial context, the present study integrates social ties and geographical city-size distribution into an agent-based model. The integration reflects the continuous interactions among social networks and spaces as settlers move about, making new contacts while phasing out old ones.

There is a modest body of literature that examines how the scale and connectivity of physical networks vary with size (e.g., Levinson, 2012; Levinson & Huang, 2011). This literature, however, does not consider the overall size distribution of settlements, and unlike the present study, it largely focuses on the built aspects of transportation networks. Research on social networks, by contrast, tends to focus on structural properties, such as small-world features (Milgram, 1967; Pool & Kochen, 1978; Watts & Strogatz, 1998), transitivity (Watts, 1999), and the degree distribution (Barabasi & Albert, 1999).
                        1
                     
                     
                        1
                        “Small world” refers to the average path length that scales as the logarithm of the number of nodes; “transitivity” refers to the frequent occurrence of the third link in triples that already have two links; the most commonly studied degree distributions are the Poisson, exponential, and scale-free.
                      However, more recent contributions highlight the formation of clusters in social networks (Girvan & Newman, 2002; Porter, Onnela, & Mucha, 2009, Danon, Díaz-Guilera, Duch, & Arenas, 2005), and this literature strand is particularly relevant to the present study, as it shows the strong tendency for relationships to cluster in larger communities (Jin, Girvan, & Newman, 2001). It appears that size and connectivity are positively correlated because a larger community provides more opportunities to form new linkages and maintain old relationships.

Despite the appealing logic and results, clustering models typically conceive nodes and connections without reference to an underlying space. The need to address spatial relationships has motivated an emerging literature to embed social networks in physical space.
                        2
                     
                     
                        2
                        See Dall and Christensen (2002), Barthelemy (2003), Herrmann et al. (2003), and Barnett et al. (2007).
                      We refer to the geographical arrangement of nodes and links as the network topology in space. Models of geographically embedded networks indeed suggest that space influences network properties in important ways (Kosmidis, Havlin, & Bunde, 2008). Spatial constraints, in particular, are relevant in social networks where distance matters, such as friendships and collaboration networks (Emmerich, Bunde, Havlin, Li, & Li, 2013). However, nodes in most spatial models are assumed to be either randomly or uniformly distributed in steady states,
                        3
                     
                     
                        3
                        See, e.g., Itzkovitz and Alon (2005), Manna et al. (2004), and Rozenfeld et al. (2002).
                      which sharply contrasts with the typical pattern of human settlements, where dense cores coexist with sparsely populated peripheries in a distinct hierarchical structure (Eeckhout, 2004; Giesen, Zimmermann, & Suedekum, 2010). Thus, simulating the connectivity impact of size requires a spatial network in which settlers interact on an uneven landscape.

We begin in the next section by advancing a model of tie formation where degree connectivity (number of connections) scales with population size. The model predicts that while long-range interactions scale as ~ m, local interactions scale as ~ m
                     
                        α
                      with α>1, where m is the city size. Section 3 then applies the framework to identify the stylized facts of the size-connectivity nexus in real-world urban systems. The key finding here is that while size is indeed vital in promoting long-range links, it exerts an even more powerful effect on local interactions. Section 4 draws on a previously developed agent-based model (Shin, Shin, & Mansury, 2009) to generate a hierarchical city system from the bottom up. The agent-based model enables the spatial dynamics of city sizes and network topology to be simultaneously simulated. In Section 5, we show that the integration allows us to consolidate the coevolution of network connectivity, city sizes, and social practices in a unified framework. Section 6 concludes.

In the most basic sense, a network is a collection of nodes where some pairs are connected by links. We consider an urban network where the nodes are the geographic locations of people within a city linked by the spatial flows that move information, materials, or people. A node is, therefore, a non-empty location occupied by at least one resident, while k
                     
                        ij
                      is a generic link between node (origin location) i and node (destination location) j. In the current network age, where places are connected in a myriad of different ways, the links between the nodes can be manifested as, for example, information transmitted during phone calls (Krings, Calabrese, Ratti, & Blondel, 2009; Lambiotte, Ausloos, & Holyst, 2007) or the exchange of goods and services (Weisbuch, Kirman, & Herreiner, 2000) as well as the relocation of people (Glaeser, Kallal, Scheinkman, & Shleifer, 1992).

We refer to any human settlement (e.g., metropolitan area, town, or village) as a “city.” Each city I is home to a set of nodal locations defined by the index i
                     =1, 2, …, N. As is standard (see, e.g., Albert, Jeong, & Barabási, 2000 and Vega-Redondo, 2007), city I's degree of connectivity is defined as the number of links emanating from all of the city's nodes. We assume that a pair of nodes can be joined by at most one link and that all existing links have equal weight. Consequently, city I's number of links to another city J, K
                     
                        IJ
                     , measures the strength of the interactions between the two cities.

Formally,
                        
                           (1)
                           
                              
                                 Κ
                                 IJ
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    I
                                    ,
                                    j
                                    ∈
                                    J
                                 
                              
                              
                                 k
                                 ij
                              
                              ,
                           
                        
                     where k
                     
                        ij
                      is a binary indicator =1 if a link exists between node i ∈ I and node j ∈ J and =0 otherwise. Thus, in the phone call example, link k
                     
                        ij
                      would represent communication between the two nodes i and j when the resident of one location places a phone call that is answered on the other end by a resident of the other location. For completeness, we set k
                     
                        ii
                     
                     =0, i.e., a node is not connected to itself. Note that when I
                     =
                     J, then the number of links K
                     
                        II
                      measures the degree of local (intra-city) connectivity, i.e., the extent to which same-city residents interact with each other.

Given these definitions, the average volume of links possessed by a typical city I's nodal location is:
                        
                           (2)
                           
                              <
                              k
                              
                                 >
                                 I
                                 in
                              
                              =
                              
                                 K
                                 I
                                 in
                              
                              /
                              
                                 
                                    2
                                    
                                       m
                                       I
                                    
                                 
                              
                              =
                              
                                 K
                                 II
                              
                              /
                              
                                 
                                    2
                                    
                                       m
                                       I
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (3)
                           
                              <
                              k
                              
                                 >
                                 I
                                 out
                              
                              =
                              
                                 K
                                 I
                                 out
                              
                              /
                              
                                 m
                                 I
                              
                              =
                              
                                 
                                    ∑
                                    
                                       J
                                       =
                                       1
                                       ,
                                       ≠
                                       I
                                    
                                    N
                                 
                                 
                                    K
                                    IJ
                                 
                                 /
                                 
                                    m
                                    I
                                 
                              
                              ,
                           
                        
                     where <
                        k
                     >
                        I
                     
                     
                        in
                      and <
                        k
                     >
                        I
                     
                     
                        out
                      are the average number of intra-city and inter-city links, respectively, and m
                     
                        I
                      is city I's population size. In the phone call example, on average, a typical resident of city I has <
                        k
                     >
                        I
                     
                     
                        in
                      local contacts and <
                        k
                     >
                        I
                     
                     
                        out
                      out-of-city acquaintances. We assume homogeneity within the same city. This means that each resident of city I has 〈k〉
                        I
                     
                     
                        in
                      same-city contacts and, at the same time, is linked to K
                     
                        IJ
                     /m
                     
                        I
                      residents of city J. The statistical properties of the geometric network are thus fully described once K
                     
                        I
                     
                     
                        in
                      and K
                     
                        I
                     
                     
                        out
                      have been determined for every settlement. But how are K
                     
                        I
                     
                     
                        in
                      and K
                     
                        I
                     
                     
                        out
                      determined? This is where settlement sizes come into play.

We use the Gravity approach (Haynes & Fotheringham, 1984; Sen & Smith, 1995; Blumenfeld-Lieberthal & Portugali, 2012; Masucci, Serras, Johansson, & Batty, 2013) to express the volume of interactions between cities as a function of size and physical distance. Central to the Gravity approach is the notion of spatial interactions, where different locations in physical space intermingle (Roy & Thill, 2004). Thus, cities interact, for example, when people change residencies or make long-distance phone calls. Spatial interaction models predict the intensity of an interaction between two cities to be proportional to size but to decay with distance. Indeed, a number of empirical studies have confirmed that populations interact less with one another as the physical distance between them increases (see, e.g., Braha, Stacey, & Bar-Yam, 2011), which, of course, is the essence of the gravitational law.

Applying the Gravity approach to network connectivity in our model, we obtain:
                        
                           (4)
                           
                              
                                 K
                                 IJ
                              
                              =
                              
                                 C
                                 X
                              
                              
                                 
                                    
                                       m
                                       I
                                    
                                    
                                       m
                                       J
                                    
                                 
                                 
                                    d
                                    IJ
                                    2
                                 
                              
                              
                              for
                              
                              I
                              ≠
                              J
                              ,
                           
                        
                     where d
                     
                        IJ
                      is the distance between two cities and C
                     
                        X
                      is a constant term. As apparent from Eq. (4), city I's connectivity scales linearly ~
                        m
                     
                        I
                     
                     1.0 given the other city's population size and distance from city I. This, in turn, implies that 
                        
                           K
                           I
                           out
                        
                        =
                        
                           
                              ∑
                              
                                 j
                                 ≠
                                 i
                              
                           
                           
                              K
                              ij
                           
                        
                      also scales linearly. Note that Eq. (4) allows nodes to connect not only to others in close proximity but also to those in distant locations. This suggests a spatial network that combines short-range interactions (where links connect only adjacent nodes) with longer links (with non-zero probability for distant cities to be connected), which early on in the history of cities are facilitated by waterways, wagons, and horses (Mumford, 1961) later on replaced by railways, and still later on by freeways and air transport among other modes of long-range interactions. More recently almost any place on earth now is accessible through the Web and the mobile phone network (Li, Kosmidis, Bunde, & Havlin, 2011).

While inter-city exchanges of people, commodities, and information can be appropriately modeled by the Gravity approach, there does not appear to be a comparable approach to summarize the degree of within-city interactions. Empirical studies indicate, however, that locations matter, even within the inner confines of a small settlement (Glaeser et al., 1992). One challenge lies in specifying the geometry of a city in an analytically tractable way.

The present study assumes that within a city, residents occupy unique positions and that distance matters as far as interactions among them are concerned. Appendix A shows that the Gravity model gives us the number of intra-city links, which is approximately mlog(m), where m is own population size. For a sufficiently large system, it can be shown that, for the most part, the log–log plot of intra-city connectivity against population size m converges to a straight line with a slope greater than unity. The plot suggests that intra-city links, or the total number of unique connections between members of the same settlement, follow a power relationship:
                        
                           (5)
                           
                              
                                 K
                                 II
                              
                              =
                              
                                 C
                                 0
                              
                              
                              
                                 m
                                 I
                                 α
                              
                              ,
                           
                        
                     where the power exponent α
                     >1 can be viewed as the elasticity of intra-city interactions and C
                     0 is a constant term. The interpretation is straightforward. A one-percent increase in population size is expected to produce a more than proportional increase in the number of local connections. We refer to α
                     >1 as the super-linear scaling exponent, which has been interpreted as evidence of an innovation-driven economy where scale economies are at work (Bettencourt, Lobo, Helbing, Kühnert, & West, 2007).

The predicted super-linear scaling in local interactions is in line with a well-known social network principle, namely, strong and frequent social contacts tend be contained in tightly connected regions and are thus able to take advantage of scale economies, while weaker ties tend to stretch farther across regions (Easley & Kleinberg, 2010). The next section examines the empirical data for select urban systems, showing evidence for the scale-free relationships put forward here.

Testing the scale-free predictions requires coverage of both inter-city and intra-city interactions. Most data sets for networks, e.g., air traffic or information flows across Internet service providers, only cover inter-city exchanges. For our purpose, we employ migration data for the United States and South Korea from surveys of the relocations of people across and within geographic areas. In these datasets, as in the theoretical model, the nodes are non-empty geographic locations and an edge joins two nodes if an individual changes locations (in the same city) or moves to a different city.

It has been shown that the gravity model is the best option to model human mobility across cities and regions (Fotheringham & Webber, 1980). Moreover, migration data reflect both the physical and social aspects of the networks that connect people across settlements. On the one hand, access to physical infrastructure clearly intensifies the extent of human interactions between cities (Jin & White, 2012; Jiang, Yin, & Zhao, 2009). Social networks, on the other hand, reflect the presence of intangibles that connect new migrants to current settlers (Crisp, 1999). Migration is thus bolstered not only by enhanced transportation infrastructure but also by, for example, the support of relatives in the destination city who share a common ethnic, familial, or communal origin (Gold, 2005).

For the U.S. data, we use the term “metropolitan areas” (MAs) to refer to urban areas defined by the U.S. Census Bureau. The 2000U.S. Census reported gross migration for, among other delineations, MAs and New England cities and towns. The data record the number of residents who had relocated from a different region (an MA or a New England city or town) as well as within the same region during the survey year.
                        4
                     
                     
                        4
                        See http://www.census.gov/main/www/cen2000.html.
                      New England consists of a total of 1575 cities and towns. The 2000 census divided MAs into 276 metropolitan statistical areas (MSAs) and 18 consolidated metropolitan statistical areas (CMSAs), which were further sub-divided into 73 primary metropolitan statistical areas (PMSAs).


                     Fig. 1
                      plots inter- and intra-regional migration against population size on a log–log scale. Consistent with the scale-free predictions, the plots reveal power-laws at work in both inter- and intra-regional interactions. Across MSAs and CMSAs, the R-squared shown in Fig. 1 (a) indicates that at least 90% of the variations in both inter- and intra-city migration are accounted for by the variations in population size. The regression lines go beyond that, however, in showing that the slope for intra-MA migration is steeper than that for inter-MA. Specifically, for all U.S. metropolitan areas, one percent increase in size, on average, is associated with an over one percent increase in intra-MA movement, but only with an approximately 0.8% increase in migration inflows from other MAs. In other words, the number of intra-MA links grows faster than the population, while the converse is true for the links between MAs. These results are significant at the 0.1% level and are robust to alternative MA delineations. In particular, disaggregating CMSAs into PMSAs results in essentially the same magnitude and statistical significance for the coefficient for population size.

Intra-regional migration stands out even more for the smaller subset containing New England cities and towns (Fig. 1 (b)), and the slope is even steeper. Specifically, the impact on same-city flows is over 1.2% for every one percent increase in size. This is in contrast to the association between inter-city flows and size that is virtually one-on-one. The slopes also suggest that gravity forces are stronger among urban areas in the smaller New England system. Whether the gravitational pull is systematically stronger for relatively smaller systems across different spatial scales is an interesting question, but is beyond the scope of the present study.

The data for South Korea (Fig. 1 (c) and (d)) also track migration flows across urban areas.
                        5
                     
                     
                        5
                        See http://kostat.go.kr.
                      The 2009 administrative divisions in South Korea include 77 urban agglomerations, each with a population of at least 150,000, and 84 smaller municipalities (similar to U.S. counties) in addition to the capital city of Seoul and other metropolitan cities. Fig. 1(c) displays the connectivity-size plot for Korean metros, while 1(d) does the same for Korean cities. The results again corroborate our theoretical model. Similar to the U.S. case, we find the size-dependent scaling exponents for inter-city flow to be within the range of 0.84 to 1.00, while for same-city flows, the scale is between 1.06 and 1.43. Once again, the population's gravitational pull is stronger for local than for long-range relocations. The Korean data also reveal the level effect of size. Fig. 1(c) and (d) show a crossing between the two power law curves at a population of one million. Thus, among smaller cities, there are more inter-city flows than same-city movements for a given population size. Once the threshold is surpassed, however, the relationship reverses and local migration dominates. The crossing curves suggest greater self-containment in cities of more than one million people, but more empirics would be required before such inferences can be drawn.

In the literature, across many urban systems, the so-called super-linear scaling exponent α
                     =1.1~1.3>1 has been found to be robust and has been taken as evidence of increasing returns at work in cities (Bettencourt et al., 2007). Super linearity has been interpreted as a city's growing population reducing the unit costs of innovation- and wealth-generating activities. Our findings indicate that local interactions are also characterized by super-linear scaling, while inter-city interactions are characterized by linear scaling. In the agent-based simulations below, we calibrate local connectivity to be ~
                        m
                     1.2 and we generate the long-range linear scaling (~
                        m
                     1.0) from the bottom-up.

We have presented empirical findings that appear to validate the scale-free prediction of our network model, while taking the physical locations of the nodes as given. But how do the nodes arise to begin with? This section shows how the proposed network structure can be integrated into an agent-based model (ABM) that generates an empirically consistent geographic distribution of cities. Geography matters in the real world for two reasons. First, cities are unevenly distributed across space, and their populations are clustered in urban agglomerations. Indeed, the concentration of people in cities is a key feature of urbanization. Thus, an approximation that produces a system where individuals are equally likely to be located at all locations would not be realistic. In the US for example, the strong tendency to cluster is self-evident in Fig. 2
                     .

Second, spacing matters, as cities are spatially arranged in a highly ordered pattern. Specifically, the evidence suggests that large cities tend to cluster with other cities (large or small), while small cities tend to be more isolated (Ioannides & Overman, 2004). The New York statistical area, for example, chains New York City, the six largest cities in New Jersey, six of the seven largest cities in Connecticut, and a few others in one of the largest urban agglomerations in the world. At the same time, however, the average distance between large agglomerations in the US has increased by approximately 25% in the 20th century (Ioannides & Overman, 2004).

To move beyond statistical properties and identify the processes that lie behind the coevolution of size and connectivity, we generate a hierarchical system of cities using a previously developed ABM (Shin et al., 2009). ABMs have increasingly been used to model network dynamics in terms of the macro-level, nonlinear consequences of micro-level behavior (see, e.g., the special issue of the American Journal of Sociology, 2005: 110, 4). Agents in our model are purposeful individuals who actively seek a better place to live, and it is their micro location decisions that collectively determine the macro spatial distributions of cities.

We initialize the ABM with a random distribution of 100,000 agents across a two-dimensional 1000×1000 plane. The random distribution corresponds to an early system of human settlements, where the location decisions of family were dictated by the food available from farming and hunting activities, which themselves were randomly distributed in the beginning (Batty, 2013).
                        6
                     
                     
                        6
                        We have experimented with different initial random distributions, including the uniform, the exponential, and the clustered distributions. The results are robust for different initial distributions of population density.
                      Because virtually all societies started as small communities of farmers and hunter gatherers, almost all spatial systems reveal such a random distribution early in their history.

While the total number of agents is fixed, the size of a city tends to ebb and flow because of inter-regional migration, which in turn is driven by the relative strengths of two opposing forces: the dispersion effect of moving costs and the centripetal force of increasing returns.
                        7
                     
                     
                        7
                        Increasing returns here refer to the various advantages associated with living in larger urban areas.
                      The results below show that, despite the initial random distribution, these forces are sufficient to generate a system of cities characterized by intense clustering and spacing. Underlying the emergence of the model's spatial structure is the theory of agglomeration economies (Fujita & Thisse, 2000), where large cities exhibit growth impulses that are, however, attenuated by the distances between cities.


                     Fig. 3
                      displays the evolution of a representative virtual system where the initial, random distribution of agents is shown in panel (a), where a dot corresponds to a city and its area is proportional to the population size. The red circles in Fig. 3 (b) indicate that a few small settlements subsequently expand in size, while others contract. The final outcome is shown in Fig. 3 (c), where agents no longer have incentive to relocate, and all potential gains for welfare improvement have been exhausted.

Under the assumption that cities are located according to the forces of agglomeration economies, our ABM is able to replicate the equilibrium size distribution that is consistent with the empirical evidence for contemporary urban systems (Shin et al., 2009). Fig. 4
                      shows how the size distribution evolves from one characterized by scale dependence in the intermediate stage (City Set 1) to a scale-free relationship in the steady state (City Set 2), which in empirical works has been identified as Zipf's/Gibrat's Law (Eeckhout, 2004; Giesen et al., 2010). This implies a city size distribution that has a fat tail associated with the largest cities. At steady state in particular, one-percent change in population is associated with a 1.1% change in ranking, regardless of the settlement's size, and, hence, is “scale-free.”

Having determined the size and the spatial distribution of cities, we next integrate a social network that is consistent with the scale-free distribution of cities into the ABM. Note the implied duality of nodes and agents; a node exists because its location is home to an agent. We accomplish the integration by calibrating the size elasticity of within-city interactions, α, to 1.2 to match the super-linear scaling exponent estimated above. Next, Eqs. (4) and (5) are used to determine the total number of links between every pair of cities and between nodal locations in the same city, respectively. We then compute the average number of connections,〈k〉
                        I
                     
                     
                        in
                      and K
                     
                        I
                     
                     
                        out
                     /m
                     
                        I
                     , using Eqs. (2) and (3). Finally, we obtain the city network by randomly assigning local and inter-city connections under the homogeneity assumption.


                     Table 1
                      summarizes the aggregate network statistics. As one might expect, the pull of agglomeration causes the number of cities to fall steeply from an average of 3,519 in the intermediate stage (City Set 1) to 1,799 in the steady-state (City Set 2). At the same time, connectivity rose by more than a quarter, from an average of 11.7 links per agent to approximately 14.

The last column in Table 1 lists the external factors, which measure the strength of inter-city interactions relative to the total. External factors have been extensively used in network models of community structures (Girvan & Newman, 2002; Danon et al., 2005). Here, they are computed as the ratio:
                        
                           (6)
                           
                              
                                 s
                                 I
                              
                              =
                              <
                              k
                              
                                 >
                                 I
                                 out
                              
                              /
                              
                                 
                                    <
                                    k
                                    
                                       >
                                       I
                                       in
                                    
                                    +
                                    <
                                    k
                                    
                                       >
                                       I
                                       out
                                    
                                 
                              
                              .
                           
                        
                     
                  

In general, the mean external factor tends to decrease as the system advances, indicating the rising tendency for agents to interact with same-city neighbors vis-à-vis acquaintances from different cities. The trend is brought about by the increasing concentration of agents in cities that were previously already larger than average. Tables 2a
                      and 2b
                     , which rank cities by size, show that larger cities are associated with smaller external factors in the same cross section. As the system approaches steady state, the large cities' external factor falls further, while that for small settlements rises. Thus, as cities expand over time, their residents become even more likely to be connected to same-city neighbors, while smaller cities become more dependent on the rest of the system. The external factor of the largest city in particular fell from over 0.5 in Table 2a to less than 0.3 in Table 2b. Simply put, in equilibrium, nearly three-fourths of the total interactions in the largest city are accounted for by local links. These results suggest that maturing urban networks are characterized by the dominance of local, same-city interactions.


                     Fig. 5
                      plots the strength of local and inter-city interactions (i.e., the degree connectivity) against city size, where the extent is measured by the number of links. In both the intermediate stages and steady states, it appears that while inter-city interactions scale with, at most, the unit exponent, local interactions and size exhibit a power relationship with a slope of 1.2. This is consistent with the empirical super linear scaling.

We have yet to provide micro-foundations for the agent-agent links. Any theory of a city system must relate the social processes that occur in the system to the spatial structure that the system assumes. To connect the social processes to the spatial context, we extend the geometric network framework with the tipping model of Shin and Lorenz (2010). The tipping model micro-foundation recognizes the role of spatial proximity in the evolution of cultural norms, such as beliefs, languages, opinions or other social conventions, that people can choose to adopt or not (Strang & Soule, 1998). The model can also help us identify the drivers behind the spatial spreading of non-communicable diseases, such as diabetes, cancer, and obesity (Gallos, Barttfeld, Havlin, Sigman, & Makse, 2012). For simplicity, we will examine the case where norms are initially divided into bi-polar camps. Differences, however, can diminish over time as interactions with others gradually change norms.

An example of a bipolar system is the bilingual society in Canada, where French- and English-speakers have coexisted for centuries. Of main interest is the tipping point where the system begins the process of reaching a consensus—‘conversion by conversation.’ The notion of tipping was originally introduced by Schelling (1971) and in this example would occur if an all-French-speaking settlement gradually transforms into an all-English speaking settlement through a series of interactions where norms spread beyond the initial language borders. We use the tipping model of Shin and Lorenz (2010) to capture the incremental spread of languages through personal interactions (Labov, 2007; Wray & Grace, 2007). We will then apply the tipping model to identify conditions under which the minority language survives, as in Abrams and Strogatz (2003), but in a spatially explicit model where interactions are more likely to occur and stronger between agents that are near one another in space (O’Sullivan & Perry, 2013). More broadly, tipping models have been used to address the question of whether a community in which members initially hold mutually incompatible views on social issues, such as gay marriage or abortion, will eventually transit into a consensus or remain divided (Lambiotte et al., 2007; Shin & Lorenz, 2010). Agents in these tipping models, however, are cast within the framework of a two-community system. We will use our model to address the same class of problems in a more realistic setting, where multiple communities are linked in a complex pattern of interactions.

In the tipping framework, every agent has a personal trait, which is a random variable that is defined over the continuous interval [−1, +1]. The extreme values, −1 and +1, represent the opposite traits that capture the bipolar nature of norms. Traits, however, are not static, as contacts between individuals of different traits trigger a chain of changes. The evolution of traits is described by the following equation of motion:
                        
                           (7)
                           
                              
                                 y
                                 i
                                 
                                    t
                                    +
                                    1
                                 
                              
                              =
                              τ
                              
                                 y
                                 i
                                 t
                              
                              +
                              
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       
                                          Γ
                                          i
                                       
                                    
                                 
                                 ω
                                 
                                 
                                    y
                                    j
                                    t
                                 
                                 
                                 
                                    
                                       1
                                       −
                                       
                                          
                                             y
                                             i
                                             t
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where y
                     
                        i
                     
                     
                        t
                      denotes agent i's trait at time t, τ the trait retention rate, ω the diffusion rate, and Γ
                        i
                      the set of agent i's acquaintances. Shin and Lorenz (2010) detail the theoretical underpinnings. Briefly, individual traits evolve because of imperfect replications (the retention term) and social interactions with others (the diffusion term). The diffusion term captures the incremental spread of personal traits and, more generally, describes the spatial process that spreads decisions through diffusive activities such as face-to-face interactions or phone, mail, and email exchanges (Hägerstrand, 1967).

We start with a hypothetical system where initially trait λ (=−1) is adopted exclusively by residents of the largest city, while all other cities have embraced trait σ (=+1). The share of σ-agents in the total population is initially greater than 0.5, which means that λ is the minority trait. We fix the trait retention rate (τ) at 0.95 and the diffusion rate (ω) at 0.05 while varying the gravity model's external factors to highlight the role of network topology in space.
                        8
                     
                     
                        8
                        We have also experimented with other alternatives where traits are initially distributed in the continuum range of [−1,+1] and with different values of τ and ω. The results reported here are highly robust to alternative parameter configurations.
                      The tipping model parameters (τ and ω) are fixed at values that yield non-trivial solutions, which occur when all traits decay to zero. Non-triviality is obtained when 1−
                     τ
                     <
                     mω, where m is the average number of acquaintances.

We next explore a case study of two contrasting size distributions. The distribution of the agent population in the first system is exponential (Fig. 6
                      (a)), while in the second, it follows a power-law (Fig. 6 (b)). A circle in Fig. 6 represents a city, and its color corresponds to the trait the city's residents adopt. The case study is motivated by the debate on which approximation is an empirically more plausible representation of the actual size distribution within the same city (Batty & Kim, 1992). We show that while exponential distribution leads to a homogenous society, power laws in both the population and degree distributions are consistent with a pluralistic society where different traits co-exist.

As shown in Fig. 6, whether the minority trait would be able to resist the influence of the majority trait depends on the relative strength of long-range connections. In Fig. 6 (a), settlements follow an exponential distribution where the strength of inter-city connections allows the majority trait, σ, to penetrate the clustered community in the largest settlement. Diffusion eventually drives the convergence to a consensus as the minority trait λ ceases to exist in the steady state.
                        9
                     
                     
                        9
                        More generally, we found that the system converges to consensus under any initial conditions where the population is randomly distributed.
                      By contrast, the system remains polarized in Fig. 6 (b), where the population is power-law distributed. In this case, local links preserve not only the minority trait in the largest settlement but also the intermediate forms in other settlements. The result is an equilibrium characterized by a continuum of traits.

We next show that survival of the minority trait critically depends on the spacing between settlements. In the evolution of network and cities in our model, spacing affects not only the interactions between places but also the degree connectivity (via Eq. (4)). Thus, a random reorganization of settlements that alters urban structure and, hence, spacing can dramatically change the outcome.

The city system shown in Fig. 7
                      is obtained by randomly swapping the locations of settlements in Fig. 6 (b). The swap preserves the scale-free size distribution, but it randomizes the original spatial structure. As shown by the homogeneous (single-colored) system, random swapping ultimately results in the global disintegration of the minority trait. It appears that a group of larger settlements with the majority trait have been randomly reshuffled toward the center of the spatial landscape. The gravitational pull of this cluster of σ-settlements then attracts new links to emanate from the largest city, where initially the λ-trait was common. In effect, the competing nature of the new cluster weakens the local network in the largest city by diverting interactions to the σ-settlements. As a result, the largest city's external factor (relative strength of inter-city interactions) experiences a dramatic 50% increase (from 0.29 to 0.44), and this is large enough to drive the minority trait into extinction and move the system to a consensus. That is, the fate of the minority trait depends not only on the size of the settlement where it is expressed but also on where the adopters are located in the network.

The reason plurality breaks down is that random swapping destroys the network fabric that has preserved the minority trait. In addition to providing locations to live, cities are the space that brings people together and encourages social interactions with those in proximity. The dissemination of norms through diffusive activities then leads to neighbors sharing similar traits. Over time, individuals with different principal traits split into culturally distinct areas, which allow the minority trait to resist the dominant culture. If the locations of cities are then randomly swapped, the simulation results suggest that the swapping disrupts the spatial pattern of interactions to the extent that the minority trait ends up being subsumed by the dominant group.

@&#CONCLUSION@&#

What can we learn from the stylized facts and agent-based simulation results presented here? First, the U.S. and South Korea data show that geographic proximity strengthens the effect of population size on degree connectivity. In particular, connectivity scales with size, but the scaling coefficient is higher for same-city interactions than for long-range ones. It appears that same-city interactions are affected more because geographic proximity allows the population size to exert its gravitational pull unencumbered. One could argue that for an urban system where the majority of the population is clustered in a small number of metropolitan areas, while the rest is scattered around the country, such as in the U.S., the impact of size on connectivity and, therefore, prosperity seems to have practical importance. In particular, if the goal is to foster social cohesiveness and innovation, then policies that spur disinvestments in urban centers while fragmenting settlements to low-density, auto-oriented suburbs (Beauregard, 2006) may have been counterproductive.

Next, we developed a spatial agent-based model to generate a hierarchal city system where scale-free networks emerge as the outcome of individual location decisions. It is important to note that the resulting urban networks do not depend on the existence of a single connected component that, in many scale-free networks, contains the majority of links. In our model, the most connected agent is linked to only approximately 30 others in the steady state, while the average connectivity throughout the entire system is less than half that (Table 1). This topological difference has robustness implications. It has been argued that communication flows in a scale-free network fall apart when highly connected hubs are maliciously attacked and disabled (Albert et al., 2000; Tanizawa, Paul, Cohen, Havlin, & Stanley, 2005). The absence of dominant hubs in our model suggests that urban networks are robust against targeted attacks, and this is broadly consistent with experimental findings (Dodds, Muhamad, & Watts, 2003).

In the last section, we show the implications of territorial diffusion for the survival of minority traits. The findings echo the sentiment that interactions and spatial topology are inextricably linked through generative processes (Roy & Thill, 2004). The simulation results suggest that the survival of minority traits is due, at least in part, to the strength of network effects, and these in turn depend on spatial proximity when distance is a costly barrier. While the model is too stark right now for a realistic policy assessment, it does suggest that a top-down approach that manipulates locational configurations to achieve a utopian ideal would be in danger of simply missing the point of why cities exist to begin with. It appears that today's spatial arrangement has emerged, in part, from the wishes of millions of people to preserve certain traits.

At the same time, the dramatic decrease in transport costs over the 20th century (Glaeser & Kohlhase, 2004) suggests that distance has continued to constrain human interactions. For example, intra-regional phone calls, business traffic, and passenger transport remain dominant over their cross-border rivals (Rietveld & Vickerman, 2004). In innovation-driven economies, face-to-face contacts prove indispensable in facilitating knowledge spillovers, which in turn favor local interactions because of the time, cost, and effort needed to overcome the friction of distance (Jaffe, Trajtenberg, & Henderson, 1993). A similar pattern of interaction is found in the old economy, where co-locating industries are more likely to engage in mutually beneficial transactions (Dumais, Ellison, & Glaeser, 2002). It is safe to say that proximity will remain important well into the foreseeable future.

A number of competing hypotheses have been proposed to explain the dominance of local interactions. Regional scientists and geographers believe that spatial clustering—and, by extension, local interactions—enable workers and firms to take advantage of increasing returns to scale in cities. Political scientists, on the other hand, argue that an essential input in exchanges among strangers is social capital (Putnam, 2000), which is spatially sticky and thus favors local interactions. Those who are able to build a close relationship based on trust will have information advantages, which can translate into considerable benefits. More specifically, trust lowers the cost of acquiring information about the nature of an exchange. The formation of networks can thus be thought of as an effort to minimize transaction costs (Williamson, 1979), and institutions that evolve to reduce such costs do so by focusing on local interactions (Westlund, 1999). These are all testable hypotheses, and their impact on network connectivity can be estimated when the data become available.

Finally, the full model opens the door for a new type of analysis, although the present study does not pursue it, namely, that we can understand more about the evolution of city sizes and distribution by observing the fate of social practices. The full model demonstrates the implications for the spread (or decay) of social practices. When agents relocate, however, they carry with them old connections and traits, which ostensibly trigger a further chain of events in the new settlement. However, a changing geographic pattern of languages, attitudes, and practices will likely have implications for location choices as Benenson (1998) explored in the single-city context. In a multi-city system, the ascent of majority cultural norms, for example, may contribute to the exodus of minority groups from the core cities, which in turn will alter the population configuration. The analysis of closed-loop feedback effects of this type is beyond the scope of the present study and will be attempted next.

This appendix shows how we apply the gravity equation to intra-city interactions. Consider the typical agent i in city I. The strength of the interactions between agent i and all other residents in city I can be approximated as follows:
                        
                           (A1)
                           
                              
                                 K
                                 i
                              
                              =
                              
                                 
                                    ∫
                                    
                                       m
                                       I
                                    
                                 
                                 
                                    C
                                    X
                                 
                                 
                                    
                                       d
                                       
                                          m
                                          z
                                       
                                    
                                    
                                       d
                                       iz
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     
                  


                     Eq. (A1) is obtained from Eq. (4) and by setting m
                     
                        i
                     
                     =1. Note that Eq. (A1) refers to the connectivity of a typical resident of city I, while Eq. (4) to the connectivity between two cities I and J. The former is an approximation while the latter is an exact description. Now, assuming that city I has a circular shape of radius R
                     
                        I
                      and has a uniform density of population, ρ, it follows that
                        
                           (A2)
                           
                              
                                 m
                                 I
                              
                              =
                              ρ
                              
                              π
                              
                              
                                 R
                                 I
                                 2
                              
                              .
                           
                        
                     
                  

If, in addition, agent i is assumed to be located at the center of the city,
                        10
                     
                     
                        10
                        This assumption is chosen more for analytical convenience than out of actual reality in order to derive a closed-form solution.
                      
                     Eq. (A1) has the following closed-form solution:
                        
                           (A3)
                           
                              
                                 K
                                 i
                              
                              =
                              
                                 
                                    ∫
                                    
                                       m
                                       I
                                    
                                 
                                 
                                    C
                                    X
                                 
                                 
                                    
                                       d
                                       
                                          m
                                          z
                                       
                                    
                                    
                                       d
                                       iz
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                       
                                          r
                                          0
                                       
                                       
                                          R
                                          I
                                       
                                    
                                    
                                       C
                                       X
                                    
                                    
                                       
                                          d
                                          m
                                       
                                       
                                          r
                                          2
                                       
                                    
                                    =
                                    2
                                    
                                    π
                                    
                                    ρ
                                    
                                    
                                       C
                                       X
                                    
                                    
                                    
                                       
                                          log
                                          
                                             R
                                             I
                                          
                                          −
                                          log
                                          
                                             r
                                             0
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        
                     where r
                     0 is the closest neighbor to the city center. The geography of the city and the spatial relationship between the city center and locations that are d
                     
                        iz
                     
                     ≡
                     r units of distance away can be visualized as follows:
                        
                           Fig. A1
                           
                              
                                 City center and locations within r and r
                                 
                                 +
                                 
                                 dr units of distance away.
                              
                              
                                 Note: The derivative dm represents the change in the population mass that interacts with an agent at the city center as the distance increases from r to r
                                 +dr.
                           
                           
                        
                     
                  

Assuming r
                     0
                     =1 and using Eq. (A2), we obtain the following relation:
                        
                           (A4)
                           
                              
                                 K
                                 i
                              
                              =
                              πρ
                              
                                 C
                                 X
                              
                              log
                              
                                 m
                                 I
                              
                              −
                              const
                              ,
                           
                        
                     where const
                     ≡πρC
                     
                        X
                     
                     logπρ.


                     Eq. (A4) gives the strength of interaction for an agent i located in the city center. Because, by construction, agent i is the typical resident of city I, the overall extent of intra-city connections can be obtained as K
                     
                        II
                     
                     =
                     m
                     
                        I
                     
                     K
                     
                        i
                      Specifically:
                        
                           (A5)
                           
                              
                                 K
                                 II
                              
                              =
                              π
                              
                              ρ
                              
                              
                                 C
                                 X
                              
                              
                              
                                 m
                                 I
                              
                              log
                              
                                 m
                                 I
                              
                              −
                              
                                 m
                                 I
                              
                              ⋅
                              const
                              .
                           
                        
                     
                  

Numerical simulations show that as the population size m
                     
                        I
                      increases to a sufficiently large number (>5,000), the constant term in Eq. (A5) above constitutes an increasingly smaller portion. There are 100,000 agents in our ABM, in which case the constant term accounts for less than 4% of K
                     
                        II
                      This gives the following approximation:
                        
                           (A6)
                           
                              
                                 K
                                 II
                              
                              ~
                              
                                 m
                                 I
                              
                              log
                              
                                 m
                                 I
                              
                              .
                           
                        
                     
                  

@&#REFERENCES@&#

