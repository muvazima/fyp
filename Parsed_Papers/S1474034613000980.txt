@&#MAIN-TITLE@&#Comparison of genetic algorithm to particle swarm for constrained simulation-based optimization of a geothermal power plant

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Genetic algorithm compared to particle swarm for optimization of a geothermal power plant.


                        
                        
                           
                           PSO achieves better specific work output across a range of algorithm control parameters.


                        
                        
                           
                           PSO converges to optimum solution with lower computation cost.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Genetic algorithm

Particle swarm optimization

Simulation-based optimization

Energy system optimization

Geothermal power plant

@&#ABSTRACT@&#


               
               
                  The performance of a genetic algorithm is compared with that of particle swarm optimization for the constrained, non-linear, simulation-based optimization of a double flash geothermal power plant. Particle swarm optimization converges to better (higher) objective function values. The genetic algorithm is shown to converge more quickly and more tightly, resulting in a loss of solution diversity. Particle swarm optimization obtains solutions within 0.1% and 0.5% of the best known optimum in significantly fewer objective function evaluations than the genetic algorithm.
               
            

@&#INTRODUCTION@&#

Approximately 32 TW of geothermal power are transferred from the interior of the Earth into the Earth’s crust, arising from the heat created in the Earth’s early gravitational collapse as well as radioactive decay within the Earth’s interior [1]. As of 2010, approximately 11 GW of installed geothermal electrical generation capacity is installed worldwide, with approximately 2.5 GW being installed in the United States. Recent studies indicate that through exploitation of existing geothermal resources and feasible development of available resources, there exists an additional 518 GW of geothermal electric resources in the western U.S. [2]. This is nearly half of the total installed electric generation capacity currently in the United States. As the United States and the world continue to develop geothermal power to meet ever-growing electrical power demand, engineers and policy makers will require data on the feasibility and optimum design of geothermal power plants across a spectrum of geothermal resource conditions and climates. As such, there exists a need for scientifically sound design guidance of this type. As a first step in determining optimum plant design across the spectrum of geothermal resources and climates, effective techniques for optimizing geothermal power plants must be investigated.

In this paper, a genetic algorithm (GA) is compared to a particle swarm optimization (PSO) method for the constrained, non-linear, simulation-based optimization of a double flash geothermal power plant. This common geothermal power plant design serves as an effective baseline model for the comparison of optimization algorithms. The optimization algorithms are coded in MATLAB, while the evaluation of the objective function and constraint violation depends on a thermodynamic simulation performed in the software package Engineering Equation Solver. Previous literature on the optimization of double flash geothermal power plants provides significant insight into the relationships between the objective function and the decision variables, but is limited in two significant ways. First, computationally intensive grid-search methods are used, which only allows investigation of a limited solution space [3]. Second, there are vital real-world constraints present in every double flash geothermal plant, described in Section 2.3, that are either ignored or accounted for in an insufficient manner [3,4]. In this work, genetic algorithms and particle swarm optimization are used to allow thorough investigation of the solution space while incorporating these real-world constraints in a rigorous manner. At a more general level, van der Lee et al. describe the use of both Quasi-Newton and “Derivative Free” optimization methods on five generic Rankine cycle power plants [5], while Koch et al. present the use of a genetic algorithm to optimize both the process parameters and the system superstructure of a combined cycle power plant [6]. Both of these studies indicate that sophisticated optimization algorithms hold promise for the simulation-based design of thermal power plants, but neither includes constraints that depend on the simulation results. Elbeltagi et al. compare five separate population-based heuristic algorithms across three non-simulation-based benchmark optimization problems and show that particle swarm optimization performs best with respect to finding feasible solutions as well as the quality of those solutions [7]. Finally, Bornatico et al. describe the use of particle swarm optimization for the constrained simulation-based optimization of a solar thermal energy storage system [8]. Additionally, Bornatico et al. compare the optimum solution achieved by particle swarm optimization to that achieved by a genetic algorithm and show that the optimum solutions are similar. While the design of a solar thermal energy storage system is fundamentally different than that of a thermal power plant, the work of Bornatico et al. provides useful insight into the use of particle swarm optimization and genetic algorithms for constrained simulation-based optimization.

As such, this work contributes to the technical literature as follows. Specifically, it improves upon previous work in the design of double flash geothermal power plants by including a comprehensive search space and accounting for real-world constraints. In a broader sense, it expands upon previous work in simulation-based optimization by including non-linear constraints that are intrinsic to the simulation results. Finally, it provides a rigorous comparison of particle swarm optimization to genetic algorithms for a prototypical constrained, non-linear, simulation-based optimization problem.

A schematic of a double flash geothermal power plant is shown in Fig. 1
                     . Geothermal brine exits the production well (1) as a saturated liquid above atmospheric pressure. After passing through a throttle valve, the brine (2) enters a separator where saturated vapor (4) is sent to a high pressure turbine while the saturated liquid (3) undergoes a second throttling process before entering the flash vessel (6). The lower pressure saturated vapor (8) exits the flash vessel to combine with the exhaust of the high pressure turbine (5) before entering a low pressure turbine (9). The mechanical work of both turbines is used to generate electrical power via a generator. The turbine exhaust (10) is condensed in a condenser (11), while the saturated liquid exiting the separator (7) is reinjected into the geothermal reservoir via an injection well.

There are two independent variables that can be varied in order to maximize the performance of the plant. These are the temperatures at which the separator, 
                           
                              
                                 
                                    T
                                 
                                 
                                    sep
                                 
                              
                           
                        , and flash vessel, 
                           
                              
                                 
                                    T
                                 
                                 
                                    flash
                                 
                              
                           
                        , operate. In the case of this analysis, these two temperatures describe state 2 and state 6:
                           
                              (1)
                              
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       sep
                                    
                                 
                                 ,
                              
                           
                        and
                           
                              (2)
                              
                                 
                                    
                                       T
                                    
                                    
                                       6
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       flash
                                    
                                 
                                 .
                              
                           
                        
                     

In the analysis of geothermal power plants, the most common and universally applicable performance metric is 
                           
                              β
                           
                        , the specific work output of the power plant, with typical units of J/kg [3,4]. This metric describes the amount of energy extracted as electrical power from each kilogram of geothermal brine entering the plant. As the aim is to maximize specific work output, the optimizations carried out in this work are formulated as maximization problems. Neglecting losses in the electrical generator (which has typical efficiency 
                           
                              >
                           
                        98% [9]), specific work output is calculated as
                           
                              (3)
                              
                                 β
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             total
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where total power output, 
                           
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    total
                                 
                              
                           
                        , is the sum of the power output from the low pressure turbine and the high pressure turbine
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       total
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       lpt
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       hpt
                                    
                                 
                                 .
                              
                           
                        
                     

The calculation of specific work output and the appurtenant thermodynamic analysis are described in detail in Appendix A. Simulation of the system thermodynamics requires the calculation of intrinsic thermodynamic properties such as entropy and enthalpy from the non-linear correlations provided by Haar et al. in the NBS/NRC Steam Tables [10]. These calculations are completed in the software package Engineering Equation Solver [11], as it produces accurate results across a wide range of system states and is capable of interfacing directly with MATLAB. As seen in Appendix A, specific work output is a non-linear objective function that is calculated through detailed simulation of the system thermodynamics.

There are several constraints that must be met to ensure effective plant operation. The first of these is the upper limit on silica saturation index (SSI), the details of which are described in Appendix B:
                           
                              (5)
                              
                                 SSI
                                 ≤
                                 1.2
                                 .
                              
                           
                        The value of silica saturation index (SSI) depends on both decision variables, and is calculated through the iterative solution of polynomial and exponential functions, yielding a non-linear constraint. Additionally, there is a lower limit on the quality of steam as it exits each turbine section, which prevents excessive damage to the turbine blades [4,12]:
                           
                              (6)
                              
                                 
                                    
                                       x
                                    
                                    
                                       5
                                    
                                 
                                 ≥
                                 0.85
                                 ,
                              
                           
                        and
                           
                              (7)
                              
                                 
                                    
                                       x
                                    
                                    
                                       10
                                    
                                 
                                 ≥
                                 0.85
                                 .
                              
                           
                        These constraints are also non-linear, as the values of 
                           
                              
                                 
                                    x
                                 
                                 
                                    5
                                 
                              
                              
                              and
                              
                              
                                 
                                    x
                                 
                                 
                                    10
                                 
                              
                           
                         depend on both decision variables and are calculated as part of the thermodynamic simulation carried out in Engineering Equation Solver. Finally, a linear constraint places a lower limit on 
                           
                              
                                 
                                    T
                                 
                                 
                                    flash
                                 
                              
                           
                         to allow for unpumped reinjection of the saturated liquid entering the injection well [4]:
                           
                              (8)
                              
                                 
                                    
                                       T
                                    
                                    
                                       Flash
                                    
                                 
                                 ≥
                                 102
                                 
                                 °
                                 C
                                 .
                              
                           
                        
                     

Heuristic optimization techniques have been developed for optimization problems in which problem size or complexity prevent the use of analytical or exhaustive optimization approaches. Like many simulation-based optimization problems, the design of a double flash geothermal power plant meets these qualifications. Heuristic methods are based on finding the best possible solution by using knowledge of the search space, information gained in the optimization process, and sound judgment. While the strict classification of algorithms is difficult, several prototypical algorithms are typically classified as heuristics. These include tabu search, simulated annealing, genetic algorithms (GA), evolutionary programming, evolution strategies, and particle swarm optimization (PSO). Of these, both tabu search and simulated annealing are designed for use in combinatorial optimization problems, with tabu search acting as a local search strategy [13], and simulated annealing focusing on global optimization [14]. Genetic algorithms are among the most widely adapted heuristics, and have been widely used in the optimization of thermal power systems [6,15–17]. Evolutionary programming shares many similarities with genetic algorithms, but little research exists showing their application to thermal systems [18]. Evolution strategies are also similar to genetic algorithms and have been used in thermal system design [19]. A rapidly growing field in heuristic optimization is that of swarm intelligence, with particle swarm optimization showing great promise in the field of thermal power systems design [8,17]. As such, genetic algorithms (without the added complexities of evolutionary programming and evolution strategies) and particle swarm optimization are chosen as the best candidates for comparison in this work.

A genetic algorithm (GA) is coded as a new implementation in MATLAB following the formulation of Deb [20]. MATLAB is used as it is widely available and allows for rapid and effective code development as well as a simple interface with Engineering Equation Solver. This genetic algorithm utilizes a tournament selection process for efficient constraint handling as well as simulated binary crossover and parameter-based mutation operators. As the goal of this work is to compare basic implementations of each algorithm, this algorithm does not include any other techniques such as “niching” for improving solution quality. A pseudo-code description of the genetic algorithm used in this work follows:
                           
                              Let 
                                    
                                       t
                                       =
                                       0
                                    
                                  be the iteration counter;

Let 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             max
                                          
                                       
                                    
                                  be the maximum number of iterations;

Let 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                    
                                  be the number of decision variables;

Let 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                    
                                  be the population size;

Set 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                       =
                                       
                                          
                                             K
                                          
                                          
                                             p
                                          
                                       
                                       ·
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                    
                                 , where 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             p
                                          
                                       
                                    
                                  is a constant;

Create a random 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                    
                                 -dimensional population, 
                                    
                                       P
                                       (
                                       1
                                       )
                                    
                                 , to consist of 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                    
                                  individuals;


                                 for 
                                 
                                    
                                       t
                                       =
                                       1
                                       :
                                       
                                          
                                             t
                                          
                                          
                                             max
                                          
                                       
                                    
                                 
                                 
                                    
                                       Evaluate the objective function, 
                                             
                                                f
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                          , and constraint violation, 
                                             
                                                C
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                          , of each individual 
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                          ;

Select the mating pool, 
                                             
                                                M
                                                (
                                                t
                                                )
                                             
                                          , through tournament selection;

Create offspring, 
                                             
                                                P
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                          , using simulated binary crossover and parameter-based mutation on 
                                             
                                                M
                                                (
                                                t
                                                )
                                             
                                          ;

Advance to the next iteration, 
                                             
                                                t
                                                =
                                                t
                                                +
                                                1
                                             
                                          ;


                                 end
                              

The details of tournament selection, simulated binary crossover, and parameter-based mutation are described by Deb [20–22]. The pertinent algorithm control parameters recommended by Deb and used in this work are 
                           
                              
                                 
                                    η
                                 
                                 
                                    c
                                 
                              
                              =
                              1
                           
                        , which determines the magnitude of crossover, 
                           
                              
                                 
                                    p
                                 
                                 
                                    sbx
                                 
                              
                              =
                              0.5
                           
                         is the probability of crossover, and 
                           
                              
                                 
                                    η
                                 
                                 
                                    m
                                    ,
                                    initial
                                 
                              
                              =
                              100
                           
                         determines the initial magnitude of mutation. A value of 
                           
                              
                                 
                                    K
                                 
                                 
                                    p
                                 
                              
                              =
                              15
                           
                         is used to set the population size.

A particle swarm optimization (PSO) algorithm, as originally described by Kennedy [23], is also coded as a new implementation in MATLAB, using the formulation and nomenclature presented by Bornatico [8]. This particle swarm optimization algorithm is described in pseudo-code as:
                           
                              Let 
                                    
                                       t
                                       =
                                       0
                                    
                                  be the iteration counter;

Let 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             max
                                          
                                       
                                    
                                  be the maximum number of iterations;

Let 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                    
                                  be the number of decision variables;

Let 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                    
                                  be the population size;

Set 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                       =
                                       
                                          
                                             K
                                          
                                          
                                             p
                                          
                                       
                                       ·
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                    
                                 , where 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             p
                                          
                                       
                                    
                                  is a constant;

Create a random 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                    
                                 -dimensional set of particle positions, 
                                    
                                       P
                                       (
                                       1
                                       )
                                    
                                 , to consist of 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                    
                                  particles;

Create a randomized 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             x
                                          
                                       
                                    
                                 -dimensional set of particle velocities, 
                                    
                                       V
                                       (
                                       1
                                       )
                                    
                                 , to consist of 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             s
                                          
                                       
                                    
                                  velocities;


                                 for 
                                 
                                    
                                       t
                                       =
                                       1
                                       :
                                       
                                          
                                             t
                                          
                                          
                                             max
                                          
                                       
                                    
                                 
                                 
                                    
                                       Evaluate the objective function, 
                                             
                                                f
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                          , and constraint violation, 
                                             
                                                C
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                          , of each individual 
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                          ;

Combine 
                                             
                                                f
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                                
                                                and
                                                
                                                C
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                           to create total objective function 
                                             
                                                F
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                          ;

Calculate new particle velocities, 
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                          ;

Calculate new particle positions, 
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                          ;

Advance to the next generation, 
                                             
                                                t
                                                =
                                                t
                                                +
                                                1
                                             
                                          ;


                                 end
                              

Total objective function, 
                           
                              F
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              )
                           
                        , is calculated by subtracting the magnitude of any constraint violation from the lowest known feasible objective function value. In this way, it is insured that all infeasible solutions have lower objective function values than that of the lowest known feasible solution. Particle velocities are calculated as
                           
                              (9)
                              
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 +
                                 1
                                 )
                                 =
                                 ϕ
                                 (
                                 t
                                 )
                                 ·
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       ,
                                       best
                                    
                                 
                                 -
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 )
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 ·
                                 (
                                 G
                                 -
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              
                              and
                              
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                           
                         are random numbers between 0 and 1. 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                    ,
                                    best
                                 
                              
                           
                         is the best position of particle i so far, and G is the best position of any particle in the population so far. Particle positions are then calculated as
                           
                              (10)
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 +
                                 1
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 +
                                 1
                                 )
                                 .
                              
                           
                        The control parameters used in the particle swarm optimization of this work are the “acceleration constants” 
                           
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              =
                              1
                              
                              and
                              
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                           
                        , chosen to set the relative value of the individual’s knowledge as compared to the entire population’s knowledge. The “inertia constant” 
                           
                              ϕ
                              (
                              t
                              )
                           
                         decreases linearly with iteration number from 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    initial
                                 
                              
                              =
                              1
                           
                         to 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    final
                                 
                              
                              =
                              0
                           
                        , allowing the particles to effectively search a smaller area as the algorithm converges by reducing the impact of a particle’s previous velocity. Again, a value of 
                           
                              
                                 
                                    K
                                 
                                 
                                    p
                                 
                              
                              =
                              15
                           
                         is used to set the population size.

@&#RESULTS@&#

To compare the performance of the genetic algorithm to the particle swarm approach, the optimization of a double flash geothermal model with the decision variables, objective function, and constraints as described in Section 2 is conducted. The constants used as inputs to the thermodynamic simulation for this analysis are 
                        
                           
                              
                                 T
                              
                              
                                 1
                              
                           
                           =
                           250
                           
                           °
                           C
                           ,
                           
                              
                                 T
                              
                              
                                 10
                              
                           
                           =
                           39
                           
                           °
                           C
                        
                     , and 
                        
                           
                              
                                 η
                              
                              
                                 turbine
                              
                           
                           =
                           0.85
                        
                     . The computational platform used in this work is an Intel Core 2 Duo 2.4GHz processor with 8GB of RAM. Both optimization algorithms utilize a population size of 30 particles, with the only stopping condition being the completion of 10 iterations. Accordingly, each algorithm completes 300 objective function evaluations for each optimization run. Each algorithm is run 30 separate times to collect the performance data described below.


                        Table 1
                         summarizes each algorithm’s performance with respect to its ability to consistently reach the maximum objective function value achieved, 
                           
                              
                                 
                                    β
                                 
                                 
                                    opt
                                    ,
                                    Max
                                 
                              
                           
                        . It is seen that both GA and PSO approaches are able to find a maximum objective function value of 127.3kJ/kg, given 30 optimization runs. However, the genetic algorithm is only able to converge to an optimum solution within 0.1% of this value 7 of the 30 optimization runs. By contrast, particle swarm optimization converges to an optimum solution within 0.1% of the best known solution 28 of 30 runs. The PSO method converges to within 0.5% of the best known optimum 30 of 30 runs, while the GA converges to within 0.5% of the best known optimum 24 of 30 runs. Additionally, the genetic algorithm fails to converge within 1% of the best known optimum 3 out of the 30 optimization runs. The ability of the particle swarm optimization to more consistently achieve better (higher) objective function values is supported by the maximum, median, and minimum optimum objective function values across all 30 runs, also displayed in Table 1.

To more rigorously test the assertion that the particle swarm optimization consistently achieves higher optimum objective function values than the genetic algorithm, a t-test is used to compare the optimum objective function values achieved by the PSO and GA on each optimization run.

Specifically, the optimum objective function found by the GA on each of the 30 optimization runs is compared to the optimum objective function found by the PSO on that same run. The difference between these two optimum objective function values, 
                           
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                           
                        ,
                           
                              (11)
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       opt
                                       ,
                                       PSO
                                       ,
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       β
                                    
                                    
                                       opt
                                       ,
                                       GA
                                       ,
                                       i
                                    
                                 
                                 ,
                                 
                                 i
                                 ∈
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       runs
                                    
                                 
                              
                           
                        is stored in a vector of differences, D, of length 30 (
                           
                              
                                 
                                    n
                                 
                                 
                                    runs
                                 
                              
                              =
                              30
                           
                        ). A single-tailed t-test is performed to test the null hypothesis that the data in the vector D is a random sample with a mean value of 0 against the one-sided alternative hypothesis that the mean difference is positive.

This 29 degree-of-freedom t-test is conducted using a significance level of 0.05. This results in a t-statistic of 3.945 with a corresponding p-value of less than 0.001. These results reject the null hypothesis and serve to validate the assertion that the particle swarm optimization consistently achieves higher optimum objective function values than the genetic algorithm in this instance.

For further investigation of the mechanism by which the particle swarm optimization achieves consistently higher optimum objective function values, Fig. 2
                         illustrates the evolution of the two decision variables as the iterations progress in a typical GA optimization run. Fig. 3
                         illustrates the decision variable evolution in a typical PSO optimization run. Figs. 2 and 3 show that the population tends to converge more quickly with respect to iterations and more tightly with respect to the decision variable space for the genetic algorithm than the particle swarm optimization. The radius of the population after the final iteration, 
                           
                              
                                 
                                    R
                                 
                                 
                                    final
                                 
                              
                           
                        , is used as a measure of the population convergence in the decision variable space and is calculated as seen in Eq. (12) 
                        [18]:
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   final
                                                
                                             
                                             =
                                             |
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   m
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   ˆ
                                                
                                             
                                             |
                                             |
                                             ,
                                             
                                             m
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             |
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   m
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   ˆ
                                                
                                             
                                             |
                                             |
                                             ⩾
                                             |
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   ˆ
                                                
                                             
                                             |
                                             |
                                             ,
                                             
                                             i
                                             ∈
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    y
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is the geometric centroid of the population after the final iteration and 
                           
                              |
                              |
                              ·
                              |
                              |
                           
                         is the Euclidean distance. Table 2
                         presents the median of the final population radius across all 30 optimization runs for each algorithm. Figs. 4 and 5
                        
                         show the progression of optimum objective function value as a function of iteration count for the GA and PSO approaches, respectively. Again, the genetic algorithm population is seen to converge more quickly with respect to iterations and more tightly with respect to the objective function than the particle swarm optimization. The data presented in Table 2 and Figs. 2–5 provide insight into the solution space and the mechanism by which the genetic algorithm yields lower objective function values. The genetic algorithm loses population diversity earlier than the particle swarm, which yields consistently worse (lower) optimum objective function values. The proclivity of genetic algorithms to converge too quickly is a known weakness, with specific techniques having been developed to maintain population diversity, most notably “niching” [20].

The computational speed of an algorithm is also a vital metric in determining the applicability of a particular algorithm to a particular problem type. In both the PSO and GA implementations of this work, the algorithm completes 300 objective function evaluations for every optimization run (30 particles for 10 iterations). Table 3
                         presents the median computational runtime required for each algorithm to complete 300 objective function evaluations, as well as the median number of objective function evaluations required for each algorithm to find an optimum solution within a small tolerance 
                           
                              δ
                           
                         of the best known optimum solution. Both algorithms require the same amount of computational runtime (13 s) to complete an optimization run. This similarity is a result of the objective function evaluations requiring significantly more time during each iteration than the internal calculations of each algorithm. However, significant differences are seen between the two optimization methods in the median number of objective function evaluations required to find an optimum solution within a small tolerance of the best known optimum. As also seen in Table 1, the median GA optimization run of 300 objective function evaluations never converges to within 0.1% of the highest known objective function value, while a PSO run requires a median of 211 objective function evaluations to achieve such a result. To converge to within 0.5% of the highest known objective function value the GA requires a median of 94 objective function evaluations while the PSO requires 42. These results indicate that if computational runtime became a limiting factor, a particle swarm optimization method may achieve better results in less time through the addition of a stopping condition that terminates the optimization when some minimum amount of improvement is not achieved over a number of iterations.

The performance of both the genetic algorithm and particle swarm optimization depends on the values of the algorithm control parameters that are used [18,24]. In order to more fully compare the performance of the GA to the PSO, an analysis is performed of each algorithm’s sensitivity to variations in algorithm control parameters. For each method, seven additional cases are investigated by varying each algorithm control parameter around the baseline values described in Section 3. Table 4
                      describes the algorithm control parameters and optimum solution convergence of each case of GA implementation. Case “GA4” results in the poorest performance, with fewer than half of all optimization runs converging to within 0.5% of the best known optimum solution. In this case, the probability of crossover, 
                        
                           
                              
                                 p
                              
                              
                                 sbx
                              
                           
                        
                      is doubled from 0.5 to 1, which results in a loss of population diversity. Case “GA7” yields the best results, with 8 runs converging to within 0.1% of the best known optimum, 26 runs converging to within 0.5%, and 30 runs within 1%. In case “GA7,” 
                        
                           
                              
                                 n
                              
                              
                                 m
                                 ,
                                 initial
                              
                           
                        
                      is decreased from 100 to 10, which yields an order of magnitude larger mutations, increasing population diversity.


                     Table 5
                      presents the sensitivity of the PSO method to varying algorithm control parameters. The worst performance is seen from case “PSO6,” where the initial inertia constant, 
                        
                           
                              
                                 ϕ
                              
                              
                                 initial
                              
                           
                        
                     , is doubled from 1 to 2. The best performance comes from case “PSO5,” wherein the value of the population’s best known position is set to half the value of the individual’s best known position by setting 
                        
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                        
                      equal to 0.5. This result is interesting in that most PSO formulations set 
                        
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                        
                      for simplicity [24].

Once the influence of algorithm control parameters on algorithm performance is illustrated, two analyses remain. First, it is determined whether the best-case GA and PSO implementations produce significantly better results than the baseline implementations described in Sections 3 and 4. Second, it is determined if there are any cases in which the GA outperforms the PSO. To perform this analysis, the optimum objective function values achieved in 30 identical optimization runs are compared across cases. Single-tailed paired t-tests are again utilized at the 0.05 significance level to test the null hypothesis, 
                        
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                        
                     , that the optimum objective function values achieved by one case are equal to those produced by a different case against the alternate hypothesis, 
                        
                           
                              
                                 H
                              
                              
                                 A
                              
                           
                        
                     , that one case produces higher optimum objective function values than the other. Table 6
                      describes these results. First, the results reported in Section 4.1, indicating that the baseline PSO case “PSO1” produces higher optimum objective function values than the baseline GA case “GA1,” are presented for reference. The next result indicates that the best-case GA case “GA7” does not produce significantly higher optimum objective function values than the baseline GA case. The third result illustrates the best-case PSO case “PSO5” does not produce significantly higher optimum objective function values than the baseline PSO case. These two results indicate that the baseline values of algorithm control parameters presented in Section 3 and as cases “GA1” and “PSO1” produce excellent performance for each optimization method. Finally, it is seen that the worst-case PSO “PSO6” produces significantly higher optimum objective function values than the best-case GA “GA7.” This result indicates that the PSO outperforms the GA across a wide range of algorithm control parameters.

@&#CONCLUSIONS@&#

Comparison is made between a genetic algorithm and a particle swarm optimization method for the optimization of a double flash geothermal power plant. The genetic algorithm and particle swarm optimization methods are implemented in MATLAB in their basic form and used to perform 30 identical constrained, non-linear, simulation-based optimization runs. Both algorithms are capable of finding feasible, near-optimum solutions. The particle swarm optimization consistently converges to better (higher) optimum objective function values, as proven by a single-tailed paired t-test. This is a result of the genetic algorithm converging more quickly with respect to iterations and more tightly with respect to the decision variable space, resulting in a premature loss of solution diversity. Computational runtime for both algorithms is equal, as it is dominated by the time required for each objective function evaluation, and each optimization run requires the same number of objective function evaluations. However, the particle swarm optimization obtains solutions within 0.1% and 0.5% of the best known optimum in significantly fewer objective function evaluations than the genetic algorithm. This quality could be exploited in a situation where computational runtime becomes a limiting factor. Sensitivity analysis shows that varying algorithm control parameters can improve or harm algorithm performance, but the worst-case PSO implementation still achieves higher optimum objective function values than the best-case GA implementation. These results indicate that particle swarm optimization has value as a design and decision-making tool for engineers of geothermal power plants as well as engineers of other constrained simulation-based designs.

This work shows the ability of particle swarm optimization and genetic algorithms to include a comprehensive search space and account for real-world constraints in the design of double flash geothermal power plants. Additionally, it expands upon previous work in simulation-based optimization by including non-linear constraints that are intrinsic to the simulation results. Finally, it provides a rigorous comparison of particle swarm optimization to genetic algorithms for a prototypical constrained, non-linear, simulation-based optimization problem.

@&#ACKNOWLEDGMENT@&#

The authors would like to thank the United States Department of Defense Science, Mathematics, and Research for Transformation (SMART) scholarship for student support.

In the modeling of geothermal power plants, it is assumed that the geothermal brine has the same thermodynamic properties as pure water [4]. Throughout this analysis, the enthalpy, h, and entropy, s, of water are calculated from the correlations provided by Haar et al. in the NBS/NRC Steam Tables [10], where subscript f and g denote saturated liquid and saturated vapor, respectively. While the derivation of intrinsic properties of steam is well beyond the scope of this paper, it is worth noting that these properties are described by a Helmholtz energy function and its partial first and second derivatives. Haar et al. developed an analytic series-expansion curve fit of this Helmholtz function, which includes up to 63 coefficients and is logarithmic in nature. Values of enthalpy and entropy as used in this work are calculated by Engineering Equation Solver from this analytic curve fit.

The geothermal brine exits the production well as a saturated liquid, 1:
                           
                              (A.1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   h
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The brine passes through an isenthalpic throttle valve,
                           
                              (A.2)
                              
                                 
                                    
                                       h
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                                 ,
                              
                           
                        to decrease its pressure before entering the separator where the saturated mixture, 2, is separated into saturated liquid, 3,
                           
                              (A.3)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   3
                                                
                                             
                                             =
                                             
                                                
                                                   h
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        and saturated vapor, 4,
                           
                              (A.4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   4
                                                
                                             
                                             =
                                             
                                                
                                                   h
                                                
                                                
                                                   g
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The quality of the saturated mixture at state 2, 
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                        , (the ratio of the mass of saturated steam to the total mass of the saturated mixture) is calculated as
                           
                              (A.5)
                              
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             4
                                          
                                       
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The mass flow rate of steam into the high pressure turbine, 
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    4
                                 
                              
                           
                        , is simply 
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                           
                         multiplied by the inlet mass flow rate of the brine,
                           
                              (A.6)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                              
                           
                        while the mass flow rate into the flash vessel, 
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    3
                                 
                              
                           
                        , is
                           
                              (A.7)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 (
                                 1
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ·
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

The saturated liquid exiting the separator undergoes a second isenthalpic throttling process to create a second, lower pressure saturated mixture, 6, in the flash vessel:
                           
                              (A.8)
                              
                                 
                                    
                                       h
                                    
                                    
                                       6
                                    
                                 
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                        From the flash vessel, the saturated liquid, 7,
                           
                              (A.9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   7
                                                
                                             
                                             =
                                             
                                                
                                                   h
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             6
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        is disposed of in an injection well while the saturated vapor, 8,
                           
                              (A.10)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   8
                                                
                                             
                                             =
                                             
                                                
                                                   h
                                                
                                                
                                                   g
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             6
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        is mixed with the saturated mixture, 5, exiting the high pressure turbine. The quality at state 6 is calculated as
                           
                              (A.11)
                              
                                 
                                    
                                       x
                                    
                                    
                                       6
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             6
                                          
                                       
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             7
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             8
                                          
                                       
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             7
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        while the mass flow rate at 6 is the same as that at 3
                           
                              (A.12)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       6
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                        The mass flow rate of saturated steam exiting the flash vessel, 
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    8
                                 
                              
                           
                        , is calculated from the quality at 6,
                           
                              (A.13)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       8
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       6
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       6
                                    
                                 
                                 ,
                              
                           
                        and the mass flow rate into the injection well, 
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    7
                                 
                              
                           
                        , is
                           
                              (A.14)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       7
                                    
                                 
                                 =
                                 (
                                 1
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       6
                                    
                                 
                                 )
                                 ·
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       6
                                    
                                 
                                 .
                              
                           
                        
                     

The entropy at state 5s, 
                           
                              
                                 
                                    s
                                 
                                 
                                    5
                                    s
                                 
                              
                           
                        , (assuming isentropic expansion through the high pressure turbine) is equal to the entropy of a saturated vapor at state 2,
                           
                              (A.15)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   5
                                                   s
                                                
                                             
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   g
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The entropy of states 7 and 8 are
                           
                              (A.16)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   7
                                                
                                             
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             6
                                          
                                       
                                    
                                 
                              
                           
                        and
                           
                              (A.17)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   8
                                                
                                             
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   g
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             6
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The quality at state 5s is
                           
                              (A.18)
                              
                                 
                                    
                                       x
                                    
                                    
                                       5
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             5
                                             s
                                          
                                       
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             7
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             8
                                          
                                       
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             7
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        and the enthalpy at state 5s is calculated as
                           
                              (A.19)
                              
                                 
                                    
                                       h
                                    
                                    
                                       5
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       7
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       5
                                       s
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                8
                                             
                                          
                                          -
                                          
                                             
                                                h
                                             
                                             
                                                7
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Because a saturated mixture of vapor and liquid droplets passes through the turbine, the well-known Baumann rule (wherein a 1% decrease in quality yields a 1% decrease in efficiency) is utilized to calculate the actual enthalpy at the exit of the high pressure turbine, 
                           
                              
                                 
                                    h
                                 
                                 
                                    5
                                 
                              
                           
                         
                        [4]:
                           
                              (A.20)
                              
                                 
                                    
                                       h
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             4
                                          
                                       
                                       -
                                       
                                          
                                             A
                                          
                                          
                                             lpt
                                          
                                       
                                       ·
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      4
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     7
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     8
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     7
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            lpt
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where the dry efficiency of the turbine is assumed to be a typical value [4], 
                           
                              
                                 
                                    η
                                 
                                 
                                    turbine
                                 
                              
                              =
                              0.85
                           
                        , and is used to calculate the factor A,
                           
                              (A.21)
                              
                                 
                                    
                                       A
                                    
                                    
                                       lpt
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       η
                                    
                                    
                                       turbine
                                    
                                 
                                 /
                                 2
                                 )
                                 ·
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       4
                                    
                                 
                                 -
                                 
                                    
                                       h
                                    
                                    
                                       5
                                       s
                                    
                                 
                                 )
                              
                           
                        and
                           
                              (A.22)
                              
                                 
                                    
                                       x
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 1
                                 .
                              
                           
                        The entropy at state 5, 
                           
                              
                                 
                                    s
                                 
                                 
                                    5
                                 
                              
                           
                        , is then calculated from the steam table correlations as
                           
                              (A.23)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   5
                                                
                                             
                                             =
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             6
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             5
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        which allows calculation of the quality at state 5,
                           
                              (A.24)
                              
                                 
                                    
                                       x
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             5
                                          
                                       
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             7
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             8
                                          
                                       
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             7
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Work output of the high pressure turbine is calculated as the mass flow rate through the turbine multiplied by the enthalpy drop across the turbine:
                           
                              (A.25)
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       hpt
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       4
                                    
                                 
                                 -
                                 
                                    
                                       h
                                    
                                    
                                       5
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

The mass flow rate exiting the high pressure turbine, 
                           
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    5
                                 
                              
                           
                        , is equal to the mass flow rate entering:
                           
                              (A.26)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                                 .
                              
                           
                        The saturated steam, 8, exiting the flash vessel is mixed with the saturated mixture exiting the high pressure turbine to create a high-quality saturated mixture, 9, with a mass flow rate equal to the sum of each flow rate
                           
                              (A.27)
                              
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       9
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       5
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       8
                                    
                                 
                                 ,
                              
                           
                        and an enthalpy equal to the weighted average of both incoming flow enthalpies
                           
                              (A.28)
                              
                                 
                                    
                                       h
                                    
                                    
                                       9
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             5
                                          
                                       
                                       ·
                                       
                                          
                                             h
                                          
                                          
                                             5
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             8
                                          
                                       
                                       ·
                                       
                                          
                                             h
                                          
                                          
                                             8
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             9
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The quality at state 9 is
                           
                              (A.29)
                              
                                 
                                    
                                       x
                                    
                                    
                                       9
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             9
                                          
                                       
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             7
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             8
                                          
                                       
                                       -
                                       
                                          
                                             h
                                          
                                          
                                             7
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        which allows calculation of the entropy
                           
                              (A.30)
                              
                                 
                                    
                                       s
                                    
                                    
                                       9
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       7
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       9
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       8
                                    
                                 
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       7
                                    
                                 
                                 )
                                 .
                              
                           
                        State 10s is the state of the saturated mixture assuming an isentropic expansion through the low pressure turbine,
                           
                              (A.31)
                              
                                 
                                    
                                       s
                                    
                                    
                                       10
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       9
                                    
                                 
                                 .
                              
                           
                        The entropies at states 11 and 12 are calculated through the aforementioned steam table correlations as
                           
                              (A.32)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   11
                                                
                                             
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             10
                                          
                                       
                                    
                                 
                              
                           
                        and
                           
                              (A.33)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   12
                                                
                                             
                                             =
                                             
                                                
                                                   s
                                                
                                                
                                                   g
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             10
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        This allows calculation of the quality at state 10s,
                           
                              (A.34)
                              
                                 
                                    
                                       x
                                    
                                    
                                       10
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             10
                                             s
                                          
                                       
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             11
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             12
                                          
                                       
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             11
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The enthalpies at states 11 and 12 are also calculated using the steam table correlations:
                           
                              (A.35)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   11
                                                
                                             
                                             =
                                             
                                                
                                                   h
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             10
                                          
                                       
                                    
                                 
                              
                           
                        and
                           
                              (A.36)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   12
                                                
                                             
                                             =
                                             
                                                
                                                   h
                                                
                                                
                                                   g
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             10
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        allowing calculation of the enthalpy at state 10s
                           
                              (A.37)
                              
                                 
                                    
                                       h
                                    
                                    
                                       10
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       h
                                    
                                    
                                       11
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       10
                                       s
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       12
                                    
                                 
                                 -
                                 
                                    
                                       h
                                    
                                    
                                       11
                                    
                                 
                                 )
                                 .
                              
                           
                        Again, the Baumann rule is used to calculate the enthalpy of the steam exiting the low pressure turbine
                           
                              (A.38)
                              
                                 
                                    
                                       h
                                    
                                    
                                       10
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             9
                                          
                                       
                                       -
                                       
                                          
                                             A
                                          
                                          
                                             hpt
                                          
                                       
                                       ·
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      9
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     11
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     12
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     11
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            hpt
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            12
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where
                           
                              (A.39)
                              
                                 
                                    
                                       A
                                    
                                    
                                       hpt
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       η
                                    
                                    
                                       turbine
                                    
                                 
                                 /
                                 2
                                 )
                                 ·
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       9
                                    
                                 
                                 -
                                 
                                    
                                       h
                                    
                                    
                                       10
                                       s
                                    
                                 
                                 )
                                 .
                              
                           
                        Using 
                           
                              
                                 
                                    h
                                 
                                 
                                    10
                                 
                              
                           
                        , the entropy at state 10 is calculated from the steam table correlations
                           
                              (A.40)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   10
                                                
                                             
                                             =
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             10
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             10
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        and steam quality at the low pressure turbine exhaust is
                           
                              (A.41)
                              
                                 
                                    
                                       x
                                    
                                    
                                       10
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             10
                                          
                                       
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             11
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             12
                                          
                                       
                                       -
                                       
                                          
                                             s
                                          
                                          
                                             11
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Work output of the low pressure turbine is calculated as
                           
                              (A.42)
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       lpt
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       9
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       9
                                    
                                 
                                 -
                                 
                                    
                                       h
                                    
                                    
                                       10
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

The objective function used in this work, specific work output (
                           
                              β
                           
                        ), is calculated as
                           
                              (A.43)
                              
                                 β
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             total
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where total power output, 
                           
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    total
                                 
                              
                           
                        , is the sum of the power output from the low pressure turbine and the high pressure turbine
                           
                              (A.44)
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       total
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       lpt
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       hpt
                                    
                                 
                                 .
                              
                           
                        
                     

Due to prolonged contact with the fractured rock of the underground reservoir, all geothermal brine is saturated with respect to silica (in the form of crystalline quartz) as it exits the production well and enters the plant components [4]. As the geothermal brine is cooled while passing through the plant, the silica undergoes a transformation from crystalline quartz to amorphous silica [25,26]. Additionally, as the geothermal brine is flashed to steam, the concentration of silica in the remaining liquid brine increases. If the silica concentration exceeds the equilibrium concentration of amorphous silica in water at the brine temperature, precipitation on plant piping will result, potentially yielding significant degradation of plant performance [25]. The “Silicon Saturation Index” (SSI) is commonly used as a measure of the potential for silica deposition, defined as the ratio of amorphous silica concentration, S, to equilibrium amorphous silica concentration, 
                        
                           
                              
                                 S
                              
                              
                                 eq
                              
                           
                        
                      
                     [27].
                        
                           (B.1)
                           
                              SSI
                              =
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          eq
                                       
                                    
                                 
                              
                           
                        
                     In practice, SSI can exceed a value of 1, due to the “slow” kinetics of the deposition process. A limit of 
                        
                           SSI
                           ⩽
                           1.2
                        
                      is used as a reasonable constraint for geothermal plant design [28].

To calculate SSI, the concentration of crystalline quartz in the brine as it exits the production well must first be determined. It is assumed that the brine is saturated with respect to crystalline quartz as a result of being held in the geothermal reservoir [4]. The equilibrium concentration of crystalline quartz assuming no salinity of the brine, 
                        
                           
                              
                                 Q
                              
                              
                                 eq
                              
                           
                        
                     , is calculated by iteratively solving Eq. (B.2) 
                     [25]
                     
                        
                           (B.2)
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              =
                              -
                              42.198
                              +
                              0.28831
                              ·
                              
                                 
                                    Q
                                 
                                 
                                    eq
                                 
                              
                              -
                              3.6686
                              ×
                              
                                 
                                    10
                                 
                                 
                                    -
                                    4
                                 
                              
                              ·
                              
                                 
                                    Q
                                 
                                 
                                    eq
                                 
                                 
                                    2
                                 
                              
                              +
                              3.1665
                              ×
                              
                                 
                                    10
                                 
                                 
                                    -
                                    7
                                 
                              
                              ·
                              
                                 
                                    Q
                                 
                                 
                                    eq
                                 
                                 
                                    3
                                 
                              
                              +
                              77.034
                              ·
                              log
                              
                                 
                                    Q
                                 
                                 
                                    eq
                                 
                              
                              .
                           
                        
                     As described above, the crystalline quartz transforms into amorphous silica as it cools, and the concentration of the amorphous silica in the remaining brine, S, increases over 
                        
                           
                              
                                 Q
                              
                              
                                 eq
                              
                           
                        
                      as the brine is flashed to steam. The ratio of amorphous silica concentration to crystalline quartz concentration is equal to the ratio of mass flow rate of brine from the production well, 
                        
                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 1
                              
                           
                        
                     , to the mass flow rate of brine into the injection well, 
                        
                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       ̇
                                    
                                 
                              
                              
                                 7
                              
                           
                        
                     , also written as
                        
                           (B.3)
                           
                              S
                              =
                              
                                 
                                    Q
                                 
                                 
                                    eq
                                 
                              
                              ·
                              
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          7
                                       
                                    
                                 
                              
                              .
                           
                        
                     All that remains is to calculate the equilibrium concentration of amorphous silica, 
                        
                           
                              
                                 S
                              
                              
                                 eq
                              
                           
                        
                     , which is found using the correlation of Fournier and Marshall (again assuming zero salinity of the brine) [29]
                     
                        
                           (B.4)
                           
                              log
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   eq
                                                
                                             
                                          
                                          
                                             58400
                                          
                                       
                                    
                                 
                              
                              =
                              -
                              6.116
                              +
                              0.01625
                              ·
                              
                                 
                                    T
                                 
                                 
                                    7
                                 
                              
                              -
                              1.758
                              ×
                              
                                 
                                    10
                                 
                                 
                                    -
                                    5
                                 
                              
                              ·
                              
                                 
                                    T
                                 
                                 
                                    7
                                 
                                 
                                    2
                                 
                              
                              +
                              5.257
                              ×
                              
                                 
                                    10
                                 
                                 
                                    -
                                    9
                                 
                              
                              ·
                              
                                 
                                    T
                                 
                                 
                                    7
                                 
                                 
                                    3
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 T
                              
                              
                                 7
                              
                           
                        
                      is measured in degrees Kelvin.

@&#REFERENCES@&#

