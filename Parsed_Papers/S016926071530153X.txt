@&#MAIN-TITLE@&#Information theoretic multiscale truncated SVD for multilead electrocardiogram

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Clinically relevant multiscale multivariate entropy is introduced based on modified Shannon's entropy.


                        
                        
                           
                           Multiscale truncated SVD is formulated by reducing ranks of the matrices based on multiscale multivariate entropy and energy.


                        
                        
                           
                           The proposed algorithm is tested with normal and pathological signals.


                        
                        
                           
                           Signal distortion measures like PRD, RMSE, WEDD are evaluated.


                        
                        
                           
                           A new signal distortion measure, multivariate clinical distortion (MCD), is introduced.


                        
                        
                           
                           Mean opinion scores (MOS) are evaluated to ensure the quality of reconstructed signals.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multilead ECG

Multiscale SVD

Multivariate multiscale entropy

PRD

RMSE

@&#ABSTRACT@&#


               
               
                  Background and objective
                  In this paper an information theory based multiscale singular value decomposition (SVD) is proposed for multilead electrocardiogram (ECG) signal processing. The shrinkage of singular values for different multivariate multiscale matrices at wavelet scales is based on information content. It aims to capture and preserve the information of clinically important local waves like P-waves, Q-waves, T-waves and QRS-complexes.
               
               
                  Methods
                  The information is derived through clinically relevant multivariate multiscale entropy in SVD domain modifying Shannon's entropy. This optimizes the approximate ranks for matrices to capture the clinical components of ECG signals appearing at different scales. A newly introduced multivariate clinical distortion (MCD) metric is computed and compared with existing subjective and objective signal distortion measures. The proposed method is tested with records from CSE multilead measurement library and PTB diagnostic ECG database for various pathological cases.
               
               
                  Results
                  It gives average percentage root mean square difference (PRD), average normalized root mean square error (NRMSE), average wavelet energy based diagnostic distortion measure (WEDD) values 5.8879%, 0.0059 and 1.0760% respectively for myocarditis pathology. The corresponding MCD value is 1.9429%. The highest average PRD and average WEDD values are 11.4053% and 5.5194% for cardiomyopathy with the corresponding MCD value 1.4003%.
               
               
                  Conclusions
                  Based on WEDD values and mean opinion scores (MOS), the quality group of all processed signals fall under excellent category.
               
            

@&#INTRODUCTION@&#

Cardiologists normally look at electrocardiogram (ECG) for clinically essential diagnostic information like, P-wave, QRS-complex, T-wave, Q-wave, S-wave, ST-segments with innate morphologies, durations and amplitudes. This helps investigating cardiac pathology. For decades, numerous studies and ideas are applied for better extraction of information about these components. When recorded, these types of physiological signals are likely to have deterministic and stochastic components [1]. To meet the demand for acceptable ‘PQRST’ morphology in a clinical setting, researchers extract relevant clinical information using different methods. Among them, the singular value decomposition (SVD) is applied to the fetal ECG extraction [2], noise removal and recovery of lost channel [3], data compression [4], denoising sensors arrays data [5] and denoising of multilead ECG signals [6]. It is employed for features extraction [7] for support vector machine (SVM) to classify the different physiological states. For pathological ECG beats recognition, SVD is used in [8]. The selection of singular values plays an important role for SVD based methods in capturing clinical information in processed signals. In our earlier study, to select singular values multiscale root fractional energy contribution is considered for multilead ECG data compression [9].

In another type of approach to extract the complexity of physiological signal, Pincus introduced approximate entropy (ApEn) [10]. The sample entropy (SampEn) was introduced by Richman and Moorman [11] to measure the regularity of complex physiological univariate data. The Higher SampEn metric indicates higher complexity. It is maximized for a randomized process and yields lower value for more regular data. It has been reported to yield misleading results [1,12,13]. The ECG signals of healthy subjects with heart rate variability (HRV) show lower SampEn compared to atrial fibrillation. The ApEn and the SampEn metrics are based on the single-scale. To extract information at multiple time scales, the SampEn is evaluated at multiple scale [1,14–17] by the coarse-graining procedure as multiscale entropy. This was modified to evaluate the multivariate sample entropy [12,13]. These types of definition of entropy of physiological signals mainly quantify the complexity. Instead, if classical Shannon entropy is assigned to quantify the information, it gives higher value for a completely random system and lower value for more ordered time series [1,14,15] which contains local waves.

In this work, the information presence in physiological signal is captured in multiscale SVD domain. As the singular values capture the information of the signal in SVD domain, it is suggested to evaluate clinically relevant modified Shannon's multivariate multiscale entropy to represent clinical information. It is expected that in time and space, the entropy may provide better information about the recorded physiological signals which contain local waves and random noise. So, in a multiscale SVD domain, modified Shannon's multivariate multiscale entropy (MME) for multichannel ECG data, is derived. Based on the MME, suitable shrinkage of singular values for multiscale SVD is formulated to capture the maximum clinical information. In an ECG signal P-waves, Q-waves, T-waves and QRS-complexes are desired clinical information. This shrinkage of singular value (SV) gives minimum clinical component distortion. In the rest of the article, in Section 2, the method is explained and in Section 3, results are summarized. At Section 4, a brief conclusion is drawn.

@&#METHOD@&#

To formulate entropy based multiscale truncated SVD using multiresolution analysis, multilead electrocardiogram signals: lead-I, lead-II, lead-III, lead-aVR, lead-aVL, lead-aVF, lead-V1, lead-V2, lead-V3, lead-V4, lead-V5 and lead-V6 are considered. Though among these only 8 leads are linearly independent, standard 12 leads are used to formulate multivariate analysis. These signals are individually wavelet transformed using the same mother wavelet and decomposition levels [18]. The details subbands are denoted as cD
                     
                        j
                     , where decomposition level j
                     =1, 2, …, L and the approximation subband is cA
                     
                        L
                     . The wavelet decomposition level is L. To form multivariate matrices at different decomposition levels, similar subbands from different ECG leads are collected. At approximation level, wavelet coefficients of approximation subbands of all the leads are arranged in columns to form matrix AL
                      ∈ R
                     
                        N
                        
                           L
                        ×n
                     . Similarly, at the details, wavelet coefficients of detail subbands of all the leads are arranged in columns to form matrices Dj
                      ∈ R
                     
                        N
                        
                           j
                        ×n
                     . The number of wavelet coefficients in each column at approximations is N
                     
                        L
                      and in each column at details are N
                     
                        j
                      respectively. The n is the number of columns which also represents number of ECG leads. The SVD of approximation matrix is given as
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          A
                                          L
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          U
                                          
                                             
                                                A
                                                L
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          Σ
                                          
                                             
                                                A
                                                L
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          V
                                          
                                             
                                                A
                                                L
                                             
                                          
                                          T
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 U
                                 
                                    
                                       A
                                       L
                                    
                                 
                              
                           
                        
                     , 
                        
                           
                              
                                 V
                                 
                                    
                                       A
                                       L
                                    
                                 
                                 T
                              
                           
                        
                      and 
                        
                           
                              
                                 Σ
                                 
                                    
                                       A
                                       L
                                    
                                 
                              
                           
                        
                      are left singular, right singular and diagonal singular value matrices respectively. For matrices at details, the SVD's are given as
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          D
                                          j
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          U
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          Σ
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          V
                                          
                                             
                                                D
                                                j
                                             
                                          
                                          T
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 U
                                 
                                    
                                       D
                                       j
                                    
                                 
                              
                           
                        
                     , 
                        
                           
                              
                                 V
                                 
                                    
                                       D
                                       j
                                    
                                 
                                 T
                              
                           
                        
                      and 
                        
                           
                              
                                 Σ
                                 
                                    
                                       D
                                       j
                                    
                                 
                              
                           
                        
                      are left singular, right singular and diagonal singular value matrices respectively. The rank of AL
                      is rank(A
                     
                        L
                     )=
                     n
                     
                        A
                        
                           L
                        
                      and ranks of Dj
                      are rank(D
                     
                        j
                     )=
                     n
                     
                        D
                        
                           j
                        
                     . These ranks represent the independent columns containing coefficients of subbands of different ECG leads at wavelet scales. The diagonal entries of singular value matrices for approximation and details levels are given as
                        
                           (3)
                           
                              
                                 σ
                                 i
                                 
                                    
                                       A
                                       L
                                    
                                 
                              
                              ⇒
                              
                                 σ
                                 1
                                 
                                    
                                       A
                                       L
                                    
                                 
                              
                              ≥
                              
                                 σ
                                 2
                                 
                                    
                                       A
                                       L
                                    
                                 
                              
                              ≥
                              ⋯
                              ≥
                              
                                 σ
                                 n
                                 
                                    
                                       A
                                       L
                                    
                                 
                              
                              ≥
                              0
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 σ
                                 i
                                 
                                    
                                       D
                                       j
                                    
                                 
                              
                              ⇒
                              
                                 σ
                                 1
                                 
                                    
                                       D
                                       j
                                    
                                 
                              
                              ≥
                              
                                 σ
                                 2
                                 
                                    
                                       D
                                       j
                                    
                                 
                              
                              ≥
                              ⋯
                              ≥
                              
                                 σ
                                 n
                                 
                                    
                                       D
                                       j
                                    
                                 
                              
                              ≥
                              0
                           
                        
                     where i
                     =1, 2, …, n. It is expected to get low rank estimations for the matrices at approximation and detail levels, 
                        rank
                        (
                        
                           
                              
                                 
                                    
                                       A
                                       L
                                    
                                 
                              
                           
                           ˆ
                        
                        )
                        =
                        
                           k
                           
                              
                                 A
                                 L
                              
                           
                        
                      and 
                        rank
                        (
                        
                           
                              
                                 
                                    
                                       D
                                       j
                                    
                                 
                              
                           
                           ˆ
                        
                        )
                        =
                        
                           k
                           
                              
                                 D
                                 j
                              
                           
                        
                      from singular value matrices to retain maximum signal information, where k
                     
                        A
                        
                           L
                        
                     
                     <
                     n
                     
                        A
                        
                           L
                        
                      and k
                     
                        D
                        
                           j
                        
                     
                     <
                     n
                     
                        D
                        
                           j
                        
                     . Thus, the truncated SVD solution of approximation matrix and details matrices are given as
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                             L
                                          
                                       
                                    
                                 
                                 ˆ
                              
                              =
                              
                                 
                                    
                                       
                                          U
                                          
                                             
                                                k
                                                
                                                   
                                                      A
                                                      L
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          Σ
                                          
                                             
                                                k
                                                
                                                   
                                                      A
                                                      L
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          V
                                          
                                             
                                                k
                                                
                                                   
                                                      A
                                                      L
                                                   
                                                
                                             
                                          
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          
                                             D
                                             j
                                          
                                       
                                    
                                 
                                 ˆ
                              
                              =
                              
                                 
                                    
                                       
                                          U
                                          
                                             
                                                k
                                                
                                                   
                                                      D
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          Σ
                                          
                                             
                                                k
                                                
                                                   
                                                      D
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          V
                                          
                                             
                                                k
                                                
                                                   
                                                      D
                                                      j
                                                   
                                                
                                             
                                          
                                          T
                                       
                                    
                                 
                              
                           
                        
                     where k
                     
                        A
                        
                           L
                        
                      and k
                     
                        D
                        
                           j
                        
                      singular values those are selected from the columns of left and right unitary matrices. In reconstructing signal, if too small rank is selected, all subtlety is lost. The errors 
                        |
                        |
                        
                           
                              
                                 
                                    A
                                    L
                                 
                              
                           
                        
                        −
                        
                           
                              
                                 
                                    
                                       
                                          A
                                          L
                                       
                                    
                                 
                              
                           
                           ˆ
                        
                        |
                        
                           |
                           F
                        
                      and 
                        |
                        |
                        
                           
                              
                                 
                                    D
                                    j
                                 
                              
                           
                        
                        −
                        
                           
                              
                                 
                                    
                                       
                                          D
                                          j
                                       
                                    
                                 
                              
                           
                           ˆ
                        
                        |
                        
                           |
                           F
                        
                      may be minimized if singular values are suitably chosen. ||.||
                        F
                      represents Frobenius norm. It is proposed that the information theoretic based shrinkage of singular values may provide a suitable solution by minimizing errors and optimizing clinical information content in output signals. The SVD evaluated in time and space is expected to preserve information of local waves. This may be achieved if the selection of suitable number of singular values are derived weighting with information and energy for different matrices, where k
                     
                        A
                        
                           L
                        
                     
                     <
                     n
                     
                        A
                        
                           L
                        
                      and k
                     
                        D
                        
                           j
                        
                     
                     <
                     n
                     
                        D
                        
                           j
                        
                     . After reducing dimensions through multiscale SVD operation, individual ECG leads are recovered by rearranging coefficients of wavelet subbands and applying wavelet reconstruction filters.

Due to multiscale wavelet decomposition, the energy of the signal is captured by a few wavelet coefficients in subbands. The frequency domain characteristics of different wavelet subbands of an electrocardiogram suggest that the approximation subband contains the low-frequency components and the details subbands contain both the lower- and higher-frequency components [18]. Wavelet subband matrices are formed using coefficients of these subbands. Ideally, for normal and clean ECG, the energy contribution of wavelet subbands matrices is in order ||AL
                        ||
                           F
                        
                        >||Dj
                        ||
                           F
                        
                        >⋯>||D1
                        ||
                           F
                         
                        [19]. It shows that the wavelet coefficients of approximation subbands (in matrix AL
                        ) and higher level details subbands with lower frequency components (in matrices Dj
                        ) capture most of the energy of multilead signals [18]. The amount of relative energy is due the representative coefficients that carry the information of local waves. It is expected that the information theoretic approach for multiscale SVD may help selection of appropriate number of singular values at AL
                         and Dj
                         to retain ‘PQRST’ morphologies in processed signals. To compute multiscale entropy to estimate the best rank(AL
                        ) and rank(Dj
                        ) for shrinkage of singular values at wavelet scales, probabilities of normalized singular values at approximation and detail scales are
                           
                              (7)
                              
                                 
                                    P
                                    
                                       
                                          σ
                                          i
                                          
                                             
                                                A
                                                L
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             
                                                σ
                                                i
                                                
                                                   
                                                      A
                                                      L
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             (
                                             
                                                σ
                                                i
                                                
                                                   
                                                      A
                                                      L
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    P
                                    
                                       
                                          σ
                                          i
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             
                                                σ
                                                i
                                                
                                                   
                                                      D
                                                      j
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             (
                                             
                                                σ
                                                i
                                                
                                                   
                                                      D
                                                      j
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        These quantities give the probability distributions based on representative relative energies due to local waves of ECG signals for different matrices. Using probabilities defined as above, multiscale entropies are calculated as
                           
                              (9)
                              
                                 H
                                 (
                                 
                                    A
                                    L
                                 
                                 )
                                 =
                                 −
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    P
                                    
                                       
                                          σ
                                          i
                                          
                                             
                                                A
                                                L
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 log
                                 (
                                 
                                    P
                                    
                                       
                                          σ
                                          i
                                          
                                             
                                                A
                                                L
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (10)
                              
                                 H
                                 (
                                 
                                    D
                                    j
                                 
                                 )
                                 =
                                 −
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    P
                                    
                                       
                                          σ
                                          i
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 log
                                 (
                                 
                                    P
                                    
                                       
                                          σ
                                          i
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        where H(A
                        
                           L
                        ) and H(D
                        
                           j
                        ) are the information estimation based on probability distributions for approximation and details matrices. Shannon entropy gives a measure of degree of the disorder of the signal. For a matrix at wavelet scale, a very low vanishing value of entropy represents most ordered components of signals. There may be periodic component from wavelet subbands due to local waves. On the other hand, totally random process may be thought as a representative of disorder signals. The higher entropy value stands for disordered signals in a matrix with flat singular value distribution [20]. In this case, the spectrum of the signals may be flat as white random noise. The matrices formed with coefficients of higher frequency subbands inherit stochastic components. The matrices with coefficients of low frequency subbands contain local waves (P, Q, T, QRS complex) of ECG signals with higher correlations [19]. Due to random components in higher frequency subband matrices, it is expected to get higher entropy values [14] whereas lower frequency subband matrices give low entropy values. Entropy values are expected to be in order H(A
                        
                           L
                        )<
                        H(D
                        
                           j
                        )<⋯<
                        H(D
                        1) due to wavelet segmentation of recorded ECG having stochastic components. But matrices with coefficients of lower frequency subband (contain local waves P, Q, T, QRS complex) are clinically important. Thus, it is suggested to consider entropy values of multiscale matrices with respect to the total entropy of the multilead system. The total entropy may include the information of random components and more regular local waves.

If the energy is evaluated using multiscale Frobenius norm for approximation and details multivariate matrices as 
                           
                              E
                              
                                 
                                    A
                                    L
                                 
                              
                           
                           =
                           |
                           |
                           
                              
                                 
                                    
                                       A
                                       L
                                    
                                 
                              
                           
                           |
                           
                              |
                              F
                           
                         and 
                           
                              E
                              
                                 
                                    D
                                    j
                                 
                              
                           
                           =
                           |
                           |
                           
                              
                                 
                                    
                                       D
                                       j
                                    
                                 
                              
                           
                           |
                           
                              |
                              F
                           
                        , the probability distributions based on energies are
                           
                              (11)
                              
                                 
                                    P
                                    
                                       
                                          E
                                          
                                             
                                                A
                                                L
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          E
                                          
                                             
                                                A
                                                L
                                             
                                          
                                       
                                    
                                    
                                       
                                          E
                                          
                                             
                                                A
                                                L
                                             
                                          
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          L
                                       
                                       
                                          E
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    P
                                    
                                       
                                          E
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          E
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          E
                                          
                                             
                                                A
                                                L
                                             
                                          
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          L
                                       
                                       
                                          E
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              P
                              
                                 
                                    E
                                    
                                       
                                          A
                                          L
                                       
                                    
                                 
                              
                           
                         and 
                           
                              P
                              
                                 
                                    E
                                    
                                       
                                          D
                                          j
                                       
                                    
                                 
                              
                           
                         indicate probability distributions for approximation and details matrices respectively. These normalized Frobenius norms give relative importance of matrices. For mathematical simplification, let us denote 
                           P
                           (
                           
                              E
                              
                                 
                                    A
                                    L
                                 
                              
                           
                           )
                         as 
                           P
                           (
                           
                              E
                              
                                 
                                    D
                                    
                                       j
                                       +
                                       1
                                    
                                 
                              
                           
                           )
                        . The total entropy of the system, H, is
                           
                              (13)
                              
                                 H
                                 =
                                 −
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       L
                                       +
                                       1
                                    
                                 
                                 
                                    P
                                    
                                       
                                          E
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 log
                                 
                                    P
                                    
                                       
                                          E
                                          
                                             
                                                D
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        For a 12-lead ECG system, H, includes information due to random components and more regularized local wave components of multilead signals. In multiresolution representation of ECG, local waves (P, Q, T, QRS-complex), are grossly distributed into different wavelet subbands. The representative coefficients of these subbands from different leads, form subbands matrices. In comparison to higher level matrices (having low frequency local waves), the lower level matrices show higher entropy values due to dominant stochastic components. Low frequency local waves are more important in a clinical setting to be interpreted by the cardiologist. Because in an ECG, P-wave represents atrial depolarization, Q-wave represents inter-ventricular septal depolarization, R-wave represents ventricular depolarization, S-wave represents basal ventricular depolarization and T-wave represents ventricular repolarization. So, it is expected that multiscale entropy with respect to the total entropy of the system may provide better information about clinically essential components. This may help deciding singular values for different multiscale multivariate matrices. It is proposed to derive multiscale entropies as
                           
                              (14)
                              
                                 
                                    H
                                    
                                       H
                                       (
                                       
                                          A
                                          L
                                       
                                       )
                                    
                                 
                                 ,
                                 
                                    H
                                    
                                       H
                                       (
                                       
                                          D
                                          j
                                       
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    H
                                    
                                       H
                                       (
                                       
                                          D
                                          1
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 =
                                 >
                                 
                                    
                                       H
                                       (
                                       
                                          A
                                          L
                                       
                                       )
                                    
                                    ˆ
                                 
                                 ,
                                 
                                    
                                       H
                                       (
                                       
                                          D
                                          j
                                       
                                       )
                                    
                                    ˆ
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       H
                                       (
                                       
                                          D
                                          1
                                       
                                       )
                                    
                                    ˆ
                                 
                              
                           
                        It gives a better representation of multivariate multiscale entropy (MME) that appears as per clinically essential diagnostic signal information contained in different matrices. In this type of representation, the entropy information is expected to appear in accordance with clinical importance: 
                           
                              
                                 H
                                 (
                                 
                                    A
                                    L
                                 
                                 )
                              
                              ˆ
                           
                           >
                           
                              
                                 H
                                 (
                                 
                                    D
                                    j
                                 
                                 )
                              
                              ˆ
                           
                           >
                           ⋯
                           >
                           
                              
                                 H
                                 (
                                 
                                    D
                                    1
                                 
                                 )
                              
                              ˆ
                           
                        .

Due to the application of wavelet transform on ECG signals, clinically essential local wave components get grossly segmented into different subbands [18,19]. Most of the signal energy appears in low frequency subbands because of lower frequency components. Multivariate multiscale matrices with these subbands contain vital diagnostic components due to the presence of local waves. It is expected that, the MME would preserve these pathological signatures. To preserve these components, selection of singular values for different multiscale matrices may be further justified, if it also considers the energy content. It is proposed to assign energy based weights to decide the number of singular values for different matrices. These weights are computed dynamically in terms of L2-norm for approximation and details matrices as
                           
                              (16)
                              
                                 
                                    Θ
                                    
                                       
                                          A
                                          L
                                       
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       |
                                       
                                          
                                             
                                                
                                                   A
                                                   L
                                                
                                             
                                          
                                       
                                       |
                                       
                                          |
                                          2
                                       
                                    
                                    
                                       |
                                       |
                                       
                                          
                                             
                                                
                                                   A
                                                   L
                                                
                                             
                                          
                                       
                                       |
                                       
                                          |
                                          2
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          L
                                       
                                       |
                                       |
                                       
                                          
                                             
                                                
                                                   D
                                                   j
                                                
                                             
                                          
                                       
                                       |
                                       
                                          |
                                          2
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    Θ
                                    
                                       
                                          D
                                          j
                                       
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       |
                                       
                                          
                                             
                                                
                                                   D
                                                   j
                                                
                                             
                                          
                                       
                                       |
                                       
                                          |
                                          2
                                       
                                    
                                    
                                       |
                                       |
                                       
                                          
                                             
                                                
                                                   A
                                                   L
                                                
                                             
                                          
                                       
                                       |
                                       
                                          |
                                          2
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          L
                                       
                                       |
                                       |
                                       
                                          
                                             
                                                
                                                   D
                                                   j
                                                
                                             
                                          
                                       
                                       |
                                       
                                          |
                                          2
                                       
                                    
                                 
                              
                           
                        where 
                           
                              Θ
                              
                                 
                                    A
                                    L
                                 
                              
                           
                         and 
                           
                              Θ
                              
                                 
                                    D
                                    j
                                 
                              
                           
                         are weights for approximation and details matrices respectively. The first singular value represents most of the signal energy in higher level matrices. Because they are having more regular low frequency components [20], P-wave T-wave and lower frequency part of the QRS-complexes. To preserve these clinical information, it is proposed to derive the number of singular values as
                           
                              (18)
                              
                                 
                                    k
                                    
                                       
                                          A
                                          L
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             Θ
                                             
                                                
                                                   A
                                                   L
                                                
                                             
                                          
                                          ·
                                          
                                             H
                                             
                                                H
                                                (
                                                
                                                   A
                                                   L
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ×
                                 rank
                                 (
                                 
                                    
                                       
                                          
                                             A
                                             L
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    k
                                    
                                       
                                          D
                                          j
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             Θ
                                             
                                                
                                                   D
                                                   j
                                                
                                             
                                          
                                          ·
                                          
                                             H
                                             
                                                H
                                                (
                                                
                                                   D
                                                   j
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ×
                                 rank
                                 (
                                 
                                    
                                       
                                          
                                             D
                                             j
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        The weights 
                           
                              Θ
                              
                                 
                                    A
                                    L
                                 
                              
                           
                         and 
                           
                              Θ
                              
                                 
                                    D
                                    j
                                 
                              
                           
                         are higher for higher level multiscale matrices and lower for lower level matrices due to signal energy content. A similar contribution is expected from the factors H/H(A
                        
                           L
                        ) and H/H(D
                        
                           j
                        ). It is due to the information content in terms of entropies. The matrices which contain the coefficients of lower frequency subbands will show higher weight factors. The reason behind this is the more regular local wave components in higher level matrices in comparison to stochastic components in the lower level matrices.

The fidelity of physiological signal is most important for its clinical use. The processed signal should carry relevant diagnostic information available in original. The errors between original and reconstructed matrices at wavelet scales are termed as multiscale multivariate errors. It is proposed to evaluate multivariate clinical distortion (MCD) measure using the weighted multiscale multivariate error (WMME) based on multiscale Frobenius norm of original and reconstructed multiscale multivariate matrices. It is given as
                           
                              (20)
                              
                                 ξ
                                 (
                                 
                                    A
                                    L
                                 
                                 )
                                 =
                                 
                                    Θ
                                    
                                       
                                          A
                                          L
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      |
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                                  L
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                      
                                                         |
                                                         F
                                                      
                                                      −
                                                      |
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        A
                                                                        L
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ˆ
                                                      
                                                      |
                                                      
                                                         |
                                                         F
                                                      
                                                      )
                                                   
                                                   
                                                      |
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                                  L
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                      
                                                         |
                                                         F
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 ξ
                                 (
                                 
                                    D
                                    j
                                 
                                 )
                                 =
                                 
                                    Θ
                                    
                                       
                                          D
                                          j
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      |
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                      
                                                         |
                                                         F
                                                      
                                                      −
                                                      |
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        D
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ˆ
                                                      
                                                      |
                                                      
                                                         |
                                                         F
                                                      
                                                      )
                                                   
                                                   
                                                      |
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                      
                                                         |
                                                         F
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ξ(A
                        
                           L
                        ) and ξ(D
                        
                           j
                        ) are weighted multiscale multivariate (WMME) error of approximation and details respectively. The multivariate clinical distortion (MCD) measure is derived as
                           
                              (22)
                              
                                 MCD
                                 =
                                 
                                    1
                                    
                                       L
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ξ
                                          (
                                          
                                             A
                                             L
                                          
                                          )
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             L
                                          
                                          ξ
                                          (
                                          
                                             D
                                             j
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        A lower MCD value is expected to represent better reconstructed signal quality. The reconstructed signal quality using proposed method can be ascertained if qualitative and quantitative analysis is compared with existing error measures in literature. The signal distortion measures for univariate data existing in literature such as the percentage root mean square difference (PRD), the normalized root mean square error (NRMSE), normalized maximum absolute error (NMAX), the wavelet energy based diagnostic distortion measure (WEDD) [21] are evaluated. The subjective quality is evaluated with a mean opinion score (MOS) [22].

@&#RESULTS AND DISCUSSION@&#

The proposed method is evaluated with multilead ECG signals from PTB diagnostic ECG database [23,24] and CSE multilead measurement library [25]. From PTB database, data sets for myocardial infarction (MI): 148, cardiomyopathy (CM): 18, dysrhythmia (DM): 14, myocardial hypertrophy (MH): 7, myocarditis (MC): 4 and normal healthy control (HC): 52 are taken for experiments. From CSE database, 20 data sets M01-001 to M01-020 are considered. Multivariate multiscale matrices are created for approximation and details, as described in the method section, applying six level wavelet decomposition, using Daubechies 9/7 biorthogonal wavelet basis. The level of wavelet decomposition depends on sampling frequency, F
                     
                        s
                     , of ECG signal and is given as L
                     =[log
                     2(F
                     
                        s
                     
                     −2.96)] [19]. The frequency range of these decomposed wavelet subbands includes main features of an ECG signal. The Daubechies 9/7 biorthogonal wavelet basis is used because of its linear phase, symmetry and good performance for ECG signals [19]. For six level wavelet decomposition, it gives multivariate matrix A6
                      at approximation scale and six multivariate matrices D6
                     , D5
                     , D4
                     , D3
                     , D2
                      and D1
                      at details scales. Truncated SVD is applied to these matrices to reduce their ranks suitably so that the error introduced is minimized.

The diagnostic quality of processed signals depends on the selection of singular values for multiscale multivariate matrices. The selection of singular values for different matrices is based on MME and energy. MME is derived as a scaled version of Shannon's entropy, which represent the information content representing local waves. For matrices at different scales, MME and energy based selection of singular values help minimizing reconstruction errors. The number of singular values may vary from matrix to matrix due to signal energy and information content. Higher MME represents higher clinical information rather than randomness. The energy based weights contribute energies of local waves at different scales. The low frequency clinical components like P-wave, T-wave and lower frequency of QRS-complex appear in matrices A6
                        , D6
                         and D5
                        . The MME values are higher for them. The higher number of singular values are selected for these matrices which help preserve clinical information. In matrices D3
                        , D2
                         and D1
                        , stochastic components are dominant and MME values are lower. Similarly, lower multiscale energy values are found in these scales. This selects a minimum number of SV to retain signal energy.

In Fig. 1
                        , multiscale Frobenius norms and number of singular values for multiscale matrices are plotted for 20 CSE data sets. The data sets considered for evaluation include normal and pathological cases. The mean values are shown with standard deviations. For higher level matrices, A6
                        , D6
                         and D5
                        , mean energy levels are higher. To preserve signal information, the number of singular values required are higher. The mean of singular values are 10.3, 8.9 and 9.1 for A6
                        , D6
                         and D5
                         respectively. Mathematical rounding operation is performed to get the integer number for SV. For matrices like, D3
                        , D2
                         and D1
                        , signal energies are minimal and less number of singular values can capture clinical information. The higher level matrices show higher standard deviation due to variation of energy levels. The lower level matrices contain noise and minimum signal energy for which the standard deviation is also lower.

To evaluate the proposed method, normal healthy control data sets are considered from PTB database. Gaussian noise with zero mean and unity variance is added in these signals. Due to page limitation only limited results are produced. In Fig. 2
                        , the results are shown for healthy control signals from PTB Diagnostic ECG Database, dataset:patient172/s0304lre. The signals have been corrupted with Gaussian noise and corresponding scaled MME are shown. In Fig. 2(a), lead-II ECG signal (healthy control) is plotted. The scaled MME is plotted in Fig. 2(e). The MME is higher for matrices A6
                        , D6
                         and D5
                         compared to D4
                        , D3
                        , D2
                         and D1
                        . This may be due to the more regular signal components (local waves) present in these matrices due to wavelet segmentation. These grossly segmented P-waves, QRS-complexes and T-waves are the most desired clinical information. The matrices having lower order wavelet subband coefficients contain more random components. The scaled MME is lower for these matrices. If uncorrelated Gaussian noise is considered, as shown in Fig. 2(b), the scaled MME is almost constant (Fig. 2(e)). This is due to the stochastic component that has been segmented at different matrices. When the Gaussian noise is added to healthy control signal, as in Fig. 2(c), still scaled MME shows higher values for A6
                        , D6
                         and D5
                         matrices (Fig. 2(e)) compared to D4
                        , D3
                        , D2
                         and D1
                         matrices. This proves that proposed MME represent actual clinical information even in a noisy environment. MME values are low and constant in D3
                        , D2
                         and D1
                         matrices (Fig. 2(e)) due to more stochastic components that are added to these scales. Scaled MME is invariant to noise and represents the information content about the signal at different scales. Fig. 2(d) shows the reconstructed signal using proposed multiscale multivariate entropy based multiscale truncated SVD method. It is observed that the clinical components with desired “PQRST” morphologies are preserved. This may be due to shrinking of singular values in optimal sense.

The real time multilead ECG recordings may contain normal as well as pathological data. It is necessary to evaluate the proposed method under pathological conditions. To evaluate the proposed method for pathological cases, data sets are considered from PTB database which include myocardial infarction (MI): 148, cardiomyopathy (CM): 18, dysrhythmia (DM): 14, myocardial hypertrophy (MH): 7 and myocarditis (MC): 4. Results for pathological data sets such as myocardial infarction (MI) (patient045/s0147lre), cardiomyopathy (CM)(patient256/s0492rem), dysrhythmia (DM)(patient259/s0495re), myocardial hypertrophy (MH) (patient250/s0485re), myocarditis (MC) (patient249/s0484re) and normal healthy control (HC) (patient131/s0273lre) are shown in Fig. 3
                        . Modified multivariate multiscale Shannon entropy values are plotted (Fig. 3) for various pathology. In the figures (right side) original and reconstructed lead-II ECG signals are shown for different diseases. The MME captures the signal information and accordingly singular values are selected for multiscale multivariate matrices. The record, patient045/s0147lre, is related to MI pathology which shows a pathological Q-wave. Due to this, QRS-complexes are distorted and also give high frequency components. During multiscale multivariate matrices formation, due to gross wavelet segmentation, these diagnostically important clinical components appear in lower-order subband matrices which contain higher-frequency parts of multilead signals [19]. Thus, the multiscale multivariate entropy captures these information in related multivariate matrices, like D3
                        , D2
                         and D1
                        , with higher values. Similar, patterns of MME are noticed for other pathological cases, dysrhythmia (patient259/s0495re), myocardial hypertrophy (patient250/s0485re) and myocarditis (patient249/s0484re). In case of cardiomyopathy (patient256/s0492rem), high frequency QRS-complexes are disturbed and it forms pathological downward sloping low frequency signal components. The higher frequency parts of QRS-complexes are lost. This may be the reason for low entropy values for matrices containing higher-frequency subbands. The proposed MME based multiscale truncated SVD selects suitable ranks for multiscale matrices. This is due to the signal information captured by proposed multiscale multivariate entropy at different scales. The reconstructed signals (lead-II of all the cases) show the presence of all the clinically essential diagnostic local wave components in the processed signals. The satisfactory reconstructions of these pathological signals prove the ability of proposed method to retain clinical information.

To score the quality of processed signals, a few commonly used error measures along with proposed MCD measure are shown in Table 1
                        . The PRD, NRMSE, NMAX, WEDD are averaged over all the leads whereas MCD represents multivariate distortion. The lowest average PRD, average NRMSE, average NMAX, average WEDD values are 5.88%, 0.0059, 0.0653 and 1.07% respectively for myocarditis. The highest average PRD and average WEDD values are 11.40% and 5.51% for cardiomyopathy. The values of distortion metrics evaluated through these univariate methods fall under excellent and very good categories [21], [22]. The lowest and the highest MCD values are 1.40% and 2.27% respectively.

The subjective quality of the reconstructed signals are evaluated by semi-blind mean opinion score (MOS). It gives the true index of the signals [19,22] which is based on expert opinions. One cardiac expert (doctor) and two biomedical signal processing experts reviewed each diagnostic features, P-wave, QRS-complex, ST-segment and T-wave of the original and the reconstructed signals in the quality groups, 1 (bad), 2 (almost tolerable), 3 (tolerable), 4 (good) and 5 (excellent) [22]. The average gives the mean opinion score (MOS). The visual quality of processed signals in terms of MOS errors from experts is acceptable. The highest MOS error value is 7.84% and the lowest is 3.34% for dysrhythmia and myocardial infarction respectively. The quality of all these processed pathological signals fall under excellent category [21,22].

The performance of the proposed information theoretic multiscale truncated SVD for ECG is compared using signal distortion measures like PRD, WEDD and MCD. Also, to ensure the quality of the processed signals, mean opinion scores (MOS) are evaluated. Wei et al. have used truncated SVD to process ECG signals from MIT-BIH database [4]. For a pathological case, premature ventricular contraction (PVC, 119.dat), PRD value 6.15% is recorded. For left bundle branch block cases (records 109.dat and 111.dat) PRD values are 9.57% and 9.66% respectively. But WEDD and MOS values are not evaluated. These performance measures are more relevant to ECG signals. The proposed method gives PRD, WEDD, MCD and MOS values 5.88%, 1.07%, 1.94% and 5.0% respectively for MC pathology. In terms of WEDD and MOS, proposed method is found better. Padhy et al. reported average PRD value 3.05% for a 8-lead ECG system [9]. But in most of the pathological cases, WEDD values are higher than the proposed method. Sharma et al. have evaluated PRD value 2.09%, WEDD value 4.19% and MOS value 5.56% using multiscale principal component analysis (MSPCA) based method [19]. But it did not consider pathological cases. The performance of the proposed method for pathological data has outperformed MSPCA based method since in most of the cases WEDD and MOS values (ref. Table 1) are found low.

@&#CONCLUSION@&#

In this work the MME is defined by scaling Shannon entropy in multiscale SVD domain. Based on energy weighted MME, suitable shrinkage of singular values is achieved for multiscale SVD. It captures information of diagnostically important local waves appearing at different scales. To access the clinical distortion introduced due to rank reduction at multiple scales, a multivariate clinical distortion measure is introduced and compared with the existing distortion metrics. To ensure the quality of processed signals, experts opinions are recorded as MOS. The proposed method may be further extended for multivariate denoising, multilead ECG data compression and classification of different pathologies.

@&#ACKNOWLEDGEMENTS@&#

Author is grateful to Editor-in-Chief for constant encouragement and would like to thank anonymous reviewers for their suggestions to improve the quality of this manuscript.

@&#REFERENCES@&#

