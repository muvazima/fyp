@&#MAIN-TITLE@&#A fully automatic 2D segmentation method for uterine fibroid in MRgFUS treatment evaluation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The proposed method performs a fully automatic uterus and fibroids segmentation.


                        
                        
                           
                           We provide the boundary and volume of ablated fibroid regions and uterus.


                        
                        
                           
                           Our approach is based on FCM and iterative optimal threshold selection algorithms.


                        
                        
                           
                           This solution could optimize the current operative MRgFUS methodology.


                        
                        
                           
                           Our approach can improve the follow-up of patients undergone MRgFUS treatments.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Automatic segmentation

Fuzzy C-Means clustering

Adaptive thresholding

MRgFUS treatment

Uterine fibroids

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Leiomyomas of the uterus, commonly known as uterine fibroids, are benign tumors occurring in women during reproductive years. One approach to this disease is MRgFUS, a non-invasive treatment that uses thermal ablation obtained by using the sonication process [1]. In fact, a High Intensity Focused Ultrasound (HIFU) beam on the affected area [2] reaches temperatures above 50°C, thereby causing protein coagulation and, consequently, tissue necrosis [3]. In fact, the overall therapy may involve multiple sessions or additional leiomyoma-related surgical interventions (such as myomectomy or hysterectomy). Therefore, the tumor recession needs to be followed quantitatively to assess the efficacy of the treatment.

In MRgFUS treatments, MR image analysis is required in fibroid diagnosis, in the subsequent treatment phases, and in patient follow-up. In a pre-treatment phase, the uterus must be identified by the selection of some control points needed for the machine calibration (InSightec ExAblate 2100 integrated with the MR scanner GE Signa HTxt), for the treatment planning and for the localization, by means of fiducial markers, of the uterus, of the fibroids and of the neighboring organs to be protected by ultrasound. In a post-treatment phase, however, segmentation is used to estimate the uterus and ablated fibroid volumes.

Nowadays, organ segmentation is performed manually, through time-consuming and operator-dependent procedures. Operator dependence is critical in terms of result reproducibility, while long treatment planning and execution times require very collaborative and motionless patients during the entire procedure (so as not to affect the uterus Region of Interest (ROI) and fibroid Region of Treatment (ROT) positions) and can have a negative impact on the optimization of both machine-time and operator-time.

In this paper, we propose a novel method based on Fuzzy C-Means clustering and iterative optimal threshold selection algorithms for the fully automatic segmentation of the uterus and the fibroids within it. The proposed approach can be used to objectively evaluate the effectiveness of the MRgFUS treatment by automatically calculating the boundary and volume of the treated region (ROT). Moreover, as reported in [4], accurate assessment of the uterus (ROI) volume is very important in the follow-up of the treatment response. This solution could provide a valid support to healthcare operators (i.e. physicians, radiologists) making it possible to improve the current operative methodology.

The research associated with the treatment of uterine fibroids was approved by the ethics committee, and has no implication on patient treatment. The proposed image analysis and segmentation are performed off-line and therefore do not change the current treatment protocol.

The manuscript is structured as follows: Section 2 provides the literature background concerning uterus/fibroid segmentation approaches; Section 3 gives some theoretical explanation about the algorithms used; Section 4 describes the proposed automatic segmentation method; Section 5 illustrates the experimental results achieved in the segmentation tests; finally, discussions and conclusions are provided in Sections 6 and 7, respectively.

@&#BACKGROUND@&#

Uterus and uterine fibroid segmentation from MR images is a new research field [4], as well as a task of fundamental importance in fibroid treatment with MRgFUS technology. In the literature there are only few works related to this study, mainly presenting semi-automated approaches. These related works are briefly described and commented below.

In [4] a method for automatic uterus segmentation using Fuzzy C-Means algorithm (FCM) [5] on Contrast Enhanced T1-Weighted MR images is presented. After this initial result, a segmentation refinement is applied through some morphological operations and a global thresholding on the corresponding T1-Weighted sequence (after a registration action) to eliminate the remaining anatomical ambiguities (i.e. colon).

Starting from the uterus segmentation achieved by [4], an automated fibroid segmentation approach is described in [6]. It is again based on an alternative formulation of clustering, called Modified Possibilistic Fuzzy C-Means (MPFCM) [7]. Finally, after another dataset registration with T2-Weighted images, post-processing is required to remove incorrectly segmented fibroids.

In [8] the authors present an interactive method composed of an initial automatic segmentation based on the level set 
                     [9] and a subsequent step that requires interactive manual feedback from an expert user to refine the output generated by the first stage. The resulting tool is, therefore, semi-automatic as it is still operator-dependent during the phase of ROI contour improvement.

In [10] a method based on the level-set is proposed, where the active contours of ROI evolve following the trend of a signed function, just for the segmentation of uterine fibroids and the subsequent volume measurement. The overall method combines two algorithms in sequence: Fast Marching Level Set and Laplacian Level Set 
                     [11,12]. Furthermore, the approach is semi-automatic because, before applying the Fast Marching Level Set, it requires seed-point selection within the regions that identify the fibroids. At this point, a rough segmentation is obtained that, subsequently, is refined through the Laplacian Level Set operation.

The authors of [13] present a two-step method for segmentation of uterine fibroids. After an initial manual region detection, a coarse segmentation is achieved using the Chan–Vese level set method 
                     [14]. Then a segmentation refinement based on the prior-shape model 
                     [15] is applied, by relying on training data concerning an ellipse model.

The authors of [16] propose a semi-automatic approach based on multi-seed region growing segmentation [17] of uterine fibroids. Indeed, it is necessary that the expert manually selects a seed point for each fibroid. A qualitative visual evaluation of the reported images shows that this solution provides good segmentation results, but no quantitative measures are reported.

In [18] an approach for the automatic segmentation of uterine fibroids with the relative ROI volume measurement is described. After reducing the granular noise (speckle noise) in MR images using the Speckle Reducing Anisotropic Diffusion (SRAD) method [19], the watershed algorithm 
                     [20] is applied. This algorithm considers the gradient image as a topological surface composed of a succession of peaks, valleys, and dams representing the boundaries between regions. To overcome the problem of the over-segmentation, some post-processing operations are applied, including morphological erosion and global thresholding using an iterative method for the automatic selection of the threshold.

Finally, in [21] an automatic method for treated fibroid segmentation is proposed. Both the post-operative contrast-enhanced MR image stack (interpolated to a 3D volume) and the treatment plan (file that stores the sonication cells used during the MRgFUS treatment) are required. In fact, the coordinates and the size of each treatment cell are exploited as a priori information for fibroid localization. In the first step, a surface model is created on the sonication cell data and it is deformed with an Active Shape Model (ASM) [22] by moving the mesh nodes towards the strongest image edge gradients. Finally, the voxels are classified in the treated (NonPerfused Volume, NPV) and the untreated (Perfused Volume, PV) tissues, by an Expectation Maximization (EM) [23] segmentation algorithm.

In the literature there are no edge-based approaches because these methods fail to effectively segment uterine fibroids as they could have calcified and infarct regions (as reported in [13]).

In fact, a fully automatic approach for the segmentation of the uterus (ROI) as well as the fibroids within it (ROT) is provided. ROI segmentation is based on Fuzzy C-Means clustering 
                     [5], while the subsequent ROT segmentation phase is performed by global thresholding through an optimized version of the iterative optimal threshold selection algorithm [24]. Indeed, in the post-operative contrast-enhanced T1-Weighted MR images, the ablated tissue does not absorb the contrast medium and appears hypo-intense with respect to the uterus. The treated regions appear very irregular or heterogeneous [25], and accordingly the segmentation task must be performed precisely.

In this context, speed and computational efficiency are demanding factors for real time performance during treatment planning and execution. Thereby, the developed algorithms and processing operations must be as simple as possible, in order to meet time constraints but without forgetting result precision.


                        Fuzzy C-Means (FCM) [5] cluster analysis is an iterative algorithm for unsupervised clustering (without training-set), which divides a dataset into groups identified by a centroid. The goal of the classic (hard) C-Means (also called K-Means) algorithm is to divide a set 
                           X
                           =
                           {
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ,
                           
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                           
                              
                                 x
                              
                              
                                 N
                              
                           
                           }
                         of 
                           N
                         objects (statistical sample represented as vectors belonging to 
                           n
                        -dimensional Euclidean space 
                           
                              
                                 ℝ
                              
                              n
                           
                        ) into 
                           C
                         clusters (partitions, where: 
                           C
                           ∈
                           ℕ
                           ,
                           
                           
                           2
                           ≤
                           C
                           <
                           N
                        ).

The fuzzy version achieves better results than the crisp C-Means version, as it has greater flexibility and adaptation in various ROI form segmentation and, especially, capturing boundaries properly. In fact, thanks to the introduction of “fuzziness”, the FCM algorithm manages the inherent uncertainty of the MRI acquisition process, as non-uniformities or artefacts, which may affect the following classification step of the whole dataset.

The crisp clusters family is represented by a 
                           C
                        -uple 
                           P
                           =
                           {
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                           
                              
                                 Y
                              
                              
                                 C
                              
                           
                           }
                         of 
                           X
                         subsets that satisfy the following conditions (1):
                           
                              (1)
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                ∅
                                                ⊂
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⊂
                                                X
                                                ,
                                                
                                                ∀
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   ∩
                                                   
                                                
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                =
                                                ∅
                                                ,
                                                
                                                ∀
                                                i
                                                ≠
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∪
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   C
                                                
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                X
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

A hard partition 
                           P
                         is represented by a matrix 
                           U
                           =
                           
                              [
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       k
                                    
                                 
                              
                              ]
                           
                           ∈
                           
                              
                                 ℝ
                              
                              
                                 C
                                 ×
                                 N
                              
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                           C
                           ;
                           
                           k
                           =
                           1
                           ,
                           …
                           ,
                           N
                        , whose generic element 
                           
                              
                                 u
                              
                              
                                 i
                                 k
                              
                           
                           ∈
                           {
                           0
                           ,
                           1
                           }
                         is the exclusive membership of the 
                           k
                        th element 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         to the 
                           i
                        th cluster 
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                        .

A fuzzy partition 
                           P
                         is defined, instead, as a fuzzy sets family 
                           P
                           =
                           {
                           
                              
                                 Y
                              
                              
                                 1
                              
                           
                           ,
                           
                           
                              
                                 Y
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                           
                              
                                 Y
                              
                              
                                 C
                              
                           
                           }
                         such that each object can have a partial membership to multiple clusters [26]. Generalizing, the matrix 
                           U
                           =
                           
                              [
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       k
                                    
                                 
                              
                              ]
                           
                           ∈
                           
                              
                                 ℝ
                              
                              
                                 C
                                 ×
                                 N
                              
                           
                         defines a 
                           C
                        -fuzzy partition of set 
                           X
                         through 
                           C
                         membership functions 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           :
                           
                           X
                           →
                           [
                           0
                           ,
                           1
                           ]
                        , whose values 
                           
                              
                                 u
                              
                              
                                 i
                                 k
                              
                           
                           ≜
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                              
                              )
                           
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                         are interpreted as membership degrees of each element 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         to the 
                           i
                        th fuzzy set (cluster) 
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                         and have to satisfy Eq. (2):
                           
                              (2)
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                ≤
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   C
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                =
                                                1
                                                ,
                                                
                                                ∀
                                                k
                                                ∈
                                                [
                                                1
                                                ,
                                                N
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                                <
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                <
                                                N
                                                ,
                                                
                                                ∀
                                                i
                                                ∈
                                                [
                                                1
                                                ,
                                                C
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In conclusion, the sets of all hard and fuzzy 
                           C
                        -partitions of 
                           X
                         are respectively defined by Eqs. (3) and (4):
                           
                              (3)
                              
                                 
                                    
                                       M
                                    
                                    
                                       c
                                       r
                                       i
                                       s
                                       p
                                    
                                    
                                       (
                                       C
                                       )
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       U
                                       ∈
                                       
                                          
                                             ℝ
                                          
                                          
                                             C
                                             ×
                                             N
                                          
                                       
                                       :
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    }
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       M
                                    
                                    
                                       f
                                       u
                                       z
                                       z
                                       y
                                    
                                    
                                       (
                                       C
                                       )
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       U
                                       ∈
                                       
                                          
                                             ℝ
                                          
                                          
                                             C
                                             ×
                                             N
                                          
                                       
                                       :
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       ∈
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                    }
                                 
                              
                           
                        where 
                           
                              
                                 M
                              
                              
                                 f
                                 u
                                 z
                                 z
                                 y
                              
                              
                                 (
                                 C
                                 )
                              
                           
                         includes and enhances information provided by 
                           
                              
                                 M
                              
                              
                                 c
                                 r
                                 i
                                 s
                                 p
                              
                              
                                 (
                                 C
                                 )
                              
                           
                        .

The Fuzzy C-Means algorithm assigns to sample 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         the membership function values using the relative distance of 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         from the 
                           C
                         prototype points 
                           V
                           =
                           {
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                           
                              
                                 v
                              
                              
                                 C
                              
                           
                           }
                        , which identify centroids of the various clusters (centers of mass). Thus, clustering may be rewritten as an optimization problem associated with the following objective function (5) (generalized least-squared errors functional):
                           
                              (5)
                              
                                 
                                    
                                       J
                                    
                                    
                                       m
                                    
                                 
                                 
                                    (
                                    
                                       U
                                       ,
                                       V
                                       ;
                                       X
                                    
                                    )
                                 
                                 
                                 
                                    
                                       
                                          d
                                          e
                                          f
                                       
                                       
                                          =
                                       
                                    
                                    
                                       ̲
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    C
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       )
                                    
                                    m
                                 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       k
                                    
                                 
                              
                           
                        where


                        
                           m
                         is the fuzzification constant (weighting exponent: 
                           1
                           ≤
                           m
                           <
                           ∞
                        ) that determines the fuzziness degree of the classification process. If 
                           m
                           =
                           1
                        , the FCM algorithm approximates hard C-Means. In general, the higher the 
                           m
                         value, the greater will be the fuzziness degree (most commonly: 
                           m
                           =
                           2
                        );


                        
                           U
                         is the fuzzy 
                           C
                        -partition of set 
                           X
                         (
                           U
                           ∈
                           
                              
                                 M
                              
                              
                                 f
                                 u
                                 z
                                 z
                                 y
                              
                              
                                 (
                                 C
                                 )
                              
                           
                        );


                        
                           
                              
                                 d
                              
                              
                                 i
                                 k
                              
                           
                           =
                           ∥
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           −
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           
                              
                                 ∥
                              
                              2
                           
                         is the squared distance between 
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        , computed through an induced norm 
                           ∥
                           ⋅
                           ∥
                         on 
                           
                              
                                 ℝ
                              
                              n
                           
                         (usually Euclidean Norm).

The aim is therefore to partition the set 
                           X
                         by finding pairs 
                           (
                           
                              U
                              ^
                           
                           ,
                           
                              V
                              ^
                           
                           )
                         that minimize locally 
                           
                              
                                 J
                              
                              
                                 m
                              
                           
                        .

Global thresholding represents the most simple and efficient segmentation technique when intensity distributions of objects and background pixels are distinct enough, i.e. images that are characterized by a bimodal histogram. Medical images usually present high variability due to various conditions of acquisition. Thereby, an algorithm capable of estimating automatically and dynamically an adaptive threshold value 
                           T
                         for each image of the input domain is required.

As described in [24], the objective is to choose an optimal threshold 
                           
                              
                                 T
                              
                              
                                 o
                                 p
                                 t
                              
                           
                         by an iterative process that updates 
                           
                              
                                 T
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         after each iteration 
                           (
                           t
                           )
                        , until the convergence condition is achieved. 
                           
                              
                                 T
                              
                              
                                 (
                                 0
                                 )
                              
                           
                         is initialized to a value 
                           
                              
                                 T
                              
                              
                                 i
                                 n
                                 i
                                 t
                              
                           
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                        , where the global mean intensity of the image 
                           I
                           ≜
                           f
                           (
                           x
                           ,
                           y
                           )
                         represents a good initial approximation: 
                           
                              
                                 μ
                              
                              
                                 G
                                 l
                                 o
                                 b
                                 a
                                 l
                              
                           
                           =
                           
                              ∑
                              
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 I
                              
                           
                           f
                           (
                           i
                           ,
                           j
                           )
                           /
                           |
                           I
                           |
                        .

At generic step 
                           (
                           t
                           )
                        , input image 
                           I
                         segmentation using global thresholding with 
                           
                              
                                 T
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         produces two classes of pixels:
                           
                              (6)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                
                                             
                                             
                                                
                                                   f
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   ≤
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         o
                                                         p
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                
                                             
                                             
                                                
                                                   f
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                   >
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         o
                                                         p
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The aim of the algorithm is to compute, at each step 
                           (
                           t
                           )
                        , the mean intensity values 
                           
                              
                                 μ
                              
                              
                                 1
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and 
                           
                              
                                 μ
                              
                              
                                 2
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         for the pixels in 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        , respectively as in Eq. (7):
                           
                              (7)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       f
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    
                                       |
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                       |
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       f
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    
                                       |
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                 
                                 .
                              
                           
                        
                     

Now, the next threshold value 
                           
                              
                                 T
                              
                              
                                 (
                                 t
                                 +
                                 1
                                 )
                              
                           
                         is updated by average 
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                         as in (8):
                           
                              (8)
                              
                                 
                                    
                                       T
                                    
                                    
                                       (
                                       t
                                       +
                                       1
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             1
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                    2
                                 
                                 .
                              
                           
                        
                     

The convergence of procedure is defined by the parameter 
                           Δ
                           T
                        , which controls result precision and number of iterations of the algorithm execution.

The successive thresholding operations described above are equivalent to divide through 
                           
                              
                                 T
                              
                              
                                 o
                                 p
                                 t
                              
                           
                         the global histogram 
                           H
                           
                           ≜
                           h
                           (
                           
                              
                                 r
                              
                              
                                 k
                              
                           
                           )
                        , where 
                           
                              
                                 r
                              
                              
                                 k
                              
                           
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                         is the 
                           k
                        th intensity level, into two sub-histograms 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         (darker regions) and 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                         (brighter regions) defined as
                           
                              (9)
                              
                                 H
                                 :
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ≤
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         o
                                                         p
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   >
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         o
                                                         p
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

All computations can be executed more efficiently by operating on the input image histogram only, as described in Section 4.2.1 and in Algorithm 2.

The proposed automatic segmentation method, based on Fuzzy C-Means clustering and iterative optimal threshold selection algorithms, is completely autonomous and operator independent. 
                     Fig. 1 depicts the overall flow diagram of the proposed method.

In the proposed approach, the segmentation process is performed in two phases:
                        
                           1.
                           uterus region segmentation (ROI): it is a useful operation in the MRgFUS pre-treatment planning process, supporting the calibration of the FUS machine, and in the subsequent uterine fibroid segmentation for treatment response evaluation [4];

uterine fibroid segmentation (ROT): from the segmented ROI, the particular characteristics of the region are identified using an adaptive thresholding applied on gray levels, because fibroids have intensity values much lower than the uterus pixels.

The proposed method operates on MR datasets that represent sagittal sections, views that are mostly used in the pre-treatment phase as well as in the post-treatment evaluation phase, where the fibroid NPV (NonPerfused Volume) is computed [25]. The proposed method was developed using the MatLab® environment, and no external optimization package was used.

The ROI segmentation phase can be divided into three sub-phases (
                        Fig. 2): pre-processing, Fuzzy C-Means clustering and post-processing.

To normalize the intensity values of the images coming from different MR datasets and, thus, define a domain represented by input data with conditions characterized by a high degree of similarity, it is essential to perform some pre-processing operations. It will, therefore, produce datasets characterized by a contrast range in such a way as to be functional for the subsequent clustering phase.

The pre-processing steps, inspired by the procedure used in [27] for lesion segmentation into DWI MR brain images, are the following:
                              
                                 •
                                 image normalization through an intensity depth conversion, from 16-bit integer DICOM encoding to double precision into 
                                       [
                                       0
                                       ,
                                       
                                       1
                                       ]
                                     range;

smoothing operation performed using an average filter, in order to remove the image noise due to MRI acquisition (i.e. due to magnetic field non-uniformities) and to balance out intensity level differences between neighboring pixels;

background elimination using global thresholding with 
                                       T
                                       =
                                       0.01
                                     (experimental value suitable for all the datasets). With this thresholding operation, the following clustering results are improved, because background values will be classified more easily within the same cluster;

expansion of gray level range to allow a better discrimination during the next stage of clustering based on intensity values. This is done through a Gamma transformation according to the power-law relationship (10), with 
                                       c
                                       =
                                       1
                                     and 
                                       γ
                                       =
                                       0.4
                                    . As described in [28], power-law transformations with a fractional exponent are widely used for image contrast manipulation in MRI


                                    
                                       r
                                     is the initial pixel value;


                                    
                                       s
                                     is the pixel value after the transformation.

By comparing results by varying the 
                              γ
                            exponent, we observed that 
                              γ
                              =
                              0.4
                            provides the best enhancement in terms of contrast and discernable detail, because a decrease of 
                              γ
                            to 
                              0.3
                            implies a little more detail only in the background with a consequent loss of contrast. This results in an image that represents an unsuitable input to the following intensity-based clustering operation. An example of results obtained in the pre-processing steps is shown in 
                           Fig. 3.

Considering the theoretical description of the FCM reported in Section 3.1, the clustering algorithm, used for uterus detection and segmentation, can be outlined as follows (Algorithm 1).
                              Algorithm 1
                              Pseudo-code of the 
                                    Fuzzy
                                  
                                 
                                    C-Means
                                  (
                                    FCM
                                 ) algorithm.
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      Input
                                                   : Set 
                                                      X
                                                      =
                                                      {
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      }
                                                    made up of 
                                                      N
                                                    objects to be divided into 
                                                      C
                                                    
                                                   cluster.
                                                
                                             
                                             
                                                1. Fix 
                                                   
                                                      C
                                                      ,
                                                      m
                                                      ,
                                                      
                                                      ∥
                                                      ⋅
                                                      ∥
                                                      ,
                                                      ε
                                                    (minimum value for the convergence);
                                             
                                             
                                                
                                                   Initialize the matrix 
                                                   
                                                      
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            f
                                                            u
                                                            z
                                                            z
                                                            y
                                                         
                                                         
                                                            (
                                                            C
                                                            )
                                                         
                                                      
                                                    (with random values);
                                             
                                             
                                                
                                                   Select maximum iterations number:
                                                      
                                                      t
                                                      =
                                                      0
                                                      ,
                                                      
                                                      1
                                                      ,
                                                      
                                                      …
                                                      ,
                                                      
                                                      M
                                                      A
                                                      X
                                                      I
                                                      T
                                                   ;
                                             
                                             
                                                2. Initialization of centroid vector (or prototypes) 
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                    
                                                   after the random generation of 
                                                   
                                                      C
                                                    
                                                   values;
                                             
                                             
                                                3. Assign each object 
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                    
                                                   to the cluster whose centroid is the nearest to the object;
                                             
                                             
                                                4. Update the vector 
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               ^
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                    
                                                   and the membership matrix 
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               ^
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                   ;
                                             
                                             
                                                5. Compare 
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               ^
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                    
                                                   with 
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               ^
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                    
                                                   using any convenient matrix norm;
                                             
                                             
                                                5.1 IF 
                                                   
                                                      
                                                         (
                                                         
                                                            ∥
                                                            
                                                               
                                                                  
                                                                     U
                                                                     ^
                                                                  
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     U
                                                                     ^
                                                                  
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                            
                                                            ∥
                                                            <
                                                            ε
                                                         
                                                         )
                                                      
                                                      
                                                      T
                                                      H
                                                      E
                                                      N
                                                   :
                                             
                                             
                                                5.1.1 STOP;
                                             
                                             
                                                5.2 ELSE
                                                
                                             
                                             
                                                5.2.1 Update 
                                                   
                                                      
                                                         
                                                            
                                                               U
                                                               ^
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            
                                                               U
                                                               ^
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                   ;
                                             
                                             
                                                5.2.2 GOTO step (3);
                                             
                                             
                                                
                                                   Output: Fuzzy partition: 
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            f
                                                            u
                                                            z
                                                            z
                                                            y
                                                         
                                                         
                                                            (
                                                            C
                                                            )
                                                         
                                                      
                                                      =
                                                      
                                                         {
                                                         
                                                            U
                                                            ∈
                                                            
                                                               
                                                                  ℝ
                                                               
                                                               
                                                                  C
                                                                  ×
                                                                  N
                                                               
                                                            
                                                            :
                                                            
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                            ∈
                                                            [
                                                            0
                                                            ,
                                                            1
                                                            ]
                                                         
                                                         }
                                                      
                                                   .
                                             
                                          
                                       
                                    
                                 
                              

The clustering is performed on gray levels and, therefore, the cluster number is set to 
                              C
                              =
                              4
                           , a choice justified both by structural and morphological properties of reference images (four different regions can essentially be seen by visual inspection based on intensity) and by experimental results.

Finally, the cluster for the Region of Interest (uterus) is selected from the output of the FCM algorithm. The cluster of interest is, in fact, characterized by the maximum intensity and it is therefore identified by the centroid with the highest value. An application of the clustering operation on an input image is shown in 
                           Fig. 4.

After clustering, a sequence of operations belonging to the mathematical morphology domain [29] applied to binary images with different structuring elements is used, in order to resolve ambiguities resulting from the previous stage and thus improve the quality of segmented ROI. In fact, after having identified the cluster of interest, we must extract the ROI from other image regions belonging, erroneously, to the same cluster because they are characterized by similar gray levels.

The post-processing steps, according to Fig. 2, are explained and justified below:
                              
                                 Step 1. Small disconnected regions (with an area less than a certain number of pixels) are removed through an operation based on connected-component labelling. Some small regions between uterus and colon are thus eliminated, removing undesired connections.

Step 2. A morphological closing operation with a structuring element represented by a 
                                       3
                                       ×
                                       3
                                     pixel square is applied. The purpose is to connect those parts near the ROI contours that were disconnected during the clustering process due to the presence of fibroids. In this way, the next hole filling operation can be correctly applied.

Step 3. A connected-component selection on the binary mask is performed using a Flood-Fill (Seed-Fill) algorithm, which determines the connected area starting from a given node (seed) in a multidimensional array [30]. In order to minimize MRI distortions, the uterus is always positioned near to the isocentre of the magnetic field [31] (i.e. the central zone of the MR imaging field). Hence, the connected-component with the minimum distance from the center of the image and with an area greater than a certain experimental value is selected. Thus, the choice of the correct cluster will only be a spatial position function, without the need to use an approach based on a priori knowledge. It is important to do this before the next step in order to avoid the filling of the holes possibly present in loosely connected regions on the ROI borders, allowing a correct ROI selection based only on the center of mass of each region.

Step 4. Hole filling algorithm (based on morphological reconstruction [29]) is performed in order to remove hollows inside the ROI, probably due to fibroids.

Step 5. A morphological opening operation with a circular structuring element with a 10 pixel radius is applied, in order to eliminate small disconnected regions and to unlink poorly connected regions to the ROI (so the resulting region will have a smoother and natural profile). The opening is performed after hole filling to avoid the risk of disconnecting the ROI contours, characterized by fibroids eventually present in their own proximity. The use of a sufficiently large structuring element makes possible to disconnect regions having intensity values similar to the ROI and joined to it, such as the colon or the nerves of the sacral plexus.

Step 6. The previous step could create several connected-components and it is necessary, therefore, to select only the ROI component. As before, the Flood-Fill algorithm is executed for the identification of connected-components and for the selection of the component whose centroid is the closest to the image center coordinates and whose area is greater than a minimum uterine size.

In this way, we obtain the binary mask that is applied to the original MR image to highlight the achieved ROI. An example of outputs of the various post-processing steps is shown in 
                           Fig. 5.

Segmentation of fibroids (ROT) is performed on the resulting image from the masking of the image with contrast enhancement (after Gamma transformation as introduced in the previous Section 4.1) and the binary mask obtained at the end of uterus segmentation (Phase 1). In this way, it is easier to dynamically select an adaptive threshold and to execute a successful global thresholding. After removing the occurrences of the background pixels from the image histogram, it is basically bimodal (the computed histogram for the example image is reported in 
                        Fig. 6).

This histogram is then separable into two regions by an appropriate adaptive threshold. Indeed, after the FUS treatment, fibroids (hypo-intense regions) appear darker than the rest of the uterus. This happens because the areas that have undergone thermal ablation have a nearly zero contrast medium absorption. After this global thresholding, regions representing uterine fibroids will be segmented from the previously segmented ROI. This phase can be divided into two sub-phases: Automatic Global Thresholding and post-processing (
                        Fig. 7).

In the present method, we developed an optimized version of the Iterative optimal threshold selection algorithm [24], which is more efficient than the approach described in [28], because it operates only on a single histogram. Indeed, the input image histogram is solely calculated at the beginning, and it is processed by successive iterations until the convergence condition is achieved. With respect to the theoretical description of the Iterative optimal threshold selection algorithm reported in Section 3.2, the optimized version of this algorithm, used for uterine fibroid segmentation, can be formalized as follows (Algorithm 2).
                              Algorithm 2
                              Pseudo-code of the iterative optimal threshold selection algorithm.
                                    
                                       
                                          
                                          
                                             
                                                
                                                   Input: Image I.
                                             
                                             
                                                1. Initial estimation value for the threshold 
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                      
                                                      
                                                   (for example, average intensity of the image 
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            G
                                                            l
                                                            o
                                                            b
                                                            a
                                                            l
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  =
                                                                  0
                                                               
                                                               
                                                                  L
                                                                  −
                                                                  1
                                                               
                                                            
                                                            (
                                                            h
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            ⋅
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  =
                                                                  0
                                                               
                                                               
                                                                  L
                                                                  −
                                                                  1
                                                               
                                                            
                                                            h
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                   );
                                             
                                             
                                                
                                                   2. 
                                                   Calculation of histogram 
                                                   
                                                      H
                                                      ≜
                                                      h
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                    
                                                   of the input image 
                                                   
                                                      I
                                                   (with 
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ∈
                                                      [
                                                      0
                                                      ,
                                                      
                                                      L
                                                      −
                                                      1
                                                      ]
                                                   , where 
                                                   
                                                      L
                                                    
                                                   is the maximum gray level) and background component reset: 
                                                      h
                                                      
                                                         (
                                                         0
                                                         )
                                                      
                                                      ←
                                                      
                                                      0
                                                   ;
                                             
                                             
                                                
                                                   3. 
                                                   Histogram H is divided into two classes 
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                    
                                                   and 
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   , separated by 
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                   , at step 
                                                   
                                                      (
                                                      t
                                                      )
                                                   ;
                                             
                                             
                                                4. At step 
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   , calculate the average intensity values µ
                                                   1 
                                                   and µ
                                                   2 
                                                   for the respective classes 
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                    
                                                   and 
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  =
                                                                  0
                                                               
                                                               
                                                                  
                                                                     
                                                                        T
                                                                     
                                                                     
                                                                        (
                                                                        t
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                            (
                                                            h
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            ⋅
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  =
                                                                  0
                                                               
                                                               
                                                                  
                                                                     
                                                                        T
                                                                     
                                                                     
                                                                        (
                                                                        t
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                            h
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  =
                                                                  
                                                                     
                                                                        T
                                                                     
                                                                     
                                                                        (
                                                                        t
                                                                        )
                                                                     
                                                                  
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  L
                                                                  −
                                                                  1
                                                               
                                                            
                                                            (
                                                            h
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            ⋅
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  =
                                                                  
                                                                     
                                                                        T
                                                                     
                                                                     
                                                                        (
                                                                        t
                                                                        )
                                                                     
                                                                  
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  L
                                                                  −
                                                                  1
                                                               
                                                            
                                                            h
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   where denominators indicate the number of pixels present respectively in 
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                    
                                                   and 
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   ;
                                             
                                             
                                                5. Update threshold value:
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  2
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                   ;
                                             
                                             
                                                6. REPEAT steps from (3) to (5) until the convergence condition is achieved according to a fixed parameter 
                                                   
                                                      Δ
                                                      T
                                                   :
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                      
                                                      ≤
                                                      Δ
                                                      T
                                                   .
                                             
                                             
                                                
                                                   Output: Optimal threshold: 
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            o
                                                            p
                                                            t
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                   .
                                             
                                          
                                       
                                    
                                 
                              

The initialization value of the threshold is set to the global average of the image 
                              
                                 
                                    μ
                                 
                                 
                                    G
                                    l
                                    o
                                    b
                                    a
                                    l
                                 
                              
                           , while the convergence parameter is set to 
                              Δ
                              T
                              =
                              0
                           , since the process is always convergent (only 2–3 iterations). The traditional Otsu method [32], based on interclass-variance maximization, in addition to being more computationally expensive, also returns a wrong threshold value (too low) for proper fibroid thresholding. 
                           Fig. 8b shows the global thresholding execution applied to Fig. 8a.

The post-processing steps, according to Fig. 7, are explained and justified below:
                              
                                 Step 1. Morphological closing with a structuring element represented by a 
                                       2
                                       ×
                                       2
                                     pixel square is applied, in order to link an eventual loosely connected fibroid contour (ROT). ROI parts near the edge could, however, present similar intensity values to gray levels characterizing fibroid regions, and thus be included in the thresholding output. To eliminate this ambiguity, it is appropriate to apply a morphological erosion (with a circular structuring element of 5 pixels radius) to the ROI binary mask and then determine logical product with the resulting image from the previous step.

Step 2. A hole filling algorithm is necessary to fill any hollow within the ROT caused by the global thresholding operation.

Step 3. Segmentation is improved by removing objects that are smaller than a certain area and characterized by the same intensity of the fibroids to be treated through a connected-component labelling based operation, because there may be regions or artefacts caused by very small dark areas.

Step 4. Inside the binary mask, however, it is still possible that some lengthened connected-components, characterized by a sufficiently large area, are present (i.e. due to other anatomical structures or to acquisition artefacts). Moreover, in poor quality datasets, some parts of the patient׳s abdomen or colon could be part of the connected-component that identifies the uterus. These areas, which are characterized by a lengthened shape and by similar intensity levels to the ROT, will be removed during this step. Fibroids, in fact, present a spherical or semi-spherical shape [33] definable based on the parameters of the various connected components, in particular eccentricity (ratio between the foci distance related to an ellipse and its own major axis length) and extent (ratio between the pixels belonging to the region and the bounding-box pixels). Specifically, experimental reference values to discern fibroids from the rest of connected components are
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            0.3
                                                            ≤
                                                            extent
                                                            <
                                                            0.8
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0.0
                                                            ≤
                                                            eccentricity
                                                            <
                                                            0.8
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

Lastly, any connected-components, which have passed the shape-based control and whose centroid distance is more than a given upper limit (e.g. 60 pixels) from the MR image center, are removed.

In this way, in the presence of not good quality datasets, eventual errors occurring during the uterus segmentation phase (due to the bad output of the clustering operation) will also be managed. An example of this result is shown in Fig. 8c.

@&#EXPERIMENTAL RESULTS@&#

As with any experimental activity, it is necessary to quantify the quality of the results through different comparative indices between the automatically segmented ROI/ROT obtained by the proposed method and those manually segmented by an expert radiologist (considered our gold standard). Supervised evaluation metrics (also called empirical discrepancy methods [34]) are therefore used to objectively determine the quality of the segmentation method, thanks to the similarity degree between the automatically segmented image and the corresponding manual segmentation [35]. These metrics were applied to each slice belonging to various datasets in order to quantify the goodness of the segmentation both of the uterus (ROI) and of fibroids (ROT). For each dataset the mean value and the standard deviation are reported. 
                     Fig. 9 shows three segmentation examples of the ROI (blue contour) and of the ROT (red contour).

The subjects were scanned at two different institutions using the same model of medical equipment. Segmentation tests were performed on images acquired after the treatment in 2D MR modality using the Signa HTxt scanner, manufactured by General Electric Medical Systems (Milwaukee, WI, USA). Input series were sagittal sections acquired using the T1-Weighted “FSPGR+FS+C” (Fast Spoiled Gradient Echo+Fat Suppression+Contrast mean) sequence. FSPGR imaging protocol enabled a drastic reduction of the acquisition time without a substantial loss in image quality. The speed of these T1-Weighted gradient echo sequences is particularly suited to Gadolinium medium monitoring in T1 high-resolution 3D imaging. The “FSPGR+FS+C” sequences are generally used for NPV assessment [25] and, properly normalized, represent a good input for the processing: in fact, ablated fibroids appear as hypo-intense areas because they do not absorb the Gadolinium-based contrast medium.

MR data are encoded in the 16-bit DICOM format. All the slices relative to examined datasets had a 
                           512
                           ×
                           512
                         pixels size, 5.0mm thickness and were separated by 6.0mm spacing between slices. The number of slices belonging to the ROI takes into account only images that really contain the uterus and, similarly, the images of the ROT refer only to those which represent fibroids. In this way, a proper and meaningful calculation of the various indices is possible (metrics based on area of regions or on distance between). The average age of the examined patients is 42.13±6.02 years. The other characteristic parameters of each dataset are shown below (
                        Table 1).

For completeness, some details of dataset #4 are shown in 
                        Fig. 10, in which the three selected slices are representative of the entire dataset. In fact, Fig. 10a and d shows slice 06 (an initial slice), 
                        Figs. 10b and 11e show slice 10 (a middle slice), while Fig. 10c and f shows slice 16 (located at dataset end). The results are immediately visible since automatic (green contour) and manual (magenta contour) segmented ROI/ROT are superimposed in Fig. 10.

In order to have a practical feedback through numerical results, dataset #4 was chosen as a sample because, with its multi-fibroid pathological scenario, it constitutes a very representative images set. In fact, this dataset is characterized by a significant number of ROI and ROT slices (14 in both cases). To quantify manual and automatic segmentation differences, area values of ROI and ROT are calculated for each image belonging to dataset #4.


                        
                        Table 2 reports the average errors: the gap between manual and automatic ROI/ROT areas is very low, demonstrating the reliability of the proposed automatic segmentation method.

Moreover, in 
                        Table 3 a comparison of volumes extracted manually and by the proposed method is shown. For each dataset the absolute error is calculated and, finally, the average error for all examined datasets is reported.

It is fundamental to quantify the area or volume of the segmented object (in this case uterus or fibroids) in the pre-treatment phase so as to perform a comparison with the real measurement. This is done, considering the automatically segmented regions (
                              
                                 
                                    R
                                 
                                 
                                    A
                                 
                              
                           ) and the corresponding segmented regions in a manual way by the expert (
                              
                                 
                                    R
                                 
                                 
                                    T
                                 
                              
                           ), in terms of samples sets composed of pixels in 2D or voxels in 3D. At this point, we define the region that contains “true positives” (TP), i.e. elements belonging to the intersection of the two regions: 
                              
                                 
                                    R
                                 
                                 
                                    T
                                    P
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    A
                                 
                              
                              
                                 ∩
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    T
                                 
                              
                           . We also specify the region containing “false positives” (FP) 
                              
                                 
                                    R
                                 
                                 
                                    F
                                    P
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    A
                                 
                              
                              −
                              
                                 
                                    R
                                 
                                 
                                    T
                                    P
                                 
                              
                            and the one containing “false negatives” (FN) 
                              
                                 
                                    R
                                 
                                 
                                    F
                                    N
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    T
                                 
                              
                              −
                              
                                 
                                    R
                                 
                                 
                                    T
                                    P
                                 
                              
                           .

The following measures are defined in percentage terms:
                              
                                 •
                                 
                                    Similarity index (Sørensen–Dice coefficient) is more susceptible to differences between the positions of segmented regions and highly dependent on their own size (a high value implies good segmentation results):
                                       
                                          (11)
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   2
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               T
                                                               P
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               A
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   +
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                             ×
                                             100
                                          
                                       
                                    
                                 


                                    Jaccard index is an overlap measure of 
                                       
                                          
                                             R
                                          
                                          
                                             A
                                          
                                       
                                     and 
                                       
                                          
                                             R
                                          
                                          
                                             T
                                          
                                       
                                     (binary masks), that is the ratio between the cardinality of intersection and the cardinality of union calculated on the two sets (a high value implies good segmentation results):
                                       
                                          (12)
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                         ∩
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   |
                                                
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            A
                                                         
                                                      
                                                      
                                                         ∪
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   |
                                                
                                             
                                             ×
                                             100
                                             =
                                             
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            T
                                                            P
                                                         
                                                      
                                                   
                                                   |
                                                
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               A
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   +
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   −
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               T
                                                               P
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                             ×
                                             100
                                          
                                       
                                    
                                 


                                    True Positive Ratio (TPR), also called sensitivity, indicates the correct detection ratio, which is the area fraction within the manually segmented region that is also part of the automatic segmentation output (the higher the evaluation score, the better the performance of the applied algorithm):
                                       
                                          (13)
                                          
                                             TPR
                                             =
                                             
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            T
                                                            P
                                                         
                                                      
                                                   
                                                   |
                                                
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   |
                                                
                                             
                                             ×
                                             100
                                          
                                       
                                    
                                 


                                    Specificity estimates the ability of not detecting wrong parts inside the autonomously segmented ROI and it is defined as
                                       
                                          (14)
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   p
                                                
                                             
                                             =
                                             (
                                             1
                                             −
                                             
                                                
                                                   F
                                                
                                                
                                                   P
                                                
                                             
                                             )
                                             ×
                                             100
                                          
                                       
                                    cwhere 
                                       
                                          
                                             F
                                          
                                          
                                             P
                                          
                                       
                                       =
                                       
                                          |
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   F
                                                   P
                                                
                                             
                                          
                                          |
                                       
                                       /
                                       
                                          |
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   A
                                                
                                             
                                          
                                          |
                                       
                                     defines the ROI portion detected incorrectly (false positives), and indicates the area fraction included in the automatically segmented region which is not covered in the output of manual segmentation performed by the expert. Thereby, greater 
                                       
                                          
                                             S
                                          
                                          
                                             p
                                          
                                       
                                     means a more accurate segmentation.

Instead, these further measures are expressed in the 
                                       [
                                       0
                                       ,
                                       
                                       1
                                       ]
                                     range:


                                    False Positive Ratio (FPR) denotes the presence of false positives with respect to the reference ROI (lower values involve more precise segmented regions):
                                       
                                          (15)
                                          
                                             FPR
                                             =
                                             
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            F
                                                            P
                                                         
                                                      
                                                   
                                                   |
                                                
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 


                                    False Negative Ratio (FNR) defined as the ratio between false negatives and the number of elements to be really segmented (lower values involve more precise segmented regions):
                                       
                                          (16)
                                          
                                             FNR
                                             =
                                             
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            F
                                                            N
                                                         
                                                      
                                                   
                                                   |
                                                
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 


                                    False Region Ratio (FRR) indicates the ratio of false regions automatically segmented by the algorithm with respect to the “true” ROI (higher values connote good experimental findings):
                                       
                                          (17)
                                          
                                             FRR
                                             =
                                             
                                                (
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                                  
                                                                     F
                                                                     P
                                                                  
                                                               
                                                            
                                                            |
                                                         
                                                         +
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                                  
                                                                     F
                                                                     N
                                                                  
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                      
                                                         |
                                                         
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 

Area-based metrics do not completely characterize the goodness of a segmentation approach. Boundary tracing is another critical aspect, which is the primary objective of ROI segmentation. It is, therefore, necessary to estimate the distance between the automatically generated boundary and those manually selected by the expert radiologist.

Let 
                              A
                              =
                              {
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              :
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                              K
                              }
                            be the set of vertices belonging to the automatically generated boundaries and 
                              T
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              :
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              N
                              }
                            be the set of vertices belonging to the gold standard. The distance between an element of the contour relative to automatically generated ROI and the set 
                              T
                            is defined as
                              
                                 (18)
                                 
                                    d
                                    
                                       (
                                       
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          T
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          j
                                          ∈
                                          {
                                          1
                                          ,
                                          
                                          
                                          N
                                          }
                                       
                                    
                                    ∥
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          j
                                       
                                    
                                    ∥
                                 
                              
                           where 
                              ∥
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              ∥
                            denotes the Euclidean distance between two points.

At this point, for each image 
                              n
                           , different measures based on the distance of points belonging to the boundary and independent of region size can be defined:
                              
                                 •
                                 
                                    Mean absolute distance between boundaries of the two ROI measures the average error in the segmentation process:
                                       
                                          (19)
                                          
                                             
                                                
                                                   MAD
                                                
                                                
                                                   n
                                                
                                             
                                             =
                                             
                                                1
                                                K
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                K
                                             
                                             d
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             T
                                             )
                                          
                                       
                                    
                                 


                                    Maximum distance between boundaries of the two ROI measures the maximum difference between the two ROI boundaries, i.e. the maximum error in the segmentation process:
                                       
                                          (20)
                                          
                                             
                                                
                                                   MAXD
                                                
                                                
                                                   n
                                                
                                             
                                             =
                                             
                                                
                                                   max
                                                
                                                
                                                   i
                                                   ∈
                                                   {
                                                   1
                                                   ,
                                                   K
                                                   }
                                                
                                             
                                             {
                                             d
                                             
                                                (
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   T
                                                
                                                )
                                             
                                             }
                                          
                                       
                                    
                                 


                                    Hausdorff distance (HD), distance between the set of vertices 
                                       A
                                     and 
                                       T
                                     belonging, respectively, to the boundaries of regions 
                                       
                                          
                                             R
                                          
                                          
                                             A
                                          
                                       
                                     and 
                                       
                                          
                                             R
                                          
                                          
                                             T
                                          
                                       
                                    , defined as
                                       
                                          (21)
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   H
                                                
                                             
                                             =
                                             
                                             max
                                             
                                             {
                                             h
                                             
                                                (
                                                
                                                   T
                                                   ,
                                                   A
                                                
                                                )
                                             
                                             ,
                                             h
                                             
                                                (
                                                
                                                   A
                                                   ,
                                                   T
                                                
                                                )
                                             
                                             
                                             }
                                          
                                       
                                    
                                 

For all distance-based metrics, since distance is a discrepancy measure between boundaries of the automatic and reference ROIs, higher values imply a bigger segmentation error. Distances are expressed in pixels to be independent of the spatial resolution of different datasets (pixel spacing).


                           
                           Tables 4 and 
                           5 depict the values of area-based metrics obtained in the experimental ROI and ROT segmentation tests performed on the 15 available datasets.

Note that ROT segmentation is characterized by greater 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                            values than ROI segmentation, demonstrating higher precision as confirmed by 
                              
                                 
                                    S
                                 
                                 
                                    p
                                 
                              
                            (specificity index). Instead, TPR assumes larger values in ROI results, because ROI segmentation could also include parts outside the uterus (i.e. colon or abdomen), as shown by the FPR index too. Moreover, TPR and FPR values provide good segmentation results in both cases. However, since all area-based metrics depend on region size, different ROI/ROT index values are also due to big differences the real dimensions of the uterus and fibroids.

Although the count of ROT slices does not consider images without fibroids, the method is able to correctly detect the absence of fibroids inside the uterus, returning a null ROT image. This ensures great reliability of the method and, consequently, an increase of specificity.


                           
                           Tables 6 and 
                           7 depict the values of distance-based metrics obtained in the experimental ROI and ROT segmentation tests, respectively.

Numerical results are coherent and sensitive to outliers, as reflected by greater values of distance-based metrics on uterus segmentation, when eventual false positives are included in the ROI (anatomical parts outside the uterus). The values of distance-based indices confirm the trend of area-based metrics in uterus (ROI) and fibroid (ROT) segmentation.

In this subsection the achieved experimental results have been compared with similar literature approaches. In order to make a fair comparison, we developed the most representative methods among the uterine fibroid segmentation literature works (see Section 2). The different approaches have been tested on our 15 MR datasets and the proposed evaluation metrics (both area-based and distance-based) have been calculated.

Since we presented a two-dimensional segmentation method, the 3D model-based approach proposed in [21] was discarded. Among the others, we implemented and tested each different segmentation method, selecting one representative paper for each method:
                           
                              •
                              Clustering techniques: Modified Possibilistic FCM with morphological refinement [6];

Level set framework: interactive level set with user feed-back [8];

Direct region detection: multi-seed region growing 
                                 [16].

Values of the main area-based and distance-based metrics, calculated for each segmentation method, are reported in 
                        Table 8.

Sensitivity and specificity, concerning the Modified Possibilistic FCM method, involve an under-estimation of the true extent of the fibroid caused by the presence of false negatives. Conversely, interactive level set results (in particular TPR and SP ratios, and distance-based metrics) attest that segmented ROTs often over-estimate the actual region boundaries, due to the huge number of false positives when low contrast datasets are processed (confirmed by higher standard deviation values). This issue also affects the multi-seed region growing approach when leaking occurs, as suggested by achieved numerical results. In addition, the latter two semi-automatic approaches have to deal with parameter settings (iteration counting and fixed uniformity criterion selection) as well as with operator-dependence caused by initial manual input. Our fully automatic approach, instead, is able to obtain the most accurate and the least variable results, according to the high mean values and the lowest standard deviation of the evaluation measures.

@&#DISCUSSIONS@&#

The proposed automatic segmentation approach is able to give good results, as illustrated by area-based and distance-based metrics reported in Sections 5.3 and 5.4. Automatic segmented boundaries match the boundaries drawn manually by an expert radiologist, as shown in Fig. 10.

The most critical step of the overall method is certainly the clustering operation through Fuzzy C-Means algorithm. In fact, magnetic field non-uniformity within the uterus region can cause under-estimation of the ROI. Conversely, low contrast MR images could lead to over-estimation due to adjacent anatomical regions that are characterized by similar gray levels (colon or sacral plexus). Despite these incorrect ROI segmentation results, the subsequent adaptive thresholding is however able to correctly segment fibroids (ROT). Although the iterative optimal threshold selection relies on images characterized by a bimodal histogram, any ambiguities are handled by post-processing steps.

As shown in Tables 4 and 6, there are two “difficult cases”, represented by patients #9 and #12. The clustering operation applied to dataset #9 can under-estimate some slices (Fig. 11b), which are affected by magnetic field non-uniformity present in the deepest part of the uterus (darker gray levels). Instead, dataset #12 (Fig. 11a) is subject to an over-estimate due to anatomical ambiguities (colon appears very near to uterus) and low contrast (abdominal muscles with pixel values similar to the uterus), which lead to assign, wrongly, these zones to the ROI. Despite low assessment indices values computed for ROI segmentation of the previous “difficult cases”, excellent ROT segmentation results were achieved, as visible in Table 5.

These cases demonstrate the robustness of the proposed approach even in situations of datasets affected by acquisition noise, artefacts or aliasing. Moreover, good performance is found even in the presence of fibroids characterized by not well-defined contours or by an irregular shape (not completely spherical).

The only assumption made is that the uterus is always located in close proximity to the center of the MR slices. This is justified by the clinical practice of positioning the lesion (fibroid) near the isocentre of magnetic field (the central zone of the MR imaging field), during MRI acquisition (gradient and static field distortions are amplified toward the periphery of the imaging field [31]).

Moreover, the efficacy of our approach was corroborated by comparison with similar literature works.

With respect to the method proposed in [19,20], where three different types of MR sequences (T1-Weighted, Contrast Enhanced T1-Weighted and T2-Weighted images) were processed, in the presented method only one image type, acquired with the “FSPGR+FS+C” (Fast Spoiled Gradient Echo+Fat Suppression+Contrast mean) modality, is used. In fact, [4] and [6] exploit the intensity value features identifying each sequence type. Each step must be, therefore, preceded by a manual registration operation (using the software package MIPAV [36]) between the output of the current step (i.e. a binary mask) and the input image for the following processing steps. Consequently, the entire process is not completely automatic; registration operations are time-consuming for the expert and onerous from the computational point of view (affine transformations with 12 degrees of freedom, tri-linear interpolation and correlation functions). In this way, our segmentation process will be truly autonomous in all its parts and integrated into a single tool for the expert. Moreover, the various processing operations are implemented much faster and characterized by a lower computational load than the approach described in [6], where the clustering process is applied twice and an external tool is used for image registration.

The same research group in [13] presents a semi-automatic approach based on the Chan–Vese level set method. In this work, no clinical application is provided. Furthermore, the segmentation refinement using the Active Shape Model requires a previous training phase to generate ellipse model based on Principal Component Analysis (PCA) for segmented regions. However training data are automatically calculated for PCA Eigenvalues [37] by varying ellipse parameters (center, axes and orientation).

The other uterine fibroid segmentation methods based on the level set framework [8,10,18] require user intervention and parameter settings needed by the computational part. However, all such methods do not face the issues about the MRgFUS treatment evaluation.

The method developed in [21] addresses the segmentation of treated uterine fibroids from a post-operative MR image stack. Although user intervention is not required, this approach needs a treatment log in order to retrieve the information about the sonication cells. Indeed, the coordinates of each treatment cell are exploited as a priori information for the reconstruction of the initial surface model of the NonPerfused Volume (NPV). Also the post-processing steps partially rely on the treatment log. The authors argue that: “the treatment log seems to match reasonably well the NPV as seen in the post-operative images”, but no experimental results are provided about this statement. In fact, a patient or intestine movement in the post-operative scan could misalign the fibroid from the location of the treatment cells fixed to the MR reference system. The authors affirm that this problem could be solved using a tool for the registration of pre- and post-treatment image stacks. Lastly, in the text it is not clear if this method works well in multi-fibroid scenarios.

The proposed method in this paper, although it had been validated for segmentation of uterine fibroids in MRgFUS treatment evaluation, could be easily extended and tested on preoperative MR datasets (T1-Weighted and T2-Weighted sequences [2]) in order to support the target delineation during MRgFUS treatments.


                     Table 8 shows a comparison, in terms of area-based and distance-based metrics, between our method and the literature approaches proposed in [6,8,16], which we have implemented and tested on our 15 MR datasets. The proposed method shows better results than the other implemented methods using different indexes.

@&#CONCLUSIONS@&#

In this paper, a novel method based on Fuzzy C-Means clustering and iterative optimal threshold selection algorithms for the fully automatic segmentation both of the uterus and fibroids during MRgFUS treatment is proposed. The developed method could address and overcome some typical issues of manual segmentation approaches, such as time-consuming and operator-dependence. The proposed solution could provide a valid support to healthcare operators (i.e. physicians, radiologists) making it possible to improve the current operative methodology.

Although fibroids are characterized by non-uniformity and irregularities, the proposed approach is able to segment ablated regions very accurately as demonstrated by the experimental results.

Finally, our method provides a practical approach for the automatic evaluation of the boundary and the volume of ablated fibroid regions, without any user interaction or external input (e.g. treatment log files). As shown in Tables 5 and 7, the achieved segmentation results show the validity and the effectiveness of the proposed solution.

None declared.

@&#ACKNOWLEDGMENTS@&#

This work was supported by “Smart Health 2.0” MIUR project (PON 04a2_C), approved by MIUR D.D. 626/Ric and 703/Ric.

@&#REFERENCES@&#

