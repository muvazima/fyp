@&#MAIN-TITLE@&#Variational image inpainting technique based on nonlinear second-order diffusions

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel variational scheme for image inpainting is proposed in this paper, first.


                        
                        
                           
                           A nonlinear anisotropic diffusion model is obtained from this PDE variational scheme.


                        
                        
                           
                           A mathematical treatment of the obtained second-order PDE-based model is provided.


                        
                        
                           
                           An explicit finite-difference based numerical approximation scheme is constructed for it.


                        
                        
                           
                           Successful image reconstruction experiments and method comparison are also described.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Partial differential equation-based image inpainting

Variational model

Euler–Lagrange equation

Nonlinear diffusion-based model

Well-posedness

Numerical approximation scheme

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           Image, graphical abstract
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Digital image completion, or inpainting, represents the process of restoring the missing zones of a deteriorated static or video image as plausibly as possible from the known regions around them. Inpainting is an ancient very old term that comes from the art restoration, where it is also called retouching. It is ancient as art itself, since medieval artwork started to be restored as early as the Renaissance [1].

While in the museum world the inpainting task is carried out by an art restorer, in the digital world, the inpainting refers to the application of some interpolation algorithms to replace the missing or corrupted image areas. There are numerous important applications of the digital image inpainting techniques, such as: damaged painting reconstruction, photo and movie restoration, image (video) object removal / replacing, zooming and super-resolution, image compression and coding.

The image reconstruction techniques are divided into the following three categories: textural inpainting, structural inpainting and combined approaches that perform simultaneous structure and texture-based inpainting. Textural completion is highly connected with the texture synthesis. Many texture inpainting schemes have been proposed since an influential texture synthesis algorithm was developed by A. Efros and T. Leung [2]. In their approach, the texture is synthesized in a pixel by pixel way, by taking existing pixels with similar neighborhoods in a randomized fashion. Many other texture synthesis algorithms improving the speed and effectiveness of the Efros–Leung model have been provided in the last 15 years [1,3].

Structure-based image inpainting refers to the process of inpainting that employs information around damaged zone to estimate isophotes from coarse to fine, and diffuses information by diffusion mechanism. It uses the PDE (partial differential equation) based and variational reconstruction techniques. The PDE methods follow isophote directions in the image to perform the restoration process. The first PDE-based completion model was introduced by Bertalmio et al. in [1]. First variational approach to image reconstruction task was Nitzberg and Mumford's 2.1-D sketch [4], based on the Mumford–Shah functional, and the second one was the work of Masnou and Morel [5], based on solving for level lines with minimal curvature. An influential variational model for image inpainting was introduced in 2001, when the Total Variation (TV) Inpainting model was proposed by T. Chan and J. Shen [6]. Their variational framework fills the missing image areas by minimizing the total variation, while keeping close to the original image in the known zones. The model uses an Euler–Lagrange equation and anisotropic diffusion based on the strength of the isophotes. That TV Inpainting model has been extended and considerably improved in some subsequent works, better reconstruction schemes, such as TV inpainting with Split Bregman [7], being obtained. Other state of the art variational inpainting models recently developed include Blind Inpainting Using l
                     0 and TV Regularization [8], TV inpainting using PDAS (primal-dual active set) method [9] and Wavelet Inpainting by Nonlocal TV [10]. Also, some powerful image inpainting solutions which are recently elaborated use the Kriging interpolation model [11].

We also consider a novel PDE variational inpainting model in this paper. Some variational approaches for image inpainting were developed by us in the past [12,13]. Since the variational inpainting field is closely related to the variational denoising domain, which has been widely investigated by us, numerous variational [13–15] and diffusion-based image restoration schemes being proposed [16,17], we were able to derive successfully some effective inpainting techniques from the denoising and restoration models. The variational scheme proposed here can restore effectively the damaged images that are affected by both Gaussian noise and missing regions. It provides a better inpainting than our previous models and many existing PDE schemes, and also reduces considerably the amount of noise and unintended effects.

This article is organized in six sections, the first one being this introduction. The proposed variational reconstruction model and the nonlinear diffusion-based scheme derived from it are described in the second section. A rigorous mathematical treatment of the well-posedness of these models is provided in the third section. We develop a consistent numerical approximation scheme for this PDE-based image inpainting model, which is presented in fourth section. The successfully restoring experiments and method comparisons are discussed in the fifth section of this article, the conclusions of this work being drawn in the sixth section. Besides these main sections, the paper also contains some acknowledgements, a list of references and the author's biography.

Let us consider an image domain Ω⊆R
                     2 and a missing, or severely damaged, region inside it: Γ⊂Ω. The deteriorated image can be expressed as a partial 2D function that is defined only outside of the damaged zone, u
                     0: Ω\Γ → R. Our goal is to recover the original image from the observed image, u
                     0. So, the evolving (recovering) image is defined as u: Ω → R, 
                        
                           u
                           
                              
                                 |
                              
                              
                                 Ω
                                 ∖
                                 Γ
                              
                           
                           =
                           
                              u
                              0
                           
                        
                     .

We propose a PDE variational scheme [18] that provides not only an effective image inpainting, but also a visible reduction of noise amount and unintended effects [3]. The considered variational model minimizes an energy cost functional F that is designed especially for this reconstruction process, containing a mask that specify the known and unknown regions of the image. Therefore, the completed and enhanced image is determined as a result of the next minimization

                        
                           (1)
                           
                              
                                 
                                    u
                                    
                                       o
                                       p
                                       t
                                    
                                 
                                 =
                                 arg
                                 
                                    min
                                    u
                                 
                                 F
                                 
                                    (
                                    u
                                    )
                                 
                              
                           
                        
                     where

                        
                           (2)
                           
                              
                                 F
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    ∫
                                    Ω
                                 
                                 
                                    (
                                    
                                       α
                                       
                                          ϕ
                                          u
                                       
                                       
                                          (
                                          
                                             ∥
                                             
                                                ∇
                                                u
                                             
                                             ∥
                                          
                                          )
                                       
                                       +
                                       
                                          β
                                          2
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             1
                                             Γ
                                          
                                          )
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   u
                                                   −
                                                   
                                                      u
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                          2
                                       
                                    
                                    )
                                 
                                 d
                                 Ω
                              
                           
                        
                     where α, β ∈ (0, 1), the mask is based on the characteristic function of the inpainting region, which is expressed as

                        
                           (3)
                           
                              
                                 
                                    1
                                    Γ
                                 
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                1
                                                ,
                                                if
                                                
                                                   (
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                   )
                                                
                                                ∈
                                                Γ
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                                ,
                                                if
                                                
                                                   (
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                   )
                                                
                                                ∉
                                                Γ
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     and the regularizer function is having the following form:

                        
                           (4)
                           
                              
                                 
                                    ϕ
                                    u
                                 
                                 
                                    (
                                    s
                                    )
                                 
                                 =
                                 
                                    ∫
                                    0
                                    s
                                 
                                 
                                    τ
                                    ξ
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   η
                                                   (
                                                   u
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      log
                                                      10
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               s
                                                               +
                                                               η
                                                               (
                                                               u
                                                               )
                                                            
                                                            )
                                                         
                                                      
                                                      2
                                                   
                                                   +
                                                   δ
                                                
                                             
                                             )
                                          
                                       
                                       
                                          1
                                          3
                                       
                                    
                                    d
                                    τ
                                 
                              
                           
                        
                     whose conductance parameter is modeled as a function of some statistics of the evolving image, u
                     
                        
                           (5)
                           
                              
                                 η
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 ζ
                                 ·
                                 m
                                 e
                                 d
                                 i
                                 a
                                 n
                                 
                                    (
                                    
                                       ∥
                                       
                                          ∇
                                          u
                                       
                                       ∥
                                    
                                    )
                                 
                                 +
                                 ν
                                 ·
                                 p
                                 o
                                 s
                                 
                                    (
                                    u
                                    )
                                 
                              
                           
                        
                     where ξ, γ, ζ, ν ∈ (0, 1], δ ∈ [1, 5), median returns the median value of the argument and pos (u) returns the position of u in the evolving image sequence.

We note 
                        
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              u
                              ,
                              
                                 u
                                 x
                              
                              ,
                              
                                 u
                                 y
                              
                              )
                           
                           =
                           α
                           
                              ϕ
                              u
                           
                           
                              (
                              
                                 ∥
                                 
                                    ∇
                                    u
                                 
                                 ∥
                              
                              )
                           
                           +
                           
                              β
                              2
                           
                           
                              (
                              1
                              −
                              
                                 1
                                 Γ
                              
                              )
                           
                           
                              
                                 (
                                 
                                    u
                                    −
                                    
                                       u
                                       0
                                    
                                 
                                 )
                              
                              2
                           
                        
                     , where 
                        
                           
                              u
                              x
                           
                           =
                           
                              
                                 ∂
                                 u
                              
                              
                                 ∂
                                 x
                              
                           
                        
                     , then determine the Euler–Lagrange equation corresponding to the variational model [18]. That equation is obtained as

                        
                           (6)
                           
                              
                                 
                                    
                                       ∂
                                       E
                                    
                                    
                                       ∂
                                       u
                                    
                                 
                                 −
                                 
                                    ∂
                                    
                                       ∂
                                       x
                                    
                                 
                                 
                                    
                                       ∂
                                       E
                                    
                                    
                                       ∂
                                       
                                          u
                                          x
                                       
                                    
                                 
                                 −
                                 
                                    ∂
                                    
                                       ∂
                                       y
                                    
                                 
                                 
                                    
                                       ∂
                                       E
                                    
                                    
                                       ∂
                                       
                                          u
                                          y
                                       
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     that leads to 
                        
                           β
                           
                              (
                              
                                 1
                                 −
                                 
                                    1
                                    Γ
                                 
                              
                              )
                           
                           
                              (
                              
                                 u
                                 −
                                 
                                    u
                                    0
                                 
                              
                              )
                           
                           −
                           
                              ∂
                              
                                 ∂
                                 x
                              
                           
                           
                              (
                              
                                 α
                                 
                                    
                                       
                                          ϕ
                                          u
                                       
                                    
                                    ′
                                 
                                 
                                    (
                                    
                                       ∥
                                       
                                          ∇
                                          u
                                       
                                       ∥
                                    
                                    )
                                 
                                 
                                    
                                       2
                                       
                                          u
                                          x
                                       
                                    
                                    
                                       ∥
                                       
                                          ∇
                                          u
                                       
                                       ∥
                                    
                                 
                              
                              )
                           
                           −
                           
                              ∂
                              
                                 ∂
                                 y
                              
                           
                           
                              (
                              
                                 α
                                 
                                    
                                       
                                          ϕ
                                          u
                                       
                                    
                                    ′
                                 
                                 
                                    (
                                    
                                       ∥
                                       
                                          ∇
                                          u
                                       
                                       ∥
                                    
                                    )
                                 
                                 
                                    
                                       2
                                       
                                          u
                                          y
                                       
                                    
                                    
                                       ∥
                                       
                                          ∇
                                          u
                                       
                                       ∥
                                    
                                 
                              
                              )
                           
                           =
                           0
                        
                      that is equivalent to

                        
                           (7)
                           
                              
                                 β
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                          1
                                          Γ
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       u
                                       −
                                       
                                          u
                                          0
                                       
                                    
                                    )
                                 
                                 −
                                 2
                                 α
                                 d
                                 i
                                 v
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                      u
                                                   
                                                
                                                ′
                                             
                                             
                                                (
                                                
                                                   ∥
                                                   
                                                      ∇
                                                      u
                                                   
                                                   ∥
                                                
                                                )
                                             
                                          
                                          
                                             ∥
                                             
                                                ∇
                                                u
                                             
                                             ∥
                                          
                                       
                                       ∇
                                       u
                                    
                                    )
                                 
                                 =
                                 0
                              
                           
                        
                     
                  

We introduce the diffusivity function ψu
                     : [0, ∞) → (0, ∞), 
                        
                           
                              ψ
                              u
                           
                           
                              (
                              s
                              )
                           
                           =
                           
                              
                                 
                                    
                                       
                                          ϕ
                                          u
                                       
                                    
                                    ′
                                 
                                 
                                    (
                                    s
                                    )
                                 
                              
                              s
                           
                        
                     , therefore from (4) one obtains

                        
                           (8)
                           
                              
                                 
                                    ψ
                                    u
                                 
                                 
                                    (
                                    s
                                    )
                                 
                                 =
                                 ξ
                                 
                                    
                                       (
                                       
                                          
                                             η
                                             (
                                             u
                                             )
                                          
                                          
                                             γ
                                             
                                                log
                                                10
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         s
                                                         +
                                                         η
                                                         (
                                                         u
                                                         )
                                                      
                                                      )
                                                   
                                                
                                                2
                                             
                                             +
                                             δ
                                          
                                       
                                       )
                                    
                                    
                                       1
                                       3
                                    
                                 
                              
                           
                        
                     
                  

Therefore,
Eq. (7) becomes

                        
                           (9)
                           
                              
                                 β
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                          1
                                          Γ
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       u
                                       −
                                       
                                          u
                                          0
                                       
                                    
                                    )
                                 
                                 −
                                 2
                                 α
                                 d
                                 i
                                 v
                                 
                                    (
                                    
                                       
                                          ψ
                                          u
                                       
                                       
                                          (
                                          
                                             ∥
                                             
                                                ∇
                                                u
                                             
                                             ∥
                                          
                                          )
                                       
                                       ∇
                                       u
                                    
                                    )
                                 
                                 =
                                 0
                              
                           
                        
                     
                  

Then, one applies the gradient descent and the following nonlinear parabolic PDE model is obtained from (9)

                        
                           (10)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   u
                                                
                                                
                                                   ∂
                                                   t
                                                
                                             
                                             =
                                             2
                                             α
                                             d
                                             i
                                             v
                                             
                                                (
                                                
                                                   
                                                      ψ
                                                      u
                                                   
                                                   
                                                      (
                                                      
                                                         ∥
                                                         
                                                            ∇
                                                            u
                                                         
                                                         ∥
                                                      
                                                      )
                                                   
                                                   ∇
                                                   u
                                                
                                                )
                                             
                                             −
                                             β
                                             
                                                (
                                                1
                                                −
                                                
                                                   1
                                                   Γ
                                                
                                                )
                                             
                                             ·
                                             
                                                (
                                                
                                                   u
                                                   −
                                                   
                                                      u
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             u
                                             
                                                (
                                                
                                                   0
                                                   ,
                                                   x
                                                   ,
                                                   y
                                                
                                                )
                                             
                                             =
                                             
                                                u
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The result of minimization (1), representing the restored image, will be determined by solving the PDE given by (10). So, the existence and uniqueness of a solution of this parabolic PDE model will be investigated in the next section, where a mathematical treatment is provided for it.

In this section we consider an analysis of the nonlinear second-order diffusion scheme (10) that is derived from the proposed variational model. The nonlinear PDE model will provide proper restoration results if it's edge-stopping, or diffusivity, function satisfies some certain conditions related to positivity, monotony and convergence to zero [3,17].

Thus, the function ψu
                      is positive: ψu
                     (s) > 0, ∀s ≥ 0. Also, it is monotonically decreasing, since 
                        
                           
                              ψ
                              u
                           
                           
                              (
                              
                                 s
                                 1
                              
                              )
                           
                           =
                           ξ
                           
                              
                                 (
                                 
                                    
                                       
                                          η
                                          (
                                          u
                                          )
                                       
                                       
                                          γ
                                          
                                             log
                                             10
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      s
                                                      1
                                                   
                                                   +
                                                   η
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                          +
                                          δ
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    1
                                    3
                                 
                              
                           
                           ≥
                           ξ
                           
                              
                                 (
                                 
                                    
                                       
                                          η
                                          (
                                          u
                                          )
                                       
                                       
                                          γ
                                          
                                             log
                                             10
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      s
                                                      2
                                                   
                                                   +
                                                   η
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                          +
                                          δ
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    1
                                    3
                                 
                              
                           
                           =
                           
                              ψ
                              u
                           
                           
                              (
                              
                                 s
                                 2
                              
                              )
                           
                        
                     , ∀s
                     1 ≥ s
                     2. This edge-stopping function also converges to zero, since 
                        
                           
                              lim
                              
                                 s
                                 →
                                 ∞
                              
                           
                           
                              ψ
                              u
                           
                           
                              (
                              s
                              )
                           
                           
                           =
                           
                              lim
                              
                                 s
                                 →
                                 ∞
                              
                           
                           ξ
                           
                              
                                 (
                                 
                                    
                                       
                                          η
                                          (
                                          u
                                          )
                                       
                                       
                                          γ
                                          
                                             log
                                             10
                                          
                                          
                                             
                                                (
                                                
                                                   s
                                                   +
                                                   η
                                                   (
                                                   u
                                                   )
                                                
                                                )
                                             
                                             2
                                          
                                          +
                                          δ
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    1
                                    3
                                 
                              
                           
                           =
                           0
                        
                     .

Since it satisfies these conditions, the function ψu
                      ensures a proper image denoising. Our main goal here is not noise removal, but reconstruction, therefore the denoising process has to be directed mainly to the unknown region. The smoothing must be reduced outside the inpainting zone, therefore the parameter α has to be chosen very small.

For the anisotropic diffusion-based model given by (10) to admit a weak solution, a Dirichlet condition should be inserted on the boundary. Therefore, it has to be transformed as following:

                        
                           (11)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   u
                                                
                                                
                                                   ∂
                                                   t
                                                
                                             
                                             =
                                             2
                                             α
                                             d
                                             i
                                             v
                                             
                                                (
                                                
                                                   
                                                      ψ
                                                      u
                                                   
                                                   
                                                      (
                                                      
                                                         ∥
                                                         
                                                            ∇
                                                            u
                                                         
                                                         ∥
                                                      
                                                      )
                                                   
                                                   ∇
                                                   u
                                                
                                                )
                                             
                                             −
                                             β
                                             
                                                (
                                                1
                                                −
                                                
                                                   1
                                                   Γ
                                                
                                                )
                                             
                                             ·
                                             
                                                (
                                                
                                                   u
                                                   −
                                                   
                                                      u
                                                      0
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                      
                                                         (
                                                         
                                                            0
                                                            ,
                                                            x
                                                            ,
                                                            y
                                                         
                                                         )
                                                      
                                                      =
                                                      
                                                         u
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                      
                                                         (
                                                         
                                                            t
                                                            ,
                                                            x
                                                            ,
                                                            y
                                                         
                                                         )
                                                      
                                                      
                                                         =
                                                         0
                                                         ,
                                                         on
                                                         ∂
                                                         Ω
                                                         ∖
                                                         Γ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Also, another condition for the existence and uniqueness of a weak solution of this PDE model is that function sψu
                     (s) to be monotonically increasing from [0, ∞) to (0, ∞). This condition is satisfied, since its derivative is always positive. Indeed, we have 
                        
                           
                              
                                 (
                                 
                                    s
                                    
                                       ψ
                                       u
                                    
                                    
                                       (
                                       s
                                       )
                                    
                                 
                                 )
                              
                              ′
                           
                           =
                           
                              ∂
                              
                                 ∂
                                 s
                              
                           
                           
                              (
                              
                                 s
                                 
                                    ψ
                                    u
                                 
                                 
                                    (
                                    s
                                    )
                                 
                              
                              )
                           
                           =
                           
                              ψ
                              u
                           
                           
                              (
                              s
                              )
                           
                           +
                           s
                           
                              
                                 ∂
                                 
                                    ψ
                                    u
                                 
                                 
                                    (
                                    s
                                    )
                                 
                              
                              
                                 ∂
                                 s
                              
                           
                        
                     . Therefore, we get

                        
                           (12)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                s
                                                
                                                   ψ
                                                   u
                                                
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                             )
                                          
                                          ′
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          ξ
                                          
                                             
                                                (
                                                
                                                   
                                                      η
                                                      (
                                                      u
                                                      )
                                                   
                                                   
                                                      γ
                                                      
                                                         log
                                                         10
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  s
                                                                  +
                                                                  η
                                                                  (
                                                                  u
                                                                  )
                                                               
                                                               )
                                                            
                                                         
                                                         2
                                                      
                                                      +
                                                      δ
                                                   
                                                
                                                )
                                             
                                             
                                                1
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                2
                                                s
                                                γ
                                                η
                                                
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   
                                                      1
                                                      3
                                                   
                                                
                                                ξ
                                             
                                             
                                                3
                                                ln
                                                
                                                   (
                                                   10
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      +
                                                      η
                                                      (
                                                      u
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            2
                                                            γ
                                                            
                                                               log
                                                               10
                                                            
                                                            
                                                               (
                                                               
                                                                  s
                                                                  +
                                                                  η
                                                                  (
                                                                  u
                                                               
                                                               )
                                                            
                                                            +
                                                            δ
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      4
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                ξ
                                                η
                                                
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   
                                                      1
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            log
                                                            10
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     s
                                                                     +
                                                                     η
                                                                     (
                                                                     u
                                                                     )
                                                                  
                                                                  )
                                                               
                                                            
                                                            2
                                                         
                                                         +
                                                         δ
                                                      
                                                      )
                                                   
                                                
                                                
                                                   1
                                                   3
                                                
                                             
                                          
                                          
                                             (
                                             
                                                1
                                                −
                                                
                                                   
                                                      2
                                                      s
                                                      γ
                                                   
                                                   
                                                      3
                                                      ln
                                                      
                                                         (
                                                         10
                                                         )
                                                      
                                                      
                                                         (
                                                         
                                                            s
                                                            +
                                                            η
                                                            (
                                                            u
                                                            )
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         
                                                            2
                                                            γ
                                                            
                                                               log
                                                               10
                                                            
                                                            
                                                               (
                                                               
                                                                  s
                                                                  +
                                                                  η
                                                                  (
                                                                  u
                                                                  )
                                                               
                                                               )
                                                            
                                                            +
                                                            δ
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          >
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     because 
                        
                           3
                           ln
                           
                              (
                              10
                              )
                           
                           
                              (
                              
                                 s
                                 +
                                 η
                                 (
                                 u
                                 )
                              
                              )
                           
                           
                              (
                              
                                 2
                                 γ
                                 
                                    log
                                    10
                                 
                                 
                                    (
                                    
                                       s
                                       +
                                       η
                                       (
                                       u
                                       )
                                    
                                    )
                                 
                                 +
                                 δ
                              
                              )
                           
                           >
                           2
                           s
                           γ
                        
                     , since 
                        
                           s
                           +
                           η
                           (
                           u
                           )
                           >
                           10
                        
                     , the conductance parameter usually taking quite high values in the numerical experiments (over 20).

Therefore, the nonlinear PDE from (11) admits a unique and weak solution that converges to the solution of the variational model. So, we have 
                        
                           
                              lim
                              
                                 t
                                 →
                                 ∞
                              
                           
                           u
                           
                              (
                              t
                              ,
                              x
                              ,
                              y
                              )
                           
                           =
                           
                              u
                              
                                 o
                                 p
                                 t
                              
                           
                        
                     . This solution, which provides the restored digital image, is numerically approximated by a stable and consistent discretization scheme that is proposed in the next section.

A consistent numerical approximation algorithm is developed for the continuous PDE-based scheme described in the previous sections. We propose a robust numerical discretization scheme based on the finite-difference method [19], to approximate the solution of the nonlinear diffusion model. Therefore, the PDE discretization is performed by considering a space grid size of h and the time step Δt, respectively. The coordinates of space and time are quantized as following:

                        
                           (13)
                           
                              
                                 x
                                 =
                                 i
                                 h
                                 ,
                                 y
                                 =
                                 j
                                 h
                                 ,
                                 t
                                 =
                                 n
                                 Δ
                                 t
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 
                                    {
                                    
                                       1
                                       ,
                                       …
                                       ,
                                       I
                                    
                                    }
                                 
                                 ,
                                 j
                                 ∈
                                 
                                    {
                                    
                                       1
                                       ,
                                       …
                                       ,
                                       J
                                    
                                    }
                                 
                                 ,
                                 n
                                 ∈
                                 
                                    {
                                    
                                       0
                                       ,
                                       1
                                       ,
                                       …
                                       ,
                                       N
                                    
                                    }
                                 
                              
                           
                        
                     
                  

Since we have 
                        
                           d
                           i
                           v
                           
                              (
                              
                                 
                                    ψ
                                    u
                                 
                                 
                                    (
                                    
                                       ∥
                                       
                                          ∇
                                          u
                                       
                                       ∥
                                    
                                    )
                                 
                                 ∇
                                 u
                              
                              )
                           
                           =
                           
                              ψ
                              u
                           
                           
                              (
                              
                                 ∥
                                 
                                    ∇
                                    u
                                 
                                 ∥
                              
                              )
                           
                           Δ
                           u
                           +
                           ∇
                           
                              (
                              
                                 
                                    ψ
                                    u
                                 
                                 
                                    (
                                    
                                       ∥
                                       
                                          ∇
                                          u
                                       
                                       ∥
                                    
                                    )
                                 
                              
                              )
                           
                           ·
                           ∇
                           u
                        
                     , the PDE equation to be discretized becomes

                        
                           (14)
                           
                              
                                 
                                    
                                       ∂
                                       u
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 2
                                 α
                                 
                                    (
                                    
                                       
                                          ψ
                                          u
                                       
                                       
                                          (
                                          
                                             ∥
                                             
                                                ∇
                                                u
                                             
                                             ∥
                                          
                                          )
                                       
                                       Δ
                                       u
                                       +
                                       ∇
                                       
                                          (
                                          
                                             
                                                ψ
                                                u
                                             
                                             
                                                (
                                                
                                                   ∥
                                                   
                                                      ∇
                                                      u
                                                   
                                                   ∥
                                                
                                                )
                                             
                                          
                                          )
                                       
                                       ·
                                       ∇
                                       u
                                    
                                    )
                                 
                                 −
                                 β
                                 
                                    (
                                    1
                                    −
                                    
                                       1
                                       Γ
                                    
                                    )
                                 
                                 ·
                                 
                                    (
                                    
                                       u
                                       −
                                       
                                          u
                                          0
                                       
                                    
                                    )
                                 
                              
                           
                        
                     
                  

The component involving the Laplacian, ψu
                     (‖∇u‖)Δu, is approximated by using finite differences, as follows:

                        
                           (15)
                           
                              
                                 
                                    D
                                    1
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 =
                                 
                                    ψ
                                    u
                                 
                                 
                                    (
                                    
                                       ∥
                                       
                                          ∇
                                          
                                             u
                                             n
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                       
                                       ∥
                                    
                                    )
                                 
                                 
                                    ∇
                                    2
                                 
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                              
                           
                        
                     where

                        
                           (16)
                           
                              
                                 
                                    ∇
                                    2
                                 
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 =
                                 Δ
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          u
                                          n
                                       
                                       
                                          (
                                          i
                                          +
                                          h
                                          ,
                                          j
                                          )
                                       
                                       +
                                       
                                          u
                                          n
                                       
                                       
                                          (
                                          i
                                          −
                                          h
                                          ,
                                          j
                                          )
                                       
                                       +
                                       
                                          u
                                          n
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          +
                                          h
                                          )
                                       
                                       +
                                       
                                          u
                                          n
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          −
                                          h
                                          )
                                       
                                       −
                                       4
                                       
                                          u
                                          n
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                    
                                       h
                                       2
                                    
                                 
                              
                           
                        
                     Also, we have

                        
                           (17)
                           
                              
                                 ∇
                                 
                                    (
                                    
                                       
                                          ψ
                                          u
                                       
                                       
                                          (
                                          
                                             ∥
                                             
                                                ∇
                                                u
                                             
                                             ∥
                                          
                                          )
                                       
                                    
                                    )
                                 
                                 ·
                                 ∇
                                 u
                                 =
                                 
                                    (
                                    
                                       
                                          ∂
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          ψ
                                          u
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                         x
                                                      
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      
                                                         u
                                                         y
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          ∂
                                          
                                             ∂
                                             y
                                          
                                       
                                       
                                          ψ
                                          u
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                         x
                                                      
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      
                                                         u
                                                         y
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                    
                                    )
                                 
                                 ·
                                 
                                    (
                                    
                                       
                                          u
                                          x
                                       
                                       ,
                                       
                                          u
                                          y
                                       
                                    
                                    )
                                 
                              
                           
                        
                     that leads to

                        
                           (18)
                           
                              
                                 ∇
                                 
                                    (
                                    
                                       
                                          ψ
                                          u
                                       
                                       
                                          (
                                          
                                             ∥
                                             
                                                ∇
                                                u
                                             
                                             ∥
                                          
                                          )
                                       
                                    
                                    )
                                 
                                 ·
                                 ∇
                                 u
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          ψ
                                          u
                                       
                                    
                                    
                                       ∂
                                       s
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   x
                                                
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                
                                                   u
                                                   y
                                                
                                             
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                                x
                                             
                                          
                                          2
                                       
                                       
                                          u
                                          
                                             x
                                             x
                                          
                                       
                                       +
                                       2
                                       
                                          u
                                          x
                                       
                                       
                                          u
                                          y
                                       
                                       
                                          u
                                          
                                             x
                                             y
                                          
                                       
                                       +
                                       
                                          
                                             
                                                u
                                                y
                                             
                                          
                                          2
                                       
                                       
                                          u
                                          
                                             y
                                             y
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   x
                                                
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                
                                                   u
                                                   y
                                                
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

We can simplify this formula, by performing some approximations. So, we may approximate uxx
                      ≈ uxy
                      ≈ uyy
                     , since we have found that second-order derivatives do not vary so much. Thus, (18) becomes

                        
                           (19)
                           
                              
                                 ∇
                                 
                                    (
                                    
                                       
                                          ψ
                                          u
                                       
                                       
                                          (
                                          
                                             ∥
                                             
                                                ∇
                                                u
                                             
                                             ∥
                                          
                                          )
                                       
                                    
                                    )
                                 
                                 ·
                                 ∇
                                 u
                                 
                                 ≈
                                 
                                    
                                       ∂
                                       
                                          ψ
                                          u
                                       
                                    
                                    
                                       ∂
                                       s
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   x
                                                
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                
                                                   u
                                                   y
                                                
                                             
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                                x
                                             
                                          
                                          y
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   u
                                                   x
                                                
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                
                                                   u
                                                   y
                                                
                                             
                                             2
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   x
                                                
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                
                                                   u
                                                   y
                                                
                                             
                                             2
                                          
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       ∂
                                       
                                          ψ
                                          u
                                       
                                    
                                    
                                       ∂
                                       s
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   x
                                                
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                
                                                   u
                                                   y
                                                
                                             
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          u
                                          x
                                       
                                    
                                    y
                                 
                                 
                                    (
                                    
                                       
                                          
                                             u
                                             x
                                          
                                       
                                       2
                                    
                                    +
                                    
                                       
                                          
                                             u
                                             y
                                          
                                       
                                       2
                                    
                                    )
                                 
                              
                           
                        
                     
                  

So, we determine the second discretization that is

                        
                           (20)
                           
                              
                                 
                                    D
                                    2
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          ψ
                                          u
                                       
                                    
                                    
                                       ∂
                                       s
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ∂
                                                         
                                                            u
                                                            n
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ∂
                                                         
                                                            u
                                                            n
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ∂
                                          2
                                       
                                       
                                          u
                                          n
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                    
                                       ∂
                                       i
                                       ∂
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             ∂
                                             
                                                u
                                                n
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                          
                                          
                                             ∂
                                             i
                                          
                                       
                                       +
                                       
                                          
                                             ∂
                                             
                                                u
                                                n
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                          
                                          
                                             ∂
                                             j
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     where, by using the finite differences [19], we get

                        
                           (21)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                   
                                                   
                                                      ∂
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      ∂
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                   
                                                   
                                                      ∂
                                                      j
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         +
                                                         h
                                                         ,
                                                         j
                                                         )
                                                      
                                                      −
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         −
                                                         h
                                                         ,
                                                         j
                                                         )
                                                      
                                                      +
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         +
                                                         h
                                                         )
                                                      
                                                      −
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         −
                                                         h
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                   
                                                   
                                                      ∂
                                                      i
                                                      ∂
                                                      j
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         +
                                                         h
                                                         ,
                                                         j
                                                         +
                                                         h
                                                         )
                                                      
                                                      −
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         +
                                                         h
                                                         ,
                                                         j
                                                         −
                                                         h
                                                         )
                                                      
                                                      −
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         −
                                                         h
                                                         ,
                                                         j
                                                         +
                                                         h
                                                         )
                                                      
                                                      +
                                                      
                                                         u
                                                         n
                                                      
                                                      
                                                         (
                                                         i
                                                         −
                                                         h
                                                         ,
                                                         j
                                                         −
                                                         h
                                                         )
                                                      
                                                   
                                                   
                                                      4
                                                      
                                                         h
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Therefore, we obtain the following approximation for the continuous model that is provided by (14)

                        
                           (22)
                           
                              
                                 
                                    u
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 =
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 +
                                 2
                                 α
                                 Δ
                                 t
                                 
                                    (
                                    
                                       
                                          D
                                          1
                                          n
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       +
                                       
                                          D
                                          2
                                          n
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                    )
                                 
                                 −
                                 β
                                 
                                    (
                                    
                                       1
                                       −
                                       
                                          1
                                          Γ
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          u
                                          n
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       −
                                       
                                          u
                                          0
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     
                  

for n
                     =0,…,N, where u
                     0 represents the discrete form [I × J] of the initial degraded image and the boundary conditions are the following:

                        
                           (23)
                           
                              
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    0
                                    ,
                                    j
                                    )
                                 
                                 =
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    1
                                    ,
                                    j
                                    )
                                 
                                 ,
                                 
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    I
                                    +
                                    1
                                    ,
                                    j
                                    )
                                 
                                 =
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    I
                                    ,
                                    j
                                    )
                                 
                                 ,
                                 
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    0
                                    )
                                 
                                 =
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    
                                    1
                                    )
                                 
                                 ,
                                 
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    J
                                    +
                                    1
                                    )
                                 
                                 =
                                 
                                    u
                                    n
                                 
                                 
                                    (
                                    i
                                    ,
                                    J
                                    )
                                 
                              
                           
                        
                     
                  

We may, for simplicity, take the parameters h
                     =1 and 
                        
                           Δ
                           t
                           =
                           1
                        
                     . The explicit numerical approximation scheme (22) is stable and consistent to the nonlinear anisotropic diffusion model (11). It converges quite fast to the solution representing the reconstructed image, since the iterative algorithm is applied on the evolving image u for a low number of steps, N.

The PDE variational inpainting technique described here has been tested on large collections of images affected by missing regions and various amounts of Gaussian noise. Given the fast convergence of its iterative approximation scheme, this approach has a low execution time, of approximately 1s. It provides an effective restoration of the degraded image, completing successfully the missing zones while removing a high amount of noise. It also preserves the image details, like edges, quite well, and reduces the unintended effects, such as image blurring, staircasing and speckle noise.

The optimal image reconstruction results are achieved for some properly selected parameters of the variational and nonlinear diffusion model. These parameter values, detected by trial and error, through empirical observation, are the following ones:

                        
                           (24)
                           
                              
                                 α
                                 =
                                 0
                                 .
                                 
                                    4
                                    ,
                                 
                                 β
                                 =
                                 0.4
                                 ,
                                 ξ
                                 =
                                 
                                    0
                                    ,
                                    5
                                    ,
                                 
                                 γ
                                 =
                                 0
                                 .
                                 
                                    7
                                    ,
                                 
                                 δ
                                 =
                                 
                                    4
                                    ,
                                 
                                 ζ
                                 =
                                 1
                                 
                                    .
                                    4
                                    ,
                                 
                                 ν
                                 =
                                 0.05
                                 ,
                                 Δ
                                 t
                                 =
                                 1
                                 ,
                                 h
                                 =
                                 1
                              
                           
                        
                     
                  

The number of iterations, N, is generally low but it depends on the number and sizes of the inpainting regions, and also on the state of the image. If the processed image is not affected by a visible amount of noise, a relatively small missing zone is inpainted in less than 20 iterations (N <20). If we deal with a noisy image, the missing regions are more than one and have larger sizes, the restoration scheme needs much more iterations to complete the inpainting task. The number of steps could reach N
                     =100.

Method comparisons have been also performed. The performance of this nonlinear anisotropic diffusion technique has been quantified by using well-known measures, such as Peak Signal-to-Noise Ratio (PSNR) and Norm of the Error Image. In order to quantify the performance of the various techniques, a high quality image is considered and some missing zones and a known amount of noise is added to it. This approach outperforms numerous state of the art inpainting methods (both PDE-based and non-PDE techniques), obtaining higher PSNR values than them.

Thus, the inpainting algorithm proposed here provides better reconstruction results and executes faster than well-known TV Inpainting [6], and also performs better than PDE variational interpolation techniques derived from other nonlinear diffusion-based denoising schemes [20,21], including some developed by us in the past [12,13]. Also, this PDE-based inpainting framework outperforms methods based on Gaussian processes, such as the Gaussian Process Regression (GPR) model [22].

This PDE-based inpainting technique is able to restore multiple missing (or highly degraded) regions. For this reason, it can be successfully used for some important tasks, such as removing the written text from the digital images or removing the watermarks. A text removing example using the proposed method is described in Fig. 1
                     , where some method comparison results are displayed.

The images of that figure depict the restoring results achieved by various inpainting techniques on the [512 × 512] Lena image. The original image, displayed in a), is affected by black texts that can be viewed as missing zones in b). The inpainting results provided by this variational scheme after N
                     =37 iterations are described in c). One can see that this technique restores completely the image, while other PDE-based methods, such as TV Inpainting (d), a Perona-Malik model-based interpolation algorithm (e), and the linear diffusion-based (heat equation-derived) inpainting scheme (f) do not succeed to inpaint it completely in the same number of steps, requiring more iterations.

Also, the figure describes the image interpolation results obtained by these techniques in noisy conditions, which are much more difficult, after a certain number of processing steps. Thus, Lena image affected by both missing regions (text) and Gaussian noise characterized by μ
                     =0.21 and variance
                     =0.02, is displayed in g). The successful inpainting achieved by this technique after N
                     =70 steps is depicted in h), while the interpolation results obtained by the other diffusion-based approaches after the same number of iterations (70) are displayed in i) – k). Obviously, those methods are clearly outperformed by this algorithm, needing much more iterations to remove the texts from the image. Also, besides the successful inpainting, this restoration scheme provides a considerable noise reduction for the processed image.

The PSNR values corresponding to the mentioned interpolation approaches are registered in Table 1
                     . As one could see in that table, the proposed image inpainting technique achieves the highest value.

We have also compared the proposed interpolation model to some more effective inpainting techniques from the state of the art, such as Bertalmio Inpainting [1], Inpainting using Kriging Interpolation [11], TV Inpainting with Split Bregman [7] and TV Inpainting using primal-dual active set method (PDAS) [9]. We have found that our reconstruction method and other recently developed interpolation algorithms provide comparable good results.

Some method comparison results are described in Fig. 2
                      and Table 2
                     . The Lena image affected by thick scratches is displayed in Fig. 2 a), the inpainting result of this technique in b), the Bertalmio inpainting in c), the inpainting achieved by Kriging interpolation in d), the TV with PDAS inpainting in e) and the TV with Spilt Bregman inpainting in f).

The PSNR values indicating the performance of these approaches are displayed in the next table. This completion technique outperforms the Bertalmio inpainting and Kriging-based inpainting, getting higher PSNR values. As resulting from Table 2, the PSNR of the proposed variational model is slightly higher than that of Split Bregman Inpainting, but slightly lower than PSNR value of TV Inpainting with PDAS.

While the PDAS-based TV Inpainting may achieve slightly higher PSNRs, it executes slower than our reconstruction algorithm (it takes several seconds for the above image). Also, this approach runs faster than Kriging interpolation, but is somewhat slower than Split Bregman, which requires slightly less iterations and converges in less than 1s. The scheme proposed here provides a better feature-preserving image denoising than Bertalmio and Kriging interpolation, which is comparable to those of TV with PDAS and TV with Split Bregman.

As we have already mentioned, this reconstruction technique outperforms our previous inpainting techniques [12], providing a better restoration and achieving much better PSNR and NE values.

@&#CONCLUSIONS@&#

A novel variational model that is able to perform both image interpolation and Gaussian noise reduction has been proposed in this article. We have focused mainly on the second-order nonlinear anisotropic diffusion model, derived from this PDE-based variational scheme.

Thus, a robust mathematical investigation of this second-order PDE model, analyzing its edge-stopping function and well-posedness, has been provided here. Also, this nonlinear diffusion model is properly discretized by using a consistent and stable finite-difference based numerical approximation scheme that represents another contribution of this paper. It is a fast converging iterative explicit scheme, although its number of iterations depends on the sizes of the unknown regions and the amount of the image noise.

The successful inpainting experiments performed on several hundreds of digital images affected by multiple missing zones prove the effectiveness of this restoration approach. The proposed nonlinear diffusion based scheme is able to inpaint multiple missing or highly deteriorated image regions, therefore it can be successfully applied to some important areas, such as the text or watermark removal, or removing multiple undesired objects from the considered image.

This image interpolation technique outperforms many PDE-based and non-PDE inpainting techniques from the state of the art, executing faster than them and providing much better restoring results. Also, unlike other reconstruction methods, the described approach performs very well in noisy conditions and, besides completing successfully all the missing regions, it reduces the 2D Gaussian noise and overcomes the unintended effects, such as the image blurring, staircase (blocky) effect and speckle noise.

Our future research in the image inpainting domain will focus on developing new variational schemes and second-order PDE-based models, by proposing novel regularizer and diffusivity functions. Also, we will consider elaborating some image completion algorithms based on the nonlinear fourth-order diffusion based models.

@&#ACKNOWLEDGMENTS@&#

This work is mainly supported by project PN-II-RU-TE-2014-4-0083-126/01.10.2015 and the Institute of Computer Science of the Romanian Academy, Iaşi, Romania.

@&#REFERENCES@&#

