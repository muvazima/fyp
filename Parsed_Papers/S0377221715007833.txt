@&#MAIN-TITLE@&#Hybrid robust and stochastic optimization for closed-loop supply chain network design using accelerated Benders decomposition

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Flexibility in CLSCN design to cover demands and returns based on market conditions.


                        
                        
                           
                           A novel hybrid robust-stochastic programming approach.


                        
                        
                           
                           Scenario generation using Latin Hypercube Sampling with backward reduction.


                        
                        
                           
                           Accelerated Benders decomposition with valid inequalities and Pareto-optimal cuts.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Robustness and sensitivity analysis

Stochastic programming

Robust optimization

Closed-loop supply chain

Benders decomposition

@&#ABSTRACT@&#


               
               
                  Environmental, social and economic concerns motivate the operation of closed-loop supply chain networks (CLSCN) in many industries. We propose a novel profit maximization model for CLSCN design as a mixed-integer linear program in which there is flexibility in covering the proportions of demand satisfied and returns collected based on the firm's policies. Our major contribution is to develop a novel hybrid robust-stochastic programming (HRSP) approach to simultaneously model two different types of uncertainties by including stochastic scenarios for transportation costs and polyhedral uncertainty sets for demands and returns. Transportation cost scenarios are generated using a Latin Hypercube Sampling method and scenario reduction is applied to consolidate them. An accelerated stochastic Benders decomposition algorithm is proposed for solving this model. To speed up the convergence of this algorithm, valid inequalities are introduced to improve the lower bound quality, and also a Pareto-optimal cut generation scheme is used to strengthen the Benders optimality cuts. Numerical studies are performed to verify our mathematical formulation and also demonstrate the benefits of the HRSP approach. The performance improvements achieved by the valid inequalities and Pareto-optimal cuts are demonstrated in randomly generated instances.
               
            

@&#INTRODUCTION@&#

The growing need for remanufacturing and recycling due to resource scarcity and environmental concerns requires firms to coordinate the forward and reverse material flows in their supply chains. This motivates the design of a closed-loop supply chain network (CLSCN) to avoid sub-optimality arising from separate design of forward and reverse networks. As pointed out by Klibi, Martel, and Guitouni (2010), the design of a supply chain network is a crucial strategic decision, the effects of which will persist for many years while the business environment may change. Thus, some important parameters such as demand and costs are significantly uncertain. In addition, because opening or closing a facility is time-consuming and costly, making any change in these decisions in response to parameter oscillations is impossible within a short time frame (Pishvaee, Rabbani, & Torabi, 2011). Uncertainties are intensified in the reverse supply chain network where the quality and quantity of returned products vary unpredictably and fast. Therefore, the design of CLSCN should be robust to the inherent uncertainty in the network parameters.

Of the few recent relevant papers that consider uncertainty in the CLSCN design problem, most estimate the probability distributions for the parameters and then apply scenario-based stochastic programming (SP; e.g., Salema, Barbosa-Povoa, & Novais, 2007; Santoso, Ahmed, Goetschalckx, & Shapiro, 2005). SP is a powerful modeling tool when an accurate probabilistic description of the random variables is known. However, it has three main drawbacks (Bertsimas & Thiele, 2006; Gülpınar, Pachamanova, & Çanakoğlu, 2013). First, in many real-life applications not enough historical data are available to estimate distributions. For instance, predicting demand of a new product is challenging. Secondly, an accurate distribution approximation may require a large number of scenarios. But the more scenarios used for representing uncertainty, the harder it is to solve the problem to optimality. Conversely, if the number of scenarios is limited for computational reasons, the obtained solution may be infeasible for some realizations of uncertain parameters. Even if this occurs with very small probability, it could result in high cost due to the large scale of the CLSCN. Finally, SP models based on expected cost are appropriate when the decision maker worries about the average performance of the system. However, there are situations where the decision maker is concerned with the worst case. We highlight this concern with respect to uncertain demand and return quantities.

To avoid these drawbacks, robust optimization (RO) has emerged as an alternative methodology to cope with uncertainty in the input data. The robust counterpart is a deterministic reformulation of the original problem in which the worst case cost is minimized over all possible values the input parameters may take within predefined uncertainty sets. Two main advantages of RO compared with SP are (Alumur, Nickel, Saldanha-da-Gama, & Verter, 2012): first, independently of the number of uncertain parameters, the robust counterpart can remain computationally tractable, and second, rough historical data and decision makers’ experiences can be used to derive the boundaries of uncertainty sets, without the need for precise estimates of probability distributions.

The uncertain parameters we consider in our CLSCN design problem differ qualitatively. Historical data for transportation costs can be used to formulate probabilistic scenarios for them, but no such data for demand and return quantities of a new product exist. Because the purpose of the network is to supply products and collect the returns, we design it for the extreme quantities to ensure that its capacity and configuration will suffice in any event. The need to consider both types of uncertainty in an integrated network has been emphasized recently by Klibi and Martel (2012), Melo, Nickel, and Saldanha-da-Gama (2009) and Gabrel, Murat, and Thiele (2014).

This paper contributes to the CLSCN design literature by developing a novel hybrid robust-stochastic optimization approach and also devising an efficient solution procedure. Specifically, a mixed-integer linear program (MILP) is developed for a multi-period, single-product and capacitated CLSCN. The strategic decisions including locations and capacities of facilities as well as the tactical decisions including inventory levels, production amounts, and shipments among the network entities are determined to maximize the expected worst-case profit. The major contributions can be summarized as follows:

                        
                           •
                           To integrate both strategic and tactical decisions with flexibility to cover varying proportions of demands and customer returns.

To simultaneously model two different types of uncertainties including stochastic scenarios for transportation costs and polyhedral uncertainty sets for demand and return quantities, via a hybrid robust-stochastic programming (HRSP) approach.

To obtain a small but representative set of transportation cost scenarios using Latin Hypercube Sampling (LHS) followed by scenario reduction.

To strengthen the Benders master problem and improve the quality of the lower bound with two sets of valid inequalities (VI). Pareto-optimal cuts are also used to accelerate the convergence of the solution algorithm.

The remainder of this paper is organized as follows. In the next section, we briefly review the literature on the CLSCN design problem and the relevant solution methods. The problem and its stochastic formulation are defined in Section 3. Then, the HRSP approach is presented in Section 4. In Section 5, the scenario generation and reduction algorithm for transportation costs is presented. The stochastic Benders decomposition (BD) algorithm with some acceleration techniques for improving its convergence is provided in Section 6. Section 7 describes computational experiments and sensitivity analyses that allow us to derive managerial insights about this CLSCN. Finally, Section 8 concludes this paper and offers some suggestions for future research.

@&#LITERATURE REVIEW@&#

The relevant literature follows two separate but complementary streams. We first review studies of the CLSCN design problem and then discuss solution algorithms. A complete literature review for the CLSCN design problem based on problem features, supply chain stages, objective, modeling, uncertainty programming, uncertain parameters, decisions, and solution methods is provided in Keyvanshokooh (2015).

To avoid sub-optimality from modeling and designing forward and reverse networks separately, many researchers have integrated them in the more complex CLSCN (Melo et al., 2009). Many CLSCN models are inspired by facility location theory. In this regard, Melo et al. (2009) and Klibi et al. (2010) presented comprehensive reviews on the facility location models in supply chain planning and on supply chain network design under uncertainty, respectively. Moreover, Pokharel and Mutha (2009) summarized the current developments of reverse supply chains, while Brandenburg, Govindan, Sarkis, and Seuring (2014) and Dekker, Bloemhof, and Mallidis (2012) reviewed quantitative models that address environmental and social aspects in the supply chain.

Originally, Fleischmann et al. (2001) considered the integration of forward and reverse flows as a CLSCN using some case studies. They found that this integrated approach could provide a potential for a significant cost savings compared to a segregated approach. The research that followed was primarily carried out with simple facility location models (e.g. Aras, Aksen, & Gönül Tanuğur, 2008). Then, more complex models were proposed especially by considering the real-life characteristics (e.g. Cruz-Rivera & Ertel, 2009). The field has experienced a strong development over the last decade (e.g. Alumur et al., 2012; Baghalian, Rezapour, & Farahani, 2013; Cardoso, Barbosa-Póvoa, & Relvas, 2013; De Giovanni & Zaccour, 2014; Devika, Jafarian, & Nourbakhsh, 2014; Faccio, Persona, Sgarbossa, & Zanin, 2014; Gao & Ryan, 2014; Keyvanshokooh, Fattahi, Seyed-Hosseini, & Tavakkoli-Moghaddam, 2013; Klibi & Martel, 2012; Niknejad & Petrovic, 2014; Soleimani & Govindan, 2014).

Given that all activities in both forward and reverse supply chains are subject to considerable uncertainty, many works addressed the CLSCN design problem where some network parameters such as demand, return and costs are uncertain. In a pioneering step, Salema et al. (2007) extended the model of Fleischmann et al. (2001) to a multi-product and capacitated CLSCN considering uncertainty in demand and return. SP is the most popular tool applied to the configuration of a CLSCN under uncertainty. However, a limited number of studies employed RO (Pishvaee et al., 2011; Hasani, Zegordi, & Nikbakhsh, 2011). These applied a worst-case robust formulation (Soyster, 1973) which may result in an overly conservative solution. Considering this research gap, we apply a more recent RO approach (Bertsimas & Sim, 2004), which allows a tradeoff between optimality and robustness. To our knowledge, no existing research on CLSCN design combines probabilistic scenarios for some parameters with uncertainty sets for others. Fanzeres, Street, and Barroso (2015) applied a similar hybrid approach in the context of electricity markets.

Minimizing cost has been the primary objective in most CLSCN models. These models typically require that every customer's demand and return has to be satisfied. However, it may not always be optimal to satisfy all demands and returns. Sometimes, there is not much competition in target market, so the cost of losing customers will be very low. Hence, the firm may maximize its profit by losing some customers. On the other hand, sometimes profit is increased with better customer service. This paper includes flexibility to determine what fraction of customers to serve.

Because the CLSCN design problem is an NP-hard combinatorial optimization problem, many solution algorithms including metaheuristic, heuristic, and exact methods have been developed. Most solution methods employ standard commercial packages such as CPLEX to solve mixed-integer programming formulations. However, when the number of discrete variables is large, the resulting models can be solved only by using metaheuristic or heuristic methods to obtain a near optimal solution. But, because CLSCN design involves large investment and greatly influences the operational and tactical costs as well as efficiency of service, developing efficient exact algorithms for solving larger and more realistic cases is worthwhile (de Sá, de Camargo, & de Miranda, 2013). Among these exact solution approaches, branch-and-bound has been a popular methodology combined with other heuristics or Lagrangian relaxation. There are few papers that develop an exact solution scheme, a shortage highlighted by Klibi and Martel (2012).

As a discrete facility location problem, CLSCN design is an attractive candidate for decomposition. It involves both binary variables related to the strategic configuration, and continuous variables associated with tactical and operational decisions. Keyvanshokooh (2015) found just four papers in which decomposition schemes were applied. Among the decomposition techniques, the BD method (Benders, 1962) is a classical exact algorithm suitable for solving large-scale MILP problems having special structure in the constraint set; i.e., upon fixing the values of the complicating integer variables, the MILP problem reduces to an easy linear program.

However, classical BD and its stochastic version, called the L-shaped method, might not be efficient (Saharidis & Ierapetritou, 2010). The major issues resulting in its slow convergence are (1) solving the relaxed master problem (RMP) which is in fact an integer program or MILP, and (2) the quality of Benders cuts. To overcome these concerns, different acceleration techniques have been proposed to speed up BD. Magnanti and Wong (1981) defined a cut as Pareto-optimal and achieved significant improvement in convergence by applying such cuts to a problem with degenerate sub-problems. Saharidis, Minoux, and Ierapetritou (2010) introduced a covering cut bundle strategy by producing a bundle of cuts in each iteration to cover all decision variables of the MP. Some other modifications to this algorithm were presented by McDaniel and Devine (1977), Sherali and Lunday (2013), Tang, Jiang, and Saharidis (2013) and Oliveira, Grossmann, and Hamacher (2014) in different applications.

As illustrated by Fig. 1
                        , we consider a single product, multi-period, and capacitated CLSCN consisting of manufacturing/remanufacturing, distribution, collection, and disposal centers as well as retailers under demand, return and transportation cost uncertainty. The end-of-use products are collected from retailers, transported to collection centers, and after a quality test, divided into two categories: recoverable products sent to manufacturing/remanufacturing centers and scrapped products shipped to disposal centers. In the forward network, the remanufactured products along with the new ones are supplied to retailers from manufacturing/remanufacturing centers through distribution centers to meet their demand. We also assume a periodic review inventory policy for distribution centers to find inventory levels and include base-stock levels for these facilities as decision variables (Keyvanshokooh et al., 2013). However, it is assumed that the product is perishable and hence the excess amount of product in the retail facilities in one period cannot be used to satisfy the consumer demand of the next period.

This CLSCN model can apply to companies that are introducing new products to their target market consisting of their previous customers. For example, suppose an exclusive company produces desktop and notebook computers. To improve customer satisfaction, it decides to also provide after-sales service and, to this aim, they want to produce some components. On one hand, due to being an exclusive firm, these spare parts would appeal only to their customers who bought the computers from this company before, so there is not much competition in the target market. Thus, the risk of losing customers will be very low. Then, if a small penalty is considered for not satisfying demand or collecting returns, profit may be maximized by covering just a portion of demand and returns. On the other hand, if the company wants to emphasize satisfaction of customers, a high penalty cost should be considered. Our formulation allows any condition between these two extremes. Most CLSCN design models in the literature aim to satisfy the whole demand and return quantities, or they maximize profit without any attention to how much of the demand and returns they satisfy (Amin and Zhang, 2013; Keyvanshokooh et al., 2013). However, one of our goals is to design the network considering different conditions of the target market that affect the importance of these constraints.

In our model, if the flow from distribution centers to retailers exceeds the retailers’ demand, then a surplus cost proportional to the excess is charged. On the other hand, if the retailers’ demand is greater than the quantity delivered from distribution centers, then a penalty cost for unsatisfied demand is incurred. In the reverse network, if the flow from retailers to collection centers is greater than the potential returns, which is impossible in practice, then we apply a penalty cost per unit of excess flow. However, if this flow is less than the potential returns, then we impose a scrap cost per unit of uncollected returns. Defining the penalty, surplus, and scrap costs balances the forward flows with the demands and the reverse flows with the return quantities as much as possible while ensuring complete recourse (Birge & Louveaux, 1997) in the stochastic program.

The main concern of this paper is to design the CLSCN in the presence of uncertainty. Two different types of uncertainty are present; one for transportation costs and the other for demand and return quantities. During the last decade, the oscillations in fuel price have dramatically influenced transportation costs and it is quite likely that this uncertainty on fuel price will be sustained (Pishvaee, Jolai, & Razmi, 2009). We assume the firm has historical data for transportation cost distributions from its previous sales and so model this uncertainty with probabilistic scenarios.

On the other hand, forecasting the precise distribution of future demands and returns of a new product is very difficult. Demand could be affected by unexpected events such as the appearance of a new competitor and return quantities depend on customer use patterns. Stationarity of probability distributions cannot be guaranteed, especially in our multi-period planning horizon. Even if sufficient data are available to generate credible scenarios, considering many of them for both demands and returns will create computational challenges. Thus, we adopt a RO approach of formulating uncertainty sets instead of probability distributions for these quantities. The CLSCN design problem is to concurrently determine the location of facilities, their capacities, and base-stock levels as the first-stage decisions in light of the recourse production amounts and network flows to meet the worst-case demand and return quantities in each transportation cost scenario.

We first formulate a two-stage stochastic program with recourse for the CLSCN design problem assuming full knowledge of probability distributions for uncertain transportation costs. Regarding the uncertain demands and returns, we first consider their nominal values under each scenario for transportation cost. In the following subsection, we explain how uncertainty sets for these parameters are included in the HRSP approach. In the first-stage, strategic decisions such as locations and capacities of facilities as well as distribution base-stock levels are determined as the here-and-now decisions that should be made before realization of any uncertain parameters, and in the second-stage operational decisions such as network flows are made after realization of uncertain parameters. Define the following notation:


                        
                           Sets


                           
                              I
                           
                           
                              Potential locations of manufacturing/remanufacturing centers, i ∈ I
                              

Potential locations available for distribution and collection centers, j ∈ J
                              

Fixed locations of retailers, k ∈ K
                              

Fixed locations of disposal centers, r ∈ R
                              

Set of scenarios for transportation costs, s ∈ S
                              

Set of time periods in the planning horizon, t, p ∈ T
                              

Nominal demand (return of used product) of retailer k at time period t in scenario s
                              

Fixed cost for opening manufacturing/remanufacturing center i
                              

Fixed cost for opening distribution (collection) center j
                              

Revenue per unit of product sold by retailer k to customers

Unit manufacturing (remanufacturing) cost in manufacturing/remanufacturing center i
                              

Inventory cost per unit of product in time period t in distribution center j
                              

Unit collection/inspection cost in collection center j
                              

Unit disposal cost in disposal center r
                              

Penalty cost per unit of non-satisfied demands of retailer

Scrap cost per unit of uncollected returns of retailer

Surplus cost per unit of excess amounts of flow over demands received by retailers

Penalty cost per unit of excess amounts of flow over returns collected from retailers

Transportation cost per unit of product transported from manufacturing/remanufacturing center i to distribution center j in time period t in scenario s
                              

Transportation cost per unit of product transported from distribution center j to retailer k in time period t in scenario s
                              

Transportation cost per unit of returned product transported from retailer k to collection center j in time period t in scenario s
                              

Transportation cost per unit of recoverable product transported from collection center j to manufacturing/remanufacturing center i in time period t in scenario s
                              

Transportation cost per unit of scrapped product transported from collection center j to disposal center r in time period t in scenario s
                              

Capacity cost of manufacturing/remanufacturing center i per unit of products per period

Capacity cost of distribution (collection) center j per unit of products per period

Maximum available capacity of manufacturing/remanufacturing center i (units of products per period)

Maximum available capacity of distribution (collection) center j (units of products per period)

Fraction of returned products that can be remanufactured

Probability of transportation cost scenario s
                              

Binary variable equal to 1 if a manufacturing/remanufacturing center is opened at location i, 0 otherwise

Binary variable equal to 1 if a distribution (collection) center is opened at location j, 0 otherwise

Capacity of manufacturing/remanufacturing center i (units of products per period)

Capacity of distribution (collection) center j (units of products per period)

Quantity of products transported from manufacturing/remanufacturing center i to distribution center j in time period t in scenario s
                              

Quantity of products transported from distribution center j to retailer k in time period t in scenario s
                              

Quantity of returned products transported from retailer k to collection center j in time period t in scenario s
                              

Quantity of recoverable products transported from collection center j to manufacturing/remanufacturing center i in time period t in scenario s
                              

Quantity of scrapped products transported from collection center j to disposal center r in time period t in scenario s
                              

Quantity of products produced by manufacturing/remanufacturing center i in time period t in scenario s
                              

Base-stock level of product in distribution center j at the beginning of each period

The two-stage stochastic CLSCN design problem can be formulated as follows:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             M
                                             a
                                             x
                                             
                                             Z
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                             Q
                                             
                                                (
                                                X
                                                ,
                                                
                                                W
                                                ,
                                                
                                                B
                                                S
                                                )
                                             
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      F
                                                      i
                                                      
                                                         M
                                                         C
                                                      
                                                   
                                                   
                                                      X
                                                      i
                                                      
                                                         M
                                                         C
                                                      
                                                   
                                                   +
                                                   
                                                      C
                                                      i
                                                      
                                                         M
                                                         C
                                                      
                                                   
                                                   
                                                      W
                                                      i
                                                      
                                                         M
                                                         C
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      F
                                                      j
                                                      
                                                         D
                                                         C
                                                      
                                                   
                                                   
                                                      X
                                                      j
                                                      
                                                         D
                                                         C
                                                      
                                                   
                                                   +
                                                   
                                                      C
                                                      j
                                                      
                                                         D
                                                         C
                                                      
                                                   
                                                   
                                                      W
                                                      j
                                                      
                                                         D
                                                         C
                                                      
                                                   
                                                   +
                                                   
                                                      F
                                                      j
                                                      
                                                         C
                                                         C
                                                      
                                                   
                                                   
                                                      X
                                                      j
                                                      
                                                         C
                                                         C
                                                      
                                                   
                                                   +
                                                   
                                                      C
                                                      j
                                                      
                                                         C
                                                         C
                                                      
                                                   
                                                   
                                                      W
                                                      j
                                                      
                                                         C
                                                         C
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        S.t.
                        
                           
                              (2)
                              
                                 
                                    
                                       W
                                       i
                                       
                                          M
                                          C
                                       
                                    
                                    ≤
                                    C
                                    A
                                    
                                       P
                                       i
                                       
                                          M
                                          C
                                       
                                    
                                    
                                       X
                                       i
                                       
                                          M
                                          C
                                       
                                    
                                    
                                    
                                    
                                       
                                          
                                             W
                                             i
                                             
                                                M
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                D
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                C
                                                C
                                             
                                          
                                          ,
                                          B
                                          
                                             S
                                             j
                                          
                                          
                                          ≥
                                          0
                                       
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       W
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    ≤
                                    C
                                    A
                                    
                                       P
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    
                                       X
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    
                                    
                                    
                                       
                                          
                                             W
                                             i
                                             
                                                M
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                D
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                C
                                                C
                                             
                                          
                                          ,
                                          B
                                          
                                             S
                                             j
                                          
                                          
                                          ≥
                                          0
                                       
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       W
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    ≤
                                    C
                                    A
                                    
                                       P
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    
                                       X
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    
                                    
                                    
                                       
                                          
                                             W
                                             i
                                             
                                                M
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                D
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                C
                                                C
                                             
                                          
                                          ,
                                          B
                                          
                                             S
                                             j
                                          
                                          
                                          ≥
                                          0
                                       
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       W
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    ≥
                                    B
                                    
                                       S
                                       j
                                    
                                    
                                    
                                    
                                    
                                       
                                          
                                             W
                                             i
                                             
                                                M
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                D
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                C
                                                C
                                             
                                          
                                          ,
                                          B
                                          
                                             S
                                             j
                                          
                                          
                                          ≥
                                          0
                                       
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       X
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    +
                                    
                                       X
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    ≤
                                    1
                                    
                                    
                                    
                                       
                                          
                                             W
                                             i
                                             
                                                M
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                D
                                                C
                                             
                                          
                                          ,
                                          
                                             W
                                             j
                                             
                                                C
                                                C
                                             
                                          
                                          ,
                                          B
                                          
                                             S
                                             j
                                          
                                          
                                          ≥
                                          0
                                       
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       X
                                       i
                                       
                                          M
                                          C
                                       
                                    
                                    ,
                                    
                                       X
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    ,
                                    
                                       X
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    ,
                                    
                                    
                                    
                                       W
                                       i
                                       
                                          M
                                          C
                                       
                                    
                                    ,
                                    
                                       W
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    ,
                                    
                                       W
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    ,
                                    B
                                    
                                       S
                                       j
                                    
                                    
                                    ≥
                                    0
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                    
                                    ,
                                    
                                    j
                                    ∈
                                    J
                                 
                              
                           
                        where 
                           
                              Q
                              
                                 (
                                 X
                                 ,
                                 
                                 W
                                 ,
                                 
                                 B
                                 S
                                 )
                              
                              
                              =
                              
                              
                                 E
                                 ζ
                              
                              
                                 [
                                 
                                    ϑ
                                    (
                                    
                                       X
                                       ,
                                       
                                       W
                                       ,
                                       
                                       B
                                       S
                                       ,
                                       
                                          ζ
                                          s
                                       
                                    
                                    )
                                 
                                 
                                 ]
                              
                              
                              =
                              
                              
                                 ∑
                                 s
                              
                              
                                 P
                                 
                                    r
                                    s
                                 
                              
                              
                              ×
                              
                              ϑ
                              
                                 (
                                 
                                    X
                                    ,
                                    
                                    W
                                    ,
                                    
                                    B
                                    S
                                    ,
                                    
                                       ζ
                                       s
                                    
                                 
                                 )
                              
                           
                        . Eζ
                        [ϑ(X, W, BS, ζs
                        )] denotes the recourse function. For a given scenario ζs
                        , ϑ(X, W, BS, ζs
                        ) is the optimal objective function value of the second-stage problem (8)–(24):

                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             ϑ
                                             
                                                (
                                                
                                                   X
                                                   ,
                                                   
                                                   W
                                                   ,
                                                   
                                                   B
                                                   S
                                                   ,
                                                   
                                                      ζ
                                                      s
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             
                                             M
                                             a
                                             x
                                             
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             [
                                             P
                                             
                                                R
                                                k
                                             
                                             F
                                             J
                                             
                                                K
                                                
                                                   j
                                                   k
                                                   s
                                                
                                                t
                                             
                                             −
                                             C
                                             J
                                             
                                                K
                                                
                                                   j
                                                   k
                                                   s
                                                
                                                t
                                             
                                             F
                                             J
                                             
                                                K
                                                
                                                   j
                                                   k
                                                   s
                                                
                                                t
                                             
                                             −
                                             C
                                             K
                                             
                                                J
                                                
                                                   k
                                                   j
                                                   s
                                                
                                                t
                                             
                                             F
                                             K
                                             
                                                J
                                                
                                                   k
                                                   j
                                                   s
                                                
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             C
                                             
                                                C
                                                j
                                             
                                             F
                                             K
                                             
                                                J
                                                
                                                   k
                                                   j
                                                   s
                                                
                                                t
                                             
                                             ]
                                             
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         C
                                                         I
                                                         
                                                            J
                                                            
                                                               i
                                                               j
                                                               s
                                                            
                                                            t
                                                         
                                                         F
                                                         I
                                                         
                                                            J
                                                            
                                                               i
                                                               j
                                                               s
                                                            
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   +
                                                   C
                                                   J
                                                   
                                                      I
                                                      
                                                         j
                                                         i
                                                         s
                                                      
                                                      t
                                                   
                                                   
                                                   F
                                                   J
                                                   
                                                      I
                                                      
                                                         j
                                                         i
                                                         s
                                                      
                                                      t
                                                   
                                                   +
                                                   R
                                                   
                                                      C
                                                      i
                                                   
                                                   F
                                                   J
                                                   
                                                      I
                                                      
                                                         j
                                                         i
                                                         s
                                                      
                                                      t
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      r
                                                      ∈
                                                      R
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         C
                                                         J
                                                         
                                                            R
                                                            
                                                               j
                                                               r
                                                               s
                                                            
                                                            t
                                                         
                                                         F
                                                         J
                                                         
                                                            R
                                                            
                                                               j
                                                               r
                                                               s
                                                            
                                                            t
                                                         
                                                         +
                                                         D
                                                         
                                                            C
                                                            r
                                                         
                                                         F
                                                         J
                                                         
                                                            R
                                                            
                                                               j
                                                               r
                                                               s
                                                            
                                                            t
                                                         
                                                      
                                                      ]
                                                   
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   M
                                                   
                                                      C
                                                      i
                                                   
                                                   P
                                                   
                                                      I
                                                      
                                                         i
                                                         s
                                                      
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  p
                                                                  ≤
                                                                  t
                                                               
                                                            
                                                            
                                                               F
                                                               I
                                                               
                                                                  J
                                                                  
                                                                     i
                                                                     j
                                                                     s
                                                                  
                                                                  p
                                                               
                                                               −
                                                               
                                                                  ∑
                                                                  
                                                                     k
                                                                     ∈
                                                                     K
                                                                  
                                                               
                                                               
                                                                  
                                                                     ∑
                                                                     
                                                                        p
                                                                        ≤
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     F
                                                                     J
                                                                     
                                                                        K
                                                                        
                                                                           j
                                                                           k
                                                                           s
                                                                        
                                                                        p
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   I
                                                   
                                                      C
                                                      j
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        S.t.
                        
                           
                              (9)
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       F
                                       J
                                       
                                          K
                                          
                                             j
                                             k
                                             s
                                          
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          D
                                          ^
                                       
                                       
                                          k
                                          s
                                       
                                       t
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       F
                                       K
                                       
                                          J
                                          
                                             k
                                             j
                                             s
                                          
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          R
                                          ^
                                       
                                       
                                          k
                                          s
                                       
                                       t
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             p
                                             ≤
                                             t
                                          
                                       
                                       
                                          F
                                          J
                                          
                                             K
                                             
                                                j
                                                k
                                                s
                                             
                                             p
                                          
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             p
                                             ≤
                                             t
                                          
                                       
                                       
                                          F
                                          I
                                          
                                             J
                                             
                                                i
                                                j
                                                s
                                             
                                             p
                                          
                                       
                                    
                                    ≤
                                    0
                                    
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             p
                                             ≤
                                             t
                                          
                                       
                                       
                                          F
                                          I
                                          
                                             J
                                             
                                                i
                                                j
                                                s
                                             
                                             p
                                          
                                          
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             p
                                             <
                                             t
                                          
                                       
                                       
                                          F
                                          J
                                          
                                             K
                                             
                                                j
                                                k
                                                s
                                             
                                             p
                                          
                                       
                                    
                                    =
                                    B
                                    
                                       S
                                       j
                                    
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    P
                                    
                                       I
                                       
                                          i
                                          s
                                       
                                       t
                                    
                                    +
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       F
                                       J
                                       
                                          I
                                          
                                             j
                                             i
                                             s
                                          
                                          t
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       F
                                       I
                                       
                                          J
                                          
                                             i
                                             j
                                             s
                                          
                                          t
                                       
                                    
                                    
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    a
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                    
                                       F
                                       K
                                       
                                          J
                                          
                                             k
                                             j
                                             s
                                          
                                          t
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       F
                                       J
                                       
                                          I
                                          
                                             j
                                             i
                                             s
                                          
                                          t
                                       
                                    
                                    
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       (
                                       
                                          1
                                          −
                                          a
                                       
                                       )
                                    
                                    
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                    
                                       F
                                       K
                                       
                                          J
                                          
                                             k
                                             j
                                             s
                                          
                                          t
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          r
                                          ∈
                                          R
                                       
                                    
                                    
                                       F
                                       J
                                       
                                          R
                                          
                                             j
                                             r
                                             s
                                          
                                          t
                                       
                                    
                                    
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    P
                                    
                                       I
                                       
                                          i
                                          s
                                       
                                       t
                                    
                                    +
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       F
                                       J
                                       
                                          I
                                          
                                             j
                                             i
                                             s
                                          
                                          t
                                       
                                    
                                    ≤
                                    
                                       W
                                       i
                                       
                                          M
                                          C
                                       
                                    
                                    
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       F
                                       I
                                       
                                          J
                                          
                                             i
                                             j
                                             s
                                          
                                          t
                                       
                                    
                                    ≤
                                    
                                       W
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                    
                                       F
                                       K
                                       
                                          J
                                          
                                             k
                                             j
                                             s
                                          
                                          t
                                       
                                    
                                    ≤
                                    
                                       W
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    F
                                    I
                                    
                                       J
                                       
                                          i
                                          j
                                          s
                                       
                                       t
                                    
                                    ≤
                                    M
                                    .
                                    
                                    
                                       X
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    F
                                    J
                                    
                                       K
                                       
                                          j
                                          k
                                          s
                                       
                                       t
                                    
                                    ≤
                                    M
                                    .
                                    
                                    
                                       X
                                       j
                                       
                                          D
                                          C
                                       
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    F
                                    K
                                    
                                       J
                                       
                                          k
                                          j
                                          s
                                       
                                       t
                                    
                                    ≤
                                    M
                                    .
                                    
                                    
                                       X
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    F
                                    J
                                    
                                       I
                                       
                                          j
                                          i
                                          s
                                       
                                       t
                                    
                                    ≤
                                    M
                                    .
                                    
                                    
                                       X
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    F
                                    J
                                    
                                       R
                                       
                                          j
                                          r
                                          s
                                       
                                       t
                                    
                                    ≤
                                    M
                                    .
                                    
                                    
                                       X
                                       j
                                       
                                          C
                                          C
                                       
                                    
                                    
                                    
                                    ∀
                                    r
                                    ∈
                                    R
                                    ,
                                    
                                    
                                    j
                                    ∈
                                    J
                                    ,
                                    
                                    
                                    t
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             F
                                             I
                                             
                                                J
                                                
                                                   i
                                                   j
                                                   s
                                                
                                                t
                                             
                                             ,
                                             F
                                             J
                                             
                                                K
                                                
                                                   j
                                                   k
                                                   s
                                                
                                                t
                                             
                                             ,
                                             F
                                             K
                                             
                                                J
                                                
                                                   k
                                                   j
                                                   s
                                                
                                                t
                                             
                                             ,
                                             F
                                             J
                                             
                                                I
                                                
                                                   j
                                                   i
                                                   s
                                                
                                                t
                                             
                                             ,
                                             F
                                             J
                                             
                                                R
                                                
                                                   j
                                                   r
                                                   s
                                                
                                                t
                                             
                                             ,
                                             P
                                             
                                                I
                                                
                                                   i
                                                   s
                                                
                                                t
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             i
                                             ∈
                                             I
                                             ,
                                             
                                             
                                             j
                                             ∈
                                             J
                                             ,
                                             
                                             
                                             r
                                             ∈
                                             R
                                             ,
                                             
                                             
                                             k
                                             ∈
                                             K
                                             ,
                                             
                                             
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The objective (1) is to maximize the expected total second-stage profit less the first-stage costs including fixed costs of opening facilities and capacity costs. The second-stage profit (8) includes the revenue from selling new products less transportation costs, inventory costs, manufacturing costs of new products and remanufacturing costs of used products, collection costs of used products, and disposal costs of scrapped product. Constraints (2)–(4) ensure capacity restrictions for manufacturing/remanufacturing, distribution and collection centers, respectively. Constraints (5) guarantee that the capacity of each distribution center is at least equal to its base-stock level. Constraints (6) ensure that at each location j just one of distribution or collection centers is opened. Constraints (9) and (10) assure that the nominal demand of retailers are satisfied by the distribution centers and also the nominal returns of used products from retailers are collected by the collection centers, respectively. In the next section, we will explain how we incorporate uncertainty sets for these parameters. Constraint (11) assures the flow balance for each distribution centers. Constraints (12) enforce base-stock levels for each distribution center in scenario s and period t. Constraints (13)–(15) ensure the flow balance for manufacturing/remanufacturing and collection centers. Constraints (16)–(18) express the capacity constraints for the manufacturing/remanufacturing, distribution and collection centers, respectively. Constraints (19)–(23) connect the binary variables for facility existence with the corresponding flows, where M is a large number. Finally, constraints (7) and (24) enforce the binary and non-negativity restrictions on decision variables.

First, we briefly review a RO approach presented by Bertsimas and Sim (2003, 2004) as a prelude to describing our HRSP formulation. Consider the linear program (LP) where C is an n-vector, A is a m × n matrix, and b is an m-vector:

                        
                           (25)
                           
                              
                                 M
                                 i
                                 n
                                 
                                 
                                 C
                                 x
                                 
                                 
                                 s
                                 .
                                 
                                 t
                                 .
                                 
                                 
                                 A
                                 x
                                 ≤
                                 b
                                 ,
                                 
                                 x
                                 ≥
                                 0
                              
                           
                        
                     
                  

Assume uncertainty only affects the elements of matrix A. That is, consider a particular row i of A and let Ji
                      represent the set of coefficients in row i of A subject to uncertainty. Each data element 
                        
                           
                              
                                 a
                                 ˜
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           j
                           ∈
                           
                              J
                              i
                           
                        
                      is modeled as a bounded and independent random variable taking value in an interval 
                        
                           [
                           
                              
                                 
                                    a
                                    ^
                                 
                                 
                                    i
                                    j
                                 
                              
                              −
                              
                                 a
                                 
                                    i
                                    j
                                 
                              
                              ,
                              
                                 
                                    a
                                    ^
                                 
                                 
                                    i
                                    j
                                 
                              
                              +
                              
                                 a
                                 
                                    i
                                    j
                                 
                              
                           
                           ]
                        
                      where 
                        
                           
                              a
                              ^
                           
                           
                              i
                              j
                           
                        
                      is the nominal value and aij
                      is the maximum deviation from this nominal value. With this assumption, LP (25) is reformulated as:

                        
                           (26)
                           
                              
                                 M
                                 i
                                 n
                                 
                                 
                                 C
                                 x
                                 
                                 
                                 s
                                 .
                                 
                                 t
                                 .
                                 
                                 
                                    
                                       m
                                       a
                                       x
                                    
                                    
                                       ∀
                                       
                                          
                                             a
                                             ˜
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ∈
                                       
                                          J
                                          i
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∑
                                          j
                                       
                                       
                                          
                                             
                                                a
                                                ˜
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             j
                                          
                                       
                                    
                                    )
                                 
                                 
                                 ≤
                                 
                                    b
                                    i
                                 
                                 
                                 
                                 
                                 ∀
                                 i
                                 ,
                                 
                                 
                                 x
                                 ≥
                                 0
                              
                           
                        
                     
                  

Then, we define a scaled deviation 
                        
                           
                              z
                              
                                 i
                                 j
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       
                                          a
                                          ˜
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          a
                                          ^
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                                 )
                              
                              /
                              
                                 a
                                 
                                    i
                                    j
                                 
                              
                           
                        
                      from its nominal value of 
                        
                           
                              a
                              ^
                           
                           
                              i
                              j
                           
                        
                      that always belongs to the interval

                        
                           [
                           
                              −
                              1
                              ,
                              1
                           
                           ]
                        
                     . Note that 
                        
                           
                              a
                              ˜
                           
                           
                              i
                              j
                           
                        
                     , 
                        
                           
                              a
                              ^
                           
                           
                              i
                              j
                           
                        
                      and aij
                      denote the uncertain value, its nominal value and its maximum deviation from the nominal value, respectively. It is unlikely that all of the uncertain input 
                        
                           
                              
                                 a
                                 ˜
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           j
                           ∈
                           
                              J
                              i
                           
                        
                      will realize their worst-case values simultaneously. Thus, a maximum number of parameters that can deviate from their nominal values for each constraint i is considered as Γi
                     , called the budget of uncertainty, where Γi
                      ∈ [0, |Ji
                     |]. The aggregated scaled deviation of uncertain parameters for constraint i is bounded as 
                        
                           
                              ∑
                              
                                 j
                                 ∈
                                 
                                    J
                                    i
                                 
                              
                           
                           
                              
                                 |
                              
                              
                                 z
                                 
                                    i
                                    j
                                 
                              
                              
                                 |
                              
                           
                           ≤
                           
                              Γ
                              i
                           
                           ,
                           
                           ∀
                           i
                        
                     .

The budget of uncertainty plays a crucial role in adjusting the solution's level of conservatism against the robustness. If 
                        
                           
                              Γ
                              i
                           
                           =
                           0
                        
                     , it reduces to the nominal formulation where there is no protection against uncertainty. If 
                        
                           
                              Γ
                              i
                           
                           =
                           
                              |
                              
                                 J
                                 i
                              
                              |
                           
                        
                     , the ith constraint is completely protected against the worst-case realization of uncertain parameters. Finally, if Γi
                      ∈ (0, |Ji
                     |) the decision maker considers a trade-off between conservatism and cost of the solution against the level of protection against constraint violation. Based on this definition, the set Ji
                      is defined as

                        
                           
                              J
                              i
                           
                           =
                           
                              {
                              
                                 
                                    
                                       a
                                       ˜
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    |
                                 
                                 
                                    
                                       
                                          a
                                          ˜
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          a
                                          ^
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       z
                                       
                                          i
                                          j
                                       
                                    
                                    ,
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ,
                                    z
                                    ∈
                                    Ω
                                 
                              
                              }
                           
                        
                      where

                        
                           Ω
                           =
                           {
                           
                              
                                 z
                                 |
                              
                              
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       z
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    
                                       Γ
                                       i
                                    
                                 
                                 ,
                                 
                                 
                                 
                                    |
                                    
                                       z
                                       
                                          i
                                          j
                                       
                                    
                                    |
                                 
                                 ≤
                                 1
                                 ,
                                 
                                 ∀
                                 i
                              
                           
                           }
                        
                     . Restating each constraint i as

                        
                           
                              ∑
                              j
                           
                           
                              
                                 
                                    a
                                    ˜
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 x
                                 j
                              
                           
                           =
                           
                              ∑
                              j
                           
                           
                              
                                 (
                                 
                                    
                                       
                                          a
                                          ^
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       z
                                       
                                          i
                                          j
                                       
                                    
                                 
                                 )
                              
                              
                                 x
                                 j
                              
                           
                           =
                           
                              ∑
                              j
                           
                           
                              
                                 
                                    a
                                    ^
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 x
                                 j
                              
                           
                           +
                           
                              ∑
                              j
                           
                           
                              
                                 a
                                 
                                    i
                                    j
                                 
                              
                              
                                 z
                                 
                                    i
                                    j
                                 
                              
                              
                                 x
                                 j
                              
                           
                        
                     , LP (26) can be reformulated as:

                        
                           (27)
                           
                              
                                 M
                                 i
                                 n
                                 
                                 
                                 C
                                 x
                                 
                                 
                                 
                                 s
                                 .
                                 
                                 t
                                 .
                                 
                                 
                                 
                                 
                                    ∑
                                    j
                                 
                                 
                                    
                                       
                                          a
                                          ^
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       x
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       M
                                       a
                                       x
                                    
                                    
                                       
                                       
                                          
                                             z
                                             i
                                          
                                          ∈
                                          
                                             Ω
                                             i
                                          
                                       
                                    
                                 
                                 
                                 
                                    ∑
                                    j
                                 
                                 
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       z
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       x
                                       j
                                    
                                 
                                 ≤
                                 
                                    b
                                    i
                                 
                                 
                                 
                                 ∀
                                 i
                                 ,
                                 
                                 
                                 x
                                 ≥
                                 0
                              
                           
                        
                     
                  

The lower level problem 
                        
                           
                              
                                 M
                                 a
                                 x
                              
                              
                                 
                                    z
                                    i
                                 
                                 ∈
                                 
                                    Ω
                                    i
                                 
                              
                           
                           
                           
                              ∑
                              j
                           
                           
                              
                                 a
                                 
                                    i
                                    j
                                 
                              
                              
                                 z
                                 
                                    i
                                    j
                                 
                              
                              
                                 x
                                 j
                              
                           
                        
                      for a given vector
x* is equivalent to LP (28):

                        
                           (28)
                           
                              
                                 M
                                 a
                                 x
                                 
                                 
                                    ∑
                                    j
                                 
                                 
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       z
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       x
                                       j
                                       *
                                    
                                 
                                 
                                 
                                 
                                 s
                                 .
                                 
                                 t
                                 .
                                 
                                 
                                 
                                 
                                    ∑
                                    j
                                 
                                 
                                    z
                                    
                                       i
                                       j
                                    
                                 
                                 ≤
                                 
                                    Γ
                                    i
                                 
                                 
                                 
                                 
                                 ∀
                                 i
                                 ,
                                 
                                 
                                 0
                                 ≤
                                 
                                    z
                                    
                                       i
                                       j
                                    
                                 
                                 ≤
                                 1
                                 
                                 
                                 ∀
                                 j
                                 ∈
                                 
                                    J
                                    i
                                 
                              
                           
                        
                     
                  

Then by introducing the dual variables λi
                      and μij
                     , the dual of LP (28) is:

                        
                           (29)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          M
                                          i
                                          n
                                          
                                          
                                          
                                             Γ
                                             i
                                          
                                          
                                             λ
                                             i
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   J
                                                   i
                                                
                                             
                                          
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                          
                                          
                                          
                                          s
                                          .
                                          
                                          t
                                          .
                                          
                                          
                                          
                                          
                                             λ
                                             i
                                          
                                          +
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             j
                                             *
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             i
                                          
                                          ,
                                          
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          0
                                          
                                          
                                          ∀
                                          j
                                          ∈
                                          
                                             J
                                             i
                                          
                                          ,
                                          
                                          
                                             λ
                                             i
                                          
                                          ≥
                                          0
                                          
                                          
                                          ∀
                                          i
                                       
                                    
                                 
                              
                           
                        
                     
                  

The dual (29) is applied to LP (27) to obtain the robust counterpart of LP (25):

                        
                           (30)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          M
                                          i
                                          n
                                          
                                          
                                          C
                                          x
                                          
                                          
                                          
                                          s
                                          .
                                          
                                          t
                                          .
                                          
                                          
                                          
                                          
                                             
                                                a
                                                ^
                                             
                                             i
                                          
                                          x
                                          −
                                          
                                             Γ
                                             i
                                          
                                          
                                             λ
                                             i
                                          
                                          −
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   J
                                                   i
                                                
                                             
                                          
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                          
                                          ≤
                                          
                                             b
                                             i
                                          
                                          
                                          ∀
                                          i
                                          ,
                                          
                                          
                                             λ
                                             i
                                          
                                          +
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             j
                                          
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             i
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                             μ
                                             
                                                i
                                                j
                                             
                                          
                                          ,
                                          
                                          
                                             λ
                                             i
                                          
                                          
                                          ≥
                                          0
                                          
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             J
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

This RO approach provides an efficient way to determine bounds on the probability of violation of each constraint. Let 
                        
                           x
                           j
                           *
                        
                      be the robust solution, then the violation probability of the ith constraint is calculated by:

                        
                           (31)
                           
                              
                                 P
                                 r
                                 
                                    (
                                    
                                       
                                          ∑
                                          j
                                       
                                       
                                          
                                             
                                                a
                                                ˜
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             j
                                             *
                                          
                                          <
                                          
                                             b
                                             i
                                          
                                       
                                    
                                    )
                                 
                                 
                                 ≤
                                 1
                                 −
                                 Φ
                                 
                                    (
                                    
                                       
                                          (
                                          
                                             
                                                Γ
                                                i
                                             
                                             −
                                             1
                                          
                                          )
                                       
                                       
                                          
                                             |
                                             
                                                J
                                                i
                                             
                                             |
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     where Φ(.) is the standard normal cumulative distribution function. This upper bound provides a way of assigning a proper budget of uncertainty to each constraint when our uncertain parameters are independent and symmetrically distributed random variables in their associated uncertainty set.

In our HRSP approach for CLSCN, within each transportation cost scenario we define polyhedral uncertainty sets for demand and return in each period and for each retailer. Fig. 2 illustrates the arrangement of the polyhedral uncertainty sets for demands of retailers in different periods for different transportation cost scenarios. The uncertain demands and returns are allowed to deviate from a nominal scenario toward a worst-case realization within a constrained polyhedral uncertainty set. For simplicity, Fig. 2 shows uncertainty sets for demand only.

To develop the uncertainty sets, first we define the positive and negative deviation percentages from the nominal scenario for demands and returns, respectively, as follows:

                        
                           (32)
                           
                              
                                 η
                                 
                                    D
                                    
                                       k
                                       s
                                    
                                    
                                       t
                                       +
                                    
                                 
                                 =
                                 
                                    
                                       
                                          D
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                       −
                                       
                                          
                                             D
                                             ^
                                          
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                    
                                    
                                       Δ
                                       
                                          D
                                          
                                             k
                                             s
                                          
                                          
                                             t
                                             +
                                          
                                       
                                    
                                 
                                 
                                 
                                 
                                 
                                 
                                 if
                                 
                                 
                                 
                                 
                                    D
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 >
                                 
                                    
                                       D
                                       ^
                                    
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ,
                                 
                                 η
                                 
                                    D
                                    
                                       k
                                       s
                                    
                                    
                                       t
                                       −
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             D
                                             ^
                                          
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                       −
                                       
                                          D
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                    
                                    
                                       Δ
                                       
                                          D
                                          
                                             k
                                             s
                                          
                                          
                                             t
                                             −
                                          
                                       
                                    
                                 
                                 
                                 
                                 
                                 
                                 
                                 if
                                 
                                 
                                 
                                 
                                 
                                    D
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 <
                                 
                                    
                                       D
                                       ^
                                    
                                    
                                       k
                                       s
                                    
                                    t
                                 
                              
                           
                        
                     
                     
                        
                           (33)
                           
                              
                                 η
                                 
                                    R
                                    
                                       k
                                       s
                                    
                                    
                                       t
                                       +
                                    
                                 
                                 =
                                 
                                    
                                       
                                          R
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                       −
                                       
                                          
                                             R
                                             ^
                                          
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                    
                                    
                                       Δ
                                       
                                          R
                                          
                                             k
                                             s
                                          
                                          
                                             t
                                             +
                                          
                                       
                                    
                                 
                                 
                                 
                                 
                                 
                                 
                                 if
                                 
                                 
                                 
                                 
                                 
                                    R
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 >
                                 
                                    
                                       R
                                       ^
                                    
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ,
                                 
                                 η
                                 
                                    R
                                    
                                       k
                                       s
                                    
                                    
                                       t
                                       −
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             R
                                             ^
                                          
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                       −
                                       
                                          R
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                    
                                    
                                       Δ
                                       
                                          R
                                          
                                             k
                                             s
                                          
                                          
                                             t
                                             −
                                          
                                       
                                    
                                 
                                 
                                 
                                 
                                 
                                 
                                 if
                                 
                                 
                                 
                                 
                                 
                                    R
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 <
                                 
                                    
                                       R
                                       ^
                                    
                                    
                                       k
                                       s
                                    
                                    t
                                 
                              
                           
                        
                     
                  

Then, the uncertainty sets of demand and return for each scenario of transportation costs are:

                        
                           (34)
                           
                              
                                 
                                    
                                       
                                          J
                                          s
                                          D
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          
                                             |
                                             
                                                
                                                   D
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                =
                                                
                                                   
                                                      D
                                                      ^
                                                   
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                Δ
                                                
                                                   D
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      +
                                                   
                                                
                                                ×
                                                η
                                                
                                                   D
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      +
                                                   
                                                
                                                −
                                                Δ
                                                
                                                   D
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      −
                                                   
                                                
                                                ×
                                                η
                                                
                                                   D
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      −
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ∀
                                          k
                                          ,
                                          t
                                          ,
                                          ∀
                                          η
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          ,
                                          η
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                −
                                             
                                          
                                          ∈
                                          
                                             K
                                             D
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        
                     where

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             K
                                             D
                                          
                                          =
                                          {
                                          η
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          ,
                                          η
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                −
                                             
                                          
                                          
                                             |
                                             0
                                             ≤
                                             η
                                             
                                                D
                                                
                                                   k
                                                   s
                                                
                                                
                                                   t
                                                   +
                                                
                                             
                                             ≤
                                             1
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          
                                             0
                                             ≤
                                             η
                                             
                                                D
                                                
                                                   k
                                                   s
                                                
                                                
                                                   t
                                                   −
                                                
                                             
                                             ≤
                                             1
                                             ,
                                          
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                K
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                (
                                                
                                                   η
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         +
                                                      
                                                   
                                                   +
                                                   η
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         −
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          ≤
                                          
                                             Γ
                                             s
                                             D
                                          
                                          }
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Similarly,

                        
                           (35)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             J
                                             s
                                             R
                                          
                                          =
                                          {
                                          
                                             R
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          
                                             |
                                             
                                                
                                                   R
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                =
                                                
                                                   
                                                      R
                                                      ^
                                                   
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                Δ
                                                
                                                   R
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      +
                                                   
                                                
                                                ×
                                                η
                                                
                                                   R
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      +
                                                   
                                                
                                                −
                                                Δ
                                                
                                                   R
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      −
                                                   
                                                
                                                ×
                                                η
                                                
                                                   R
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      −
                                                   
                                                
                                             
                                          
                                          ,
                                          ∀
                                          k
                                          ,
                                          t
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ∀
                                          η
                                          
                                             R
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          ,
                                          η
                                          
                                             R
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                −
                                             
                                          
                                          ∈
                                          
                                             K
                                             R
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        
                     where

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             K
                                             R
                                          
                                          =
                                          {
                                          η
                                          
                                             R
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          ,
                                          η
                                          
                                             R
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                −
                                             
                                          
                                          
                                             |
                                             0
                                             ≤
                                             η
                                             
                                                R
                                                
                                                   k
                                                   s
                                                
                                                
                                                   t
                                                   +
                                                
                                             
                                             ≤
                                             1
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             0
                                             ≤
                                             η
                                             
                                                R
                                                
                                                   k
                                                   s
                                                
                                                
                                                   t
                                                   −
                                                
                                             
                                             ≤
                                             1
                                             ,
                                          
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                K
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                (
                                                
                                                   η
                                                   
                                                      R
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         +
                                                      
                                                   
                                                   +
                                                   η
                                                   
                                                      R
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         −
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          ≤
                                          
                                             Γ
                                             s
                                             R
                                          
                                          }
                                       
                                    
                                 
                              
                           
                        
                     
                  

The dimension of these sets is |K| × |T| for each transportation cost scenario. The parameter 
                        
                           Γ
                           s
                           D
                        
                      in (34) is the budget of uncertainty for demand in scenario s via which we can constrain the number of periods in which the demand may deviate from its nominal value. Similar definitions apply to the polyhedral uncertainty sets for returns in (35).

Allowing for this uncertainty implies that constraints (9) and (10) may not be satisfied. In the HRSP, we relax these constraints and penalize their violation in the objective function. By doing so, we provide the decision maker with flexibility to allow violations in either direction. For example, if the company is in a very competitive market setting where it does not want to lose any customer, then we can increase the penalty for unsatisfied demand. On the other hand, if the manufacturing and remanufacturing resources of company are restricted or the cost price of the product is high, and also if there is not much competition in the target market, then it can increase the surplus cost per unit of excess flow to retailers. In Section 7.1.2, we investigate the effects of these parameter values on the CLSCN design solution.

Our purpose is to minimize the worst-case costs associated with violations of (9) and (10). To incorporate the uncertainty sets (34) and (35) in the stochastic formulation (1)–(8), (11)–(24), we isolate the objective function terms containing random demand and return parameters for scenario s as the following nonlinear expression:

                        
                           (36)
                           
                              
                                 
                                    
                                       
                                          P
                                          
                                             C
                                             s
                                          
                                          
                                             (
                                             
                                                F
                                                J
                                                K
                                                ,
                                                F
                                                K
                                                J
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                M
                                                a
                                                x
                                             
                                             
                                                
                                                   D
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                ∈
                                                
                                                   J
                                                   s
                                                   D
                                                
                                             
                                          
                                          
                                             [
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      t
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      F
                                                      J
                                                      
                                                         K
                                                         
                                                            j
                                                            k
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                          P
                                          
                                             C
                                             D
                                          
                                          ,
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      K
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  ∈
                                                                  J
                                                               
                                                            
                                                            
                                                               F
                                                               J
                                                               
                                                                  K
                                                                  
                                                                     j
                                                                     k
                                                                     s
                                                                  
                                                                  t
                                                               
                                                            
                                                            −
                                                            
                                                               D
                                                               
                                                                  k
                                                                  s
                                                               
                                                               t
                                                            
                                                         
                                                         )
                                                      
                                                      ×
                                                      S
                                                      
                                                         C
                                                         D
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             
                                                M
                                                a
                                                x
                                             
                                             
                                                
                                                
                                                   R
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                ∈
                                                
                                                   J
                                                   s
                                                   R
                                                
                                             
                                          
                                          
                                             [
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      R
                                                      
                                                         k
                                                         s
                                                      
                                                      t
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      F
                                                      K
                                                      
                                                         J
                                                         
                                                            k
                                                            j
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                          S
                                          
                                             C
                                             R
                                          
                                          ,
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      K
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  ∈
                                                                  J
                                                               
                                                            
                                                            
                                                               F
                                                               K
                                                               
                                                                  J
                                                                  
                                                                     k
                                                                     j
                                                                     s
                                                                  
                                                                  t
                                                               
                                                            
                                                            −
                                                            
                                                               R
                                                               
                                                                  k
                                                                  s
                                                               
                                                               t
                                                            
                                                         
                                                         )
                                                      
                                                      ×
                                                      P
                                                      
                                                         C
                                                         R
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

For each transportation cost scenario, this term represents the worst-case value for penalty, scrap and surplus costs. We reformulate this nonlinear optimization problem (36) as the following LP for each scenario s by defining auxiliary variables Z1
                        s
                      and Z2
                        s
                     :

                        
                           (37)
                           
                              
                                 
                                    Min
                                    
                                       Z
                                       
                                          1
                                          s
                                       
                                       ,
                                       Z
                                       
                                          2
                                          s
                                       
                                    
                                 
                                 P
                                 
                                    C
                                    s
                                 
                                 
                                    (
                                    
                                       F
                                       J
                                       K
                                       ,
                                       F
                                       K
                                       J
                                    
                                    )
                                 
                                 =
                                 Z
                                 
                                    1
                                    s
                                 
                                 +
                                 Z
                                 
                                    2
                                    s
                                 
                              
                           
                        
                     
                  


                     S.t.
                     
                        
                           (38)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                D
                                                
                                                   k
                                                   s
                                                
                                                t
                                             
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                F
                                                J
                                                
                                                   K
                                                   
                                                      j
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                             
                                          
                                          )
                                       
                                       ×
                                       P
                                       
                                          C
                                          D
                                       
                                       ≤
                                       Z
                                       
                                          1
                                          s
                                       
                                    
                                 
                                 ,
                                 
                                 
                                 ∀
                                 
                                    D
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ∈
                                 
                                    J
                                    s
                                    D
                                 
                              
                           
                        
                     
                     
                        
                           (39)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                F
                                                J
                                                
                                                   K
                                                   
                                                      j
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                             
                                             −
                                             
                                                D
                                                
                                                   k
                                                   s
                                                
                                                t
                                             
                                          
                                          )
                                       
                                       ×
                                       S
                                       
                                          C
                                          D
                                       
                                    
                                 
                                 ≤
                                 Z
                                 
                                    1
                                    s
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 
                                    D
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ∈
                                 
                                    J
                                    s
                                    D
                                 
                              
                           
                        
                     
                     
                        
                           (40)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                R
                                                
                                                   k
                                                   s
                                                
                                                t
                                             
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                F
                                                K
                                                
                                                   J
                                                   
                                                      k
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                             
                                          
                                          )
                                       
                                       ×
                                       S
                                       
                                          C
                                          R
                                       
                                    
                                 
                                 ≤
                                 Z
                                 
                                    2
                                    s
                                 
                                 ,
                                 
                                 
                                 ∀
                                 
                                    R
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ∈
                                 
                                    J
                                    s
                                    R
                                 
                              
                           
                        
                     
                     
                        
                           (41)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                F
                                                K
                                                
                                                   J
                                                   
                                                      k
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                             
                                             −
                                             
                                                R
                                                
                                                   k
                                                   s
                                                
                                                t
                                             
                                          
                                          )
                                       
                                       ×
                                       P
                                       
                                          C
                                          R
                                       
                                    
                                 
                                 ≤
                                 Z
                                 
                                    2
                                    s
                                 
                                 ,
                                 
                                 
                                 ∀
                                 
                                    R
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ∈
                                 
                                    J
                                    s
                                    R
                                 
                              
                           
                        
                     
                     
                        
                           (42)
                           
                              
                                 Z
                                 
                                    1
                                    s
                                 
                                 ,
                                 
                                 
                                 Z
                                 
                                    2
                                    s
                                 
                                 ≥
                                 0
                              
                           
                        
                     
                  

The constraints (38)–(42) should be satisfied for all realizations of the uncertain demands and returns in their polyhedral uncertainty sets. We find their robust counterparts, explained in detail for constraint (38). From the set definition (34), we can rewrite the constraints (38) as:

                        
                           (43)
                           
                              
                                 
                                    
                                       M
                                       a
                                       x
                                    
                                    
                                       
                                          D
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                       ∈
                                       
                                          J
                                          s
                                          D
                                       
                                    
                                 
                                 
                                 
                                 
                                    [
                                    
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      t
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      F
                                                      J
                                                      
                                                         K
                                                         
                                                            j
                                                            k
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                
                                                )
                                             
                                             ×
                                             P
                                             
                                                C
                                                D
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ≤
                                 Z
                                 
                                    1
                                    s
                                 
                              
                           
                        
                     which can be transformed into:

                        
                           (44)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                K
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            D
                                                            ^
                                                         
                                                         
                                                            k
                                                            s
                                                         
                                                         t
                                                      
                                                      −
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         F
                                                         J
                                                         
                                                            K
                                                            
                                                               j
                                                               k
                                                               s
                                                            
                                                            t
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ×
                                                P
                                                
                                                   C
                                                   D
                                                
                                             
                                          
                                          +
                                          
                                             
                                                M
                                                a
                                                x
                                             
                                             
                                                η
                                                
                                                   D
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      +
                                                   
                                                
                                                ,
                                                η
                                                
                                                   D
                                                   
                                                      k
                                                      s
                                                   
                                                   
                                                      t
                                                      −
                                                   
                                                
                                                ∈
                                                
                                                   K
                                                   D
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                          
                                             [
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      K
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            Δ
                                                            
                                                               D
                                                               
                                                                  k
                                                                  s
                                                               
                                                               
                                                                  t
                                                                  +
                                                               
                                                            
                                                            ×
                                                            η
                                                            
                                                               D
                                                               
                                                                  k
                                                                  s
                                                               
                                                               
                                                                  t
                                                                  +
                                                               
                                                            
                                                            −
                                                            Δ
                                                            
                                                               D
                                                               
                                                                  k
                                                                  s
                                                               
                                                               
                                                                  t
                                                                  −
                                                               
                                                            
                                                            ×
                                                            η
                                                            
                                                               D
                                                               
                                                                  k
                                                                  s
                                                               
                                                               
                                                                  t
                                                                  −
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      ×
                                                      P
                                                      
                                                         C
                                                         D
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          ≤
                                          Z
                                          
                                             1
                                             s
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In this constraint, we optimize over the positive and negative deviation percentages from nominal scenario for uncertain demand. We expand the maximization problem in (44) considering constraints from polyhedral uncertainty sets as follows:

                        
                           
                              
                                 −
                                 
                                    
                                       M
                                       i
                                       n
                                    
                                    
                                       η
                                       
                                          D
                                          
                                             k
                                             s
                                          
                                          
                                             t
                                             +
                                          
                                       
                                       ,
                                       η
                                       
                                          D
                                          
                                             k
                                             s
                                          
                                          
                                             t
                                             −
                                          
                                       
                                       ∈
                                       
                                          K
                                          D
                                       
                                    
                                 
                                 
                                 
                                 
                                    [
                                    
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   −
                                                   Δ
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         +
                                                      
                                                   
                                                   ×
                                                   η
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         +
                                                      
                                                   
                                                   +
                                                   Δ
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         −
                                                      
                                                   
                                                   ×
                                                   η
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         −
                                                      
                                                   
                                                
                                                )
                                             
                                             ×
                                             P
                                             
                                                C
                                                D
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     
                  


                     S.t.
                     
                        
                           (45)
                           
                              
                                 
                                    
                                       
                                          −
                                          η
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          ≥
                                          −
                                          1
                                          ,
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          ,
                                          k
                                          ∈
                                          K
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          :
                                          
                                          
                                          
                                          
                                          α
                                          
                                             1
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          −
                                          η
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                −
                                             
                                          
                                          ≥
                                          −
                                          1
                                          ,
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          ,
                                          k
                                          ∈
                                          K
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          :
                                          
                                          
                                          
                                          α
                                          
                                             2
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   
                                                      −
                                                      η
                                                      
                                                         D
                                                         
                                                            k
                                                            s
                                                         
                                                         
                                                            t
                                                            +
                                                         
                                                      
                                                      −
                                                      η
                                                      
                                                         D
                                                         
                                                            k
                                                            s
                                                         
                                                         
                                                            t
                                                            −
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             ≥
                                             −
                                             
                                                Γ
                                                s
                                                D
                                             
                                             
                                             
                                             
                                             
                                             
                                             :
                                             
                                             
                                             
                                             β
                                             
                                                1
                                                D
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          η
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          ,
                                          η
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                −
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                  

Then we take the dual as:

                        
                           
                              
                                 
                                    
                                       M
                                       a
                                       x
                                    
                                    
                                       α
                                       
                                          1
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                       ,
                                       α
                                       
                                          2
                                          
                                             k
                                             s
                                          
                                          t
                                       
                                       ,
                                       β
                                       
                                          1
                                          D
                                       
                                    
                                 
                                 
                                 
                                 
                                    [
                                    
                                       −
                                       
                                          Γ
                                          s
                                          D
                                       
                                       ×
                                       β
                                       
                                          1
                                          D
                                       
                                       
                                       −
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             (
                                             
                                                α
                                                
                                                   1
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                α
                                                
                                                   2
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     
                  


                     S.t.
                     
                        
                           (46)
                           
                              
                                 
                                    
                                       
                                          −
                                          α
                                          
                                             1
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          −
                                          β
                                          
                                             1
                                             D
                                          
                                          ≤
                                          −
                                          Δ
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          ,
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          ,
                                          k
                                          ∈
                                          K
                                          
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          −
                                          α
                                          
                                             2
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          −
                                          β
                                          
                                             1
                                             D
                                          
                                          ≤
                                          Δ
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                −
                                             
                                          
                                          ,
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          ,
                                          k
                                          ∈
                                          K
                                          
                                          
                                          
                                          
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          β
                                          
                                             1
                                             D
                                          
                                          ,
                                          α
                                          
                                             1
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          α
                                          
                                             2
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          ,
                                          k
                                          ∈
                                          K
                                          
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In this LP (46), since the second constraint is actually redundant, we can remove

                        
                           α
                           
                              2
                              
                                 k
                                 s
                              
                              t
                           
                        
                     . According to strong duality theory, we then replace the objective function (46) without 
                        
                           α
                           
                              2
                              
                                 k
                                 s
                              
                              t
                           
                        
                      in the constraint (44) and, hence, the robust counterpart of constraint (38) is equivalent to the system of inequalities:

                        
                           (47)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          (
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            D
                                                            ^
                                                         
                                                         
                                                            k
                                                            s
                                                         
                                                         t
                                                      
                                                      +
                                                      α
                                                      
                                                         1
                                                         
                                                            k
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                             +
                                             β
                                             
                                                1
                                                D
                                             
                                             ×
                                             
                                                Γ
                                                s
                                                D
                                             
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      F
                                                      J
                                                      
                                                         K
                                                         
                                                            j
                                                            k
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ×
                                          
                                          P
                                          
                                             C
                                             D
                                          
                                          ≤
                                          Z
                                          
                                             1
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          α
                                          
                                             1
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          +
                                          β
                                          
                                             1
                                             D
                                          
                                          ≥
                                          Δ
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          ,
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          α
                                          
                                             1
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          β
                                          
                                             1
                                             D
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                              
                           
                        
                     
                  

The robust counterpart of the other constraints is found by the same procedure. Finally, our hybrid robust-stochastic formulation of this CLSCN design problem is:

                        
                           (48)
                           
                              
                                 
                                    
                                       
                                          M
                                          a
                                          x
                                          
                                          Z
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                          
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                S
                                             
                                          
                                          
                                             
                                                Pr
                                                s
                                             
                                             .
                                          
                                          
                                             (
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      K
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         P
                                                         
                                                            R
                                                            k
                                                         
                                                         F
                                                         J
                                                         
                                                            K
                                                            
                                                               j
                                                               k
                                                               s
                                                            
                                                            t
                                                         
                                                         −
                                                         C
                                                         J
                                                         
                                                            K
                                                            
                                                               j
                                                               k
                                                               s
                                                            
                                                            t
                                                         
                                                         F
                                                         J
                                                         
                                                            K
                                                            
                                                               j
                                                               k
                                                               s
                                                            
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          C
                                          K
                                          
                                             J
                                             
                                                k
                                                j
                                                s
                                             
                                             t
                                          
                                          F
                                          K
                                          
                                             J
                                             
                                                k
                                                j
                                                s
                                             
                                             t
                                          
                                          −
                                          C
                                          
                                             C
                                             j
                                          
                                          F
                                          K
                                          
                                             J
                                             
                                                k
                                                j
                                                s
                                             
                                             t
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   [
                                                   
                                                      C
                                                      I
                                                      
                                                         J
                                                         
                                                            i
                                                            j
                                                            s
                                                         
                                                         t
                                                      
                                                      F
                                                      I
                                                      
                                                         J
                                                         
                                                            i
                                                            j
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                +
                                                C
                                                J
                                                
                                                   I
                                                   
                                                      j
                                                      i
                                                      s
                                                   
                                                   t
                                                
                                                F
                                                J
                                                
                                                   I
                                                   
                                                      j
                                                      i
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                R
                                                
                                                   C
                                                   i
                                                
                                                F
                                                J
                                                
                                                   I
                                                   
                                                      j
                                                      i
                                                      s
                                                   
                                                   t
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   r
                                                   ∈
                                                   R
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   [
                                                   
                                                      C
                                                      J
                                                      
                                                         R
                                                         
                                                            j
                                                            r
                                                            s
                                                         
                                                         t
                                                      
                                                      F
                                                      J
                                                      
                                                         R
                                                         
                                                            j
                                                            r
                                                            s
                                                         
                                                         t
                                                      
                                                      +
                                                      D
                                                      
                                                         C
                                                         r
                                                      
                                                      F
                                                      J
                                                      
                                                         R
                                                         
                                                            j
                                                            r
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               p
                                                               ≤
                                                               t
                                                            
                                                         
                                                         
                                                            F
                                                            I
                                                            
                                                               J
                                                               
                                                                  i
                                                                  j
                                                                  s
                                                               
                                                               p
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ∈
                                                                  K
                                                               
                                                            
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     p
                                                                     ≤
                                                                     t
                                                                  
                                                               
                                                               
                                                                  F
                                                                  J
                                                                  
                                                                     K
                                                                     
                                                                        j
                                                                        k
                                                                        s
                                                                     
                                                                     p
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                I
                                                
                                                   C
                                                   j
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                M
                                                
                                                   C
                                                   i
                                                
                                                P
                                                
                                                   I
                                                   
                                                      i
                                                      s
                                                   
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                −
                                                Z
                                                
                                                   1
                                                   s
                                                
                                                −
                                                Z
                                                
                                                   2
                                                   s
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   F
                                                   i
                                                   
                                                      M
                                                      C
                                                   
                                                
                                                
                                                   X
                                                   i
                                                   
                                                      M
                                                      C
                                                   
                                                
                                                +
                                                
                                                   C
                                                   i
                                                   
                                                      M
                                                      C
                                                   
                                                
                                                
                                                   W
                                                   i
                                                   
                                                      M
                                                      C
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   F
                                                   j
                                                   
                                                      D
                                                      C
                                                   
                                                
                                                
                                                   X
                                                   j
                                                   
                                                      D
                                                      C
                                                   
                                                
                                                +
                                                
                                                   C
                                                   j
                                                   
                                                      D
                                                      C
                                                   
                                                
                                                
                                                   W
                                                   j
                                                   
                                                      D
                                                      C
                                                   
                                                
                                                +
                                                
                                                   F
                                                   j
                                                   
                                                      C
                                                      C
                                                   
                                                
                                                
                                                   X
                                                   j
                                                   
                                                      C
                                                      C
                                                   
                                                
                                                +
                                                
                                                   C
                                                   j
                                                   
                                                      C
                                                      C
                                                   
                                                
                                                
                                                   W
                                                   j
                                                   
                                                      C
                                                      C
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     S.t.
                  

Constraints
                      (2)–(7), (11)–(24)

                        
                           (49)
                           
                              
                                 
                                    (
                                    
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      D
                                                      ^
                                                   
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                α
                                                
                                                   1
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                       
                                       +
                                       β
                                       
                                          1
                                          D
                                       
                                       
                                          Γ
                                          s
                                          D
                                       
                                       −
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                F
                                                J
                                                
                                                   K
                                                   
                                                      j
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 P
                                 
                                    C
                                    D
                                 
                                 ≤
                                 Z
                                 
                                    1
                                    s
                                 
                                 ,
                                 
                                 ∀
                                 s
                                 ∈
                                 S
                              
                           
                        
                     
                     
                        
                           (50)
                           
                              
                                 
                                    (
                                    
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      D
                                                      ^
                                                   
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                −
                                                α
                                                
                                                   2
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                       
                                       −
                                       β
                                       
                                          2
                                          D
                                       
                                       
                                          Γ
                                          s
                                          D
                                       
                                       −
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                F
                                                J
                                                
                                                   K
                                                   
                                                      j
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 S
                                 
                                    C
                                    D
                                 
                                 ≥
                                 −
                                 Z
                                 
                                    1
                                    s
                                 
                                 ,
                                 ∀
                                 s
                                 ∈
                                 S
                              
                           
                        
                     
                     
                        
                           (51)
                           
                              
                                 
                                    (
                                    
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      R
                                                      ^
                                                   
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                γ
                                                
                                                   1
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                       
                                       +
                                       λ
                                       
                                          1
                                          R
                                       
                                       
                                          Γ
                                          s
                                          R
                                       
                                       −
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                F
                                                K
                                                
                                                   J
                                                   
                                                      k
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 S
                                 
                                    C
                                    R
                                 
                                 ≤
                                 Z
                                 
                                    2
                                    s
                                 
                                 ,
                                 ∀
                                 s
                                 ∈
                                 S
                              
                           
                        
                     
                     
                        
                           (52)
                           
                              
                                 
                                    (
                                    
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      R
                                                      ^
                                                   
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                                −
                                                γ
                                                
                                                   2
                                                   
                                                      k
                                                      s
                                                   
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                       
                                       −
                                       λ
                                       
                                          2
                                          R
                                       
                                       
                                          Γ
                                          s
                                          R
                                       
                                       −
                                       
                                          ∑
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                F
                                                K
                                                
                                                   J
                                                   
                                                      k
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 P
                                 
                                    C
                                    R
                                 
                                 ≥
                                 −
                                 Z
                                 
                                    2
                                    s
                                 
                                 ,
                                 ∀
                                 s
                                 ∈
                                 S
                              
                           
                        
                     
                     
                        
                           (53)
                           
                              
                                 α
                                 
                                    1
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 +
                                 β
                                 
                                    1
                                    D
                                 
                                 ≥
                                 Δ
                                 
                                    D
                                    
                                       k
                                       s
                                    
                                    
                                       t
                                       +
                                    
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 t
                                 ∈
                                 T
                                 ,
                                 
                                 
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 s
                                 ∈
                                 S
                                 
                              
                           
                        
                     
                     
                        
                           (54)
                           
                              
                                 α
                                 
                                    2
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 +
                                 β
                                 
                                    2
                                    D
                                 
                                 ≥
                                 Δ
                                 
                                    D
                                    
                                       k
                                       s
                                    
                                    
                                       t
                                       −
                                    
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 t
                                 ∈
                                 T
                                 ,
                                 
                                 
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 s
                                 ∈
                                 S
                                 
                              
                           
                        
                     
                     
                        
                           (55)
                           
                              
                                 γ
                                 
                                    1
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 +
                                 λ
                                 
                                    1
                                    R
                                 
                                 ≥
                                 Δ
                                 
                                    R
                                    
                                       k
                                       s
                                    
                                    
                                       t
                                       +
                                    
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 t
                                 ∈
                                 T
                                 ,
                                 
                                 
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 s
                                 ∈
                                 S
                                 
                              
                           
                        
                     
                     
                        
                           (56)
                           
                              
                                 γ
                                 
                                    2
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 +
                                 λ
                                 
                                    2
                                    R
                                 
                                 ≥
                                 Δ
                                 
                                    R
                                    
                                       k
                                       s
                                    
                                    
                                       t
                                       −
                                    
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 t
                                 ∈
                                 T
                                 ,
                                 
                                 
                                 k
                                 ∈
                                 K
                                 
                                 ,
                                 
                                 
                                 s
                                 ∈
                                 S
                              
                           
                        
                     
                     
                        
                           (57)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          Z
                                          
                                             1
                                             s
                                          
                                          ,
                                          Z
                                          
                                             2
                                             s
                                          
                                          ,
                                          α
                                          
                                             1
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          β
                                          
                                             1
                                             D
                                          
                                          ,
                                          α
                                          
                                             2
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          β
                                          
                                             2
                                             D
                                          
                                          ,
                                          γ
                                          
                                             1
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          λ
                                          
                                             1
                                             R
                                          
                                          ,
                                          
                                          γ
                                          
                                             2
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          λ
                                          
                                             2
                                             R
                                          
                                          ≥
                                          0
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          ,
                                          
                                          
                                          k
                                          ∈
                                          K
                                          ,
                                          
                                          s
                                          ∈
                                          S
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In this formulation, the parameters 
                        
                           Γ
                           s
                           D
                        
                      and 
                        
                           Γ
                           s
                           R
                        
                      control the trade-off between the robustness and the level of conservatism of the obtained solution at each scenario for transportation cost by restricting the number of times that demands and returns deviate from the nominal scenario in their associated uncertainty sets. As a result, higher values for the parameters 
                        
                           Γ
                           s
                           D
                        
                      and 
                        
                           Γ
                           s
                           R
                        
                      increase the level of robustness at the expense of a lower expected profit.

To obtain transportation cost scenarios over multiple periods, we combine forecast errors into a tree. As in Schütz, Tomasgard, and Ahmed (2009) we use a deterministic Pth order autoregressive process as the forecasting method, and add a realization of error term 
                        
                           
                              ɛ
                           
                           
                              t
                              +
                              1
                           
                           s
                        
                     , to the predicted transportation cost at time t + 1 to obtain the transportation cost in scenario s denoted by 
                        
                           c
                           
                              t
                              +
                              1
                           
                           s
                        
                     :

                        
                           (58)
                           
                              
                                 
                                    
                                       c
                                       ^
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                    s
                                 
                                 =
                                 α
                                 +
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    P
                                 
                                 
                                    
                                       β
                                       i
                                    
                                    
                                    
                                       c
                                       
                                          
                                          t
                                          +
                                          1
                                          −
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          ɛ
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                       s
                                    
                                 
                              
                           
                        
                     where α is a constant parameter, βi
                      is an autoregressive parameter, and 
                        
                           c
                           
                              
                              t
                              +
                              1
                              −
                              i
                           
                        
                      is the historical transportation cost at period (t + 1 – i). Then, a transportation cost scenario is generated as:

                        
                           (59)
                           
                              
                                 
                                    
                                       c
                                       ^
                                    
                                    
                                       t
                                       +
                                       j
                                    
                                    s
                                 
                                 =
                                 
                                 
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                   +
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      P
                                                   
                                                   
                                                      
                                                         β
                                                         i
                                                      
                                                      
                                                      
                                                         c
                                                         
                                                            t
                                                            +
                                                            j
                                                            −
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            ɛ
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                         s
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      j
                                                      =
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   α
                                                   +
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         j
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                         i
                                                      
                                                      
                                                      
                                                         
                                                            c
                                                            ^
                                                         
                                                         
                                                            t
                                                            +
                                                            j
                                                            −
                                                            i
                                                         
                                                         s
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            j
                                                         
                                                         P
                                                      
                                                      
                                                         
                                                            β
                                                            i
                                                         
                                                         
                                                         
                                                            c
                                                            
                                                               t
                                                               +
                                                               j
                                                               −
                                                               i
                                                            
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         1
                                                         <
                                                         j
                                                         ≤
                                                         P
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   α
                                                   +
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      P
                                                   
                                                   
                                                      
                                                         β
                                                         i
                                                      
                                                      
                                                      
                                                         
                                                            c
                                                            ^
                                                         
                                                         
                                                            t
                                                            +
                                                            j
                                                            −
                                                            i
                                                         
                                                         s
                                                      
                                                      ,
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   j
                                                   >
                                                   P
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The error terms are assumed to be independent and normally distributed with mean zero and variance

                        
                           σ
                           
                              ɛ
                           
                           2
                        
                     . Fig. 3 illustrates the tree of NS scenarios for prediction errors on costs associated with all arcs between a given pair of facility sets (e.g., from I to J), where NF is the number of such arcs.

Based on this scenario tree for the prediction error terms, the procedure to combine forecasting and scenario generation for a given arc 
                        
                           f
                           =
                           (
                           
                              i
                              ,
                              j
                           
                           )
                        
                      is illustrated by Fig 4.

To construct different scenarios for the error terms, most previous studies used Monte Carlo simulation (MCS). Instead, we apply Latin hypercube sampling (LHS) introduced by Olsson, Sandberg, and Dahlblom (2003). MCS often requires a large sample size to approximate an input distribution, but LHS is designed to accurately approximate the input distribution through sampling in fewer iterations compared with MCS. Moreover, this method covers more of the domain of the random variables than MCS with the same sample size (Fattahi, Mahootchi, Moattar Husseini, Keyvanshokooh, & Alborzi, 2015; Shi, Liu, Shang, & Cui, 2013). To generate the scenario tree for |T| periods, suppose that in each period the error terms are generated using LHS. Since the error terms are period-independent, using this procedure results in an exponentially increasing number of scenarios which makes CLSCN model hard to solve. To efficiently reduce the number of scenarios, a backward reduction technique (Dupačová, Gröwe-Kuska, & Römisch, 2003) is used. The goal is to reduce a scenario tree from m to n scenarios, where n ≪ m. We find the scenario whose removal will require the least probability mass to be redistributed, remove it, redistribute its probability, and then repeat this procedure until we have only n scenarios left. The pseudo-code for our scenario generation and reduction algorithm is provided in Keyvanshokooh (2015).

The L-shaped method introduced by Van Slyke and Wets (1969) is a BD method applied to two-stage recourse SP problems. The MILP is decomposed into a master problem (MP) that involves the first-stage decision variables, and Benders sub-problems (BSP) to optimize the second-stage decision variables. The BSPs are scenario-specific and connected by the first-stage variables. The BSP of this CLSCN can be formulated by fixing the first-stage variables to the given values

                        
                           {
                           
                              X
                              i
                              
                                 M
                                 C
                              
                           
                           =
                           
                              
                                 X
                                 ˜
                              
                              
                                 i
                                 ,
                                 i
                                 t
                              
                              
                                 M
                                 C
                              
                           
                           ,
                           
                           
                              X
                              j
                              
                                 D
                                 C
                              
                           
                           =
                           
                              
                                 X
                                 ˜
                              
                              
                                 j
                                 ,
                                 i
                                 t
                              
                              
                                 D
                                 C
                              
                           
                           ,
                           
                           
                           
                              X
                              j
                              
                                 C
                                 C
                              
                           
                           =
                           
                              
                                 X
                                 ˜
                              
                              
                                 j
                                 ,
                                 i
                                 t
                              
                              
                                 C
                                 C
                              
                           
                           ,
                           
                           
                           
                              W
                              i
                              
                                 M
                                 C
                              
                           
                           =
                           
                              
                                 W
                                 ˜
                              
                              
                                 i
                                 ,
                                 i
                                 t
                              
                              
                                 M
                                 C
                              
                           
                           ,
                           
                           
                           
                              W
                              j
                              
                                 D
                                 C
                              
                           
                           =
                           
                              
                                 W
                                 ˜
                              
                              
                                 j
                                 ,
                                 i
                                 t
                              
                              
                                 D
                                 C
                              
                           
                           ,
                           
                           
                           
                              W
                              j
                              
                                 C
                                 C
                              
                           
                           =
                           
                              
                                 W
                                 ˜
                              
                              
                                 j
                                 ,
                                 i
                                 t
                              
                              
                                 C
                                 C
                              
                           
                           ,
                           
                           
                           B
                           
                              S
                              j
                           
                           =
                           
                              B
                              ˜
                           
                           
                              S
                              
                                 j
                                 ,
                                 i
                                 t
                              
                           
                           }
                        
                      at iteration it. The BSP includes the objective function (8) with the added term 
                        
                           −
                           Z
                           
                              1
                              s
                           
                           −
                           Z
                           
                              2
                              s
                           
                        
                      subject to the constraints (11)–(24) and (49)–(57) in which the first-stage variables have been fixed to these given values. Because our formulation possesses complete recourse, the BSP is feasible for the given values of first-stage variables, and an optimality cut (OC) may be deduced from an optimal solution to the dual of the sub-problem (DSP). Thus, if vectors y and h represent the dual variables of the constraints (11)–(23) and (49)–(56) respectively, then the DSP which obtains a lower bound for the objective function of the original CLSND problem at each iteration it is formulated as follows:

                        
                           (60)
                           
                              
                                 
                                    
                                       
                                          D
                                          S
                                          P
                                          :
                                          
                                          
                                          M
                                          i
                                          n
                                          
                                          
                                             Z
                                             
                                                s
                                                ,
                                                i
                                                t
                                             
                                             
                                                D
                                                S
                                                P
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   B
                                                   ˜
                                                
                                                
                                                   S
                                                   
                                                      j
                                                      ,
                                                      i
                                                      t
                                                   
                                                
                                                y
                                                
                                                   2
                                                   
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                
                                                   
                                                      W
                                                      ˜
                                                   
                                                   
                                                      j
                                                      ,
                                                      i
                                                      t
                                                   
                                                   
                                                      D
                                                      C
                                                   
                                                
                                                y
                                                
                                                   7
                                                   
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                
                                                   
                                                      W
                                                      ˜
                                                   
                                                   
                                                      j
                                                      ,
                                                      i
                                                      t
                                                   
                                                   
                                                      C
                                                      C
                                                   
                                                
                                                y
                                                
                                                   8
                                                   
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                
                                                   
                                                      W
                                                      ˜
                                                   
                                                   
                                                      i
                                                      ,
                                                      i
                                                      t
                                                   
                                                   
                                                      M
                                                      C
                                                   
                                                
                                                y
                                                
                                                   6
                                                   
                                                      i
                                                      s
                                                   
                                                   t
                                                
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                R
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   M
                                                   .
                                                   
                                                      
                                                         X
                                                         ˜
                                                      
                                                      
                                                         j
                                                         ,
                                                         i
                                                         t
                                                      
                                                      
                                                         C
                                                         C
                                                      
                                                   
                                                   y
                                                   
                                                      13
                                                      
                                                         j
                                                         r
                                                         s
                                                      
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ×
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      .
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         
                                                            j
                                                            ,
                                                            i
                                                            t
                                                         
                                                         
                                                            D
                                                            C
                                                         
                                                      
                                                      y
                                                      
                                                         9
                                                         
                                                            i
                                                            j
                                                            s
                                                         
                                                         t
                                                      
                                                      +
                                                      M
                                                      .
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         
                                                            j
                                                            ,
                                                            i
                                                            t
                                                         
                                                         
                                                            C
                                                            C
                                                         
                                                      
                                                      y
                                                      
                                                         12
                                                         
                                                            j
                                                            i
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      .
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         
                                                            j
                                                            ,
                                                            i
                                                            t
                                                         
                                                         
                                                            D
                                                            C
                                                         
                                                      
                                                      y
                                                      
                                                         10
                                                         
                                                            j
                                                            k
                                                            s
                                                         
                                                         t
                                                      
                                                      +
                                                      M
                                                      .
                                                      
                                                         
                                                            X
                                                            ˜
                                                         
                                                         
                                                            j
                                                            ,
                                                            i
                                                            t
                                                         
                                                         
                                                            C
                                                            C
                                                         
                                                      
                                                      y
                                                      
                                                         11
                                                         
                                                            k
                                                            j
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                K
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             (
                                             Δ
                                          
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          h
                                          
                                             5
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          +
                                          Δ
                                          
                                             D
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                −
                                             
                                          
                                          h
                                          
                                             6
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          +
                                          Δ
                                          
                                             R
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                +
                                             
                                          
                                          h
                                          
                                             7
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          +
                                          
                                          Δ
                                          
                                             R
                                             
                                                k
                                                s
                                             
                                             
                                                t
                                                −
                                             
                                          
                                          h
                                          
                                             8
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     Subject to:
                     
                        
                           (61)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          y
                                          
                                             1
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          −
                                          y
                                          
                                             2
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          +
                                          y
                                          
                                             10
                                             
                                                k
                                                j
                                                s
                                             
                                             t
                                          
                                          −
                                          P
                                          
                                             C
                                             D
                                          
                                          h
                                          
                                             1
                                             s
                                          
                                          +
                                          S
                                          
                                             C
                                             D
                                          
                                          h
                                          
                                             2
                                             s
                                          
                                          ≥
                                          P
                                          
                                             R
                                             k
                                          
                                          −
                                          C
                                          J
                                          
                                             K
                                             
                                                j
                                                k
                                                s
                                             
                                             t
                                          
                                          +
                                          I
                                          
                                             C
                                             j
                                             t
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ∈
                                          J
                                          ,
                                          k
                                          ∈
                                          K
                                          ,
                                          
                                          
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (62)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          −
                                          y
                                          
                                             1
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          +
                                          y
                                          
                                             2
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          −
                                          y
                                          
                                             3
                                             
                                                i
                                                s
                                             
                                             t
                                          
                                          +
                                          y
                                          
                                             7
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          +
                                          y
                                          
                                             9
                                             
                                                i
                                                j
                                                s
                                             
                                             t
                                          
                                          ≥
                                          −
                                          C
                                          I
                                          
                                             J
                                             
                                                i
                                                j
                                                s
                                             
                                             t
                                          
                                          −
                                          I
                                          
                                             C
                                             j
                                             t
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ∈
                                          J
                                          ,
                                          
                                          
                                          i
                                          ∈
                                          I
                                          ,
                                          
                                          
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (63)
                           
                              
                                 y
                                 
                                    3
                                    
                                       i
                                       s
                                    
                                    t
                                 
                                 −
                                 y
                                 
                                    4
                                    
                                       j
                                       s
                                    
                                    t
                                 
                                 +
                                 y
                                 
                                    6
                                    
                                       i
                                       s
                                    
                                    t
                                 
                                 +
                                 y
                                 
                                    12
                                    
                                       i
                                       j
                                       s
                                    
                                    t
                                 
                                 ≥
                                 −
                                 C
                                 I
                                 
                                    J
                                    
                                       j
                                       i
                                       s
                                    
                                    t
                                 
                                 −
                                 R
                                 
                                    C
                                    i
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 j
                                 ∈
                                 J
                                 ,
                                 
                                 
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (64)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          a
                                          
                                          y
                                          
                                             4
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          +
                                          
                                             (
                                             
                                                1
                                                −
                                                a
                                             
                                             )
                                          
                                          y
                                          
                                             5
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          +
                                          y
                                          
                                             8
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          +
                                          y
                                          
                                             11
                                             
                                                k
                                                j
                                                s
                                             
                                             t
                                          
                                          −
                                          S
                                          
                                             C
                                             R
                                          
                                          h
                                          
                                             3
                                             s
                                          
                                          +
                                          P
                                          
                                             C
                                             R
                                          
                                          h
                                          
                                             4
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ≥
                                          −
                                          C
                                          K
                                          
                                             J
                                             
                                                k
                                                j
                                                s
                                             
                                             t
                                          
                                          −
                                          C
                                          
                                             C
                                             j
                                             t
                                          
                                          ,
                                          
                                          
                                          
                                          
                                          
                                          ∀
                                          j
                                          ∈
                                          J
                                          ,
                                          k
                                          ∈
                                          K
                                          ,
                                          
                                          
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (65)
                           
                              
                                 −
                                 y
                                 
                                    5
                                    
                                       j
                                       s
                                    
                                    t
                                 
                                 +
                                 y
                                 
                                    13
                                    
                                       r
                                       j
                                       s
                                    
                                    t
                                 
                                 ≥
                                 −
                                 C
                                 J
                                 
                                    R
                                    
                                       j
                                       r
                                       s
                                    
                                    t
                                 
                                 −
                                 D
                                 
                                    C
                                    r
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 j
                                 ∈
                                 J
                                 ,
                                 
                                 
                                 r
                                 ∈
                                 R
                                 ,
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (66)
                           
                              
                                 y
                                 
                                    3
                                    
                                       i
                                       s
                                    
                                    t
                                 
                                 +
                                 y
                                 
                                    6
                                    
                                       i
                                       s
                                    
                                    t
                                 
                                 ≥
                                 −
                                 M
                                 
                                    C
                                    i
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 I
                                 ,
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (67)
                           
                              
                                 P
                                 
                                    C
                                    D
                                 
                                 
                                 
                                    Γ
                                    s
                                    D
                                 
                                 h
                                 
                                    1
                                    s
                                 
                                 −
                                 h
                                 
                                    5
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ≥
                                 0
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (68)
                           
                              
                                 S
                                 
                                    C
                                    D
                                 
                                 
                                 
                                    Γ
                                    s
                                    D
                                 
                                 h
                                 
                                    2
                                    s
                                 
                                 −
                                 h
                                 
                                    6
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ≥
                                 0
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (69)
                           
                              
                                 S
                                 
                                    C
                                    R
                                 
                                 
                                 
                                    Γ
                                    s
                                    R
                                 
                                 h
                                 
                                    3
                                    s
                                 
                                 −
                                 h
                                 
                                    7
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ≥
                                 0
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (70)
                           
                              
                                 P
                                 
                                    C
                                    R
                                 
                                 
                                 
                                    Γ
                                    s
                                    R
                                 
                                 h
                                 
                                    4
                                    s
                                 
                                 −
                                 h
                                 
                                    8
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ≥
                                 0
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (71)
                           
                              
                                 P
                                 
                                    C
                                    D
                                 
                                 
                                 h
                                 
                                    1
                                    s
                                 
                                 −
                                 h
                                 
                                    5
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ≥
                                 0
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (72)
                           
                              
                                 S
                                 
                                    C
                                    D
                                 
                                 
                                 h
                                 
                                    2
                                    s
                                 
                                 −
                                 h
                                 
                                    6
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ≥
                                 0
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (73)
                           
                              
                                 S
                                 
                                    C
                                    R
                                 
                                 
                                 h
                                 
                                    3
                                    s
                                 
                                 −
                                 h
                                 
                                    7
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ≥
                                 0
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (74)
                           
                              
                                 P
                                 
                                    C
                                    R
                                 
                                 
                                 h
                                 
                                    4
                                    s
                                 
                                 −
                                 h
                                 
                                    8
                                    
                                       k
                                       s
                                    
                                    t
                                 
                                 ≥
                                 0
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (75)
                           
                              
                                 h
                                 
                                    1
                                    s
                                 
                                 +
                                 h
                                 
                                    2
                                    s
                                 
                                 ≤
                                 1
                                 
                              
                           
                        
                     
                     
                        
                           (76)
                           
                              
                                 h
                                 
                                    3
                                    s
                                 
                                 +
                                 h
                                 
                                    4
                                    s
                                 
                                 ≤
                                 1
                                 
                              
                           
                        
                     
                     
                        
                           (77)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          y
                                          
                                             1
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          ,
                                          y
                                          
                                             6
                                             
                                                i
                                                s
                                             
                                             t
                                          
                                          ,
                                          y
                                          
                                             7
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          ,
                                          y
                                          
                                             8
                                             
                                                j
                                                s
                                             
                                             t
                                          
                                          ,
                                          y
                                          
                                             9
                                             
                                                i
                                                j
                                                s
                                             
                                             t
                                          
                                          ,
                                          y
                                          
                                             10
                                             
                                                j
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          y
                                          
                                             11
                                             
                                                k
                                                j
                                                s
                                             
                                             t
                                          
                                          ,
                                          y
                                          
                                             12
                                             
                                                j
                                                i
                                                s
                                             
                                             t
                                          
                                          ,
                                          y
                                          
                                             13
                                             
                                                j
                                                r
                                                s
                                             
                                             t
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          h
                                          
                                             1
                                             s
                                          
                                          ,
                                          h
                                          
                                             2
                                             s
                                          
                                          ,
                                          h
                                          
                                             3
                                             s
                                          
                                          ,
                                          h
                                          
                                             4
                                             s
                                          
                                          ,
                                          h
                                          
                                             5
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          h
                                          
                                             6
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          h
                                          
                                             7
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ,
                                          h
                                          
                                             8
                                             
                                                k
                                                s
                                             
                                             t
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ∈
                                          J
                                          ,
                                          i
                                          ∈
                                          I
                                          ,
                                          k
                                          ∈
                                          K
                                          ,
                                          t
                                          ∈
                                          T
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Then, based on the DSP's solution, the general MP which produces an upper bound for the objective function of original CLSN design model at each iteration can be written as:

                        
                           (78)
                           
                              
                                 
                                    
                                       
                                          
                                             MP
                                             :
                                          
                                          
                                          
                                          
                                          M
                                          a
                                          x
                                          
                                          
                                          
                                             Z
                                             
                                                M
                                                P
                                             
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                          
                                             ∑
                                             s
                                          
                                          
                                             
                                                Pr
                                                s
                                             
                                             ×
                                             
                                          
                                          
                                             θ
                                             s
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             
                                                F
                                                i
                                                
                                                   M
                                                   C
                                                
                                             
                                             
                                                X
                                                i
                                                
                                                   M
                                                   C
                                                
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             
                                                C
                                                i
                                                
                                                   M
                                                   C
                                                
                                             
                                             
                                                W
                                                i
                                                
                                                   M
                                                   C
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                F
                                                j
                                                
                                                   D
                                                   C
                                                
                                             
                                             
                                                X
                                                j
                                                
                                                   D
                                                   C
                                                
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                C
                                                j
                                                
                                                   D
                                                   C
                                                
                                             
                                             
                                                W
                                                j
                                                
                                                   D
                                                   C
                                                
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                F
                                                j
                                                
                                                   C
                                                   C
                                                
                                             
                                             
                                                X
                                                j
                                                
                                                   C
                                                   C
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                C
                                                j
                                                
                                                   C
                                                   C
                                                
                                             
                                             
                                                W
                                                j
                                                
                                                   C
                                                   C
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     Subject to:
                  

Constraints (2)–(7), θs
                      ≥ 0,  ∀s ∈ S 
                     
                        
                           (79)
                           
                              
                                 
                                    
                                       
                                          θ
                                          s
                                       
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             (
                                             
                                                B
                                                
                                                   S
                                                   
                                                      j
                                                      ,
                                                      i
                                                      t
                                                   
                                                
                                                
                                                   y
                                                   ˜
                                                
                                                
                                                   2
                                                   
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                
                                                   W
                                                   
                                                      j
                                                      ,
                                                      i
                                                      t
                                                   
                                                   
                                                      D
                                                      C
                                                   
                                                
                                                
                                                   y
                                                   ˜
                                                
                                                
                                                   7
                                                   
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                                +
                                                
                                                   W
                                                   
                                                      j
                                                      ,
                                                      i
                                                      t
                                                   
                                                   
                                                      C
                                                      C
                                                   
                                                
                                                
                                                   y
                                                   ˜
                                                
                                                
                                                   8
                                                   
                                                      j
                                                      s
                                                   
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                
                                                   W
                                                   
                                                      i
                                                      ,
                                                      i
                                                      t
                                                   
                                                   
                                                      M
                                                      C
                                                   
                                                
                                                
                                                   y
                                                   ˜
                                                
                                                
                                                   6
                                                   
                                                      i
                                                      s
                                                   
                                                   t
                                                
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                R
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   M
                                                   .
                                                   
                                                      X
                                                      
                                                         j
                                                         ,
                                                         i
                                                         t
                                                      
                                                      
                                                         C
                                                         C
                                                      
                                                   
                                                   
                                                      y
                                                      ˜
                                                   
                                                   
                                                      13
                                                      
                                                         j
                                                         r
                                                         s
                                                      
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      .
                                                      
                                                         X
                                                         
                                                            j
                                                            ,
                                                            i
                                                            t
                                                         
                                                         
                                                            D
                                                            C
                                                         
                                                      
                                                      
                                                         y
                                                         ˜
                                                      
                                                      
                                                         9
                                                         
                                                            i
                                                            j
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                +
                                                M
                                                .
                                                
                                                   X
                                                   
                                                      j
                                                      ,
                                                      i
                                                      t
                                                   
                                                   
                                                      C
                                                      C
                                                   
                                                
                                                
                                                   y
                                                   ˜
                                                
                                                
                                                   12
                                                   
                                                      j
                                                      i
                                                      s
                                                   
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      .
                                                      
                                                         X
                                                         
                                                            j
                                                            ,
                                                            i
                                                            t
                                                         
                                                         
                                                            D
                                                            C
                                                         
                                                      
                                                      
                                                         y
                                                         ˜
                                                      
                                                      
                                                         10
                                                         
                                                            j
                                                            k
                                                            s
                                                         
                                                         t
                                                      
                                                      +
                                                      M
                                                      .
                                                      
                                                         X
                                                         
                                                            j
                                                            ,
                                                            i
                                                            t
                                                         
                                                         
                                                            C
                                                            C
                                                         
                                                      
                                                      
                                                         y
                                                         ˜
                                                      
                                                      
                                                         11
                                                         
                                                            k
                                                            j
                                                            s
                                                         
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                K
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                (
                                                
                                                   Δ
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         +
                                                      
                                                   
                                                   
                                                      h
                                                      ˜
                                                   
                                                   
                                                      5
                                                      
                                                         k
                                                         s
                                                      
                                                      t
                                                   
                                                   +
                                                   Δ
                                                   
                                                      D
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         −
                                                      
                                                   
                                                   
                                                      h
                                                      ˜
                                                   
                                                   
                                                      6
                                                      
                                                         k
                                                         s
                                                      
                                                      t
                                                   
                                                   +
                                                   Δ
                                                   
                                                      R
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         +
                                                      
                                                   
                                                   
                                                      h
                                                      ˜
                                                   
                                                   
                                                      7
                                                      
                                                         k
                                                         s
                                                      
                                                      t
                                                   
                                                   +
                                                   Δ
                                                   
                                                      R
                                                      
                                                         k
                                                         s
                                                      
                                                      
                                                         t
                                                         −
                                                      
                                                   
                                                   
                                                      h
                                                      ˜
                                                   
                                                   
                                                      8
                                                      
                                                         k
                                                         s
                                                      
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          s
                                          ∈
                                          S
                                       
                                    
                                 
                              
                           
                        
                     
                  

In this MP, the constraint (79) represents the optimality cut where 
                        
                           (
                           
                              y
                              ˜
                           
                           ,
                           
                              h
                              ˜
                           
                           )
                        
                      indicates the extreme point of the dual polyhedron that results from solving the DSP. This RMP provides an upper bound to the optimal objective value of the MP. At a given iteration of BD, the RMP is first solved to obtain the values of first-stage decisions. Then, these values are used to solve DSP to obtain an extreme point and a new optimality cut (79) is included in the RMP. But this algorithm may require a large number of iterations to converge. To improve the slow convergence of BD, acceleration techniques such as generation of valid inequalities, disaggregation of Benders cuts (Dogan & Goetschalckx, 1999), Pareto-optimal cut generation scheme (Magnanti & Wong, 1981; Papadakos, 2008), covering cut bundle strategy (Saharidis et al., 2010), local branching (Rei et al., 2009), generation of maximal non-dominated cuts (Sherali & Lunday, 2013), and dynamically updated near-maximal Benders cuts (Oliveira et al., 2014) have been proposed. Of these, we employ the following acceleration strategies.

One of the critical reasons for slow convergence of BD is the low quality of the RMP solutions at the primary iterations (Saharidis & Ierapetritou, 2010). To avoid this inefficiency, a series of valid inequalities may be derived to be included into RMP to restrict the feasible region and produce higher quality solutions. Consequently, the gap between the lower and upper bounds will be decreased and the algorithm will converge to an optimal solution faster. The following two types of VI are developed:

                           
                              (1)
                              Force the capacity of established facilities to at least equal the sum of maximal downstream requirements:
                                    
                                       (80)
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                W
                                                i
                                                
                                                   M
                                                   C
                                                
                                             
                                             ≥
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                B
                                                
                                                   S
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (81)
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                W
                                                j
                                                
                                                   D
                                                   C
                                                
                                             
                                             ≥
                                             
                                                max
                                                
                                                   s
                                                   ∈
                                                   S
                                                   ,
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                
                                                   D
                                                   ^
                                                
                                                
                                                   k
                                                   s
                                                
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (82)
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                W
                                                j
                                                
                                                   C
                                                   C
                                                
                                             
                                             ≥
                                             
                                                max
                                                
                                                   s
                                                   ∈
                                                   S
                                                   ,
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                
                                                   R
                                                   ^
                                                
                                                
                                                   k
                                                   s
                                                
                                                t
                                             
                                          
                                       
                                    
                                 
                              

Constraints (80)–(82) apply this idea to manufacturing/remanufacturing, distribution, and collection centers, respectively.

Force the opening of at least one facility of each type:
                                    
                                       (83)
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                X
                                                i
                                                
                                                   M
                                                   C
                                                
                                             
                                             ≥
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       (84)
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                X
                                                j
                                                
                                                   D
                                                   C
                                                
                                             
                                             ≥
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       (85)
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                X
                                                j
                                                
                                                   C
                                                   C
                                                
                                             
                                             ≥
                                             1
                                          
                                       
                                    
                                 
                              

It is easy to verify that they preserve complete recourse. Moreover, at the beginning of the L-shaped algorithm, we need an initial feasible solution of first-stage variables. We can obtain a good initial feasible solution by solving the optimization problem with the objective (78) without its first term subject to constraints (2)–(7) and the VIs (80)–(85).


                        Magnanti and Wong (1981) proposed a procedure for generating Pareto-optimal cuts to strengthen the optimality cuts. A cut is called Pareto-optimal if no other cut makes it redundant and similarly, the optimal dual solution corresponding to that cut is called Pareto-optimal. If a DSP has multiple optimal solutions, as typically occurs in BSPs with network structure such as ours, the Pareto-optimal cut is the strongest among all the alternative cuts that could be generated. To generate a Pareto-optimal cut, consider our CLSCND problem as the MILP problem 
                           
                              M
                              a
                              x
                              
                              
                              
                                 c
                                 1
                                 T
                              
                              x
                              +
                              
                                 c
                                 2
                                 T
                              
                              y
                              
                              
                              
                              S
                              .
                              
                              t
                              .
                              
                              
                              A
                              x
                              
                              +
                              
                              B
                              y
                              ≤
                              b
                              ,
                              
                              
                              x
                              ≥
                              0
                              ,
                              
                              y
                              ∈
                              
                                 {
                                 
                                    0
                                    ,
                                    1
                                 
                                 }
                              
                           
                        . Fixing integer variables 
                           
                              y
                              =
                              
                                 y
                                 ˜
                              
                           
                        , the general form of the SP is 
                           
                              Max
                              
                              
                              
                                 c
                                 1
                                 T
                              
                              x
                              
                              
                              
                              S
                              .
                              
                              t
                              .
                              
                              
                              A
                              x
                              
                              ≤
                              b
                              
                              −
                              
                              B
                              
                                 y
                                 ˜
                              
                              ,
                              
                              
                              x
                              ≥
                              0
                           
                         and then its DSP can be written as 
                           
                              Min
                              
                              
                              
                                 
                                    (
                                    
                                       b
                                       −
                                       B
                                       
                                          y
                                          ˜
                                       
                                    
                                    )
                                 
                                 T
                              
                              u
                              
                              
                              
                              S
                              .
                              
                              t
                              .
                              
                              
                              
                                 A
                                 T
                              
                              u
                              ≥
                              
                                 c
                                 1
                                 T
                              
                              ,
                              
                              
                              u
                              ≥
                              0
                           
                        . Let u*
                         be the optimal solution of the DSP and yc
                         be a core point of the solution space of RMP. A Pareto-optimal cut can be obtained by solving the following problem, which is also called Magnanti–Wong problem:

                           
                              (86)
                              
                                 
                                    Min
                                    
                                    
                                    
                                       
                                          (
                                          
                                             b
                                             −
                                             B
                                             
                                                y
                                                c
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    u
                                    
                                    
                                    
                                    s
                                    .
                                    
                                    t
                                    .
                                    
                                    
                                    
                                       A
                                       T
                                    
                                    u
                                    ≥
                                    
                                       c
                                       1
                                       T
                                    
                                    ,
                                    
                                    
                                    
                                       
                                          (
                                          
                                             b
                                             −
                                             B
                                             
                                                y
                                                ˜
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    u
                                    ≥
                                    
                                    
                                       
                                          (
                                          
                                             b
                                             −
                                             B
                                             
                                                y
                                                ˜
                                             
                                          
                                          )
                                       
                                       T
                                    
                                    
                                       u
                                       *
                                    
                                    ,
                                    
                                    
                                    u
                                    ≥
                                    0
                                 
                              
                           
                        
                     

The challenge at each iteration is to identify and update a core point, which is required to lie inside the relative interior of the convex hull of the sub-region defined in terms of the MP variables. To deal with this problem, Papadakos (2008) proved that it is not necessary to use a core point yc
                         to obtain a Pareto-optimal cut. Instead, a convex combination of the current MP solution and the previously used core point suffices for obtaining a new core point at each iteration as 
                           
                              
                                 y
                                 
                                    i
                                    t
                                 
                                 c
                              
                              ←
                              λ
                              
                                 y
                                 
                                    i
                                    t
                                    −
                                    1
                                 
                                 c
                              
                              +
                              
                                 (
                                 
                                    1
                                    −
                                    λ
                                 
                                 )
                              
                              
                                 y
                                 
                                    i
                                    t
                                 
                                 
                                    M
                                    P
                                 
                              
                              ,
                              
                              
                              0
                              <
                              λ
                              <
                              1
                           
                        . For the first iteration, 
                           
                              y
                              0
                              c
                           
                         is set to equal the solution of MP. Fig. 5
                         depicts the pseudo-code for the accelerated multi-cut L-shaped algorithm with the Pareto-optimal cut scheme. In step iii, the corresponding Magnanti–Wong problem (86) is solved to obtain a Pareto-optimal cut.

In Section 7.1, the mathematical formulation is verified by performing sensitivity analysis on some important parameters in small instances. Then in Section 7.2, stability analysis is done to verify that our developed scenario generation and reduction algorithm generates appropriate scenario trees. Finally in Section 7.3, we describe computational experiments using the proposed stochastic BD algorithm for solving large-scale CLSCN design problems.

To assess the model performance, two test instances described in Table 1 are considered. We generate scenarios for uncertain transportation costs. Then, for each scenario uncertainty sets of demand and return are developed. To do so, we sample nominal demands from a uniform distribution specified in Table 1. Then, we determine maximum positive and negative deviations from the nominal scenario such that the deviation interval of uncertain demand is a subset of the interval defined in Table 1. The same procedure is used to obtain uncertainty sets for returns.

Other parameters are generated randomly according to the uniform distributions specified in Table 2
                        . The instances are solved by GAMS 23.5 using ILOG-CPLEX 11.0. To explore the effects of the main parameters on solutions, sensitivity analysis is performed on operational costs, penalty costs analysis, selling price and uncertainty budgets.

First, we examine solution sensitivity to some essential costs, such as remanufacturing, collection, and manufacturing costs. Changing these operational costs affects the amount of demands satisfied and the amount of returns collected. To investigate these effects, one cost at a time is multiplied by some constant coefficients. Then we examine the sensitivity of expected coverage of demand and returns, as well as profit, over the scenarios.

The fluctuation of the optimal expected profit and the expected coverage of return and demand over scenarios are demonstrated in Tables 3
                            and 4
                            for different values of remanufacturing and collection costs, respectively. Increasing these costs results in decreasing the expected coverage of return as well as the profit. In fact, with extreme increase in these operational costs, the expected coverage of return decreases to zero because collecting and acquiring end-of-use products is no longer economical. However, changing the collection and remanufacturing costs has no effect on the expected coverage of demand.


                           Table 5
                            shows that when the manufacturing cost increases, the expected coverage of demand and profit will decrease, but the expected coverage of returns will increase. When the manufacturing cost increases in the forward network, the system tries to satisfy demand by remanufacturing used products collected from retailers. Thus, with increase in manufacturing cost, the expected coverage of returns increases and, since the remanufactured products are not sufficient to meet the demand, the expected coverage of demand decreases.
                        

Next we investigate the impact of penalty costs for unsatisfied demand and scrap costs for uncollected returns on the expected coverage of demand and return, respectively, followed by the relation between surplus cost and the expected coverage of demand and also the relation between penalty cost and the expected coverage of return. There is an inverse relation between the surplus and penalty costs in the forward network and also between the scrap and penalty costs in the reverse network. In the forward network, the CLSCN seeks a trade-off between the penalty and surplus costs such that their total is minimized. Likewise, in the reverse network, the optimization achieves a trade-off between the penalty and scrap costs such that their total is also minimized. These costs serve to balance the forward flows with the demand and the reverse flows with the return quantities as much as possible.

As the results in Table 6 show, increasing the penalty cost for unsatisfied demands results in higher expected coverage of demand and lower total profit. A similar sensitivity of the expected coverage of return to its corresponding scrap cost of uncollected returns is also seen in Table 7.
                           
                        

Furthermore, as Table 8
                            illustrates, increasing the unit surplus cost for excess amount of flows over demands in retailers lowers the expected coverage of demand and the total profit. A similar result for penalty costs on the excess amount of flows over returns is shown in Table 9.
                           
                        

The selling price has an important influence on the total profit and the expected coverage of demand. The sensitivity is explored by multiplying the price by a constant coefficient.

From Table 10
                           , increasing the selling price causes the expected coverage of demand and profit to increase. The reason for this system behavior is that the cost prices of the product for different customers are different and so the system tries to satisfy the demand of customers whose cost price is less than the selling price. Increasing the selling price raises the number of such customers and so the expected coverage of demands will increase.

The effect of uncertainty is studied by changing the budget of uncertainty parameters for uncertain demands and returns. We define ρ as the level of variability of the uncertain parameter respect to its nominal value and consider the values 
                              
                                 ρ
                                 =
                                 5
                                 %
                                 ,
                                 
                                 10
                                 %
                                 ,
                                 
                                 20
                                 %
                              
                            and
30%. With the help of this parameter we can change the radius of the polyhedral uncertainty sets. In test instance 1, for each level of variability of uncertain demand, we vary 
                              
                                 Γ
                                 s
                                 D
                              
                            in each scenario s from 0 (the nominal formulation) to its maximum value 
                              
                                 |
                                 K
                                 |
                                 ×
                                 |
                                 T
                                 |
                                 =
                                 20
                              
                            (the worst-case formulation) by 1, while maintaining 
                              
                                 
                                    Γ
                                    s
                                    R
                                 
                                 =
                                 0
                              
                            to investigate just the uncertainty in demand. In addition, a bound on the probability of constraint violation is computed according to Eq. (31) under the assumption of symmetric distributions for independent demand and return quantities. The percent decrease in the optimal profit value and the constraint violation probability bound for each scenario s independently are plotted in Figs. 6
                            and 7
                           , respectively, as functions of 
                              
                                 Γ
                                 s
                                 D
                              
                            and

                              
                                 Γ
                                 s
                                 R
                              
                           . Here, the relative decrease in optimal profit is calculated as 
                              
                                 
                                    (
                                    
                                       
                                          z
                                          N
                                       
                                       −
                                       
                                          z
                                          R
                                       
                                    
                                    )
                                 
                                 /
                                 
                                    Z
                                    N
                                 
                              
                            where ZN
                            and ZR
                            are the nominal and robust optimal profits, respectively.

As expected, we observe from Figs. 6 and 7 that for each level of variability, the magnitude of reduction in profit increases while the constraint violation probability decreases with as the uncertainty budget increases. However, the bound on the probability of constraint violation computed according to Eq. (31) applies only to a single robust constraint. To our knowledge, no bounds have been developed for probability of violating multiple robust constraints together. To investigate this, we compute an empirical frequency of constraint violation in a simulation. Test instance 1 is solved for different values of 
                              
                                 Γ
                                 s
                                 D
                              
                            and 
                              
                                 Γ
                                 s
                                 R
                              
                            as they are increased from 0 to 20 in increments of one. Then, for each solved test instance 1 with different values of 
                              
                                 Γ
                                 s
                                 D
                              
                            and 
                              
                                 Γ
                                 s
                                 R
                              
                           , we generate random values a thousand times for the collection of uncertain demands and returns uniformly within their associated polyhedral uncertainty sets. Next, based on the optimal values for the decision variables and these sampled values of demand and return quantities, we check to see whether the robust constraints are feasible or not, and so obtain the violation frequency of our hybrid robust-stochastic problem. To compare with each other for test instance 1, these frequencies as well as the constraint violation probability bound for each scenario s, which is calculated based on Eq. (31), are plotted together in Fig. 8
                            as functions of 
                              
                                 Γ
                                 s
                                 D
                              
                            and 
                              
                                 Γ
                                 s
                                 R
                              
                           .

In Fig. 8, the red curve with diamond markers shows the deviation from optimal profit for different values of 
                              
                                 Γ
                                 s
                                 D
                              
                            and 
                              
                                 Γ
                                 s
                                 R
                              
                           . Also, the green plot with star markers shows the violation probability of a single constraint computed using Eq. (31). However, according to the approximate violation frequencies illustrated by the blue plot with triangle markers, if we choose

                              
                                 
                                    Γ
                                    s
                                    D
                                 
                                 ,
                                 
                                    Γ
                                    s
                                    R
                                 
                                 ≤
                                 4
                              
                           , then the overall violation probability is approximately 1, which means that when the highest objective value is obtained it is not robust with respect to changing the values of our uncertain parameters. By increasing the values of 
                              
                                 Γ
                                 s
                                 D
                              
                            and

                              
                                 Γ
                                 s
                                 R
                              
                            from 4 to 14 constraint violation frequency decreases sharply. Finally, if we choose our budget of uncertainty parameters from

                              
                                 
                                    Γ
                                    s
                                    D
                                 
                                 ,
                                 
                                    Γ
                                    s
                                    R
                                 
                                 >
                                 14
                              
                           , then there is not much difference in violation frequency and in fact it is close to 0, but the objective value may be unacceptably high. This suggests that moderate values of the uncertainty budgets, such as 10, may provide a good tradeoff between cost and robustness.

One of the main criteria which should be satisfied by a scenario generation and reduction method is stability. If several scenario trees with the same input data are generated and we solve our problem with these scenario trees, then we should obtain (approximately) the same optimal value of the objective function. That is, if we generate |L| scenario trees 
                           
                              
                                 ξ
                                 l
                              
                              ,
                              
                              l
                              =
                              1
                              ,
                              …
                              ,
                              L
                           
                         using our scenario generation and reduction algorithm, solve the CLSCN design problem with each one of these scenario trees, and obtain the optimal solution

                           
                              
                                 x
                                 l
                                 *
                              
                              ,
                              
                              l
                              =
                              1
                              ,
                              …
                              ,
                              L
                           
                        , then stability means that we should have
                           
                              f
                              
                                 (
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       l
                                       *
                                    
                                    ,
                                    
                                       ξ
                                       l
                                    
                                 
                                 )
                              
                              ≈
                              f
                              
                                 (
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       u
                                       *
                                    
                                    ,
                                    
                                       ξ
                                       u
                                    
                                 
                                 )
                              
                              ,
                              
                              ∀
                              l
                              ,
                              
                              u
                              
                              ∈
                              
                              1
                              ,
                              
                              …
                              ,
                              
                              L
                           
                         where
                           
                              f
                              (
                              
                                 
                                    
                                       x
                                       ^
                                    
                                    l
                                    *
                                 
                                 ,
                                 
                                    ξ
                                    l
                                 
                              
                              )
                           
                         is the optimal objective function value with respect to the scenario tree l. This type of stability means that the real performance of the optimal solution 
                           
                              x
                              l
                              *
                           
                         is stable; i.e., it is not dependent upon which scenario tree we choose (Kaut & Wallace, 2007). To carry out this stability analysis, we generate eight scenario trees for test instances 1 and 2, solve the hybrid robust-stochastic CLSCN design problem with the other input data held constant and then the optimal objective function values are reported in Table 11
                        . The lack of any substantial difference between the optimal objective values indicates stability.

We measure the computational efficiencies achieved by adding VIs and employing Pareto-optimal cuts in terms of computing times, number of Benders cycles and the quality of lower bounds. The characteristics of test instances are described in Table 12
                        . The transportation cost scenarios are based on an AR (1) process with α = 30, β
                        1 = 0.15, and error terms normally distributed with a mean 0. The accelerated BD algorithm is coded in MATLAB and tested on a computer with CPU Intel Core i7, 2.5 gigahertz and 8 gigabytes RAM. CPLEX 11.0 is used to solve MP and BSPs. We solve each instance both with and without VIs and Pareto-optimal cuts.


                           Table 13
                            compares the effects of different combinations of VIs on the lower bounds, optimality gap, the number of BD iterations (Iters) and computational times. Here, BD denotes the BD algorithm without any VI, and BDVI1, BDVI2, and BDVI12 denote that VIs (80)–(82), (83)–(86), and (80)–(86), respectively, are added to the MP. The stopping criteria are (1) optimality gap below a threshold value 0.009 or (2) a maximum of 70 Benders iterations is reached. In Table 13, we see that VI2 itself does not make any significant impact on either the number of Benders iterations or the optimality gap. However, BDVI12 consistently improves the lower bound as compared with the classical BD algorithm, and so increases the convergence rate. Moreover, when the maximum number of iterations is reached, for example in instances 3 and 8, the gaps provided including both VIs are better than those provided with either VI alone. Of the two sets of VIs alone, the first (VI1) improves the lower bound more and so is more efficient.

In Table 13, the lower bound, the optimality gap and the number of Benders iterations are also displayed for the BD variants with Pareto-optimal cuts and also with a hybrid strategy that combines the VIs with the Pareto-optimal cuts. Note that in our computational experiments, a core point approximation 
                              
                                 
                                    y
                                    ¯
                                 
                                 0
                                 c
                              
                            is initialized with a feasible solution to our RMP and then we update the approximation at each successive iteration by setting 
                              
                                 
                                    
                                       y
                                       ¯
                                    
                                    
                                       i
                                       t
                                    
                                    c
                                 
                                 ←
                                 λ
                                 
                                    
                                       y
                                       ¯
                                    
                                    
                                       i
                                       t
                                       −
                                       1
                                    
                                    c
                                 
                                 +
                                 
                                    (
                                    
                                       1
                                       −
                                       λ
                                    
                                    )
                                 
                                 
                                    
                                       y
                                       ^
                                    
                                    
                                       i
                                       t
                                    
                                    
                                       M
                                       P
                                    
                                 
                              
                           . We set 
                              
                                 λ
                                 =
                                 0.5
                              
                            according to empirical observations of Papadakos (2008) and Oliveira et al. (2014). The BDVI12 variant has lower optimality gaps than the BD variant with Pareto-optimal cuts. The hybrid strategy achieves even better results in terms of optimality gap and the iteration count compared with other variants of BD algorithm. Table 13 also displays the computational times for solving each test instance by each BD variant and also by directly solving the extensive form by CPLEX. The CPLEX computational times are smaller for the test instances with few scenarios. As the number of scenarios increases, the BD algorithm, especially with the hybrid strategy, outperforms CPLEX. Moreover, we see that when we apply the BD algorithm with Pareto-optimal cut, the number of iterations and optimality gap are decreased for most test instances compared with BD, BDV1, BDV2, and BDV12. But, this algorithm has the highest computational time compared with all BD algorithms. The smaller numbers of Benders iterations when using Pareto-optimal cuts do not necessarily mean smaller computational times in fact, the computational times are increased as a result of the time spent to solve the Magnanti–Wong problem to obtain the Pareto-optimal cuts. Here, each iteration is more effective than each iteration in other BD algorithms and that is why we have less the number of iterations and optimality gap compared with BD, BDV1, BDV2, and BDV12, but each iteration takes longer. However, when we add both VI1 and VI2 to the BD algorithm with Pareto-optimal cut as the BD algorithm with hybrid strategy, it gives us the best performance in terms of both computational time and also optimality gaps and number of Benders cycles for large-scale instances such as instance 5, 6, 7, and 8. Therefore, the Pareto-optimal cuts generation scheme plus adding both valid inequalities demonstrates the best performance in general.

@&#CONCLUSION@&#

In this paper, a mixed-integer linear programming model for a multi-period, single-product and capacitated CLSCN design problem is formulated to maximize the expected profit. As the major contribution, a hybrid robust-stochastic programming approach is developed to model qualitatively different uncertainties. We assume historical data exist for transportation costs and use them to generate probabilistic scenarios by a scenario generation and reduction algorithm. Then, in each scenario for transportation costs, polyhedral uncertainty sets are proposed for demand and return quantities in the absence of historical data for a new product. Some numerical instances are created to analyze and validate formulation. To solve this combinatorial problem, an accelerated stochastic BD algorithm is proposed. Two groups of valid inequalities are added to the master problem to efficiently improve the lower bound, and Pareto-optimal cuts are also applied to further accelerate convergence. The computational results demonstrate that the combination of all valid inequalities is most effective for improving the lower bound. Also, the Pareto-optimal cut generation scheme results in significant improvement for some instances where the number of Benders iterations is large. Overall, the combination of VIs and Pareto-optimal cuts demonstrates the best average performance.

As this paper introduces a novel combination of robust and stochastic optimization in the context of CLSCN design, there are some opportunities for future research such as applying other robust optimization approaches and even other uncertainty sets such as ellipsoidal ones, as well as investigating the management of disruption risk in the CLSCN design problem. Moreover, to solve this large-scale problem, other versions of the BD approach such as a Benders-based branch-and-cut approach, where a single branch-and-cut tree is constructed and then the Benders cuts are added during the exploration of this tree, can be applied for performance comparisons.

@&#ACKNOWLEDGEMENTS@&#

The authors thank the associate editor and the anonymous referees for their valuable and constructive comments on this research, which improved the content and presentation substantially. This material is based upon work supported by the National Science Foundation under Grant No. 1130900.

@&#REFERENCES@&#

