@&#MAIN-TITLE@&#Feature selection and multi-kernel learning for adaptive graph regularized nonnegative matrix factorization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Graph has been used to regularize nonnegative matrix factorization (NMF).


                        
                        
                           
                           However, noisy features and nonlinear distributed data effect the graph construction.


                        
                        
                           
                           We proposed to integrate feature selection and multi-kernel learning to this problem.


                        
                        
                           
                           Novel algorithms are developed to learn feature/kernel weights and NMF parameters.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Data representation

Nonnegative matrix factorization

Graph regularization

Feature selection

Multi-kernel learning

@&#ABSTRACT@&#


               
               
                  Nonnegative matrix factorization (NMF), a popular part-based representation technique, does not capture the intrinsic local geometric structure of the data space. Graph regularized NMF (GNMF) was recently proposed to avoid this limitation by regularizing NMF with a nearest neighbor graph constructed from the input data set. However, GNMF has two main bottlenecks. First, using the original feature space directly to construct the graph is not necessarily optimal because of the noisy and irrelevant features and nonlinear distributions of data samples. Second, one possible way to handle the nonlinear distribution of data samples is by kernel embedding. However, it is often difficult to choose the most suitable kernel. To solve these bottlenecks, we propose two novel graph-regularized NMF methods, AGNMF
                        FS
                      and AGNMF
                        MK
                     , by introducing feature selection and multiple-kernel learning to the graph regularized NMF, respectively. Instead of using a fixed graph as in GNMF, the two proposed methods learn the nearest neighbor graph that is adaptive to the selected features and learned multiple kernels, respectively. For each method, we propose a unified objective function to conduct feature selection/multi-kernel learning, NMF and adaptive graph regularization simultaneously. We further develop two iterative algorithms to solve the two optimization problems. Experimental results on two challenging pattern classification tasks demonstrate that the proposed methods significantly outperform state-of-the-art data representation methods.
               
            

@&#INTRODUCTION@&#

Nonnegative matrix factorization (NMF) (Lee & Seung, 2000; Sun, Wu, Wu, Guo, & Lu, 2012; Wang, Almasri, & Gao, 2012b; Wang, Bensmail, & Gao, 2013a; Wang & Gao, 2013; Wang, Wang, & Gao, 2013c) decomposes a nonnegative data matrix as a product of two low-rank nonnegative matrices, one of them is regarded as the basis matrix, while the other one as the coding matrix, which could be used as a reduced representation of the data samples in the data matrix (Kim, Chen, Kim, Pan, & Park, 2011a). This method has become popular in recent years for data representation in various areas, such as bioinformatics (Zheng, Ng, Zhang, Shiu, & Wang, 2011) and computer vision (Cai et al., 2013). Recently, Cai, He, Han, and Huang (2011) argued that NMF fails to exploit the intrinsic local geometric structure of the data space. They improved the traditional NMF to graph regularized nonnegative matrix factorization (GNMF). The basic idea is that the data samples are drawn from a low-dimensional manifold with a local geometric structure (Orsenigo & Vercellis, 2012; Wang, Bensmail, & Gao, 2012a, 2014a; Wang, Bensmail, Yao, & Gao, 2013b; Wang, Sun, & Gao, 2014b). Thus the nearby data samples in the original data space should also have similar NMF representations. In GNMF, the geometric structure of the data space is encoded by constructing a nearest neighbor graph, and then the matrix factorization is sought by adding a graph regularization to the original NMF objective function. The key component of GNMF is the graph. In the original GNMF algorithm, the graph is constructed according to the original input feature space. The nearest neighbors of a data sample is found by comparing the Euclidean distances (Lee, Rajkumar, Lo, Wan, & Isa, 2013a; Merigó & Casanovas, 2011) between pairs of data points, while the weights of edges are also estimated in the Euclidean space, by assuming that the original features could provide a proper representation of the local structure of the data space. However, as is well known that in many pattern recognition problems, using the original feature space directly is not appropriate because of the noisy and irrelevant features and the nonlinear distribution of the samples.

To handle the noisy and irrelevant features, one may apply feature selection (Fakhraei, Soltanian-Zadeh, & Fotouhi, 2014; Iquebal, Pal, Ceglarek, & Tiwari, 2014; Lin, Chen, & Wu, 2014; Li, Wu, Li, & Ding, 2013b, 2013a) to assign different weights to different features, so that the data samples could be represented in a better way than using the original features. So far, the most broadly used feature selection method is proposed by Sun et al. (2012). Such an approach is able to determine feature weights from a statistics point of view to automatically discover the intrinsic features. It provides a powerful and efficient solution for feature selection in NMF. So this work has been internationally recognized by the researchers in this field. To handle the nonlinear distribution of the data samples, one could map the input data into a nonlinear feature space by kernel embedding (Cui & Soh, 2010; Yeh, Su, & Lee, 2013). However, the most suitable types and parameters of the kernels for a particular task is often unknown, and selection of the optimal kernel by exhaustive search on a pre-defined pool of kernels is usually time-consuming, and sometimes causes over-fitting. Multi-kernel learning (Chen, Li, Wei, Xu, & Shi, 2011; Yeh, Huang, & Lee, 2011), which seeks the optimal kernel by a weighted, linear combination of pre-defined candidate kernels, has been introduced to handle the problem of kernel selection. An, Yun, and Choi (2011), presented the Multi-Kernel NMF (NMF
                        MK
                     ), which learns the best convex combination of multiple kernel matrices and NMF parameters jointly. However, graph regularization was not taken into consideration in their framework. In this paper, we will incorporate feature selection and multi-kernel learning into the graph regularization NMF to obtain novel and enhanced data representation methods. In this way, we could handle the problem of noisy and irrelevant features, nonlinearly distributed data samples, graph construction, and data matrix factorization simultaneously. Compared to the methods reported in the current literature which use a fixed graph for NMF parameters learning, our method can adapt the graph to the learned feature or kernel weights, which improves the NMF by providing it with a more reliable graph.

Here, we propose two novel methods, AGNMF
                        FS
                      and AGNMF
                        MK
                     , that incorporate features selection and multiple-kernel learning into graph-regularized NMF, respectively. Feature selection or multi-kernel learning will provide a new data space for the graph construction of GNMF, and at the same time, GNMF will direct feature selection or multi-kernel learning. Both AGNMF
                        FS
                      and AGNMF
                        MK
                      are formulated as constraint optimization problems, each of which has a unified objective function to optimize feature selection/multi-kernel learning and graph-regularized NMF simultaneously. Experimental results demonstrate that the two proposed methods significantly outperform state-of-the-art data representation methods.

The rest of the paper is organized as follows: We briefly review the GNMF in Section 2. We then propose the two novel algorithms, AGNMF
                        FS
                      and AGNMF
                        MK
                     , in Section 3. The proposed methods are compared with other NMF learning methods on two challenging data sets for classification tasks in Section 4. Finally, the paper is concluded in Section 5 with some future works.

In this section, we will briefly introduce the graph regularized NMF as background knowledge of this paper.

Given a training set with N nonnegative data samples 
                           
                              X
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                              }
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                                 
                                    D
                                 
                              
                           
                         represented as a nonnegative data matrix 
                           
                              X
                              =
                              [
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                              ]
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                                 
                                    D
                                    ×
                                    N
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                                 
                                    D
                                 
                              
                           
                         is the D-dimensional nonnegative feature vector of the nth sample, NMF aims to find two nonnegative matrices H and W whose product can well approximate the original matrix X as
                           
                              (1)
                              
                                 X
                                 ≈
                                 HW
                                 ,
                              
                           
                        where 
                           
                              H
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    D
                                    ×
                                    R
                                 
                              
                           
                        , and 
                           
                              W
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    R
                                    ×
                                    N
                                 
                              
                           
                        . Accordingly, each sample 
                           
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                           
                         is approximated by a linear combination of the columns of H, weighted by the components of the nth column of W, as
                           
                              (2)
                              
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 ≈
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          =
                                          1
                                       
                                       
                                          R
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       rn
                                    
                                 
                              
                           
                        
                     

Therefore, H can be regarded as a collection of basis vectors, while, 
                           
                              
                                 
                                    w
                                 
                                 
                                    n
                                 
                              
                           
                        , the nth columns of W, can be regarded as the coding vector or a new representation of the nth data sample. The most commonly used cost function to solve H and W is based on the squared Euclidean distance (SED) between the two matrices:
                           
                              (3)
                              
                                 
                                    
                                       O
                                    
                                    
                                       NMF
                                    
                                 
                                 (
                                 H
                                 ,
                                 W
                                 )
                                 =
                                 |
                                 |
                                 X
                                 -
                                 HW
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 Tr
                                 (
                                 
                                    
                                       XX
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 -
                                 2
                                 Tr
                                 (
                                 
                                    
                                       XW
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 +
                                 Tr
                                 (
                                 
                                    
                                       HWW
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              Tr
                              (
                              ·
                              )
                           
                         denotes the trace of a matrix.


                        Cai et al. (2011) introduced the GNMF algorithm, by imposing the local invariance assumption (LIA) to NMF. If two data samples 
                           
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                              
                           
                         are close in the intrinsic geometric space of the data distribution, 
                           
                              
                                 
                                    w
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    m
                                 
                              
                           
                        , the coding vectors of these two samples with respect to the new basis, should also be close to each other; and vice versa. They modeled the local geometric structure by a K-nearest neighbor graph 
                           
                              G
                           
                         constructed from the data set 
                           
                              X
                           
                        . For each data sample 
                           
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                              ∈
                              X
                           
                        , the set of its K nearest neighbors, 
                           
                              
                                 
                                    N
                                 
                                 
                                    n
                                 
                              
                           
                        , in 
                           
                              X
                           
                         is determined by the SED metric (Lee et al., 2013a) as
                           
                              (4)
                              
                                 d
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 =
                                 |
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             dn
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             dm
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 -
                                 2
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        
                     

A K-nearest neighbor graph is constructed for 
                           
                              X
                           
                        . Each data sample in 
                           
                              X
                           
                         will be a node of the graph, and each node 
                           
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                           
                         will be connected to its K nearest neighbors 
                           
                              
                                 
                                    N
                                 
                                 
                                    n
                                 
                              
                           
                        . We also define a weight matrix 
                           
                              A
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    N
                                    ×
                                    N
                                 
                              
                           
                         on the graph, with 
                           
                              
                                 
                                    A
                                 
                                 
                                    nm
                                 
                              
                           
                         equal to the weight of the connection between nodes 
                           
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                              
                           
                        . There are many choices to define the weight matrix A. Two of the most commonly used options are as follows:
                           
                              
                                 Gaussian kernel weighting
                              
                              
                                 
                                    
                                       (5)
                                       
                                          
                                             
                                                A
                                             
                                             
                                                nm
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            exp
                                                            
                                                               
                                                                  
                                                                     -
                                                                     
                                                                        
                                                                           |
                                                                           |
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 n
                                                                              
                                                                           
                                                                           -
                                                                           
                                                                              
                                                                                 x
                                                                              
                                                                              
                                                                                 m
                                                                              
                                                                           
                                                                           |
                                                                           
                                                                              
                                                                                 |
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 σ
                                                                              
                                                                              
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            ,
                                                         
                                                         
                                                            if
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                            ,
                                                         
                                                         
                                                            otherwise
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       (6)
                                       
                                          
                                             
                                                A
                                             
                                             
                                                nm
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  n
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            ,
                                                         
                                                         
                                                            if
                                                            
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  n
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                            ,
                                                         
                                                         
                                                            otherwise
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

With the weight matrix A, we can use the following graph regularization term to measure the smoothness of the low-dimensional coding vector representations in W:
                           
                              (7)
                              
                                 
                                    
                                       O
                                    
                                    
                                       G
                                    
                                 
                                 (
                                 W
                                 ;
                                 A
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          ,
                                          m
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       n
                                    
                                 
                                 -
                                 
                                    
                                       w
                                    
                                    
                                       m
                                    
                                 
                                 |
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       nm
                                    
                                 
                                 =
                                 Tr
                                 (
                                 
                                    
                                       WDW
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 -
                                 Tr
                                 (
                                 
                                    
                                       WAW
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 =
                                 Tr
                                 (
                                 
                                    
                                       WLW
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 ,
                              
                           
                        where D is a diagonal matrix whose entries are column sums of A, i.e., 
                           
                              
                                 
                                    D
                                 
                                 
                                    nn
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    m
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    nm
                                 
                              
                           
                         and 
                           
                              L
                              =
                              D
                              -
                              A
                           
                         is the graph Laplacian matrix. By minimizing 
                           
                              
                                 
                                    O
                                 
                                 
                                    G
                                 
                              
                              (
                              W
                              ;
                              A
                              )
                           
                         with regard to W, we expect that if two data points 
                           
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                              
                           
                         are close, i.e., 
                           
                              
                                 
                                    A
                                 
                                 
                                    nm
                                 
                              
                           
                         is large, 
                           
                              
                                 
                                    w
                                 
                                 
                                    n
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    m
                                 
                              
                           
                         are also close to each other.

Combining this geometry-based regularizer, 
                           
                              
                                 
                                    O
                                 
                                 
                                    G
                                 
                              
                              (
                              W
                              ;
                              A
                              )
                           
                        , with the original NMF objective function, 
                           
                              
                                 
                                    O
                                 
                                 
                                    NMF
                                 
                              
                              (
                              H
                              ,
                              W
                              )
                           
                        , leads to the loss function of GNMF (Cai et al., 2011):
                           
                              (8)
                              
                                 
                                    
                                       O
                                    
                                    
                                       GNMF
                                    
                                 
                                 (
                                 H
                                 ,
                                 W
                                 ;
                                 A
                                 )
                                 =
                                 
                                    
                                       O
                                    
                                    
                                       NMF
                                    
                                 
                                 (
                                 H
                                 ,
                                 W
                                 )
                                 +
                                 α
                                 
                                    
                                       O
                                    
                                    
                                       G
                                    
                                 
                                 (
                                 W
                                 ;
                                 A
                                 )
                                 =
                                 Tr
                                 (
                                 
                                    
                                       XX
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 -
                                 2
                                 Tr
                                 (
                                 
                                    
                                       XW
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 +
                                 Tr
                                 (
                                 
                                    
                                       HWW
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 +
                                 α
                                 Tr
                                 (
                                 
                                    
                                       WLW
                                    
                                    
                                       ⊤
                                    
                                 
                                 )
                                 ,
                              
                           
                        in which α is a tradeoff parameter. Thus the GNMF problem turns to a constrained minimization problem as
                           
                              (9)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      H
                                                      ,
                                                      W
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   O
                                                
                                                
                                                   GNMF
                                                
                                             
                                             (
                                             H
                                             ,
                                             W
                                             ;
                                             A
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             H
                                             ⩾
                                             0
                                             ,
                                             
                                             W
                                             ⩾
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        where H and W can be solved in an iterative manner by optimizing and updating them alternately (Cai et al., 2011).

In this section, we propose two enhanced data representation methods based on GNMF by encoding feature selection and multi-kernel learning, respectively.

Given an input sample x represented as a vector of D nonnegative features as 
                              
                                 x
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             D
                                          
                                       
                                       ]
                                    
                                    
                                       ⊤
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                    
                                       D
                                    
                                 
                              
                           , feature selection tries to scale each feature to obtain a weighted feature space, parameterized by a D-dimensional nonnegative feature weight vector 
                              
                                 λ
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             D
                                          
                                       
                                       ]
                                    
                                    
                                       ⊤
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                    
                                       D
                                    
                                 
                              
                           , where 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       d
                                    
                                 
                              
                            is the scaling factor for the dth feature (Sun, Todorovic, & Goodison, 2010b). We restrict its scale by 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       d
                                       =
                                       1
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 1
                              
                            and 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       d
                                    
                                 
                                 ⩾
                                 0
                              
                           . Thus the scaled feature vector of x is represented as 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             D
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             D
                                          
                                       
                                       ]
                                    
                                    
                                       ⊤
                                    
                                 
                                 =
                                 diag
                                 (
                                 λ
                                 )
                                 x
                              
                           , where 
                              
                                 diag
                                 (
                                 λ
                                 )
                              
                            is a 
                              
                                 D
                                 ×
                                 D
                              
                            diagonal matrix with entries of λ along the main diagonal. The original data matrix and basis matrix for NMF can be represented in the scaled space as (10),
                              
                                 (10)
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ̃
                                       
                                    
                                    =
                                    diag
                                    (
                                    λ
                                    )
                                    X
                                    
                                    and
                                    
                                    
                                       
                                          H
                                       
                                       
                                          ̃
                                       
                                    
                                    =
                                    diag
                                    (
                                    λ
                                    )
                                    H
                                    ,
                                    
                                    s
                                    .
                                    t
                                    .
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             d
                                             =
                                             1
                                          
                                          
                                             D
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          d
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                    
                                    d
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    D
                                    .
                                 
                              
                           
                        

By replacing the original features in X and H of NMF with the weighted features 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ̃
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       H
                                    
                                    
                                       ̃
                                    
                                 
                              
                            defined in (10), we have the augmented objective function for NMF with feature selection in an enlarged parameter space
                              
                                 (11)
                                 
                                    
                                       
                                          O
                                       
                                       
                                          
                                             
                                                NMF
                                             
                                             
                                                FS
                                             
                                          
                                       
                                    
                                    (
                                    H
                                    ,
                                    W
                                    ,
                                    λ
                                    )
                                    =
                                    |
                                    |
                                    diag
                                    (
                                    λ
                                    )
                                    (
                                    X
                                    -
                                    HW
                                    )
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    Tr
                                    [
                                    diag
                                    
                                       
                                          (
                                          λ
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          XX
                                       
                                       
                                          ⊤
                                       
                                    
                                    ]
                                    -
                                    2
                                    Tr
                                    [
                                    diag
                                    
                                       
                                          (
                                          λ
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          XW
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          ⊤
                                       
                                    
                                    ]
                                    +
                                    Tr
                                    [
                                    diag
                                    
                                       
                                          (
                                          λ
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          HWW
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          ⊤
                                       
                                    
                                    ]
                                 
                              
                           
                        

Here 
                              
                                 H
                                 ,
                                 
                                 W
                              
                            and λ are all the variables to solve so that the above objective function can be minimized.

After the new feature space defined by feature weight vector λ is defined, the nearest neighbor graph should also be updated to be adaptive to the selected features. First, the K nearest neighbors, 
                              
                                 
                                    
                                       N
                                    
                                    
                                       n
                                    
                                 
                              
                           , of the nth data point should be re-found according to the λ-weighted SED, i.e.,
                              
                                 (12)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    )
                                    =
                                    |
                                    |
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             d
                                             =
                                             1
                                          
                                          
                                             D
                                          
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                dn
                                             
                                          
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                dm
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        

The K nearest neighbors 
                              
                                 
                                    
                                       N
                                    
                                    
                                       n
                                    
                                 
                              
                            re-found by the λ-weighted distance is denoted as 
                              
                                 
                                    
                                       N
                                    
                                    
                                       n
                                    
                                    
                                       λ
                                    
                                 
                              
                           , and the graph adaptive to λ is donated as 
                              
                                 
                                    
                                       G
                                    
                                    
                                       λ
                                    
                                 
                              
                           . The corresponding weight matrix 
                              
                                 
                                    
                                       A
                                    
                                    
                                       λ
                                    
                                 
                              
                            of 
                              
                                 
                                    
                                       G
                                    
                                    
                                       λ
                                    
                                 
                              
                            should also be updated. Here we discuss how to update the Gaussian kernel weighting for adaptive graph with feature selection, which is updated as 
                              
                                 
                                    
                                       A
                                    
                                    
                                       nm
                                    
                                    
                                       λ
                                    
                                 
                                 exp
                                 (
                                 -
                                 
                                    
                                       |
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             n
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             m
                                          
                                       
                                       |
                                       
                                          
                                             |
                                          
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                            if 
                              
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       n
                                    
                                    
                                       λ
                                    
                                 
                              
                           , and 0 otherwise.

With the adaptive graph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       λ
                                    
                                 
                              
                           , we can re-regularize the NMF in the selected feature space. Similar to the GNMF, we propose the adaptive graph regularization term as
                              
                                 (13)
                                 
                                    
                                       
                                          O
                                       
                                       
                                          AG
                                       
                                    
                                    (
                                    W
                                    ;
                                    
                                       
                                          A
                                       
                                       
                                          λ
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ,
                                             m
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          w
                                       
                                       
                                          m
                                       
                                    
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          nm
                                       
                                       
                                          λ
                                       
                                    
                                    =
                                    Tr
                                    (
                                    
                                       
                                          WL
                                       
                                       
                                          λ
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          ⊤
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       L
                                    
                                    
                                       λ
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       λ
                                    
                                 
                                 -
                                 
                                    
                                       A
                                    
                                    
                                       λ
                                    
                                 
                              
                            is the corresponding graph Laplacian. By minimizing 
                              
                                 
                                    
                                       O
                                    
                                    
                                       AG
                                    
                                 
                                 (
                                 W
                                 ;
                                 
                                    
                                       A
                                    
                                    
                                       λ
                                    
                                 
                                 )
                              
                           , we expect that if two data points 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                              
                            are close with respect to the new features selected by λ, the representations 
                              
                                 
                                    
                                       w
                                    
                                    
                                       n
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       m
                                    
                                 
                              
                            with respect to the selected features should also be close to each other.

To perform the feature selection together with the adaptive graph regularized NMF, we first propose the unified objective function for adaptive graph regularized NMF and feature selection for data representation, and then develop an alternately updating algorithm to estimate the basis matrix H, the coding coefficient matrix W and the feature weight matrix λ.
                              
                                 •
                                 
                                    Objective function: Combining the NMF objective function with feature selection defined in (11) with the adaptive graph-based regularizer defined in (13) leads to the objective function of our AGNMF with feature selection — AGNMF
                                       FS
                                     algorithm:
                                       
                                          (14)
                                          
                                             
                                                
                                                   O
                                                
                                                
                                                   
                                                      
                                                         AGNMF
                                                      
                                                      
                                                         FS
                                                      
                                                   
                                                
                                             
                                             (
                                             H
                                             ,
                                             W
                                             ,
                                             λ
                                             )
                                             =
                                             
                                                
                                                   O
                                                
                                                
                                                   
                                                      
                                                         NMF
                                                      
                                                      
                                                         FS
                                                      
                                                   
                                                
                                             
                                             (
                                             H
                                             ,
                                             W
                                             ,
                                             λ
                                             )
                                             +
                                             α
                                             
                                                
                                                   O
                                                
                                                
                                                   AG
                                                
                                             
                                             (
                                             W
                                             ;
                                             
                                                
                                                   A
                                                
                                                
                                                   λ
                                                
                                             
                                             )
                                             =
                                             Tr
                                             [
                                             diag
                                             
                                                
                                                   (
                                                   λ
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   XX
                                                
                                                
                                                   ⊤
                                                
                                             
                                             ]
                                             -
                                             2
                                             Tr
                                             [
                                             diag
                                             
                                                
                                                   (
                                                   λ
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   XW
                                                
                                                
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   ⊤
                                                
                                             
                                             ]
                                             +
                                             Tr
                                             [
                                             diag
                                             
                                                
                                                   (
                                                   λ
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   HWW
                                                
                                                
                                                   ⊤
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   ⊤
                                                
                                             
                                             ]
                                             +
                                             α
                                             Tr
                                             (
                                             
                                                
                                                   WL
                                                
                                                
                                                   λ
                                                
                                             
                                             
                                                
                                                   W
                                                
                                                
                                                   ⊤
                                                
                                             
                                             )
                                          
                                       
                                    
                                 

The optimization problem (8) of GNMF can now be extended to accommodate the feature selection and adaptive graph:
                                       
                                          (15)
                                          
                                             
                                                
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  min
                                                               
                                                               
                                                                  H
                                                                  ,
                                                                  W
                                                                  ,
                                                                  λ
                                                               
                                                            
                                                         
                                                         
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               
                                                                  
                                                                     AGNMF
                                                                  
                                                                  
                                                                     FS
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         H
                                                         ,
                                                         W
                                                         ,
                                                         λ
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         s
                                                         .
                                                         t
                                                         .
                                                         
                                                         H
                                                         ⩾
                                                         0
                                                         ,
                                                         
                                                         W
                                                         ⩾
                                                         0
                                                         ,
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  d
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  D
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                         =
                                                         C
                                                         ,
                                                         
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                         ⩾
                                                         0
                                                         ,
                                                         
                                                         d
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         D
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    Optimization: Since direct optimization to (15) is difficult, we instead adopt an iterative, two-step strategy to alternately optimize 
                                       
                                          (
                                          H
                                          ,
                                          W
                                          )
                                       
                                     and λ. At each iteration, one of 
                                       
                                          (
                                          H
                                          ,
                                          W
                                          )
                                       
                                     and λ is optimized while the other is fixed, and then the roles of 
                                       
                                          (
                                          H
                                          ,
                                          W
                                          )
                                       
                                     and λ are switched. Iterations are repeated until convergence or a maximum number of iterations is reached.
                                       
                                          –
                                          
                                             On optimizing 
                                             
                                                
                                                   (
                                                   H
                                                   ,
                                                   W
                                                   )
                                                
                                             : By fixing λ and updating the adaptive graph 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         λ
                                                      
                                                   
                                                
                                              with its corresponding Laplacian matrix 
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         λ
                                                      
                                                   
                                                
                                              according to λ, the optimization problem (15) is reduced to
                                                
                                                   (16)
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           min
                                                                        
                                                                        
                                                                           H
                                                                           ,
                                                                           W
                                                                        
                                                                     
                                                                  
                                                                  
                                                                  Tr
                                                                  [
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        XX
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  ]
                                                                  -
                                                                  2
                                                                  Tr
                                                                  [
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        XW
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  ]
                                                                  +
                                                                  Tr
                                                                  [
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        HWW
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  ]
                                                                  +
                                                                  α
                                                                  Tr
                                                                  (
                                                                  
                                                                     
                                                                        WL
                                                                     
                                                                     
                                                                        λ
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        W
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            
                                                               
                                                                  s
                                                                  .
                                                                  t
                                                                  .
                                                                  
                                                                  H
                                                                  ⩾
                                                                  0
                                                                  ,
                                                                  
                                                                  W
                                                                  ⩾
                                                                  0
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          

The Lagrange 
                                                
                                                   L
                                                
                                              of the above optimization problem is
                                                
                                                   (17)
                                                   
                                                      L
                                                      =
                                                      Tr
                                                      [
                                                      diag
                                                      
                                                         
                                                            (
                                                            λ
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            XX
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      ]
                                                      -
                                                      2
                                                      Tr
                                                      [
                                                      diag
                                                      
                                                         
                                                            (
                                                            λ
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            XW
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      ]
                                                      +
                                                      Tr
                                                      [
                                                      diag
                                                      
                                                         
                                                            (
                                                            λ
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            HWW
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      ]
                                                      +
                                                      α
                                                      Tr
                                                      (
                                                      
                                                         
                                                            WL
                                                         
                                                         
                                                            λ
                                                         
                                                      
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      )
                                                      +
                                                      Tr
                                                      (
                                                      Φ
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      )
                                                      +
                                                      Tr
                                                      (
                                                      Ψ
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                
                                             where 
                                                
                                                   Φ
                                                   =
                                                   [
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         dr
                                                      
                                                   
                                                   ]
                                                
                                              and 
                                                
                                                   Ψ
                                                   =
                                                   [
                                                   
                                                      
                                                         ψ
                                                      
                                                      
                                                         rn
                                                      
                                                   
                                                   ]
                                                
                                              are the Lagrange multiplier matrices for constraint 
                                                
                                                   H
                                                   ⩾
                                                   0
                                                
                                              and 
                                                
                                                   W
                                                   ⩾
                                                   0
                                                
                                             , respectively. By setting the partial derivatives of 
                                                
                                                   L
                                                
                                              with respect to H and W to zero, we have
                                                
                                                   (18)
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∂
                                                                        L
                                                                     
                                                                     
                                                                        ∂
                                                                        H
                                                                     
                                                                  
                                                                  =
                                                                  -
                                                                  2
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        XW
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  +
                                                                  2
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        HWW
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  +
                                                                  Φ
                                                                  =
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∂
                                                                        L
                                                                     
                                                                     
                                                                        ∂
                                                                        W
                                                                     
                                                                  
                                                                  =
                                                                  -
                                                                  2
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  X
                                                                  +
                                                                  2
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  HW
                                                                  +
                                                                  2
                                                                  α
                                                                  
                                                                     
                                                                        WL
                                                                     
                                                                     
                                                                        λ
                                                                     
                                                                  
                                                                  +
                                                                  Ψ
                                                                  =
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          

Using the KKT conditions, i.e., 
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         dr
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         dr
                                                      
                                                   
                                                   =
                                                   0
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ψ
                                                      
                                                      
                                                         rn
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         rn
                                                      
                                                   
                                                   =
                                                   0
                                                
                                             , we get the following equations for 
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         dr
                                                      
                                                   
                                                
                                              and 
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         rn
                                                      
                                                   
                                                
                                             : 
                                                
                                                   (19)
                                                   
                                                      -
                                                      
                                                         
                                                            [
                                                            diag
                                                            
                                                               
                                                                  (
                                                                  λ
                                                                  )
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  XW
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            ]
                                                         
                                                         
                                                            dr
                                                         
                                                      
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            dr
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            [
                                                            diag
                                                            
                                                               
                                                                  (
                                                                  λ
                                                                  )
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  HWW
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            ]
                                                         
                                                         
                                                            dr
                                                         
                                                      
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            dr
                                                         
                                                      
                                                      =
                                                      0
                                                      -
                                                      
                                                         
                                                            [
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            diag
                                                            
                                                               
                                                                  (
                                                                  λ
                                                                  )
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            X
                                                            ]
                                                         
                                                         
                                                            rn
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            rn
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            [
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                            diag
                                                            
                                                               
                                                                  (
                                                                  λ
                                                                  )
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            HW
                                                            ]
                                                         
                                                         
                                                            rn
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            rn
                                                         
                                                      
                                                      +
                                                      α
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  WL
                                                               
                                                               
                                                                  λ
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            rn
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            rn
                                                         
                                                      
                                                      =
                                                      0
                                                   
                                                
                                             
                                          

These equations lead to the following updating rules:
                                                
                                                   (20)
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        dr
                                                                     
                                                                  
                                                                  ←
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              [
                                                                              diag
                                                                              
                                                                                 
                                                                                    (
                                                                                    λ
                                                                                    )
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    XW
                                                                                 
                                                                                 
                                                                                    ⊤
                                                                                 
                                                                              
                                                                              ]
                                                                           
                                                                           
                                                                              dr
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              [
                                                                              diag
                                                                              
                                                                                 
                                                                                    (
                                                                                    λ
                                                                                    )
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    HWW
                                                                                 
                                                                                 
                                                                                    ⊤
                                                                                 
                                                                              
                                                                              ]
                                                                           
                                                                           
                                                                              dr
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        dr
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        rn
                                                                     
                                                                  
                                                                  ←
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              [
                                                                              
                                                                                 
                                                                                    H
                                                                                 
                                                                                 
                                                                                    ⊤
                                                                                 
                                                                              
                                                                              diag
                                                                              
                                                                                 
                                                                                    (
                                                                                    λ
                                                                                    )
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                              X
                                                                              +
                                                                              α
                                                                              
                                                                                 
                                                                                    WA
                                                                                 
                                                                                 
                                                                                    λ
                                                                                 
                                                                              
                                                                              ]
                                                                           
                                                                           
                                                                              rn
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              [
                                                                              
                                                                                 
                                                                                    H
                                                                                 
                                                                                 
                                                                                    ⊤
                                                                                 
                                                                              
                                                                              diag
                                                                              
                                                                                 
                                                                                    (
                                                                                    λ
                                                                                    )
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                              HW
                                                                              +
                                                                              α
                                                                              
                                                                                 
                                                                                    WD
                                                                                 
                                                                                 
                                                                                    λ
                                                                                 
                                                                              
                                                                              ]
                                                                           
                                                                           
                                                                              rn
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        rn
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          


                                             On optimizing 
                                             λ: By fixing H and W, and removing the terms irrelevant to λ, the optimization problem (15) becomes
                                                
                                                   (21)
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           min
                                                                        
                                                                        
                                                                           λ
                                                                        
                                                                     
                                                                  
                                                                  
                                                                  Tr
                                                                  [
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        XX
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  -
                                                                  2
                                                                  
                                                                     
                                                                        XW
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        HWW
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        H
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  )
                                                                  ]
                                                                  =
                                                                  Tr
                                                                  [
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        YY
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  )
                                                                  ]
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            
                                                               
                                                                  s
                                                                  .
                                                                  t
                                                                  .
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           d
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           D
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        dd
                                                                     
                                                                  
                                                                  =
                                                                  1
                                                                  ,
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        dd
                                                                     
                                                                  
                                                                  ⩾
                                                                  0
                                                                  ,
                                                                  
                                                                  d
                                                                  =
                                                                  1
                                                                  ,
                                                                  …
                                                                  ,
                                                                  D
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             where 
                                                
                                                   Y
                                                   =
                                                   X
                                                   -
                                                   HW
                                                
                                             . Here, the value of 
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                
                                              indicates the weight of the dth feature. We rewrite the objective function of (21) as follows:
                                                
                                                   (22)
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           min
                                                                        
                                                                        
                                                                           λ
                                                                        
                                                                     
                                                                  
                                                                  
                                                                  Tr
                                                                  [
                                                                  diag
                                                                  
                                                                     
                                                                        (
                                                                        λ
                                                                        )
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        YY
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  )
                                                                  ]
                                                                  =
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           d
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           D
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           n
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           N
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        dn
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  =
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           d
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           D
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        e
                                                                     
                                                                     
                                                                        d
                                                                     
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            
                                                               
                                                                  s
                                                                  .
                                                                  t
                                                                  .
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           d
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           D
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        dd
                                                                     
                                                                  
                                                                  =
                                                                  1
                                                                  ,
                                                                  
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        dd
                                                                     
                                                                  
                                                                  ⩾
                                                                  0
                                                                  ,
                                                                  
                                                                  d
                                                                  =
                                                                  1
                                                                  ,
                                                                  …
                                                                  ,
                                                                  D
                                                                  .
                                                                  
                                                                     
                                                                        λ
                                                                     
                                                                     
                                                                        d
                                                                     
                                                                  
                                                                  ⩾
                                                                  0
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             where 
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         dn
                                                      
                                                   
                                                
                                              is the 
                                                
                                                   (
                                                   d
                                                   ,
                                                   n
                                                   )
                                                
                                             th element of matrix Y and 
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         dn
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             . It could be optimized by using Theorem 1.


                                          The closed form solution of the optimization problem in 
                                          
                                             (21)
                                           
                                          is given by:
                                          
                                             
                                                (23)
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         1
                                                         /
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               d
                                                               =
                                                               1
                                                            
                                                            
                                                               F
                                                            
                                                         
                                                         1
                                                         /
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                   d
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   D
                                                
                                             
                                          
                                       

Given the constrain of 
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      d
                                                      =
                                                      1
                                                   
                                                   
                                                      D
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      d
                                                   
                                                
                                                =
                                                1
                                             
                                           and the Candy-Schwartz inequality, we have
                                             
                                                (24)
                                                
                                                   1
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        d
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        D
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        d
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        D
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           y
                                                                        
                                                                        
                                                                           d
                                                                        
                                                                     
                                                                  
                                                               
                                                               ·
                                                               
                                                                  
                                                                     1
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 y
                                                                              
                                                                              
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     d
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     D
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  d
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     d
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     D
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        d
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       

Thus we have the following inequality,
                                             
                                                (25)
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            d
                                                            =
                                                            1
                                                         
                                                         
                                                            D
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         d
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        d
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        D
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              y
                                                                           
                                                                           
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          and the equal sign holds if 
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                =
                                                C
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          , or
                                             
                                                (26)
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   =
                                                   C
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                   d
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   D
                                                
                                             
                                          
                                       

Moreover, since 
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      d
                                                      =
                                                      1
                                                   
                                                   
                                                      D
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      d
                                                   
                                                
                                                =
                                                1
                                             
                                          , we have 
                                             
                                                C
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      d
                                                      =
                                                      1
                                                   
                                                   
                                                      D
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                =
                                                1
                                             
                                          , therefore 
                                             
                                                C
                                                =
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            d
                                                            =
                                                            1
                                                         
                                                         
                                                            D
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          , and the minimizer of (21) is (23).□


                                    Algorithm: The proposed iterative AGNMF algorithm with feature selection (named as AGNMF
                                       FS
                                    ) is summarized in Algorithm 1.

After learning 
                              
                                 (
                                 H
                                 ,
                                 W
                                 )
                              
                            and λ via AGNMF
                              FS
                            for the training data matrix X, we can use the basis matrix H and feature weight matrix λ to infer the coding vector for a new data point. When a new test data sample 
                              
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                    
                                       D
                                    
                                 
                              
                            comes in, we first connect it to its K nearest neighbors 
                              
                                 
                                    
                                       N
                                    
                                    
                                       λ
                                    
                                 
                              
                            from the training set 
                              
                                 X
                              
                            which are found by using the λ-weighted SED (12), and then calculate the weight vector of x as 
                              
                                 
                                    
                                       a
                                    
                                    
                                       λ
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                    
                                       λ
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       N
                                    
                                    
                                       λ
                                    
                                 
                                 ]
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       N
                                    
                                 
                              
                            where 
                              
                                 
                                    
                                       a
                                    
                                    
                                       n
                                    
                                    
                                       λ
                                    
                                 
                                 =
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                |
                                                |
                                                x
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      m
                                                   
                                                
                                                |
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      λ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           , if 
                              
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       λ
                                    
                                 
                              
                           ; and 0, otherwise. Assuming the coding of the training samples are not affected by the test sample, we only need to optimize the following objective function regarding to the coding vector 
                              
                                 w
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       R
                                    
                                 
                              
                            of the test sample:
                              
                                 (27)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                
                                                
                                                O
                                                
                                                   
                                                      (
                                                      w
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            AGNMF
                                                         
                                                         
                                                            FS
                                                         
                                                      
                                                   
                                                
                                                =
                                                |
                                                |
                                                diag
                                                (
                                                λ
                                                )
                                                (
                                                x
                                                -
                                                Hw
                                                )
                                                |
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                |
                                                |
                                                w
                                                -
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      λ
                                                   
                                                
                                                =
                                                Tr
                                                
                                                   
                                                      
                                                         diag
                                                         
                                                            
                                                               (
                                                               λ
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               xx
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                      
                                                   
                                                
                                                -
                                                2
                                                Tr
                                                
                                                   
                                                      
                                                         diag
                                                         
                                                            
                                                               (
                                                               λ
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               xw
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                Tr
                                                [
                                                diag
                                                
                                                   
                                                      (
                                                      λ
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      Hww
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                ]
                                                +
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      λ
                                                   
                                                
                                                Tr
                                                (
                                                
                                                   
                                                      ww
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                                -
                                                α
                                                Tr
                                                
                                                   
                                                      
                                                         w
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  n
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  N
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               n
                                                            
                                                            
                                                               λ
                                                            
                                                         
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               n
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      τ
                                                   
                                                
                                                Tr
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                                
                                                w
                                                ⩾
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

By setting the partial derivative of the Lagrange function of (27) with respect to w to zero, and using the KKT conditions, we can have the following updating rule for w:
                              
                                 (28)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          r
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      diag
                                                      
                                                         
                                                            (
                                                            λ
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      x
                                                      +
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            n
                                                         
                                                         
                                                            λ
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      diag
                                                      
                                                         
                                                            (
                                                            λ
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      Hw
                                                      +
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            n
                                                         
                                                         
                                                            λ
                                                         
                                                      
                                                      w
                                                   
                                                
                                             
                                             
                                                r
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          r
                                       
                                    
                                 
                              
                           
                        

By repeating this updating rule, we could have the optimal coding vector, w, for the test sample.

Consider a nonlinear mapping 
                              
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 →
                                 φ
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            or 
                              
                                 X
                                 →
                                 φ
                                 (
                                 X
                                 )
                                 =
                                 [
                                 φ
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 φ
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       N
                                    
                                 
                                 )
                                 ]
                              
                           , the kernel matrix 
                              
                                 K
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       N
                                       ×
                                       N
                                    
                                 
                              
                            is given by 
                              
                                 K
                                 =
                                 φ
                                 
                                    
                                       (
                                       X
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 φ
                                 (
                                 X
                                 )
                              
                           . A direct application of NMF to the feature matrix 
                              
                                 φ
                                 (
                                 X
                                 )
                              
                            yields
                              
                                 (29)
                                 
                                    φ
                                    (
                                    X
                                    )
                                    ≈
                                    HW
                                 
                              
                           
                        

For the sake of convenience, we impose the constraint that the vectors defining H lie within the column space of 
                              
                                 φ
                                 (
                                 X
                                 )
                              
                           : 
                              
                                 
                                    
                                       h
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       nr
                                    
                                 
                                 φ
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            or
                              
                                 (30)
                                 
                                    H
                                    =
                                    φ
                                    (
                                    X
                                    )
                                    F
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       f
                                    
                                    
                                       nr
                                    
                                 
                              
                            is the 
                              
                                 (
                                 n
                                 ,
                                 r
                                 )
                              
                           th element of the matrix 
                              
                                 F
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                    
                                       N
                                       ×
                                       K
                                    
                                 
                              
                           . Substituting (30) to (3), we have the objective function for the kernelized version of NMF
                              
                                 (31)
                                 
                                    
                                       
                                          O
                                       
                                       
                                          
                                             
                                                NMF
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    F
                                    ,
                                    W
                                    )
                                    =
                                    |
                                    |
                                    φ
                                    (
                                    X
                                    )
                                    -
                                    φ
                                    (
                                    X
                                    )
                                    FW
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    Tr
                                    [
                                    φ
                                    (
                                    X
                                    )
                                    (
                                    I
                                    -
                                    FW
                                    )
                                    
                                       
                                          (
                                          I
                                          -
                                          FW
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    φ
                                    
                                       
                                          (
                                          X
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    ]
                                    =
                                    Tr
                                    [
                                    φ
                                    
                                       
                                          (
                                          X
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    φ
                                    (
                                    X
                                    )
                                    (
                                    I
                                    -
                                    FW
                                    )
                                    
                                       
                                          (
                                          I
                                          -
                                          FW
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    ]
                                    =
                                    Tr
                                    [
                                    K
                                    (
                                    I
                                    -
                                    FW
                                    )
                                    
                                       
                                          (
                                          I
                                          -
                                          FW
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                    ]
                                 
                              
                           
                        

Suppose there are altogether L different kernel functions 
                              
                                 
                                    
                                       {
                                       
                                          
                                             K
                                          
                                          
                                             l
                                          
                                       
                                       }
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                              
                            available for the NMF task in hand. Accordingly, there are L different but associated nonlinear feature spaces. In general, we do not know which kernel space should be used. An intuitive way is to use them all by concatenating all feature spaces into an augmented Hilbert space and associating each feature space with a relevance weight 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       l
                                    
                                 
                              
                           , where 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       l
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       τ
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 1
                              
                           . We denote the kernel weights as a vector 
                              
                                 τ
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             L
                                          
                                       
                                       ]
                                    
                                    
                                       ⊤
                                    
                                 
                              
                           . Performing the NMF in such feature space is equivalent to employing a combined kernel function for the NMF:
                              
                                 (32)
                                 
                                    
                                       
                                          K
                                       
                                       
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             L
                                          
                                       
                                    
                                    
                                       
                                          τ
                                       
                                       
                                          l
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          l
                                       
                                    
                                    ,
                                    
                                    s
                                    .
                                    t
                                    .
                                    
                                       
                                          τ
                                       
                                       
                                          l
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             L
                                          
                                       
                                    
                                    
                                       
                                          τ
                                       
                                       
                                          l
                                       
                                    
                                    =
                                    1
                                 
                              
                           
                        

We substitute this relation into (31) to obtain the objective function for Multiple Kernel-based NMF (NMF
                              MK
                           ):
                              
                                 (33)
                                 
                                    
                                       
                                          O
                                       
                                       
                                          
                                             
                                                NMF
                                             
                                             
                                                MK
                                             
                                          
                                       
                                    
                                    (
                                    F
                                    ,
                                    W
                                    ,
                                    τ
                                    )
                                    =
                                    Tr
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                             
                                                
                                                   τ
                                                
                                                
                                                   l
                                                
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   l
                                                
                                             
                                             (
                                             I
                                             -
                                             FW
                                             )
                                             
                                                
                                                   (
                                                   I
                                                   -
                                                   FW
                                                   )
                                                
                                                
                                                   ⊤
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

To update the graph 
                              
                                 G
                              
                            regarding the multiple kernel space, given a τ, the K nearest neighbors 
                              
                                 
                                    
                                       N
                                    
                                    
                                       n
                                    
                                    
                                       τ
                                    
                                 
                              
                            for the GNMF algorithm will be re-found by the τ-weighted SED in the multiple kernel space, i.e.,
                              
                                 (34)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    )
                                    =
                                    |
                                    |
                                    φ
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    -
                                    φ
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    )
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          τ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    )
                                    -
                                    2
                                    
                                       
                                          K
                                       
                                       
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             L
                                          
                                       
                                    
                                    
                                       
                                          τ
                                       
                                       
                                          l
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   l
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   K
                                                
                                                
                                                   l
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                             -
                                             2
                                             
                                                
                                                   K
                                                
                                                
                                                   l
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             
                                                
                                                   x
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        

The corresponding K nearest neighbor graph adaptive to τ is donated as 
                              
                                 G
                              
                           . Here we discuss the updating of dot-product weighting for the weight matrix 
                              
                                 
                                    
                                       A
                                    
                                    
                                       τ
                                    
                                 
                              
                            of the adaptive graph with multiple kernel learning, i.e, 
                              
                                 
                                    
                                       A
                                    
                                    
                                       nm
                                    
                                    
                                       τ
                                    
                                 
                                 =
                                 φ
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 φ
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       τ
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       l
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                           , if 
                              
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       n
                                    
                                    
                                       τ
                                    
                                 
                              
                           ; 0, otherwise.

With the graph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       τ
                                    
                                 
                              
                            adaptive to the multiple kernel space, we then re-regularize the NMF
                              MK
                            in the multiple kernel space. We propose the Adaptive Graph regularization term as
                              
                                 (35)
                                 
                                    
                                       
                                          O
                                       
                                       
                                          AG
                                       
                                    
                                    (
                                    W
                                    ;
                                    
                                       
                                          A
                                       
                                       
                                          τ
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             ,
                                             m
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          w
                                       
                                       
                                          m
                                       
                                    
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          nm
                                       
                                       
                                          τ
                                       
                                    
                                    =
                                    Tr
                                    (
                                    
                                       
                                          WL
                                       
                                       
                                          τ
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          ⊤
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       L
                                    
                                    
                                       τ
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       τ
                                    
                                 
                                 -
                                 
                                    
                                       A
                                    
                                    
                                       τ
                                    
                                 
                              
                            is the corresponding graph Laplacian.

To perform the multi-kernel learning together with the adaptive graph regularized NMF, we first propose a unified object function, and then develop an alternately updating algorithm to solve it.
                              
                                 •
                                 
                                    Objective function: Combining the NMF objective function with multiple kernel defined in (33) with the adaptive graph-based regularizer defined in (35) leads to the optimization problem of our AGNMF with multi-kernel learning — AGNMF
                                       MK
                                    :
                                       
                                          (36)
                                          
                                             
                                                
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  min
                                                               
                                                               
                                                                  F
                                                                  ,
                                                                  W
                                                                  ,
                                                                  τ
                                                               
                                                            
                                                         
                                                         
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               
                                                                  
                                                                     AGNMF
                                                                  
                                                                  
                                                                     MK
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         F
                                                         ,
                                                         W
                                                         ,
                                                         τ
                                                         )
                                                         =
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               
                                                                  
                                                                     NMF
                                                                  
                                                                  
                                                                     MK
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         F
                                                         ,
                                                         W
                                                         ,
                                                         τ
                                                         )
                                                         +
                                                         α
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               AG
                                                            
                                                         
                                                         (
                                                         W
                                                         ;
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               τ
                                                            
                                                         
                                                         )
                                                         +
                                                         β
                                                         |
                                                         |
                                                         τ
                                                         |
                                                         
                                                            
                                                               |
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         =
                                                         Tr
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           l
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           L
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        K
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  (
                                                                  I
                                                                  -
                                                                  FW
                                                                  )
                                                                  
                                                                     
                                                                        (
                                                                        I
                                                                        -
                                                                        FW
                                                                        )
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         α
                                                         Tr
                                                         (
                                                         
                                                            
                                                               WL
                                                            
                                                            
                                                               τ
                                                            
                                                         
                                                         
                                                            
                                                               W
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         )
                                                         +
                                                         β
                                                         |
                                                         |
                                                         τ
                                                         |
                                                         
                                                            
                                                               |
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         =
                                                         Tr
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        K
                                                                     
                                                                     
                                                                        τ
                                                                     
                                                                  
                                                                  (
                                                                  I
                                                                  -
                                                                  FW
                                                                  )
                                                                  
                                                                     
                                                                        (
                                                                        I
                                                                        -
                                                                        FW
                                                                        )
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         α
                                                         Tr
                                                         (
                                                         
                                                            
                                                               WL
                                                            
                                                            
                                                               τ
                                                            
                                                         
                                                         
                                                            
                                                               W
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                         )
                                                         +
                                                         β
                                                         |
                                                         |
                                                         τ
                                                         |
                                                         
                                                            
                                                               |
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         s
                                                         .
                                                         t
                                                         .
                                                         
                                                         F
                                                         ⩾
                                                         0
                                                         ,
                                                         
                                                         W
                                                         ⩾
                                                         0
                                                         ,
                                                         
                                                         τ
                                                         ⩾
                                                         0
                                                         ,
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  l
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  L
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               τ
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                         =
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    where the regularization term 
                                       
                                          |
                                          |
                                          τ
                                          |
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                     is also introduced to prevent the parameter τ from overfitting to one kernel.


                                    Optimization: Similar to AGNMF
                                       FS
                                    , we also adopt an iterative strategy to alternately optimize 
                                       
                                          (
                                          F
                                          ,
                                          W
                                          )
                                       
                                     and τ.
                                       
                                          –
                                          
                                             On optimizing 
                                             
                                                
                                                   (
                                                   F
                                                   ,
                                                   W
                                                   )
                                                
                                             : By fixing τ and updating the adaptive graph 
                                                
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                
                                              and kernel matrix 
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         τ
                                                      
                                                   
                                                
                                             , the optimization problem (36) is reduced to
                                                
                                                   (37)
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           min
                                                                        
                                                                        
                                                                           F
                                                                           ,
                                                                           W
                                                                        
                                                                     
                                                                  
                                                                  
                                                                  Tr
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 K
                                                                              
                                                                              
                                                                                 τ
                                                                              
                                                                           
                                                                           (
                                                                           I
                                                                           -
                                                                           FW
                                                                           )
                                                                           
                                                                              
                                                                                 (
                                                                                 I
                                                                                 -
                                                                                 FW
                                                                                 )
                                                                              
                                                                              
                                                                                 ⊤
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  +
                                                                  α
                                                                  Tr
                                                                  (
                                                                  
                                                                     
                                                                        WL
                                                                     
                                                                     
                                                                        τ
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        W
                                                                     
                                                                     
                                                                        ⊤
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            
                                                               
                                                                  s
                                                                  .
                                                                  t
                                                                  .
                                                                  
                                                                  F
                                                                  ⩾
                                                                  0
                                                                  ,
                                                                  
                                                                  W
                                                                  ⩾
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          

Similar to the optimization of H and W of AGNMF
                                                FS
                                             , we have following rules to update F and W:
                                                
                                                   (38)
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        f
                                                                     
                                                                     
                                                                        nr
                                                                     
                                                                  
                                                                  ←
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              (
                                                                              
                                                                                 
                                                                                    K
                                                                                 
                                                                                 
                                                                                    τ
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    W
                                                                                 
                                                                                 
                                                                                    ⊤
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                           
                                                                              nr
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              (
                                                                              
                                                                                 
                                                                                    K
                                                                                 
                                                                                 
                                                                                    τ
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    FWW
                                                                                 
                                                                                 
                                                                                    ⊤
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                           
                                                                              nr
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        f
                                                                     
                                                                     
                                                                        nr
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        rn
                                                                     
                                                                  
                                                                  ←
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              (
                                                                              
                                                                                 
                                                                                    F
                                                                                 
                                                                                 
                                                                                    ⊤
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    K
                                                                                 
                                                                                 
                                                                                    τ
                                                                                 
                                                                              
                                                                              +
                                                                              α
                                                                              
                                                                                 
                                                                                    WA
                                                                                 
                                                                                 
                                                                                    τ
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                           
                                                                              rn
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              (
                                                                              
                                                                                 
                                                                                    F
                                                                                 
                                                                                 
                                                                                    ⊤
                                                                                 
                                                                              
                                                                              
                                                                                 
                                                                                    K
                                                                                 
                                                                                 
                                                                                    τ
                                                                                 
                                                                              
                                                                              FW
                                                                              +
                                                                              α
                                                                              
                                                                                 
                                                                                    WD
                                                                                 
                                                                                 
                                                                                    τ
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                           
                                                                              rn
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        rn
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          


                                             On optimizing 
                                             τ: By fixing F and W, and removing the irrelevant terms, the optimization problem (36) becomes
                                                
                                                   (39)
                                                   
                                                      
                                                         
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           min
                                                                        
                                                                        
                                                                           τ
                                                                        
                                                                     
                                                                  
                                                                  
                                                                  Tr
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    ∑
                                                                                 
                                                                                 
                                                                                    l
                                                                                    =
                                                                                    1
                                                                                 
                                                                                 
                                                                                    L
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 τ
                                                                              
                                                                              
                                                                                 l
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 K
                                                                              
                                                                              
                                                                                 l
                                                                              
                                                                           
                                                                           (
                                                                           I
                                                                           -
                                                                           FW
                                                                           )
                                                                           
                                                                              
                                                                                 (
                                                                                 I
                                                                                 -
                                                                                 FW
                                                                                 )
                                                                              
                                                                              
                                                                                 ⊤
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  +
                                                                  β
                                                                  |
                                                                  |
                                                                  τ
                                                                  |
                                                                  
                                                                     
                                                                        |
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  =
                                                                  Tr
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    ∑
                                                                                 
                                                                                 
                                                                                    l
                                                                                    =
                                                                                    1
                                                                                 
                                                                                 
                                                                                    L
                                                                                 
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 τ
                                                                              
                                                                              
                                                                                 l
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 K
                                                                              
                                                                              
                                                                                 l
                                                                              
                                                                           
                                                                           
                                                                              
                                                                                 ZZ
                                                                              
                                                                              
                                                                                 ⊤
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  +
                                                                  β
                                                                  |
                                                                  |
                                                                  τ
                                                                  |
                                                                  
                                                                     
                                                                        |
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  =
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           l
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           L
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        g
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  +
                                                                  β
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           l
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           L
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            
                                                               
                                                                  s
                                                                  .
                                                                  t
                                                                  .
                                                                  
                                                                  τ
                                                                  ⩾
                                                                  0
                                                                  ,
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           l
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           L
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        l
                                                                     
                                                                  
                                                                  =
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             where 
                                                
                                                   Z
                                                   =
                                                   I
                                                   -
                                                   FW
                                                
                                              and 
                                                
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   =
                                                   Tr
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                            
                                                               
                                                                  ZZ
                                                               
                                                               
                                                                  ⊤
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             . The optimization of (39) with respect to the feature weights τ could be solved as a standard quadratic programming (QP) problem.


                                    Algorithm: The iterative AGNMF algorithm with multiple kernel learning (named as AGNMF
                                       MK
                                    ) is summarized in Algorithm 2.

When a test sample 
                              
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       D
                                    
                                 
                              
                            comes in, we first connect it to its K nearest neighbors 
                              
                                 
                                    
                                       N
                                    
                                    
                                       τ
                                    
                                 
                              
                            from the training set 
                              
                                 X
                              
                           , which is found by using the τ-weighted SED (34). Then the weight vector 
                              
                                 
                                    
                                       a
                                    
                                    
                                       τ
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                    
                                       τ
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       N
                                    
                                    
                                       τ
                                    
                                 
                                 ]
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       N
                                    
                                 
                              
                            is calculated as 
                              
                                 
                                    
                                       a
                                    
                                    
                                       n
                                    
                                    
                                       τ
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 x
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                           , if 
                              
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       τ
                                    
                                 
                              
                           ; 0, otherwise. We need to optimize the following objective function to solve w with AGNMF
                              MK
                           :
                              
                                 (40)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         w
                                                      
                                                   
                                                
                                                O
                                                
                                                   
                                                      (
                                                      w
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            AGNMF
                                                         
                                                         
                                                            MK
                                                         
                                                      
                                                   
                                                
                                                =
                                                |
                                                |
                                                ϕ
                                                (
                                                x
                                                )
                                                -
                                                ϕ
                                                (
                                                X
                                                )
                                                Fw
                                                |
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                |
                                                |
                                                w
                                                -
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      τ
                                                   
                                                
                                                =
                                                Tr
                                                [
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      τ
                                                   
                                                
                                                (
                                                x
                                                ,
                                                x
                                                )
                                                ]
                                                -
                                                2
                                                Tr
                                                [
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      τ
                                                   
                                                
                                                (
                                                X
                                                ,
                                                x
                                                )
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                ]
                                                +
                                                Tr
                                                [
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      τ
                                                   
                                                
                                                (
                                                X
                                                ,
                                                X
                                                )
                                                
                                                   
                                                      Fww
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                ]
                                                +
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      τ
                                                   
                                                
                                                Tr
                                                (
                                                
                                                   
                                                      ww
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                                -
                                                α
                                                Tr
                                                
                                                   
                                                      
                                                         w
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  n
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  N
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               n
                                                            
                                                            
                                                               τ
                                                            
                                                         
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               n
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      τ
                                                   
                                                
                                                Tr
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                                
                                                w
                                                ⩾
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       K
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 X
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             K
                                          
                                          
                                             τ
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       y
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             K
                                          
                                          
                                             τ
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             N
                                          
                                       
                                       ,
                                       y
                                       )
                                       ]
                                    
                                    
                                       ⊤
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       K
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 X
                                 ,
                                 X
                                 )
                                 =
                                 [
                                 
                                    
                                       K
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 ]
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       N
                                       ×
                                       N
                                    
                                 
                              
                           . By setting the partial derivative of the Lagrange function of (40) regarding w to zero and using the KKT conditions, we have the following updating rule for w
                           
                              
                                 (41)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          r
                                       
                                    
                                    ←
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            τ
                                                         
                                                      
                                                      (
                                                      X
                                                      ,
                                                      x
                                                      )
                                                      +
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            n
                                                         
                                                         
                                                            τ
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                r
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            ⊤
                                                         
                                                      
                                                      
                                                         
                                                            K
                                                         
                                                         
                                                            τ
                                                         
                                                      
                                                      (
                                                      X
                                                      ,
                                                      X
                                                      )
                                                      Fw
                                                      +
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            n
                                                         
                                                         
                                                            τ
                                                         
                                                      
                                                      w
                                                   
                                                
                                             
                                             
                                                r
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          r
                                       
                                    
                                 
                              
                           
                        

@&#EXPERIMENTS@&#

In this section, we apply the two proposed enhanced AGNMF algorithms to two challenging classification tasks – colon cancer diagnosis and face recognition.

In the first experiment, we test the proposed algorithms as data representation methods for the colon cancer diagnosis task based on the gene expression data.

Classification of colon cancer types according to the gene expression of patients’ tissue samples is an important technique for colon cancer diagnosis (Zheng et al., 2011). Given the gene expression levels for genes of a sample, the aim is to identify if it is a tumor or a normal colon tissue. The gene expression data is usually nonnegative, thus NMF could be used to represent the gene expression data for classification tasks. In this experiment we will evaluate the use of the proposed algorithms as a data representation method for the colon cancer classification problem. A publicly available microarray dataset of colon tissue samples is used in this experiment (Zheng et al., 2011). The colon cancer data set contains the gene expression data of 
                              
                                 D
                                 =
                                 2000
                              
                            genes in 
                              
                                 N
                                 =
                                 62
                              
                            colon tissue samples, 22 of which are normal samples and 40 of which are tumor colon tissue samples. The colon tissue samples are defined as positive samples while the normal samples as negative ones. The gene expression data of 2000 genes of a sample are used as the original nonnegative features. The proposed AGNMF
                              FS
                            or AGNMF
                              MK
                            algorithms were applied to represent data samples in a low dimensional coding vector.

To evaluate the proposed algorithms, we performed a 5-fold cross validation on the dataset. The entire dataset was split into five folds randomly, and in each fold, there were 8 positive samples and 4–5 negative samples. Each fold was used as an independent test set in turn, while the remaining four folds were used as the training set. We first applied AGNMF
                              FS
                            and AGNMF
                              MK
                            respectively to the training set to represent all the training samples as coding vectors, and then trained a support vector machine (SVM) (Emami & Omar, 2013) to distinguish the normal and tumor colon tissue samples. When a test sample was given, we first represented it by a coding vector, based on the basis and coding matrices, and feature selection or multi-kernel learning parameters learned using the training set, and then classified the coding vector by the trained SVM classifier. Note that all the parameters were tuned on the training set only, and the test set was not included in the parameter optimization procedure.

The classification performance is measured by the receiver operating characteristic (ROC) curves and recall-precision curves (Zhang, Xu, & Chen, 2008). The ROC curves were obtained by plotting the true positive rates (TPR) vs. the false positive rates (FPR) at various threshold settings, while recall-precision curves were obtained by plotting the recalls vs. the precisions at various threshold settings. The TPR, FPR, recall and precision are defined as follows:
                              
                                 (42)
                                 
                                    
                                       
                                          
                                          
                                             
                                                TPR
                                                =
                                                
                                                   
                                                      TP
                                                   
                                                   
                                                      TP
                                                      +
                                                      FN
                                                   
                                                
                                                ,
                                                
                                                FPR
                                                =
                                                
                                                   
                                                      FP
                                                   
                                                   
                                                      FP
                                                      +
                                                      TN
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                recall
                                                =
                                                
                                                   
                                                      TP
                                                   
                                                   
                                                      TP
                                                      +
                                                      FN
                                                   
                                                
                                                ,
                                                
                                                precision
                                                =
                                                
                                                   
                                                      TP
                                                   
                                                   
                                                      TP
                                                      +
                                                      FP
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where TP is the number of true positives, FP is the number of false positives, TN is the number of true negatives, while FN is the number of false negatives. Moreover, the area under the ROC curve (AUC) is also used as a measure of the classification performance.

@&#EXPERIMENTAL RESULTS@&#

Since our algorithms combine feature selection, multi-kernel learning, graph regularization and NMF, we compared our algorithms with the following relevant methods: the original NMF (Lee & Seung, 2000), the graph-regularized NMF (GNMF) (Cai et al., 2011), the kernel NMF (NMF
                              K
                           ) (Lee, Cichocki, & Choi, 2009), the NMF with multi-kernels (NMF
                              MK
                           ) (An et al., 2011) and the NMF with feature selection (NMF
                              FS
                           ) (Das Gupta & Xiao, 2011). In total seven different methods were compared on this data set. The ROC and recall-precision curves of these methods are shown in Fig. 1
                           , and the AUCs are given in Table 1
                           . It can be seen that the proposed methods using feature selection or multi-kernel learning to learn an adaptive graph for regularization of NMF model consistently perform better than the GNMF method using the original data space for the graph estimation. In particular, this difference is significant when a small number of data samples with large feature dimension are available to train the NMF. Moreover, NMF
                              FS
                            outperforms NMF
                              MK
                           , which implies that feature selection works better than multiple kernel learning for high dimensional data with many noisy and irrelevant features, such as the gene expression data. We also observed that both of the proposed feature selection version (AGNMF
                              FS
                           ) and multi-kernel version (AGNMF
                              MK
                           ) of graph-adaptive NMF methods are superior to their competing algorithms that only consider feature selection (NMF
                              FS
                           ) or multi-kernel learning (NMF
                              MK
                           ) without conducting graph regularization. This is consistent with the manifold assumption of the data and also shows the necessity to apply graph regularization. It is also interesting to notice that the difference between NMF
                              MK
                            and NMF
                              K
                            is marginal. A possible reason is that NMF
                              MK
                            does not use the 
                              
                                 
                                    
                                       l
                                    
                                    
                                       2
                                    
                                 
                              
                            norm to regularize the kernel weights whereas NMF
                              MK
                            does, thus the kernel weights overfit to one kernel in NMF
                              MK
                           .

In the second experiment, we test our algorithms on the face recognition task.

We used the face image dataset from Georgia Institute of Technology (GTFD) (Nefian & Hayes, 2000) in this experiment. This database contains face images of 50 individuals. Fifteen color pictures are taken for each individual in two or three sessions. Thus there are in total 750 images in the database. For each individual, the pictures of different positions, facial expressions, lighting conditions and scales are taken. The face area in each image is manually cropped. We extracted the color-based local binary pattern (LBP) (Nanni, Lumini, & Brahnam, 2012) and the Gabor wavelet coefficients (Park & Kim, 2013) as features of each face image, and concatenated them to construct the original nonnegative feature vector.

To conduct the evaluation, we randomly split the entire database into non-overlapping training and test subsets. For each individual, 10 images out of the 15 were randomly selected as the training samples, and the remaining five images were used as the test samples. Thus there were in total 500 samples in the training subset while 250 samples in the test set. To represent the samples, we first performed the NMF algorithms to the training set to obtain the basis matrix and the coding vectors of training samples, and then the test samples were coded into coding vectors using the NMF parameters learned by the training set. To classify the test samples, we first trained a hidden Markov model (HMM) (Elliott, Siu, & Fung, 2014) for each individual using the training samples, and then the test samples were fit to each of the HMM model, and classified into the one with the highest log-likelihood score. The above split process (training/test) was repeated 10 times, and the recognition accuracies over the splits were reported as the final performance.

@&#EXPERIMENTAL RESULTS@&#


                           Fig. 2
                            shows the boxplots of the classification accuracies of different methods over the 10 splits. It can be seen that the proposed AGNMF
                              MK
                            and AGNMF
                              FS
                            again consistently outperform other methods. AGNMF
                              MK
                            performs similarly as AGNMF
                              FS
                            on this dataset. This makes sense because for the computer vision problems, such as face recognition, multi-kernel-based methods have been shown to perform well (Yeh et al., 2013). In this data representation task, modeling the data as graphs gives much better representation than modeling them in the original Hilbert space that is constructed by a single kernel or multiple kernels. Thus, it is not surprising to see that the proposed AGNMF
                              MK
                            significantly and consistently outperforms NMF
                              MK
                            and NMF
                              K
                           , although all of them minimize the data reconstruction error. Similar reasons can be used to explain the improvement of AGNMF
                              FS
                            over NMF
                              FS
                           . By comparing the performance between AGNMF
                              FS
                            and GNMF, and between NMF
                              FS
                            and NMF, we can conclude that feature selection plays important roles in the classification accuracy.

In this paper, we proposed two novel data representation methods that aimed to solve the issue of NMF caused by noisy and irrelevant features, and non-linear distributions of data samples. The first method conducts feature selection, graph regularization, and NMF simultaneously, whereas the second method optimizes multi-kernel learning, graph regularization, and NMF in a unified objective function. We developed two iterative optimization algorithms to optimize the two objective functions, respectively. Experimental results demonstrate that our methods significantly outperform state-of-the-art data representation methods on the colon cancer classification and face recognition tasks. The strength of the proposed algorithms lies on the fact that it does not need class label information for feature selection and multi-kernel learning. The weakness is the high computational complexity of the proposed multi-kernel learning method due to the QP problem in each iteration.

Manifold regularization based on graphs has been a popular method in NMF-related studies. However, the construction of the graph is often effected by the noisy features and the nonlinear distribution of the data. The theoretical contributions of this paper are to propose two solutions for these problems. One contribution of them is to use the feature selection to refine the data to construct a reliable graph to regularize the NMF, and also to incorporate the problem of feature selection to the problem of NMF. Another one is to incorporate the problem of multi-kernel learning to NMF and also to use it to refine the graph construction. We show that both feature selection and multi-kernel learning can be used to construct a more reliable graph for NMF, and the learning of feature and kernel weights can be learned simultaneously with NMF.

Moreover, we also provide some insightful and practical implications to feature selection and multi-kernel learning. Although the feature selection and multi-kernel learning are used to construct the graph for NMF, feature selection and multi-kernel learning problems are also solved by minimizing the objective of graph regularized NMF. This gives an insight about feature selection and multi-kernel learning: NMF and graph regularization can also be used as criteria for feature selection and multi-kernel learning even when the supervision information is missing. The problems of feature selection and multi-kernel learning, NMF and graph regularization can be unified as a single learning problem.

In the future, to extend the work proposed in this paper, we propose the following future research directions. The first direction is to parallelize the proposed algorithms in a distributed system to apply it to a big data platform (Kwon & Sim, 2013; Lee, Lee, & Sohn, 2013b; Li et al., 2011b; Wang, Jiang, & Agrawal, 2012c; Wang, Nandi, & Agrawal, 2014c; Wang, Su, & Agrawal, 2013d). The second direction is to improve the proposed algorithm to handle different data sets of different distributions for domain transfer learning problems (Al-Shedivat, Wang, Alzahrani, Huang, & Gao, 2014; Lee et al., 2013b; Meng, Lin, & Li, 2011). The third direction is to apply it to more applications, such as image watermarking (Ouhsain & Hamza, 2009), fault diagnosis(Li et al., 2011a), sensing (Sun, Hu, & Qi, 2010a, 2014; Li, Wu, & Li, 2014), malicious websites detection (Xu, Zhan, Xu, & Ye, 2014, 2013), data analysis (Luo & Brodsky, 2011; Luo, Brodsky, & Li, 2012), and protein sequence motif discovery (Kim, Chen, Kim, Pan, & Park, 2011b).

@&#ACKNOWLEDGMENTS@&#

The study is in part supported by US National Science Foundation (Grant No. DBI-1322212) and a grant from King Abdullah University of Science and Technology (KAUST), Saudi Arabia. We would like to thank Dr. Qingquan Sun for sharing the code of the feature selection algorithm with us.

@&#REFERENCES@&#

