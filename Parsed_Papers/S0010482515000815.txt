@&#MAIN-TITLE@&#Median prior constrained TV algorithm for sparse view low-dose CT reconstruction

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A Median prior constrained TV algorithm is proposed for sparse view low-dose CT reconstruction.


                        
                        
                           
                           The median gradient proves to be sparse as well gradient image.


                        
                        
                           
                           The proposed algorithm can not only ensure a higher SNR but also a higher resolution.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Low-dose CT

Total variation

Sparse-view

Median prior

Reconstruction

@&#ABSTRACT@&#


               
               
                  It is known that lowering the X-ray tube current (mAs) or tube voltage (kVp) and simultaneously reducing the total number of X-ray views (sparse view) is an effective means to achieve low-dose in computed tomography (CT) scan. However, the associated image quality by the conventional filtered back-projection (FBP) usually degrades due to the excessive quantum noise. Although sparse-view CT reconstruction algorithm via total variation (TV), in the scanning protocol of reducing X-ray tube current, has been demonstrated to be able to result in significant radiation dose reduction while maintain image quality, noticeable patchy artifacts still exist in reconstructed images. In this study, to address the problem of patchy artifacts, we proposed a median prior constrained TV regularization to retain the image quality by introducing an auxiliary vector 
                        m
                      in register with the object. Specifically, the approximate action of 
                        m
                      is to draw, in each iteration, an object voxel toward its own local median, aiming to improve low-dose image quality with sparse-view projection measurements. Subsequently, an alternating optimization algorithm is adopted to optimize the associative objective function. We refer to the median prior constrained TV regularization as “TV_MP” for simplicity. Experimental results on digital phantoms and clinical phantom demonstrated that the proposed TV_MP with appropriate control parameters can not only ensure a higher signal to noise ratio (SNR) of the reconstructed image, but also its resolution compared with the original TV method.
               
            

@&#INTRODUCTION@&#

Low-dose computed tomography imaging has been particularly used in modern medical practice for its advantage on reducing the radiation dose to patients. Lowering the X-ray tube current (mAs) or tube voltage (kVp) and simultaneously reducing the total number of X-ray views per rotation around the body is an effective means to achieve radiation dose reduction [1,2].

However, given the noisy and sparse-view projection measurements, the associated image quality would degrade by the conventional analytical reconstruction methods. Therefore, to achieve high-quality CT images from low-dose sparse-view acquisitions is a hot research topic in CT field.

Up to now, various techniques have been extensively investigated to improve the reconstruction of low-dose scanned data [3–21]. Among them, statistical iterative reconstruction (SIR) algorithms, which take into account of statistical properties of the data, have showed their superior performances in maintaining image quality in various CT applications compared with FBP reconstruction algorithm. Generally, the cost function of the SIR consists of two terms, the “data-fidelity term” and the “penalty term” or “regularization term”. The data-fidelity term models the statistical measurements, and the regularization term reflecting a priori information penalizes the solution. Many prior options have been proposed in the past decades, including smoothing and edge-preserving regularization terms. And numerous iterative algorithms with varying degrees of success have been studied to obtain high-quality CT reconstruction images from low-dose sparse-view projections. A typical example is the total variation (TV) minimization. Accurate reconstructions can be accomplished by TV minimization algorithm, in which the sparse gradient magnitude image (GMI) after discrete gradient transform (DGT) is regarded to be a constraint.

In order to reconstruct CT images from under-sampling datasets, Sidky et al. improved the traditional TV minimization algorithm by considering the conditions of piecewise constant and sparse source distribution, and then proposed the TV minimization based projection on convex sets (TV-POCS) algorithm [11]. Chen proposed a radiation dose reduction algorithm called prior image constrained compressed sensing (PICCS) [15–17], which was first proposed to realize sparse-view CT reconstruction for under-sampling projections where X-ray exposure levels were considerably reduced. Then a series of PICCS applications were proposed, such as DR-PICCS [18], NC-PICCS [19], PICCS-4DCBCT [20], TRI-PICCS [21] and so on. Such TV-based algorithms answered the question that whether there is a mathematical foundation to enable accurate image reconstruction from highly under-sampled datasets.

In this work, we developed and investigated an iterative median prior constrained TV regularization for the application in low-dose sparse-view CT. First, we introduced an auxiliary vector 
                        m
                      in register with the objective function of TV, so that the target pixel was close to its local median in each iteration process. Next, we used the SIR process to enforce the statistical knowledge, then a series of simulation experiments, in order to verify the effectiveness of this new algorithm, were designed and the obtained results were also analyzed in detail. Experimental results demonstrated that the proposed algorithm can ensure the reconstructed image with higher SNR from low-dose sparse-view projection measurements, while ensuring the resolution of the reconstructed image.

The remainder of this paper is organized as follows. In Section 2, we first briefly review the relationship between the 
                        
                           
                              ℓ
                           
                           
                              1
                           
                        
                     -norm minimization and the TV model in medical and other tomographic imaging applications, and then we describe the proposed algorithm and its implementation. In Section 3, we analyze the simulation experiment results. Finally, in Section 4 we conclude the paper.

@&#MATERIAL AND METHODS@&#

The CT projection data can be obtained by a discrete linear transformation:
                           
                              (1)
                              
                                 y
                                 =
                                 Gf
                              
                           
                        
                     

The image function is represented in its discrete form as a vector 
                           f
                         of length N with individual elements 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                        . The projection-data vector 
                           y
                         is a vector of length M with individual elements
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           M
                        , 
                           G
                        
                        
                           (
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             g
                                          
                                          
                                             i
                                             j
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    M
                                    ×
                                    N
                                 
                              
                           
                           )
                         is an M×N dimensional system matrix.

A high quality reconstructed image depends on a high accuracy system matrix 
                           G
                         to some extent [22]. There are many methods to determine the system matrix 
                           G
                        , such as the view of view method proposed by Vardi first [23], Monte Carlo (MC) method proposed by Veklerov [24]. Since the system matrix is not our research focus in this paper, we choose the linear distance method to determine the system matrix [25].


                        
                        Fig. 1 is the calculation diagram of system probability matrix 
                           G
                         whose element g
                        
                           ij
                         is the probability of that the jth pixel can be detected by the ith detector. g
                        
                           ij
                         is calculated by the following formula:
                           
                              (2)
                              
                                 
                                    
                                       g
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                      
                                                      
                                                         Δ
                                                         s
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   <
                                                   Δ
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   >
                                                   Δ
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                              
                           
                        where d
                        
                           ij
                         is the distance from pixel j to ray i, Δ
                           s
                         is the distance between two adjacent rays.

It has been demonstrated that performing 
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                        -norm minimization after sparse transform is a solution to get an accurate reconstruction. In CT imaging applications, tomographic images are generally extended distributions, which violates the prerequisite of employing the 
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                        -based algorithms. However, a similar sparsity can describe tomographic images. Generally, image pixel values of the reconstructed image are relatively stable, such as the organ internal parts. Rapid changes of the reconstructed image pixel values may only occur at the boundary of the internal structure. Hence, the reconstruction image itself may not be sparse, but its gradient image is approximately sparse.

The widely used Shepp–Logan phantom, as shown in 
                        Fig. 2(a), is used to demonstrate the viewpoint described above. Given a 2-D image 
                           
                              
                                 f
                              
                              
                                 x
                                 ,
                                 y
                              
                           
                        , its corresponding gradient magnitude value is calculated according to formula (3).
                           
                              (3)
                              
                                 
                                    |
                                    
                                       ∇
                                       
                                          
                                             f
                                          
                                          
                                             x
                                             ,
                                             y
                                          
                                       
                                    
                                    |
                                 
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      x
                                                      −
                                                      1
                                                      ,
                                                      y
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      x
                                                      ,
                                                      y
                                                      −
                                                      1
                                                   
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        
                     

The transform process from Fig. 2(a) to (b) is called discrete gradient transform (DGT). The number of non-zero pixels in this 256
                           ×
                        256 image is 32,412, while the number of non-zero pixels in the gradient image, as shown in Fig. 2(b), is only 2184. Obviously, the obtained gradient image after DGT is sparser.

The 
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                        -norm of the gradient image is minimized to develop an iterative algorithm that takes advantage of this sparseness. TV norm is essentially 
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                        -norm of derivatives.
                           
                              (4)
                              
                                 
                                    
                                       
                                          TV
                                          
                                             (
                                             f
                                             )
                                          
                                          =
                                          
                                             
                                                ∬
                                                
                                                   ‖
                                                   
                                                      ∇
                                                      f
                                                      
                                                         (
                                                         
                                                            x
                                                            ,
                                                            y
                                                         
                                                         )
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                1
                                             
                                          
                                          d
                                          x
                                          d
                                          y
                                          =
                                          ∬
                                          
                                             
                                                |
                                                
                                                   
                                                      
                                                         ∂
                                                         f
                                                      
                                                      
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                                |
                                             
                                             +
                                             
                                                |
                                                
                                                   
                                                      
                                                         ∂
                                                         f
                                                      
                                                      
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                                |
                                             
                                             d
                                             x
                                             d
                                             y
                                          
                                       
                                    
                                    
                                       
                                          =
                                          ∬
                                          
                                             |
                                             
                                                ∇
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                
                                             
                                             |
                                          
                                          d
                                          x
                                          d
                                          y
                                       
                                    
                                 
                              
                           
                        
                     

The general theoretical setting for the TV algorithm discussed here involves inversion of a linear transform 
                           y
                        =
                           Gf
                        , we seek to obtain an image 
                           f
                         from knowledge of the data vector 
                           y
                         and the system 
                           G
                        . The data vector 
                           y
                         is insufficient and not able to uniquely determine the image 
                           f
                         by directly inverting Eq. (1).

The TV minimization algorithm is implemented to solve this linear system represented in Eq. (1) by following an optimization program.
                           
                              (5)
                              
                                 
                                    
                                       f
                                    
                                    
                                       opt
                                    
                                 
                                 =
                                 arg
                                 
                                 min
                                 
                                 TV
                                 
                                    (
                                    f
                                    )
                                 
                                 
                                 s
                                 .t
                                 .
                                 
                                 Gf
                                 =
                                 y
                              
                           
                        
                     

In reality, due to the influence of noise, formula (5) is usually expressed as:
                           
                              (6)
                              
                                 
                                    
                                       f
                                    
                                    
                                       opt
                                    
                                 
                                 =
                                 arg
                                 
                                 min
                                 
                                 TV
                                 
                                    (
                                    f
                                    )
                                 
                                 
                                 s
                                 .t
                                 .
                                 
                                 ∥
                                 Gf
                                 −
                                 y
                                 
                                    
                                       ∥
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 ε
                              
                           
                        where ε represents the noise intensity. Taking into account the restrictive condition, the constrained problem above can be translated into an unconstrained problem by using the Lagrange multiplier [26]:
                           
                              (7)
                              
                                 
                                    
                                       f
                                    
                                    
                                       opt
                                    
                                 
                                 =
                                 arg
                                 
                                 min
                                 
                                 
                                    
                                       ‖
                                       
                                          Gf
                                          −
                                          y
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 β
                                 TV
                                 
                                    (
                                    f
                                    )
                                 
                              
                           
                        where β is the Lagrange multiplier and recognized as the regularization parameter. Thus, TV minimization is transformed into a TV-regularization iterative reconstruction.

The reason why we can obtain an accurate image from the insufficient data 
                           y
                         by this method is based on a foundation that the image prior after DGT is sparse. TV minimization constraint in an iterative reconstruction makes it possible to solve the problem of high pathological reconstruction and obtain stable and accurate reconstruction images.

Although TV algorithm for low-dose sparse-view CT can achieve good results, there are still some challenges due to the fact that we cannot clearly distinguish noise and signal in a specific position, and only the DGT sum of reconstructed images is constrained through the data fidelity term in TV algorithm. The two points described above state that TV belongs to a kind of smoothness constraint in a certain extent. Therefore, TV algorithm often fails to express small structures and reconstructed images don’t have clear edges. To solve these problems, in this paper, we researched on the recovery of noisy projection under the sparse-view case, and then on the basis of studying some kinds of constrained TV-based minimization algorithms, we introduced a median prior and proposed the TV_MP algorithm to obtain more accurate images from low-dose sparse-view CT projections.

Hsiao et al. proposed a MP (median prior) algorithm based on median prior which has excellent ability to maintain the edge values [27]. The median prior was obtained by constructing an auxiliary vector.
                           
                              (8)
                              
                                 R
                                 
                                    (
                                    
                                       f
                                       ,
                                       m
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                       j
                                    
                                    
                                       
                                          ∑
                                          
                                             
                                                j
                                                ′
                                             
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                j
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                                 ϕ
                                 
                                    (
                                    
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             m
                                          
                                          
                                             j
                                             ′
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        where 
                           m
                         is an auxiliary vector which has the same dimension with 
                           f
                        , ϕ is a convex potential energy function. The neighborhood weight 
                           
                              
                                 ω
                              
                              
                                 j
                                 
                                    j
                                    ′
                                 
                              
                           
                         links 
                           m
                         and 
                           f
                        , and the interaction between f
                        
                           j
                         and 
                           
                              
                                 m
                              
                              
                                 j
                                 ′
                              
                           
                         is indicated in 
                        Fig. 3. In this paper, the convex function 
                           ϕ
                           
                              (
                              z
                              )
                           
                           =
                           
                              |
                              z
                              |
                           
                        , then
                           
                              (9)
                              
                                 R
                                 
                                    (
                                    
                                       f
                                       ,
                                       m
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                       j
                                    
                                    
                                       
                                          ∑
                                          
                                             
                                                j
                                                ′
                                             
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          |
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   j
                                                
                                             
                                             −
                                             
                                                
                                                   m
                                                
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                          |
                                       
                                    
                                 
                              
                           
                        when 
                           j
                           ′
                           ∈
                           
                              
                                 N
                              
                              
                                 j
                              
                           
                        , 
                           
                              
                                 ω
                              
                              
                                 j
                                 j
                                 ′
                              
                           
                           =
                           1
                        , and in other cases, 
                           
                              
                                 ω
                              
                              
                                 j
                                 j
                                 ′
                              
                           
                           =
                           0
                        . Since 
                           ϕ
                           
                              (
                              z
                              )
                           
                           =
                           
                              |
                              z
                              |
                           
                         is convex, 
                           R
                           
                              (
                              
                                 f
                                 ,
                                 m
                              
                              )
                           
                           =
                           
                              
                                 ∑
                                 j
                              
                              
                                 
                                    ∑
                                    
                                       
                                          j
                                          ′
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    |
                                    
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             m
                                          
                                          
                                             j
                                             ′
                                          
                                       
                                    
                                    |
                                 
                              
                           
                         is also convex by proof in Hsiao’s literature [27]. The weight 
                           
                              
                                 ω
                              
                              
                                 j
                                 
                                    j
                                    ′
                                 
                              
                           
                         links 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                         not with its 
                           
                              
                                 f
                              
                              
                                 j
                                 ′
                              
                           
                        -neighbors, but with
                           
                              {
                              
                                 
                                    
                                       m
                                    
                                    
                                       j
                                       ′
                                    
                                 
                                 ,
                                 j
                                 ′
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       j
                                    
                                 
                              
                              }
                           
                           .
                         For the potential energy function 
                           ϕ
                           
                              (
                              z
                              )
                           
                        , here 
                           z
                           =
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           −
                           
                              
                                 m
                              
                              
                                 j
                                 ′
                              
                           
                        , unlike traditional algorithms, 
                           z
                           =
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           −
                           
                              
                                 f
                              
                              
                                 j
                                 ′
                              
                           
                        ,
                           j
                           ′
                           ∈
                           
                              
                                 N
                              
                              
                                 j
                              
                           
                        .

Ref. [27] clearly shows that the solution turns out to be the local median of its local neighborhood by optimizing the absolute function. For example,
                           
                              (10)
                              
                                 median
                                 
                                    {
                                    
                                       2
                                       ,
                                       2
                                       ,
                                       5
                                    
                                    }
                                 
                                 =
                                 2
                                 =
                                 arg
                                 
                                    
                                       min
                                    
                                    
                                       ζ
                                    
                                 
                                 
                                    {
                                    
                                       
                                          |
                                          
                                             ζ
                                             −
                                             2
                                          
                                          |
                                       
                                       +
                                       
                                          |
                                          
                                             ζ
                                             −
                                             2
                                          
                                          |
                                       
                                       +
                                       
                                          |
                                          
                                             ζ
                                             −
                                             5
                                          
                                          |
                                       
                                    
                                    }
                                 
                              
                           
                        
                     

For low-dose CT projections, “isolated points“ which is similar to impulse noise may exist in some area of the sonogram [28,29]. When TV algorithm is applied to low-dose sparse-view CT reconstruction, patchy artifacts are generated in the reconstructed images due to the fact that the low-dose sparse-view CT projections are contaminated by excessive quantum noise. Therefore, a constraint with better expression ability for image features is needed. It has been demonstrated that, in our previous study, the median filter could effectively eliminate this kind of noise, thus useful information of projections after median filtered become more concentrated and the basic characteristics could be more accurately expressed [29]. Taking the relationship between the median prior and the median filter into consideration, we introduced an auxiliary vector 
                           m
                         in register with the object of TV and proposed a median prior constrained TV reconstruction algorithm to eliminate patchy artifacts in reconstructed images.

The proposed objective function is given by
                           
                              (11)
                              
                                 
                                    
                                       F
                                    
                                    
                                       uc
                                    
                                 
                                 
                                    (
                                    
                                       f
                                       ,
                                       m
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ‖
                                       
                                          Gf
                                          −
                                          y
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 TV
                                 
                                    (
                                    f
                                    )
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 R
                                 
                                    (
                                    
                                       f
                                       ,
                                       m
                                    
                                    )
                                 
                              
                           
                        where β
                        1 and β
                        2 are regularization parameters to restrain the fidelity term. As the median prior 
                           R
                           
                              (
                              
                                 f
                                 ,
                                 m
                              
                              )
                           
                         is a function of both 
                           f
                         and 
                           m
                         , the optimization issue in (11) then is translated into a joint estimation problem about 
                           f
                         and 
                           m
                         , then the problem becomes
                           
                              (12)
                              
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    f
                                 
                                 
                                    
                                       ‖
                                       
                                          Gf
                                          −
                                          y
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 TV
                                 
                                    (
                                    f
                                    )
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 R
                                 
                                    (
                                    
                                       f
                                       ,
                                       
                                          
                                             
                                                m
                                                ^
                                             
                                          
                                          k
                                       
                                    
                                    )
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          m
                                          ^
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       min
                                    
                                    m
                                 
                                 
                                    {
                                    
                                       R
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             m
                                          
                                          )
                                       
                                    
                                    }
                                 
                              
                           
                        
                     

From the preceding discussion, we note that the solution obtained by optimizing the absolute function within a local neighborhood turns out to be the result of the local median. The solution 
                           
                              
                                 
                                    m
                                    ^
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         in Eq. (13) is a set of local medians of 
                           
                              
                                 
                                    f
                                    ^
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        . That is, 
                           
                              
                                 
                                    m
                                    ^
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         is regarded as the result of a median window filtering 
                           
                              
                                 
                                    f
                                    ^
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        . Through the alternate iterative update calculation between Eqs. (12) and (13), the update equations are given
                           
                              (14)
                              
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       min
                                    
                                    f
                                 
                                 
                                    
                                       ‖
                                       
                                          Gf
                                          −
                                          y
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 T
                                 V
                                 
                                    (
                                    f
                                    )
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 R
                                 
                                    (
                                    
                                       f
                                       ,
                                       
                                          
                                             
                                                m
                                                ^
                                             
                                          
                                          k
                                       
                                    
                                    )
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          m
                                          ^
                                       
                                    
                                    
                                       j
                                       ′
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 median
                                 
                                    {
                                    
                                       
                                          
                                             
                                                f
                                                ^
                                             
                                          
                                          
                                             j
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ,
                                       j
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             j
                                             ′
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        
                     

According to Eq. (3), for an image 
                           f
                           ∈
                           
                              
                                 R
                              
                              
                                 W
                                 H
                                 ×
                                 1
                              
                           
                        , integers W and H are the width and height of the 2D image array, respectively, we can get its discrete form of TV
                           
                              (16)
                              
                                 TV
                                 
                                    (
                                    f
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          1
                                          <
                                          j
                                          <
                                          W
                                          ⋅
                                          
                                             (
                                             
                                                H
                                                −
                                                1
                                             
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             |
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             |
                                          
                                          +
                                          
                                             |
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      j
                                                      +
                                                      W
                                                   
                                                
                                                −
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

By comparing the median prior 
                           R
                           
                              (
                              
                                 f
                                 ,
                                 m
                              
                              )
                           
                         in Eq. (9) and TV norm in Eq. (16), it can be seen that they have similar forms: they all have a summation operation involving all pixels in the image. However, their sum contents are different, the former relates to the gradient magnitude of the image while the latter refers to the absolute value 
                           |
                           
                              
                                 
                                    f
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 
                                    m
                                 
                                 
                                    j
                                    ′
                                 
                              
                           
                           |
                        .

In this paper, the 
                           
                              
                                 Σ
                              
                              
                                 
                                    j
                                    ′
                                 
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           |
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           −
                           
                              
                                 m
                              
                              
                                 j
                                 ′
                              
                           
                           |
                         is defined as median gradient norm (MGN) and this process, similar to DGT, is named as discrete median gradient transform (DMGT). This median gradient proves to be sparse as well. Still for the phantom in Fig. 2(a), the median gradient norm image after DMGT is shown in 
                        Fig. 4(b).

We have calculated the number of non-zero pixels after DGT (2184), however, for the median gradient norm image obtained after DMGT, the number of non-zero pixels is 5042. It can be seen that although sparsity in the obtained MGN image is inferior to that in GMI, it has significant sparsity compared with the original image.

Through all the above analysis, it is drawn that TV norm goes to be the sum of discrete gradient (DG), while 
                           R
                           
                              (
                              
                                 f
                                 ,
                                 m
                              
                              )
                           
                         is the sum of DMG. Since this process is similar to TV, we define it as a pseudo total variation (pseudo-TV), and rewrite the formula as
                           
                              (17)
                              
                                 PTV
                                 
                                    (
                                    
                                       f
                                       ,
                                       m
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                       j
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             ′
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          |
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   j
                                                
                                             
                                             −
                                             
                                                
                                                   m
                                                
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                          |
                                       
                                    
                                 
                              
                           
                        
                     

And then we define our final objective function as
                           
                              (18)
                              
                                 
                                    
                                       F
                                    
                                    
                                       uc
                                    
                                 
                                 (
                                 f
                                 ,
                                 m
                                 )
                                 =
                                 
                                    
                                       ‖
                                       
                                          Gf
                                          −
                                          y
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 TV
                                 
                                    (
                                    f
                                    )
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 PTV
                                 
                                    (
                                    
                                       f
                                       ,
                                       m
                                    
                                    )
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       min
                                    
                                    f
                                 
                                 
                                    
                                       F
                                    
                                    
                                       uc
                                    
                                 
                                 
                                    (
                                    
                                       f
                                       ,
                                       
                                          
                                             
                                                m
                                                ^
                                             
                                          
                                          k
                                       
                                    
                                    )
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          m
                                          ^
                                       
                                    
                                    
                                       j
                                       ′
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 median
                                 
                                    {
                                    
                                       
                                          
                                             
                                                f
                                                ^
                                             
                                          
                                          
                                             j
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ,
                                       j
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             j
                                             ′
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        
                     

A trial solution in Eq. (19) is constrained by the fidelity term, which may yield a noisy result. A successful solution can be obtained from Eq. (20) by using the trial solution of Eq. (19) as initial value, wherein serious noise-induced artifacts are remarkable suppressed.

In the implementation, the nonlinear conjugate gradient (CG) algorithm was used to solve Eq. (19). The expression for the partial derivative of the objective function is required when performing, and for the jth element of the image, the partial derivative is as follows.
                           
                              (21)
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             F
                                          
                                          
                                             uc
                                          
                                       
                                       (
                                       f
                                       ,
                                       m
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          2
                                          
                                             
                                                G
                                             
                                             T
                                          
                                          
                                             (
                                             
                                                G
                                                f
                                                −
                                                y
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       ∂
                                       TV
                                       (
                                       f
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∂
                                       PTV
                                       
                                          (
                                          
                                             f
                                             ,
                                             m
                                          
                                          )
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Since it is not convenient to use Eq. (16) in TV norm calculation, 
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                        -norm in Eq. (22) is usually used to approximate 
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                        -norm, and a small parameter ε is introduced to avoid an infinite value.
                           
                              (22)
                              
                                 TV
                                 
                                    (
                                    f
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          1
                                          <
                                          j
                                          <
                                          M
                                          ⋅
                                          
                                             (
                                             
                                                N
                                                −
                                                1
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            +
                                                            M
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   ε
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The partial derivative of the TV norm for the jth element of image f
                        
                           j
                         is given in Eq. (23).
                           
                              (23)
                              
                                 
                                    
                                       ∂
                                       TV
                                       (
                                       f
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             j
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            −
                                                            1
                                                            +
                                                            M
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   ε
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             j
                                             −
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            −
                                                            M
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            −
                                                            M
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            −
                                                            M
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   ε
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             j
                                             +
                                             M
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                            +
                                                            M
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   ε
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Analogously, we calculate the partial derivative of 
                           PTV
                           
                              (
                              
                                 f
                                 ,
                                 m
                              
                              )
                           
                        . At first, a median filter is applied to the image 
                           f
                         and then image 
                           m
                         is obtained. Note that the gradient of the absolute value is ±1, when 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           −
                           
                              
                                 m
                              
                              
                                 j
                                 ′
                              
                           
                           >
                           0
                        , the result is 1 and when 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           −
                           
                              
                                 m
                              
                              
                                 j
                                 ′
                              
                           
                           <
                           0
                        , the result is −1, when 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 m
                              
                              
                                 j
                                 ′
                              
                           
                        , the result is set to be 0. So the gradient of 
                           PTV
                           
                              (
                              
                                 f
                                 ,
                                 m
                              
                              )
                           
                         is a count, denoted as
                           
                              (24)
                              
                                 
                                    
                                       ∂
                                       PTV
                                       (
                                       f
                                       ,
                                       m
                                       )
                                    
                                    
                                       ∂
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          
                                             j
                                             ′
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                      >
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                      <
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The main idea of CG is that the next searching direction is determined by the steepest descent direction and the previous searching direction. In summary, the implementation of the present TV_MP is described as follows.
                           
                              
                                 
                                 
                                    
                                       Initialization:
                                    
                                    
                                       initial image 
                                             f
                                          
                                          0, 
                                             y
                                          
                                          0, 
                                             m
                                          
                                          0
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                0
                                             
                                             =
                                             G
                                             
                                                
                                                   f
                                                
                                                0
                                             
                                          , 
                                             
                                                
                                                   m
                                                
                                                0
                                             
                                             =
                                             median
                                             
                                                {
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      0
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                    
                                       partial objective function 
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                             
                                             =
                                             ∇
                                             
                                                
                                                   F
                                                
                                                
                                                   uc
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      0
                                                   
                                                   ,
                                                   
                                                      
                                                         m
                                                      
                                                      0
                                                   
                                                
                                                )
                                             
                                          ,
                                    
                                    
                                       gradient descent direction 
                                             
                                                
                                                   d
                                                
                                                
                                                   0
                                                
                                             
                                             =
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                             
                                          .
                                    
                                    
                                       Iterative loop:
                                    
                                    
                                       for itern=1:I
                                       
                                    
                                    
                                       Start with a linear search, until it meets the standard criteria Wolfe
                                    
                                    
                                       (1)
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   γ
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       (2)
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   γ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       (3)
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             =
                                             ∇
                                             
                                                
                                                   F
                                                
                                                
                                                   uc
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                )
                                             
                                          , 
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             =
                                             median
                                             
                                                {
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                    
                                       (4)
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   g
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       (5)
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                             max
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   0
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       (6)
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             =
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       End for: 
                                             
                                                f
                                                ^
                                             
                                             =
                                             
                                                
                                                   f
                                                
                                                
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The initial search step-length γ
                        0=0.00005, c
                        1=0.5.

These preset parameters and coefficients only changed the convergence speed.

Wang expounded the noise modeling of low-dose CT projection data [1,29]. The projections after system calibration and logarithm transformation are approximately Gaussian distributed in low-dose CT applications. And the proposed model described the relationship between the mean and the variance of the calibrated projection data as follows.
                           
                              (25)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 exp
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          η
                                       
                                    
                                    )
                                 
                              
                           
                        where 
                           
                              
                                 
                                    y
                                    ¯
                                 
                              
                              
                                 i
                              
                           
                         denotes the expectation value of the projection in detector bin i and 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 2
                              
                           
                         denotes the corresponding variance. Notation η is a scaling parameter which is object-independent but completely determined by the system settings. And notation w
                        
                           i
                         is a parameter adaptive to different bins. It is obviously that the relationship between the data mean and the data variance is nonlinear.

To prove the feasibility of the proposed TV_MP algorithm, three experiments in which two experiments are based on numerical simulation datasets and one experiment is based on clinical standard-dose CT dataset, were designed. For the numerical simulations, one is CT reconstruction from noise-free sparse-view projections and another is CT reconstruction from low-dose sparse-view projections. The models we chosen were the numerical Hot-Cold phantom and the Shepp–Logan phantom with size of 256×256, shown in 
                        Fig. 5(a) and (b). 
                        
                        Tables 1 and 2 list the parameters of the ellipsoids (or objects) in the phantoms. The pelvic CT image (shown in Fig. 5(c)) was obtained from the clinical actual projections. The acquisition was obtained using a Siemens CT machine and the scanning parameter setting was: 120kVp, 100mAs, radius of source circle of 2.868mm, ray spacing of 1.2mm; the distance from the X-ray source to the center of rotation was 408mm and 816mm to the detector band.

The projections corresponding to numerical phantoms were obtained under the protocol of parallel beam scanning. The system matrix 
                           G
                         under different view numbers could be calculated and then the simulated noise-free sparse projections were obtained by uniform sampling for the three models through 
                           y
                           =
                           Gf
                        . The view numbers are 30, 60 and 120, sampled evenly over 180 degrees, respectively, and there are 256 detectors at each view. It is impossible to get noise-free projections in actual CT imaging process, even though we increase the radiation dose. Therefore, we performed the sparse sampling simulation experiments for emulational low-dose CT projections. The way we simulated the low-dose CT projections was to add non-stationary Gaussian noise into the simulated ideal projections using Eq. (25) where η=22,000, w
                        
                           i
                        =150. With regard to the clinical projection data, it is regarded as noise-free in our study, and in order to simulate the low-dose projections, we added noise to the actual projections in the same way.

Reconstructed images are obtained by FBP, ART, TV and TV_MP algorithms in cases of 30-, 60- and 120-views, respectively. Not only signal noise rate (SNR) was used to evaluate the quality of images reconstructed from noisy projections, but also root mean square error (RMSE) was used as a quality evaluation for noise-free projection reconstruction images. SNR and RMSE are defined as follows.
                           
                              (26)
                              
                                 S
                                 N
                                 R
                                 =
                                 10
                                 
                                 log
                                 
                                    {
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               f
                                                               ^
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            
                                                               f
                                                               ^
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                J
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               f
                                                               ^
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            ref
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 RMSE
                                 =
                                 
                                    
                                       
                                          1
                                          J
                                       
                                       
                                          ∑
                                          j
                                          J
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                                  ^
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               ref
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               ref
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    f
                                    ^
                                 
                              
                              
                                 j
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 j
                              
                              
                                 ref
                              
                           
                         are the value of the reconstruction image and the original image at the jth pixel, respectively. 
                           
                              
                                 m
                              
                              
                                 
                                    f
                                    ^
                                 
                              
                           
                         is the mean value of the reconstructed image. J is the total number of image pixels. RMSE describes the extent how far the reconstruction image is close to the original phantom. The smaller the RMSE value is, the better the reconstruction image quality is, indicating the reconstruction image is closer to the original phantom.

@&#EXPERIMENTAL RESULTS@&#

In the objective function in Eq. (18), we investigated the selection of β
                           1 and β
                           2 for each experiment by subjective visual and quality evaluation. To search the optimal β
                           1 and β
                           2 for each simulated condition, first we fixed β
                           1 and searched step by step to find the best β
                           2 with which we could obtain reconstructed images with the smallest RMSE. Optimal β
                           1 then was chose by the same strategy. Note that the SNR are also taken into account at the same time in noisy condition. 
                           Table 3 lists the best β
                           1 and β
                           2 for different simulated conditions. Obviously, the proposed TV_MP algorithm degrades into TV algorithm when β
                           2=0.


                           
                           Fig. 6 shows images reconstructed by FBP, ART, TV and TV_MP algorithms in cases of 30-, 60- and 120-views, respectively. There are considerable deviations between FBP reconstruction results and the original phantom, seeing the first row of Fig. 6, especially in the case of fewer views. Especially, we notice that distortions exist in the reconstructed images and the distortions become more serious with the decrease of view numbers. Reconstructions of ART under different view numbers are shown in the second row of Fig. 6. The iterative process stopped in terms of visual effect and the number of iterations in 30-, 60-, and 120-views is 5, 50 and 50, respectively. Though artifacts in the reconstructed images acquire partial elimination when the view number increases, reconstruction is still blurred, excessive smoothed, and details missing in the case of 30-views. Reconstructions of TV and TV_MP under different view numbers are shown in the third and fourth row of Fig. 6, respectively. The number of iterations for both TV and TV_MP in different cases was set to 100. Visually, ring-like artifacts exist in TV results when the view number is smaller such as 30 and 60, seeing the area indicated by arrows. By contrast, no ring-like artifacts exist in the TV_MP reconstructions which are very close to the original phantom.

Since projection data in this set of experiments is noise-free, we evaluate the accuracy of reconstructed images by RMSE defined in Eq. (27). The RMSE indexes of results obtained by TV and TV_MP are shown in 
                           Table 4. Under the same conditions, RMSE values of TV_MP reconstructions are lower than those of TV, which means that the accuracy of TV_MP reconstructions is slightly higher than that of TV.


                           
                           Fig. 7(a) describes the images reconstructed by different algorithms from the sparse-view low-dose projections. It can be seen that FBP is more powerless under sparse-view cases, while results of ART makes a little better process in which we set the number of iterations in 30-, 60- and 120-views as 5, 20 and 20, respectively, with the sacrifice of resolution, since plenty of strip artifacts would appear with more iterations. Compared with noise-free results of ART, edges in the reconstructed images are smoothed and clear streak artifacts are clearly seen in the reconstructed images, especially in the case of 30-views. In the third and fourth row of Fig. 7(a), the results of TV and TV_MP under different projection view numbers are shown, respectively. The number of iterations for both TV and TV_MP in different cases was set to 100. Compared with results of FBP and ART, significant improvements can be seen in the reconstructed images using TV method. However, there are still some shortages, for example, obvious patchy artifacts exist in the reconstructed image when the under-sampling degree is greater for low-dose CT. Seen from the TV_MP reconstructions, even when view number is smaller, such as 30, there are no blocky or streak artifacts in the reconstructed image, with a relatively smooth background. And the more the views are, the closer they are to the original phantom. In addition, due to using of median filter after TV reconstruction can also attenuate blocky effect, we specially displayed the results of TV reconstruction+2D median filter (3×3) post processing, seeing in the last row. It is obviously that the results of TV reconstruction+2D median filter are better than those of only TV process, however, cannot be comparable to results of TV_MP.


                           Fig. 7(b) shows the differences between the original phantom and the results of TV and TV reconstruction+2D median filter and the corresponding results of the TV_MP method as well. From left to right, the images are from 30-, 60- and 120-views, respectively. The merits of the two algorithms can be seen from not only the reconstructed results but also the difference images. Clearly, TV reconstructions have more noise and more blocky artifacts and there is no way for the results of TV reconstruction+2D median filter to avoid artifacts. It comes to the conclusion that the proposed TV_MP algorithm has better results comparing with the results of TV and TV+2D median filter.

In order to further compare the performance of TV and the proposed TV_MP algorithm, we use the quality evaluation parameters SNR and RMSE, shown respectively in 
                           
                           Tables 5 and 6, to illustrate the noise suppression and edge-preserving ability of both the two algorithms. SNR values of TV_MP reconstructions in Table 5 are higher than those of TV reconstructions and TV reconstruction+2D median filter results under the same conditions, which demonstrates that TV_MP has better ability for noise reduction than TV. In Table 6, RMSE values of TV_MP reconstructed images are lower than those of the other two methods under the same conditions, it means that TV_MP reconstructed images are closer to the original phantom compared with TV reconstructed images.

For the Shepp–Logan phantom, we use the same method as for the Hot–Cold phantom to determine two regularization parameters β
                           1 and β
                           2. 
                           Table 7 shows the best β
                           1 and β
                           2 under different view numbers.


                           
                           Fig. 8 shows the images reconstructed by FBP, ART, TV and TV_MP from noise-free projections in cases of 30-, 60- and 120-views. Obviously, same as the Hot–Cold phantom, there are considerable deviations between results of FBP and the original phantom. And the fewer the views are, the larger the deviations are, such as the reconstructed image from 30 views, and we can see a lot of obvious artifacts, serious image structural damage and detail information loss. The reconstructed results of ART are shown in the second row of Fig. 8 and the number of iterations in 30-, 60- and 120-views was set to 5, 20 and 20, respectively. Although the obtained reconstruction is seriously blurred and over-smoothed in the case of 30-views, artifacts are gradually eliminated when the view number increases. However, edges in the reconstruction in 120-views are still a little blurred. The reconstructed results of TV and TV_MP are shown in the third and fourth row of Fig. 8, respectively. The number of iterations for both TV and TV_MP in different cases was set to 100. By contrasting the results of TV and TV_MP, it indicates that they are of about the same result from noise-free projections. As it turns out, when the view number is bigger, such as 60 and 120, the reconstructed results are very close to the original phantom.


                           
                           Table 8 shows RMSE values of TV results and TV_MP results under different view numbers. RMSE values of TV_MP reconstructions are lower than those of TV reconstructions under the same conditions, which means that though TV results and TV_MP results are very similar from the perspective of vision, the accuracy of TV_MP is slightly higher than TV.


                           
                           Fig. 9(a) describes the results of different algorithms reconstructed from sparse-views low-dose projections. Seen from the results of FBP in the first row, when the view number is smaller, the reconstructed image is contaminated more heavily. Especially, when the view number is 30, the structure characteristics of the image suffered severe damage. The results of ART are shown in the second row of Fig. 9(a) and the number of iterations in 30-, 60- and 120-views, in terms of visual effect, was set to 5, 15 and 20, respectively. Obviously, results of ART are better than those of FBP, but edges and details in the reconstructed images are excessive smoothed, leading to blurred results in the case of 30-views, and when the view numbers are 30 and 60, clear strip artifacts can be seen in the reconstructed images. The reconstructed images of TV and TV_MP are shown in the third and fourth row of Fig. 9(a), respectively. The number of iterations for both TV and TV_MP in different cases was set to 100. We observed that both the two methods comply with the fact that reconstructed images are closer to the original phantom when increasing the view number. Specifically, significant improvements can be seen in TV reconstructions comparing with FBP and ART algorithm. However, there are still some problems; for example, obvious blocky artifacts exist in TV reconstructed results when the under-sampling degree is greater. Seen from the TV_MP reconstructed results in the fourth row, even if the view number is small, such as 30, there are no blocky artifacts in the reconstructed image. Same as the conclusion for Hot–cold phantom, reconstructed images are closer to the original phantom when increasing the view number is bigger. The results of TV reconstruction+2D median filter (3×3) are shown in the last row as well, from which we can observe that the results of TV reconstruction+2D median filter have better visual effects than those of TV, but cannot equal the results of TV_MP. It is especially obvious in the case of 30-views. In fact, the quality of results didn’t essentially improve because blocky artifacts cannot be totally removed.

Similar conclusion comes from Fig. 9(b) which shows the differences between the original phantom and the results of TV and TV reconstruction+2D median filter and the corresponding results of the TV_MP method as well. From left to right, the images are from 30-, 60- and 120-views, respectively.

Though we cannot well distinguish the advantages between the two algorithms when the view number is 120, the superiority of the proposed TV_MP algorithm is clear with the decrease of view numbers, taking 30 views for example. In addition, we further enlarge a region of interest (ROI) of the reconstructed images of TV, TV reconstruction+2D median filter and TV_MP in 
                           Fig. 10. Obviously, we can see that blocky artifacts exist in the results of TV and TV reconstruction+2D median filter and more obvious blocky artifacts exist when the views are fewer. While there are no blocky artifacts exist in the TV_MP reconstructed images, both details and edges are well preserved.

For further comparison, we used SNR and RMSE to illustrate the noise suppression effect and the edge preservation effect of the two methods. It can be seen form 
                           
                           Tables 9 and 10 that, under the same conditions, the SNR values of TV_MP reconstructions are higher than other results, nether the results of TV nor those of TV reconstruction+2D median filter, meaning TV_MP has better ability of noise reduction. In parallel, RMSE values of TV_MP reconstructions are lower under the same conditions. It illustrated that the reconstructed images by TV_MP are much closer to the original image.


                           
                           Fig. 11 shows the horizontal and vertical profiles of TV and TV_MP results in Fig. 9(e3, f3, g3, e4, f4 and g4), which could illustrate the similarity between reconstructed images and the original Shepp–Logan phantom image. It is obviously that, compared with the results of TV, whether the horizontal profiles or the vertical profiles, they are closer to the original profiles in the TV_MP reconstructed images in all cases.

The resolution of the reconstructed image was analyzed by the parameter modulation transfer function (MTF) [30]. To compute the MTF, first we obtained an edge spread function (ESP) along the profile in the selected ROI, indicated by a blue line in the reconstructed image, shown in 
                           Fig. 12. Next the line spread function (LSP) was obtained from the derivation of the ESP. Then MTF was obtained after applying Fourier transformation to the LSF. In this paper, normalization may be need in order to ensure MTF(0)=1. Fig. 12 shows the MTFs obtained by the TV and TV_MP methods for the 30-, 60- and 120-views. We can observe that the TV_MP results yield a better image resolution than the TV results in all cases.

Although the convergence of this iteration process is not theoretically guaranteed, we have confirmed experimentally that this iteration process converges after certain iterations. One example is the curves of RMSE from the TV_MP results, shown in Fig. 8(a4, b4 and c4), reconstructed from clean projections and another example is the curves of the RMSE values and SNR values with iterations for the results, shown in Fig. 9(e4, f4 and g4), reconstructed from noisy projections. The RMSE value and SNR value at each iteration in different cases is shown in 
                           Fig. 13(a)–(c), respectively. Another example is the curves of objective values with iterations for the TV_MP results shown in Fig. 9(e4, f4 and g4). The objective values at each iteration in different cases are shown in Fig. 13(d)–(f), respectively.

All experiments were performed using Matlab R2008b under the environment that OS: 32-bit; Windows 7; CPU: Intel Core(TM) 2 Duo, 4G RAM, NVIDIA GeForce GT 730M+Intel GMA HD 4600. We ran different algorithms 20 times for different cases of 30-, 60- and 120-views, respectively. 
                           Table 11 lists the average computation time of ART, TV, TV+2D median filter and TV_MP, respectively. It can be seen that the average computation time of TV_MP is more than that of TV and TV_MP, but less than ART, which indicates that the proposed TV_MP is relatively fast.

As described in Section 3.2, the pelvic phantom with low-contrast was reconstructed from the standard-dose projections and the simulated low-dose CT projections were used to estimate the proposed TV_MP algorithm. 
                           Table 12 shows the best regularization parameters β
                           1 and β
                           2 under different view numbers.


                           
                           Fig. 14(a) shows the results of different algorithms reconstructed from sparse-views low-dose projections. Serious artifacts appeared in the FBP reconstructed images, shown in the first row; it’s easily observed that the reconstructed image degenerated more heavily with the decrease of views. In comparison with FBP reconstructions, the results of ART, as shown in the second row, have relatively few artifacts but with blurred edges. The number of iterations in 30-, 60- and 120-views, in terms of visual effect, was set to 5, 15 and 20, respectively. The reconstructed images of TV and TV_MP are shown in the third and fourth row of Fig. 14(a), respectively. The number of iterations for TV and TV_MP in different cases was set to 100. Compared with the reconstructed images in first two rows, significant improvements can be seen in the reconstructed images using TV method and TV_MP method. However, in the case of fewer views, blocky artifacts still exist in the reconstructed image of TV so that some tissues seriously stick together and there are even some tissue-like which should not appear, seeing the area “I” indicated by blue ellipse in the case of 30 views. Seen from the TV_MP reconstructed results, blocky artifacts were well eliminated even in the case of 30 views. The results of TV reconstruction+2D median filter (3×3) are shown in the last row as well, from which we can observe that blocky artifacts were partially attenuate comparing with those of TV, but artifacts are pretty obvious in the case of 30 views. The reconstructed results by TV_MP obviously show the greatest superiority in terms of noise reduction, artifacts suppression, and edge preservation.

To further evaluate the TV_MP method for its performance in noise and artifacts suppression, Fig. 14(b) shows a zoomed ROI for the reconstructed images in the selected area “II” as indicated by a blue rectangle. Seen from the zoomed images, TV_MP obviously performed better behavior than TV. One example is that bones are more legible in the reconstructed images of TV_MP rather than those of TV. Another example is that the tissues in the TV reconstruction are totally fused in the case of 30 views so that we even cannot distinguish them, and little blocky artifacts are apparent in the case of 60 views. In the results of TV+2D median filter, artifacts were well eliminated but with the sacrifice of resolution, seeing the bones which are blurred after median filter, while the results of TV_MP were obtained without this kind of situation.

@&#DISCUSSION AND CONCLUSION@&#

In this paper, we investigated TV minimization method and proposed the TV_MP algorithm for accurate image reconstruction in parallel-beam CT under under-sampling and low-dose situation. We have evaluated and demonstrated the performance of TV_MP algorithm in reconstructing low-dose CT images from sparse-view projections. Reconstructions in numerical studies indicate that, compared with the TV algorithm and ART algorithm, the proposed TV_MP algorithm can yield better reconstructions from under-sampling and noisy projections since patchy artifacts or streak artifacts exist in TV reconstructed images or ART reconstructed images when the projections are contaminated by excessive quantum noise in the process of scan. Different from TV algorithm, the proposed TV_MP algorithm overcomes the shortcomings of blocky artifacts and shows its superiority in low-dose CT reconstruction. However, as TV algorithm, the effectiveness of the TV_MP algorithm depends on the fact that the object being imaged has a sparse gradient image and a relatively sparse median gradient norm image. Even though the examples described above were limited to parallel-beam CT, the TV_MP algorithm equally to fan-beam and cone-beam CT. And we will extend the proposed algorithm to fan-beam or cone-beam orbit and real CT system in the further study.

We declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work, there is no professional or other personal interest of any nature or kind in any product, service and/or company that could be construed as influencing the position presented in, or the review of, the manuscript entitled, “Median prior constrained TV algorithm for sparse view low-dose CT reconstruction”.

@&#ACKNOWLEDGEMENTS@&#

The work reported here was supported by (1) The National Nature Science Foundation of China (61071192, 61271357, 61171178), (2) The Top Young Academic Leaders of Higher Learning Institutions of Shanxi, (3) International S&T Cooperation Program of Shanxi Province (2013081035), (4) Outstanding Graduate Innovation Project of Shanxi Province Province (20123098).

@&#REFERENCES@&#

