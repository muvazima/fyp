@&#MAIN-TITLE@&#Multi-level facility location as the maximization of a submodular set function

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study the multi-level uncapacitated facility location problem.


                        
                        
                           
                           We model it as two different combinatorial optimization problems.


                        
                        
                           
                           The set function associated with the first problem is not submodular.


                        
                        
                           
                           The set function associated with the second problem is submodular.


                        
                        
                           
                           Submodularity is not a property intrinsic to a problem but rather to its representation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Submodularity

Multi-level facility location

@&#ABSTRACT@&#


               
               
                  In this paper we model the multi-level uncapacitated facility location problem as two different combinatorial optimization problems. The first model is the classical representation of the problem which uses a set of vertices as combinatorial objects to represent solutions whereas in the second model we propose the use of a set of paths. An interesting observation is that the real-valued set function associated with the first combinatorial problem does not satisfy the submodular property, whereas the set function associated with the second problem does satisfy this property. This illustrates the fact that submodularity is not a property intrinsic to an optimization problem but rather to its mathematical representation.
               
            

@&#INTRODUCTION@&#

In this paper we introduce an alternative combinatorial representation for the multi-level uncapacitated facility location problem (MUFLP) whose objective function satisfies the submodularity property. The contribution of this paper is twofold. First, we correct a previous conclusion stating that the MUFLP is not submodular and also, we illustrate the fact that submodularity is not an intrinsic property of an optimization problem but rather of the set function of its mathematical representation. To the best of our knowledge, this has not been clarified before in the literature and has led to a misuse of the terminology and to misleading results.

Generally speaking multi-level facility location problems (MFLPs) consist of finding the best set of facilities to open at each of the different levels (or type of facilities) in order to maximize the total profit while satisfying the demand of every customer. Several variants of MFLPs have been studied over the last four decades. Early works addressing MFLPs are those of Calvo and Marks (1973) and Kaufman, Eede, and Hansen (1977), who introduced this family of discrete location problems and described mathematical programming formulations to represent them. However, since most MFLPs are NP-hard, several approximation algorithms have been developed for different versions of this family of problems (see for instance, Aardal, Chudak, & Shmoys, 1999; Edwards, 2001; Ageev, Ye, & Zhang, 2003; Addis, Carello, & Ceselli, 2013). Moreover, even for the single level case, very recent approximation and exact algorithms for solving particular cases are presented in Aardal, Van den Berg, Gijswijt, and Li (2015) and Letchford and Miller (2014), respectively, showing the continued interest in this fundamental class of problems for the location science community. For recent overviews of models, classification criteria, solution techniques and references of Hierarchical Facility Location Problems, a more general view of MFLPs, we refer the reader to Şahin and Süral (2007) and Zanjirani-Farahani, Hekmatfar, Fahimnia, and Kazemzadeh (2014).

We focus our attention on a class of MFLPs originally introduced by Kaufman et al. (1977) and then extended by Ro and Tcha (1984) and Barros and Labbé (1994). Let 
                        
                           I
                           =
                           {
                           1
                           ,
                           …
                           
                           ,
                           m
                           }
                        
                      be the set of customers and 
                        
                           
                              V
                              1
                           
                           ,
                           
                              V
                              2
                           
                           ,
                           …
                           
                           ,
                           
                              V
                              k
                           
                        
                      the sets of sites where facilities of levels 1 to k can be selected (or open) and 
                        
                           V
                           =
                           
                              ∪
                              
                                 i
                                 =
                                 1
                              
                              k
                           
                           
                              V
                              i
                           
                        
                     . Also, there are fixed costs 
                        
                           f
                           
                              j
                              r
                           
                        
                      associated with opening facility jr
                      at level r and a profit 
                        
                           c
                           
                              i
                              
                                 j
                                 1
                              
                              …
                              
                                 j
                                 k
                              
                           
                        
                      obtained from allocating customer i ∈ I to the sequence of facilities 
                        
                           
                              j
                              1
                           
                           ,
                           …
                           
                           ,
                           
                              j
                              k
                           
                        
                     . The MUFLP consists of selecting a set of facilities to open at each of the k levels and of assigning each customer to a set of facilities, exactly one at each level, while maximizing the difference of the total profit minus the setup cost for opening the facilities. The MUFLP can be modeled as the following combinatorial optimization problem. For each nonempty subset R ⊆ V define

                        
                           
                              
                                 
                                    
                                       
                                          q
                                          (
                                          R
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                r
                                                =
                                                1
                                             
                                             k
                                          
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   r
                                                
                                                ∈
                                                
                                                   R
                                                   r
                                                
                                             
                                          
                                          
                                             f
                                             
                                                j
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          w
                                          (
                                          R
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             w
                                             i
                                          
                                          
                                             (
                                             R
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             max
                                             
                                                
                                                   j
                                                   1
                                                
                                                ∈
                                                
                                                   R
                                                   1
                                                
                                                ,
                                                …
                                                
                                                ,
                                                
                                                   j
                                                   k
                                                
                                                ∈
                                                
                                                   R
                                                   k
                                                
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                
                                                   j
                                                   1
                                                
                                                …
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and

                        
                           
                              
                                 
                                    
                                       
                                          v
                                          (
                                          R
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          w
                                          (
                                          R
                                          )
                                          +
                                          q
                                          (
                                          R
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             max
                                             
                                                
                                                   j
                                                   1
                                                
                                                ∈
                                                
                                                   R
                                                   1
                                                
                                                ,
                                                …
                                                
                                                ,
                                                
                                                   j
                                                   k
                                                
                                                ∈
                                                
                                                   R
                                                   k
                                                
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                
                                                   j
                                                   1
                                                
                                                …
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                r
                                                =
                                                1
                                             
                                             k
                                          
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   r
                                                
                                                ∈
                                                
                                                   R
                                                   r
                                                
                                             
                                          
                                          
                                             f
                                             
                                                j
                                                r
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 R
                                 =
                                 
                                    ∪
                                    
                                       r
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    R
                                    r
                                 
                              
                              ,
                           
                        
                      with 
                        
                           
                              R
                              1
                           
                           ⊆
                           
                              V
                              1
                           
                           ,
                           …
                           
                           ,
                           
                              R
                              k
                           
                           ⊆
                           
                              V
                              k
                           
                        
                     . The MUFLP can then be stated as the problem of selecting a set of nodes R ⊆ V such that v(R) is maximum, i.e.,

                        
                           (1)
                           
                              
                                 
                                    max
                                    
                                       R
                                       ⊆
                                       V
                                    
                                 
                                 
                                 
                                 
                                    {
                                    v
                                    (
                                    R
                                    )
                                    }
                                 
                                 .
                              
                           
                        
                     
                  

Note that when 
                        
                           k
                           =
                           1
                           ,
                        
                      the MUFLP reduces to the classical uncapacitated facility location problem (UFLP), a central problem in location theory (Cornuéjols, Nemhauser, & Wolsey, 1990). A promising avenue of research has thus been the extension of well-known properties of the UFLP for the multi-level case (i.e. k > 1). For instance, Aardal, Labbé, Leung, and Queyranne (1996) show that all non-trivial facet defining inequalities for the UFLP also define facets for the MUFLP when 
                        
                           k
                           =
                           2
                        
                     . Aardal et al. (1999), Bumb and Kern (2001) and Zhang (2006) use ideas previously developed for the UFLP, such as dual ascent and adjustment techniques (Erlenkotter, 1978), in order to develop approximation algorithms for the MUFLP. Frieze (1974) and Babayev (1974) show that the natural set function representation v(R) is submodular and Nemhauser, Wolsey, and Fisher (1978) show that w(R) is submodular and nondecreasing when 
                        
                           k
                           =
                           1
                        
                     . We recall the definition of submodular and nondecreasing set functions (see, Nemhauser et al., 1978).

Let N be a finite set and f be a real-valued function defined on the set of subsets of N and 
                        
                           
                              ρ
                              e
                           
                           
                              (
                              S
                              )
                           
                           =
                           f
                           
                              (
                              S
                              ∪
                              
                                 {
                                 e
                                 }
                              
                              )
                           
                           −
                           f
                           
                              (
                              S
                              )
                           
                        
                      be the incremental value of adding element e to the set S when evaluating the set function f.

                        Definition 1
                        
                           
                              
                                 (a)
                                 
                                    f is submodular if ρe
                                    (S) ≥ ρe
                                    (T),  ∀S ⊆ T ⊆ N and e ∈ N∖T.


                                    f is nondecreasing if ρe
                                    (S) ≥ 0,  ∀S ⊆ N and e ∈ N.

Although the maximization of a submodular set function is known to be NP-hard (Nemhauser & Wolsey, 1988), the submodular property has allowed the analytic study and development of exact and approximate algorithms for several classes of optimization problems (Goldengorin, 2009). One milestone in facility location is the paper of Cornuéjols, Fisher, and Nemhauser (1977) in which the authors use this property to obtain worst-case bounds for greedy and local improvement heuristics and for enumeration algorithms for the maximization version of the location problem. Later, a result by Feige (1998) implied that the best possible approximation guarantee for the UFLP was given precisely by the greedy algorithm, unless 
                        
                           P
                           =
                           N
                           P
                        
                     . More generally, the submodularity property is used by Nemhauser et al. (1978) in order to extend the results of the greedy and local heuristics for the problem of maximizing a submodular set function subject to a cardinality constraint. Nemhauser and Wolsey (1981) presented a mixed integer programming formulation and a cutting-plane algorithm to solve this class of problems based on submodularity. Wolsey (1983) applied this formulation to the UFLP and discussed its connections with a Benders reformulation. Spielberg (1969) studied simplification rules to reduce the number of explored nodes in an enumeration tree when solving the UFLP to optimality by branch-and-bound. More recently, Calinescu, Chekuri, Martin, and Vondrák (2011) presented a randomized approximation algorithm with worst-case bound for the problem of maximizing a submodular function subject to an arbitrary matroid and Kulik, Shachnai, and Tamir (2009) introduced an approximation algorithm for the maximization of a non-decreasing submodular function subject to multiple linear constraints. Also, Gupta and Könemann (2011) presented a survey of different approximation algorithms for network design, including the results of the greedy heuristic based on submodularity. Contreras and Fernández (2014) showed how a general class of hub location problems can be modeled as the minimization of a supermodular set function and used this representation to develop mixed integer programming formulations and approximation algorithms to solve these problems.

A similar approach to that of Spielberg (1969) is used in Ro and Tcha (1984) and Tcha and Lee (1984), where the submodularity property is assumed for the MUFLP, and branch-and-bound methods using similar simplification rules are presented for the two-level and the multi-level cases, respectively. However, Barros and Labbé (1994) provided a counter-example showing that the submodular property does not hold for the set function v(R), and thus the authors concluded that part of the results obtained in Ro and Tcha (1984) and Tcha and Lee (1984) were unfortunately wrong, also concluding that the MUFLP is not submodular.

We next provide an alternative combinatorial representation of the MUFLP whose objective set function is submodular. Note that for the case of problem (1), the mathematical model is defined on the set of subsets of V. Such a model arises naturally given that the MUFLP seeks to open a subset of facilities in V and to assign each customer to exactly one facility at each level. However, an alternative combinatorial representation is to use the set of paths connecting facilities between different levels to represent the allocation paths of customers to their allocated facility in each level.

Let 
                        
                           G
                           =
                           (
                           V
                           ∪
                           I
                           ,
                           E
                           )
                        
                      be a graph with a vertex set V ∪ I partitioned into 
                        
                           k
                           +
                           1
                        
                      levels where, as before, I represents the set of customers and 
                        
                           
                              V
                              1
                           
                           ,
                           
                              V
                              2
                           
                           ,
                           …
                           
                           ,
                           
                              V
                              k
                           
                        
                      are the sets of facilities from level 1 to level k, respectively. The set of edges E is also partitioned as 
                        
                           E
                           =
                           
                              {
                              
                                 E
                                 1
                              
                              ,
                              …
                              
                              ,
                              
                                 E
                                 k
                              
                              }
                           
                           ,
                        
                      where 
                        
                           
                              E
                              i
                           
                           =
                           
                              {
                              e
                              ∈
                              E
                              :
                              e
                              =
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              
                              with
                              
                              s
                              ∈
                              
                                 V
                                 
                                    i
                                    −
                                    1
                                 
                              
                              
                              and
                              
                              t
                              ∈
                              
                                 V
                                 i
                              
                              }
                           
                        
                      for 
                        
                           i
                           =
                           2
                           ,
                           …
                           
                           ,
                           k
                           ,
                        
                      and 
                        
                           
                              E
                              1
                           
                           =
                           
                              {
                              e
                              ∈
                              E
                              :
                              e
                              =
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              
                              with
                              
                              s
                              ∈
                              I
                              
                              and
                              
                              t
                              ∈
                              
                                 V
                                 1
                              
                              }
                           
                        
                     . Without loss of generality, we assume that for each 
                        
                           i
                           =
                           2
                           ,
                           …
                           
                           ,
                           k
                           ,
                        
                      the graphs induced by 
                        
                           
                              V
                              
                                 i
                                 −
                                 1
                              
                           
                           ∪
                           
                              V
                              i
                           
                        
                      are complete, otherwise we could complete the graph by adding edges such that the total profits of the corresponding new paths are zero. Moreover, we denote by P the set of all possible simple paths 
                        
                           (
                           
                              j
                              1
                           
                           ,
                           
                              j
                              2
                           
                           ,
                           …
                           
                           ,
                           
                              j
                              k
                           
                           )
                        
                      in G starting at a vertex j
                     1 ∈ V
                     1, finishing at a vertex jk
                      ∈ Vk
                     , and having exactly one element from each level. Let 
                        
                           N
                           =
                           P
                           ∪
                           V
                        
                      be a finite set containing both the set of paths P and the subset of vertices V of G. Also, consider the set Nr
                     (S) to be the set of vertices of level r associated with the paths of set S. Moreover, with an abuse of notation, we refer to each nonempty subset of N as the pair (S, R) thus, (S, R) ⊆ N, where S ⊆ P and R ⊆ V. Note that (S, R) is not a couple but a subset of N, which we denote as a pair in order to clearly differentiate the elements taken from P and those taken from V. Now, we define

                        
                           
                              
                                 
                                    
                                       
                                          f
                                          (
                                          S
                                          ,
                                          R
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                r
                                                =
                                                1
                                             
                                             k
                                          
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   r
                                                
                                                ∈
                                                
                                                   R
                                                   r
                                                
                                             
                                          
                                          
                                             f
                                             
                                                j
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          c
                                          (
                                          S
                                          ,
                                          R
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             c
                                             i
                                          
                                          
                                             (
                                             S
                                             ,
                                             R
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             max
                                             
                                                (
                                                
                                                   j
                                                   1
                                                
                                                ,
                                                
                                                   j
                                                   2
                                                
                                                ,
                                                …
                                                
                                                ,
                                                
                                                   j
                                                   k
                                                
                                                )
                                                ∈
                                                S
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                
                                                   j
                                                   1
                                                
                                                
                                                   j
                                                   2
                                                
                                                …
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and

                        
                           
                              
                                 
                                    
                                       
                                          z
                                          (
                                          S
                                          ,
                                          R
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          c
                                          (
                                          S
                                          ,
                                          R
                                          )
                                          +
                                          f
                                          (
                                          S
                                          ,
                                          R
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             max
                                             
                                                (
                                                
                                                   j
                                                   1
                                                
                                                ,
                                                
                                                   j
                                                   2
                                                
                                                ,
                                                …
                                                
                                                ,
                                                
                                                   j
                                                   k
                                                
                                                )
                                                ∈
                                                S
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                
                                                   j
                                                   1
                                                
                                                
                                                   j
                                                   2
                                                
                                                …
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                r
                                                =
                                                1
                                             
                                             k
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   R
                                                   r
                                                
                                             
                                          
                                          
                                             f
                                             
                                                j
                                                r
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where, as before, 
                        
                           
                              
                                 R
                                 =
                                 
                                    ∪
                                    
                                       r
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    R
                                    r
                                 
                              
                              ,
                           
                        
                      with 
                        
                           
                              R
                              1
                           
                           ⊆
                           
                              V
                              1
                           
                           ,
                           …
                           
                           ,
                           
                              R
                              k
                           
                           ⊆
                           
                              V
                              k
                           
                        
                     . The MUFLP can now be stated as the problem of selecting a set of paths S ⊆ P and a set of nodes R ⊆ V such that z(S, R) is maximum, i.e.,

                        
                           (2)
                           
                              
                                 
                                    max
                                    
                                       (
                                       S
                                       ,
                                       R
                                       )
                                       ⊆
                                       N
                                    
                                 
                                 
                                 
                                    {
                                    z
                                    
                                       (
                                       S
                                       ,
                                       R
                                       )
                                    
                                    :
                                    
                                       N
                                       r
                                    
                                    
                                       (
                                       S
                                       )
                                    
                                    =
                                    
                                       R
                                       r
                                    
                                    ,
                                    
                                    
                                    for
                                    
                                    r
                                    =
                                    1
                                    ,
                                    …
                                    
                                    ,
                                    k
                                    }
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           
                              N
                              r
                           
                           
                              (
                              S
                              )
                           
                           =
                           
                              {
                              j
                              ∈
                              
                                 V
                                 r
                              
                              :
                              j
                              
                              is
                              
                              a
                              
                              vertex
                              
                              of
                              
                              some
                              
                              path
                              
                              p
                              ∈
                              S
                              }
                           
                        
                     . Observe that the constraints of (2) state that for each edge 
                        
                           e
                           =
                           (
                           j
                           ,
                           k
                           )
                        
                      formed from a path p ∈ S, the corresponding facilities 
                        
                           j
                           ∈
                           
                              V
                              
                                 i
                                 −
                                 1
                              
                           
                        
                      and k ∈ Vi
                      must be open.

Before proving the submodularity of z(S, R), we recall some results on submodular and nondecreasing set functions (see, Nemhauser et al., 1978).

                        Lemma 1
                        
                           Let dj be the weight of j ∈ N. Then, the linear set function
                           
                              
                                 f
                                 
                                    (
                                    S
                                    )
                                 
                                 =
                                 −
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       S
                                    
                                 
                                 
                                    d
                                    j
                                 
                              
                            
                           is submodular.
                        


                           A positive linear combination of submodular functions is submodular.
                        

Using Lemmas 1 and 2 we can now prove that the objective function of the alternative combinatorial representation for the MUFLP satisfies submodularity.

                        Proposition 1
                        
                           
                              
                                 (a)
                                 
                                    
                                       
                                          c
                                          
                                             (
                                             S
                                             ,
                                             R
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             c
                                             i
                                          
                                          
                                             (
                                             S
                                             ,
                                             R
                                             )
                                          
                                       
                                     
                                    is submodular and nondecreasing.
                                 


                                    
                                       
                                          z
                                          (
                                          S
                                          ,
                                          R
                                          )
                                          =
                                          c
                                          (
                                          S
                                          ,
                                          R
                                          )
                                          +
                                          f
                                          (
                                          S
                                          ,
                                          R
                                          )
                                       
                                     
                                    is submodular.
                                 


                           
                              
                                 (a)
                                 Let (S, R) ⊆ (T, Q) ⊆ N, with S ⊆ T ⊆ P and R ⊆ Q ⊆ V, and 
                                       
                                          q
                                          =
                                          (
                                          
                                             q
                                             1
                                          
                                          ,
                                          
                                             q
                                             2
                                          
                                          ,
                                          …
                                          
                                          ,
                                          
                                             q
                                             k
                                          
                                          )
                                          ∈
                                          P
                                          ∖
                                          T
                                       
                                    . For each i ∈ I, we have

                                       
                                          
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                         
                                                         
                                                         
                                                         
                                                            max
                                                            
                                                               
                                                                  (
                                                                  
                                                                     j
                                                                     1
                                                                  
                                                                  ,
                                                                  …
                                                                  
                                                                  ,
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                                  )
                                                               
                                                               ∈
                                                               S
                                                               ∪
                                                               
                                                                  {
                                                                  q
                                                                  }
                                                               
                                                            
                                                         
                                                         
                                                            c
                                                            
                                                               i
                                                               
                                                                  j
                                                                  1
                                                               
                                                               …
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                         −
                                                         
                                                            max
                                                            
                                                               (
                                                               
                                                                  j
                                                                  1
                                                               
                                                               ,
                                                               …
                                                               
                                                               ,
                                                               
                                                                  j
                                                                  k
                                                               
                                                               )
                                                               ∈
                                                               S
                                                            
                                                         
                                                         
                                                            c
                                                            
                                                               i
                                                               
                                                                  j
                                                                  1
                                                               
                                                               …
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         =
                                                         max
                                                         
                                                            {
                                                            0
                                                            ,
                                                            
                                                               c
                                                               
                                                                  i
                                                                  
                                                                     q
                                                                     1
                                                                  
                                                                  …
                                                                  
                                                                  
                                                                     q
                                                                     k
                                                                  
                                                               
                                                            
                                                            −
                                                            
                                                               max
                                                               
                                                                  (
                                                                  
                                                                     j
                                                                     1
                                                                  
                                                                  ,
                                                                  …
                                                                  
                                                                  ,
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                                  )
                                                                  ∈
                                                                  S
                                                               
                                                            
                                                            
                                                               c
                                                               
                                                                  i
                                                                  
                                                                     j
                                                                     1
                                                                  
                                                                  …
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ≥
                                                         max
                                                         
                                                            {
                                                            0
                                                            ,
                                                            
                                                               c
                                                               
                                                                  i
                                                                  
                                                                     q
                                                                     1
                                                                  
                                                                  …
                                                                  
                                                                     q
                                                                     k
                                                                  
                                                               
                                                            
                                                            −
                                                            
                                                               max
                                                               
                                                                  (
                                                                  
                                                                     j
                                                                     1
                                                                  
                                                                  ,
                                                                  …
                                                                  
                                                                  ,
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                                  )
                                                                  ∈
                                                                  T
                                                               
                                                            
                                                            
                                                               c
                                                               
                                                                  i
                                                                  
                                                                     j
                                                                     1
                                                                  
                                                                  …
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         =
                                                         
                                                            max
                                                            
                                                               
                                                                  (
                                                                  
                                                                     j
                                                                     1
                                                                  
                                                                  ,
                                                                  …
                                                                  
                                                                  ,
                                                                  
                                                                     j
                                                                     k
                                                                  
                                                                  )
                                                               
                                                               ∈
                                                               T
                                                               ∪
                                                               
                                                                  {
                                                                  q
                                                                  }
                                                               
                                                            
                                                         
                                                         
                                                            c
                                                            
                                                               i
                                                               
                                                                  j
                                                                  1
                                                               
                                                               …
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                         −
                                                         
                                                            max
                                                            
                                                               (
                                                               
                                                                  j
                                                                  1
                                                               
                                                               ,
                                                               …
                                                               
                                                               ,
                                                               
                                                                  j
                                                                  k
                                                               
                                                               )
                                                               ∈
                                                               T
                                                            
                                                         
                                                         
                                                            c
                                                            
                                                               i
                                                               
                                                                  j
                                                                  1
                                                               
                                                               …
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    where the inequality follows from 
                                       
                                          
                                             max
                                             
                                                (
                                                
                                                   j
                                                   1
                                                
                                                ,
                                                …
                                                
                                                ,
                                                
                                                   j
                                                   k
                                                
                                                )
                                                ∈
                                                S
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                
                                                   j
                                                   1
                                                
                                                …
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                          ≤
                                          
                                             max
                                             
                                                (
                                                
                                                   j
                                                   1
                                                
                                                ,
                                                …
                                                
                                                ,
                                                
                                                   j
                                                   k
                                                
                                                )
                                                ∈
                                                T
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                
                                                   j
                                                   1
                                                
                                                …
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                    . Summing over i ∈ I and by Lemma 2 we obtain that c(S, R) is submodular. Moreover, given that

                                       
                                          
                                             
                                                
                                                   max
                                                   
                                                      
                                                         (
                                                         
                                                            j
                                                            1
                                                         
                                                         ,
                                                         …
                                                         
                                                         ,
                                                         
                                                            j
                                                            k
                                                         
                                                         )
                                                      
                                                      ∈
                                                      T
                                                      ∪
                                                      
                                                         {
                                                         q
                                                         }
                                                      
                                                   
                                                
                                                
                                                   c
                                                   
                                                      i
                                                      
                                                         j
                                                         1
                                                      
                                                      …
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                −
                                                
                                                   max
                                                   
                                                      (
                                                      
                                                         j
                                                         1
                                                      
                                                      ,
                                                      …
                                                      
                                                      ,
                                                      
                                                         j
                                                         k
                                                      
                                                      )
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   c
                                                   
                                                      i
                                                      
                                                         j
                                                         1
                                                      
                                                      …
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                       
                                    for each T ⊆ P and q ∈ P∖T, c(S, R) is nondecreasing.

The function f(S, R) is submodular as a direct consequence of Lemma 1 and when combined with Lemma 2, the submodularity of z(S, R) follows.□

The above result shows that the MUFLP can be stated as the maximization of a submodular set function subject to a set of constraints that ensure that the set of selected paths S are associated with a set of open facilities R ⊆ V. Observe that these constraints can be easily modeled by using a system of linear equations and thus, problem (2) is a particular case of the more general problem of maximizing a submodular function subject to a linear set of constraints studied by Nemhauser and Wolsey (1981).

To illustrate the structural differences between the vertex and the path-allocation representations of the MUFLP we use the following example introduced in Barros and Labbé (1994). Let 
                        
                           k
                           =
                           2
                           ,
                        
                     
                     
                        
                           I
                           =
                           {
                           1
                           }
                           ,
                        
                     
                     
                        
                           
                              V
                              1
                           
                           =
                           
                              {
                              
                                 1
                                 1
                              
                              ,
                              
                                 2
                                 1
                              
                              }
                           
                           ,
                        
                     
                     
                        
                           
                              V
                              2
                           
                           =
                           
                              {
                              
                                 1
                                 2
                              
                              ,
                              
                                 2
                                 2
                              
                              }
                           
                           ,
                        
                     
                     
                        
                           
                              f
                              j
                           
                           =
                           0
                        
                      for all j ∈ V and the following profit matrix:


                     
                        
                           
                              
                                 c
                              
                              
                                 
                                    1
                                    2
                                 
                              
                              
                                 
                                    2
                                    2
                                 
                              
                           
                           
                              
                                 
                                    1
                                    1
                                 
                              
                              
                                 1
                              
                              
                                 1
                              
                           
                           
                              
                                 
                                    2
                                    1
                                 
                              
                              
                                 100
                              
                              
                                 1
                              
                           
                        
                     
                  

An optimal solution for this two-level instance is obtained when facilities 21 and 12 are open with a total profit of 100. In the case of the set function v(R), note that when 
                        
                           R
                           =
                           {
                           
                              1
                              1
                           
                           ,
                           
                              2
                              2
                           
                           }
                           ,
                        
                     
                     
                        
                           Q
                           =
                           {
                           
                              1
                              1
                           
                           ,
                           
                              1
                              2
                           
                           ,
                           
                              2
                              2
                           
                           }
                           ,
                        
                      and 
                        
                           j
                           =
                           
                              2
                              1
                           
                           ,
                        
                      we have

                        
                           
                              
                                 w
                                 (
                                 R
                                 ∪
                                 {
                                 j
                                 }
                                 )
                                 
                                 −
                                 
                                 w
                                 (
                                 R
                                 )
                                 
                                 =
                                 
                                 1
                                 
                                 −
                                 
                                 1
                                 
                                 =
                                 
                                 0
                                 ≤
                                 99
                                 
                                 =
                                 
                                 100
                                 
                                 −
                                 
                                 1
                                 
                                 =
                                 
                                 w
                                 (
                                 Q
                                 ∪
                                 {
                                 j
                                 }
                                 )
                                 −
                                 w
                                 (
                                 Q
                                 )
                                 .
                              
                           
                        
                     That is, for R ⊂ Q and j ∈ V∖Q, adding j to R does not increase w more than by adding j to Q and thus, the submodularity property is not satisfied by w.


                     Fig. 1 illustrates the vertex representation in which the possible allocations of the customer to facilities are shown for R and Q. In this case, a simple path going from the customer to a second level facility corresponds to an allocation path. The thick lines represent the possible links between the customer and the first level facilities and between the first and second level facilities induced by the set R (thereby, also some of Q since R ⊆ Q). The thin lines represent the additional links induced by the set Q∖R. Fig. 1(a) depicts the available allocation paths associated with the initial sets R and Q. Note that path (1, 11, 12) induced by Q is the only one not contained in the set of paths induced by R. However, from Fig. 1(b) we observe that when the element 21 is added to R and Q (i.e. 21 is open), two new allocation paths become available for Q ∪ {21} but only one of them is available for the set R ∪ {21}. This means that the incremental could be ρe
                     (R) < ρe
                     (Q), because of the additional possible selection that is offered to the set Q ∪ {21}, which is precisely the case of this example.

The above observation motivates the use of the allocation paths as the combinatorial objects in the objective function z(S, R), instead of vertices. This will ensure that when one path q is added to the set S, exactly one allocation path becomes available for both sets, S and T, with S ⊆ T ⊆ P, and therefore,

                        
                           
                              
                                 c
                                 (
                                 S
                                 ∪
                                 {
                                 q
                                 }
                                 )
                                 −
                                 c
                                 (
                                 S
                                 )
                                 ≥
                                 c
                                 (
                                 T
                                 ∪
                                 {
                                 e
                                 }
                                 )
                                 −
                                 c
                                 (
                                 T
                                 )
                                 ≥
                                 0
                                 
                                 
                                 
                                 for
                                 
                                 each
                                 
                                 
                                 q
                                 ∈
                                 P
                                 ∖
                                 T
                                 .
                              
                           
                        
                     
                  

For example, when 
                        
                           S
                           =
                           
                              {
                              (
                              
                                 1
                                 1
                              
                              ,
                              
                                 2
                                 2
                              
                              )
                              }
                           
                           ,
                        
                     
                     
                        
                           T
                           =
                           
                              {
                              
                                 (
                                 
                                    1
                                    1
                                 
                                 ,
                                 
                                    1
                                    2
                                 
                                 )
                              
                              ,
                              
                                 (
                                 
                                    1
                                    1
                                 
                                 ,
                                 
                                    2
                                    2
                                 
                                 )
                              
                              }
                           
                           ,
                        
                     
                     
                        
                           R
                           =
                           {
                           
                              1
                              1
                           
                           ,
                           
                              2
                              2
                           
                           }
                           ,
                        
                     
                     
                        
                           Q
                           =
                           {
                           
                              1
                              1
                           
                           ,
                           
                              1
                              2
                           
                           ,
                           
                              2
                              2
                           
                           }
                           ,
                        
                      and 
                        
                           q
                           =
                           (
                           
                              2
                              1
                           
                           ,
                           
                              1
                              2
                           
                           )
                           ,
                        
                      we have

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          c
                                          (
                                          S
                                          ∪
                                          {
                                          q
                                          }
                                          ,
                                          R
                                          )
                                          −
                                          c
                                          (
                                          S
                                          ,
                                          R
                                          )
                                          =
                                          100
                                          −
                                          1
                                          =
                                          99
                                          ≥
                                          99
                                          =
                                          100
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          c
                                          (
                                          T
                                          ∪
                                          {
                                          j
                                          }
                                          ,
                                          Q
                                          )
                                          −
                                          c
                                          (
                                          T
                                          ,
                                          Q
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

That is, for S ⊂ T and q ∈ P∖T, adding q to S increased c as much as adding q to T.


                     Fig. 2
                      illustrates the path-allocation representation, where the meaning of the thin and thick lines is the same as before but for the corresponding sets S and T in this case. In Fig. 2(a) we have the configuration of possible patterns using the initial sets 
                        
                           S
                           =
                           {
                           
                              (
                              
                                 1
                                 1
                              
                              ,
                              
                                 2
                                 2
                              
                              )
                           
                           }
                        
                      and 
                        
                           T
                           =
                           {
                           
                              (
                              
                                 1
                                 1
                              
                              ,
                              
                                 2
                                 2
                              
                              )
                           
                           ,
                           
                              (
                              
                                 1
                                 1
                              
                              ,
                              
                                 1
                                 2
                              
                              )
                           
                           }
                        
                     . Fig. 2(b) and (c) represent the updated allocation patterns when adding the elements (21, 12) and (21, 22) to both S and T, respectively.

Note that in the vertex representation, when an element is added to the sets R and Q, the change in the objective function can vary abruptly, since opening a new facility implies that we can take any possible combination with the open facilities of another level for the allocation of customers. However, in the path-allocation representation, the change in the objective function when adding an element to S and T is controlled by the fact that only one new possibility of allocation is being offered to the customers, either through S or T.

@&#ACKNOWLEDGMENTS@&#

This research was partly funded by the Canadian Natural Sciences and Engineering Research Council under grants 418609–2012 and 39682–10. This support is gratefully acknowledged. The authors thank three anonymous reviewers for their valuable comments.

@&#REFERENCES@&#

