@&#MAIN-TITLE@&#Lagrangean relaxation of the hull-reformulation of linear generalized disjunctive programs and its use in disjunctive branch and bound

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A Lagrangean relaxation of the hull-reformulation of linear GDPs is presented.


                        
                        
                           
                           The proposed Lagrangean relaxation always yields 0–1 values to the binary variables.


                        
                        
                           
                           The proposed Lagrangean relaxation can be solved by solving many small LPs in parallel.


                        
                        
                           
                           The Lagrangean relaxation is incorporated into a disjunctive branch and bound as primal heuristic.


                        
                        
                           
                           Computational results show that the proposed modified disjunctive branch and bound performs better than other alternatives of the algorithm.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

MILP

Disjunctive programming

GDP

Lagrangean relaxation

@&#ABSTRACT@&#


               
               
                  In this work, we present a Lagrangean relaxation of the hull-reformulation of discrete-continuous optimization problems formulated as linear generalized disjunctive programs (GDP). The proposed Lagrangean relaxation has three important properties. The first property is that it can be applied to any linear GDP. The second property is that the solution to its continuous relaxation always yields 0–1 values for the binary variables of the hull-reformulation. Finally, it is simpler to solve than the continuous relaxation of the hull-reformulation. The proposed Lagrangean relaxation can be used in different GDP solution methods. In this work, we explore its use as primal heuristic to find feasible solutions in a disjunctive branch and bound algorithm. The modified disjunctive branch and bound is tested with several instances with up to 300 variables. The results show that the proposed disjunctive branch and bound performs faster than other versions of the algorithm that do not include this primal heuristic.
               
            

@&#INTRODUCTION@&#

Lagrangean relaxation (or Lagrangean decomposition) of an optimization program is a widely-used and powerful tool to solve problems. The review work by Guignard (2003) discusses how Lagrangean relaxation can be used in different solution methods and applications. Fisher (2004) provides a theoretical background for Lagrangean relaxation of mixed-integer linear programs (MILP). The general idea in the Lagrangean relaxation is to “dualize” some of the constraints in the optimization problem (i.e. remove some constraints from the feasible region of the problem, and penalize the violation of such constraints in the objective function). This approach is particularly useful in problems with complicating constraints. Some of these problems appear in planning (Rong, Lahdelma, & Luh, 2008), scheduling (Terrazas-Moreno, Trotter, & Grossmann, 2011), facility location (Cornuejols, Fisher, & Nemhauser, 1977), and stochastic programming problems (Carøe & Schultz, 1999). In these type of problems, a Lagrangean relaxation is simpler to solve than the original problems.

A particular method that uses Lagrangean relaxation to solve MILPs is the Lagrangean relaxation based branch and bound (Geoffrion, 1974). This method follows the same general idea as the LP based branch and bound, but it solves the Lagrangean relaxation at every node instead of the LP relaxation. This method can be useful in problems in which, by dualizing the complicating constraints, the Lagrangean relaxation is simpler to solve than the LP relaxation. One of the main difficulties in automating this strategy, or any other method that uses Lagrangean relaxation, is identifying the complicating constraints, which can be non-trivial and problem specific. Typically, the modeler needs to identify the problem structure and select the constraints to dualize, or needs to modify the model to allow such a structure (Guignard, 2003).

Linear discrete–continuous optimization problems are typically formulated as MILPs. An alternative framework for modeling these problems is generalized disjunctive programming (GDP) (Raman & Grossmann, 1994). GDP models are used to represent discrete–continuous problems through the use of disjunctions, algebraic equations, and Boolean and continuous variables. Linear GDP problems can be reformulated as mixed-integer linear programs (MILP) and solved with existing MILP solvers. The GDP-to-MILP reformulations are the Big-M (BM) (Wolsey & Nemhauser, 2014), multiple-parameter Big-M (MBM) (Trespalacios & Grossmann, 2015) and Hull reformulation (HR) (Beaumont, 1990; Lee & Grossmann, 2000). The HR reformulations is at least as tight, and typically tighter, than the other two. The downside of the HR is that it yields a larger MILP formulation. Alternatively to the MILP reformulation, GDP problems can be solved with specialized algorithms. In the case of linear GDP problems, the disjunctive branch and bound is a powerful solution method (Beaumont, 1990; Lee & Grossmann, 2000).

In this work we first present a Lagrangean relaxation of the HR for linear GDPs. The proposed Lagrangean relaxation is an MILP, and it has three important characteristics. The first one is that the solution to the continuous relaxation of the proposed Lagrangean relaxation always yields 0–1 values for the binary variables of the HR. The second one is that it is easier to solve than the original problem (i.e. the HR). Furthermore, it is easier to solve than the continuous relaxation of the HR. The third one is that this relaxation can be applied to any linear GDP. This means that there is no need to specify which are the complicating constraints in different problems, so automating a method that uses this Lagrangean relaxation can be achieved.

While there are different methods that can make use of the proposed Lagrangean relaxation, in this work we use it to improve the performance of the disjunctive branch and bound algorithm. In particular, we use it as a primal heuristic in the disjunctive branch and bound. A primal heuristic is a method whose purpose is to find good quality feasible solutions quickly (but does not guarantee that such solution is optimal). In the modified disjunctive branch and bound, we evaluate the Lagrangean relaxation at every node and use its solution as primal heuristic for finding feasible solutions to the problem. The continuous relaxation of the Lagrangean relaxation always provides 0–1 values to the binary variables, so the value of the 0–1 variables is fixed and a small LP is solved in search of feasible solutions. The limitation of the proposed Lagrangean relaxation it that the value of its objective function is not better than the value of the objective function in the LP relaxation.

This paper is organized as follows. Section 2 presents a brief background on Lagrangean relaxation of MILPs, generalized disjunctive programming, and the disjunctive branch and bound. Section 3 presents the proposed Lagrangean relaxation of the HR. This section presents the formulation and main properties. The proposed Lagrangean relaxation is then incorporated into a disjunctive branch and bound, which is presented in Section 4. Section 5 demonstrates the performance of the proposed disjunctive branch and bound in an illustrative example. The performance of the disjunctive branch and bound with the Lagrangean relaxation is evaluated against other versions of the disjunctive branch and bound with several instances with up to 300 variables. The results of these instances are presented in Section 6. Finally the conclusions of the paper are presented in Section 7.

@&#BACKGROUND@&#

In this section we present a brief review of the Lagrangean relaxation of mixed-integer linear programs. In this work, we consider the complicating constraints to be equality constraints. We refer the reader to the work by Guignard (2003) for a comprehensive review and for proofs of the Theorems and relations presented in this section. Throughout the manuscript, for any given optimization problem (Q) we denote v(Q) its optimal value and F(Q) its feasible region.

Without loss of generality, consider the following general mixed-integer linear program:

                           
                              (P)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             A
                                             x
                                             =
                                             b
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             C
                                             x
                                             ≤
                                             d
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             X
                                          
                                       
                                    
                                 
                              
                           
                        where X contains the integrality and sign restrictions on x (e.g. 
                           
                              X
                              =
                              
                                 R
                                 +
                                 
                                    n
                                    −
                                    q
                                 
                              
                              ×
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 q
                              
                           
                        ). Consider that 
                           
                              A
                              x
                              =
                              b
                           
                         are the complicating constraints (i.e. the problem becomes much simpler to solve without them). Let λ be a vector of weights, namely the Lagrange multipliers.

The Lagrangean relaxation of (P) is:

                           
                              (LR1
                                    λ
                                 )
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                             +
                                             
                                                λ
                                                T
                                             
                                             
                                                (
                                                A
                                                x
                                                −
                                                b
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             C
                                             x
                                             ≤
                                             d
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             x
                                             ∈
                                             X
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In (
                           LR1
                              λ
                           
                        ), the complicating constraints (
                           
                              A
                              x
                              =
                              b
                           
                        ) have been “dualized” (i.e. the slacks of the complicating constraints have been added to the objective function, and the complicating constraints dropped from the formulation). Note that if these constraints are inequalities (Ax ≤ b), then the corresponding Lagrange multipliers are non-negative.

It is easy to see that (
                           LR1
                              λ
                           
                        ) is a relaxation of (P), since F(P) ⊆ F(
                           LR1
                              λ
                           
                        ). Therefore, v(
                           LR1
                              λ
                           
                        ) ≤ v(P) in general.

                           Theorem 2.1
                           
                              
                                 
                                    1.
                                    
                                       If x(λ) is an optimal solution of (
                                       
                                          LR1
                                             λ
                                          
                                       
                                       ) for some λ, (
                                       
                                          LR1
                                             λ
                                          
                                       
                                       ) is bounded, and the original problem is feasible, then
                                       
                                          
                                             
                                                c
                                                T
                                             
                                             x
                                             
                                                (
                                                λ
                                                )
                                             
                                             +
                                             
                                                λ
                                                T
                                             
                                             
                                                (
                                                A
                                                x
                                                −
                                                b
                                                )
                                             
                                             ≤
                                             v
                                          
                                       
                                       (
                                       
                                          P
                                       ).
                                    


                                       If in addition x(λ) is feasible for 
                                       
                                          (P)
                                       
                                       , then x(λ) is an optimal solution of 
                                       
                                          (P)
                                       
                                       , and
                                       
                                          
                                             
                                                c
                                                T
                                             
                                             x
                                             
                                                (
                                                λ
                                                )
                                             
                                             =
                                             v
                                          
                                       
                                       (
                                       
                                          P
                                       )


                        Theorem 2.1 states that Lagrangean relaxation always provides a lower bound for the MILP problem. The best possible lower bound that the Lagrangean relaxation provides can be obtained with the following optimization problem:

                           
                              (LD)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   m
                                                   a
                                                   x
                                                
                                                λ
                                             
                                             
                                             v
                                             
                                                (
                                                L
                                                R
                                                
                                                   1
                                                   λ
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Problem (LD) is called the Lagrangean dual of (P) with respect to the complicating constraints 
                           
                              A
                              x
                              =
                              b
                           
                        .

Let (RP) be the continuous relaxation of (P) defined by omitting the integrality requirements in the set X. In general, v(RP) ≤ v(LD). In the particular case in which the Lagrangean dual has the integrality property (i.e. the extreme points of {x|Cx ≤ d} are in X), 
                           
                              v
                              (
                              R
                              P
                              )
                              =
                              v
                              (
                           
                        
                        LD).

In this work, we present a Lagrangean relaxation applicable to the MILP reformulation of problems formulated as GDPs. In the next section, we introduce the GDP formulation and the two main GDP-to-MILP reformulations.

GDP is an alternative framework for modeling discrete–continuous optimization problems. In this section we present the formulation for linear GDPs, as well as the two traditional GDP-to-MILP reformulations: the BM and the HR. For a comprehensive review on formulating GDP problems, as well as the theory for general nonlinear GDPs, we refer the reader to Grossmann and Trespalacios (2013).

The general linear GDP formulation can be represented as follows:

                           
                              (GDP)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             G
                                             x
                                             ≤
                                             g
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ∨
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                            
                                                               k
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                               
                                                                  k
                                                                  i
                                                               
                                                            
                                                            x
                                                            ≤
                                                            
                                                               a
                                                               
                                                                  k
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ⊻
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                Y
                                                
                                                   k
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             Ω
                                             (
                                             Y
                                             )
                                             =
                                             T
                                             r
                                             u
                                             e
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   l
                                                   o
                                                
                                             
                                             ≤
                                             x
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             
                                                R
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             
                                                {
                                                T
                                                r
                                                u
                                                e
                                                ,
                                                F
                                                a
                                                l
                                                s
                                                e
                                                }
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In (GDP), the objective is to minimize a linear function of the continuous variables 
                           
                              x
                              ∈
                              
                                 R
                                 n
                              
                           
                        . The global constraints of the problem (Gx ≤ g) are enforced regardless of the discrete decisions. In (GDP) there is a set of disjunctions k ∈ K. Each disjunction involves |Dk
                        | disjunctive terms that are connected by an “or” operator (∨). Each disjunctive term has an associated polyhedron (Akix ≤ aki
                        ) and Boolean variables (Yki
                        ). Exactly one disjunctive term must be selected in each disjunction, which is enforced by an exclusive OR in the Boolean variables (
                           
                              
                                 ⊻
                                 
                                    i
                                    ∈
                                    
                                       D
                                       k
                                    
                                 
                              
                              
                                 Y
                                 
                                    k
                                    i
                                 
                              
                           
                        ). The constraints corresponding to the selected disjunctive term (
                           
                              
                                 Y
                                 
                                    k
                                    i
                                 
                              
                              =
                              T
                              r
                              u
                              e
                           
                        ) are enforced, while the ones corresponding to non-selected terms (
                           
                              
                                 Y
                                 
                                    k
                                    i
                                 
                              
                              =
                              F
                              a
                              l
                              s
                              e
                           
                        ) are ignored. Notice that the constraints corresponding to the terms in the disjunctions need not be exclusive, the XOR operator is only applied to the Boolean variables (i.e. only one Boolean variable will be True and its corresponding constraints enforced, while the constraints that correspond to a False Boolean variable are ignored). Finally, the equation 
                           
                              Ω
                              (
                              Y
                              )
                              =
                              T
                              r
                              u
                              e
                           
                         represents the logic relations between the Boolean variables.

The (BM) reformulation is as follows:

                           
                              (BM)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             G
                                             x
                                             ≤
                                             g
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                A
                                                
                                                   k
                                                   i
                                                
                                             
                                             x
                                             ≤
                                             
                                                a
                                                
                                                   k
                                                   i
                                                
                                             
                                             +
                                             
                                                M
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             H
                                             y
                                             ≥
                                             h
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   l
                                                   o
                                                
                                             
                                             ≤
                                             x
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             
                                                R
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In (BM), the objective function and global constraints remain unchanged. The Boolean variables Yki
                         are replaced by binary variables with a one-to-one correspondence: 
                           
                              
                                 Y
                                 
                                    k
                                    i
                                 
                              
                              =
                              T
                              r
                              u
                              e
                           
                         is equivalent to 
                           
                              
                                 y
                                 
                                    k
                                    i
                                 
                              
                              =
                              1
                           
                         and 
                           
                              
                                 Y
                                 
                                    k
                                    i
                                 
                              
                              =
                              F
                              a
                              l
                              s
                              e
                           
                         is equivalent to 
                           
                              
                                 y
                                 
                                    k
                                    i
                                 
                              
                              =
                              0
                           
                        . Constraint 
                           
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    
                                       D
                                       k
                                    
                                 
                              
                              
                                 y
                                 
                                    k
                                    i
                                 
                              
                              =
                              1
                           
                         enforces that exactly one disjunctive term is selected per disjunction. When a disjunctive term is selected (
                           
                              
                                 y
                                 
                                    k
                                    i
                                 
                              
                              =
                              1
                           
                        ), the corresponding constraints are enforced (Akix ≤ aki
                        ). When a term is not selected (
                           
                              
                                 y
                                 
                                    k
                                    i
                                 
                              
                              =
                              0
                           
                        ), the corresponding constraints become redundant for a large enough Mki
                         (
                           
                              
                                 A
                                 
                                    k
                                    i
                                 
                              
                              x
                              ≤
                              
                                 a
                                 
                                    k
                                    i
                                 
                              
                              +
                              
                                 M
                                 
                                    k
                                    i
                                 
                              
                           
                        ). The logic constraints 
                           
                              Ω
                              (
                              Y
                              )
                              =
                              T
                              r
                              u
                              e
                           
                         are easily transformed into integer linear constraints (Hy ≥ h) (Grossmann & Trespalacios, 2013; Williams, 2013).

The (HR) formulation is given as follows:

                           
                              (HR)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             G
                                             x
                                             ≤
                                             g
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                A
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                a
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             H
                                             y
                                             ≥
                                             h
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   l
                                                   o
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             
                                                R
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In (HR), the objective function and global constraints remain unchanged, the Boolean variables are replaced by binary variables, and the logic relations transformed into linear constraints. In this reformulation, the continuous variables are disaggregated. The constraint xloyki
                         ≤ νki
                         ≤ xupyki
                         enforces that when a term is selected, the corresponding disaggregated variable must lie within the bounds. When it is not selected, the disaggregated variable becomes zero. The constraint 
                           
                              x
                              =
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    
                                       D
                                       k
                                    
                                 
                              
                              
                                 ν
                                 
                                    k
                                    i
                                 
                              
                           
                         enforces that the variables x take the same value as the disaggregated variables of the active terms. When a term is selected (
                           
                              
                                 y
                                 
                                    k
                                    i
                                 
                              
                              =
                              1
                           
                        ) the constraint is enforced for the disaggregated variable (Akiνki
                         ≤ aki
                        ). When it is not active (
                           
                              
                                 y
                                 
                                    k
                                    i
                                 
                              
                              =
                              0
                           
                        ), the constraint is trivially satisfied (0 ≤ 0). Note that this reformulation for linear GDPs is equivalent to the convex hull representation in disjunctive programming (Balas, 1998).

The (BM) reformulation generates a smaller MILP, while the (HR) provides a formulation that is as tight, and generally tighter (Grossmann & Lee, 2003). Also note that (HR) can be further strengthened with basic steps (Sawaya & Grossmann, 2012).

Note that (GDP) without the logic constraints (
                           
                              Ω
                              (
                              Y
                              )
                              =
                              T
                              r
                              u
                              e
                           
                        ) can be represented in a more compact form as follows:

                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             G
                                             x
                                             ≤
                                             g
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             
                                                P
                                                k
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   l
                                                   o
                                                
                                             
                                             ≤
                                             x
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 P
                                 k
                              
                              =
                              
                                 ∪
                                 
                                    i
                                    ∈
                                    
                                       D
                                       k
                                    
                                 
                              
                              
                                 P
                                 
                                    k
                                    i
                                 
                              
                           
                         and Pki
                         is a polyhedron.

The solution of linear GDPs typically involve reformulating them as MILPs, and then solve them using an LP-based branch and bound method (or one of its variants). Alternatively, the GDPs can be solved by a specialized algorithm: the disjunctive branch and bound.

The idea behind the disjunctive branch and bound (Beaumont, 1990; Lee & Grossmann, 2000) is to branch directly on the disjunctions, while using the continuous relaxation of the BM or HR of the remaining disjunctions. Let (R-BM) and (R-HR) be the continuous relaxation of (BM) and (HR), respectively.

For a node Np
                        , let zp
                         denote the optimal value of (R-BM) or (R-HR) of the corresponding GDPp
                        , and (xp, yp
                        ) its solution. Let L be the set of nodes to be solved, let N
                        0 be the root node, and GDP
                        0 be the original GDP. Let zup
                         be an upper bound for the optimal value of the objective function z
                        *. Also, (
                           
                              G
                              D
                              
                                 P
                                 p
                                 i
                              
                           
                        ) is constructed by setting the constraints corresponding to the disjunctive term i as global, and removing the Boolean variables and constraints corresponding to term 
                           
                              
                                 i
                                 
                                    
                                    ′
                                 
                              
                              ≠
                              i
                              ;
                              
                                 i
                                 
                                    
                                    ′
                                 
                              
                              ∈
                              
                                 D
                                 k
                              
                           
                        . The disjunctive branch and bound is presented in Algorithm 1
                        .

It is easy to see that this algorithm terminates finitely, in the worst case evaluating every possible node. This algorithm can be trivially modified to consider a tolerance for termination ϵ > 0. The HR disjunctive branch and bound makes use of (R-HR) at every node, while the BM disjunctive branch and bound makes use of (R-BM) at every node. It is also possible to have a hybrid disjunctive branch and bound in which some nodes are solved using the BM and others using the HR. It is important to note that, as the disjunctive branch and bound progresses, the GDP problems that correspond to each node become smaller. In particular, the constraints that correspond to the disjunctive terms that were not selected are removed from the problem formulation in the subsequent nodes.

Note that the worst case involves 
                           
                              
                                 ∏
                                 
                                    k
                                    ∈
                                    
                                       D
                                       k
                                    
                                 
                              
                              
                                 |
                                 
                                    D
                                    k
                                 
                                 |
                              
                           
                         leaf nodes (which are all the possible alternatives in the problem), which is fewer than the worst case number of leaf nodes in a binary branch and bound algorithm (bounded by 
                           
                              2
                              
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                                 
                                    (
                                    |
                                 
                                 
                                    D
                                    k
                                 
                                 
                                    |
                                    −
                                    1
                                    )
                                 
                              
                           
                        ) except when 
                           
                              
                                 |
                              
                              
                                 D
                                 k
                              
                              
                                 |
                                 =
                                 2
                                 ,
                                 ∀
                                 k
                                 ∈
                                 K
                              
                           
                         (in which case the maximum number of leave nodes for both algorithms is 2|K|). The worst case for number of evaluated nodes in the disjunctive branch and bound depends on the sequence in which the disjunctions were branched, but it is smaller than the binary branch and bound except when 
                           
                              
                                 |
                              
                              
                                 D
                                 k
                              
                              
                                 |
                                 =
                                 2
                                 ,
                                 ∀
                                 k
                              
                           
                         (in which case it is the same: 
                           
                              
                                 2
                                 
                                    |
                                    K
                                    |
                                    +
                                    1
                                 
                              
                              −
                              1
                           
                        ).

It has been shown that the disjunctive branch and bound has advantages over the binary branch and bound, such as smaller subproblems at each node and the availability to use propositional logic for improved branching (Beaumont, 1990; Hooker, 1994). In this work, we improve the search of feasible solutions in the disjunctive branch and bound by solving a Lagrangean relaxation of the HR at every node.

In this section we present a Lagrangean relaxation of the HR of any linear GDP. This relaxation is easier to solve than the continuous relaxation of the HR. The continuous relaxation of the proposed Lagrangean relaxation can be proved to always yield 0–1 values to the binary variables of the reformulation. We first present the Lagrangean relaxation for the case in which GDP does not involve logic relations, and we then discuss its extension to the case in which it does. We note that these properties can be extended to nonlinear convex GDP. This is achieved by using the theory for convex GDPs by Ruiz and Grossmann (2012), which extends part of the rich theory of disjunctive programming (Balas, 1998) to GDPs with convex constraints.

For given Lagrange multipliers (λkj
                        ), the following Lagrangean relaxation can be applied to the hull-reformulation of any linear GDP:

                           
                              (LHR
                                 
                                    λ
                                 )
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                m
                                                i
                                                n
                                                
                                                
                                                   c
                                                   T
                                                
                                                x
                                                +
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      K
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         J
                                                         k
                                                      
                                                   
                                                
                                                
                                                   λ
                                                   
                                                      k
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      j
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         
                                                            D
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      ν
                                                      j
                                                      
                                                         k
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                G
                                                x
                                                ≤
                                                g
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                   
                                                      k
                                                      i
                                                   
                                                
                                                
                                                   ν
                                                   
                                                      k
                                                      i
                                                   
                                                
                                                ≤
                                                
                                                   a
                                                   
                                                      k
                                                      i
                                                   
                                                
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         D
                                                         k
                                                      
                                                   
                                                
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                   
                                                      l
                                                      o
                                                   
                                                
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                
                                                ≤
                                                
                                                   ν
                                                   
                                                      k
                                                      i
                                                   
                                                
                                                ≤
                                                
                                                   x
                                                   
                                                      u
                                                      p
                                                   
                                                
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                ∈
                                                
                                                   R
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                   
                                                      k
                                                      i
                                                   
                                                
                                                ∈
                                                
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                k
                                                ∈
                                                K
                                                ,
                                                i
                                                ∈
                                                
                                                   D
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Jk
                         is the set of variables that appear in disjunction k.

                           Property 3.1
                           The Lagrangean relaxation (
                                 LHR
                                 
                                    λ
                                 
                              ) can be applied to any linear GDP.


                        Property 3.1 is trivial, since the decomposition is applied to the MILP reformulation of the general form of linear GDP.

Note that in problem (
                           LHR
                           
                              λ
                           
                        ) the variables xj
                         and νki
                         do not appear together in any constraint. Furthermore, variables νki
                         and 
                           
                              ν
                              
                                 
                                    k
                                    
                                       
                                       ′
                                    
                                 
                                 
                                    i
                                    
                                       
                                       ′
                                    
                                 
                              
                           
                         for 
                           
                              
                                 k
                                 
                                    
                                    ′
                                 
                              
                              ≠
                              k
                              ;
                              i
                              ∈
                              
                                 D
                                 k
                              
                              ;
                              
                                 i
                                 
                                    
                                    ′
                                 
                              
                              ∈
                              
                                 D
                                 
                                    k
                                    
                                       
                                       ′
                                    
                                 
                              
                           
                         do not appear together in any constraint either. Therefore, (
                           LHR
                           
                              λ
                           
                        ) can be decomposed into 
                           
                              |
                              K
                              |
                              +
                              1
                           
                         simpler problems.

The first problem, that involves only the continuous variables and global constraints, is as follows:

                           
                              (LHR
                                 0)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   
                                                      J
                                                      k
                                                   
                                                
                                             
                                             
                                                λ
                                                
                                                   k
                                                   j
                                                
                                             
                                             
                                                x
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             G
                                             x
                                             ≤
                                             g
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             
                                                R
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The remaining k ∈ K problems, each one containing the variables νki
                         and yki
                         corresponding to disjunction k, are as follows:

                           
                              (LHRk
                                 )
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   
                                                      J
                                                      k
                                                   
                                                
                                             
                                             
                                                λ
                                                
                                                   k
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         D
                                                         k
                                                      
                                                   
                                                
                                                
                                                   ν
                                                   j
                                                   
                                                      k
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                A
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                a
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   l
                                                   o
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Property 3.2
                           The optimal solution of (
                                 LHR
                                 
                                    λ
                                 
                              ) can be obtained by the summation of the optimal values of 
                                 
                                    |
                                    K
                                    |
                                    +
                                    1
                                 
                               problems: v(
                                 LHR
                                 
                                    λ
                                 
                              
                              
                                 
                                    )
                                    =
                                    v
                                    (
                                 
                              
                              
                                 LHR
                                 0
                              
                              
                                 
                                    
                                       )
                                       +
                                    
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                    
                                       v
                                       (
                                    
                                 
                              
                              
                                 LHRk
                                 
                              ).


                        Property 3.2 indicates that it is possible to solve 
                           
                              |
                              K
                              |
                              +
                              1
                           
                         smaller MILPs to solve (
                           LHR
                           
                              λ
                           
                        ). Furthermore, (
                           LHR
                           
                              λ
                           
                        ) and each of these problems can be solved as an LP, as is shown in Property 3.3.

                           Property 3.3
                           Let 
                                 
                                    (
                                    
                                       x
                                       ^
                                    
                                    ,
                                    
                                       y
                                       ^
                                    
                                    )
                                 
                               be a vertex of the continuous relaxation of (
                                 LHR
                                 
                                    λ
                                 
                              ). Then, for every k ∈ K there exists an i ∈ Dk
                               such that 
                                 
                                    
                                       
                                          y
                                          ^
                                       
                                       k
                                    
                                    =
                                    
                                       e
                                       i
                                    
                                    ,
                                 
                               where ei
                               is the unit vector.

The proof is presented by analyzing the decomposed problem. Problem (
                                 LHR
                                 0
                              ) does not involve any binary variable or disaggregated as a decision variable. In problems (
                                 LHRk
                                 
                              ), only the binary variables yki
                               and the disaggregated variables νki
                              , that correspond to the disjunction (k ∈ Dk
                              ) are optimization variables. From Corollary 2.1.2 of Balas (1998), for any vertex 
                                 
                                    (
                                    
                                       ν
                                       ¯
                                    
                                    ,
                                    
                                       y
                                       ¯
                                    
                                    )
                                 
                               of the feasible region of the continuous relaxation of (
                                 LHRk
                                 
                              ) there exists a 
                                 
                                    
                                       
                                          y
                                          ^
                                       
                                       k
                                    
                                    =
                                    
                                       e
                                       i
                                    
                                 
                              . Therefore, for every k ∈ K the vertices of their corresponding problem have {0, 1} values for yki
                              . Since there are no constraints linking the variables of the feasible region of each of the 
                                 
                                    |
                                    K
                                    |
                                    +
                                    1
                                 
                               problems, then all of the vertices of the feasible region of the continuous relaxation of (
                                 LHR
                                 
                                    λ
                                 
                              ) have {0, 1} values for yki
                              .□

Note that Property 3.3 indicates that every solution of (
                           LHR
                           
                              λ
                           
                        ) yields 0–1 values for the binary variables. One of the main advantages of this property, together with Property 3.2, is that (
                           LHR
                           
                              λ
                           
                        ) can be solved by solving 
                           
                              |
                              K
                              |
                              +
                              1
                           
                         small LPs. The solution of (
                           LHR
                           
                              λ
                           
                        ) can be used as a primal heuristic for finding “good” feasible solutions for (GDP). A limitation of this property is that it indicates that the best possible bound that can be obtained from (
                           LHR
                           
                              λ
                           
                        ) is the same as the optimal value of the continuous relaxation of (HR). The value of the objective function of a Lagrangean relaxation with the integrality property is not better than the value of the objective function of the continuous relaxation. The proof of this can be found in the review work by Guignard (2003).

Note that the dual Lagrange multipliers of this problem correspond to the multipliers of the constraint 
                           
                              x
                              =
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    
                                       D
                                       k
                                    
                                 
                              
                              
                                 ν
                                 
                                    k
                                    i
                                 
                              
                           
                         at the optimal solution of (R-HR). In this case, both the optimal value of the Lagrangean relaxation (LRH) and the continuous relaxation of (HR) are equal to the optimal value of the convexified problem:

                           
                              (2)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             G
                                             x
                                             ≤
                                             g
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             c
                                             o
                                             n
                                             v
                                             (
                                             
                                                P
                                                k
                                             
                                             )
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   l
                                                   o
                                                
                                             
                                             ≤
                                             x
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 P
                                 k
                              
                              =
                              
                                 ∪
                                 
                                    i
                                    ∈
                                    
                                       D
                                       k
                                    
                                 
                              
                              
                                 P
                                 
                                    k
                                    i
                                 
                              
                           
                         and Pki
                         is a polyhedron.

In cases in which there are logic relations between the Boolean variables of the GDP, (
                           LHR
                           
                              λ
                           
                        ) needs to be modified to preserve Properties 3.3 and 3.2. This can be achieved by either introducing additional variables or including the propositional logic in the solution method (Hooker, 1994). Using the propositional logic in the solution method enables a large set of tools that combine logic-based methods with optimization. The work by Hooker (2012) has established important theories and results in this field. However, the scope of this work is to establish the properties of a general Lagrangean relaxation of (HR), as well as the basis for using this relaxation as primal heuristic. For this reason, we will present in this section a modified version of (
                           LHR
                           
                              λ
                           
                        ) by introducing additional variables, and leave the integration of (
                           LHR
                           
                              λ
                           
                        ) with logic-based methods for future work.

Consider the following problem, that is equivalent to (GDP):

                           
                              (3)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             G
                                             x
                                             ≤
                                             g
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ∨
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                            
                                                               k
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                                  ¯
                                                               
                                                               
                                                                  k
                                                                  i
                                                               
                                                            
                                                            =
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                               
                                                                  k
                                                                  i
                                                               
                                                            
                                                            x
                                                            ≤
                                                            
                                                               a
                                                               
                                                                  k
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ⊻
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                Y
                                                
                                                   k
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   k
                                                   i
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             H
                                             
                                                y
                                                ¯
                                             
                                             ≥
                                             h
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   l
                                                   o
                                                
                                             
                                             ≤
                                             x
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             1
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             k
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             
                                                R
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             R
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             
                                                {
                                                T
                                                r
                                                u
                                                e
                                                ,
                                                F
                                                a
                                                l
                                                s
                                                e
                                                }
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that in (3) a continuous variable (
                           
                              0
                              ≤
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    k
                                    i
                                 
                              
                              ≤
                              1
                           
                        ) is introduced. The linear constraints that represent the logic relations are expressed for 
                           
                              y
                              ¯
                           
                        . It is easy to see that (3) is equivalent to (GDP), in the sense that 
                           
                              
                                 Y
                                 
                                    k
                                    i
                                 
                              
                              =
                              T
                              r
                              u
                              e
                           
                         implies 
                           
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    k
                                    i
                                 
                              
                              =
                              1
                              ,
                           
                         and 
                           
                              
                                 Y
                                 
                                    k
                                    i
                                 
                              
                              =
                              F
                              a
                              l
                              s
                              e
                           
                         implies 
                           
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    k
                                    i
                                 
                              
                              =
                              0
                           
                        . Note that (3) also has the structure required: there are no logic relations between Boolean variables, and the global constraints and disjunctive terms involve only continuous variables. It is possible to perform the (HR) reformulation of (3). After a few algebraic substitutions, the HR of (3) is as follows:

                           
                              (4)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                             G
                                             x
                                             ≤
                                             g
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             y
                                             =
                                             
                                                y
                                                ¯
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             x
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                             
                                             
                                             
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                                A
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                a
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             =
                                             1
                                             
                                             
                                             
                                             
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             H
                                             
                                                y
                                                ¯
                                             
                                             ≥
                                             h
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                                x
                                                
                                                   l
                                                   o
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             x
                                             ∈
                                             
                                                R
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             R
                                             
                                             
                                             
                                             
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             
                                             
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For the Lagrange multipliers λ
                        1, λ
                        2, the following Lagrangean relaxation of (4) is obtained:

                           
                              (5)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                c
                                                T
                                             
                                             x
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         J
                                                         k
                                                      
                                                   
                                                
                                                
                                                   λ
                                                   
                                                      k
                                                      j
                                                   
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      j
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         
                                                            D
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      ν
                                                      j
                                                      
                                                         k
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             +
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         D
                                                         k
                                                      
                                                   
                                                
                                                
                                                   λ
                                                   
                                                      k
                                                      i
                                                   
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      y
                                                      
                                                         k
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      
                                                         k
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             G
                                             x
                                             ≤
                                             g
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                A
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                a
                                                
                                                   k
                                                   i
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      D
                                                      k
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             =
                                             1
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             H
                                             
                                                y
                                                ¯
                                             
                                             ≥
                                             h
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   l
                                                   o
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                ν
                                                
                                                   k
                                                   i
                                                
                                             
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             x
                                             ∈
                                             
                                                R
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             R
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   k
                                                   i
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                          
                                       
                                       
                                          
                                             k
                                             ∈
                                             K
                                             ,
                                             i
                                             ∈
                                             
                                                D
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        which decomposes into 
                           
                              |
                              K
                              |
                              +
                              1
                           
                         subproblems (where 
                           
                              H
                              
                                 y
                                 ¯
                              
                              ≥
                              h
                           
                         is a global constraint and appears in (
                           LHR
                           0
                        )).

In some cases, the solution of (
                           LHR
                           
                              λ
                           
                        ) including the logic constraints for the original variables might still yield 0–1 values to the binary variables (e.g. it can still be solved as an LP). However, it might not be possible to decompose (
                           LHR
                           
                              λ
                           
                        ) into smaller LPs (depending on the structure of the logic relations). Different methods could make use of problem (
                           LHR
                           
                              λ
                           
                        ) to solve (GDP). For example, it can be used as primal heuristic in the search of feasible solutions.

The disjunctive branch and bound presented in Section 2.3 can be adapted to incorporate (
                        LHR
                        
                           λ
                        
                     ) as primal heuristic. Before presenting the algorithm, consider the LP subproblem (SP) that results when the value of the Boolean variables (or binary variables in the MILP reformulation) are fixed. Given 
                        
                           y
                           ^
                        
                      such that, for every k ∈ K there is only one i ∈ Dk
                      for which 
                        
                           
                              
                                 y
                                 ^
                              
                              k
                           
                           =
                           
                              e
                              i
                           
                           ,
                        
                      the following (SP) is obtained:

                        
                           (SP)
                           
                              
                                 
                                    
                                    
                                       
                                          m
                                          i
                                          n
                                          
                                          
                                             c
                                             T
                                          
                                          x
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                       
                                    
                                    
                                       
                                          G
                                          x
                                          ≤
                                          g
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             A
                                             
                                                k
                                                i
                                             
                                          
                                          x
                                          ≤
                                          
                                             a
                                             
                                                k
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∀
                                          
                                             
                                                y
                                                ^
                                             
                                             
                                                k
                                                i
                                             
                                          
                                          =
                                          1
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             x
                                             
                                                l
                                                o
                                             
                                          
                                          ≤
                                          x
                                          ≤
                                          
                                             x
                                             
                                                u
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          x
                                          ∈
                                          
                                             R
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In (SP), the constraints corresponding to active disjunctive terms 
                        
                           
                              
                                 y
                                 ^
                              
                              
                                 k
                                 i
                              
                           
                           =
                           1
                        
                      are enforced, while constraints corresponding to non-active terms 
                        
                           
                              
                                 y
                                 ^
                              
                              
                                 k
                                 
                                    i
                                    
                                       
                                       ′
                                    
                                 
                              
                           
                           =
                           0
                        
                      are removed.

The modified algorithm is presented in Algorithm 2
                     .

There are two main differences in the proposed disjunctive branch and bound with respect to the one presented in Section 2.3. The first in obtaining 
                        
                           λ
                           
                              k
                              j
                           
                           p
                        
                      (6–9) and the second is the inclusion of the primal heuristic (16–22).

The first difference is the update of the Lagrange multipliers. Note that this implies that for the particular node in which the (R-HR) was solved, (
                        LHR
                        
                           λ
                        
                     ) is in fact the Lagrangean dual of the HR of GDPp
                     . It is important (while not required) to use (R-HR) at the root node, so the Lagrange multipliers are initialized with the Lagrangean dual of the HR of the original GDP. In subsequent nodes, it may or may not be useful to solve the larger HR reformulation in order to obtain better lower bounds and updated Lagrange multipliers.

The second difference is the primal heuristic, which is optional. In the primal heuristic, (
                        LHR
                        
                           λ
                        
                     ) is solved to obtain integer solutions. The discrete solution is fixed and a small LP is solved (which corresponds to the original GDP with fixed decisions). If the LP is feasible, it provides a valid upper bound and feasible solution. Note that if (R-HR) was selected (
                        LHR
                        
                           λ
                        
                     ) is in fact the Lagrangean dual. Otherwise, it is a Lagrangean relaxation that uses the Lagrange multipliers inherited from the parent node. Also note that if (R-BM) was selected, it is possible that 
                        
                           
                              
                                 z
                                 ^
                              
                              p
                           
                           ≥
                           
                              z
                              p
                           
                        
                      (e.g. the Lagrangean relaxation of the HR provides better bound than the continuous relaxation of the BM). For this reason, 
                        
                           
                              z
                              p
                           
                           =
                           m
                           a
                           x
                           
                              {
                              
                                 z
                                 p
                              
                              ,
                              
                                 
                                    z
                                    ^
                                 
                                 p
                              
                              }
                           
                        
                     .

Same as the disjunctive branch and bound presented in Section 2.3, this algorithm converges in a finite number of iterations. In the worst case, evaluating every single resulting node of the search tree.

In this section, we present a simple example and the application of the proposed disjunctive branch and bound to solve it. Consider the following analytical example:

                        
                           (6)
                           
                              
                                 
                                    
                                    
                                       
                                          m
                                          i
                                          n
                                          
                                          7
                                          
                                             x
                                             1
                                          
                                          −
                                          2
                                          
                                             x
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      Y
                                                      11
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0.9487
                                                      
                                                         x
                                                         1
                                                      
                                                      +
                                                      0.3162
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      11.3842
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      0.5145
                                                      
                                                         x
                                                         1
                                                      
                                                      −
                                                      0.8575
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      −
                                                      10.2899
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      9
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ∨
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         12
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.9615
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.2747
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         5.7691
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.6247
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.7809
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         0.4685
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.7071
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.7071
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         4.2426
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ∨
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         13
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.8944
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.4472
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         6.2610
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.9864
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.1644
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         0.3288
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.5547
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.8321
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         2.7735
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      Y
                                                      21
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0.9806
                                                      
                                                         x
                                                         1
                                                      
                                                      −
                                                      0.1961
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      2.1573
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      0.6
                                                      
                                                         x
                                                         1
                                                      
                                                      +
                                                      0.8
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      4.8
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      0.5547
                                                      
                                                         x
                                                         1
                                                      
                                                      −
                                                      0.8321
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      −
                                                      4.9923
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ∨
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         22
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.9806
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.1961
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         7.2563
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.9487
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.3162
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         3.4785
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.3162
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.9487
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         0.3162
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ∨
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         23
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            1
                                                         
                                                         ≤
                                                         10
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.3162
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.9487
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         6.3246
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.5547
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.8321
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         11.3714
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      Y
                                                      31
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         1
                                                      
                                                      ≤
                                                      6
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      0.3714
                                                      
                                                         x
                                                         1
                                                      
                                                      −
                                                      0.9285
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      −
                                                      3.1568
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      
                                                         x
                                                         1
                                                      
                                                      ≤
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      6
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          ∨
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         32
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.7071
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.7071
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         10.6066
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.3162
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.9487
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         7.9057
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.4472
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.8944
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         6.7082
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             ⊻
                                             
                                                i
                                                ∈
                                                
                                                   D
                                                   k
                                                
                                             
                                          
                                          
                                             Y
                                             
                                                k
                                                i
                                             
                                          
                                          ;
                                          
                                          k
                                          ∈
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             x
                                             1
                                          
                                          ,
                                          
                                             x
                                             2
                                          
                                          ≤
                                          10
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             Y
                                             
                                                k
                                                i
                                             
                                          
                                          ∈
                                          
                                             {
                                             T
                                             r
                                             u
                                             e
                                             ,
                                             F
                                             a
                                             l
                                             s
                                             e
                                             }
                                          
                                          ;
                                          
                                          k
                                          ∈
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                          ,
                                          i
                                          ∈
                                          
                                             D
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The feasible region of problem (6) is shown in Fig. 1
                     . Fig. 1a shows the feasible region of each disjunction, projected onto the space of the continuous variables. Fig. 1b shows the optimal solution to problem (6) in the projection onto the continuous variables.

The application of the proposed disjunctive branch and bound to (6) is as follows:


                     Initialize. Set 
                        
                           L
                           =
                           
                              N
                              0
                           
                           ,
                        
                     
                     
                        
                           
                              z
                              
                                 u
                                 p
                              
                           
                           =
                           ∞
                           ,
                        
                     
                     
                        
                           (
                           
                              x
                              *
                           
                           ,
                           
                              y
                              *
                           
                           )
                           =
                           ∅
                        
                     . Initialize 
                        
                           
                              λ
                              
                                 k
                                 j
                              
                              0
                           
                           =
                           0
                        
                     .


                     Terminate.
                     
                        
                           L
                           =
                           
                              N
                              0
                           
                        
                     .


                     Node selection. Choose node N
                     0 and delete it from L.


                     Bound. The solution of the (R-HR) of GDP
                     0 (which corresponds to N
                     0) yields the following values:

Continuous variables and objective function 
                        
                           
                              (
                              
                                 x
                                 1
                                 0
                              
                              ,
                              
                                 x
                                 2
                                 0
                              
                              ,
                              
                                 z
                                 0
                              
                              )
                           
                           =
                           
                              (
                              1.5
                              ,
                              7.1
                              ,
                              −
                              3.6
                              )
                           
                        
                      (Point A in Fig. 1b).

Binary variables 
                        
                           
                              y
                              
                                 13
                              
                              0
                           
                           =
                           
                              y
                              
                                 21
                              
                              0
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           
                              y
                              
                                 11
                              
                              0
                           
                           =
                           
                              y
                              
                                 12
                              
                              0
                           
                           =
                           
                              y
                              
                                 22
                              
                              0
                           
                           =
                           
                              y
                              
                                 23
                              
                              0
                           
                           =
                           0
                           ,
                        
                      and 
                        
                           
                              y
                              
                                 31
                              
                              0
                           
                           =
                           0.43
                           ,
                           
                              y
                              
                                 32
                              
                              0
                           
                           =
                           0.57
                        
                     
                  

Lagrange multipliers 
                        
                           
                              λ
                              
                                 k
                                 j
                              
                              0
                           
                           =
                           
                              (
                              −
                              6.286
                              ,
                              1.048
                              ,
                              −
                              0.714
                              ,
                              0.952
                              ,
                              0
                              ,
                              0
                              )
                           
                        
                      (i.e. Lagrange multipliers corresponding to the constraints 
                        
                           
                              x
                              j
                           
                           =
                           
                              ∑
                              
                                 i
                                 ∈
                                 
                                    D
                                    k
                                 
                              
                           
                           
                              ν
                              
                                 k
                                 i
                              
                           
                           ;
                           
                           k
                           ∈
                           K
                           ;
                           j
                           ∈
                           
                              J
                              k
                           
                        
                      in (R-HR)).


                     Prune. Since z
                     0 < zup
                      and 
                        
                           
                              y
                              0
                           
                           ∉
                           
                              Z
                              q
                           
                        
                     .


                     Primal heuristic (optional). The solution of (
                        LHR
                        
                           λ
                        
                     ) of GDP
                     0 with 
                        
                           λ
                           
                              k
                              j
                           
                           0
                        
                      yields: 
                        
                           
                              
                                 z
                                 ^
                              
                              0
                           
                           =
                           −
                           3.6
                           ,
                        
                     
                     
                        
                           
                              
                                 y
                                 ^
                              
                              
                                 13
                              
                              0
                           
                           =
                           
                              
                                 y
                                 ^
                              
                              
                                 21
                              
                              0
                           
                           =
                           
                              
                                 y
                                 ^
                              
                              
                                 32
                              
                              0
                           
                           =
                           1
                        
                      (Point B in Fig. 1b).

The solution (SP) with fixed 
                        
                           
                              y
                              ^
                           
                           0
                        
                      is feasible and it yields the following values:

Continuous variables and objective function 
                        
                           
                              (
                              
                                 
                                    x
                                    ¯
                                 
                                 1
                                 0
                              
                              ,
                              
                                 
                                    x
                                    ¯
                                 
                                 2
                                 0
                              
                              ,
                              
                                 
                                    z
                                    ¯
                                 
                                 0
                              
                              )
                           
                           =
                           
                              (
                              2.15
                              ,
                              7.62
                              ,
                              −
                              0.154
                              )
                           
                        
                     .

Note that this solution indicates that even at the root node, it is possible to obtain a feasible solution. In this case, we update the best known solution: 
                        
                           
                              z
                              
                                 u
                                 p
                              
                           
                           =
                           −
                           0.154
                           ,
                        
                     
                     
                        
                           
                              (
                              
                                 x
                                 *
                              
                              ,
                              
                                 y
                                 *
                              
                              )
                           
                           =
                           
                              (
                              
                                 
                                    x
                                    ¯
                                 
                                 0
                              
                              ,
                              
                                 
                                    y
                                    ^
                                 
                                 0
                              
                              )
                           
                        
                     
                  


                     Branch. Select 
                        
                           k
                           =
                           3
                        
                      for branching. Since 
                        
                           
                              |
                           
                           
                              D
                              3
                           
                           
                              |
                              =
                              2
                              ,
                           
                        
                      two new nodes are created: 
                        
                           L
                           D
                           G
                           
                              P
                              0
                              1
                           
                           ,
                           L
                           D
                           G
                           
                              P
                              0
                              2
                           
                        
                     . 
                        
                           L
                           D
                           G
                           
                              P
                              0
                              1
                           
                        
                      is as follows:

                        
                           (7)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          m
                                          i
                                          n
                                          
                                          7
                                          
                                             x
                                             1
                                          
                                          −
                                          2
                                          
                                             x
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                       
                                    
                                    
                                       
                                          
                                             x
                                             1
                                          
                                          ≤
                                          6
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          0.3714
                                          
                                             x
                                             1
                                          
                                          −
                                          0.9285
                                          
                                             x
                                             2
                                          
                                          ≤
                                          −
                                          3.1568
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             x
                                             1
                                          
                                          ≤
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             x
                                             2
                                          
                                          ≤
                                          6
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      Y
                                                      11
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0.9487
                                                      
                                                         x
                                                         1
                                                      
                                                      +
                                                      0.3162
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      11.3842
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      0.5145
                                                      
                                                         x
                                                         1
                                                      
                                                      −
                                                      0.8575
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      −
                                                      10.2899
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      9
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ∨
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         12
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.9615
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.2747
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         5.7691
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.6247
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.7809
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         0.4685
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.7071
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.7071
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         4.2426
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ∨
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         13
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.8944
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.4472
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         6.2610
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.9864
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.1644
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         0.3288
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.5547
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.8321
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         2.7735
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      Y
                                                      21
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0.9806
                                                      
                                                         x
                                                         1
                                                      
                                                      −
                                                      0.1961
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      2.1573
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      0.6
                                                      
                                                         x
                                                         1
                                                      
                                                      +
                                                      0.8
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      4.8
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      0.5547
                                                      
                                                         x
                                                         1
                                                      
                                                      −
                                                      0.8321
                                                      
                                                         x
                                                         2
                                                      
                                                      ≤
                                                      −
                                                      4.9923
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ∨
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         22
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.9806
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.1961
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         7.2563
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.9487
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.3162
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         3.4785
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0.3162
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.9487
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         0.3162
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          ∨
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         23
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            1
                                                         
                                                         ≤
                                                         10
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.3162
                                                         
                                                            x
                                                            1
                                                         
                                                         +
                                                         0.9487
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         6.3246
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         0.5547
                                                         
                                                            x
                                                            1
                                                         
                                                         −
                                                         0.8321
                                                         
                                                            x
                                                            2
                                                         
                                                         ≤
                                                         −
                                                         11.3714
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             ⊻
                                             
                                                i
                                                ∈
                                                
                                                   D
                                                   k
                                                
                                             
                                          
                                          
                                             Y
                                             
                                                k
                                                i
                                             
                                          
                                          ;
                                          
                                          k
                                          ∈
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             x
                                             1
                                          
                                          ,
                                          
                                             x
                                             2
                                          
                                          ≤
                                          10
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             Y
                                             
                                                k
                                                i
                                             
                                          
                                          ∈
                                          
                                             {
                                             T
                                             r
                                             u
                                             e
                                             ,
                                             F
                                             a
                                             l
                                             s
                                             e
                                             }
                                          
                                          ;
                                          
                                          k
                                          ∈
                                          
                                             {
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                          ,
                                          i
                                          ∈
                                          
                                             D
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Note that in (7), the constraints corresponding to 
                        
                           
                              Y
                              31
                           
                           =
                           T
                           r
                           u
                           e
                        
                      are included as global constraints, while constraints corresponding to 
                        
                           
                              Y
                              32
                           
                           =
                           T
                           r
                           u
                           e
                        
                      are removed from the formulation. 
                        
                           L
                           D
                           G
                           
                              P
                              0
                              2
                           
                        
                      can be constructed in the same manner, but including as global constraints the ones corresponding to 
                        
                           
                              Y
                              32
                           
                           =
                           T
                           r
                           u
                           e
                        
                      while removing the constraints corresponding to 
                        
                           
                              Y
                              31
                           
                           =
                           T
                           r
                           u
                           e
                        
                     . For simplicity, 
                        
                           p
                           =
                           1
                        
                      is assigned to 
                        
                           L
                           D
                           G
                           
                              P
                              0
                              1
                           
                           ,
                        
                      and 
                        
                           p
                           =
                           2
                        
                      to 
                        
                           L
                           D
                           G
                           
                              P
                              0
                              2
                           
                        
                     . Two new nodes are added L: 
                        
                           L
                           =
                           {
                           
                              N
                              1
                           
                           ,
                           
                              N
                              2
                           
                           }
                        
                      (corresponding to 
                        
                           p
                           =
                           1
                           ,
                           2
                        
                     ). The Lagrange multipliers of the new nodes are initialized using 
                        
                           λ
                           
                              k
                              j
                           
                           0
                        
                      from the parent node: 
                        
                           
                              λ
                              
                                 k
                                 j
                              
                              1
                           
                           =
                           
                              λ
                              
                                 k
                                 j
                              
                              2
                           
                           =
                           
                              (
                              −
                              6.286
                              ,
                              1.048
                              ,
                              −
                              0.714
                              ,
                              0.952
                              ,
                              0
                              ,
                              0
                              )
                           
                        
                     .

In the second iteration, the following results are obtained for the node N
                     1 using (R-HR):

(R-HR): 
                        
                           
                              (
                              
                                 z
                                 1
                              
                              ,
                              
                                 x
                                 1
                                 1
                              
                              ,
                              
                                 x
                                 2
                                 1
                              
                              ,
                              
                                 y
                                 
                                    11
                                 
                                 1
                              
                              ,
                              
                                 y
                                 
                                    12
                                 
                                 1
                              
                              ,
                              
                                 y
                                 
                                    13
                                 
                                 1
                              
                              ,
                              
                                 y
                                 
                                    21
                                 
                                 1
                              
                              ,
                              
                                 y
                                 
                                    22
                                 
                                 1
                              
                              ,
                              
                                 y
                                 
                                    23
                                 
                                 1
                              
                              )
                           
                           =
                           
                              (
                              −
                              2.67
                              ,
                              1.33
                              ,
                              6
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              0.852
                              ,
                              0.025
                              ,
                              0.123
                              )
                           
                        
                     
                  

(
                        LHR
                        
                           λ
                        
                     ): 
                        
                           
                              (
                              
                                 
                                    z
                                    ^
                                 
                                 1
                              
                              ,
                              
                                 
                                    y
                                    ^
                                 
                                 
                                    11
                                 
                                 1
                              
                              ,
                              
                                 
                                    y
                                    ^
                                 
                                 
                                    12
                                 
                                 1
                              
                              ,
                              
                                 
                                    y
                                    ^
                                 
                                 
                                    13
                                 
                                 1
                              
                              ,
                              
                                 
                                    y
                                    ^
                                 
                                 
                                    21
                                 
                                 1
                              
                              ,
                              
                                 
                                    y
                                    ^
                                 
                                 
                                    22
                                 
                                 1
                              
                              ,
                              
                                 
                                    y
                                    ^
                                 
                                 
                                    23
                                 
                                 1
                              
                              )
                           
                           =
                           
                              (
                              −
                              2.67
                              ,
                              1.33
                              ,
                              6.0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              )
                           
                        
                     
                  


                     (SP): 
                        
                           
                              (
                              
                                 
                                    z
                                    ¯
                                 
                                 1
                              
                              ,
                              
                                 
                                    x
                                    ¯
                                 
                                 1
                                 1
                              
                              ,
                              
                                 
                                    x
                                    ¯
                                 
                                 2
                                 1
                              
                              )
                           
                           =
                           
                              (
                              −
                              2.67
                              ,
                              1.33
                              ,
                              6
                              )
                           
                        
                      (Point C in Fig. 1b).

Note that the solution obtained by (R-HR) is optimal in the continuous variables. However, it did not yield 0–1 values to 
                        
                           (
                           
                              y
                              
                                 21
                              
                              1
                           
                           ,
                           
                              y
                              
                                 22
                              
                              1
                           
                           ,
                           
                              y
                              
                                 23
                              
                              1
                           
                           )
                        
                     . After solving (
                        LHR
                        
                           λ
                        
                     ), the best known solution is updated: 
                        
                           
                              z
                              
                                 u
                                 p
                              
                           
                           =
                           −
                           2.67
                           ,
                        
                     
                     
                        
                           
                              (
                              
                                 x
                                 *
                              
                              ,
                              
                                 y
                                 *
                              
                              )
                           
                           =
                           
                              (
                              
                                 
                                    x
                                    ¯
                                 
                                 0
                              
                              ,
                              
                                 
                                    y
                                    ^
                                 
                                 0
                              
                              )
                           
                        
                     . The node can be pruned since 
                        
                           
                              z
                              1
                           
                           =
                           
                              z
                              
                                 u
                                 p
                              
                           
                        
                     .

Node N
                     2 yields an integer solution with 
                        
                           
                              z
                              2
                           
                           =
                           −
                           0.154
                        
                      and it can be pruned. After evaluating N
                     1, N
                     2, all the nodes are pruned (
                        
                           L
                           =
                           ∅
                        
                     ) and the algorithm terminates.


                     Fig. 2
                      shows the disjunctive branch and bound tree for different versions of the algorithm for problem (6). Fig. 2a shows the tree for the proposed algorithm, as described earlier (using (R-HR) in each of the nodes). Fig. 2b presents the tree of the HR disjunctive branch and bound (i.e. the algorithm presented in Section 2.3 using (R-HR) at every node). Finally, Fig. 2b presents the tree of the BM disjunctive branch and bound (i.e. using (R-BM) at every node).

It is easy to see from Fig. 2 that the proposed algorithm requires fewer number of nodes than the other two algorithms (3 in the proposed algorithm, 6 in the HR, and 12 in the BM). Nevertheless, it requires the evaluation of 3 LPs in N
                     0 and in N
                     1, while the BM and HR disjunctive branch and bound require the evaluation of one LP at every node. In this simple example, the solution of every LP takes a fraction of a second. However, in larger problems the difference in solution time among (R-HR), (
                        LHR
                        
                           λ
                        
                     ), (R-BM), and (SP) can be very significant. For example, in instance 11 of Section 6.1 the solution times (using CPLEX 12.6.1 (IBM ILOG CPLEX, 2009)) of (R-HR), (
                        LHR
                        
                           λ
                        
                     ), (R-BM), and (SP) at the root node are 21.5 seconds, 0.7 seconds, 0.2 seconds, 0.1 seconds, respectively. Note that the solution time of (
                        LHR
                        
                           λ
                        
                     ) is about 30 times faster than the solution of (R-HR) ((
                        LHR
                        
                           λ
                        
                     ) is the Lagrangean dual of (R-HR), so they provide the same lower bound). Also, (
                        LHR
                        
                           λ
                        
                     ) was evaluated as a single LP and a single core, so the difference in solution time comes from CPLEX exploiting the structure of (
                        LHR
                        
                           λ
                        
                     ). If (
                        LHR
                        
                           λ
                        
                     ) is solved by solving the smaller LPs in parallel (Property 3.2), the solution time can be further reduced.

@&#RESULTS@&#

In this section, we present the performance of the proposed disjunctive branch and bound against the simple BM and HR disjunctive branch and bound. We also compare against a fourth disjunctive branch and bound with a “random heuristic”. This algorithm is exactly the same as the proposed algorithm, but the primal heuristic is random (i.e. instead of solving (
                        LHR
                        
                           λ
                        
                     ) and fixing 
                        
                           y
                           ^
                        
                      at its solution, 
                        
                           y
                           ^
                        
                      is fixed randomly). This comparison is important to show that (
                        LHR
                        
                           λ
                        
                     ) provides a good primal heuristic for finding feasible solutions, and it is not only the additional work at each node what drives the improvement in the disjunctive branch and bound. The M-parameters of the Big-M reformulation were obtained by using the variable bounds (i.e. for a constraint of the type ax ≤ b the parameter 
                        
                           M
                           =
                           
                              ∑
                              
                                 j
                                 :
                                 
                                    a
                                    j
                                 
                                 ≥
                                 0
                              
                           
                           
                              x
                              
                                 u
                                 p
                              
                           
                           −
                           
                              ∑
                              
                                 j
                                 :
                                 
                                    a
                                    j
                                 
                                 <
                                 0
                              
                           
                           
                              x
                              
                                 l
                                 o
                              
                           
                           −
                           b
                        
                     ).

The results were obtained using an Intel(R) Core(TM) i7 CPU 2.93 gigahertz and 4 gigabyte of RAM. The algorithm was implemented in GAMS 24.4.5 (G. D. Corporation, 2015) using CPLEX 12.6.1 (IBM ILOG CPLEX, 2009). The proposed algorithm uses (R-BM) at every node, except for the root node (i.e. it solves (R-HR) at the root node, initializes the Lagrange multipliers, then solves (R-BM) at every other node without modifying the multipliers). (
                        LHR
                        
                           λ
                        
                     ) is solved as a single LP by CPLEX, but computational experience shows that CPLEX can exploit the decomposable structure of (
                        LHR
                        
                           λ
                        
                     ) (as described in Section 5). The algorithms use a breadth first branching strategy, and at every node select the disjunction with fewest disjunctive terms that yield non-integer variables for branching.

The solution times presented in this section refer to the solve time (i.e. it includes the time to generate the model at every node, but ignores the time to create each node and to decide on branching and pruning). While in most cases the wall time is very close to the solve time, in some instances it is not. The reason for comparing the solve time (vs. wall time) is to consider only the time spent in solving the problem, and ignore inefficiencies in the code (that could be reduced in a lower level programming language or improvements in the branch and bound code).

Note that this implementation of the disjunctive branch and bound algorithm is a prototype, and its purpose is to show the improvement of the basic algorithm when using (
                        LHR
                        
                           λ
                        
                     ) as a primal heuristic. The algorithm is implemented in GAMS, and it has to generate an MILP model at every node of the search tree. Also, it does not include presolve, heuristics or cuts, so it is much slower than CPLEX. Future work includes improvements in the implementation of the algorithm.

The algorithms were tested with 100 instances of 3 problems (i.e. a total of 300 instances). The solution time performance curve over all instances is presented in Fig. 3
                     . Fig. 3 shows the percentage of instance solved vs. time. The figure shows four algorithms: “HR” refers to the HR disjunctive branch and bound, “BM” to the BM one, “ALG” to the proposed modified algorithm, and “RAN” to the algorithm with a random primal heuristic. It can be observed from the figure that the proposed algorithm is considerably better than the rest. The HR branch and bound performs second, but the random heuristic algorithm performs similarly in larger instances. The worst performer is the BM disjunctive branch and bound. Out of the 300 instances, the BM, HR, ALG, and RAN solve 253, 266, 296, and 269 instances, respectively.

While Fig. 3 presents the performance over all instances, the performance varies in the different examples. In the remaining of this section, we present more details and results for each example. We first present random instances for unstructured linear GDP problems. We than present results of two particular GDP problems: the strip packing and the contracts problem. The strip packing problem does not include logic constraints, while the contracts problem does. 100 instances are tested for each of these problems.

For this example, 100 random instance are generated for the unstructured GDP problems without logic relations or global constraints (note that any GDP with global constraints can always be reformulated as a GDP without global constraints by using improper basic steps (Grossmann & Trespalacios, 2013)). The coefficients of aki
                         range between 
                           
                              −
                              1.00
                           
                         and 1.00. The coefficient range of c is 
                           
                              [
                              −
                              10.0
                              ,
                              10.0
                              ]
                           
                        ; of xlo
                         is 
                           
                              [
                              −
                              100
                              ,
                              −
                              10
                              ]
                           
                        ; and of xup
                         is [10, 100]. In order to avoid very high density in the matrices Aki
                        , and to give the problem structure (e.g. to relate more some variables to some disjunctions), the following formula was used to calculate Aki
                        ; k ∈ K, i ∈ Dk
                         (where e ∈ Eki
                         are the constraints in ki and j ∈ Jk
                         are the variables in k ∈ K):


                        
                           
                              
                                 A
                                 
                                    e
                                    j
                                 
                                 
                                    k
                                    i
                                 
                              
                              =
                              A
                              
                                 0
                                 
                                    e
                                    j
                                 
                                 
                                    k
                                    i
                                 
                              
                              
                                 α
                                 
                                    e
                                    j
                                 
                                 
                                    k
                                    i
                                 
                              
                              
                                 β
                                 
                                    e
                                    j
                                 
                                 
                                    k
                                    i
                                 
                              
                           
                        
                     

where,


                        
                           
                              A
                              
                                 0
                                 
                                    e
                                    j
                                 
                                 
                                    k
                                    i
                                 
                              
                           
                         is a random parameter between 
                           
                              −
                              1.00
                           
                         and 1.00.


                        
                           
                              α
                              
                                 e
                                 j
                              
                              
                                 k
                                 i
                              
                           
                         is the probability of a variable appearing in an equation. (in all tested instances 
                           
                              
                                 α
                                 
                                    e
                                    j
                                 
                                 
                                    k
                                    i
                                 
                              
                              =
                              0.5
                           
                        ).


                        
                           
                              
                                 β
                                 
                                    e
                                    j
                                 
                                 
                                    k
                                    i
                                 
                              
                              
                                 =
                                 r
                                 o
                                 u
                                 n
                                 d
                                 (
                                 r
                                 a
                                 n
                                 d
                              
                           
                        -
                           
                              b
                              e
                              t
                              w
                              e
                              e
                              n
                              (
                              0
                              ,
                              1
                              −
                              |
                              (
                              j
                              −
                              k
                              *
                              |
                              J
                              |
                              /
                              |
                              K
                              |
                              )
                              /
                              |
                              J
                              ∥
                              )
                              )
                           
                        .

To illustrate the idea behind the generation of Aki
                        , consider a problem with 40 variables, 10 disjunctions, 20 disjunctive terms per disjunction, and a maximum of 30 constraints per disjunctive term. In disjunction 
                           
                              k
                              =
                              1
                              ,
                           
                         the probability of variable 
                           
                              j
                              =
                              1
                           
                         appearing in any constraint of any disjunctive term is 
                           
                              
                                 α
                                 
                                    e
                                    ,
                                    1
                                 
                                 
                                    1
                                    ,
                                    i
                                 
                              
                              
                                 β
                                 
                                    e
                                    ,
                                    1
                                 
                                 
                                    1
                                    ,
                                    i
                                 
                              
                           
                        . Since 
                           
                              
                                 β
                                 
                                    e
                                    ,
                                    1
                                 
                                 
                                    1
                                    ,
                                    i
                                 
                              
                              
                                 =
                                 r
                                 o
                                 u
                                 n
                                 d
                                 (
                                 r
                                 a
                                 n
                                 d
                              
                           
                        -between(0, 0.925)), the probability is 
                           
                              
                                 α
                                 
                                    e
                                    ,
                                    1
                                 
                                 
                                    1
                                    ,
                                    i
                                 
                              
                              
                                 β
                                 
                                    e
                                    ,
                                    1
                                 
                                 
                                    1
                                    ,
                                    i
                                 
                              
                              =
                              
                                 (
                                 0.5
                                 )
                              
                              
                                 (
                                 0.46
                                 )
                              
                              =
                              23
                              
                              percent
                           
                        . Note that, since there are up to 30 constraints in each of the 20 disjunctive terms of disjunction 
                           
                              k
                              =
                              1
                              ,
                           
                         there is a very high probability that this variable appears in a constraint of 
                           
                              k
                              =
                              1
                           
                        . For 
                           
                              k
                              =
                              1
                           
                         and 
                           
                              j
                              =
                              20
                              ,
                           
                        
                        
                           
                              
                                 β
                                 
                                    e
                                    ,
                                    20
                                 
                                 
                                    1
                                    ,
                                    i
                                 
                              
                              
                                 =
                                 r
                                 o
                                 u
                                 n
                                 d
                                 (
                                 r
                                 a
                                 n
                                 d
                              
                           
                        -between(0, 0.6)) so the probability of variable 
                           
                              j
                              =
                              20
                           
                         appearing in any constraint of any disjunctive term of 
                           
                              k
                              =
                              1
                           
                         is 8 percent. The probability of variable j > 25 appearing in any constraint of any disjunctive term of 
                           
                              k
                              =
                              1
                           
                         is 0 percent. The probability of variable 
                           
                              j
                              =
                              20
                           
                         appearing in any constraint of any disjunctive term of 
                           
                              k
                              =
                              5
                           
                         is 25 percent.


                        Table 1
                         presents the statistics for the instances that were generated randomly. All infeasible instances were removed from the test set, and all infeasible disjunctive terms were removed from the feasible instances. The number of constraints in a disjunctive term (|Eki
                        |) is random between Emax
                        /5 and Emax
                        . The problem identifier indicates the number of disjunctions |K|, disjunctive terms Dk
                        , and number of continuous variables in the GDP. The table shows the average number of binary variables, as well as the average problem size for the BM and HR. It can be observed from Table 1 that in some of these instances the difference in problem size between the BM and HR is considerable, particularly in the number of variables.


                        Fig. 4
                         shows the performance of the different algorithms for the 100 random instances. Fig. 4a shows that the solution time performance of the proposed and the random algorithms is much better than the traditional BM and HR disjunctive branch and bound for this example. The figure shows that the proposed and random algorithms solve 98 of the instances, while the BM and HR versions can only solve 81 and 72, respectively. Note that in this example, the BM disjunctive branch and bound performs better than the HR. This is because the number of nodes required in the BM and HR disjunctive branch and bound is very similar as can be observed in Fig. 4b. Fig. 4b shows the required number of nodes to solve the 72 instances that all algorithms solved. The figure shows that the proposed algorithm requires the fewest number of nodes. The BM and HR, however, require very similar number of nodes. Considering that the HR generates a much larger MILP (as shown in Table 1), it is expected that the solution time of the BM disjunctive branch and bound is faster than that of the HR.


                        Fig. 5
                         shows the number of nodes required to find the optimal solution and the first feasible solution for the 72 instances that all algorithms solve. While the figure does not show the time to prove optimality, finding a feasible and the optimal solution is an important consideration in practice. It can be observed from the figure that the proposed algorithm is better at finding the optimal solution (Fig. 5a) and the first feasible solution (Fig. 5b). The random heuristic algorithm is very good in this example, requiring a similar number of nodes to find the first and optimal solution as the proposed method. However, the BM and HR versions require many more nodes to find a feasible solution and the optimal solution. The figure shows that there is small difference in the HR and BM disjunctive branch and bound with respect to the number of nodes required to find first and optimal solutions. The small difference seems to indicate that the HR requires fewer nodes to find the optimal solution, while the BM requires fewer to find the first feasible solution.

Note that the proposed algorithm performs better than the other versions of the disjunctive branch and bound for unstructured GDP instances. In the remaining of this section, we present results for two particular GDP problems: strip packing and contracts.

Given set of N rectangles, the strip packing problem consists on placing them on a strip while minimizing its length. The rectangles cannot overlap or be rotated. The height and length of each rectangle is known (Hi, Li
                        ; i ∈ N), and the strip has width W (Sawaya & Grossmann, 2005). Fig. 6
                         illustrates the strip packing problem.

The GDP formulation of this problem is as follows (Sawaya & Grossmann, 2005; Trespalacios & Grossmann, 2016):

                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             l
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             l
                                             t
                                             ≥
                                             
                                                x
                                                i
                                             
                                             +
                                             
                                                L
                                                i
                                             
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                            
                                                               i
                                                               j
                                                            
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               i
                                                            
                                                            +
                                                            
                                                               L
                                                               i
                                                            
                                                            ≤
                                                            
                                                               x
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ∨
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                            
                                                               j
                                                               i
                                                            
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               j
                                                            
                                                            +
                                                            
                                                               L
                                                               j
                                                            
                                                            ≤
                                                            
                                                               x
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ∨
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                            
                                                               i
                                                               j
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                               i
                                                            
                                                            −
                                                            
                                                               H
                                                               i
                                                            
                                                            ≥
                                                            
                                                               y
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ∨
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                            
                                                               j
                                                               i
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                               j
                                                            
                                                            −
                                                            
                                                               H
                                                               j
                                                            
                                                            ≥
                                                            
                                                               y
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             i
                                             ,
                                             j
                                             ∈
                                             N
                                             ,
                                             i
                                             <
                                             j
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Z
                                                
                                                   i
                                                   j
                                                
                                                1
                                             
                                             ⊻
                                             
                                                Z
                                                
                                                   j
                                                   i
                                                
                                                1
                                             
                                             ⊻
                                             
                                                Z
                                                
                                                   i
                                                   j
                                                
                                                2
                                             
                                             ⊻
                                             
                                                Z
                                                
                                                   j
                                                   i
                                                
                                                2
                                             
                                          
                                       
                                       
                                          
                                             i
                                             ,
                                             j
                                             ∈
                                             N
                                             ,
                                             i
                                             <
                                             j
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                x
                                                i
                                             
                                             ≤
                                             U
                                             B
                                             −
                                             
                                                L
                                                i
                                             
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                H
                                                i
                                             
                                             ≤
                                             
                                                y
                                                i
                                             
                                             ≤
                                             W
                                          
                                       
                                       
                                          
                                             i
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Z
                                                
                                                   i
                                                   j
                                                
                                                1
                                             
                                             ,
                                             
                                                Z
                                                
                                                   i
                                                   j
                                                
                                                2
                                             
                                             ∈
                                             
                                                {
                                                T
                                                r
                                                u
                                                e
                                                ,
                                                F
                                                a
                                                l
                                                s
                                                e
                                                }
                                             
                                          
                                       
                                       
                                          
                                             i
                                             ,
                                             j
                                             ∈
                                             N
                                             ,
                                             i
                                             ≠
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In (8), the objective is to minimize the length lt. The coordinates of the upper-left corner of rectangle i are represented with the variables (xi, yi
                        ). The global constraints (
                           
                              l
                              t
                              ≥
                              
                                 x
                                 i
                              
                              +
                              
                                 L
                                 i
                              
                           
                        ) enforce length of the strip corresponds to the largest 
                           
                              
                                 x
                                 i
                              
                              +
                              
                                 L
                                 i
                              
                           
                         (i.e. the coordinate of the top-left corner plus the length of the rectangle). There is a disjunction for every pair of rectangles i, j ∈ N, i < j. Each of the terms of the disjunction represents the relative position of rectangle i with respect to rectangle j. The first term, corresponding to 
                           
                              
                                 Z
                                 
                                    i
                                    j
                                 
                                 1
                              
                              =
                              T
                              r
                              u
                              e
                              ,
                           
                         represents rectangle i to the left of rectangle j. 
                           
                              
                                 Z
                                 
                                    j
                                    i
                                 
                                 1
                              
                              =
                              T
                              r
                              u
                              e
                           
                         represents rectangle i to the right of rectangle j. 
                           
                              
                                 Z
                                 
                                    i
                                    j
                                 
                                 2
                              
                              =
                              T
                              r
                              u
                              e
                           
                         represents rectangle i on top of rectangle j. Finally, 
                           
                              
                                 Z
                                 
                                    j
                                    i
                                 
                                 2
                              
                              =
                              T
                              r
                              u
                              e
                           
                         represents rectangle i below rectangle j. The parameter UB is an upper bound for the strip (e.g. 
                           
                              U
                              B
                              =
                              
                                 ∑
                                 i
                              
                              
                                 L
                                 i
                              
                           
                        ).

The different algorithms were tested on 100 random instances of the strip packing problem. The range of values of the random parameters is as follows: 
                           
                              N
                              =
                              4
                              ,
                              5
                              ;
                              W
                              =
                              5
                           
                        -
                           
                              7
                              ;
                              
                                 L
                                 i
                              
                              =
                              1
                           
                        -
                           
                              10
                              ;
                              
                                 H
                                 i
                              
                              =
                              2
                           
                        -5.


                        Fig. 7
                         a shows that the HR disjunctive branch and bound performs better than the other three for this problem. The BM, random heuristic, and the proposed branch and bound perform similarly in terms of solution time. It is interesting to note that the proposed algorithm performs the third in terms of solution time. However, Fig. 7b shows that the proposed algorithm requires the fewest number of nodes. Because some of the nodes require the evaluation of more than one LP, the fewer number of nodes is not reflected in the solution time for this problem. As expected, the random heuristic and the HR disjunctive branch and bound require fewer nodes than the BM disjunctive branch and bound. The random heuristic algorithm requires similar number of nodes as the HR. However, it requires the evaluation of two LPs in many of the nodes, so the performance in terms of the solution time is worse (as shown in Fig. 7a). The primal heuristic that uses the Lagrangean relaxation requires fewer nodes than the random heuristic, which shows that the former is a better primal heuristic than randomly fixing variables. However, the improvement is small in this example, and hence the time spent in solving the Lagrangean relaxation at every node increases the total solution time. Note that for this problem the performance curves of all algorithms are not very different.


                        Fig. 8
                         shows the performance curve of the number of nodes required to find the optimal solution and to find a feasible solution. Fig. 8a shows that the number of nodes required to find an optimal solution is smaller for the proposed algorithm than for the others. Fig. 8b shows that the first feasible solution can almost always be found at the root node in the proposed and random algorithms. In particular, the proposed algorithm finds the first feasible solution at the root node in 94 instances, and in 4 instances it finds it at the first node. The improvement in finding optimal and feasible solutions can be better appreciated in Table 2
                        . Table 2 shows an average of the metrics presented in Figs. 7 and 8. Note that both algorithms with primal heuristics find the optimal and feasible solutions faster than the BM and HR disjunctive branch and bound. Out of the two algorithms with primal heuristics, the one that uses the Lagrangean relaxation finds the optimal and first feasible solution in fewer nodes.

Given feedstock requirements of a raw material at every time period Dt
                        ; t ∈ T, the problems consists on finding the best purchasing contracts to minimize costs. The inventory of the feedstock st
                         allows to carry material from a time period to the next ones, but there is a cost associated with inventory 
                           
                              α
                              t
                              S
                           
                        . In general, there are three types of contracts: a) the “standard contract” which allows buying any amount of material at a given price γt
                        ; b) the “bulk contract” which provides a discount 
                           
                              β
                              t
                              B
                           
                         of the material, but there is a minimum purchase requirement 
                           
                              F
                              t
                              
                                 B
                                 ,
                                 l
                                 o
                              
                           
                        ; c) the last type of contract requires purchasing materials for the following q ≥ 1 time periods, all of which include the same discount 
                           
                              β
                              
                                 t
                                 q
                              
                              L
                           
                         over the same price γt
                         and the same minimum purchase requirement 
                           
                              F
                              
                                 t
                                 q
                              
                              
                                 L
                                 ,
                                 l
                                 o
                              
                           
                        .

The GDP of the contracts problem is as follows:

                           
                              (9)
                              
                                 
                                    
                                       
                                       
                                          
                                             m
                                             i
                                             n
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                (
                                                
                                                   α
                                                   t
                                                   S
                                                
                                                
                                                   s
                                                   t
                                                
                                                +
                                                
                                                   c
                                                   t
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                          
                                       
                                       
                                          
                                             
                                                f
                                                t
                                             
                                             ≥
                                             
                                                D
                                                t
                                             
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                s
                                                t
                                             
                                             =
                                             
                                                s
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                x
                                                t
                                             
                                             −
                                             
                                                f
                                                t
                                             
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                            t
                                                            S
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                               t
                                                            
                                                            =
                                                            
                                                               γ
                                                               t
                                                            
                                                            
                                                               x
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ∨
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                            t
                                                            B
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                               t
                                                            
                                                            =
                                                            
                                                               (
                                                               1
                                                               −
                                                               
                                                                  β
                                                                  t
                                                                  B
                                                               
                                                               )
                                                            
                                                            
                                                               γ
                                                               t
                                                            
                                                            
                                                               x
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               t
                                                            
                                                            ≥
                                                            
                                                               F
                                                               t
                                                               
                                                                  B
                                                                  ,
                                                                  l
                                                                  o
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             ∨
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ∨
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                            t
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                            ≤
                                                            
                                                               c
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                ∨
                                                
                                                   q
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   |
                                                   T
                                                   |
                                                   −
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         Y
                                                         
                                                            t
                                                            q
                                                         
                                                         L
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               t
                                                               ′
                                                            
                                                         
                                                         =
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  t
                                                                  q
                                                               
                                                               L
                                                            
                                                            )
                                                         
                                                         
                                                            γ
                                                            
                                                               t
                                                               
                                                                  x
                                                                  
                                                                     t
                                                                     ′
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                         
                                                         
                                                            t
                                                            ′
                                                         
                                                         =
                                                         t
                                                         ,
                                                         …
                                                         ,
                                                         t
                                                         +
                                                         q
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            
                                                               t
                                                               ′
                                                            
                                                         
                                                         ≥
                                                         
                                                            F
                                                            
                                                               t
                                                               q
                                                            
                                                            
                                                               L
                                                               ,
                                                               l
                                                               o
                                                            
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                         
                                                            t
                                                            ′
                                                         
                                                         =
                                                         t
                                                         ,
                                                         …
                                                         ,
                                                         t
                                                         +
                                                         q
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Y
                                                t
                                                S
                                             
                                             ⊻
                                             
                                                Y
                                                t
                                                B
                                             
                                             ⊻
                                             
                                                Y
                                                t
                                                0
                                             
                                             
                                                ⊻
                                                
                                                   q
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   |
                                                   T
                                                   |
                                                   −
                                                   t
                                                
                                             
                                             
                                                Y
                                                
                                                   t
                                                   q
                                                
                                                L
                                             
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Y
                                                t
                                                0
                                             
                                             ⇔
                                             
                                                ∨
                                                
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                               ′
                                                            
                                                            <
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            q
                                                            ≥
                                                            t
                                                            −
                                                            
                                                               t
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                Y
                                                
                                                   
                                                      t
                                                      ′
                                                   
                                                   q
                                                
                                                L
                                             
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Y
                                                1
                                                0
                                             
                                             =
                                             F
                                             a
                                             l
                                             s
                                             e
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                x
                                                t
                                             
                                             ≤
                                             
                                                x
                                                
                                                   u
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                c
                                                t
                                             
                                             ≤
                                             
                                                c
                                                
                                                   u
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                s
                                                t
                                             
                                             ≤
                                             
                                                s
                                                
                                                   u
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Y
                                                t
                                                S
                                             
                                             ,
                                             
                                                Y
                                                t
                                                B
                                             
                                             ,
                                             
                                                Y
                                                t
                                                0
                                             
                                             ∈
                                             
                                                {
                                                T
                                                r
                                                u
                                                e
                                                ,
                                                F
                                                a
                                                l
                                                s
                                                e
                                                }
                                             
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                Y
                                                
                                                   t
                                                   q
                                                
                                                L
                                             
                                             ∈
                                             
                                                {
                                                T
                                                r
                                                u
                                                e
                                                ,
                                                F
                                                a
                                                l
                                                s
                                                e
                                                }
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                             1
                                             ≤
                                             q
                                             ≤
                                             
                                                |
                                                T
                                                |
                                             
                                             −
                                             t
                                             ;
                                          
                                       
                                       
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The global constraints in (9) enforce the demand satisfaction (ft
                         ≥ Dt
                        ) and the material balance at the inventory (
                           
                              
                                 s
                                 t
                              
                              =
                              
                                 s
                                 
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 x
                                 t
                              
                              −
                              
                                 f
                                 t
                              
                           
                        ). At each time period t ∈ T there is a disjunction. The term that corresponds to the Boolean variable 
                           
                              Y
                              t
                              S
                           
                         represents the “standard contract”, where any amount xt
                         can be purchased at price γt
                        . 
                           
                              Y
                              t
                              B
                           
                         represents the “bulk contract”, where 
                           
                              
                                 x
                                 t
                              
                              ≥
                              
                                 F
                                 t
                                 
                                    B
                                    ,
                                    l
                                    o
                                 
                              
                           
                         can be purchased with a discount in the price 
                           
                              β
                              t
                              B
                           
                        . 
                           
                              Y
                              t
                              0
                           
                         is active when a long term contract from a previous time period is selected, and such a contract involves time period t
                        
                           
                              (
                              
                                 Y
                                 t
                                 0
                              
                              ⇔
                              ∨
                              
                                 
                                 
                                    
                                       
                                          
                                             
                                                t
                                                ′
                                             
                                             <
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             q
                                             ≥
                                             t
                                             −
                                             
                                                t
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 Y
                                 
                                    
                                       t
                                       ′
                                    
                                    q
                                 
                                 L
                              
                              )
                           
                        . For example, if 
                           
                              Y
                              
                                 1
                                 ,
                                 3
                              
                              L
                           
                         is selected (e.g. in the time period 
                           
                              t
                              =
                              1
                              ,
                           
                         a contract with a length of 
                           
                              q
                              =
                              3
                           
                         time periods was selected), then 
                           
                              
                                 Y
                                 2
                                 0
                              
                              =
                              
                                 Y
                                 3
                                 0
                              
                              =
                              
                                 Y
                                 4
                                 0
                              
                              =
                              T
                              r
                              u
                              e
                           
                        . The term associated with 
                           
                              Y
                              t
                              0
                           
                         does not constrain the variables, since the corresponding cost and purchase bound are determined at the time period in which the long term contract is active 
                           
                              (
                              
                                 c
                                 
                                    t
                                    ′
                                 
                              
                              =
                              
                                 (
                                 1
                                 −
                                 
                                    β
                                    
                                       t
                                       q
                                    
                                    L
                                 
                                 )
                              
                              
                                 γ
                                 t
                              
                              
                                 x
                                 
                                    t
                                    ′
                                 
                              
                              ;
                              
                                 x
                                 
                                    t
                                    ′
                                 
                              
                              ≥
                              
                                 F
                                 
                                    t
                                    q
                                 
                                 
                                    L
                                    ,
                                    l
                                    o
                                 
                              
                              ;
                              
                                 t
                                 ′
                              
                              =
                              t
                              ,
                              …
                              ,
                              t
                              +
                              q
                              )
                           
                        . For the first time period, 
                           
                              Y
                              1
                              0
                           
                         cannot be selected. When performing the BM or HR reformulation, the logic constraint 
                           
                              (
                              
                                 Y
                                 t
                                 0
                              
                              ⇔
                              ∨
                              
                                 
                                 
                                    
                                       
                                          
                                             
                                                t
                                                ′
                                             
                                             <
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             q
                                             ≥
                                             t
                                             −
                                             
                                                t
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 Y
                                 
                                    
                                       t
                                       ′
                                    
                                    q
                                 
                                 L
                              
                              )
                           
                         can be reformulated as 
                           
                              (
                              
                                 y
                                 t
                                 0
                              
                              =
                              
                                 ∑
                                 
                                    
                                       
                                          
                                             
                                                t
                                                ′
                                             
                                             <
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             q
                                             ≥
                                             t
                                             −
                                             
                                                t
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 y
                                 
                                    
                                       t
                                       ′
                                    
                                    q
                                 
                                 L
                              
                              )
                           
                        .

Note that (9) involves logic constraints. Therefore, in order to preserve Properties 3.2 and 3.3, it would be necessary to use (5). However, the continuous relaxation of the HR and BM reformulations of (9) (as well as (
                           LHR
                           
                              λ
                           
                        ) with the logic constraints reformulated for the original binary variables) can be solved in a fraction of a second. Therefore, Property 3.2 (which established that (
                           LHR
                           
                              λ
                           
                        ) can be solved by solving small LPs) does not have an important impact in the solution time of the problem. Furthermore, out of the over 2.2 million nodes solved for the instances of this example, there was not a case in which the continuous relaxation of (
                           LHR
                           
                              λ
                           
                        ) with the logic constraints reformulated for the original variables gave a non-integer solution. While this is no proof that Property 3.3 holds, it indicates that (
                           LHR
                           
                              λ
                           
                        ) with the logic constraints reformulated for the original variables can be used as primal heuristic for the tested instances.

The different algorithms were tested with 100 random instances of the contracts problem. The range of values of the random parameters is as follows: 
                           
                              |
                              T
                              |
                              =
                              9
                           
                        –
                           
                              11
                              ;
                              
                                 D
                                 t
                              
                              =
                              50
                           
                        –
                           
                              100
                              ;
                              
                                 α
                                 t
                                 S
                              
                              =
                              5
                           
                        –
                           
                              20
                              ;
                              
                                 γ
                                 t
                              
                              =
                              10
                           
                        –
                           
                              30
                              ;
                              
                                 β
                                 t
                                 B
                              
                              =
                              0.050
                           
                        –
                           
                              0.500
                              ;
                              
                                 β
                                 
                                    t
                                    q
                                 
                                 L
                              
                              =
                              0.010
                           
                        –
                           
                              0.999
                              ;
                              
                                 F
                                 t
                                 
                                    B
                                    ,
                                    l
                                    o
                                 
                              
                              =
                              50
                           
                        –
                           
                              100
                              ;
                              
                                 F
                                 
                                    t
                                    q
                                 
                                 
                                    L
                                    ,
                                    l
                                    o
                                 
                              
                              =
                              50
                           
                        –100. The algorithm uses (
                           LHR
                           
                              λ
                           
                        ) with the logic constraints reformulated for the original variables as the primal heuristic.


                        Fig. 9
                         presents the performance plots of the algorithms for solving instances of the contracts problem. Fig. 9a shows the performance of the solution times. It can be observed that the HR disjunctive branch and bound performs the best for the smaller problems. However, the proposed algorithm outperforms the HR after about 4000 seconds. Of the 100 instances, the proposed algorithm solves 98, the HR 94, the BM 72, and the random primal heuristic 71. It is clear from Fig. 9a that the BM and primal heuristic algorithms perform much worse than the other two for this problem. Fig. 9b shows the number of nodes required to solve the 71 instances that all algorithms solve. Similar to the solution time, the HR and the proposed algorithm are the best performers. Their performance is close, the HR being better at first and the proposed algorithm taking over in the more difficult problems. In this example, the primal heuristic algorithms performs exactly the same as the BM branch and bound, in terms of number of nodes. This indicates that the random primal heuristic is poor, since it requires additional work and it does not reduce the number of nodes required for the BM disjunctive branch and bound.


                        Fig. 10
                         displays the number of nodes required to find the optimal solution and the first solution. Fig. 10a shows that the proposed algorithm is faster in finding the optimal solution. Furthermore, Fig. 10b shows that the algorithm finds a feasible solution in every instance at the root node. Again, these two figures show that the primal heuristic algorithms performs exactly the same as the BM branch and bound in terms of number of nodes. For this example, the BM and random primal heuristic branch and bound perform much worse than the HR and the proposed algorithm.

@&#CONCLUSIONS@&#

In this work, we have presented a Lagrangean relaxation of the hull-reformulation of linear GDP problems. This Lagrangean relaxation can be applied to any linear GDP. We proved two important properties of this relaxation. The first one is that any vertex of the continuous relaxation of the Lagrangean relaxation yields 0–1 values for the binary variables of the hull reformulation. The second one is that it can be solved with several small LPs (potentially in parallel). This relaxation was incorporated into a disjunctive branch and bound as a primal heuristic, and the proposed algorithm was tested with 300 instances on 3 problems: unstructured GDPs, strip packing and contracts.

For every problem, the number of nodes required by the proposed algorithm is smaller than the number of nodes required by the HR, BM, and “random heuristic” disjunctive branch and bound. Furthermore, the number of nodes to find a feasible and optimal solution to problems is drastically improved when using the Lagrangean relaxation as primal heuristic. Over all the instances, the solution time performance of the proposed algorithm is faster than alternative disjunctive branch and bound methods. Over all the instances, the BM, HR, ALG, and RAN solve 253, 266, 296, and 269, respectively.

In terms of solution time, the proposed algorithm and the heuristic one are the best for the unstructured GDP instances. Their solution time performance curve is better and they solve considerably more instances than the rest within the time limit (98 percent for the proposed and heuristic algorithms vs. 81 percent for the BM, and 72 percent HR). For the two examples of structured GDPs, the performance of the solution time is different for each of the problems. For the strip packing problem, the HR disjunctive branch and bound performs the best, while the proposed algorithm performs third. For the contracts problem, the proposed algorithm performs the best, solving 98 percent of the instances (while the BM, HR, and RAN solve 72 percent, 94 percent, and 71 percent).

Note that instead of using the proposed Lagrangean decomposition approach in Algorithm 2, it is also possible to solve the continuous relaxation of (HR) by Column Generation (CG), where the pricing problems are defined as the sub-problems of the Lagrangean relaxation.

The proposed Lagrangean relaxation can be extended to nonlinear convex GDP problems. Future work will address these problems through the Lagrangean relaxation described in this paper, as well as improvements in the implementation.

@&#ACKNOWLEDGMENTS@&#

The authors would like to acknowledge financial support from the Center for Advanced Process Decision-making (CAPD).

@&#REFERENCES@&#

