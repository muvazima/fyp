@&#MAIN-TITLE@&#Geometric leaf classification

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel system for plant leaf classification is proposed.


                        
                        
                           
                           New and well-known feature extraction and classification methods are both used.


                        
                        
                           
                           The proposed method includes margin descriptors that improve accuracy.


                        
                        
                           
                           Linear Discriminant Classifier is used which is suitable for leaf classification.


                        
                        
                           
                           The proposed system outperforms well-known geometric leaf classification methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Leaf classification

Geometric features

Linear Discriminant Classifier

Multi-scale distance matrix

@&#ABSTRACT@&#


               
               
                  In this paper, we propose a novel method including segmentation, a combination of new and well-known feature extraction and classification methods to classify plant leaves. The aim of the proposed features is to distinguish leaf margins, which cannot be distinguished using commonly used geometric features. Additionally, Linear Discriminant Classifier is used for classification, therefore using features that are noisy for some leaf types does not reduce the performance of the system. The proposed system outperforms the well-known geometric methods that are used for leaf classification.
               
            

@&#INTRODUCTION@&#

Automated plant classification has many application fields [1–7], such that it can be used to identify endangered plant species [8] or used in automation systems that separate undesired plants from a product. Additionally, it may serve as a tool to identify plants [9,6]. Leaf is considered as an important feature of a plant for classification [10].

Geometric features are successfully used in leaf classification in the literature [8,11,12]. Low dimensionality is the major advantage of geometric features. However, geometric features can only describe coarse shape of the leaf such as its similarity to a circle. Using moment invariants and contour-based shape descriptors [13] adds more details to leaf descriptor. However, they cannot distinguish between leaf margin and noise.

There are many different methods in the literature to classify leaves. Authors in [14] propose the use of features extracted from leaf veins and areoles to classify types of legume plants. In this research, three methods, namely support vector machines, penalized discriminant analysis and random forests methods are analyzed. The results demonstrate that random forests method reaches up to 90% accuracy.

Authors in [15] propose two new spline embedding based methods called orthogonal locally discriminant spline embedding (OLDSE-I and OLDSE-II). These methods also employ maximum margin criterion method (MMC) which is used to reduce dimensionality.

In [16], authors propose a novel shape descriptor – Multi-level Curve Segment Measures (MLCSM) – for the purpose of leaf retrieval. MLCSM is rotation and scale invariant shape descriptor that can capture statistical characteristics such as curve bending, convexity and concavity of curve segments. This operation is performed over different curve lengths. The results demonstrated in [16] show that MLCSM has the highest performance and comparable computational complexity.

A method that uses semantic information and active contour segmentation is proposed in [17]. This method proposes polygonal model parameters used for segmentation, base and tip model and curvature scale histogram as features. The authors demonstrated the performance of their systems over Pl@ntLeaves dataset [18]. Another plant identification system called Leafsnap is proposed in [6]. This paper details a complete system from acquisition to presenting the results. However, the speed of this system is a limiting factor as it takes 5.4s for a single leaf classification.

A novel contour-based shape descriptor which is named as Multiscale Distance Matrix (MDM) is proposed in [13]. This method is invariant to rotation, scaling and symmetry changes. Additionally, the authors proposed Maximum Margin Criterion (MMC) method to reduce dimensionality. Finally, Nearest Neighbor Classifier (NNC) is used for classification. Although MDM effectively describes the broad shape of the leaf, it fails to capture the details.

Another method that works on leaf textures is proposed in [2]. In this method, Gabor co-occurrences are used as features. For classification, this method uses KNN with Jeffery-divergence distance measure. The reported results display 85% accuracy on a hand selected leaf texture database containing 32 classes. Performing this algorithm on randomly selected sections of leaves produces 80% accuracy.

An information retrieval method using Inner Distance Shape Context is proposed in [5]. During this research, authors have built a system that allows Smithsonian Institution National Museum of Natural History botanists to catalog and search three new databases.

Authors in [19] propose a method that uses shape and venation features for leaf image retrieval. Minimum Perimeter Polygons (MPP) are used to extract shape features and Nearest Neighbor Classifier is employed for leaf classification. For venation classification, the method extracts several parameters and compares them using ANN. Results are only demonstrated for venation classification which divides leaves into three venation based classes.

A Content-Based Image Retrieval method is proposed for leaves in [20]. This method uses venation information to classify venation pattern of a leaf before performing retrieval using shape information. The authors demonstrate that using venation classification increases the precision of the system by 25% on average.

A probabilistic neural network system that works on geometric features is proposed in [8], which extracts 12 geometric features from segmented leaf image. The research is performed on 32 kinds of plants with an accuracy of 90%. This method requires user to enter start and end points of the midrib. Therefore, this method cannot be used for automated classification tasks. On the other hand, authors in [21] use a modified Minimum Perimeter Polygons approach to reduce the number features and increase the accuracy. They have presented their methods using an information retrieval system.

Authors in [11] propose leaf classification based on geometric features. They have identified 8 geometric features in addition to 7 moment invariants. After feature extraction, their proposed system performs linear scaling and Wilson Editing. This method uses Moving Center Hypersphere Classifier, which is proposed specifically for leaf classification. On the other hand, dynamic Time Warping algorithm is used in [22] to extract features and KNN is employed to classify leaf images. Authors in [22] used 6 different plant species and achieved 97% accuracy.

In this paper, we propose a leaf classification system that uses geometric features, Multi-scale Distance Matrix (MDM) and moment invariants as well as new features we have proposed specifically for leaf classification. Moment invariants and MDM cannot distinguish between leaf margin and noise. In order to solve this issue, we propose five additional features that describe leaf margins. We have also employed Linear Discriminant Classifier (LDC) for the reason that it can work with different classes having different importance factor for features. This trait is important as some features of a leaf may show large amount of variance whereas in another leaf type the same feature will produce less variance. Margin statistics are described in Section 2.2.6.

Compared to the state-of-the-art shape based leaf identification methods, our proposed method has better performance in terms of accuracy. Additionally, the proposed method employs LDC which has a lower computational complexity compared to many other classifiers.

@&#PROPOSED METHOD@&#

A leaf classification system is proposed in this study that uses geometric features, Multi-scale Distance Matrix, Moment invariants and a new set of features. In addition, Linear Discriminant Classifier is used for classification. Our proposed method consists of three steps. The first step is the preprocessing step to prepare images using segmentation, noise reduction, contour extraction and corner region detection. The second step extracts features from the binary images and the traced contour data, and the last step performs actual classification.

The first step of the preprocessing is segmentation. This operation is performed according to the database used. In the experimental study, we have used two different databases namely Flavia [23] and Leafsnap [6]. For the first database, we have employed a simple adaptive threshold segmentation over blue channel. The representation for this segmentation is as follows:
                           
                              (1)
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ∈
                                 Leaf
                                 ⇔
                                 
                                    
                                    
                                       blue
                                    
                                 
                                 
                                    
                                       I
                                    
                                    
                                       x
                                       ,
                                       y
                                    
                                 
                                 <
                                 E
                                 
                                    
                                       
                                          
                                             
                                             
                                                blue
                                             
                                          
                                          I
                                       
                                    
                                 
                              
                           
                        where x and y are the coordinates of the corresponding pixel and I is the input image. For the second database, we have employed the first segmentation algorithm described in [24].

We have performed stalk removal for Leafsnap database. Our method of stalk removal uses contour information to detect narrow parallel running chains. The longest of these chains is removed from the image. The reason behind stalk removal is that it dilutes some features such as edge ratio. These values are affected by the change in stalk length more than they are affected by between class variance.

It is possible to obtain a noisy binary image from the segmentation operation. This noise is generally caused by highlights on the leaf surface and dust particles that are scattered over the image acquisition device. A severely affected sample is shown in Fig. 1
                        . A noise removal algorithm to reduce leaf surface to a single connected component is necessary for the further steps of our system. A simple algorithm for this task is illustrated in Algorithm 1 with the results shown in Fig. 1.
                           Algorithm 1
                           Proposed noise removal algorithm. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                1: procedure NoiseRemove(
                                                   
                                                      I
                                                      ,
                                                      limit
                                                   
                                                )
                                          
                                          
                                             
                                                2: 
                                                
                                                   
                                                      ♢
                                                   
                                                 
                                                I is binary image
                                             
                                          
                                          
                                             
                                                3: 
                                                J is a new set of points
                                          
                                          
                                             
                                                4: startover:
                                             
                                          
                                          
                                             
                                                5: 
                                                for each pixel at 
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                6: 
                                                if 
                                                
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      ∉
                                                      J
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                7: 
                                                
                                                open and closed are stacks of 2D coordinates
                                          
                                          
                                             
                                                8: 
                                                
                                                push 
                                                
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                 to open stack
                                          
                                          
                                             
                                                9: 
                                                
                                                
                                                   
                                                      current
                                                      =
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            x
                                                            ,
                                                            y
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             10:
                                          
                                          
                                             11: 
                                                
                                                
                                                   
                                                      ♢
                                                   
                                                 
                                                Finding connected components
                                             
                                          
                                          
                                             12: 
                                                
                                                while 
                                                open has items do
                                             
                                          
                                          
                                             13: 
                                                
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                      =
                                                      pop
                                                   
                                                 
                                                open
                                             
                                          
                                          
                                             14: 
                                                
                                                
                                                push 
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                 to closed stack
                                          
                                          
                                             15: 
                                                
                                                
                                                for 
                                                
                                                   
                                                      (
                                                      xx
                                                      ,
                                                      yy
                                                      )
                                                      ∈
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                         
                                                            4
                                                            -
                                                            neighborhood
                                                         
                                                      
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             16: 
                                                
                                                
                                                
                                                if 
                                                
                                                   
                                                      (
                                                      xx
                                                      ,
                                                      yy
                                                      )
                                                      ∉
                                                      J
                                                      ∧
                                                      (
                                                      xx
                                                      ,
                                                      yy
                                                      )
                                                      
                                                      ∉
                                                      
                                                      open
                                                      
                                                      ∧
                                                   
                                                
                                             
                                          
                                          
                                             17: 
                                                
                                                
                                                
                                                
                                                
                                                   
                                                      (
                                                      xx
                                                      ,
                                                      yy
                                                      )
                                                      ∉
                                                      closed
                                                      ∧
                                                      current
                                                      =
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            xx
                                                            ,
                                                            yy
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             18: 
                                                
                                                
                                                
                                                
                                                push 
                                                
                                                   
                                                      (
                                                      xx
                                                      ,
                                                      yy
                                                      )
                                                   
                                                 to open stack
                                          
                                          
                                             19: 
                                                
                                                
                                                
                                                end if
                                             
                                          
                                          
                                             20: 
                                                
                                                
                                                end for
                                             
                                          
                                          
                                             21: 
                                                
                                                end while
                                             
                                          
                                          
                                             22:
                                          
                                          
                                             23: 
                                                
                                                if 
                                                
                                                   
                                                      sizeof
                                                      (
                                                      closed
                                                      )
                                                      >
                                                      limit
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             24: 
                                                
                                                
                                                append 
                                                closed to J
                                             
                                          
                                          
                                             25: 
                                                
                                                else
                                             
                                          
                                          
                                             26: 
                                                
                                                
                                                for 
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                      ∈
                                                      closed
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             27: 
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      ¬
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             28: 
                                                
                                                
                                                end for
                                             
                                          
                                          
                                             29: 
                                                
                                                
                                                goto 
                                                startover
                                             
                                          
                                          
                                             30: 
                                                
                                                end if
                                             
                                          
                                          
                                             31: 
                                                end if
                                             
                                          
                                          
                                             32: 
                                                end for
                                             
                                          
                                          
                                             33: end procedure
                                             
                                          
                                       
                                    
                                 
                              
                           

The proposed method uses contour information to extract some of the features. These features are discussed in Section 2.2. We have used Pavlidis’ Contour Extraction Algorithm [25] for this task as it can extract contours on any connected surface and works efficiently. However, any algorithm that can extract 8-connected contours in clock-wise fashion can be used instead.

Additionally, we have employed a simple contour smoothing operator both to reduce noise and to detect smaller changes along the leaf blade. Our smoothing operator works over a given window and performs one dimensional vector convolution. The kernel we have used consists of equal entries, causing a box smoothing. If the smoothing factor is s, the size of the smoothing kernel will be 
                           
                              2
                              s
                              +
                              1
                           
                         and each entry in the kernel will be 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                    s
                                    +
                                    1
                                 
                              
                           
                        . The effect of different level of contour smoothing is presented in Fig. 2
                        . It can also be noted that, after contour extraction, we perform a smoothing operation with a factor of 3. This is performed to cancel segmentation and quantization errors. It is evident from Fig. 2a that contour smoothing with factor of 3 does not damage any margin information although it is still sufficient to cancel quantization noise.

We propose corner regions to be excluded from the calculation of certain features. Corner regions are the contour segments that contain a leaf tip. Depending on the leaf type, corners may have different properties compared to the other segments of leaf blade. Therefore, these segments are ignored while calculating some of the features that are discussed in Section 2.2.

This detection uses smooth contour information. We have determined smoothing factor of 15 to be optimal in the database we have used. This value depends on the size of the image, rather than the size of the leaf to be analyzed.

In order to determine corner regions, we use average arc angles of different distances. Two points that have the given distance from the central point are selected. Using these points, the angle between the lines that passes from the first selected point to the current point, and from the current point to the second selected point is calculated. Arc angles are averaged for the distances that start from 1 to 
                           
                              n
                              /
                              4
                           
                        , where n is the number of contour points. It is possible to derive the maximum distance using heuristics, however, using a fixed ratio also results in predictable and useful corner regions. Therefore, we have used the simpler technique both for efficiency and to avoid additional complexity.

The average arc angles are calculated and then a threshold is determined as follows:
                           
                              (2)
                              
                                 
                                    
                                       arc
                                    
                                    
                                       threshold
                                    
                                 
                                 =
                                 
                                    
                                       min
                                       (
                                       arcs
                                       )
                                       +
                                       3
                                       E
                                       [
                                       arcs
                                       ]
                                    
                                    
                                       4
                                    
                                 
                              
                           
                        
                     

Setting threshold to this value reduces the amount of noise, while making sure to include all the meaningful corner regions. The average arc angles, their average and determined threshold is presented in Fig. 3
                        .
                           
                              (3)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   qp
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   p
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ¯
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         10
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         00
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   ¯
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         01
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         00
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   pq
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                      ∈
                                                      I
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   x
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   p
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   )
                                                
                                                
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   η
                                                
                                                
                                                   20
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   02
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         20
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         02
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             4
                                             
                                                
                                                   η
                                                
                                                
                                                   11
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   3
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         30
                                                      
                                                   
                                                   -
                                                   3
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   3
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         03
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   4
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         30
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         03
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   5
                                                
                                             
                                             =
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   30
                                                
                                             
                                             -
                                             3
                                             
                                                
                                                   η
                                                
                                                
                                                   12
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   30
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   12
                                                
                                             
                                             )
                                             [
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         30
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             3
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         03
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             +
                                             (
                                             3
                                             
                                                
                                                   η
                                                
                                                
                                                   21
                                                
                                             
                                             -
                                             
                                                
                                                   η
                                                
                                                
                                                   03
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   21
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   03
                                                
                                             
                                             )
                                             [
                                             3
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         30
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         03
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   6
                                                
                                             
                                             =
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   20
                                                
                                             
                                             -
                                             
                                                
                                                   η
                                                
                                                
                                                   02
                                                
                                             
                                             )
                                             [
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         30
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         03
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             +
                                             4
                                             
                                                
                                                   η
                                                
                                                
                                                   11
                                                
                                             
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   30
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   12
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   21
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   03
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   7
                                                
                                             
                                             =
                                             (
                                             3
                                             
                                                
                                                   η
                                                
                                                
                                                   21
                                                
                                             
                                             -
                                             
                                                
                                                   η
                                                
                                                
                                                   03
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   30
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   12
                                                
                                             
                                             )
                                             [
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         30
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             3
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         03
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             -
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   30
                                                
                                             
                                             -
                                             3
                                             
                                                
                                                   η
                                                
                                                
                                                   12
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   21
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   03
                                                
                                             
                                             )
                                             [
                                             3
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         30
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         03
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   8
                                                
                                             
                                             =
                                             
                                                
                                                   η
                                                
                                                
                                                   11
                                                
                                             
                                             [
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         30
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   (
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         03
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             -
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   20
                                                
                                             
                                             -
                                             
                                                
                                                   η
                                                
                                                
                                                   02
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   30
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   12
                                                
                                             
                                             )
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   03
                                                
                                             
                                             +
                                             
                                                
                                                   η
                                                
                                                
                                                   21
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We have proposed a set of features to describe a leaf. In the proposed method, we have taken precautions against noise in every step including feature extraction. Feature extraction is performed to obtain moment invariants, convexity, perimeter ratio, multi-scale distance matrix, average margin distance and margin statistics. The methods to extract these features are described below in detail.

Moment invariants define general shape characteristics of an image and are widely used as shape features [24]. Moment invariants are first proposed by [26] and they are invariant to scale and rotation. The equations that are necessary to calculate moment invariants for binary image I are presented in Eq. (3).

Convexity features measure the similarity between a leaf shape and its convex hull. We have adopted perimeter and area convexity and circularity features that are proposed by [24]. A leaf that is simple and straight and has an entire margin type is fully convex. Complex leaves, different margin types and bents cause concave features to appear and therefore, alter these features. Convexity features can be calculated as follows:
                              
                                 (4)
                                 
                                    
                                       
                                          
                                          
                                             
                                                Area
                                                
                                                convexity
                                                =
                                                
                                                   
                                                      
                                                         
                                                            Area
                                                         
                                                         
                                                            leaf
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Area
                                                         
                                                         
                                                            convex
                                                            
                                                            hull
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                Perimeter
                                                
                                                convexity
                                                =
                                                
                                                   
                                                      
                                                         
                                                            Perimeter
                                                         
                                                         
                                                            leaf
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Perimeter
                                                         
                                                         
                                                            convex
                                                            
                                                            hull
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                Circularity
                                                =
                                                
                                                   
                                                      
                                                         
                                                            Area
                                                         
                                                         
                                                            leaf
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Perimeter
                                                         
                                                         
                                                            convex
                                                            
                                                            hull
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

It must be noted that, in the last feature, we have dropped constant factors as they have no effect when LDC or linear scaling is used.

These features contain information about the overall leaf complexity, including structural complexity and margin complexity. However, structural complexity affects convexity features significantly more than margin complexity. This behavior is evident from Fig. 4
                           . Due to this difference, these features cannot reliably be used to distinguish margin shapes.

Convex hull can easily be constructed from contour points. The task is to eliminate points that cause concave shapes. The proposed algorithm works with the contour extraction algorithm described in Section 2.1 which is illustrated in Algorithm 2.
                              Algorithm 2
                              Convex hull algorithm using contour information. 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   procedure ConvexHull(L)
                                             
                                             
                                                
                                                   
                                                   
                                                      
                                                         ♢
                                                      
                                                    
                                                   L is the contour of the leaf
                                                
                                             
                                             
                                                
                                                   
                                                   a
                                                   =0, b
                                                   =1, c
                                                   =2
                                             
                                             
                                                
                                                   
                                                   while 
                                                   
                                                      
                                                         c
                                                         ≯
                                                         
                                                            
                                                               Size
                                                            
                                                            
                                                               L
                                                            
                                                         
                                                      
                                                    
                                                   do
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                      
                                                         m
                                                         =
                                                         
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     c
                                                                     
                                                                     y
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     a
                                                                     
                                                                     y
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     c
                                                                     
                                                                     x
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     a
                                                                     
                                                                     x
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                      
                                                         a
                                                         =
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               c
                                                               
                                                               y
                                                            
                                                         
                                                         -
                                                         m
                                                         
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               c
                                                               
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   if 
                                                   
                                                      
                                                         m
                                                         
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               b
                                                               
                                                               x
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               b
                                                               
                                                               y
                                                            
                                                         
                                                         +
                                                         a
                                                         <
                                                         0
                                                      
                                                    
                                                   then
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ♢
                                                      
                                                    
                                                   Removal of b causes c to point to the next contour
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   remove 
                                                   b from L
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         a
                                                         =
                                                         a
                                                         -
                                                         1
                                                         ,
                                                         b
                                                         =
                                                         b
                                                         -
                                                         1
                                                         ,
                                                         c
                                                         =
                                                         c
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   else
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         a
                                                         =
                                                         a
                                                         +
                                                         1
                                                         ,
                                                         b
                                                         =
                                                         b
                                                         +
                                                         1
                                                         ,
                                                         c
                                                         =
                                                         c
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   
                                                   end while
                                                
                                             
                                             
                                                
                                                   end procedure
                                                
                                             
                                          
                                       
                                    
                                 
                              

Perimeter ratio feature is the ratio of the leaf perimeter to the leaf area. This feature contains information about general complexity and the form factor of the leaf. It is closely related to form factor feature proposed in [8]. The following formula is used to calculate this feature:
                              
                                 (5)
                                 
                                    Perimeter
                                    
                                    ratio
                                    =
                                    
                                       
                                          
                                             
                                                Perimeter
                                             
                                             
                                                leaf
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Area
                                                   
                                                   
                                                      leaf
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In order to define leaf shape in general, we have employed Multi-scale Distance Matrix (MDM) feature metric proposed by [13]. MDM is scale and rotation independent, making it suitable for leaf identification. The main problem of MDM is its inability to capture smaller details such as leaf margins.

Although authors in [13] propose to use 64 nodes to construct the matrix, according to our analysis, using 32 nodes on smooth contours with additional features performs better both in terms of performance and computational efficiency. Additionally, 64 nodes generate too many features that cause Linear Discriminant Classifier to fail due to the singular case of the covariance matrix. This property of LDC is described in Section 2.3. The growth of features in MDM is in factor of 
                              
                                 O
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , where n is the number of nodes. Additionally, we have used matrix average as scaling factor. This depends on the fact that matrix maximum is more susceptible noise, whereas noise will have less effect on average. MDM representation of several leaves is displayed in Fig. 5
                           .

MDM algorithm works by generating a distance matrix from the selected points over the leaf contour. In our system, we propose the use of smoothed contours instead of regular contours. Selected nodes in the contour and peaks in margin have different frequency, so that every node is affected differently from margin peaks causing a moire pattern. Smooth contours do not contain any information about leaf margins; therefore, they do not have this problem. According to our experiments presented in Section 3, the improvement achieved using smooth contours is minimal, however, the improvement is evident in leaves that have larger margin shapes.

In the second step, every column of the matrix is rotated up by its column index, starting from 1. Only the first 
                              
                                 
                                    
                                       
                                          n
                                          /
                                          2
                                       
                                    
                                 
                                 -
                                 1
                              
                            rows of the resultant matrix are kept, the rest is discarded. After that, there will be exact duplicate of the same data followed by a row of zeros. In the third step, all rows are sorted to ensure rotation invariance. In the final step, matrix is divided by its average for scale invariance.

Margin distance is the average distance between smoothed contour points and original contour points. This difference represents how rough the leaf blade is. If the leaf blade is smooth, there will not be any change between smooth and original contours, however, if there are dents, these dents will be straightened by smoothing, causing difference. This assumption has a weak point; there is a large distance between smooth and original contours around the corners. In order to remedy this issue, we have used the corner regions that we have identified previously in Section 2.1. Any point that is inside these regions are ignored, so that the corners will not affect this metric. Margin distance is formally calculated as follows:
                              
                                 (6)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      distances
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  0
                                                                  ,
                                                               
                                                               
                                                                  if
                                                                  
                                                                  i
                                                                  ∈
                                                                  corner
                                                                  _
                                                                  regions
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 smooth
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           -
                                                                           
                                                                              
                                                                                 original
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                               
                                                               
                                                                  otherwise
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                margin
                                                
                                                distance
                                                =
                                                E
                                                (
                                                distances
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           where smooth and original are smoothed and original contours, 
                              
                                 corner
                                 _
                                 regions
                              
                            are the regions that are determined in Section 2.1.

Margin statistics are calculated over the margin peaks. These are average peak height, peak height variance, average peak distance and peak distance variance. These features are closely related to average margin distance, however, they compliment each other. For instance, average peak height and average margin distance can be used together to determine whether the margin type is serrated or circular. Average margin distance cannot describe this property as margin distance will increase together with the peak height. As the shape of the leaf margin becomes smoother, margin distance increases while all other margin statistics stay the same. These inter-feature relations can be exploited by LDC. Additionally, margin statistics of leaves that have entire margins are rather noisy; LDC calculates support value for each class separately, allowing the use of these features effectively.

Calculation of margin statistics requires detection of peaks in the leaf margin. Leaf margin distances that are extracted in the previous step are used for this task. We have employed a peak detection algorithm that is derived from Automatic Multiscale Peak Detection algorithm proposed in [27]. This algorithm first calculates multi-scale maxima matrix, however, instead of cutting the matrix from an automatically determined point, we set the threshold to be the half of the smoothing distance used to obtain margin distances. The final form of the algorithm is presented in Algorithm 3. Additionally, we have removed any peaks that are less than 0.5. These very low peaks can be formed by segmentation noise around the edges and do not contain any information about margins.
                              Algorithm 3
                              Proposed peak detection algorithm. 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   procedure Peaks(M, L)
                                             
                                             
                                                
                                                   
                                                   
                                                      
                                                         ♢
                                                      
                                                    M is the margin distances, L is the threshold
                                             
                                             
                                                
                                                   
                                                   V is an empty 
                                                      
                                                         M
                                                         ×
                                                         L
                                                      
                                                    matrix
                                             
                                             
                                                
                                                   
                                                   for 
                                                   i = 1 to 
                                                   
                                                      
                                                         
                                                            
                                                               Size
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                    
                                                   do
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   for 
                                                   k = 1 to L do
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                   if 
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         >
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               i
                                                               -
                                                               k
                                                            
                                                         
                                                         ∧
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         >
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               i
                                                               +
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               k
                                                               ,
                                                               i
                                                            
                                                         
                                                         =
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                   else
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               k
                                                               ,
                                                               i
                                                            
                                                         
                                                         =
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                   end if
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   end for
                                                
                                             
                                             
                                                
                                                   
                                                   end for
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               sums
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               k
                                                               ,
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   return 
                                                   
                                                      
                                                         
                                                            
                                                               indexesof
                                                            
                                                            
                                                               sums
                                                               =
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   end procedure
                                                
                                             
                                          
                                       
                                    
                                 
                              

We propose the use of LDC for leaf classification. The reason for this choice is the ability of LDC to prioritize features depending on the leaf type. This is a very important property as some features do not contain any useful information about specific leaves. For instance, any margin statistics that can be extracted from a leaf that has entire margins is purely noise. Therefore, samples of that class cannot be identified according to their margin attributes. LDC contains weights for each feature separately for all classes. Therefore, it is possible for a feature to have a very low weight for a specific class while having higher values for others.

LDC is based on normal distribution and closely related to Quadratic Discriminant Classifier (QDC). The main difference of LDC and QDC is that LDC assumes that the covariance matrices for all classes are the same. Although this assumption does not hold in real life scenarios, common covariance for all classes is calculated and used. Common covariance can be calculated as follows:
                           
                              (7)
                              
                                 Σ
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          C
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        where 
                           
                              Σ
                           
                         is common covariance, N is the number of training samples, 
                           
                              
                                 
                                    N
                                 
                                 
                                    i
                                 
                              
                           
                         is the number of training samples for class 
                           
                              i
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    i
                                 
                              
                           
                         is the covariance of class i. If the number of training samples is less than the number of dimensions, 
                           
                              Σ
                           
                         will be a singular matrix.

After determining the common covariance matrix, LDC should be trained separately for each class. Training yields to a constant c and a vector 
                           
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                           
                         for every class. The following formula is used to calculate c and 
                           
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                           
                         for class i:
                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   Σ
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             ln
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   Σ
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         is the mean of class 
                           
                              i
                              ,
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         is the probability of class i. Matrix inversion in this step will fail if the covariance matrix calculated in the previous step is singular.

While classifying a sample, support for each class is calculated separately. The class with the highest support is declared as the classification result. Support for class i is calculated as follows:
                           
                              (9)
                              
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

Therefore, LDC has a lower or similar computational complexity compared to other classification methods. Additionally, LDC assigns separate weights to features for every class which allows it to ignore features that have no meaning for some classes.

In short, the proposed method performs segmentation, noise removal, contour extraction and corner detection. Using the data obtained from these steps, feature extraction methods are performed to extract moment invariants, convexity, perimeter ratio, MDM, average margin distance and margin statistics features as leaf descriptor. Using these leaf descriptors, an LDC is trained and used for classification.

@&#RESULTS@&#

We have conducted experiments to demonstrate the effectiveness of the proposed method. These experiments are divided into three categories. The first category is the comparison of the proposed method with other shape based leaf classification methods. The second category presents the improvement gained by employing the proposed features and modifications. The third category contains computational efficiency comparisons.

Experiments are performed over two databases: Flavia [23] and Leafsnap [6]. The first database contains a total of 1907 scanned images of 32 different plants. These images have white background with small amount of noise. We have selected 4375 samples from the second database containing 132 classes. We have avoided Pinales leaves as they are completely removed by our stalk removal algorithm. The second database contains shadows, variable background intensity and fair amount of noise. Both databases are presented in JPEG format, which is commonly used in image acquisition devices. Example images of these databases are shown in Fig. 6
                     .

Performance and computational efficiency comparisons have been performed by implementing the methods that are presented in [11,13]. The results that are reported in [8] are directly used for reference. All algorithms are implemented in C++ and simulations are performed on a computer with Intel i5 processor. All results on Flavia database presented in this section are the average results of 100 simulations, with the exception of [8]. On the other hand, the results obtained using Leafsnap database are the average of 20 simulations.

In Fig. 7
                     , we have compared the accuracy of the algorithms at different number of testing samples using Flavia dataset. The amount of test samples in [8] is 16.7%, which is 10 samples per class. In Fig. 8
                     , the proposed method is compared with the state-of-the-art methods over Leafsnap database. In this figure, 10% of the samples are used as test samples.

We have also identified contribution of each feature set by removing them from the system. The accuracy loss when they have removed is listed in Table 1
                     . This table additionally lists accuracy improvement by proposed segmentation, noise removal and MDM smoothing. While removing MDM, we have placed back the geometric features that are made obsolete by the use of MDM. These features are listed in [24].

The computational time for feature extraction, classification and training times are reported in Table 2
                     . The running time for [8] is omitted as it requires human input for each sample, which is not possible to calculate objectively. It is evident from these results that classification phase of our proposed method works faster or comparable to any other method that it is compared with. The reason for this high speed is the usage of LDC classification method. Instead of comparisons, it performs a single vector dot product which has D elements, where D is the number of dimensions. Additionally, feature extraction using contour information is faster than feature extraction using entire image. In fact, MDM is extracted over contour information, the proposed method uses a mixture of contour and geometric features whereas MCH uses only geometric features. This is the reason for feature extraction running times in Table 2. Training time for the proposed algorithm is comparable with MCH [11]. Feature extraction speed is also acceptable compared to both [11,13]. In addition to the reported values, the proposed classification method has a low computational complexity which makes it more suitable for larger systems.

@&#CONCLUSION@&#

A combination of several known features and a set of novel features to describe leaf margins are proposed in this study to represent a leaf. Additionally, we propose the use of LDC which has a lower computational complexity compared to many other classifiers.

In this research, we have shown that leaf identification can be improved by combining features that complement each other. Moreover, we have proposed margin features that enable discrimination of leaves according to margin types. Additionally, we have shown that reducing inherent noise in leaf images also contributes to the performance of leaf shape based plant identification.

The proposed method uses LDC, which is a better suited classifier for leaf classification compared to the other classifiers analyzed in this study. The reason is that LDC is able to prioritize features depending on the leaf type. This allows the use of information that has no meaning in some leaf types but contains discriminative information in others. Additionally, increasing the amount of samples does not increase online classification time of LDC. Therefore, it is well suited for large-scale applications.

Compared to the other well-known classification systems, our proposed system has better performance. Additionally, the proposed method has a comparable computational efficiency with respect to the state-of-the-art systems.

Although the proposed system has a superior performance, there is still room of improvement. We believe that margin descriptors introduced in this paper can be further refined. Additionally, it is also possible to incorporate texture related parameters to this system to distinguish leaves that have identical shape but different texture.

@&#REFERENCES@&#

