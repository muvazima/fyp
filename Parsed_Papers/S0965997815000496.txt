@&#MAIN-TITLE@&#Rapid integrated parametric CAE modeling method of Linear Variable Differential Transformer based on a script template

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Join CAD/CAE integration and CAE modeling method for the automatic parametric CAE modeling based on CAD model.


                        
                        
                           
                           Provide a software for the CAE modeling based on parameters.


                        
                        
                           
                           A more efficient and effective method based on a script template in LVDT simulations for the rapid integration between CAD and CAE and CAE modeling continuously.


                        
                        
                           
                           The parametric LVDT simulation can not only be rapidly established but also significantly improves the quality of LVDT design in industry.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

LVDT

Script template

CAE

CAD

Integrated parametric modeling

Maxwell

@&#ABSTRACT@&#


               
               
                  Generally, Computing Aided Engineering (CAE) modeling and simulation of Linear Variable Differential Transformer (LVDT) has drawbacks such as the slow modeling speed and instability in simulation results. In this study, a rapid integrated parametric CAE modeling method is proposed for electromagnetic simulation based on a script template implemented in Maxwell electromagnetic simulation software with Visual Basic, so that the proposed method only requires the establishment of a simplified electromagnetic simulation model of a LVDT. The standard and parametric modeling process of LVDT is initially recorded as a script and then identifiers are added into the script to form a script template and transform Computing Aided Design (CAD) parameters to CAE modeling parameters according to parameter constraints of the model. Finally, parameter values are automatically assigned to identifiers in the script template in order to generate the script file through which the accurate CAE model can be created conveniently. The parametric LVDT simulation can not only be rapidly established but also significantly improves the quality of LVDT design in industry. In addition, the proposed method can improve CAD information availability in realizing seamless integration of CAD/CAE modeling in similar sensor product.
               
            

@&#INTRODUCTION@&#

The prototype structure of a Linear Variable Differential Transformer or LVDT is shown in Fig. 1
                     . According to the theory of electromagnetism, a linear relationship exists between iron core displacement defined as X and output voltage defined as e
                     2 
                     [1].

In practice, a deviation of actual output voltage from theoretical value of LVDT is always present because of various factors. Engineering design must determine tolerances of design parameters so that deviations can be controlled by allowable design requirements, cost constraints, and design quality [2].

Applications of CAE technology in product design have significantly improved the design efficiency and quality since the turn of the twenty first century, but this is not the case for the LVDT or other sensor industry. There are few reasons but not unique reasons. First, design requirements are so sophisticated that the majority of design engineers have difficulties in establishing an accurate simulation model. Second, CAE modeling is complicated, thereby allowing opportunity for mistakes and requiring a significant investment of time [3,4]. Finally, LVDT design is an iterative process which often requires dozens of simulation models during the design process of a product so that it results in much more heavier workload for design engineer. Consequently, an integrated CAD/CAE modeling method is needed to meet requirements of the CAE model which are quickly and efficiently generated based on the CAD model.

Extensive work has been done on CAD/CAE integration, primarily focusing on the see areas. Gujarathi and Ma [5] found that a CAD/CAE integration method uses a “common data model” (CDM) which contains all required parametric information for CAD modeling and CAE analysis. CDM is used as a parametric data model repository and the supply source of input for associative entities of CAD and CAE models, thereby maintaining associative dependences between CAD/CAE. Park [6] observed a framework that performs integration between commercial CAD and CAE software by using a common scripting, programming languages, and an application programming interface. Software that satisfies functional requirements shown in the framework can be used to implement the integration, but the software should support automation. In most popular commercial CAD/CAE systems such as CATIA, NX, Maxwell and so on, it is basic function for automatic modules offering script language. These automatic functions are commonly executed based on an application programming interface and scripting language [7–9].

These methods discussed in integrated modeling between CAD and CAE all referred to the concept of “intermediate medium” such as a database or framework for realizing the seamless integration, but how to generate CAE model based on the medium rapidly and effectively have been not found or the two steps including the CAD/CAE integration and CAE modeling is independent completely. However, there are still lots of work to modify CAE model after completing the integration. To unify CAD/CAE integration and CAE modeling, the study describes a more efficient and effective method based on a script template in LVDT simulations in order to realize the rapid integration between CAD/CAE integration and CAE modeling continuously. Therefore, the main contribution of this paper is not only to join CAD/CAE integration and CAE modeling method for the automatic parametric CAE modeling based on CAD model, but also to provide a software for the CAE modeling based on parameters. Because it is introduced in many literatures that how to extract parameter information from CAD model, the paper is focused on how to utilize CAD parameters into CAE section.

Organization of this paper is as followed. Section 2 presents the basic process of Maxwell electromagnetic properties simulation. In Section 3, the basic approach of parametric modeling is presented. A practical LVDT product example is presented in Section 4, and a conclusion is provided in Section 5.

Electromagnetic performance of LVDT was simulated by using the commercial software Maxwell, which is the premier electromagnetic field simulation software for engineers tasked with designing and analyzing 3-D and 2-D electromagnetic and electromechanical devices. The basic process of Maxwell includes the following seven steps, such as establishing the geometric model, appointing material properties of components, setting boundary condition, adding the excitation source, setting the solution domain, grid division, and solution set [10–12]. Building a reasonable geometric model is essential and important for above seven steps.

Theoretically, reasonable simulation results can be obtained by establishing an LVDT simulation model completely defined by the parameters in actual situation. Realistically, a simulation model for every system details is impossible to obtain because of limitations of computer memory and computation speed. Therefore, reasonable simplification, which attempts to reduce the geometric complexity without affecting overall magnetic field distribution, must be obtained.

For LVDT, the designed target parameter (induced voltage) is determined by electromagnetic induction. Non-magnetic components, such as the core and connecting rod between the objects to be tested (Fig. 1), have no effect on the electromagnetic field and can be neglected during electromagnetic simulation modeling. In addition, features such as a positioning column and holes do not affect magnetic field distribution and can also be omitted.

Compared to the other steps, winding modeling is a complicated and difficult task in LVDT electromagnetic simulation modeling. For example, for a certain type of LVDT with magnetizing winding of 5105 turns of coil, each of the two output windings has 1883 turns of coil with the wire diameter of 0.15mm. According to the actual shape (helix, Fig. 2
                        a), unilateral output winding can produce up to 125,505 elements during meshing, resulting in a long simulation computational time. So the winding must be simplified. Because output voltage is primarily affected by resistance and inductance which value depends on the winding sectional area independent to the cross section shape, the circular cross section shape of single-turn coil can be simplified to square with equal area, and the winding is simplified as a rectangle (Fig. 2b).

To verify effectiveness of the simplified model shown in Fig. 2, we tested a single-turn coil. According to the principle of equal area, a circular coil with diameter of 0.15mm, length 6mm was simplified to a square coil with side length of 0.13mm. Before the simplification, the element number was 66,652 and the computation time was 15min and 41s. But after simplification, the element number was 159 and the computation time was reduced to 44s. Simulation results are listed in Table 1
                        . Error resulting from the simplification was less than 0.1%.

Due to be axisymmetric, this character of LVDT was used to further simplify the model. When symmetry multiplier of the model was set as N and then 1/N slice of the original model was circumferentially intercepted (Fig. 3
                        ), the Maxwell automatically calculated the simplified model as the effect of full model and it corresponded to the full model calculation results [13,14]. However, the number of N have to be considered carefully, otherwise the model cannot be meshed because the circumferential size is too small. So far, how to define the best number of N is still a difficult problem need to research and solve. In this paper, N is equal to 128 according the empiric value based on several attempts. Consequently, as conducting test modeling, computation time can be reduced from approximately 12h as a full model to approximately 3h as the simplified model.

The basic approach of parametric modeling is shown in Fig. 4
                        . First, accurate and standard modeling steps must be formed according to the parametric modeling method mentioned in Section 2. Second, the correct modeling process should be recorded as a script in Maxwell environment. Third, data which needs to be parameterized in the scripts should be identified and associated with the parameter, thereby forming the script template using design parameters input by the designer to modify the tag in the script template and generate the dynamic script file. Finally, the script should be run in Maxwell for parametric modeling of electromagnetic simulation.

The manual modeling process can be recorded as script by VBScript language provided by Maxwell. Table 2
                         lists the magnetizing winding simulation modeling script of the model shown in Fig. 3. This model can be generated in 10s when running the script in Maxwell, compared to the manual modeling which requires more than 30min.

The script shown in Table 2 can only generate an LVDT model that includes fixed parameters. The script must be re-recorded if a model of other parameters and structure must be generated. Because the program actually does not achieve parametric modeling [15], design parameters in the script must be automatically accessed and modified by running a secondary development program. This paper proposes a method to achieve parametric modeling by modifying the recorded script file and using defined special symbols to mark parameters to be dynamically updated.

After a user inputs parameters, the system automatically searches parameter tags and find the position of parameter tags in the script template file. Then these parameter tags can be replaced with input parameters in order to create a new script file. As long as running the script file in the CAE environment, the accurate simulation model can be obtained conveniently. Table 3
                         is an example script template generated by adding parameter identification to Table 2. In Table 3, parameters which must be parameterized are marked, including magnetizing winding center coordinates X (0mm), Y (87.9mm), Z (0mm), inner diameter (4.1mm), length (175.8mm) and material (copper), etc. as % jici_X %, % jici_Y %, % jici_Z %, % jici_R %, % jici_H % and % jic_material %.

Those parameters which the user inputs through software interface are called design parameters, and the others for constructing the simulation model are called modeling parameters [16]. Design parameters are expressed as {dpNamei, dpValuei | i=1.. NDP} and modeling parameters are expressed as {mpNamei, mpValuei | i=1.. NMP}, in which dpNamei expresses the name of design parameter, dpValuei expresses design parameter values, NDP is the number of design parameters; The mpNamei represents the name of modeling parameters, mpValuei is modeling parameters, and NMP is the number of modeling parameters.

Obviously, design parameters are relevant to modeling parameters. For example, for field winding, design parameters include the winding layer number C1, wire diameter d1, and winding length Lj, while modeling parameters include the external diameter D, pitch diameter Dcp
                         of magnetizing winding, coil turns W1, skeleton diameter D
                        3, and resistor R1. The following relationship between design parameters and modeling parameters are shown in Eqs. (1)–(4).
                           
                              (1)
                              
                                 D
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 0.15
                                 +
                                 C
                                 1
                                 ∗
                                 d
                                 1
                                 ∗
                                 2
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       D
                                    
                                    
                                       cp
                                    
                                 
                                 =
                                 1
                                 /
                                 2
                                 (
                                 D
                                 +
                                 
                                    
                                       D
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 0.15
                                 )
                              
                           
                        
                        
                           
                              (3)
                              
                                 W
                                 1
                                 =
                                 C
                                 1
                                 ∗
                                 (
                                 Lj
                                 /
                                 (
                                 d
                                 1
                                 +
                                 0.0015
                                 )
                                 )
                              
                           
                        
                        
                           
                              (4)
                              
                                 R
                                 1
                                 =
                                 4
                                 ∗
                                 0.0175
                                 ∗
                                 0.001
                                 ∗
                                 
                                    
                                       D
                                    
                                    
                                       cp
                                    
                                 
                                 ∗
                                 W
                                 1
                                 /
                                 (
                                 d
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        
                     

Input can be simplified through establishment of an association model. Users only need to input design parameters and the system automatically converts design parameters to modeling parameters according to the association model. Meanwhile, constraint relations are present among the parameters [16]. For example, from Fig. 5
                        , structural diagram of LVDT can be depicted clearly, and as the core moves in the skeleton, the inner diameter of the skeleton is greater than the external diameter of the core. The magnetizing winding is wound around a framework, so the inner diameter of the magnetizing winding equals the external diameter of the skeleton. Constraint relations or rules can be shown among LVDT parameters in Fig. 5, from which rationality of the input parameters can be effectively tested.

After creating the constraint relation or rules of parameters, parameters marked by “%” can by replaced in the script template with modeling parameter values. The whole process is as followed.
                           
                              (1)
                              Open the corresponding script template file.

Sets the initial position of the search as zero.

Search the first tag “%” and obtain the position POS1 from the initial position.

Continue to search the second tag “%” and obtain the position POS2.

Obtains the string STR between POS1 and POS2.

Traverse the set of modeling parameters and distinguish whether STR is equal to mpName(i). if the result is yes, replace the string between POS1 and POS2 with mpValue(i).

Sets the initial search position as POS2.

Repeat steps (3)–(7) until end of file.

Through the above process, the script template file shown in Table 3 can be reduced to the script file shown in Table 2. Only parameter name in the script file is replaced by the desired parameter value. The parametric model can be obtained by running the dynamically formed script file in Maxwell.

Based on the above mentioned method, parametric modeling and simulation system of LVDT is developed by using Visual Basic script in the Maxwell. The main interface of LVDT parametric modeling and simulation program is shown in Fig. 6
                        . The parameters input interface is shown on the left of parametric simulation system of LVDT, while the simulation model display interface is shown on the right of parametric simulation system of LVDT.

After Users input design parameters initially, the program automatically determines modeling parameters based on the parameter constraints model. Parameter tags are searched in the script templates and replaced with the current input value. Finally, when the dynamically generated script file must be run on the Maxwell, it means that the electromagnetic simulation model retrieved CAD parameters by integrated CAE modeling process can be obtained accurately.

Using a practical LVDT product as an example, we verified the “LVDT parametric simulation system” proposed by this paper.

The main parameters of the case are shown in Table 4
                     . Input the design parameters in the table into the interface in Fig. 6 and call the parametric modeling program. The generated 1/128 simulation model is shown in Fig. 7
                     .

Through simulation we obtained the curve of relationship between core position x and output voltage e
                     2 in the post-processing interface. From Table 5
                     , it shows comparison of output voltage simulation values, measured values and theoretical values as sequence value of core position given from −7mm to 7mm.

As shown in Table 5, the measured values and simulation values are deviated from theoretical calculation results. Primary reasons for the error between the measured values and theoretical calculation results are as followed.
                        
                           (1)
                           Winding shape differences. In theoretical calculation, the assumption is made that output winding presents a cone-shaped distribution in order to compensate for attenuation of the magnetic field away from the center. In the actual test and simulation modeling, however, output winding adopts a step structure (Fig. 7).

Magnetic field asymmetry. In theoretical calculation, with the assumption that parameters of output winding coil is equal to the size of magnetic circuit when the core is in the center position, the magnetic field symmetrically distributes in LVDT. However, in actual production, due to the instability and inconsistency of winding manufacturing process, winding cannot be completely symmetrical, thereby causing the magnetic circuit to be asymmetrical. In simulation modeling, characteristics of the meshing algorithm determine that generated finite element mesh cannot be fully symmetrical so that asymmetry of the magnetic field distribution results in simulation deviation.

Impact of material performance. In theoretical calculation, because it is assumed that the electromagnetic field distributes uniformly in LVDT, the electromagnetic strength changes linearly with the current. In fact, with influences of magnetic saturation characteristics, coil parasitic capacitance, iron loss for permeability material, the magnetic field distribution deviates from the theoretical calculation, which leads to the nonlinear change between the electromagnetic strength and the current.

Eddy current phenomenon. In theoretical calculation, the impact of eddy current on the magnetic field produced by permeability magnetic materials such as the core and shell is generally ignored.

Other reasons. Theoretical and measurement deviation may also be influenced by measurement errors caused by measuring tools, the measuring environment or operators, etc.

The main reasons for deviation in measured values between a simulated model and a physical device are as followed.
                        
                           (1)
                           Model simplification. As mentioned above in Section 2.2, due to limitations of computing ability, the actual model must be simplified, possibly resulting in value bias.

The impact of exciting source fluctuation and temperature. The exciting source in the simulation was an ideal sine curve, and no fluctuations and environment temperature changes were considered. In actual measurement, variation of amplitude and frequency of the exciting source cause output variation. The variation of environmental temperature not only alters inductance coil parameters of LVDT, magnetizer characteristics, and the excitation source but also affects the output value.

Although deviation among simulation values, actual device, and theoretical values, there is little tolerance among these values in the same row of Table 5. Fig. 8
                      shows the deviation between the theoretical and simulation values as well as the measured values and theoretical values. In Fig. 8, X axis represents core position and Y axis represents deviation of induced voltage values. As shown in the Fig. 8, the maximum deviation between measured values and theoretical values was 0.027V (2.08%) and the maximum deviation between simulation values and theoretical values was 0.034V (2.6%). Therefore, simulation results obtained by the method proposed in this paper meet engineering design requirements.

@&#CONCLUSION@&#

In this paper, we proposed a rapid integration of CAE parametric modeling approach to realize parametric modeling of LVDT electromagnetic performance simulation. We apply a novel and rapid method using Visual Basic script and parametric template to achieve the proposed framework. Examples show that the “LVDT parametric simulation system” will significantly improve the efficiency and quality of LVDT design. According to the products’ features and simplified principles, the method can be extended to apply in CAE modeling for the other sensors or products. The further work will be focused in transform LVDT parametric simulation system to the CAE modeling of other products in order to the availability and flexibility of the method. Moreover, how to improve the versatility and portability of the system is the key work in the future.

@&#REFERENCES@&#

