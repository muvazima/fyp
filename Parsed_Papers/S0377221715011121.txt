@&#MAIN-TITLE@&#A technique to develop simplified and linearised models of complex dynamic supply chain systems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a systematic method for the analysis of high-order nonlinear dynamic models.


                        
                        
                           
                           Nonlinear control theory is used to gain insights into system’s behaviour.


                        
                        
                           
                           More accurate simplified linear approximations can be found.


                        
                        
                           
                           These simplified models enhance the understanding of the system transient responses.


                        
                        
                           
                           This work is a precursor to robust analysis and design of system dynamics models.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

System dynamics

Nonlinear control theory

The Forrester model

Manufacturing and shipment constraints

@&#ABSTRACT@&#


               
               
                  There is a need to identify and categorise different types of nonlinearities that commonly appear in supply chain dynamics models, as well as establishing suitable methods for linearising and analysing each type of nonlinearity. In this paper simplification methods to reduce model complexity and to assist in gaining system dynamics insights are suggested. Hence, an outcome is the development of more accurate simplified linear representations of complex nonlinear supply chain models.
                   We use the highly cited Forrester production-distribution model as a benchmark supply chain system to study nonlinear control structures and apply appropriate analytical control theory methods. We then compare performances of the linearised model with numerical solutions of the original nonlinear model and with other previous research on the same model.
                   Findings suggest that more accurate linear approximations can be found. These simplified and linearised models enhance the understanding of the system dynamics and transient responses, especially for inventory and shipment responses.
                   A systematic method is provided for the rigorous analysis and design of nonlinear supply chain dynamics models, especially when overly simplistic linear relationship assumptions are not possible or appropriate. This is a precursor to robust control system optimisation.
               
            

@&#INTRODUCTION@&#

In supply chains, the variability in the ordering patterns often increases as one moves up the chain, towards the factory and the suppliers (Dejonckheere, Disney, Lambrecht, & Towill, 2003). This variance is called the bullwhip effect, “one of the most widely investigated phenomena in supply chain management” (Chatfield & Pritchard, 2013). Even to this day the seminal works of Forrester (1958, 1961), that formed the foundation for System Dynamics, are almost always referred to synonymously with the bullwhip effect (e.g. Chatfield & Pritchard, 2013; Zhang & Burke, 2011). In citing Forrester’s works authors refer to the original production-distribution model, which may now be classified as a representation of a supply chain, as a bullwhip generator archetype and the use of System Dynamics simulation as a technique for exploring opportunities to mitigate unwanted dynamic behaviour.

While System Dynamics simulation is often used in the analysis and redesign of supply chain models that exhibit nonlinearities, quantitative analytical approaches are more often restricted to linear representations of supply chains. Hence, much of the research on supply chain dynamics either takes a ‘trial and error’, experimental, simulation approach to redesign (Forrester, 1961; Poles, 2013; Shukla, Naim, & Yaseen, 2009; Spiegler & Naim, 2014; Sterman, 1989) or develops exact solutions of models that are already linearised approximations to the real-world situation (Disney & Towill, 2005; Gaalman & Disney, 2009; John, Naim, & Towill, 1994; Towill, 1982; Zhou, Disney, & Towill, 2010).

While the original Forrester supply chain model is often quoted as the embodiment of the bullwhip effect it has had little exposure with respect to its use as a benchmark for applying supply chain analysis and redesign methods, with the notable exceptions of Wikner, Naim, and Towill (1992) and Jeong, Oh, and Kim (2000). The former explore a simplification approach to understanding the causes of the bullwhip effect (Wikner et al., 1992), while the latter apply a linearisation approach but with an analysis totally reliant on simulation. Analytical tools to link system dynamics model structures to different system modes of behaviour have recently become available and explored for linear models (Saleh, Oliva, Kampmann, & Davidsen, 2010). However, there is still a need to expand the existing body of knowledge regarding robust control of nonlinear supply chains. “Nonlinearity can introduce unexpected behaviour in a system” (Forrester, 1961), causing instability and uncertainty and therefore needing to be rigorously analysed.

Our paper aims to present a technique to develop both simplified and linearised models of complex, nonlinear supply chain systems. We seek to gain greater insights into the underlying mechanisms that create supply chain dynamics and to provide guidelines for undertaking system dynamics simulation in a time effective and productive way. The simplified and linearised form may also be a precursor to robust optimisation of nonlinear decision rules in supply chains, a gap in the existing body of knowledge due to the complexities of dealing with seemingly intractable mathematics. We utilise the original Forrester model as a benchmark, as per Wikner et al. (1992) and Jeong et al. (2000), given it is a complex representation of a production-inventory control system with nonlinearities and it is highly cited for describing the behavioural dynamics of supply chains. The currency of the model is also evidenced by 333 citations related to supply chains in 2013–2014 (according to Google Scholar searched on 27 August 2014) and by Singhal and Singhal (2012) noting that Forrester’s papers still represent well the real-world phenomenon of fluctuations and oscillations since it contains a combination of simulated data and case study data to examine the flow of materials and information in a supply chain.

In summary, we aim to determine the methodological benefits of nonlinear control theory in supporting simulation based research on supply chain dynamics studies. This research is particularly relevant to operations research scholars exploring nonlinear dynamic systems. Moreover, future applications of the proposed technique may also benefit practitioners in improving supply chain performance. As Ivanov and Sokolov (2013) pointed out “useful tools for quantitative analysis of control and systems theory for a wide supply chain management research community remain undiscovered”. Our work addresses this shortcoming.

A nonlinear system is one whose performance does not obey the principal of superposition. This means that the output of a nonlinear system is not directly proportional to the input and the variables to be solved cannot be expressed as a linear combination of the independent parts (Atherton, 1975). In this section, we briefly review methods for analysing nonlinear system dynamics and highlight where certain methods have already been used in supply chain dynamics research.

When confronted with a nonlinear system the primary approach utilised by system designers is to identify an equivalent linear representation. A justification for this is that there are a variety of analytical techniques available in linear control theory that are not so readily applicable in the analysis of nonlinear systems. While linear control theory is well established, the literature lacks a unique nonlinear theory that strives for generality and applicability (Hotz & Vogel, 2014; Rugh, 2002).

The lack of generality, coupled with often indefinite research methods, has led to a confusion of terminologies making it a challenge to determine a listing of all existing techniques and their applicability in the analysis of nonlinear feedback systems. Table 1
                      lists those methods that have been sufficiently acknowledged in the literature. The table highlights the type of nonlinearity that each method addresses, the assumptions or limitations that need due consideration in their application and citations of where they have been applied in a supply chain dynamics context. The choice of each method may also depend on the degree of complexity involved in the setting up of a mathematical model, the type of data available for analysis and the analytical skills of the researcher or supply chain designer.

Most research on nonlinear supply chain systems has been undertaken via simulation methods. Table 1 gives only a small number of examples from a plethora of papers that utilise simulation to analyse nonlinearities in supply chains. This research has led to the understanding of particular phenomena; such as:

                        
                           •
                           Stability and chaos (Larsen, Morecroft, & Thomsen, 1999; Laugesen & Mosekilde, 2006),

The impact of capacity and batching constraints (e.g. Cannella, Ciancimino, & Márquez, 2008; Hamdouch, 2011; Ivanov, Hartl, Dolgui, Pavlov, & Sokolov, 2014; Juntunen & Juga, 2009; Paik & Bagchi, 2007), inaccuracies in inventory (Cannella, Framinan, Bruccoleri, Barbosa-Póvoa, & Relvas, 2015), reverse logistics (Turrisi, Bruccoleri, & Cannella, 2013) and collaborative strategies (e.g. Cannella & Ciancimino, 2010; Spiegler & Naim, 2014) on system dynamics and supply chain performance,

Bullwhip effect in service supply chains Akkermans and Voss (2013)
                           

Shipment planning (Mula, Campuzano-Bolari, Diaz-Madronero, & Carpio, 2013; Shukla et al., 2009) and

The effects of psychological pressure, misperceptions and misjudgement in work environments (Bruccoleri, Cannella, & Porta, 2014; Sterman, 1989; Syntetos, Georgantzas, Boylan, & Dangerfield, 2011).

In contrast, there is limited research on the use of analytical methods. Many of the analytical studies on nonlinear system dynamics were undertaken in the same decade Forrester launched the World Dynamics model (Forrester, 1971), which is a simpler model when comparing to the production-distribution model. Cuypers (1973) used averaging techniques for linearising discontinuous nonlinearities in the World Dynamics model. One year later, numerical perturbation techniques and model simplification, involving the removal of variables with little variation, were also explored (Cuypers & Rademaker, 1974). Ratnatunga and Sharp (1976) proposed the use of numerical analysis to linearise and reduce orders of system assuming that nonlinear associations can be approximated to a first order function. Mohapatra (1980) identified and categorised different types of nonlinearities in business system dynamics research. Although his work recommends a number of techniques to deal with nonlinearities, there is no implementation of such methods in the paper.

Within a supply chain management context, Wikner et al. (1992) undertook in-depth analysis of the complex Forrester production-distribution model (1961). By using averaging techniques and block diagram manipulation, they linearised and simplified the original model and provided more qualitative analytical insights. For example, they highlighted the lack of feedback information fed into the manufacturing rate and the separation of ‘real’ and ‘safety’ orders. By following the same simplification and linearisation steps, Naim, Wikner, Towill, and Marques (2012) achieved the same result for the discrete z-domain model. In contrast, instead of using an averaging technique, Jeong et al. (2000) used small perturbation theory to linearise the continuous nonlinearities in the Forrester model and Matsubara’s time delay theorem to obtain a first-order delay approximation to represent an upstream echelon.

Another advocate of the use of analytical methods rather than just the use of exhaustive repeated simulation are Saleh et al. (2010). They suggest the use of small perturbation theory to perform structured policy analysis. However, their analytical framework disregards the presence of discontinuous nonlinearities. On the other hand, Wang and Disney (2012) and Wang, Disney, and Wang (2014) used graphical and eigenvalue methods to explore stability boundaries of a piecewise linear inventory control system and to identify a set of behaviours in the unstable region. Their work is limited to the analysis of a single-valued discontinuous nonlinearity given by a non-negative constraint on the replenishment order.

Our paper specifically addresses the gap in the use of describing functions in supply chain dynamics modelling to analyse both single- and multi-valued discontinuities. Moreover, our work focuses on understanding behaviour within the system’s stable region. In analysing the full set of nonlinearities we find in the Forrester model we couple describing functions with small perturbation theory using Taylor series expansion. Although Saleh et al. (2010) recommend the use of small perturbation theory, application of this method has only been found in Jeong et al. (2000) to linearise the continuous, single-valued nonlinearities in the Forrester model. Despite their efforts to linearise part of the model, they use solely simulation methods to analyse the effect of different capacity levels, or discontinuous nonlinearities, in the factory’s production rate. Due to their lack of explicit research objectives and methodological structure, their contribution to supply chain dynamics research is unclear and perhaps explains the lack of citation to their paper. As we will see, the small perturbation theory will overcome the accuracy disadvantages seen in the use of averaging techniques previously utilised in supply chain modelling by Naim et al. (2012); Wikner et al. (1992).

Although system design is not within the scope of this paper, the system’s transfer functions, damping ratio and natural frequencies will be presented for future evaluation of the impact of each control parameter on the supply chain performance. After linearisation is performed, the reader can refer to Saleh et al. (2010) and other relevant works (Disney, Farasyn, Lambrecht, Towill, & Van de Velde, 2006; Ouyang & Daganzo, 2008; Zhou et al., 2010) for robust analysis and design of linear models.

As previously mentioned, Wikner et al. (1992) endeavoured to gain more insights into the Forrester model by a two-stage linearisation and simplification approach. More importantly, their work translated the Forrester DYNAMO equations into Laplace domain block diagram format to improve visibility of the model’s system structure. Fig. 1
                      illustrates the block diagram representation of a single echelon, namely the factory, of the Forrester model and the steps taken by Wikner et al. (1992) in simplifying the original model. Appendix A in the supplement file contains the listing and explanation of constants, variables and equations. As is commonly found in such research a single-echelon as the unit of analysis suffices in determining the structural causes of the bullwhip effect (e.g. Disney et al., 2006; Ouyang & Daganzo, 2008).

The first step taken by Wikner et al. (1992) was to translate the original DYNAMO equations into a control engineering block diagram representation and to identify any nonlinearities as shown in Fig. 1a. Then they removed the discontinuous nonlinearities, represented by the CLIP functions (
                        
                     ), by assuming that the capacity limitations in manufacturing (AL) and shipping (IA) are never attained under ‘normal’ operating conditions, so that the wanted manufacturing rate is equal to the actual one (MW=MD) and shipments tried are equal to shipments sent (ST=SS) at all times. Note that while AL is a fixed capacity constraint IA is variable.

The continuous nonlinearity, caused by the nonlinear comparator ratio (
                        
                     ) in defining the delay in filling orders (DF), was considered the average value of this delay and then kept fixed as shown in Fig. 1b, Step 2. Lastly in Step 3, by block diagram manipulation (Wikner et al., 1992) collected constants and eliminated redundancies in the original model, resulting in the final block diagram of Fig. 1c. Step 3 is further explained in Section 4.1.1.

The resulting model highlights the lack of feedback information fed into the manufacturing rate (MD) and reveals a separation between ‘real’ and ‘safety’ orders. Hence, Wikner et al. (1992) showed that the so-called ‘Forrester effect’, in which orders are amplified from sink to source, is not due to linear feedback control but due to a first-order derivative term, s, in the feedforward path. As their study was focused on the bullwhip effect, the main problem with their model is that while accuracy is kept for analysing the manufacturing rate, their linearised and simplified model is less reliable for analysing inventory (IA) and shipments (SS) responses due to the use of averaging techniques for linearisation.

In this work we will show that it is possible to use Taylor series expansion to represent some of the nonlinearities present in the original model and linearise it with small perturbation theory to get better accuracy. Moreover, we do not neglect the presence of CLIP functions and we investigate their effect in the overall response of the model with the describing function method.


                     Wikner et al.’s (1992) approach consisted of conducting linearisation before simplification, as also seen in Jeong et al. (2000); Naim et al. (2012). However, causal relationships between certain variables may be lost during the linearisation process. For instance when cross-referencing Fig. 1a and b of Wikner et al.’s (1992) model, the effect of IA and AI (constant for inventory) on SS has been omitted after linearisation. Hence, we propose that models should be simplified first, by eliminating all redundancies whenever possible. Then later, having clearer visibility of the inherent model structure, analysis and synthesis of the nonlinear elements are undertaken.

To summarise, Fig. 2 illustrates the steps taken in this paper to simplify and linearise the original Forrester model in comparison to the approach used by Wikner et al. (1992). We start by taking the Forrester model equations and representing them in block diagram form. Then we take two steps to simplify the model: block diagram manipulation to remove redundancies found in the original model and low order modelling to reduce the order of the differential equation. Next, the linearisation process is initiated by identifying the types of nonlinearities present in the simplified model. Later, we use small perturbation theory to linearise continuous nonlinearities and describing functions to analyse discontinuous nonlinearities. Finally, we compare our simplified, low order and linearised model with the original Forrester and Wikner et al.’s (1992) models.

In this section, we explain in detail how block diagram manipulation and low order modelling techniques can help simplify the Forrester model.

The original block diagram of Fig. 1a can be manipulated so that redundancies are removed and constants are collected as given in Fig. 3
                           a. The sequence of steps taken were:

                              
                                 •
                                 
                                    Redundancy 1: Calculation of actual pipeline orders in transit (LA). The figure shows that the information about manufacturing orders (MO) is being added and reduced at the same time when calculating LA; therefore the information about MO is redundant in the determination of LA.


                                    Collecting constants: gathering constants from the output variable in the summing comparator SUM
                                    1. In the SUM
                                    1 expression, all the constants that multiply the variable smoothed requisition orders (RS) were combined together and called K, which is equal to 
                                       
                                          D
                                          C
                                          +
                                          D
                                          P
                                          −
                                          D
                                          H
                                          −
                                          D
                                          U
                                          +
                                          A
                                          I
                                       
                                    .


                                    Redundancy 2: Calculation of the output variable in the summing comparator SUM
                                    2. In the calculation of SUM
                                    2 both shipment received (SR) and shipment sent (SS) information is found to be redundant; therefore, they can be removed at that summation point.

After removing all the redundancies and combining the constants in K, the block diagram in Fig. 3b is then presented. Note that the resulting simplified non-linear model in Fig. 3a provides exactly the same responses as in the original model. No variable interactions were lost in this simplification process. Moreover, it can now be seen that the Forrester model contains a feedback loop in the manufacturing order rate (MD) but only to provide information regarding the manufacturing capacity. If the system cannot manufacture the amount wanted in a particular time period, this information is then fed back so that these orders can be produced later. However, if the capacity limitation is never reached, this feedback information is not needed and hence it can be ignored. As also evidenced by Wikner et al. (1992) inventory information is not fed back into manufacturing orders.

A high-order control system often contains poles that produce little effect on the transient response. In the pipeline of Fig. 3b, represented by the sixth-order transfer function 
                              
                                 
                                    
                                       (
                                       
                                          1
                                          
                                             1
                                             +
                                             
                                                
                                                   D
                                                   C
                                                
                                                3
                                             
                                             s
                                          
                                       
                                       )
                                    
                                    3
                                 
                                 .
                                 
                                    
                                       (
                                       
                                          1
                                          
                                             1
                                             +
                                             
                                                
                                                   D
                                                   P
                                                
                                                3
                                             
                                             s
                                          
                                       
                                       )
                                    
                                    3
                                 
                                 ,
                              
                            with selected parameter settings (
                              
                                 D
                                 C
                                 =
                                 1
                              
                            and 
                              
                                 D
                                 P
                                 =
                                 6
                              
                           ), the delay DC has little impact on the transient response of the pipeline. This is due to the position of the poles in the s-plane. The reader can refer to Appendix B in the supplement file to review the methods suggested by Towill (1981) and Kuo and Golnaraghi (2003). The former method is extended from the time delay theorem developed by Matsubara (1965). This method attempts to determine a low-order model based on the system unit step response and has already been used by Jeong et al. (2000) to approximate high-order delays in the Forrester model. Kuo and Golnaraghi (2003) recommend a method proposed by Hsia (1972) that approximates a high-order system to a low-order model by approaching their frequency responses.

We compared the Matsubara and Hsia methods to find the best low order model of the Forrester pipeline, and we found that Matsubara method provides better results for both step and sinusoidal inputs. For this reason , we use the Matsubara method for simplifying the Forrester model further. Hence, in the following analysis we consider the Matsubara first-order plus dummy pole pipeline approximation in the form of TM
                           (s), which is:

                              
                                 (1)
                                 
                                    
                                       
                                          T
                                          M
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                       =
                                       
                                          1
                                          
                                             
                                                (
                                                1
                                                +
                                                
                                                   
                                                      D
                                                      P
                                                   
                                                   3
                                                
                                                s
                                                )
                                             
                                             .
                                             
                                                [
                                                1
                                                +
                                                (
                                                D
                                                C
                                                +
                                                
                                                   2
                                                   3
                                                
                                                D
                                                P
                                                )
                                                s
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The derivation of Eq. 1 can be found in subsection (a) of Appendix B in the supplement file.

In this section, analysis of the nonlinearities in the Forrester production-distribution model will be undertaken. We analyse the continuous and discontinuous nonlinearities separately since each of them requires different linearisation methods.

We start our analysis by temporarily assuming that the CLIP functions are not active (Fig. 4
                           ). In other words, the manufacturing rate decision will be equal to the manufacturing rate wanted, MD=MW, and the shipment sent will be the same as the shipment tried, SS=ST, independent of actual inventory levels.

Hence, the system in Fig. 4 can be described by the system of differential equations (Eqs. 2–8), where 
                              
                                 
                                    r
                                    ˙
                                 
                                 s
                                 ,
                              
                           
                           
                              
                                 
                                    r
                                    ˙
                                 
                                 
                                    s
                                    s
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    m
                                    ˙
                                 
                                 
                                    d
                                    d
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    s
                                    ˙
                                 
                                 r
                                 ,
                              
                           
                           
                              
                                 
                                    u
                                    ˙
                                 
                                 o
                              
                            and 
                              
                                 
                                    i
                                    ˙
                                 
                                 a
                              
                            are the state variables, 
                              
                                 
                                    x
                                    ˙
                                 
                                 =
                                 f
                                 
                                    (
                                    x
                                    ,
                                    u
                                    )
                                 
                                 ,
                              
                            of the system and rr is the system input, u. Note that, since the six-order pipeline was replaced by the lower-order equation in Eq. 1, four other states have been excluded. The state variables rss
                            and mdd
                           , representing dummy variables RSS
                            and MDD
                            respectively, have been added to help derive the state variable equations below:

                              
                                 (2)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   ˙
                                                
                                                s
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   f
                                                   1
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                
                                                   
                                                      r
                                                      r
                                                      −
                                                      r
                                                      s
                                                   
                                                   
                                                      D
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   ˙
                                                
                                                
                                                   s
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   f
                                                   2
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                
                                                   
                                                      r
                                                      s
                                                      −
                                                      r
                                                      
                                                         s
                                                         s
                                                      
                                                   
                                                   
                                                      D
                                                      I
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                   ˙
                                                
                                                
                                                   d
                                                   d
                                                
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   f
                                                   3
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                
                                                   
                                                      3
                                                      K
                                                      .
                                                      r
                                                      s
                                                   
                                                   
                                                      D
                                                      I
                                                      .
                                                      D
                                                      P
                                                   
                                                
                                                −
                                                
                                                   
                                                      3
                                                      K
                                                      .
                                                      r
                                                      
                                                         s
                                                         s
                                                      
                                                   
                                                   
                                                      D
                                                      I
                                                      .
                                                      D
                                                      P
                                                   
                                                
                                                −
                                                
                                                   
                                                      3
                                                      m
                                                      
                                                         d
                                                         d
                                                      
                                                   
                                                   
                                                      D
                                                      P
                                                   
                                                
                                                +
                                                
                                                   
                                                      3
                                                      r
                                                      r
                                                   
                                                   
                                                      D
                                                      P
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                   ˙
                                                
                                                r
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   f
                                                   4
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                
                                                   
                                                      3
                                                      (
                                                      m
                                                      
                                                         d
                                                         d
                                                      
                                                      −
                                                      s
                                                      r
                                                      )
                                                   
                                                   
                                                      3
                                                      D
                                                      C
                                                      +
                                                      2
                                                      D
                                                      P
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   ˙
                                                
                                                o
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   f
                                                   5
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                r
                                                r
                                                −
                                                s
                                                s
                                                =
                                                r
                                                r
                                                −
                                                
                                                   
                                                      u
                                                      o
                                                      .
                                                      i
                                                      a
                                                   
                                                   
                                                      A
                                                      I
                                                      .
                                                      D
                                                      U
                                                      .
                                                      r
                                                      s
                                                      +
                                                      D
                                                      H
                                                      .
                                                      i
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   i
                                                   ˙
                                                
                                                a
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   f
                                                   6
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                s
                                                r
                                                −
                                                s
                                                s
                                                =
                                                s
                                                r
                                                −
                                                
                                                   
                                                      u
                                                      o
                                                      .
                                                      i
                                                      a
                                                   
                                                   
                                                      A
                                                      I
                                                      .
                                                      D
                                                      U
                                                      .
                                                      r
                                                      s
                                                      +
                                                      D
                                                      H
                                                      .
                                                      i
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                r
                                                s
                                             
                                          
                                          
                                             
                                                (
                                                0
                                                )
                                                =
                                                a
                                                (
                                                0
                                                )
                                                =
                                                b
                                                (
                                                0
                                                )
                                                =
                                                s
                                                r
                                                (
                                                0
                                                )
                                                =
                                                r
                                                r
                                                (
                                                0
                                                )
                                                ,
                                                i
                                                a
                                                (
                                                0
                                                )
                                                =
                                                A
                                                I
                                                .
                                                r
                                                r
                                                (
                                                0
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                u
                                                o
                                             
                                          
                                          
                                             
                                                (
                                                0
                                                )
                                                =
                                                (
                                                D
                                                H
                                                +
                                                D
                                                U
                                                )
                                                r
                                                r
                                                (
                                                0
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The outputs, 
                              
                                 y
                                 =
                                 g
                                 (
                                 x
                                 ,
                                 u
                                 )
                                 ,
                              
                            of interest are the manufacturing rate, MD, the actual inventory levels, IA, and shipment sent, SS. In addition to these outputs, it is interesting to know how the time-varying parameter DF will be affected after the linearisation.

                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                m
                                                d
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   g
                                                   1
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                r
                                                r
                                                +
                                                
                                                   
                                                      K
                                                      .
                                                      r
                                                      s
                                                   
                                                   
                                                      D
                                                      I
                                                   
                                                
                                                −
                                                
                                                   
                                                      K
                                                      .
                                                      r
                                                      
                                                         s
                                                         s
                                                      
                                                   
                                                   
                                                      D
                                                      I
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                s
                                                s
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   g
                                                   2
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                
                                                   
                                                      u
                                                      o
                                                      .
                                                      i
                                                      a
                                                   
                                                   
                                                      A
                                                      I
                                                      .
                                                      D
                                                      U
                                                      .
                                                      r
                                                      s
                                                      +
                                                      D
                                                      H
                                                      .
                                                      i
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             
                                                i
                                                a
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   g
                                                   3
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                i
                                                a
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                d
                                                f
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   g
                                                   4
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   u
                                                   )
                                                
                                                =
                                                
                                                   
                                                      A
                                                      I
                                                      .
                                                      r
                                                      s
                                                   
                                                   
                                                      i
                                                      a
                                                   
                                                
                                                .
                                                D
                                                U
                                                +
                                                D
                                                H
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The mathematical model above is nonlinear due to the presence of nonlinear algebraic differential equations, which in the block diagram are represented by the symbol 
                              
                           . The overall model can be linearised about a nominal operating state space x
                           * and for a given input u
                           * by using small perturbation with Taylor series expansion. The first order Taylor series approximation of the nonlinear state derivatives leads to the following linearised function:

                              
                                 (13)
                                 
                                    
                                       Δ
                                       
                                          x
                                          ˙
                                       
                                       =
                                       A
                                       Δ
                                       x
                                       +
                                       B
                                       Δ
                                       u
                                    
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    
                                       Δ
                                       y
                                       =
                                       C
                                       Δ
                                       x
                                       +
                                       D
                                       Δ
                                       u
                                    
                                 
                              
                           where 
                              
                                 Δ
                                 x
                                 =
                                 x
                                 −
                                 
                                    x
                                    *
                                 
                                 ,
                              
                           
                           
                              
                                 Δ
                                 y
                                 =
                                 y
                                 −
                                 
                                    y
                                    *
                                 
                                 ,
                              
                           
                           
                              
                                 Δ
                                 u
                                 =
                                 u
                                 −
                                 
                                    u
                                    *
                                 
                              
                           . The equilibrium or resting points (x
                           *, u
                           *) can be determined by the final value theorem and A, B, C, D can be found through the partial derivatives of the state space equations, which result in the matrix given by Eq. 15. Eq. 15 can then be converted back to a block diagram representation as in Fig. 5
                           . Note that, in the resulting matrix only DF is input-dependent, and hence it could not be represented in the block diagram of Fig. 5.

                              
                                 (15)
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   B
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   D
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                      
                                                         D
                                                         R
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      1
                                                      
                                                         D
                                                         R
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      
                                                         D
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                      
                                                         D
                                                         I
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         3
                                                         K
                                                      
                                                      
                                                         D
                                                         P
                                                         .
                                                         D
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         3
                                                         K
                                                      
                                                      
                                                         D
                                                         P
                                                         .
                                                         D
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         3
                                                      
                                                      
                                                         D
                                                         P
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      3
                                                      
                                                         D
                                                         P
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      3
                                                      
                                                         (
                                                         3
                                                         D
                                                         C
                                                         +
                                                         2
                                                         D
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         3
                                                      
                                                      
                                                         (
                                                         3
                                                         D
                                                         C
                                                         +
                                                         2
                                                         D
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         D
                                                         U
                                                      
                                                      
                                                         D
                                                         U
                                                         +
                                                         D
                                                         H
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                      
                                                         D
                                                         U
                                                         +
                                                         D
                                                         H
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         D
                                                         U
                                                      
                                                      
                                                         A
                                                         I
                                                         (
                                                         D
                                                         U
                                                         +
                                                         D
                                                         H
                                                         )
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         D
                                                         U
                                                      
                                                      
                                                         D
                                                         U
                                                         +
                                                         D
                                                         H
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         −
                                                         1
                                                      
                                                      
                                                         D
                                                         U
                                                         +
                                                         D
                                                         H
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         D
                                                         U
                                                      
                                                      
                                                         A
                                                         I
                                                         (
                                                         D
                                                         U
                                                         +
                                                         D
                                                         H
                                                         )
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      K
                                                      
                                                         D
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         K
                                                      
                                                      
                                                         D
                                                         I
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         −
                                                         D
                                                         U
                                                      
                                                      
                                                         D
                                                         U
                                                         +
                                                         D
                                                         H
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      1
                                                      
                                                         D
                                                         U
                                                         +
                                                         D
                                                         H
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         D
                                                         U
                                                      
                                                      
                                                         A
                                                         I
                                                         (
                                                         D
                                                         U
                                                         +
                                                         D
                                                         H
                                                         )
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         −
                                                         D
                                                         U
                                                      
                                                      
                                                         R
                                                         R
                                                         I
                                                         +
                                                         S
                                                         T
                                                         E
                                                         P
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         −
                                                         D
                                                         U
                                                      
                                                      
                                                         A
                                                         I
                                                         (
                                                         R
                                                         R
                                                         I
                                                         +
                                                         S
                                                         T
                                                         E
                                                         P
                                                         )
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

When comparing Figs. 4 and 5, it can be seen that after linearisation the product functions (
                              
                           ) are replaced by summing comparators (
                              
                           ) after linearisation. Moreover, the system transfer functions can now be determined and linear control theory can be used for analysing the impact of each control parameter and improving system design (please refer to Appendix C in the supplement file). The separation between ‘real’ and ‘safety’ orders is well evidenced in the MD transfer function in Eq. C1. Hence, bullwhip does not occur due to feedback control, but due a derivative term in the numerator of the transfer function.


                           Fig. 6
                            illustrates unit step and sinusoidal responses in changes in manufacturing rate (ΔMD), inventory (ΔIA) and shipment sent (ΔSS) from their initial states and the delay in filling orders (DF), comparing the output responses of the original model with averaging (Wikner et al., 1992) and small perturbation linearisation techniques. Fig. 6 demonstrates the power of small perturbation theory for the analysis of continuous nonlinearities. Accuracy is increased as the amplitude of the input signals is decreased although in all cases the small perturbation theory approach gives a better approximation than the averaging method.

Now we re-insert the CLIP functions into the linearised model resulting in Fig. 7
                           
                           . Note that when re-inserting the CLIP functions, two feedback loops have also been re-instated. We then analyse each of the discontinuous nonlinearities separately.


                           Manufacturing constraint: if a sinusoidal input, MW

                              
                                 (16)
                                 
                                    
                                       M
                                       W
                                       (
                                       t
                                       )
                                       =
                                       A
                                       .
                                       c
                                       o
                                       s
                                       (
                                       ω
                                       t
                                       )
                                       +
                                       B
                                    
                                 
                              
                           with amplitude A, mean B and angular frequency, 
                              
                                 ω
                                 =
                                 2
                                 π
                                 /
                                 T
                                 ,
                              
                            is the input into the nonlinearity, which consists of a saturation function with a maximum limit value AL, an output MD will result. MD does not depend on the past values of the input MW, but it varies according to the actual state of MW. Although the function is nonlinear, it can be represented by two piecewise linear equations:

                              
                                 (17)
                                 
                                    
                                       M
                                       D
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      M
                                                      W
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      M
                                                      W
                                                      <
                                                      A
                                                      L
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      A
                                                      L
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      M
                                                      W
                                                      ≥
                                                      A
                                                      L
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

By investigating the block diagram again in Fig. 7, it is clear that if the output MD differs from demand RR, this error will be accumulated due to the presence of an integrator 1/s in the feedback loop. Hence, the manufacturing rate, MD, will only align with the demand if the manufacturing capacity AL is at least equal to the average demand. If manufacturing capacity is less than the required demand, RR, then the manufacturing wanted, MW, will increase exponentially and the system will never stabilise.

In order to investigate the impact of discontinuous nonlinearities in feedback systems, we can use the describing function method, which is a quasi-linear representation for a nonlinear element subjected to a sinusoidal input.

For asymmetric nonlinearities at least two terms of the describing function are needed: one that describes the change in the output amplitude (NA
                           ) as the input amplitude increases or the saturation value decreases, and another term that determines the change in the output mean (NB
                           ). We can also investigate the change in phase angle (ϕ) of the output response in relation to its input. Given MW as input, the output MD can be approximated to:

                              
                                 (18)
                                 
                                    
                                       M
                                       D
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          N
                                          A
                                       
                                       .
                                       A
                                       .
                                       c
                                       o
                                       s
                                       
                                          (
                                          ω
                                          t
                                          +
                                          ϕ
                                          )
                                       
                                       +
                                       
                                          N
                                          B
                                       
                                       .
                                       B
                                    
                                 
                              
                           
                        

In order to determine the terms of the describing function (NA, NB
                            and ϕ) the series have to be expanded and its first harmonic coefficients must be determined. The Fourier series expansion method is used to represent the output MD as a series such as:

                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                                M
                                                D
                                                (
                                                t
                                                )
                                             
                                          
                                          
                                             ≈
                                          
                                          
                                             
                                                
                                                   b
                                                   0
                                                
                                                +
                                                
                                                   a
                                                   1
                                                
                                                c
                                                o
                                                s
                                                
                                                   (
                                                   ω
                                                   t
                                                   )
                                                
                                                +
                                                
                                                   b
                                                   1
                                                
                                                s
                                                i
                                                n
                                                
                                                   (
                                                   ω
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   a
                                                   2
                                                
                                                c
                                                o
                                                s
                                                
                                                   (
                                                   2
                                                   ω
                                                   t
                                                   )
                                                
                                                +
                                                
                                                   b
                                                   2
                                                
                                                s
                                                i
                                                n
                                                
                                                   (
                                                   2
                                                   ω
                                                   t
                                                   )
                                                
                                                +
                                                ⋯
                                                =
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≈
                                          
                                          
                                             
                                                
                                                   b
                                                   0
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   ∞
                                                
                                                
                                                   [
                                                   
                                                      a
                                                      k
                                                   
                                                   c
                                                   o
                                                   s
                                                   
                                                      (
                                                      k
                                                      .
                                                      ω
                                                      t
                                                      )
                                                   
                                                   +
                                                   
                                                      b
                                                      k
                                                   
                                                   s
                                                   i
                                                   n
                                                   
                                                      (
                                                      k
                                                      .
                                                      ω
                                                      t
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where ak, bk
                            and b
                           0 are the Fourier coefficients and MD is the piecewise linear function given in Eq. 17.

If we approximate the piecewise linear output MD to the first harmonic, we have:

                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                M
                                                D
                                                (
                                                t
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   b
                                                   0
                                                
                                                +
                                                
                                                   a
                                                   1
                                                
                                                c
                                                o
                                                s
                                                
                                                   (
                                                   ω
                                                   t
                                                   )
                                                
                                                +
                                                
                                                   b
                                                   1
                                                
                                                s
                                                i
                                                n
                                                
                                                   (
                                                   ω
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   b
                                                   0
                                                
                                                +
                                                
                                                   
                                                      
                                                         a
                                                         1
                                                         2
                                                      
                                                      +
                                                      
                                                         b
                                                         1
                                                         2
                                                      
                                                   
                                                
                                                
                                                .
                                                c
                                                o
                                                s
                                                
                                                   (
                                                   ω
                                                   t
                                                   +
                                                   ϕ
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where, 
                              
                                 ϕ
                                 =
                                 a
                                 r
                                 c
                                 t
                                 a
                                 n
                                 (
                                 
                                    
                                       b
                                       1
                                    
                                    
                                       a
                                       1
                                    
                                 
                                 )
                              
                           
                        

In this way the two terms of the describing function can be determined as:

                              
                                 (21)
                                 
                                    
                                       
                                          
                                             
                                                N
                                                A
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      
                                                         
                                                            a
                                                            1
                                                            2
                                                         
                                                         +
                                                         
                                                            b
                                                            1
                                                            2
                                                         
                                                      
                                                   
                                                   A
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             
                                                N
                                                B
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      b
                                                      0
                                                   
                                                   B
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For single-valued nonlinearities the coefficient b
                           1, the imaginary part of the describing function, will be equal to zero and therefore the phase angle will be also zero. Hence, for the asymmetric saturation in the Forrester system it is found that:

                              
                                 (23)
                                 
                                    
                                       
                                          
                                             
                                                N
                                                A
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      −
                                                      γ
                                                      +
                                                      π
                                                      +
                                                      c
                                                      o
                                                      s
                                                      γ
                                                      .
                                                      s
                                                      i
                                                      n
                                                      γ
                                                   
                                                   π
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                N
                                                B
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      B
                                                      .
                                                      π
                                                      +
                                                      A
                                                      .
                                                      γ
                                                      .
                                                      c
                                                      o
                                                      s
                                                      γ
                                                      −
                                                      A
                                                      .
                                                      s
                                                      i
                                                      n
                                                      γ
                                                   
                                                   
                                                      B
                                                      .
                                                      π
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 γ
                                 =
                                 c
                                 o
                                 
                                    s
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          A
                                          L
                                          −
                                          B
                                       
                                       A
                                    
                                    )
                                 
                              
                           .


                           Fig. 8 illustrates how the coefficients of the describing function for the manufacturing capacity vary as the amplitude of manufacturing wanted rate, AMW
                           , increases. For amplitudes lower than the capacity, AL, the system behaves as linear and output MD will be equal to the input MW corresponding to a describing function gain equal to 1. However, when MW hits the capacity AL we have to consider that only a fraction of this rate will actually be manufactured.


                           Fig. 9
                           
                           
                           
                           
                            demonstrates the changes in the sinusoidal responses of the change in manufacturing orders (ΔMD) comparing the original Forrester model with Wikner et al.’s (1992) model and the describing function method for different frequencies, noting the different scales in the x-axis. Again we have found a better linear approximation for the original model.


                           Shipment constraint: the CLIP function in the shipment system is used to avoid any shipments being made to customers if no inventory is actually available. Hence, shipments sent, SS, will be equal to shipment tried, ST, only if actual inventory, IA, is greater than ST.

This second nonlinearity is different from the discontinuity in the manufacturing system in that it is not only amplitude-dependent but also frequency-dependent. In Fig. 10, we explore a set of system responses for inventory and shipments for different amplitude and frequencies, again noting the different scales in the x-axis. In the example in Fig. 10, it seems that higher frequencies and lower amplitudes (Fig. 10a) result in a seemingly linear response. Hence, SS will be equal to ST, corresponding to a describing function of 1. However, for lower frequencies and increased amplitude (Fig. 10d), the shipment capacity is reduced and a complex nonlinear behaviour is observed. Fig. 10 also illustrates that this nonlinearity is multi-valued, as may be noted by the insets on the top right corner of each figure, which shows the variations in the output amplitude, on the y-axis, for a given input amplitude, on the x-axis. For a given input ST the output SS can assume different values depending on the past states of ST.

Since this discontinuous nonlinearity is frequency-dependent, there will be one describing function for each frequency. We used Matlab
                           ® combined with Simulink
                           ® to find the describing function corresponding to the amplitude gain and also to identify the phase shift, resulting in Fig. 11.


                           Fig. 11 confirms that the nonlinearity in the shipment process only occurs for very low frequencies and high amplitudes. Another important factor is regarding the target inventory, AI, as inventory levels decrease the nonlinearity becomes more pronounced. With the nominal values for AI in the Forrester model set between 4 to 8 weeks, then the Wikner et al. (1992) representation is reasonable because the CLIP function will only take effect at extremely low frequencies and high demand amplitudes. The system designer does not have to be concerned with the shipment constraint when demand has medium to high frequencies and low amplitudes.

In Fig. 12 we compare the change in shipment sent, ΔSS, due to sinusoidal inputs of two distinct frequencies, of the original Forrester model, the Wikner et al.’s (1992) representation and the describing function method when the system reaches steady state. The amplitude is fixed to 2 for both cases. Note that for this comparison we have set the value of AL to a high enough value so that the manufacturing constraint is inactive and MD=MW. For both responses in Fig. 12 the describing function method provides a better approximation to the Forrester model response than that achieved by Wikner et al. (1992). Although the differences between the three models are not significant, the describing function method provides a better understanding of the shipment constraint in relation to its effect on the output phase and amplitude shift for certain input frequencies and amplitudes.

Finally, Fig. 13 illustrates the change in inventory (ΔIA) when all discontinuous nonlinearities are in effect. The inventory response given by the Forrester model does not return to the target value, Δmean=0, due to the capacity constraints. Our model was able to track this behaviour, while the Wikner et al.’s (1992) model was incapable of replicating the original behaviour since they disregarded the CLIP functions. As the demand frequency decreases and amplitude increases the nonlinear responses in the original Forrester become more acute and hence the Wikner et al.’s (1992) linearised model becomes less accurate.

Further analysis can be undertaken using the describing function method to design supply chain systems. Appendix D in the supplement file explains how to use the root locus technique in combination with the describing function method to predict the effect of discontinuous nonlinearities on the system’s natural frequency (ωn
                           ) and damping ratio (ζ). ωn
                            determines how fast the system oscillates during the transient response, while ζ describes how much the system oscillates as the response decays towards steady state.

We found that while both manufacturing and shipment capacity constraints equally decrease ωn
                           , the manufacturing capacity has the most significant impact on ζ by damping the system’s response and making it slower. Hence, the nonlinearity present in the shipment process is not much of a concern for the supply chain designer.

@&#CONCLUSION@&#

To date, simulation techniques have been mainly used to deal with the dynamics of complex, nonlinear supply chain systems. However, this research suggests a more rigorous approach that permits mathematical analysis of nonlinearities as precursor for simulation experiments and any subsequent robust system optimisation.

For this reason this research identified and categorised the different types of nonlinearities that may appear in supply chain dynamics models in order to suggest suitable analytical methods for investigating each type of nonlinearity. Moreover, simplification techniques have also been used to reduce model complexity and to assist in gaining system dynamics insights. Hence, another outcome of this research was the development of a methodological framework to obtain more accurate simplified linear representations of complex nonlinear supply chain models by using nonlinear control theory. Better accuracy of our proposed approach is a result of firstly simplifying the original model so that complexity can be removed (Fig. 14
                     ). This step facilitated the application of advanced linearisation methods that improved the precision of the system’s responses and the understanding of the impact of each nonlinearity on the system’s behaviour.

The well-known Forrester model has been used as a benchmark supply chain system to study nonlinear control structures and to experiment with the application of low order modelling, small perturbation and describing function methods. In this model, we have identified all types of nonlinearities, although not all combinations of nonlinearities. Continuous nonlinearities were used by Forrester to represent a time-varying parameter: delay in filling order (DF), which increases substantially as inventory approaches zero. Discontinuous nonlinearities were used to represent manufacturing and shipment constraints. Both types of nonlinearities can be represented by piecewise linear functions. Single-valued nonlinearities were used to represent fixed capacity values in the manufacturing while multi-valued nonlinearities emerged from variable capacities in shipments. Performances of the linearised models have been compared with numerical solutions of the original Forrester model. Moreover, these techniques have also been compared to simple averaging and best-fit line approximation advocated and applied by previous research (Naim et al., 2012; Wikner et al., 1992).

The use of this approach brought a number of insights to bear on the understanding of the system dynamics behaviour and how each nonlinearity affects responses. Table 2
                      summarises the analytical insights obtained with the use of nonlinear control theory, the suggestions for further simulation experiments and the possible implications of not conducting a mathematical analysis before simulation.

The simplification techniques, such as block diagram manipulation and low order modelling, have contributed to providing a better visualisation and understanding of the variable interactions in the model. Moreover, by reducing the number of equations and orders, these techniques supported the application of small perturbation theory and describing functions methods. Finally, these linearisation techniques provided further insights since they make possible the calculation of the system transfer functions and local stability boundaries and the understanding of how different capacity constraints impact on the system’s behaviour. While simulation generates confidence, analysis breeds insights.

The methodological framework proposed by this work can guide researchers and practitioners in undertaking comprehensive analysis and design of nonlinear dynamics systems in a less time consuming and less resource intensive manner. Hence, research with the aim of acquiring only exploratory knowledge of system dynamics may opt to conduct a simulation-only approach. In the search for deep understanding, many of the simulation studies reviewed in Table 1 could benefit from simplification methods to reduce the complexity of their models when the number of variables and parameters is too large. For supply chain dynamics studies considering more than one echelon, analysis can be firstly undertaken for a single echelon to gain preliminary insights on the existing underlying mechanisms. These simplification techniques will then facilitate the application of linearisation methods that will provide more insights into understanding the systems behaviour and how nonlinearities affect system responses. Further investigation and results confirmation can then be more easily undertaken via simulation and consequently leading to a more complete system design.

This research is limited to the dynamics of single-echelon supply chain systems and focused on the analysis of each nonlinearity individually. Further research, motivated by the analytical research and due consideration of the literature review, could include in-depth analysis of system stability and limit cycles via describing function and identification and investigation of other combination of nonlinearities, such as continuous and multi-valued requiring the Volterra–Wiener series expansion method.

Supplementary material associated with this article can be found, in the online version, at 10.1016/j.ejor.2015.12.004 .


                     
                        
                           Supplementary Data S1
                           
                              Supplementary Raw Research Data. This is open data under the CC BY license http://creativecommons.org/licenses/by/4.0/
                              
                           
                           
                        
                     
                  

@&#REFERENCES@&#

