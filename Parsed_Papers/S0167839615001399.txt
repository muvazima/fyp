@&#MAIN-TITLE@&#Multivariate splines and the Bernstein–Bézier form of a polynomial

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This is a survey of the Bernstein–Bézier form of a multivariate polynomial.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

@&#ABSTRACT@&#


               
               
                  This expository paper exhibits the power and versatility of the Bernstein–Bézier form of a polynomial, and the role that it has played in the analysis of multivariate spline spaces. Several particular applications are discussed in some detail. The purpose of the paper is to provide the reader with a working facility with the Bernstein–Bézier form.
               
            

@&#INTRODUCTION@&#

The Bernstein–Bézier form of a polynomial, henceforth simply referred to as the B-form, has been essential and central in multivariate spline research during the past 40 years or so. The purpose of this article is to serve as a tutorial and illustrate the power and utility of the B-form. Several B-form based arguments will be shown in detail so that a reader new to the B-form should obtain a working familiarity with some of the techniques that proved useful in spline research. However, I'll make no attempt to give a comprehensive, or even just balanced, summary of the history or the state of the art. I'll quote only those references that have a direct bearing on the material discussed here. For a complete description of the subject and its history, a comprehensive list of references, and an account of the state of the art as of 2007, consult the authoritative monograph by Lai and Schumaker (2007).


                     Splines are smooth piecewise polynomial functions defined on a partition of an underlying domain 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              k
                           
                        
                     . Splines are called univariate if 
                        k
                        =
                        1
                     , bivariate if 
                        k
                        =
                        2
                     , trivariate if 
                        k
                        =
                        3
                     , and, in general, multivariate if 
                        k
                        >
                        1
                     . Throughout this paper, r will denote the degree of smoothness, d the polynomial degree, k the dimension of the underlying domain, and N the number of regions in the underlying partition.

Our emphasis is of course on multivariate splines, but it is instructive briefly to look at univariate splines for comparison. In one variable, 
                        k
                        =
                        1
                     , an interval 
                        Ω
                        =
                        [
                        a
                        ,
                        b
                        ]
                      is partitioned into subintervals 
                        
                           
                              I
                           
                           
                              i
                           
                        
                        =
                        [
                        
                           
                              x
                           
                           
                              i
                              −
                              1
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              i
                           
                        
                        ]
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        N
                     , where 
                        a
                        =
                        
                           
                              x
                           
                           
                              0
                           
                        
                        <
                        
                           
                              x
                           
                           
                              1
                           
                        
                        <
                        …
                        <
                        
                           
                              x
                           
                           
                              N
                           
                        
                        =
                        b
                     . We denote the partition by 
                        Δ
                        =
                        
                           {
                           
                              
                                 I
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                           }
                        
                     . The relevant spline space is
                        
                           (1)
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              (
                              Δ
                              )
                              =
                              
                                 {
                                 s
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Ω
                                 )
                                 :
                                 s
                                 
                                    
                                       |
                                    
                                    
                                       I
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 I
                                 ∈
                                 Δ
                                 }
                              
                           
                        
                      where 
                        
                           
                              P
                           
                           
                              d
                           
                        
                      is the 
                        (
                        d
                        +
                        1
                        )
                     -dimensional space of polynomials of degree d in one variable.

The set 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                        (
                        Δ
                        )
                      is a linear space and as such it has a dimension. In the case 
                        k
                        =
                        1
                      it requires little more than first semester calculus to compute that dimension. Casually speaking, on the first interval, 
                        [
                        
                           
                              x
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              x
                           
                           
                              1
                           
                        
                        ]
                      we have a polynomial of degree d with 
                        d
                        +
                        1
                      parameters. When we move to the next interval, we gain another 
                        d
                        +
                        1
                      parameters, but we also need to satisfy 
                        r
                        +
                        1
                      linear smoothness conditions (continuity of the spline and its first r derivatives) and thus we gain 
                        d
                        −
                        r
                      parameters. This happens every time we move into a new interval, which we do 
                        N
                        −
                        1
                      times. Of course, one has to verify that the smoothness conditions are linearly independent, but that is a simple matter. Thus, in the univariate case,
                        
                           (2)
                           
                              dim
                              
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              (
                              Δ
                              )
                              =
                              (
                              d
                              +
                              1
                              )
                              +
                              (
                              N
                              −
                              1
                              )
                              (
                              d
                              −
                              r
                              )
                              =
                              N
                              (
                              d
                              −
                              r
                              )
                              +
                              r
                              +
                              1
                              .
                           
                        
                     
                  

In two or more variables, 
                        (
                        k
                        >
                        1
                        )
                     , various types of partitions are possible and have been investigated. The focus in this paper is on splines defined on triangulations of a polygonal region in 
                        
                           
                              R
                           
                           
                              2
                           
                        
                     , and, to a lesser degree, on splines defined on tetrahedral decompositions of a polyhedral domain in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     . Let 
                        
                           
                              T
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        N
                      denote the triangles in a triangulation Δ of a region 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              2
                           
                        
                     .


                     
                        Definition 1
                        A set 
                              Δ
                              =
                              
                                 {
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       N
                                    
                                 
                                 }
                              
                            of triangles in the plane is called a triangulation of 
                              Ω
                              =
                              
                                 
                                    ⋃
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                            provided that
                              
                                 1.
                                 If a pair of triangles in Δ intersect, then that intersection is either a common vertex or a common edge.

The domain Ω is homeomorphic to a disk.

We can now define our spline space of interest similarly as in the univariate case:
                        
                           (3)
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              (
                              Ω
                              )
                              =
                              
                                 {
                                 s
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Ω
                                 )
                                 :
                                 s
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 }
                              
                           
                        
                      where 
                        
                           
                              P
                           
                           
                              d
                           
                        
                      is now the 
                        (
                        d
                        +
                        2
                        )
                        (
                        d
                        +
                        1
                        )
                        /
                        2
                     -dimensional space of polynomials of degree d in two variables. We will often write simply 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                      instead of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                        (
                        Δ
                        )
                      when this causes no confusion.

Note that in the univariate case the dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                     , given in equation (2), depends only on the number of subintervals in the partition, and not on the lengths of those subintervals. For multivariate splines, the situation is very different. The dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                      (and a number of other properties such as the solvability of certain interpolation problems) depends not only on the combinatorics (the numbers of interior and boundary vertices and edges, and triangles) and topology (the way triangles are connected) of the underlying partition, but also on its geometry, i.e., the precise location of the vertices. This fact is the source of the vastly increased complexity of multivariate spline spaces as compared to the simplicity of univariate spline spaces.

Throughout this paper for planar triangulations we use the notation
                        
                           (4)
                           
                              
                                 
                                    
                                       N
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       number of triangles
                                    
                                 
                                 
                                    
                                       V
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       number of vertices
                                    
                                 
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             I
                                          
                                       
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       number of interior vertices
                                    
                                 
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             B
                                          
                                       
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       number of boundary vertices
                                    
                                 
                                 
                                    
                                       E
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       number of edges
                                    
                                 
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             I
                                          
                                       
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       number of interior edges
                                    
                                 
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             B
                                          
                                       
                                       
                                    
                                    
                                       =
                                       
                                    
                                    
                                       number of boundary edges
                                    
                                 
                              
                           
                        
                      The following Euler relations are useful:
                        
                           (5)
                           
                              
                                 
                                    V
                                 
                                 
                                    B
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    B
                                 
                              
                              ,
                              
                              
                                 
                                    E
                                 
                                 
                                    I
                                 
                              
                              =
                              3
                              
                                 
                                    V
                                 
                                 
                                    I
                                 
                              
                              +
                              
                                 
                                    V
                                 
                                 
                                    B
                                 
                              
                              −
                              3
                              ,
                              
                              N
                              =
                              2
                              
                                 
                                    V
                                 
                                 
                                    I
                                 
                              
                              +
                              
                                 
                                    V
                                 
                                 
                                    B
                                 
                              
                              −
                              2
                           
                        
                     
                  

A polynomial p of degree d in two variables x and y is usually written as
                        
                           (6)
                           
                              p
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 ∑
                                 
                                    0
                                    ≤
                                    i
                                    +
                                    j
                                    ≤
                                    d
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              .
                           
                        
                      This form is focused on the origin and is inappropriate when dealing with a triangle that could be anywhere in the plane. An alternative is based on barycentric coordinates.


                     
                        Definition 2
                        Let T be a non-degenerate triangle with vertices 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                            and let x be a point in 
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           . Then the barycentric coordinates 
                           
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                            
                           of x with respect to 
                           T are defined by
                              
                                 (7)
                                 
                                    x
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       3
                                    
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    
                                    and
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       3
                                    
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    1
                                    .
                                 
                              
                           
                        

Then it is easy to see that any bivariate polynomial p of degree d can be written uniquely in its B-form as
                        
                           (8)
                           
                              p
                              (
                              x
                              )
                              =
                              
                                 ∑
                                 
                                    i
                                    +
                                    j
                                    +
                                    k
                                    =
                                    d
                                 
                              
                              
                                 
                                    d
                                    !
                                 
                                 
                                    i
                                    !
                                    j
                                    !
                                    k
                                    !
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                                 
                                    k
                                 
                              
                              .
                           
                        
                      The 
                        
                           
                              c
                           
                           
                              i
                              j
                              k
                           
                        
                      are the Bézier ordinates, or simply coefficients, of p. The integers 
                        
                           
                              d
                              !
                           
                           
                              i
                              !
                              j
                              !
                              k
                              !
                           
                        
                      are convenient normalizing constants. Associated with each coefficient 
                        
                           
                              c
                           
                           
                              i
                              j
                              k
                           
                        
                      is a Domain Point
                     
                        
                           (9)
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              
                                 
                                    i
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    j
                                    
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    k
                                    
                                       
                                          v
                                       
                                       
                                          3
                                       
                                    
                                 
                                 d
                              
                              ∈
                              T
                           
                        
                      and a Control Point
                     
                        
                           (10)
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 )
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              .
                           
                        
                     
                  


                     Fig. 1
                      shows the domain points on a single triangle for 
                        d
                        =
                        7
                     . Domain points will be shown in several figures in this paper but you always want to think in terms of the associated control points in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                     . For an illustration of the control points in 3-dimensional space see, for example, Fig. 18.13 on page 323 of Farin (1990). That book also contains many other figures illustrating the finer points of the B-form.

Note that 
                        
                           
                              b
                           
                           
                              i
                           
                        
                        (
                        
                           
                              v
                           
                           
                              j
                           
                        
                        )
                        =
                        
                           
                              δ
                           
                           
                              i
                              j
                           
                        
                      and that as a consequence 
                        p
                        (
                        
                           
                              v
                           
                           
                              1
                           
                        
                        )
                        =
                        
                           
                              c
                           
                           
                              d
                              00
                           
                        
                     , 
                        p
                        (
                        
                           
                              v
                           
                           
                              2
                           
                        
                        )
                        =
                        
                           
                              c
                           
                           
                              0
                              d
                              0
                           
                        
                     , and 
                        p
                        (
                        
                           
                              v
                           
                           
                              3
                           
                        
                        )
                        =
                        
                           
                              c
                           
                           
                              00
                              d
                           
                        
                     . It follows that the control points corresponding to the vertices of T lie on the graph of p. Similarly, let x be a point on the edge 
                        
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           
                           ‾
                        
                     . Then 
                        
                           
                              b
                           
                           
                              3
                           
                        
                        (
                        x
                        )
                        =
                        0
                      and 
                        p
                        (
                        x
                        )
                        =
                        
                           
                              ∑
                           
                           
                              i
                              +
                              j
                              =
                              d
                           
                        
                        
                           
                              c
                           
                           
                              i
                              j
                              0
                           
                        
                        
                           
                              d
                              !
                           
                           
                              i
                              !
                              j
                              !
                           
                        
                        
                           
                              b
                           
                           
                              1
                           
                           
                              i
                           
                        
                        
                           
                              b
                           
                           
                              2
                           
                           
                              j
                           
                        
                     . Similar statements apply to the other two edges. It follows that the restriction of p to an edge is determined by the control points on that edge, and is independent of the other control points.

Consider now the smoothness conditions between two triangles as illustrated in Fig. 2
                      which show the domain points for two polynomials of degree 5. Because we always require the spline to be at least continuous we identify the domain and control points along the common edge. The 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      conditions are indicated by the shaded quadrilaterals of domain points. The two polynomials join differentiably iff each of the 5 quadrilaterals of 4 control points each lie in a plane. The plane need not be (and usually isn't) the same for all quadrilaterals, but there needs to be such a plane for each quadrilateral.

It is worthwhile to examine a detailed argument for why this is so, because this will illustrate the close interplay between algebra and geometry that is facilitated by the B-form.


                     
                        Theorem 1
                        
                           Let T be a non-degenerate triangle with vertices 
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           
                           , 
                           
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                            
                           and 
                           
                              
                                 
                                    v
                                 
                                 
                                    3
                                 
                              
                            
                           and let 
                           
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                            
                           be a non-degenerate triangle with vertices 
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           
                           , 
                           
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                            
                           and 
                           
                              
                                 
                                    v
                                 
                                 
                                    4
                                 
                              
                            
                           sharing the common edge 
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ‾
                              
                           
                           . For points 
                           
                              x
                              ∈
                              T
                            
                           let p be defined by
                           
                              
                                 (11)
                                 
                                    p
                                    (
                                    x
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          +
                                          j
                                          +
                                          k
                                          =
                                          d
                                       
                                    
                                    
                                       
                                          d
                                          !
                                       
                                       
                                          i
                                          !
                                          j
                                          !
                                          k
                                          !
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                            
                           and for points 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˜
                                 
                              
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    ˜
                                 
                              
                            
                           let 
                           
                              
                                 
                                    p
                                 
                                 
                                    ˜
                                 
                              
                            
                           be defined by
                           
                              
                                 (12)
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˜
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          ˜
                                       
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          +
                                          j
                                          +
                                          k
                                          =
                                          d
                                       
                                    
                                    
                                       
                                          d
                                          !
                                       
                                       
                                          i
                                          !
                                          j
                                          !
                                          k
                                          !
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          4
                                       
                                       
                                          k
                                       
                                    
                                    .
                                 
                              
                            
                           Then p and 
                           
                              
                                 
                                    p
                                 
                                 
                                    ˜
                                 
                              
                            
                           join continuously along the common edge if
                           
                              
                                 (13)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          j
                                          0
                                       
                                    
                                    ,
                                    
                                    i
                                    +
                                    j
                                    =
                                    d
                                    .
                                 
                              
                            
                           Moreover, they join differentiably if and only if, in addition, each of the quadrilaterals 
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    i
                                    +
                                    1
                                    ,
                                    j
                                    ,
                                    0
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                    +
                                    1
                                    ,
                                    0
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                    ,
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                    ,
                                    1
                                 
                              
                              }
                            
                           is planar.
                        


                     
                        Proof
                        For continuity we require that 
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    0
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    i
                                    j
                                    0
                                 
                              
                           , i.e., the control points along the common edge must coincide. Continuity also implies the continuity of directional derivatives along the common edge. To get continuity of all directional derivatives we need to have continuity of just one additional directional derivative in a direction that crosses the edge. Let D denote such a directional derivative operator. Note in passing that the direction does not need to be normalized, nor does it need to be perpendicular to the edge. But it must be in a direction not contained in the edge.

We will now compute this derivative on both triangles, restrict both derivatives to the common edge, set the difference of the two restrictions to zero, and examine the resulting equations.

We obtain
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             D
                                             p
                                             (
                                             x
                                             )
                                             
                                          
                                          
                                             =
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   +
                                                   j
                                                   +
                                                   k
                                                   =
                                                   d
                                                
                                             
                                             
                                                
                                                   d
                                                   !
                                                
                                                
                                                   i
                                                   !
                                                   j
                                                   !
                                                   k
                                                   !
                                                
                                             
                                             
                                                (
                                                i
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                D
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                                j
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                D
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      j
                                                   
                                                
                                                k
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                                D
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             =
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   +
                                                   j
                                                   +
                                                   k
                                                   =
                                                   d
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   (
                                                   d
                                                   −
                                                   1
                                                   )
                                                   !
                                                
                                                
                                                   i
                                                   !
                                                   j
                                                   !
                                                   k
                                                   !
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   b
                                                
                                                
                                                   3
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            where
                              
                                 (15)
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    d
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                       D
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ,
                                             j
                                             +
                                             1
                                             ,
                                             k
                                          
                                       
                                       D
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             +
                                             1
                                          
                                       
                                       D
                                       
                                          
                                             b
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

Note that 
                              D
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                           , 
                              D
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                            and 
                              D
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                            are constants because the barycentric coordinates are linear functions. Differentiating thus on both triangles, restricting the derivatives to the common edge, setting the difference to zero, and equating coefficients gives conditions of the form
                              
                                 (16)
                                 
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          1
                                       
                                    
                                    =
                                    0
                                 
                              
                            where 
                              i
                              +
                              j
                              =
                              d
                              −
                              1
                            and the coefficients 
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                           , and 
                              
                                 
                                    a
                                 
                                 
                                    4
                                 
                              
                            are independent of i and j. Moreover, after dividing by d they are also independent of the polynomial degree.

Thus we get a homogeneous linear relationship between the four control points of each of the shaded quadrilaterals which is independent of the polynomial degree, and that is the same for each quadrilateral. In the particular case that 
                              d
                              =
                              1
                            differentiability means that the piecewise linear function is actually linear. Because the control points at the vertices lie on the graph of the polynomial function this means that the four control points must lie in the same plane.

In the case that 
                              d
                              >
                              1
                            we get several congruent quadrilaterals that are similar to the union of the two triangles, i.e., the quadrilaterals for the case 
                              d
                              =
                              1
                           . We have the same algebraic relationship which, on similar quadrilaterals, implies the same geometric property: for each quadrilateral, the four control points must lie in a plane.  □

Similar arguments apply in the case that 
                        r
                        >
                        0
                     . The 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      condition can be interpreted as the requirement that the coefficients in the first row parallel to the common edge are obtained by evaluating the linear function defined on the triangle opposite to each point. The 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      conditions require similarly that coefficients in the second row be obtained by evaluating quadratic polynomials at opposite triangles containing 6 points. In general, 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      conditions require that the coefficients in the r-th row be obtained by evaluating polynomials of degree r in opposite triangles with 
                        (
                        
                           
                              
                                 
                                    r
                                    +
                                    2
                                 
                              
                           
                           
                              
                                 2
                              
                           
                        
                        )
                      points. A very general discussion of such conditions may be found in de Boor (1987).

We also note that because the coefficients of the smoothness conditions only depend on the barycentric coordinates of the vertex of a triangle with respect to the opposite triangle they are independent of any affine transformation applied to all vertices in a triangulation.

A major technique in B-form based spline research is the construction of a set of domain points such that the associated coefficients can be set arbitrarily, and any such assignment uniquely determines a spline in 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                     . More precisely, we define


                     
                        Definition 3
                        A set M of domain points is a determining set for 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                            if the only spline in 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                            that has all associated coefficients equal to zero is the zero spline. M is a minimal determining set (MDS) if it contains no smaller determining set.

It follows from basic linear algebra, see Lai and Schumaker (2007) for a detailed discussion, that all minimal determining sets have the same cardinality, and that that unique cardinality is the dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                        (
                        Δ
                        )
                     .


                     
                        Example 1
                        In the case 
                              r
                              =
                              0
                            there are no additional smoothness conditions and all coefficients of a spline can be set arbitrarily. In this case the minimal determining set is unique and includes all domain points. The dimension of 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                            is
                              
                                 (17)
                                 
                                    dim
                                    
                                    
                                       
                                          S
                                       
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    V
                                    +
                                    (
                                    d
                                    −
                                    1
                                    )
                                    E
                                    +
                                    
                                       
                                          (
                                          d
                                          −
                                          1
                                          )
                                          (
                                          d
                                          −
                                          2
                                          )
                                       
                                       2
                                    
                                    N
                                 
                              
                           
                        

The simplest example of the dependence of the dimension on the geometry of the underlying triangulation is provided by the very specific concept of a singular vertex.


                     
                        Definition 4
                        A singular vertex is an interior vertex of degree four such that the interior edges form two collinear pairs.

Thus we can think of a singular vertex as having been obtained by drawing the diagonals in a convex quadrilateral.


                     
                        Example 2
                        Let Δ be a triangulation consisting of four triangles sharing the interior vertex v. Then 
                              dim
                              
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                              =
                              8
                            if v is singular and 
                              dim
                              
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                              =
                              7
                            if v is not singular.

Consider first the generic case shown in Fig. 3
                     . It shows a triangulation of a square by four triangles all sharing one interior vertex. In this and most other figures in this paper the domain points shown as crosses inside a circle or square form a minimal determining set. Domain points shown as solid circles or squares correspond to coefficients that are implied by the smoothness conditions. The pictures have been obtained with the author's MDS software which can be downloaded from www.math.utah.edu/~pa/MDS. The particular MDS shown in the figure includes all points in the top triangle. The points marked as solid circles are then implied by the smoothness conditions indicated by the shaded quadrilaterals. Then any one of the three points marked as squares in the bottom row of domain points can be set and will imply the other two points. (In the figure the leftmost of the three points is set as indicated by the cross in a square.) Therefore any of these points can be added to the MDS. Thus a total of seven coefficients can be set. Now consider the singular case, shown in Fig. 4
                     . Here, again a square is triangulated by four triangles, but the interior edges form two pairs each of which is contained in a line. Therefore, the shaded quadrilaterals actually form triangles. The requirement that a quadrilateral be planar degenerates into the requirement that the three points along the base of the triangle be collinear, and the coefficient at the tip of the triangle is then arbitrary. The eight coefficients indicated with crosses in Fig. 4 can be set arbitrarily.

For stars of interior vertices, such as singular vertices, the dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                      is understood completely. (The star of a vertex v of a triangulation is the union of all triangles that contain v as a vertex.) The following Theorem is due to Schumaker (1979):


                     
                        Theorem 2
                        
                           Suppose Ω is the star of an interior vertex v and that E is the number of interior edges in it while e is the number of edges with different slopes attached to v. Then
                           
                              
                                 (18)
                                 
                                    dim
                                    
                                    
                                       
                                          S
                                       
                                       
                                          d
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Ω
                                    )
                                    =
                                    α
                                    +
                                    β
                                    E
                                    −
                                    γ
                                    +
                                    σ
                                 
                              
                            
                           where
                           
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                          
                                          
                                             α
                                             
                                          
                                          
                                             =
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                   (
                                                   d
                                                   +
                                                   1
                                                   )
                                                
                                                2
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             β
                                             
                                          
                                          
                                             =
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   d
                                                   −
                                                   r
                                                   )
                                                   (
                                                   d
                                                   −
                                                   r
                                                   −
                                                   1
                                                   )
                                                
                                                2
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             γ
                                             
                                          
                                          
                                             =
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                   (
                                                   d
                                                   +
                                                   1
                                                   )
                                                   −
                                                   (
                                                   r
                                                   +
                                                   1
                                                   )
                                                   (
                                                   r
                                                   +
                                                   2
                                                   )
                                                
                                                2
                                             
                                             ,
                                             
                                             
                                                and
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             σ
                                             
                                          
                                          
                                             =
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   d
                                                   −
                                                   r
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   (
                                                   r
                                                   +
                                                   j
                                                   +
                                                   1
                                                   −
                                                   j
                                                   e
                                                   )
                                                
                                                
                                                   +
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        

The proof of this theorem preceded the appearance of the B-form. However, in a later paper, Schumaker (1988), Schumaker analyzed the problem in terms of the B-form and gave a minimal determining set for spline spaces on vertex stars.

As mentioned earlier, a profound difference between univariate and multivariate splines is the fact that the dimension of a spline space may change with the geometry of the underlying partition. In the previous section, this is illustrated, and classified completely, for partitions consisting of the star of a single interior vertex. However, there are triangulations that require more than one interior vertex for the phenomenon to occur.

The simplest example of such a triangulation is the so-called Morgan–Scott Split, or Morgan–Scott Triangulation, Lai and Schumaker (2007). It was first described in the mid-seventies by Morgan and Scott (1975a), in an unpublished but widely read and distributed manuscript. The first known published reference is in Schumaker (1979). Figs. 5 and 6
                     
                      show two versions of the split. It consists of a triangulation of a triangular domain by seven triangles. In this case, 
                        
                           
                              V
                           
                           
                              B
                           
                        
                        =
                        
                           
                              V
                           
                           
                              I
                           
                        
                        =
                        3
                     . As before, crosses in circles show domain points in a minimal determining set, and filled circles indicate domain points for which corresponding coefficients are implied by the smoothness conditions. As shown in the figures, the dimension of 
                        
                           
                              S
                           
                           
                              2
                           
                           
                              1
                           
                        
                      is either 6, i.e., 
                        
                           
                              S
                           
                           
                              2
                           
                           
                              1
                           
                        
                      contains only polynomials, see Fig. 5, or else it is 7, see Fig. 6. Diener (1990) showed that in general the dimension of 
                        
                           
                              S
                           
                           
                              2
                              r
                           
                           
                              r
                           
                        
                      increases by 1 iff the three lines from a boundary vertex to the opposite interior vertex intersect in one point.


                     
                        Definition 5
                        A triangulation Δ is sensitive (with respect to r and d) if the dimension of 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              (
                              Δ
                              )
                            assumes more than one value, depending on the geometry of Δ. We say that Δ is minimally sensitive if no triangulation obtained from Δ by removing one or more triangles is sensitive.

As shown above, in Theorem 2 and Example 2, stars of interior vertices may be sensitive for specific values of r and d. In fact, it follows from Theorem 2 that such vertex stars are sensitive for sufficiently large values of r (and all 
                        d
                        >
                        r
                     ) whenever the number of triangles sharing the vertex is greater than 3. Sensitive vertex stars are also minimally sensitive. The Morgan–Scott split is minimally sensitive with respect to 
                        r
                        >
                        0
                      and 
                        d
                        =
                        2
                        r
                     .

Larger sensitive triangulations can be constructed, and I make the following


                     
                        Conjecture 1
                        
                           There are minimally sensitive triangulations with arbitrarily many triangles all of whose edges are interior.
                        

As shown in Example 1, in the case 
                        r
                        =
                        0
                      the dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              0
                           
                        
                      is simply the number of domain points and no triangulation is sensitive.

It is well known and understood that spline spaces have a generic dimension. We verify its key property here because this illustrates another application of the B-form. As before, we think of a triangulation as having fixed combinatorics, and a fixed topology, and consider changes in the location of the vertices that do not change the combinatorics or topology. The generic dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                      over all triangulations with the same topology and combinatorics is the minimum possible value of that dimension, cf., Definition 9.29 in Lai and Schumaker (2007), p. 262.

The term generic is explained by the following:


                     
                        Theorem 3
                        
                           Suppose the dimension of 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              (
                              Δ
                              )
                            
                           does not equal the generic dimension for some triangulation Δ. Then there exists an arbitrarily small perturbation of the locations of the vertices such that the dimension of 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    ˜
                                 
                              
                              )
                            
                           equals the generic dimension, where 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    ˜
                                 
                              
                            
                           is the modified triangulation.
                        


                     
                        Proof
                        Consider 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              (
                              Δ
                              )
                            a subspace of 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              (
                              Δ
                              )
                            that is determined by the homogeneous smoothness conditions 
                              A
                              c
                              =
                              0
                            where c is the vector of coefficients of a spline in 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              (
                              Δ
                              )
                            and A is the matrix of smoothness conditions of the form given for the case 
                              r
                              =
                              1
                            in Equation (16). Then
                              
                                 (20)
                                 
                                    dim
                                    
                                    
                                       
                                          S
                                       
                                       
                                          d
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Δ
                                    )
                                    =
                                    dim
                                    
                                    
                                       
                                          S
                                       
                                       
                                          d
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    Δ
                                    )
                                    −
                                    rank
                                    (
                                    A
                                    )
                                    .
                                 
                              
                            Suppose the vertices of Δ are such that the dimension of 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                            assumes its minimal, generic, value. Then the rank R of A assumes its maximum possible value and we can reorder the rows and columns of A such that
                              
                                 (21)
                                 
                                    A
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      11
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      12
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      21
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      22
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    A
                                 
                                 
                                    11
                                 
                              
                            is a non-singular 
                              R
                              ×
                              R
                            matrix. If the vertices are located so that the dimension of 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                            is greater than the generic value, then the determinant of 
                              
                                 
                                    A
                                 
                                 
                                    11
                                 
                              
                            must be zero. However, the entries of A are rational functions of the locations of the vertices. The determinant of 
                              
                                 
                                    A
                                 
                                 
                                    11
                                 
                              
                            is a rational function as well that is non-zero for some triangulations. A non-zero rational function cannot vanish identically in the neighborhood of a point and so there must be an arbitrarily small perturbation of the location of the vertices that causes the determinant of 
                              
                                 
                                    A
                                 
                                 
                                    11
                                 
                              
                            to become non-zero and the dimension of 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                            to assume its generic value.  □

A major application of multivariate splines is the interpolation of given data, for example, function values at the vertices of a triangulation. Whether this is possible or not may also depend on the geometry of the triangulation.

Consider 
                        
                           
                              S
                           
                           
                              2
                           
                           
                              1
                           
                        
                      on a triangulation of a hexagon by six triangles sharing one interior vertex. Two such triangulations are shown in Figs. 7 and 8
                     
                     . Fig. 8 shows a regular hexagon with the interior vertex in its center. (The aspect ratio is different from 1 in the figure, but this does not affect the interpolation property or dimension of 
                        
                           
                              S
                           
                           
                              2
                           
                           
                              1
                           
                        
                     .) Suppose we want to interpolate function values at the vertices of the hexagon. This means we need to include the vertices in the minimal determining set. The dimension of 
                        
                           
                              S
                           
                           
                              2
                           
                           
                              1
                           
                        
                      is 9, according to Theorem 2, which is certainly large enough to interpolate at 6 points. Indeed, interpolation is almost always possible. However, as shown in the figures, interpolation is not possible on the regular hexagon. Fig. 9
                      shows why this is so. Consider a spline that is zero at the 5 points marked with crosses in circles. Four of the domain points are labeled according to the corresponding coefficients as a, b, c and d. Because the hexagon is regular, with the interior vertex of the center, the planarity condition for all quadrilaterals with coefficients A, B, C and D, where A and B lie on the common edge, becomes 
                        D
                        =
                        A
                        +
                        B
                        −
                        C
                     . Thus the smoothness conditions imply that the remaining coefficients equal the expressions indicated in the figure. At the point marked with a filled circle the coefficient has to be 
                        (
                        b
                        −
                        d
                        )
                        −
                        (
                        a
                        +
                        b
                        −
                        c
                        )
                        +
                        (
                        a
                        −
                        c
                        +
                        d
                        )
                      which equals zero regardless of the values of a, b, c and d. The article (Allen et al., 2016) by Alexei Kolesnikov and several student coworkers elsewhere in this issue analyzes the situation in detail and shows that one can interpolate in general unless, up to a projective transformation, the hexagon is regular with the interior vertex at the center.

The example discussed in the preceding section arose in the construction of a basis for 
                        
                           
                              S
                           
                           
                              4
                           
                           
                              1
                           
                        
                      on general triangulations (Alfeld et al., 1987). There the concept of a confinable vertex is introduced. An interior vertex v is confinable if there exists a minimal determining set of 
                        
                           
                              S
                           
                           
                              2
                           
                           
                              1
                           
                        
                        (
                        star
                        (
                        v
                        )
                        )
                      that contains the boundary vertices of star(v). Thus the interior vertex of the triangulation shown in Fig. 8 is not confinable. It is also the only non-confinable kind of vertex I am aware of. Confinable vertices played a key role in the construction of a basis for 
                        
                           
                              S
                           
                           
                              4
                           
                           
                              1
                           
                        
                     , which turned out to be quite complicated. However, it is easy to construct, again exploiting the properties of the B-form, a minimal determining set (and hence a basis) for 
                        
                           
                              S
                           
                           
                              4
                           
                           
                              1
                           
                        
                      on a large class of triangulations.


                     
                        Theorem 4
                        
                           Suppose Δ is a triangulation where no two edges attached to the same vertex are collinear. Then
                           
                              
                                 (22)
                                 
                                    dim
                                    
                                    
                                       
                                          S
                                       
                                       
                                          4
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    Δ
                                    )
                                    =
                                    6
                                    V
                                    −
                                    3
                                    .
                                 
                              
                            
                           Moreover, on such triangulations one can interpolate with 
                           
                              
                                 
                                    S
                                 
                                 
                                    4
                                 
                                 
                                    1
                                 
                              
                            
                           to function and gradient values at the vertices of the triangulation.
                        

The proof is by induction on the number of vertices. Details are in Alfeld et al. (1987) but Fig. 10
                      illustrates the main idea. Build the triangulation by adding one boundary vertex and all edges connecting it to the boundary of the triangulation constructed so far. The number of vertices increases by 1, and we have to show that the size of the minimal determining set increases by 6. In the figure, the new vertex is the boundary vertex on top of the figure. Points already in the minimal determining set and points determined by that set are marked with small filled circles. The two points marked with outlined triangles do not enter any smoothness conditions and become members of the new minimal determining set. The three points marked with crosses inside a circle can be set and together determine the tangent plane at the new vertex. They also determine all remaining points, shown as large filled circles, in the 1-disk around the new vertex. The remaining points not yet determined are shown as square boxes. Any one of them can be added to the minimal determining set, and determines the others. One specific such choice, the leftmost box, is shown in the figure. The total number of points added is 6. Because the added points include three points determining the tangent plane at the new vertex interpolation to function and gradient values at the new vertex, and by induction at all vertices, is possible.

It is not known whether one can interpolate with 
                        
                           
                              S
                           
                           
                              4
                           
                           
                              1
                           
                        
                      to function and gradient values on all triangulations. I may well be wrong, but I expect one cannot: 
                        Conjecture 2
                        
                           There are triangulations on which interpolation of function and gradient values at all vertices with 
                           
                              
                                 
                                    S
                                 
                                 
                                    4
                                 
                                 
                                    1
                                 
                              
                            
                           is not possible.
                        

The most famous outstanding problem in bivariate spline research concerns the dimension of 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              1
                           
                        
                      on a general triangulation. Using B-form techniques one can see easily:


                     
                        Theorem 5
                        
                           Let Δ be a triangulation with 
                           
                              
                                 
                                    V
                                 
                                 
                                    B
                                 
                              
                            
                           boundary vertices, 
                           
                              
                                 
                                    V
                                 
                                 
                                    I
                                 
                              
                            
                           interior vertices, and σ singular vertices. Then
                           
                              
                                 (23)
                                 
                                    dim
                                    
                                    
                                       
                                          S
                                       
                                       
                                          3
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    Δ
                                    )
                                    ≥
                                    3
                                    
                                       
                                          V
                                       
                                       
                                          B
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          V
                                       
                                       
                                          I
                                       
                                    
                                    +
                                    1
                                    +
                                    σ
                                    .
                                 
                              
                           
                        

This result follows, for example, from the more general Theorem 9.9 in Lai and Schumaker (2007), p. 240, but a simple idea that is specific to 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              1
                           
                        
                      is outlined in Fig. 11
                     . Think of 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              1
                           
                        
                      as a subspace of the larger space 
                        
                           
                              
                                 
                                    S
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              3
                           
                           
                              0
                           
                        
                      which is the space of all splines in 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              0
                           
                        
                      that are differentiable at the vertices (but not necessarily across interior edges). A minimal determining set for that larger space can be formed by choosing 3 points in each 1-disk around a vertex and the centroids of the triangle (shown as outlined small triangles in the figure). The dimension of 
                        
                           
                              
                                 
                                    S
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              3
                           
                           
                              1
                           
                        
                     , therefore, is
                        
                           (24)
                           
                              dim
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    3
                                 
                                 
                                    0
                                 
                              
                              =
                              3
                              (
                              
                                 
                                    V
                                 
                                 
                                    B
                                 
                              
                              +
                              
                                 
                                    V
                                 
                                 
                                    I
                                 
                              
                              )
                              +
                              N
                           
                        
                      where N is the number of triangles in the triangulation. A spline in 
                        
                           
                              
                                 
                                    S
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              3
                           
                           
                              0
                           
                        
                        (
                        Δ
                        )
                      is actually in 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              1
                           
                        
                      if the smoothness conditions across interior edges, shown as shaded quadrilaterals in the figure, are all satisfied. There is one such condition for each of the 
                        
                           
                              E
                           
                           
                              I
                           
                        
                      interior edges. However, these smoothness conditions may not be linearly independent, and so some of them may be superfluous. In fact, we know that at a singular vertex one of them is implied by the other three. Thus
                        
                           (25)
                           
                              dim
                              
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                                 
                                    1
                                 
                              
                              ≥
                              dim
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    3
                                 
                                 
                                    0
                                 
                              
                              −
                              
                                 
                                    E
                                 
                                 
                                    I
                                 
                              
                              +
                              σ
                              =
                              3
                              (
                              
                                 
                                    V
                                 
                                 
                                    B
                                 
                              
                              +
                              
                                 
                                    V
                                 
                                 
                                    I
                                 
                              
                              )
                              +
                              N
                              −
                              
                                 
                                    E
                                 
                                 
                                    I
                                 
                              
                              +
                              σ
                           
                        
                      Using the Euler relations (5) the inequality (23) follows.

No case is known where the inequality holds strictly, and so far nobody has been able to prove that inequality is always true with equality. The dimension problem was first described by Strang (1973) where he considered 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              1
                           
                        
                      on a special (“Type I”) triangulation with periodic boundary conditions. The space 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              1
                           
                        
                      on general triangulations has been much studied and everybody whose opinion I know (see also page 275 of Lai and Schumaker, 2007) agrees with the long standing 
                        Conjecture 3
                        
                           For all triangulations Δ
                              
                                 (26)
                                 
                                    dim
                                    
                                    
                                       
                                          S
                                       
                                       
                                          3
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    Δ
                                    )
                                    =
                                    3
                                    
                                       
                                          V
                                       
                                       
                                          B
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          V
                                       
                                       
                                          I
                                       
                                    
                                    +
                                    1
                                    +
                                    σ
                                 
                              
                           
                        

The case 
                        r
                        =
                        1
                      and 
                        d
                        =
                        3
                      is particularly interesting for applications because it provides the smallest value of d such that the dimension exceeds the number of vertices and so one can hope to be able to interpolate with a differentiable function to function values at the vertices. However, to date it is also unknown whether that is in fact always possible. I think it probably is: 
                        Conjecture 4
                        
                           For all triangulations Δ it is possible to interpolate function values at the vertices of Δ with 
                           
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                           
                        

In 1975 Morgan and Scott (1975b) published a pioneering and influential paper in which they constructed a nodal basis for 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                      in the case that 
                        d
                        ≥
                        5
                     . Their paper preceded the development of the B-form a few years later by Farin (1979). However, I was only able to understand the Morgan–Scott paper after translating it into the B-form, which is why I titled this section the Morgan–Scott idea. That idea is illustrated in Fig. 12
                      (where 
                        r
                        =
                        1
                      and 
                        d
                        =
                        7
                     ). Divide the domain points into sets. These are disks of radius 2 around the vertices (shown as filled circles), layers of thickness 1 paralleling edges (shown as filled squares), and points (shown as outlined circles) that do not enter any smoothness conditions. In general, the layers along edges are r rows deep. The disks around the vertices do not overlap and are sufficiently large so that the edge layers do not intersect. This implies that the radius of the vertex disks must be at least 2r and that 
                        d
                        >
                        4
                        r
                     . The vertex disks can then be analyzed individually. This is in effect what Morgan and Scott did in the case that 
                        r
                        =
                        1
                     , and what Schumaker did for general r in Schumaker (1988). The analysis of the edge layers then becomes trivial. Just include the points on the edge, and on one side of it, in the minimal determining set. Finally, include all points that do not enter smoothness conditions in the minimal determining set. That's effectively the program carried out in Alfeld and Schumaker (1987).

If in fact 
                        d
                        <
                        4
                        r
                        +
                        1
                      then the vertex disks start to overlap and the analysis becomes non-local. If the overlap is small the analysis can still be carried out, with more effort. The case 
                        
                           
                              S
                           
                           
                              4
                           
                           
                              1
                           
                        
                      was studied in Alfeld et al. (1987). Don Hong analyzed the case 
                        d
                        ≥
                        3
                        r
                        +
                        2
                      in a remarkable M.S. thesis which was later published as Hong (1991). The generic case for 
                        d
                        =
                        3
                        r
                        +
                        1
                      was analyzed in Alfeld and Schumaker (1990). The generic dimension of 
                        
                           
                              S
                           
                           
                              2
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              S
                           
                           
                              3
                           
                           
                              1
                           
                        
                      is also known and was obtained by algebraic techniques by Billera (1988) and Whiteley (1991).

That is where matters stand at the moment. Very little is known about the dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                      where 
                        r
                        >
                        1
                      and 
                        r
                        <
                        d
                        <
                        3
                        r
                        +
                        1
                     .

It is natural to consider splines on tetrahedral partitions of a polyhedral domain, and many of the ideas carry over from the bivariate case. The B-form can be defined on tetrahedra in essentially the same way as on triangles. (In fact, the form applies just as simply on k-dimensional simplices, see de Boor, 1987 for a rigorous discussion.) The smoothness conditions between tetrahedra transfer in a natural way. The Morgan–Scott idea now requires that 
                        d
                        ≥
                        8
                        r
                        +
                        1
                      (and 
                        d
                        ≥
                        
                           
                              2
                           
                           
                              k
                           
                        
                        r
                        +
                        1
                      for k-dimensional domains).

There is, however, one new major issue. In two variables, we can understand everything if d is sufficiently large. However, on general tetrahedral partitions, in order to have a dimension formula for 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                      for sufficiently large values of d, we must first have a dimension formula for 
                        
                           
                              S
                           
                           
                              δ
                           
                           
                              r
                           
                        
                      on two dimensional triangulations for all values of 
                     δ.


                     Fig. 13
                      illustrates why this is so. Start with any triangulation in the plane. Add a point above the plane, and connect it to every vertex in the planar triangulation (in a process called coning). This results in a tetrahedral decomposition that does not even contain an interior vertex. The smoothness conditions decouple into layers which are identical to the smoothness conditions for 
                        
                           
                              S
                           
                           
                              δ
                           
                           
                              r
                           
                        
                      on the initial planar triangulation and 
                        δ
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        d
                     . (In one lower dimension this decoupling corresponds to the degeneration of a quadrilateral into a triangle in the presence of pairs of collinear edges, see the discussion of a singular vertex earlier in this paper.) All of these separate sets of conditions must be understood in order to understand the dimension of the trivariate spline space.

For bivariate spline spaces, the generic dimensions of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                      are known for all d. This made it possible to derive a formula for the dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                      on tetrahedral decompositions, for 
                        d
                        ≥
                        8
                     , see Alfeld et al. (1993).

Bounds on the dimension are of course also known, see Alfeld and Schumaker (2007) for the trivariate case, and Alfeld (1996) for the general multivariate case.

A major application, and active research area, of multivariate splines, which I only mention in passing, is the construction of macro elements. The word “macro” basically means that everything concerning the spline can be done and analyzed in terms of its restriction to a single triangle in the underlying triangulation. In particular, the spline can be specified on a single triangle in terms of domain points in that triangle, or function and derivative data on that triangle. If the data are given one has an interpolation problem and the scheme is called a macro element. If the data are parameters that are determined by solving a global system, approximating, for example, the solution of a differential equation, we refer to a finite element. Sometimes the triangles of the original triangulation are subdivided, each in the same way, into micro triangles, with a view towards reducing the required polynomial degree. The design of macro, or finite, elements is a huge subject which easily would fill a survey paper of the same or larger length as this one. We refer the reader to the monograph (Lai and Schumaker, 2007) for more information. See in particular chapters 6–8 and 18. Some macro elements that appeared only after that book was published can be found in Schumaker et al. (2009), Alfeld and Sorokina (2009, in press), and Alfeld et al. (2010). In the design and analysis of all of these recent schemes, and most of those described in Lai and Schumaker (2007), the B-form played a central role.

The author has written extensive software that can be used to construct minimal determining sets for splines on planar triangulations and tetrahedral decompositions, among other tasks. The software is freely available on

  
                     www.math.utah.edu/~pa/
                  

There is also software for the analysis of splines on T-meshes which are not addressed in this paper.

@&#ACKNOWLEDGEMENTS@&#

Long ago I was an undergraduate student in Hamburg, and even in those days everybody there talked about Oberwolfach all the time. As an impressionable student I developed the idea that Oberwolfach is the center of the mathematical universe, and little has happened since that would cause me to modify that opinion. I am grateful to the Mathematisches Forschungsinstitut Oberwolfach for hosting this conference, the organizers, Tanya Sorokina, Hal Schenck, and Larry Schumaker, for organizing the conference and inviting me to participate, and my fellow participants for their cheerful companionship during the conference. The conference was utterly enjoyable and perfect in every way! I would also like to acknowledge the very careful reading of an earlier version of this paper by two anonymous referees whose comments improved the paper. Finally, I want to acknowledge the exceptionally smooth final proof reading and typesetting process based on Elsevier's new and ground breaking Sky
                     
                   system.

@&#REFERENCES@&#

