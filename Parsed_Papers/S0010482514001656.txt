@&#MAIN-TITLE@&#A new algorithm and problems in automatic anterior eye chamber volume determining

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We showed the problem of automatic determination of the anterior eye chamber volume.


                        
                        
                           
                           60,000 images were obtained using OCT SS-1000 CASIA and Zeiss Visante OCT.


                        
                        
                           
                           The proposed algorithm gave the anterior chamber surface measurement error at the level of 4.3%.


                        
                        
                           
                           The proposed algorithm enables to obtain reproducible results fully automatically.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Anterior eye chamber

Image processing

Measurement automation

Segmentation

Volume

@&#ABSTRACT@&#


               
               
                  This study investigates the problem of automatic determination of the anterior eye chamber volume using previously published as well as new algorithms of image analysis and processing proposed by the authors. A new method for determining the anterior eye chamber volume that provides more accurate results has been proposed. The entire algorithm was implemented in Matlab and C language. 60,000 images were obtained using OCT SS-1000 CASIA and Zeiss Visante OCT. The acquired images of the anterior segment of the eye had a resolution of 256×1024 pixels with a measuring range of 8×16mm2. The images were acquired during routine medical examination at the Clinical Department of Ophthalmology, District Railway Hospital in Katowice, Poland, and were analysed in accordance with the Declaration of Helsinki. The new algorithm uses edge detection, morphological operations, binarization and filtration. The proposed algorithm gave the anterior chamber surface measurement error at the level of 4.3% and the anterior chamber volume measurement error of 12%. For comparison, the surface measurement error of the tomograph software was at 6.7%. Thus the obtained results were better by 2.4%. The proposed algorithm provides reproducible results automatically at a runtime of 3s per patient using a Core i7 PC computer with 8GB of RAM.
               
            

@&#INTRODUCTION@&#

Measurements of anterior eye segment parameters are essential in diagnosis and selection of treatment methods for a variety of ocular diseases including glaucoma, corneal pathologies and cataracts. Several imaging techniques have been used for anterior chamber depth (ACD) assessment: Scheimflug camera [1,2], scanning-slit topography [3,4], ultrasonic immersion instruments [5,6] and optical coherence tomography [7,8].

Optical coherence tomography (OCT) is a high-speed, high-resolution, non-contact optical imaging technique developed for noninvasive cross-sectional imaging in biologic systems. The technique was first introduced in 1991 [9] and became commercially available in 1995. Time-Domain OCT technology has longitudinal resolution of 18μm and transverse resolution of 60μm. It provides scans at a rate of up to 2048 A-scans per second. TD-OCT uses 820nm wavelength for retinal imaging and 1310nm wavelength for anterior eye segment examination. It enables precise morphometric evaluation and has good, proven repeatability and reproducibility [10–12]. Fourier-Domain Optical Coherence technology introduced in 2002 scans at 26,000 A-scans per second and provides detailed cross-sectional images of biological structures with axial resolution of 5.0μm and transverse resolution of 15μm [13,14]. Since 2003, there has been a 3-dimentional Fourier domain, anterior eye segment OCT based on available swept-source technology (SS-OCT) [15,16]. The measurement speed of commercial SS-OCT is 30,000 A-scans per second, it has high robustness against sample motion and is capable of obtaining full 3D images of ocular tissues [16].

OCT has been increasingly used to diagnose and monitor a variety of retinal and anterior chamber diseases [17,18]. It provides images of anterior segment structures, including the cornea, iris, angle and lens. Corneal thickness measurement and anterior segment morphology assessment obtained with OCT play an essential role in keratorefractive procedures [19], Goldmann applanation tonometry measurements [20,21], glaucoma surgery and corneal transplantation procedures [22,23].

Methods for measuring anterior eye chamber parameters involve primarily measurements of its width and depth on one of B-scans of a tomographic image [24]. The width calculation is based on designation of the apex positions of the iridocorneal angles (
                     Fig. 1). The length of the line connecting the apices AR1 and AR2 is the anterior chamber width. The perpendicular drawn in its centre is used for measuring the anterior chamber depth (ACD). ACD is the distance from the corneal endothelium to the lens anterior surface. In addition, a tomograph sets parameters such as central corneal thickness (CCT) and others [25]. Fig. 1(b) shows the Region Of Interest (ROI) designated by a tomograph, which is the anterior chamber surface. At present, these parameters are calculated in tomographs fully automatically [26]. It is also possible to correct them manually or, in extreme cases, characteristic points, e.g. AR1 and AR2, can be designated manually. Depending on the tomograph type, it is possible to improve calculation accuracy by increasing the number of B-scans required for 3D reconstruction of the anterior chamber. 3D reconstruction of the anterior chamber is completed with B-scans arranged in the shape of a star [27] with respect to the main axis of symmetry of the eye.

The presented known methods and the parameters such as depth, width, or the anterior chamber surface [28] obtained on their basis are not free of errors. The main problems are a limited number of B-scans (usually one) and inaccurate representation of the iris contour [29]. Examples are patients who have the lens and the iris disposed above or below the lines AR1 and AR2 (drawn between the apices of the iridocorneal angle). In these cases, shown in 
                     Fig. 2, there are problems with overestimation or underestimation of the volume (estimated based on the width and depth) [30]. Determination of the lens position or the correct iris contour constitutes a similar problem (Fig. 1b, Fig. 2). Adaptation of the algorithm to the large interindividual variability in patients or race, e.g. the difference between Caucasians and Asians, is also significant [31].

As far as image analysis and processing are concerned, all kinds of such methods which enable to determine contours play the key role in the anterior chamber volume analysis. These are usually the inner and outer contours of the cornea, iris, sclera and lens. Typical methods are based on the well-known edge detectors such as Sobel, Prewitt and Canny filters. However, these methods cannot cope with large interindividual variability. Also shadows and uneven brightness that occur in OCT images constitute a problem. The known methods of image analysis and processing must be profiled or new methods dedicated to solving this type of problems must be proposed [27]. These methods, however, involve significant zooming of the lens or corneal contour and, as a result, they introduce a statistically significant measurement error. Zooming methods are usually based on polynomial approximation using anthropometric data of the eye. Thus, the effect of shadows in OCT images is offset to a limited extent but, at the same time, it leads to a significant generalization of the detected contour. Depending on the extent of pathology and interindividual variability, smoothing the shape of the contour causes significant errors in detecting the anterior chamber volume or its surface on one of B-scans.

Therefore, there is a need to propose new, more accurate methods for image analysis and to show the impact of the measurement methods used in tomographs on the results obtained. The proposed new algorithm for image analysis and processing provides reproducible results, regardless of the race of the test subjects, the extent of pathology or type of the OCT device. It is discussed in detail in the next section.

60,000 images were obtained using OCT SS-1000 CASIA and Zeiss Visante OCT. The acquired images of the anterior segment of the eye had a resolution of 256×1024 pixels with a measuring range of 8×16mm2, which gave 0.0313×0.0156mm2/pixel. The images were acquired during routine medical examination at the Clinical Department of Ophthalmology, District Railway Hospital in Katowice, Poland, and were analysed in accordance with the Declaration of Helsinki. The subjects were all Europeans from the Caucasian ethnic group. There were 356 subjects, including 234 patients, aged 16–88. All the images were saved anonymously. They were all analysed, each B-scan, for all groups of patients: healthy subjects and patients including those with corneal transplants and other ophthalmic diseases.

To evaluate the method error, 100 images (from 50 healthy subjects and 50 patients) were separated from the group of 60,000 images for which a specialist doctor manually marked the anterior chamber contour. The acquired information was stored in a vector containing the coordinates of the rows and columns of individual points.

@&#METHOD@&#

Image pre-processing involves the removal of small artefacts and noise resulting from the imperfections of the measurement path and the entering pollution. For this purpose, the input image L
                        
                           GRAY
                         with a resolution of M×N=256×1024 pixels (M – number of rows, N – number of columns of the image) is filtered with a median filter with a mask h sized M
                        
                           h
                        ×N
                        
                           h
                        =3×3 pixels. The result is the image L
                        
                           MED
                        . The size of the filter mask h was chosen on the basis of medical evidence regarding the size of the artefacts found in the B-scan of a tomographic image [32,33] and the resolution of the image L
                        
                           GRAY
                        . Artefacts and other disturbances that appear in the acquired images are clusters of fewer than 4 pixels. This means that for the filter mask resolution of M
                        
                           h
                        ×N
                        
                           h
                        =3×3 pixels, and in accordance with the definition, they will be replaced by the median value of the background area of 3×3 pixels. On the other hand, the smallest objects visible in the images which are fragments of the iris have a size 5×5 pixels or more. Therefore, the adopted median filter mask size will result in the removal of small artefacts from the image leaving small, diagnostically relevant, objects. In the general case, when using the proposed algorithm, the median filter mask size must be matched once to the resolution of the input image L
                        
                           GRAY
                         and the tomograph individual settings. The use of another filter type in image pre-processing leads to poorer results (e.g. averaging filter) or unnecessary complications of the algorithm computational complexity (e.g. adaptive filters). Next, the image L
                        
                           MED
                         is subjected to further processing steps.

The image L
                        
                           MED
                         undergoes operations profiled to the analysis of the contours of the cornea, iris and lens. To this end, each n-th column of the image L
                        
                           MED
                         is analysed. A binary image which uses a threshold p
                        
                           r
                        (n) chosen according to the Otsu equation [34] is designated
                           
                              (1)
                              
                                 
                                    
                                       L
                                    
                                    
                                       B
                                       I
                                       N
                                    
                                 
                                 (
                                 m
                                 ,
                                 
                                 n
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         M
                                                         E
                                                         D
                                                      
                                                   
                                                   (
                                                   m
                                                   ,
                                                   
                                                   n
                                                   )
                                                   >
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   other
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where m, n is the coordinates of the rows and columns of the matrix m∈(1,M) and n∈(1,N)

The formula (1) applied to the pre-filtered image L
                        
                           MED
                         leads to the formation of visible noise in the form of isolated white pixel clusters. In order to eliminate them, a morphological close operation is performed for the chosen size of the structural element SE, i.e.
                           
                              (2)
                              
                                 
                                    
                                       L
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       S
                                       E
                                    
                                 
                                 (
                                 
                                    
                                       max
                                    
                                    
                                       S
                                       E
                                    
                                 
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       B
                                       I
                                       N
                                    
                                 
                                 )
                                 )
                              
                           
                        
                     

On the basis of Eq. (2), labelling is carried out, which enables to label each cluster separately. The label value is in the range from i equal to 1 to I, thus i∈(1,I). The value I is the maximum number of detected clusters. The resulting image L
                        
                           LAB
                         is further subjected to filtration, which enables the detection of objects smaller than the minimum thickness of the cornea and iris. This value for the resolution of 256×1024 pixels gives a minimum of p
                        
                           r2=15 pixels, i.e.
                           
                              (3)
                              
                                 
                                    
                                       L
                                    
                                    
                                       B
                                       I
                                       N
                                       2
                                    
                                 
                                 (
                                 m
                                 ,
                                 
                                 n
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                   (
                                                   i
                                                   )
                                                   >
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         r
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   other
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              (4)
                              
                                 
                                    
                                       L
                                    
                                    
                                       S
                                    
                                 
                                 (
                                 i
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         m
                                                         =
                                                         1
                                                      
                                                      M
                                                   
                                                   
                                                      ∑
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         L
                                                         A
                                                         B
                                                      
                                                   
                                                   (
                                                   m
                                                   ,
                                                   
                                                   n
                                                   )
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         L
                                                         A
                                                         B
                                                      
                                                   
                                                   (
                                                   m
                                                   ,
                                                   
                                                   n
                                                   )
                                                   =
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   other
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Based on the image L
                        
                           BIN2, the image L
                        
                           K
                         is designated containing inner and outer corneal contours and the outer contours of the iris and the lens, i.e.
                           
                              (5)
                              
                                 
                                    
                                       L
                                    
                                    
                                       K
                                    
                                 
                                 (
                                 m
                                 ,
                                 
                                 n
                                 )
                                 =
                                 (
                                 
                                    
                                       min
                                    
                                    
                                       S
                                       E
                                    
                                 
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       B
                                       I
                                       N
                                       2
                                    
                                 
                                 (
                                 m
                                 ,
                                 
                                 n
                                 )
                                 )
                                 )
                                 
                                    
                                       v
                                    
                                    ̲
                                 
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       B
                                       I
                                       N
                                       2
                                    
                                 
                                 (
                                 m
                                 ,
                                 
                                 n
                                 )
                                 )
                              
                           
                        Where 
                           
                              
                                 v
                              
                              ̲
                           
                         is the xor operation (exclusive or).

Examples of each of these transformations are shown in 
                        Table 1. The inner contour ICC(n) and outer contour OCC(n) of the cornea as well as the iris outer contour ICI(n) and the lens outer contour OCL(n) are designated as the next values of the matrix L
                        
                           D
                         other than zero, i.e.
                           
                              (6)
                              
                                 
                                    
                                       L
                                    
                                    
                                       D
                                    
                                 
                                 (
                                 m
                                 ,
                                 
                                 n
                                 )
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       K
                                    
                                 
                                 (
                                 m
                                 ,
                                 
                                 n
                                 )
                                 m
                              
                           
                        In the absence of information about the location of any of the contours, the value “0” is assigned. The image L
                        
                           BIN2 is therefore the one which provides information about the location of each contour (of the cornea, iris, lens, sclera). This depends on the location and, to be more exact, on the order of occurrence of edges for each column. The first one at the top is the outer edge of the cornea or iris. The second one, depending on the location, is the inner edge of the cornea or iris. The third edge is the outer edge of the iris. These locations are closely dependent on the place of analysis – the next column. For a properly performed B-scan, detection of the second inner edge guarantees correct localization of individual elements – iris, iridocorneal angle or sclera (according to the afore-mentioned Table 1).

The results obtained are shown in 
                        Fig. 3. The behaviour of the proposed algorithm in areas covering the lens, iris and outside the eye (extreme left and right areas) is visible. In practice, the described methodology works correctly in 80% of analysed cases at a resolution of 8 bits per pixel. The algorithm is very sensitive to noise in the form of large isolated objects. Sometimes this type of noise is not completely filtered out at the stage of filtering provided. Automatic disorder in distinguishing proper contours is carried forward to the next steps of the algorithm. Due to the specifics of the algorithm (automatically selected threshold p
                        
                           r
                        (n)), there are no local large holes in objects (for the selected range of columns). Smaller gaps are automatically filtered out in subsequent steps of the algorithm. For this reason, the algorithm is resistant to noise and local artefacts – with the exception of large isolated objects, as noted above.

The inner corneal contour ICC(n) and the outer iris contour ICI(n) are used to automatically detect the positions of points AR1 and AR2. The points AR1 and AR2 are the apices of the iridocorneal angle. The method for finding apices of the iridocorneal angle was used here and is common for the following methods [35]:
                           
                              •
                              
                                 AOD (Angle Opening Distance) involving the measurement of the distance between the point of the cornea about 500μm away from the scleral spur and the opposite point of the iris,


                                 TIA (Trabecular-Iris Angle) involving direct measurement of the angle,


                                 TISA (Trabecular-Iris Space Area) involving the measurement of the surface calculated in the area bounded by the cornea and iris covering 500μm,


                                 AOM (Angle Opening Minimum) involving determination of the minimum distance between the iris contour and the corneal contour in the range of 500μm or 750μm from the scleral spur.

These methods are shown demonstratively in 
                        Fig. 4a and, in practice, in the tomographic image in Fig. 4b. Having designated the points AR1 and AR2 with coordinates (m
                        
                           AR1,n
                        
                           AR1) and analogously (m
                        
                           AR2,n
                        
                           AR2), the width of the anterior chamber is defined as follows:
                           
                              (7)
                              
                                 A
                                 R
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   A
                                                   R
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   m
                                                
                                                
                                                   A
                                                   R
                                                   2
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   n
                                                
                                                
                                                   A
                                                   R
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   A
                                                   R
                                                   2
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        
                     

Anterior chamber depth is calculated as the distance between the points ACD1 and ACD2. The point ACD1 with coordinates (m
                        
                           ACD1,n
                        
                           ACD1) is the point located at the centre between the points AR1 and AR2, i.e.
                           
                              (8)
                              
                                 
                                    
                                       m
                                    
                                    
                                       A
                                       C
                                       D
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       A
                                       R
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             A
                                             R
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             m
                                          
                                          
                                             A
                                             R
                                             2
                                          
                                       
                                    
                                    2
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       n
                                    
                                    
                                       A
                                       C
                                       D
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       n
                                    
                                    
                                       A
                                       R
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             A
                                             R
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             n
                                          
                                          
                                             A
                                             R
                                             2
                                          
                                       
                                    
                                    2
                                 
                              
                           
                        
                     

In contrast, the point ACD2 is the place of intersection of a straight line perpendicular to the straight line AR with the corneal contour. The straight line perpendicular to the line AR is
                           
                              (10)
                              
                                 A
                                 C
                                 D
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             A
                                             R
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             m
                                          
                                          
                                             A
                                             R
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             A
                                             R
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             n
                                          
                                          
                                             A
                                             R
                                             2
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       A
                                       C
                                       D
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       A
                                       C
                                       D
                                       1
                                    
                                 
                              
                           
                        
                     

The intersection point of the straight line ACD with the inner corneal contour designated on this basis has the coordinates (m
                        
                           ACD2,n
                        
                           ACD2) at the point ACD2. Location of corresponding points is shown in 
                        Fig. 5. The calculation of the width and depth of the anterior chamber was carried out for all the registered B-scans. The accuracy comparable to the accuracy of commercial software of tomographs was obtained. The error is related mainly to the resolution errors of characteristic point locations, i.e. ±2 LSB (Least Significant Bit). For the resolution of 0.0313×0.0156mm2/pixel, there is an error of ±62µm. In this range of measurement of the anterior chamber depth and width, the proposed algorithm does not show significant statistical differences in the obtained measurement accuracy with respect to the original software of tomographs. This algorithm provides the basis for further calculations. It is further used for the calculation of the anterior chamber surface and volume as shown in the next section.

Based on the earlier calculations of positions of the contours ICC, ICI and OCL, it is possible to calculate the surface area and estimate the anterior chamber volume. The surface area is limited by the detected contour. The number of pixels inside the contour (ROI) is the anterior chamber surface area AAC. The basic problem in this case is the necessity of closing the object and determining the ROI which results from combining the contours ICC, ICI and OCL. The contours (ICC, ICI and OCL) were closed using the approximation of the inner corneal contour ICC(n) with a polynomial of degree four. The degree of the polynomial was chosen on the basis of anthropometric evidence and previous experience [31]. Another problem is the way of approximating the lens contour. Sometimes due to various diseases or tomograph imperfections, the lens is not sufficiently visible. When there were difficulties in detecting the lens contour OCL(n), it was approximated with a straight line connecting the last point of the iris – such an example is shown in 
                        Fig. 6. The method for approximating the lens shape has a significant impact on the method error, which is discussed in the next section.

The anterior chamber volume is typically determined based on 2, 4 B-scans. In extreme cases, the anterior chamber volume can be determined on the basis of one B-scan. Due to the small amount of information, the volume can only be estimated. In the case of a single B-scan, the inclination angle α of the straight line ACD is determined, i.e.
                           
                              (11)
                              
                                 α
                                 =
                                 a
                                 r
                                 c
                                 t
                                 g
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   A
                                                   R
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   m
                                                
                                                
                                                   A
                                                   R
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   A
                                                   R
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   A
                                                   R
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

On this basis, the position of ACD is adjusted to the vertical orientation. After this operation, the contours are rotated with respect to the main axis of symmetry of the straight line ACD. After adjusting its position, it (ACD) corresponds to the position of one of the columns. For simplicity, the contours ICC, ICI and OCL on the left side of the axis of symmetry of ACD are further called ICL
                        
                           L
                        (i
                        
                           L
                        ), where i
                        
                           L
                         refers to subsequent contour points, and analogously ICL
                        
                           P
                        (i
                        
                           P
                        ) on the right side. The contour rotation results in two solids of revolution (in the case of perfect symmetry there may be only one). The mean value of volume is the sought value VAC, i.e.
                           
                              (12)
                              
                                 V
                                 A
                                 C
                                 =
                                 
                                    π
                                    2
                                 
                                 
                                    (
                                    
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          
                                             (
                                             I
                                             C
                                             
                                                
                                                   L
                                                
                                                
                                                   L
                                                
                                             
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   L
                                                
                                             
                                             )
                                             )
                                          
                                          2
                                       
                                       +
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          M
                                       
                                       
                                          
                                             (
                                             I
                                             C
                                             
                                                
                                                   L
                                                
                                                
                                                   R
                                                
                                             
                                             (
                                             
                                                
                                                   i
                                                
                                                
                                                   P
                                                
                                             
                                             )
                                             )
                                          
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                        
                     

If there is more than one B-scan, approximation with splines between each set of contour points is used. In the case of two B-scans, spline approximation is performed between four contour points, for 4 B-scans between 8 points, etc. [36]. A schematic diagram of the measurement method based on one B-scan is shown in 
                        Fig. 7 whereas reconstruction of the anterior chamber volume based on two B-scans in 
                        Fig. 8.

@&#RESULTS@&#

The described methods for measuring the anterior chamber surface AAC and volume VAC were applied to all collected 60,000 images. In 91% of cases (approximately 54,500 B-scans), the algorithm worked properly. The contours ICC, ICI and OCL were detected correctly and the incorrectly detected 5500 resulted from not adhering to the assumptions: the scanned area of the eye, significant pathology or operator׳s errors [37].

In order to verify the accuracy of the presented method for calculating the anterior chamber surface area, the obtained results were compared with the results obtained by a specialist physician. The expert marked manually the inner corneal contour and the outer contours of the iris and lens. The marked area concerned 100 B-scans for a variety of healthy subjects. Next, the anterior chamber surface area measurement error δ
                     
                        AAC
                      was calculated as
                        
                           (13)
                           
                              
                                 
                                    δ
                                 
                                 
                                    A
                                    A
                                    C
                                 
                              
                              =
                              
                                 |
                                 
                                    
                                       
                                          A
                                          A
                                          C
                                          −
                                          A
                                          A
                                          
                                             
                                                C
                                             
                                             
                                                E
                                                X
                                             
                                          
                                       
                                       
                                          A
                                          A
                                          
                                             
                                                C
                                             
                                             
                                                E
                                                X
                                             
                                          
                                       
                                    
                                 
                                 |
                              
                              100
                              
                              %
                           
                        
                     where AAC
                     
                        EX
                      is the value of the surface area calculated on the basis of the contour marked manually by an expert (the subscript EX refers to the expert).

The obtained results, namely changes in the anterior chamber measurement error values δ
                     
                        AAC
                     , are shown in 
                     Fig. 9 (green). The mean value of the error δ
                     
                        AAC
                      is 4.3% and the standard deviation of the mean is 1.6%. Since in most cases the calculated value of the anterior chamber surface was underestimated (Fig. 9), the position of the contour OCL was modified. According to the algorithm described above, the curve OCL is the lens contour if it is fully visible or if it is its approximation. The latter case reduces the method effectiveness (the error δ
                     
                        AAC
                      increases). This was investigated for the changes in the position of the contour OCL in the axis of ACD, in the range Δ
                        OCL
                     =±8 pixels. The value of ±8 pixels results from the iris thickness value of 16 pixels at a resolution of 0.0313×0.0156mm2/pixel. The results are shown in 
                     Fig. 10 and Fig. 9 (red and blue). The obtained results confirm the need for a small position correction of the contour OCL by Δ
                        OCL
                     =−4 pixels if the lens is not visible. For this shift, the mean value of the error δ
                     
                        AAC
                      calculated for all cases w is close to zero.

For the aforementioned B-scans, a comparison of the accuracy with the results obtained using Visante OCT was also made. The analogous formula for the error (13) was used for the comparison with the area marked manually by the expert. The mean value of the error δ
                     
                        AAC
                      was 6.7% with a much higher standard deviation of the mean equal to 4.1%. Taking into consideration the comparison of these data with the results obtained from the proposed new method at a confidence level of p-value equal to 0.05, it can be concluded that the proposed method is superior to the analysis method used in Visante OCT. However, these significantly better results obtained from the discussed new method of analysis only apply to one ethnic group. When the reasons for the error occurrence were carefully investigated, it turned out that the error results from approximation of the iris and lens contours with a polynomial. In many B-scans, such an approach introduces a considerably rounded contour which is neither real nor consistent with the anatomy of its waveform. This is shown, for example, in Fig. 1a.

It is much more difficult to verify the accuracy of the calculation of the anterior chamber volume VAC on the basis of one B-scan. The error value δ
                     
                        VAC
                      was calculated analogously to (13). Due to the tedious manual selection of individual points in three-dimensional space, the expert marked the anterior chamber volume in 10 cases only. For these 10 cases, the mean value of the error δ
                     
                        VAC
                      was 12%. The anterior chamber volume was in this case compared with calculations that use the rotation of a single B-scan around the axis of symmetry – according to the formula (12). The lack of sufficient information about the contour location for the other B-scans of the eye resulted in the occurrence of errors. Each successive B-scan reduces the measurement error by about half. Moreover, it automatically increases the measurement time. Therefore, the number of B-scans acquired from tomographs should be a compromise between the accuracy obtained (the necessity of anterior chamber volume calculation) and measurement time (not more than 3s for the Intel i7, 8GB RAM). The graph of analysis time for the first 1000 sample B-scans is shown in 
                     Fig. 11.

A block diagram of the whole analysis is shown in 
                     Fig. 12.

The known methods of image analysis and processing related to the anterior segment of the eye may be divided into:
                           
                              •
                              Analysis of the corneal contour used independently to measure its thickness. Because it is easy to obtain it, there exist dedicated methods of image analysis and processing capable of performing this type of measurement fully automatically [38]. The methods proposed and implemented by tomographs׳ manufacturers work properly even for patients with a high degree of pathology or for large interindividual variability.

Analysis of the iris contour. The iris contour is necessary to determine an additional parameter which is the iridocorneal angle. The current state of advancement of the software used in tomographs only allows semi-automatic designation of the iridocorneal angle (an operator manually selects the characteristic points of the measured angle) [39,40]. The iris contour is here approximated with a straight line. Therefore, this method is not fully automatic.

Analysis of the lens contour. This is not a trivial task. This is due to the large possible interindividual variability of occurring pathology including the absence of lenses. For this reason, the lens approximation with a straight line is present in a large amount of software.

In terms of image analysis and processing tools, the known methods of edge analysis may include:
                           
                              •
                              Edge detectors based on the Roberts, Sobel or Prewitt filters. These filters do not provide any continuous boundary of the cornea, iris or lens (if it exists).

Edge detectors based on the Canny filter. The results obtained are much better than in the case of detectors based on the Roberts, Sobel or Prewitt filters. Still, the detected edge is not continuous.

Active contour method. By definition, it provides a closed contour. In practice, there remain problems with selecting the starting points automatically and defining which edge is detected. This method may be partly used to solve the problem described in this paper. However, this application is limited to the correction of the contour position at the beginning and end of the edge.

Dedicated methods. By definition, they do not provide correct results for those types of images which are different from the ones for which they were designed. Dedicated methods provide the best results only for strictly selected images.

Artificial intelligence. As far as medical images and contour detection are concerned, it provides good results only in the case of a group of test images which do not differ from a series of learning images (e.g. in the case of neural networks). In the general case of interindividual variability and possible pathologies, the results obtained are subject to a very high error and the edges may be incorrectly detected.

In the case of the known methods of image analysis and processing, which operate fully automatically and are applied in modern tomographs, there is a considerable measurement error (6.7%). It was reduced by 2.4% using the described algorithm, proposed by the authors. It should be noted that in the known methods of image analysis the error is greatly affected by the total anterior chamber surface. The smaller the anterior chamber surface, the greater the value of the error is. Its main cause is inappropriate approximation of the iris contour (
                        Fig. 13) and/or the lens contour with a straight line [18,27]. The selected cases of anterior chamber surface analysis performed by the OCT software and the proposed algorithm are shown in 
                        Fig. 14.

The paper presents a new algorithm, proposed by the authors, which allows the measurement of anterior eye chamber surface area and volume. The presented methodology of the procedure is only an example. It leads to a fully automated measurement on the basis of even a single B-scan in less than 3s (for the Intel i7, 8GB RAM). Similar results can also be obtained by profiling other methods of image analysis such as the ones from microscopy analysis [41], biometrics [42] or others [43,44]. These are the methods of mathematical morphology such as conditional opening and closing. These can also be the methods derived from the analysis of the eye fundus (similar problems in edge detection) or ultrasound image analysis (texture analysis).

The issues related to the designation of anterior eye chamber parameters concern primarily inaccuracies of its contour approximation. In the available software, in Visante and Casia OCT, the contours are rounded and approximated as shown in Fig. 13. In addition, there are significant problems with the correct detection of the lens outer contour even in healthy subjects (Fig. 1). Another problem is the lack of a sufficient amount of information necessary for the calculation of the anterior chamber volume. Owing to anthropometric data, it is possible to use the properties of a solid of revolution with a small error and estimate the anterior chamber volume on the basis of a single B-scan. The results obtained here will be more subject to an error if the difference in relation to the healthy subject will be greater.

In subsequent papers, the authors intend to apply the described algorithm to measure the reproducibility of the results. This is an extremely important element in practice. In this case, the measurement error caused by patient׳s different positions relative to the tomograph, different arrangement of the eye relative to the main axis of fixation or the impact of individual tomograph settings is of interest. Sensitivity of the proposed algorithm to changes in the parameters of acquisition (different image resolutions) and changes of the filter mask sizes (used in the present algorithm) will be verified independently. The algorithm is currently working in the Ophthalmology Clinic, Medical University of Silesia, District Railway Hospital in Katowice, Poland.

The authors declare that they have no competing interests.

RK suggested the algorithm for image analysis and processing, implemented it and analysed the images, wrote the full text of the manuscript. AN, EW, ZW performed the acquisition the images from tomography and consulted the obtained results. All authors have read and approved the final manuscript.

@&#ACKNOWLEDGEMENTS@&#

No outside funding was received for this study.

@&#REFERENCES@&#

