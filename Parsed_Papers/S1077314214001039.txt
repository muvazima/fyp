@&#MAIN-TITLE@&#Radial distortion invariants and lens evaluation under a single-optical-axis omnidirectional camera

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We establish invariants for space points and radially distorted image points.


                        
                        
                           
                           We construct the invariant criterion functions that are very stable to noise.


                        
                        
                           
                           A feature vector is constructed from the functions and its infinity norm is computed.


                        
                        
                           
                           The norm is applied to evaluate camera lens alignment or tangent distortion.


                        
                        
                           
                           The evaluation is flexible and useful in applications such as 3D reconstruction.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Geometric invariant

Omnidirectional camera

Tangent distortion evaluation

@&#ABSTRACT@&#


               
               
                  This paper presents radial distortion invariants and their application to lens evaluation under a single-optical-axis omnidirectional camera. Little work on geometric invariants of distorted images has been reported previously. We establish accurate geometric invariants from 2-dimensional/3-dimensional space points and their radially distorted image points. Based on the established invariants in a single image, we construct criterion functions and then design a feature vector for evaluating the camera lens, where the infinity norm of the feature vector is computed to indicate the tangent distortion amount. The evaluation is simple and convenient thanks to the feature vector that is analytical and straightforward on image points and space points without any other computations. In addition, the evaluation is flexible since the used invariants make any a coordinate system of measuring space or image points workable. Moreover, the constructed feature vector is free of point orders and resistant to noise. The established invariants in the paper have other potential applications such as camera calibration, image rectification, structure reconstruction, image matching, and object recognition. Extensive experiments, including on structure reconstruction, demonstrate the usefulness, higher accuracy, and higher stability of the present work.
               
            

@&#INTRODUCTION@&#

Geometric invariants, reflecting intrinsic properties of objects, are extremely useful for classifying and recognizing objects [1–5]. In particular, projective geometric invariants between scene and image can be applied to recognizing objects without requiring camera calibration and complete 3-dimensional (3D) reconstruction.

In the past years, there have been many studies on projective geometric invariants under perspective cameras [1–5]. However, there are few studies on invariants under omnidirectional cameras due to the severe image distortions and the nonlinear imaging processes. The omnidirectional cameras, having a large field of view, offer great benefit to three-dimensional modeling of wide environment, robot navigation, and visual surveillance. Geometric properties of these cameras are currently being studied by a number of authors [6–18,29–37].

Catadioptric camera, fisheye camera, and wide-angle camera are all omnidirectional cameras with radial distortion. In 2005, Bayro-Corrochano and Lopez-Franco [16] projected features of the catadioptric image to the sphere defined by Geyer and Daniilidis [17], and then calculated projective geometric invariants using conformal geometric algebra, where camera intrinsic parameters should be known. Also in the same year, Wu and Hu [18] established invariant equations of space points and their radially distorted image points, in which camera optical axis position was used for 3D points and intersection point of camera optical axis with 2-dimensional (2D) scene plane was used for 2D points. Establishment of invariants without involving the optical axis knowledge in scene space or other camera parameters deserves investigations because solving these parameters is a complex task.

In this work, we:
                        
                           (1)
                           define the single-optical-axis omnidirectional camera to be a kind of omnidirectional cameras that have a single optical axis and whose optical center loci lie on the optical axis. For example, the catadioptric camera with a quadric as its mirror [17], the fisheye camera, some wide angle cameras, and the traditional perspective camera are all single-optical-axis cameras.

establish projective geometric invariant between 2D/3D space points and their radially distorted image points under a single-optical-axis camera. The invariants are called radial distortion invariants. These invariants do not involve the camera optical axis position in 3D space or the intersection point of the camera optical axis with the scene plane. Additionally, they do not involve any other camera parameters except for the principal point. The principal point can be well approximated by the center of the imaged edge contour (see the analyses in the fourth paragraph of Section 5.1 and the fourth paragraph of Section 5.2). Thus, the invariants are more practical and flexible.

apply the established invariants for evaluating a single-optical-axis camera lens. We construct a criterion function and then design a feature vector. The infinity norm of this feature vector is computed which indicates the tangent distortion amount of the camera. By comparing the infinity norm with a given threshold, whether a single-optical-axis camera lens is aligned or has tangent distortion is evaluated. The algorithm is simple and convenient for evaluating a camera as the feature vector is analytical that is directly constructed from image points and space points without any other computations. In addition, the vector is free of point orders and resistant to noise. Once a camera is evaluated as no tangent distortion, only radial distortion model should be used in applications. In this paper, scene structure recovery after lens evaluation is proposed like in [18].

Geometric distortion of a camera lens includes: radial distortion, tangent distortion, or the hybrid distortion of both [29]. The distortion is an important factor for evaluating the quality of a camera lens [19–22]. However, detecting tangent distortion is difficult. Moreover, for a single-optical-axis omnidirectional camera, detection of its alignment is needed. As pointed out in [6,8,11], if the distortion center and the principal point are different for a misaligned camera, tangent distortion will appear. Thus, this paper is very useful for a single-optical-axis camera to tell whether it is aligned or has tangent distortion.

For example in Fig. 1
                     , a catadioptric camera consisting of a quadric mirror and a perspective camera lens is a single-optical-axis omnidirectional camera. Before using this camera, alignment is needed to make the mirror face the lens rightly. In [34], Mashita, Iwai, and Yachida also think the mirror alignment is absolutely essential and think it is difficult to align the mirror and camera positions. If images of the misaligned camera were used to do camera calibration or 3D reconstruction by regarding it aligned, the results would not be accurate. How to know whether the camera is aligned or the alignment extent can be accepted? The infinity norm of the designed feature vector in this paper can be as an indication.

Besides the proposed evaluation application, the established invariants can find other applications. For example, they can be used for recognizing polyhedrons or polygons directly from 2D distorted images without a complete 3D reconstruction like those for perspective images in [23,24].

The remainder of this paper is organized as follows. Some preliminaries are listed in Section 2. The radial distortion invariants are given in Section 3. Section 4 proposes the lens evaluation algorithm for a single-optical-axis camera. The experimental results are reported in Section 5, followed by a conclusion in Section 6.

As we all know, a point 
                        a
                      in a 1-dimensional (1D) space (a line) may be represented by the coordinate x, a point 
                        B
                      in a 2D space (a plane) may be represented by the coordinates (x,
                     y), and a point 
                        C
                      in a 3D space may be represented by the coordinates (x,
                     y,
                     z). In a projective space, point representations are slightly different and they are represented by homogeneous coordinates. The homogeneous coordinates of the above point 
                        a
                      is s(x,1)
                        T
                      if it is not at infinity or is s(x,0)
                        T
                      if it is at infinity, where s is any a nonzero scalar. Similarly, the homogeneous coordinates of 
                        B
                      is s(x,
                     y,1)
                        T
                      or s(x,
                     y,0)
                        T
                      and of 
                        C
                      is s(x,
                     y,
                     z,1)
                        T
                      or s(x,
                     y,
                     z,0)
                        T
                     . In the following of this paper, a bold italic letter just denotes a point or its homogeneous coordinates and sometimes a vector or a matrix.

We use the symbol “∣ ∣” to denote determinant of points in it. For example, ∣
                        a
                     
                     1
                     
                        a
                     
                     2∣ is the determinant of 1D finity points 
                        a
                     
                     
                        i
                     , i
                     =1, 2 with homogeneous coordinates s
                     
                        i
                      (x
                     
                        i
                     ,1)
                        T
                     , whose absolute value is also the distance between 
                        a
                     
                     1 and 
                        a
                     
                     2 if both s
                     
                        i
                      are taken as 1. ∣
                        B
                     
                     1
                     
                        B
                     
                     2
                     
                        B
                     
                     3∣ is the determinant of 2D finity points 
                        B
                     
                     
                        i
                     , i
                     =1,2,3 with homogeneous coordinates s
                     
                        i
                     (x
                     
                        i
                     ,
                     y
                     
                        i
                     ,1)
                        T
                     . ∣
                        C
                     
                     1
                     
                        C
                     
                     2
                     
                        C
                     
                     3
                     
                        C
                     
                     4∣ is the determinant of 3D finity points 
                        C
                     
                     
                        i
                     , i
                     =1, 2, 3, 4 with homogeneous coordinates s
                     
                        i
                     (x
                     
                        i
                     ,
                     y
                     
                        i
                     ,
                     z
                     
                        i
                     ,1)
                        T
                     . For notational convenience, if there is no risk of ambiguity, ∣
                        B
                     
                     1
                     
                        B
                     
                     2
                     
                        B
                     
                     3∣ for 2D points 
                        B
                     
                     
                        i
                      will be simply written as ∣
                        B
                     
                     1,2,3∣ and ∣
                        C
                     
                     1
                     
                        C
                     
                     2
                     
                        C
                     
                     3
                     
                        C
                     
                     4∣ for 3D points 
                        C
                     
                     
                        i
                      as ∣
                        C
                     
                     1,2,3,4∣.

The cross ratio is fundamental in projective geometry that keeps invariant under a projective transformation [25]. For four collinear points 
                        a
                     
                     
                        i
                     , i
                     =1…4 being 1D homogeneous coordinates, the cross ratio is defined as
                        
                           (1)
                           
                              |
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              |
                              |
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    4
                                 
                              
                              |
                              /
                              (
                              |
                              
                                 
                                    a
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    3
                                 
                              
                              |
                              |
                              
                                 
                                    a
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    4
                                 
                              
                              |
                              )
                              .
                           
                        
                     
                  

In a 2D projective plane, a pencil of lines is a set of lines, each of which passes through a fixed point. The fixed point is called the vertex of the pencil. There is a cross ratio from a pencil of four lines, which is equal to the cross ratio of four collinear intersection points of a general transversal line with this pencil. As shown in Fig. 2
                     , the four lines 
                        A
                     
                     0
                     
                        A
                     
                     
                        i
                     , i
                     =1…4 construct a pencil with 
                        A
                     
                     0 being the vertex. This pencil is denoted as 
                        A
                     
                     0(
                        A
                     
                     1,
                     
                        A
                     
                     2,
                     
                        A
                     
                     3,
                     
                        A
                     
                     4) and its cross ratio is equal to the cross ratio of the four points 
                        a
                     
                     
                        i
                     , i
                     =1…4 on l. This cross ratio is computed as ∣
                        A
                     
                     013∣∣
                        A
                     
                     024∣/(∣
                        A
                     
                     023∣∣
                        A
                     
                     014∣) by 
                        A
                     
                     
                        i
                      and the derivation is shown in the third paragraph of Section 3.1.

Similarly in a 3D projective space, a pencil of planes is a set of planes, each of which passes through a fixed line. The fixed line is called the axis of the pencil. Cutting a pencil of planes by a general space plane generates a pencil of lines. The two cross ratios of the pencil of planes and the pencil of lines are equal, which is also equal to the cross ratio of the collinear intersection points of a general transversal line with this pencil of planes. As shown in Fig. 3
                     , the four planes 
                        A
                     
                     0
                     
                        A
                     
                     1
                     
                        A
                     
                     
                        i
                     , i
                     =2…5 construct a pencil of planes with 
                        A
                     
                     0
                     
                        A
                     
                     1 being the axis. This pencil is denoted as 
                        A
                     
                     0
                     
                        A
                     
                     1(
                        A
                     
                     2,
                     
                        A
                     
                     3,
                     
                        A
                     
                     4,
                     
                        A
                     
                     5). The plane PL cuts the pencil as the pencil of lines L
                     
                        i
                     , i
                     =1…4 and the transversal line L cuts as 
                        b
                     
                     
                        i
                     , i
                     =1…4. The three cross ratios of the planes 
                        A
                     
                     0
                     
                        A
                     
                     1(
                        A
                     
                     2,
                     
                        A
                     
                     3,
                     
                        A
                     
                     4
                     ,
                        A
                     
                     5), the lines L
                     
                        i
                     , i
                     =1…4, and the points 
                        b
                     
                     
                        i
                     , i
                     =1…4 are equal. This cross ratio is computed as ∣
                        A
                     
                     0
                     
                        A
                     
                     1
                     
                        A
                     
                     2
                     
                        A
                     
                     4∣∣
                        A
                     
                     0
                     
                        A
                     
                     1
                     
                        A
                     
                     3
                     
                        A
                     
                     5∣/(∣
                        A
                     
                     0
                     
                        A
                     
                     1
                     
                        A
                     
                     3
                     
                        A
                     
                     4∣∣
                        A
                     
                     0
                     
                        A
                     
                     1
                     
                        A
                     
                     2
                     
                        A
                     
                     5∣) by 
                        A
                     
                     
                        i
                      and the derivation is shown in the third paragraph of Section 3.2.

There exist relations among determinants. One kind of these relations is the following Grassmann–Plücker relation [26,27]:
                        
                           (2)
                           
                              |
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                 
                              
                              |
                              |
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    4
                                    ,
                                    5
                                 
                              
                              |
                              -
                              |
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    2
                                    ,
                                    4
                                 
                              
                              |
                              |
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    3
                                    ,
                                    5
                                 
                              
                              |
                              +
                              |
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    2
                                    ,
                                    5
                                 
                              
                              |
                              |
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    3
                                    ,
                                    4
                                 
                              
                              |
                              =
                              0
                              ,
                           
                        
                     with 
                        B
                     
                     
                        i
                     , i
                     =1…5 being 2D homogeneous coordinates. This equation will be used to simplify the later polynomial computations in this paper.

The central catadioptric cameras with paraboloid, ellipsoid, or hyperboloid mirrors are unified as an equivalent spherical projection by Geyer and Daniilidis [17]. The spherical projection is recalled as follows: As shown in Fig. 4
                     , a space point 
                        M
                      is projected to a point 
                        X
                      on the viewing sphere through the sphere center 
                        O
                      then projected to 
                        m
                      on the image plane through the camera viewpoint 
                        O
                     
                     
                        c
                     . The camera optical axis is the line through 
                        O
                      and 
                        O
                     
                     
                        c
                     , denoted as 
                        OO
                     
                     
                        c
                     . The camera principal point, denoted as 
                        m
                     
                     0, is the intersection point of 
                        OO
                     
                     
                        c
                      with the image plane. The distance between 
                        O
                      and 
                        O
                     
                     
                        c
                     , denoted as e, is the mirror parameter. The mirror used in this model is a paraboloid when e
                     =1, an ellipsoid or hyperboloid when 0<
                     e
                     <1, and a plane when e
                     =0.

Geometric distortion of a camera lens includes: radial distortion, tangent distortion, or the hybrid distortion of both as shown in Fig. 5
                     , where 
                        C
                      denotes the distortion center, 
                        A
                      denotes the ideal position of an image point under a perspective camera, if the obtained image point is located at 
                        B
                     , we say the image point has radial distortion; if at 
                        D
                     , we say the image point has tangent distortion; if at 
                        E
                     , we say the image point has radial-tangent distortion. The aligned central catadioptric cameras have only radial distortion because the optical axis 
                        OO
                     
                     
                        c
                     , 
                        m
                     
                     0, 
                        M
                     , 
                        m
                      are coplanar.


                     A single-optical-axis camera is defined to be the above kind of omnidirectional cameras which has a single optical axis 
                        OO
                     
                     
                        c
                      but whose optical centers 
                        O
                      or 
                        O
                     
                     
                        c
                      are not necessarily fixed and could vary along the optical axis. For example, besides the above central catadioptric cameras, some fisheye cameras, some wide-angle cameras, and the traditional perspective camera are all the single-optical-axis cameras.

From 1D space points, the radial distortion invariant with known camera principal point was reported in [18]. However, the presented invariants from 2D/3D space points [18] involve intersection point of camera optical axis with the 2D scene plane or involve camera optical axis position in the 3D space. In the following, we show how to derive invariants without the knowledge of the intersection point or the camera optical axis. In order to have a geometric intuition, we illustrate some derived invariant equations only under the sphere model of the central catadioptric cameras.

Let 
                           M
                        
                        
                           i
                        , i
                        =1…6 be six points on a space plane and 
                           m
                        
                        
                           i
                         their image points under a single-optical-axis camera with only radial distortion. The base plane containing 
                           M
                        
                        
                           i
                         is denoted as Π and the camera optical axis is still denoted as 
                           OO
                        
                        
                           c
                        . The intersection point of 
                           OO
                        
                        
                           c
                         with Π is denoted as 
                           M
                        
                        0. We assume that no four of 
                           M
                        
                        
                           i
                        , i
                        =1…6 are collinear.

From four points 
                           M
                        
                        
                           i
                        , 
                           M
                        
                        
                           j
                        , 
                           M
                        
                        
                           k
                        , 
                           M
                        
                        
                           n
                         with i, j, k, n
                        ∈{1,2,3,4,5,6} among 
                           M
                        
                        
                           l
                        , l
                        =1…6, we construct a pencil of planes 
                           OO
                        
                        
                           c
                        (
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ). The pencil of planes is cut as 
                           M
                        
                        0(
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ) by the space plane Π. Furthermore, if the camera has no tangent distortion, the pencil of planes is cut as 
                           m
                        
                        0(
                           m
                        
                        
                           i
                        ,
                        
                           m
                        
                        
                           j
                        ,
                        
                           m
                        
                        
                           k
                        ,
                        
                           m
                        
                        
                           n
                        ) by the image plane. It follows that by the cross ratio introduction for a pencil of planes in Section 2, the cross ratio of 
                           M
                        
                        0(
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ) is equal to the cross ratio of 
                           m
                        
                        0(
                           m
                        
                        
                           i
                        ,
                        
                           m
                        
                        
                           j
                        ,
                        
                           m
                        
                        
                           k
                        ,
                        
                           m
                        
                        
                           n
                        ). An example by (
                           M
                        
                        1,
                        
                           M
                        
                        2,
                        
                           M
                        
                        3,
                        
                           M
                        
                        4) under the sphere model is shown in Fig. 6
                        .

The cross ratio of the pencil of lines 
                           m
                        
                        0(
                           m
                        
                        
                           i
                        ,
                        
                           m
                        
                        
                           j
                        ,
                        
                           m
                        
                        
                           k
                        ,
                        
                           m
                        
                        
                           n
                        ) is ∣
                           m
                        
                        
                           i,k,0∣∣
                           m
                        
                        
                           j,n,0∣/(∣
                           m
                        
                        
                           j,k,0∣∣
                           m
                        
                        
                           i,n,0∣). The derivation is as follows. We use the line 
                           m
                        
                        
                           i
                        
                        
                           m
                        
                        
                           j
                         to cut this pencil. The obtained four collinear points are 
                           m
                        
                        
                           i
                        , 
                           m
                        
                        
                           j
                        , 
                           a
                        
                        
                           k
                        
                        =(
                           m
                        
                        
                           i
                        
                        ×
                        
                           m
                        
                        
                           j
                        )×(
                           m
                        
                        0
                        ×
                        
                           m
                        
                        
                           k
                        ), 
                           a
                        
                        
                           n
                        
                        =(
                           m
                        
                        
                           i
                        
                        ×
                        
                           m
                        
                        
                           j
                        )×(
                           m
                        
                        0
                        ×
                        
                           m
                        
                        
                           n
                        ), where × means outer product of two vectors, 
                           a
                        
                        
                           k
                         denotes the intersection point of line 
                           m
                        
                        
                           i
                        
                        
                           m
                        
                        
                           j
                         with line 
                           m
                        
                        0
                        
                           m
                        
                        
                           k
                        , and 
                           a
                        
                        
                           n
                         denotes the intersection point of line 
                           m
                        
                        
                           i
                        
                        
                           m
                        
                        
                           j
                         with line 
                           m
                        
                        0
                        
                           m
                        
                        
                           n
                        . Expand the outer products, we have:
                           
                              (3)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             ×
                                             
                                                
                                                   m
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             ×
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                
                                             
                                             ×
                                             
                                                
                                                   m
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             =
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   j
                                                   ,
                                                   k
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                   ,
                                                   k
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   n
                                                
                                             
                                             =
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             ×
                                             
                                                
                                                   m
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             ×
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   0
                                                
                                             
                                             ×
                                             
                                                
                                                   m
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                             =
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   j
                                                   ,
                                                   n
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                   ,
                                                   n
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Let 
                           m
                        
                        
                           i
                         and 
                           m
                        
                        
                           j
                         be the projective coordinate bases on the line 
                           m
                        
                        
                           i
                        
                        
                           m
                        
                        
                           j
                        , the 1D homogeneous coordinates of the four points 
                           m
                        
                        
                           i
                        , 
                           m
                        
                        
                           j
                        , 
                           a
                        
                        
                           k
                        , 
                           a
                        
                        
                           n
                         are (1,0), (0,1), (∣
                           m
                        
                        
                           j,k,0∣,−∣
                           m
                        
                        
                           i,k,0∣), (∣
                           m
                        
                        
                           j,n,0∣,−∣
                           m
                        
                        
                           i,n,0∣) respectively. It follows that according to (1), the cross ratio of the four points 
                           m
                        
                        
                           i
                        , 
                           m
                        
                        
                           j
                        , 
                           a
                        
                        
                           k
                        , 
                           a
                        
                        
                           n
                         is:
                           
                              (4)
                              
                                 
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             j
                                             ,
                                             n
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             j
                                             ,
                                             k
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             i
                                             ,
                                             n
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                 
                                 .
                              
                           
                        Since a cross ratio is invariant to projective coordinate systems, the result (4) still holds under any other projective coordinate systems. From the cross ratio introduction for a pencil of lines in Section 2, we know that this cross ratio (4) of the four collinear points 
                           m
                        
                        
                           i
                        , 
                           m
                        
                        
                           j
                        , 
                           a
                        
                        
                           k
                        , 
                           a
                        
                        
                           n
                         is just the cross ratio of 
                           m
                        
                        0(
                           m
                        
                        
                           i
                        ,
                        
                           m
                        
                        
                           j
                        ,
                        
                           m
                        
                        
                           k
                        ,
                        
                           m
                        
                        
                           n
                        ).

Similarly, we could obtain the cross ratio of 
                           M
                        
                        0(
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ) is ∣
                           M
                        
                        
                           i,k,0∣∣
                           M
                        
                        
                           j,n,0∣/(∣
                           M
                        
                        
                           j,k,0∣∣
                           M
                        
                        
                           i,n,0∣). As stated above like shown in Fig. 6 that the cross ratio of 
                           M
                        
                        0(
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ) is equal to the cross ratio of 
                           m
                        
                        0 (
                           m
                        
                        
                           i
                        ,
                        
                           m
                        
                        
                           j
                        ,
                        
                           m
                        
                        
                           k
                        ,
                        
                           m
                        
                        
                           n
                        ), we have:
                           
                              (5)
                              
                                 
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             j
                                             ,
                                             n
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             j
                                             ,
                                             k
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             i
                                             ,
                                             n
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             j
                                             ,
                                             n
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             j
                                             ,
                                             k
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             i
                                             ,
                                             n
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                 
                                 ,
                              
                           
                        This equation is consistent with the established homography between the space plane and the 1D radial lines by Thirthala and Pollefeys in [13,14]. Next, we eliminate 
                           M
                        
                        0 of (5).

By across multiplying the corresponding Eq. (5) for k
                        =1, n
                        =2, j
                        =3, there are:
                           
                              (6)
                              
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       2
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 -
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 =
                                 0
                                 .
                              
                           
                        Multiply (6) with ∣
                           M
                        
                        1,2,3∣. And then from the result by the Grassmann–Plücker relations (2):
                           
                              (7)
                              
                                 
                                    
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   2
                                                   ,
                                                   i
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   3
                                                
                                             
                                             |
                                             =
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   i
                                                
                                             
                                             |
                                             -
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   i
                                                
                                             
                                             |
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   i
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   3
                                                
                                             
                                             |
                                             =
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   3
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   i
                                                
                                             
                                             |
                                             -
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   3
                                                   ,
                                                   i
                                                
                                             
                                             |
                                          
                                       
                                    
                                 
                              
                           
                        we obtain:
                           
                              (8)
                              
                                 (
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 -
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 )
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                       ,
                                       2
                                       ,
                                       i
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 +
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                       ,
                                       3
                                       ,
                                       i
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                       ,
                                       2
                                       ,
                                       0
                                    
                                 
                                 |
                                 -
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       i
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                       ,
                                       2
                                       ,
                                       0
                                    
                                 
                                 |
                                 =
                                 0
                                 .
                              
                           
                        By applying the Grassmann–Plücker relation like (2):
                           
                              (9)
                              
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 -
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 =
                                 -
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       2
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       3
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                              
                           
                        to (8) again, we have:
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                             -
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   3
                                                   ,
                                                   i
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   i
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   3
                                                   ,
                                                   0
                                                
                                             
                                             |
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   3
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   2
                                                   ,
                                                   i
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   3
                                                   ,
                                                   i
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             |
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             -
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                   ,
                                                   i
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   2
                                                   ,
                                                   3
                                                   ,
                                                   i
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   3
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             |
                                             =
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Let 
                           V
                        
                        0 be the vector:
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   -
                                                   |
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                         ,
                                                         3
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                         ,
                                                         3
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         3
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                         ,
                                                         3
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                
                                             
                                             
                                                
                                                   -
                                                   |
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                         ,
                                                         3
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                         ,
                                                         3
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        In general 
                           V
                        
                        0 is nonzero. This is because if 
                           V
                        
                        0 is zero, then ∣
                           m
                        
                        1,2,0∣∣
                           M
                        
                        2,3,0∣∣
                           M
                        
                        1,3,0∣=0, ∣
                           m
                        
                        1,3,0∣∣
                           M
                        
                        2,3,0∣∣
                           M
                        
                        1,2,0∣=0, and ∣
                           m
                        
                        2,3,0∣∣
                           M
                        
                        1,3,0∣∣
                           M
                        
                        1,2,0∣=0. This implies that either 
                           m
                        
                        1, 
                           m
                        
                        2, 
                           m
                        
                        3, 
                           m
                        
                        0 are collinear or 
                           M
                        
                        1, 
                           M
                        
                        2, 
                           M
                        
                        3, 
                           M
                        
                        0 are collinear. This is not the general case and here we do not consider such special cases.

Consider the three Eq. (10) from i
                        =4, 5, 6. Because 
                           V
                        
                        0 is nonzero, the determinant of the coefficient matrix of these three equations with respect to 
                           V
                        
                        0 should be zero, namely:
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  3
                                                                  ,
                                                                  4
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            |
                                                            |
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  2
                                                                  ,
                                                                  4
                                                               
                                                            
                                                            |
                                                            ,
                                                            |
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  2
                                                                  ,
                                                                  4
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            |
                                                            |
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  3
                                                                  ,
                                                                  4
                                                               
                                                            
                                                            |
                                                            ,
                                                            |
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  4
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            |
                                                            |
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  2
                                                                  ,
                                                                  3
                                                                  ,
                                                                  4
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  3
                                                                  ,
                                                                  5
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            |
                                                            |
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  2
                                                                  ,
                                                                  5
                                                               
                                                            
                                                            |
                                                            ,
                                                            |
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  2
                                                                  ,
                                                                  5
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            |
                                                            |
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  3
                                                                  ,
                                                                  5
                                                               
                                                            
                                                            |
                                                            ,
                                                            |
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  5
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            |
                                                            |
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  2
                                                                  ,
                                                                  3
                                                                  ,
                                                                  5
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  3
                                                                  ,
                                                                  6
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            |
                                                            |
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  2
                                                                  ,
                                                                  6
                                                               
                                                            
                                                            |
                                                            ,
                                                            |
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  2
                                                                  ,
                                                                  6
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            |
                                                            |
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  3
                                                                  ,
                                                                  6
                                                               
                                                            
                                                            |
                                                            ,
                                                            |
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  6
                                                                  ,
                                                                  0
                                                               
                                                            
                                                            |
                                                            |
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  2
                                                                  ,
                                                                  3
                                                                  ,
                                                                  6
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 0
                              
                           
                        Expand the left side and the resulting expression is denoted as f
                        123;456, where changing the order of the subscripts (1, 2, 3) or changing the order of the subscripts (4, 5, 6) does not change the expression of (11).


                        Interpretation of the geometric invariance for 
                        (11): Since we assume that no four of the space points are collinear, at least one term in the expansion of (11) is nonzero. Assume the nonzero term is the last term, then (11) is equivalent to:
                           
                              (12)
                              
                                 f
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             6
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             3
                                             ,
                                             4
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             4
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             3
                                             ,
                                             6
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       In
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             5
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             2
                                             ,
                                             6
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             3
                                             ,
                                             4
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             4
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             2
                                             ,
                                             5
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             3
                                             ,
                                             6
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       In
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             6
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             2
                                             ,
                                             4
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             3
                                             ,
                                             5
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             4
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             2
                                             ,
                                             5
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             3
                                             ,
                                             6
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       In
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             2
                                             ,
                                             6
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             3
                                             ,
                                             5
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             2
                                             ,
                                             5
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             3
                                             ,
                                             6
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       In
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             5
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             2
                                             ,
                                             4
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             1
                                             ,
                                             4
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             2
                                             ,
                                             5
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       In
                                    
                                    
                                       5
                                    
                                 
                                 -
                                 1
                                 =
                                 0
                                 ,
                              
                           
                        where
                           
                              
                                 
                                    
                                       In
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             2
                                             ,
                                             4
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             2
                                             ,
                                             3
                                             ,
                                             6
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             2
                                             ,
                                             6
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             2
                                             ,
                                             3
                                             ,
                                             4
                                          
                                       
                                       |
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       In
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             2
                                             ,
                                             4
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             3
                                             ,
                                             6
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             2
                                             ,
                                             3
                                             ,
                                             5
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             2
                                             ,
                                             6
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             3
                                             ,
                                             5
                                          
                                       
                                       |
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             2
                                             ,
                                             3
                                             ,
                                             4
                                          
                                       
                                       |
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       In
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             2
                                             ,
                                             5
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             3
                                             ,
                                             4
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             2
                                             ,
                                             3
                                             ,
                                             6
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             2
                                             ,
                                             6
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             3
                                             ,
                                             5
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             2
                                             ,
                                             3
                                             ,
                                             4
                                          
                                       
                                       |
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       In
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             2
                                             ,
                                             5
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             3
                                             ,
                                             6
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             2
                                             ,
                                             6
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             3
                                             ,
                                             5
                                          
                                       
                                       |
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       In
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             3
                                             ,
                                             4
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             2
                                             ,
                                             3
                                             ,
                                             5
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             1
                                             ,
                                             3
                                             ,
                                             5
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             2
                                             ,
                                             3
                                             ,
                                             4
                                          
                                       
                                       |
                                    
                                 
                                 .
                              
                           
                        These In
                        
                           i
                        , i
                        =1…5 are invariants of 
                           M
                        
                        
                           i
                        , i
                        =1…6 to a 3D projective transformation and their coefficients are invariants of 
                           m
                        
                        
                           i
                        , i
                        =1…6 to a 2D projective transformation. This is because they are cross ratios or cross ratio functions. For example, In
                        1 is the cross ratio of 
                           M
                        
                        2(
                           M
                        
                        1,
                        
                           M
                        
                        3,
                        
                           M
                        
                        4,
                        
                           M
                        
                        6), whose coefficient is the cross ratio of 
                           m
                        
                        0(
                           m
                        
                        1,
                        
                           m
                        
                        3,
                        
                           m
                        
                        6,
                        
                           m
                        
                        4). In
                        2 is the product of the cross ratio of 
                           M
                        
                        1(
                           M
                        
                        2,
                        
                           M
                        
                        3,
                        
                           M
                        
                        4,
                        
                           M
                        
                        6) with the cross ratio of 
                           M
                        
                        3(
                           M
                        
                        1,
                        
                           M
                        
                        2,
                        
                           M
                        
                        4,
                        
                           M
                        
                        5) and its coefficient is the product of the cross ratio of 
                           m
                        
                        0(
                           m
                        
                        1,
                        
                           m
                        
                        2,
                        
                           m
                        
                        5,
                        
                           m
                        
                        6) with the cross ratio of 
                           m
                        
                        0(
                           m
                        
                        1,
                        
                           m
                        
                        3,
                        
                           m
                        
                        6,
                        
                           m
                        
                        4).


                        (11) or (12) does not involve 
                           M
                        
                        0 anymore and requires at least six pairs of space points and their image points. Whether (11) or (12) holds is not related to a specific order of the space points and the image points. It follows that changing the order of the space points and their corresponding image points in (11) or (12) still gives an invariance relation between the space points and their image points. But, such relations are not independent of the original ones in (11) or (12).

In order to establish invariance equation for 3D space points, eight pairs of space points and their image points are required. Let 
                           M
                        
                        
                           i
                        , i
                        =1…8 be eight 3D space points of which no five are coplanar. Let 
                           m
                        
                        
                           i
                        , i
                        =1…8 be their image points under a single-optical-axis camera with only radial distortion.

From the four points 
                           M
                        
                        
                           i
                        , 
                           M
                        
                        
                           j
                        , 
                           M
                        
                        
                           k
                        , 
                           M
                        
                        
                           n
                         with i, j, k, n
                        ∈{1,…,8}, we construct a pencil of planes 
                           OO
                        
                        
                           c
                        (
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ). If the camera has no tangent distortion, this pencil is cut as the pencil of lines 
                           m
                        
                        0(
                           m
                        
                        
                           i
                        ,
                        
                           m
                        
                        
                           j
                        ,
                        
                           m
                        
                        
                           k
                        ,
                        
                           m
                        
                        
                           n
                        ) by the image plane. It follows that the two cross ratios of 
                           OO
                        
                        
                           c
                        (
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ) and 
                           m
                        
                        0(
                           m
                        
                        
                           i
                        ,
                        
                           m
                        
                        
                           j
                        ,
                        
                           m
                        
                        
                           k
                        ,
                        
                           m
                        
                        
                           n
                        ) are equal. An example by 
                           M
                        
                        1, 
                           M
                        
                        2, 
                           M
                        
                        3, 
                           M
                        
                        4 under the sphere model is shown in Fig. 7
                        .

Now we derive the cross ratio of 
                           OO
                        
                        
                           c
                        (
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ). We use the space line 
                           M
                        
                        
                           i
                        
                        
                           M
                        
                        
                           j
                         to cut the pencil of planes. The obtained four collinear points are 
                           M
                        
                        
                           i
                        , 
                           M
                        
                        
                           j
                        , 
                           b
                        
                        
                           k
                        
                        =(
                           M
                        
                        
                           i
                        
                        
                           M
                        
                        
                           j
                        )∩(
                           M
                        
                        
                           k
                        
                        
                           OO
                        
                        
                           c
                        ), 
                           b
                        
                        
                           n
                        
                        =(
                           M
                        
                        
                           i
                        
                        
                           M
                        
                        
                           j
                        )∩(
                           M
                        
                        
                           n
                        
                        
                           OO
                        
                        
                           c
                        ). 
                           b
                        
                        
                           k
                         is the intersection point of line 
                           M
                        
                        
                           i
                        
                        
                           M
                        
                        
                           j
                         with plane 
                           M
                        
                        
                           k
                        
                        
                           OO
                        
                        
                           c
                        , and 
                           b
                        
                        
                           n
                         is the intersection point of line 
                           M
                        
                        
                           i
                        
                        
                           M
                        
                        
                           j
                         with plane 
                           M
                        
                        
                           n
                        
                        
                           OO
                        
                        
                           c
                        . 
                           b
                        
                        
                           k
                         and 
                           b
                        
                        
                           n
                         can be computed as:
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   M
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             O
                                             ,
                                             
                                                
                                                   O
                                                
                                                
                                                   c
                                                
                                             
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   M
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             O
                                             ,
                                             
                                                
                                                   O
                                                
                                                
                                                   c
                                                
                                             
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   n
                                                
                                             
                                             =
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   M
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             O
                                             ,
                                             
                                                
                                                   O
                                                
                                                
                                                   c
                                                
                                             
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   M
                                                
                                                
                                                   n
                                                
                                             
                                             ,
                                             O
                                             ,
                                             
                                                
                                                   O
                                                
                                                
                                                   c
                                                
                                             
                                             |
                                             
                                                
                                                   M
                                                
                                                
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Let 
                           M
                        
                        
                           i
                         and 
                           M
                        
                        
                           j
                         be the projective coordinate bases on the line 
                           M
                        
                        
                           i
                        
                        
                           M
                        
                        
                           j
                        , the 1D homogeneous coordinates of the four points 
                           M
                        
                        
                           i
                        , 
                           M
                        
                        
                           j
                        , 
                           b
                        
                        
                           k
                        , 
                           b
                        
                        
                           n
                         are (1,0), (0,1), (∣
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           O
                        ,
                        
                           O
                        
                        
                           c
                        ∣,−∣
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           O
                        ,
                        
                           O
                        
                        
                           c
                        ∣), (∣
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           n
                        ,
                        
                           O
                        ,
                        
                           O
                        
                        
                           c
                        ∣,−∣
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           n
                        ,
                        
                           O
                        ,
                        
                           O
                        
                        
                           c
                        ∣) respectively. It follows that according to (1), the cross ratio of the four collinear points 
                           M
                        
                        
                           i
                        , 
                           M
                        
                        
                           j
                        , 
                           b
                        
                        
                           k
                        , 
                           b
                        
                        
                           n
                        , also the cross ratio of 
                           OO
                        
                        
                           c
                        (
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ), is:
                           
                              (14)
                              
                                 
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       O
                                       ,
                                       
                                          
                                             O
                                          
                                          
                                             c
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       O
                                       ,
                                       
                                          
                                             O
                                          
                                          
                                             c
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       O
                                       ,
                                       
                                          
                                             O
                                          
                                          
                                             c
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       O
                                       ,
                                       
                                          
                                             O
                                          
                                          
                                             c
                                          
                                       
                                       |
                                    
                                 
                                 .
                              
                           
                        
                     

The cross ratio of 
                           m
                        
                        0(
                           m
                        
                        
                           i
                        ,
                        
                           m
                        
                        
                           j
                        ,
                        
                           m
                        
                        
                           k
                        ,
                        
                           m
                        
                        
                           n
                        ) is (4). As stated above like shown in Fig. 7 that the cross ratio of 
                           OO
                        
                        
                           c
                        (
                           M
                        
                        
                           i
                        ,
                        
                           M
                        
                        
                           j
                        ,
                        
                           M
                        
                        
                           k
                        ,
                        
                           M
                        
                        
                           n
                        ) is equal to the cross ratio of 
                           m
                        
                        0(
                           m
                        
                        
                           i
                        ,
                        
                           m
                        
                        
                           j
                        ,
                        
                           m
                        
                        
                           k
                        ,
                        
                           m
                        
                        
                           n
                        ), we have:
                           
                              (15)
                              
                                 
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       O
                                       ,
                                       
                                          
                                             O
                                          
                                          
                                             c
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       O
                                       ,
                                       
                                          
                                             O
                                          
                                          
                                             c
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       O
                                       ,
                                       
                                          
                                             O
                                          
                                          
                                             c
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       O
                                       ,
                                       
                                          
                                             O
                                          
                                          
                                             c
                                          
                                       
                                       |
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             i
                                             ,
                                             k
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             j
                                             ,
                                             n
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             j
                                             ,
                                             k
                                             ,
                                             0
                                          
                                       
                                       |
                                       |
                                       
                                          
                                             m
                                          
                                          
                                             i
                                             ,
                                             n
                                             ,
                                             0
                                          
                                       
                                       |
                                    
                                 
                                 ,
                              
                           
                        
                     

By across multiplying the corresponding Eq. (15) for k
                        =1, n
                        =2, j
                        =3, we get:
                           
                              (16)
                              
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 O
                                 ,
                                 
                                    
                                       O
                                    
                                    
                                       c
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 O
                                 ,
                                 
                                    
                                       O
                                    
                                    
                                       c
                                    
                                 
                                 |
                                 -
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       1
                                       ,
                                       3
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       2
                                       ,
                                       i
                                       ,
                                       0
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 O
                                 ,
                                 
                                    
                                       O
                                    
                                    
                                       c
                                    
                                 
                                 |
                                 |
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 O
                                 ,
                                 
                                    
                                       O
                                    
                                    
                                       c
                                    
                                 
                                 |
                                 =
                                 0
                                 ,
                              
                           
                        Like in Section 3.1, by the similar transformation for (16) and elimination of 
                           O
                        , 
                           O
                        
                        
                           c
                        , we get:
                           
                              (17)
                              
                                 |
                                 
                                    
                                       G
                                    
                                    
                                       5
                                    
                                 
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       6
                                    
                                 
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       7
                                    
                                 
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       8
                                    
                                 
                                 |
                                 =
                                 0
                                 ,
                              
                           
                        where
                           
                              
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         4
                                                         ,
                                                         i
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         3
                                                         ,
                                                         i
                                                      
                                                   
                                                   |
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         3
                                                         ,
                                                         i
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         4
                                                         ,
                                                         i
                                                      
                                                   
                                                   |
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                         ,
                                                         i
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                         ,
                                                         3
                                                         ,
                                                         4
                                                         ,
                                                         i
                                                      
                                                   
                                                   |
                                                
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                         ,
                                                         i
                                                         ,
                                                         0
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                         ,
                                                         3
                                                         ,
                                                         4
                                                         ,
                                                         i
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 for
                                 
                                 i
                                 =
                                 5
                                 
                                 …
                                 
                                 8
                                 .
                              
                           
                        The left side of (17) is denoted as g
                        1234;5678, where changing the order of the subscripts (1, 2, 3, 4) or the order of subscripts (5, 6, 7, 8) does not change the expression. Under the condition that no five of 
                           M
                        
                        
                           i
                        , i
                        =1…8 are coplanar, at least one term of the expanded g
                        1234;5678 is nonzero. Like (12), dividing g
                        1234;5678 by one of its nonzero terms will give a relation between space invariants and image invariants. Also, changing the order of the space points and their corresponding image points in (17) does not give additional independent invariants.

The distortion invariants (11) and (17) are derived under a single-optical-axis camera with only radial distortion. It follows that if a single-optical-axis camera has non-radial distortion, i.e. tangent distortion, then (11) and (17) cannot hold. Usually a nonaligned single-optical-axis camera has tangent distortion and thus cannot satisfy (11) and (17). Fig. 8
                     (a) shows a nonaligned catadioptric camera lens, where the perspective camera optical axis 
                        O
                     
                     
                        c
                     
                     
                        m
                     
                     0 and the mirror axis 
                        OV
                      are not coincident, and consequently 
                        m
                      no longer lies on plane 
                        OVXM
                     . Fig. 8(b) shows a thin prism with tangent distortion, where the non-coincident degrees of solid lines and the closer dashed lines say the tangent distortion degrees, the two thick solid lines denotes the axes of the minimum tangent distortion and the maximum distortion. From the minimum axis to the maximum axis, the tangent distortion angles become greater and greater.

The values of f
                     123;456 or g
                     1234;5678 could be used to determine whether a single-optical-axis camera is aligned or whether it has tangent distortion. Based one them, we can construct a feature vector and then compute its norm to measure the camera lens tangent distortion amount. To this end, we need to construct two criterion functions at first. One is for 2D case and the other for 3D case.

Stability of (11) or (17) to noise is affected by the order of space points and their image points. Thus in order to efficiently use the invariants, we need to consider more equations by changing the order of space points and their image points. The following criterion functions are constructed.


                           For 2D case from six points: The criterion function is constructed as:
                              
                                 (18)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          2
                                          D
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          20
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ijk
                                             ;
                                             opq
                                             ∈
                                             S
                                          
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ijk
                                                ;
                                                opq
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          ijk
                                          ;
                                          opq
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           where S is the set of all the combinations (ijk;
                           opq) from 1, 2, 3, 4, 5, 6 with 20 elements in total, f
                           
                              ijk;opq
                            is the result of f
                           123;456 (as given in Section 3.1) after changing 
                              M
                           
                           1, 
                              M
                           
                           2, 
                              M
                           
                           3, 
                              M
                           
                           4, 
                              M
                           
                           5, 
                              M
                           
                           6 to 
                              M
                           
                           
                              i
                           , 
                              M
                           
                           
                              j
                           , 
                              M
                           
                           
                              k
                           , 
                              M
                           
                           
                              o
                           , 
                              M
                           
                           
                              p
                           , 
                              M
                           
                           
                              q
                            and simultaneously changing the corresponding image points, w
                           
                              ijk;opq
                            is a weight to f
                           
                              ijk;opq
                            given as follows. In the n-th summation term of the expanded polynomial of f
                           
                              ijk;opq
                            on determinants, let w
                           
                              n1 be the absolute value of product of determinants containing the space points, and let w
                           
                              n2 be the absolute value of product of determinants containing the image points. For example, in the 1-th term of f
                           123;456, w
                           11 is the absolute value of ∣
                              M
                           
                           1,2,4∣∣
                              M
                           
                           1,3,5∣∣
                              M
                           
                           2,3,6∣ and w
                           12 is the absolute value of ∣
                              m
                           
                           1,6,0∣∣
                              m
                           
                           2,5,0∣∣
                              m
                           
                           3,4,0∣. Then sort ascendingly all w
                           
                              n1 with varying n and let the result be B
                           1. Sort ascendingly all w
                           
                              n2 with varying n and let the result be B
                           2. We take the product of the fifth element of B
                           1 and the fifth element of B
                           2 as the weight w
                           
                              ijk;opq
                           . After adding the weight w
                           
                              ijk;opq
                            to f
                           
                              ijk;opq
                           , I
                           2D
                            is a function on invariants of the space points and their image points as shown in (12).


                           For 3D case from eight points: The criterion function is constructed as:
                              
                                 (19)
                                 
                                    
                                       
                                          I
                                       
                                       
                                          3
                                          D
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          70
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ijkl
                                             ;
                                             opqr
                                             ∈
                                             S
                                          
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ijkl
                                                ;
                                                opqr
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          g
                                       
                                       
                                          ijkl
                                          ;
                                          opqr
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           where S is the set of all the combinations (ijkt;
                           opqr) from 1, 2, 3, 4, 5, 6, 7, 8 with 70 elements in total, g
                           
                              ijkt;opqr
                            is the result of g
                           1234;5678 (as given in Section 3.2) after changing 
                              M
                           
                           1, 
                              M
                           
                           2, 
                              M
                           
                           3, 
                              M
                           
                           4, 
                              M
                           
                           5, 
                              M
                           
                           6, 
                              M
                           
                           7, 
                              M
                           
                           8 to 
                              M
                           
                           
                              i
                           , 
                              M
                           
                           
                              j
                           , 
                              M
                           
                           
                              k
                           , 
                              M
                           
                           
                              t
                           , 
                              M
                           
                           
                              o
                           , 
                              M
                           
                           
                              p
                           , 
                              M
                           
                           
                              q
                           , 
                              M
                           
                           
                              r
                            and simultaneously changing the corresponding image points, w
                           
                              ijkt;opqr
                            is a weight to g
                           
                              ijkt;opqr
                            taken as follows. In the n-th term of the expanded polynomial of g
                           
                              ijkt;opqr
                            on determinants, let w
                           
                              n1 be the absolute value of product of determinants containing the space points, and let w
                           
                              n2 be the absolute value of product of determinants containing the image points. Then sort ascendingly all w
                           
                              n1 with varying n and let the result be B
                           1. Sort ascendingly all w
                           
                              n2 with varying n and let the result be B
                           2. We take the product of the twenty-second element of B
                           1 with the twenty-second element of B
                           2 as the weight w
                           
                              ijkt;opqr
                           . After adding the weight w
                           
                              ijkt;opqr
                            to g
                           
                              ijkt;opqr
                           , I
                           3D
                            is a function on invariants of the space points and their image points.
                              Remark 1
                              The above constructed weights are always nonzero under the respective assumptions that no four of 
                                    M
                                 
                                 
                                    i
                                 , i
                                 =1…6 are collinear in 2D case and no five of 
                                    M
                                 
                                 
                                    i
                                 , i
                                 =1…8 are coplanar in 3D case.

We analyze the details of the above construction for each f
                           
                              ijk;opq
                           , g
                           
                              ijkt;opqr
                            in this subsection 4.1.2.

In fact, any functions on f
                           
                              ijk;opq
                            or g
                           
                              ijkt;opqr
                            by dividing some term in the function will be invariant. Why do we take such I
                           2D
                           , I
                           3D
                            in (18) and (19)? The first reason is that the individual f
                           
                              ijk;opq
                            or g
                           
                              ijkt;opqr
                            is related with point order which makes the values sensitive to noise. So, all the possible point orders in (18) and (19) are considered. Secondly, that we take the square sum other than absolute value sum of f
                           
                              ijk;opq
                            or g
                           
                              ijkt;opqr
                            is because it could make the functions more distinct between zero and nonzero. Besides, the reason why we do not consider higher order sum of f
                           
                              ijk;opq
                            or g
                           
                              ijkt;opqr
                            is because the high order sum is too sensitive to noise. Lastly, weighted f
                           
                              ijk;opq
                            and g
                           
                              ijkt;opqr
                            in such a way become the functions of cross ratios as shown in (12). The cross ratios are the most basic invariants in projective space which are independent of any specific coordinate systems. Why do we take the fifth elements of B
                           1 and B
                           2 when assigning the weights to f
                           
                              ijk;opq
                           ? The reason is detailed next. The similar reason holds for g
                           
                              ijkt;opqr
                            and is omitted.


                           Error analysis for added weights The reason why we take the fifth elements of B
                           1 and B
                           2 when assigning the weight w
                           
                              ijk;opq
                            to f
                           
                              ijk;opq
                            is given below. f
                           
                              ijk;opq
                            has six terms. Let 
                              
                                 F
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              
                            be a general function containing six terms v
                           
                              i
                           , i
                           =1…6. The error for v
                           
                              i
                            is denoted as e
                           
                              i
                           . In practice the obtained function value is the value of 
                              
                                 
                                    
                                       F
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       6
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           . Without loss of generality, we assume ∣v
                           
                              i
                           
                           +
                           e
                           
                              i
                           ∣⩽∣v
                           5
                           +
                           e
                           5∣⩽∣v
                           6
                           +
                           e
                           6∣, i
                           =1…4, namely the ∣v
                           5
                           +
                           e
                           5∣ term is the fifth element of the list ∣v
                           
                              i
                           
                           +
                           e
                           
                              i
                           ∣ after being ordered ascendingly. Since for our case of f
                           
                              ijk;opq
                           , the values of v
                           
                              i
                            are much bigger than the errors e
                           
                              i
                           , from ∣v
                           
                              i
                           
                           +
                           e
                           
                              i
                           ∣⩽∣v
                           5
                           +
                           e
                           5∣⩽∣v
                           6
                           +
                           e
                           6∣ there is still ∣v
                           
                              i
                           ∣⩽∣v
                           5∣⩽∣v
                           6∣. We assign the weight v
                           5
                           +
                           e
                           5 to F
                           
                              e
                            and then have the weight function 
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             e
                                          
                                       
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             5
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             5
                                          
                                       
                                    
                                 
                              
                           . The error for the weight function is the value of 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      5
                                                   
                                                
                                                +
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                F
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           , denoted as ER. We expand ER in the first-order Taylor series:
                              
                                 (20)
                                 
                                    ER
                                    ≈
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   (
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         5
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           For some parameters, if the value of F is zero, then we have v
                           5
                           =−(v
                           1
                           +
                           v
                           2
                           +
                           v
                           3
                           +
                           v
                           4
                           +
                           v
                           6). Substitute v
                           5
                           =−(v
                           1
                           +
                           v
                           2
                           +
                           v
                           3
                           +
                           v
                           4
                           +
                           v
                           6) into (20), we obtain: 
                              
                                 ER
                                 ≈
                                 
                                    
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             5
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             6
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             v
                                          
                                          
                                             5
                                          
                                       
                                       |
                                    
                                 
                              
                           . Since ∣v
                           5∣ is much bigger than the errors e
                           
                              i
                           , ER is small and thus for the zero F, the weight function 
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             e
                                          
                                       
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             5
                                          
                                       
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             5
                                          
                                       
                                    
                                 
                              
                            is stable to noise e
                           
                              i
                           . Clearly, the bigger the denominator is, the smaller the error ER is. However, for some parameters, the values of F will not be zero, a large weight is not a good choice. Assume we assign the largest term ∣v
                           6
                           +
                           e
                           6∣ in the list ∣v
                           
                              i
                           
                           +
                           e
                           
                              i
                           ∣, i
                           =1…6 to F
                           
                              e
                           , then 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      6
                                                   
                                                
                                                +
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      5
                                                   
                                                
                                                +
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      5
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           . Therefore, the weight function by v
                           6
                           +
                           e
                           6 is more close to zero than the weight function by v
                           5
                           +
                           e
                           5. This means that the discriminability between the zero values of F and the nonzero values of F by 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      e
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      6
                                                   
                                                
                                                +
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            is poor. Thus, using the fifth element as the weight is a tradeoff between the stability to noise and the distinctiveness from zero to nonzero.

Based on the criterion functions constructed in Section 4.1, we are able to give an algorithm to determine whether a single-optical-axis camera is aligned or has tangent distortion. In addition, the infinity norm of a constructed feature vector is outputted to indicate the tangent distortion amount. Here, the camera principal point 
                           m
                        
                        0 is assumed to be known and can be reasonably approximated by the image center or the center of the imaged mirror contour in practice (see the analyses in the fourth paragraph of Section 5.1 and the fourth paragraph of Section 5.2). Let ε be a threshold. Assume there are some known space points. The known space points can be obtained by a known grid object or by manual measurement and their accuracies are determined by this object or measurement. A set consisting of six (eight) pairs of space points and their image points is called a six (eight)-point group. In 2D case, we use six-point group and I
                        2D
                        . In 3D case we use eight-point group and I
                        3D
                        . The proposed algorithm is given in Fig. 9
                        .

In the following, some implementation issues in the algorithm about sufficiency condition of the zero infinity norm P, monotonicity of the infinity norm P, threshold setting, and degeneracy will be addressed.

In Section 3, we have proved that if a camera has only radial distortion, i.e. no tangent distortion, all f
                           
                              ijk;opq
                           
                           =0 and g
                           
                              ijkt;opqr
                           
                           =0 in theory, or I
                           2D
                           
                           =0 on all six-point groups for 2D case and I
                           3D
                           
                           =0 on all eight-point groups for 3D case. Equivalently, we can say if there exist I
                           2D
                           ≠0 on some six-point groups (I
                           3D
                           
                           ≠0 on some eight-point group), the camera must have tangent distortion. This means that if P
                           ⩾
                           ε, the camera is nonaligned or has tangent distortion without any question.

Conversely, if a camera has tangent distortion, should there exist some six (eight)-point group whose value of I
                           2D
                           (I
                           3D
                           ) is nonzero? Or, if I
                           2D
                           
                           =0(I
                           3D
                           
                           =0) on all six (eight)-point groups that is P
                           <
                           ε, does it mean the camera is tangent distortion free? In general, the answer is affirmative. Assume that all the values of I
                           2D
                           (I
                           3D
                           ) are zero but the camera lens has tangent distortion, this means that there is a projective transformation between pencil of lines 
                              
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                    
                                       d
                                    
                                 
                              
                            and pencil of lines 
                              
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                    
                                       u
                                    
                                 
                              
                            in 2D image space, where i is the index of different image points, 
                              
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                    
                                       d
                                    
                                 
                              
                            is the image point with tangent distortion, and 
                              
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                    
                                       u
                                    
                                 
                              
                            is the corresponding image point without tangent distortion. If the number of the image points is sufficiently large, this tangent distortion being a projective transformation is not a true tangent distortion because we can make a global projective transformation to remove it in the image. In conclusion, if P
                           <
                           ε, we could say the image has no tangent distortion.

Does a smaller value of P indicate a smaller tangent distortion and does a larger value of P indicate a larger tangent distortion? Or mathematically, is P monotonic?


                           P is the maximum of the values of the feature vector 
                              F
                            and 
                              F
                            consists of values of I
                           2D
                           (I
                           3D
                           ) on different six (eight)-point groups. Some smaller values of I
                           2D
                           (I
                           3D
                           ) from only a few number of six (eight)-point groups cannot indicate smaller tangent distortions. But usually in practice, there are sufficient image points in an image and so we have sufficient six (eight)-point groups. Thus, 
                              F
                            contains a sufficient number of values. If P is smaller, all the values in 
                              F
                            are smaller. Based on the analysis of sufficiency condition of the zero infinity norm P, we know smaller P can indicate smaller distortions in an image.

We performed extensive simulations to investigate the monotonicity of the infinity norm P. We generate different radial distortion images and then add tangent distortion to them. In 2D case, based on different six-point groups, we increase tangent distortion angle for one point in these groups, and then compute the values of I
                           2D
                           . Repeat the processing by increasing tangent distortion angles for two, three, four, five, six points in these groups respectively. We observe that these values of the single function I
                           2D
                            increase gradually with the tangent distortion angles increasing in 12,539 cases out of 14,060, but the rest 1521 cases do not. Among these 12,539 cases, all the different monotonicity shapes are shown in Fig. 10
                           . I
                           3D
                            behaves similarly. Because 
                              F
                            is composed of all the values of I
                           2D
                           (I
                           3D
                           ) on different point groups and P is the maximum of these values, the most part of values in 
                              F
                            that are strictly monotonic assure the monotonicity of P.

Conclusively, the infinity norm P in the proposed algorithm is monotonic with respect to the tangent distortion degree, which supports the output P can measure the tangent distortion amount.

Based on the experiments for monotonicity analysis, we also study how to choose the threshold ε for the algorithm. We collect all the values of the criterion functions on points without tangent distortion to be a set and those with tangent distortion being monotonic to be another set. These two sets are denoted as ST
                           1 and ST
                           2. The maximum of the values in ST
                           1 is taken and denoted as s
                           1. ST
                           2 consists of values of different point groups with increasing tangent distortion level. We take all these values at the lowest tangent distortion level to be a set, denoted as st. Then, the mean of st is taken and denoted as s
                           2. Having obtained s
                           1 and s
                           2, take a value between them and the result is the threshold in our algorithm. In our experiments, we have s
                           1
                           =0.0052, s
                           2
                           =0.0189, and the threshold is taken as 0.01. The reason why we take the mean of st other than the minimum is as follows. Under the lowest tangent distortion level, the tangent distortion of most points is very small, for example in one of our experiments, the tangent distortion angles of 10 points among all 16 points are smaller than 1° and those larger angles are 3.14°, 4.48°, 4.03°, 1.06°, 1.33°, 1.27°. Therefore, all the points in some six (eight)-point groups may be with the very small tangent distortions. It follows that taking the minimum value of st as s
                           2 cannot distinguish between the points without tangent distortion but only disturbed by small noise and the points having tangent distortion. Another reason of why we take the mean of st other than the minimum is that the camera lens is not necessarily meant tangent distortion free when the value of a single criterion function is zero (but there exist nonzero values when the camera has tangent distortion).

If we cannot obtain such a G in Step 1, the used space points distribute in some specific configurations, for example, the configuration with N
                           −1 space points collinear (N is the number of the total space points) or with all space points collinear. These configurations should not be chosen when applying the above algorithm and can be separately dealt with by using the invariants of 1D space points in [18].

The feature vector in the proposed algorithm is invariant to a projective transformation, which makes any a world coordinate system of measuring the space points workable. Another advantage of our work is that it is straightforward from space points and image points, where no other parameters except for the principal point are needed. Some vision tasks such as camera calibration, camera pose determination, and 3D reconstruction are required to solve the camera parameters under some camera imaging model. Once the model is used mistakenly, the solved results are unreliable. Also, to evaluate distortion of a camera by after solving camera parameters cannot be trusted either. For example, tangentially distorted image points do not satisfy the homography transformation [13,14] between space points and image points. If the homography is compulsively computed from tangent distorted images, the result is unreliable. Then the subsequent computation for detecting tangent distortion from such unreliable estimation cannot be reliable either. However, our method does not involve the unreliability and can be trusted. Therefore, it is better to use our method to make camera lens verification before performing some vision task when taking a radial distortion camera. Such an example is shown in the following Section 4.3.

Once we know a camera has only radial distortion, the established invariance equations can also be used for reconstructing the scene structure. In [18], a method to recover structure of a plane is presented from two views, where the intersection points of the camera optical axes with this plane are estimated at first. We present an improvement without resorting to the intersection points. Similar to [18], five points on the scene plane should be known and then from two views to recover the other point coordinates of the plane. As analyzed before, we use the center of imaged mirror contour as 
                           m
                        
                        0. The known five points are denoted as 
                           M
                        
                        
                           i
                        , i
                        =1…5, others unknown as 
                           M
                        
                        
                           j
                        , j
                        =6…
                        n with n being the number of points on the plane. Now we have two views, the image points are 
                           m
                        
                        
                           k
                        , k
                        =1…
                        n under the first view and 
                           
                              
                                 
                                    m
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ,
                              k
                              =
                              1
                              …
                              n
                           
                         under the second view, as shown in Fig. 11
                        . Then we establish the corresponding Eq. (11) 
                        f
                        123,45j
                        
                        =0, j
                        =6…
                        n under the first view (which is the equation of the line L shown in Fig. 11) and those denoted as f′123,45j
                        
                        =0, j
                        =6…
                        n under the second view (which is the equation of the line L’ shown in Fig. 11). These equations are linear for the coordinates of 
                           M
                        
                        
                           j
                        , j
                        =6…
                        n. Each 
                           M
                        
                        
                           j
                        , j
                        =6…
                        n has two coordinates unknown. So, from f
                        123,45j
                        
                        =0 and 
                           
                              
                                 
                                    f
                                 
                                 
                                    123
                                    ,
                                    45
                                    j
                                 
                                 
                                    ′
                                 
                              
                              =
                              0
                           
                         we could solve out 
                           M
                        
                        
                           j
                        . In order to obtain a more stable estimation, we use all the possible equations of f
                        123,45j
                        
                        =0 and 
                           
                              
                                 
                                    f
                                 
                                 
                                    123
                                    ,
                                    45
                                    j
                                 
                                 
                                    ′
                                 
                              
                              =
                              0
                           
                         by changing the point order like in the construction of I
                        2D
                         when solving the equations. The above process can be extended to 3D space based on (17), but at least three views are needed and seven known space points in scene are required.

@&#EXPERIMENTS@&#

In Section 5.1, stabilities of the proposed algorithm to noise with only radial distortion and with including tangent distortion are tested from simulation data. Also, stability of the algorithm to the deviations of the camera principal point is tested. The results show that the criterion functions are very stable and the proposed algorithm in Section 4.2 is effective. In Section 5.2, the algorithm from real images captured by different cameras and under different illumination is tested. According to the test result for one camera, we performed image rectification. All the results show that the algorithm is robust and useful. In Section 5.3, we tested the proposed method of structure recovery after lens verification from both simulation and real data. The result shows that this method has higher accuracy and stability than the invariance method in [18] and the homography method in [37].

We use the catadioptric camera model as shown in Fig. 4. The simulated camera intrinsic parameters are:
                           
                              
                                 K
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   610
                                                   ,
                                                
                                                
                                                   0.8
                                                   ,
                                                
                                                
                                                   500
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   600
                                                   ,
                                                
                                                
                                                   350
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where (500,350) is the principal point 
                           m
                        
                        0 assumed to be known, 0.8 is the skew factor, 610 and 600 are the focal lengths. The mirror parameter e i.e. the distance from 
                           O
                         to 
                           O
                        
                        
                           c
                         is taken as 0.9231. Through an aligned central catadioptric camera with these parameters, sixteen space points on the world X–Y plane are projected to the simulated image plane. The results are shown as “∘” points in Fig. 12
                        , where the view size is not greater than 1000×1000pixels.

Gaussian noise with mean 0 and standard deviation ranging from 0 to 2 pixels is directly added to each of these image points and the principal point. Then from the pairs of the space points and the contaminated image points, the values of I
                        2D
                         are computed by the algorithm proposed in Section 4.2. At each noise level, we perform 100 runs and the histograms of the averaged results are shown in Fig. 13
                        (a). Since the image points have only radial distortion, the values of I
                        2D
                         should be close to zero. We can see that all the values in Fig. 13(a) are not greater than 0.002, which is much smaller than ε
                        =0.01. Namely, the infinity norm P
                        <
                        ε. The standard deviations of the values at each noise level are also calculated and are shown in Fig. 13(b). The result shows that all the standard deviations are not greater than 0.0025 indicating that the evaluation function is stable to noise.

In order to test how well the proposed algorithm can detect non-radial distortion, tangent distortion is also added to each image point “∘” and the result is shown as “*” points in Fig. 12. The axis of the maximum tangent distortion is the horizontal axis through 
                           m
                        
                        0, the axis of the minimum tangent distortion is the vertical axis through 
                           m
                        
                        0, the maximum of the tangentially distorted angle is 11.43°, and the minimum of the tangentially distorted angle is 0.07°. The distortion angles are sampled by a distortion function according to the maximum and minimum distortion axes, and this is similar to the tangent distortions appearing in other places of the paper. The same kind noise as before is directly added to each of these points “*” and 
                           m
                        
                        0. Then the averaged values of 100 runs from the space points and these contaminated image points at each noise level are calculated. The result and the deviations are shown as histogram in Fig. 14
                        . It is seen that many values are greater than ε
                        =0.01 and so P
                        >
                        ε. So the image is considered to have tangent distortion, which is consistent with the real case.

Stability of the algorithm to the deviations of the camera principal point is also tested. At the noise level of 2 pixels to the image points “∘” and “*”, Gaussian noise with mean 0 and standard deviation ranging from 0 to 30pixels is directly added to 
                           m
                        
                        0 and then the averaged values and standard deviations of I
                        2D
                         from 100 runs are calculated and shown as histogram in Fig. 15
                        , where (a) and (b) are the results from the image points “∘” of Fig. 12, (c) and (d) are the results from the image points “*” of Fig. 12. We find that these values are all quite close to the corresponding values under noise level 0 of 
                           m
                        
                        0. The values in (a) are all smaller and many values in (c) under each noise level are greater than ε
                        =0.01. However, when noise level of 
                           m
                        
                        0 is increased to 40 pixels, the corresponding values are changed substantially. With these tests, we conclude that deviations of less than 30 pixels of the camera principal point for the image of size 1000×1000 will not perturb the values of the evaluation function severely. Therefore in practice, the center of the imaged mirror contour can be used as 
                           m
                        
                        0 without worry for the proposed algorithm as the real principal point can rarely surpass such a large range.

Furthermore, our algorithm is tested by a simulated image downloaded from http://www.pointzero.nl/dump/mirrorball_theory/. This image is shown in Fig. 16
                        (a), which is generated by a virtual reflective sphere and an orthographic camera. 72 Image points are extracted and then the lens evaluation algorithm is applied to them. The values of I
                        2D
                         are shown as histogram in Fig. 16(b). The existence of values greater than ε
                        =0.01 that is the infinity norm P
                        >
                        ε indicates that the image has tangent distortion, which is consistent with the ground truth of the tangentially distorted angle of 20°.

The proposed infinity norm P that can measure the tangent distortion amount is tested too. One of the examples is shown as follows. The added maximum of the tangentially distorted angles to image points are respectively 4.48°, 5.26°, 6.04°, 6.88°,7.65°, 8.41°, 9.18°, 9.93°, 10.69°, 11.43°, 12.24°, 13.04°, 13.83°, 14.61°, 15.33°, 16.13°, 16.85°, 17.55°, 18.25°, 18.94°, 19.62°, 20.30°, 20.97°, 21.63°, 22.28°. Then, each of the corresponding infinity norms P is computed and the results are as 0.62, 0.74, 0.91, 1.25, 1.58, 1.86, 2.21, 2.66, 3.16, 3.70, 4.25, 4.86, 5.52, 6.24, 6.99, 7.74, 8.17, 8.60, 9.04, 9.49, 9.95, 10.42, 10.90, 11.40, 11.91. We see that P increases with the distorted angle increasing, as shown in Fig. 17
                        . Although some distortion degrees close very much, the norm can still discriminate them correctly. This monotonicity supports P can measure the tangent distortion amount. But, there exists some transformation between the infinity norm P and the Euclidean distortion degree. The transformation is not discussed here because it is needed to calibrate all the camera parameters which loses the advantages of the proposed invariants and is out of the scope of this paper.

The corresponding algorithm from 3D space points and their image points is also tested. The radially distorted images of the 3D space points are shown as “∘” points and the images that have both radial and tangent distortions from the 3D space points are shown as “*” points in Fig. 18
                        . For the image points “*”, the maximum of the tangentially distorted angle is 11.65∘ and the minimum of the tangentially distorted angle is 0.06°. Gaussian noise is added to each of the image points. From the contaminated image points and their space points, the calculated averaged values of I
                        3D
                         of 100 runs are shown in Fig. 19
                        , where (a) is from “∘” points and (b) is from “*” points. Similarly, the standard deviations are also computed. For (a), the deviations are not greater than 0.0045 and for (b), the deviations are not greater than 0.0346. Compared the infinity norms in (a) and (b) of Fig. 19 with ε
                        =0.01, the algorithm is validated from 3D space points.

Four distortion images are shown in Fig. 20
                        , where (a) and (b) are two catadioptric images of size 2048×1536pixels captured by a NIKON COOLPIX990 camera with a hyperbolic mirror designed by the Center for Machine Perception, Czech Technical University. And Fig. 20 (c) is an image of size 2048×1536pixels captured by a NIKON COOLPIX990 camera with a FC-E8 fisheye lens. Fig. 20(d) is also a catadioptric image of size 1024×768pixels captured by the same camera system as that for (a) and (b) but with the camera facing the mirror slantwise.

2D scene points on the ceiling are used and their image points are shown as the red circle points in Fig. 20. The image center and the center of the imaged mirror contour are taken as the camera principal point respectively.

Take the image center as the camera principal point and then the algorithm in Section 4.2 is applied to each of these four images. The calculated values of I
                        2D
                         are shown as (a), (b), (c) and (d) in Fig. 21
                        , where we see that all the values in (a) and (c) are smaller while there exist values in (b) and (d) greater than the threshold ε
                        =0.01. Namely, the infinity norm P
                        <
                        ε in (a) and (c). The infinity norm P is 0.10 in (b) and is 1.72 in (d), which all P
                        >
                        ε. It follows that the cameras was aligned and had no tangent distortion when capturing (a) and (c) but nonaligned when capturing (b) and (d). That the contour of the mirror is clearly deviated to the left in the image (b) and the slant of the camera to the mirror in the image (d) also reveal the nonalignment.

We also use the center of the imaged mirror contour as 
                           m
                        
                        0 to repeat the above experiments. The distances from the image center to the center of the imaged mirror contour are respectively 23.92, 126.82, 14.15, 21.85 pixels for the images (a), (b), (c), and (d). For images (a), (c), and (d), the ratios of these distances to the image horizontal size or to the image vertical size are all less than 30/1000 while for the image (b) the ratios are greater than 30/1000. So according to the experience from simulation (the fourth paragraph in Section 5.1), we expect that when using the center of the imaged mirror contour as 
                           m
                        
                        0, the values of I
                        2D
                         for the images (a), (c) and (d) would not change greatly compared to the previous ones, while for the image (b) the values of I
                        2D
                         would. In fact, the results are consistent with our expectation. For the image (b), the corresponding values when using the center of the imaged mirror contour as 
                           m
                        
                        0 are shown in Fig. 22
                        . It can be observed that the values are much smaller than those in Fig. 21 (b), which indicates that when capturing the image (b), the mirror is just horizontally deviated and this deviation generates little non-radial distortion. So, in practice using the center of imaged mirror contour as the principal point is more reliable than using image center as the principal point for this catadioptric camera. These experiments once again demonstrate the usefulness of the proposed algorithm.

We tested the algorithm with real image from 3D space points too. An image taken by the FC-E8 fisheye camera is shown in Fig. 23
                        (a), where space points of the red circle points are measured as known. The values of I
                        3D
                         on these image points and their space points are calculated. The result when the image center is taken as 
                           m
                        
                        0 is given in Fig. 23(b), of which all the values are smaller than ε
                        =0.01. There is the similar result when the center of the imaged contour is taken as 
                           m
                        
                        0. These are coincident with the experiment of Fig. 20(c) by using 2D points.

We have performed extensive experiments under various conditions. Besides the above images with general indoor illumination, images with different illuminations as shown in Fig. 24
                        (a)–(c) are also tested. Besides the above indoor images, outdoor images as shown in Fig. 24(d)–(g) are tested. Besides the above used FC-E8 fisheye camera, images captured by another kind of fisheye camera—SIGMA F3.5 EX DG are tested and such an image is shown in Fig. 24(c). The image sizes of Fig. 24(a) and (b) are both 2048×1360pixels, that of (c) is 2256×1504pixels, and those of (c), (d) and (e) are 2048×1536pixels. Indoor we use a grid board or a grid ceiling, where it is upright in (a) but not in (b) and (c). Outdoor, we use a floor grid as shown in (d) and a building plane as shown in (e)–(g). The used grid plane in (e)–(g) is upright but not in (d). Furthermore, in (g) the mirror of the used catadioptric camera is slantwise, i.e. the camera is not well aligned. By correspondences between space grid points and their image points, the values of the proposed criterion function are computed and the results are shown in Fig. 25
                         respectively. The evaluations are consistent with the previous evaluations. Similarly, the result from (g) reveals the nonalignment of the camera.

By the above evaluations, the FC-E8 fisheye camera and SIGMA F3.5 EX DG fisheye camera can be considered to have only radial distortion. For the catadioptric camera, if the values of the infinity norm are less than a given threshold, the camera is regarded aligned. These lens evaluations were validated in our many research works. Under only radial distortion from the images captured by these cameras, we performed camera calibration [30], 3D reconstruction as in Section 5.3 of this paper or [18], and image rectification [30]. The details of camera calibration, image rectification, and 3D reconstruction from the catadioptric camera and FC-E8 fisheye camera can be found in [30,18] or Section 5.3. As camera calibration and image rectification for the SIGMA F3.5 EX DG fisheye camera, one example is shown below. With only radial distortion model of Kannala and Brandt [31], the camera parameters are calibrated and the images are subsequently rectified. For the image in Fig. 24(c), the rectified image is shown in Fig. 26
                         and the lines become straight.

We test the method in Section 4.3 by both simulations and real data including comparing with the invariance method in [18] and with the homography method in [37]. The result shows that this method has higher accuracy and stability than that in [18] and that in [37].

The same data as [18] are used.

In simulation, the Gaussian noise with mean 0 and standard deviations 0, 0.4, 0.8, 1.2, 1.6, 2pixels is respectively added to each of the image points and then the space points are reconstructed by the methods of Section 4.3 and of [18,37]. For each noise level we perform 100 independent experiments and the averaged results are shown in Fig. 27
                        . Each subfigure in Fig. 27(a) shows the reconstructed X-coordinate of each space point vs. noise levels of 0, 0.4, 0.8, 1.2, 1.6, 2pixels and each subfigure of Fig. 27(b) shows the corresponding reconstructed Y-coordinate, where the method in Section 4.3 is denoted as “Inv1-M”, the method in [18] as “Inv2-M”, and the method in [37] as “H-M”. Under the noise level 0, all of the reconstructed results are accurate with errors 0. Under other noise levels, reconstructed accuracies and standard deviations for most of the points under each noise level by the method of Section 4.3 are improved. The maximum absolute error is 0.36 and the maximum deviation is 1.14. While by that of [18], they are 0.72 and 2.06. By [37], all the errors and deviations are much bigger, in particular, of the reconstructed points close to optical axis.

In experiments with real data, Fig. 28
                         shows the reconstructed points, where points in “*” are those from the method of Section 4.3, points in “∘” from [18], and points in “+” from [37]. The previous two kinds of reconstructions are comparable and the maximum errors are both 0.24. While, the maximum error from [37] is 0.98.

@&#CONCLUSION@&#

We derive invariants from 2D/3D scene points and their radially distorted image points under a single-optical-axis camera. Then based on them, a criterion function and a feature vector are constructed to evaluate alignment or tangent distortion for the camera lens. The evaluation method only needs comparing the infinity norm of the feature vector with a threshold, in which no estimation of camera parameters except for the principal point is needed. The principal point is taken as the center of the imaged edge contour. Ahmed and Farag [29] proved that deviation of distortion center from its true location has relation with tangent distortion. Here, we analyze the soundness of taking the center of the imaged edge contour (in the fourth paragraph of Section 5.1 and the fourth paragraph of Section 5.2). Once the camera lens is shown to be tangent distortion free, an improved structure reconstruction method from [18] is also presented. Extensive experiments under various conditions are performed and demonstrate the evaluation of camera lens is very stable to noise and useful in applications. The transformation between the infinity norm in the proposed algorithm indicating the tangent distortion amount and the Euclidean distortion degree is interesting to be studied next. Furthermore, to explore more applications of the introduced invariants and to establish invariants for more geometric entities like in [28] will be our future step.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank Mr. Richard Annema, Director of Client Relations SplutterFish of LLC, for his kind free provision of the image in Fig. 16(a). This work was supported by the National Basic Research Program of China under Grant No. 2012CB316302, by the National Natural Science Foundation of China under Grant No. 61333015, and by a Grant from the Research Grants Council of Hong Kong [Project No. CityU118613].

@&#REFERENCES@&#

