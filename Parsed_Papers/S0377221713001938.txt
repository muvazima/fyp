@&#MAIN-TITLE@&#Estimating freeway traffic measures from mobile phone location data

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We considered the fact that multi-phones exist in a traveling vehicle.


                        
                        
                           
                           We used a clustering method to estimate freeway traffic measures from mobile phone location data.


                        
                        
                           
                           Three factors influence estimation accuracy of traffic measures.


                        
                        
                           
                           Further development of location technologies will improve estimation accuracy.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Traffic

Traffic measures estimation

Mobile phone

Clustering analysis

Freeway

@&#ABSTRACT@&#


               
               
                  The worldwide propagation of mobile phone and the rapid development of location technologies have provided the chance to monitor freeway traffic conditions without requiring extra infrastructure investment. Over the past decade, a number of research studies and operational tests have attempted to investigate the methods to estimate traffic measures using information from mobile phone. However, most of these works ignored the fact that each vehicle has more than one phone due to the rapid popularity of mobile phone. This paper considered the circumstance of multi-phones and proposed a relatively simplistic clustering technique to identify whether phones travel in the same vehicle. By using this technique, mobile phone data can be used to determine not only speed, but also vehicle counts by type, and therefore density. A complex simulation covering different traffic condition and location accuracy of mobile phone has been developed to evaluate the proposed approach. Simulation results indicate that location accuracy of mobile phone is a crucial factor to estimate accurate traffic measures in case of a given location frequency and the number of continuous location data. In addition, traffic demand and clustering method have a certain effect on the accuracy of traffic measures.
               
            

@&#INTRODUCTION@&#

Comprehensive and accurate traffic information is necessary to manage the freeway network and provide navigation services for the road users. Traditionally, freeway traffic measures have been obtained from the fixed sensors such as loop detectors and television cameras. Due to the high cost of the devices installation and maintenance, they are typically installed only on a relatively small portion of the freeway, thus providing limited coverage of the entire freeway network. In addition, these fixed sensors are vulnerable to extreme weather in certain areas. With the rapid development of wireless communication technologies, mobile sensors based on GPS (Global Positioning System) and mobile phones have been increasingly applied to collect traffic data in recent years. GPS-based sensors can provide better accuracy in terms of vehicle position compared with mobile-phone-based sensors, but traffic information which is acquired from a small group of vehicles equipped with GPS device is insufficient to represent general traffic flow and this may lead to a bias of real traffic information. Mobile phones become very popular at present. According to national telecommunications statistics, up to May 2012, the mobile phone penetration rate in China grows to 78.02%. So using mobile phones instead of GPS to estimate traffic measures has attracted a lot of attention. Compared with GPS-based sensors, mobile-phone-based sensors have the advantage of the ready-to-use infrastructure and the wide coverage. Moreover, mobile-phone-based sensors are less susceptible to multi-path fading from skyscrapers than GPS-based sensors (Jirapa et al., 2008). During the past years, a number of operational tests and simulated studies have attempted to investigate the feasibility of traffic measures acquisition from mobile-phone-based sensors. The first operational test was CAPITAL (Cellular Applied to ITS Tracking and Location) project, which was conducted by University of Maryland Transportation Studies Center (1997) over 27 month period in the Washington DC area and various state routes in the Virginia suburbs. The test demonstrated the location technique can provide geolocation data and vehicle speed under the proper circumstances, but the geolocation data do not appear to be accurate enough to adequately estimate speed. STRIP (System for TRaffic Information and Positioning) project conducted a field test on inter-city motorways and intra-urban motorways of Lyon (Ygnace et al., 2001). The objectives of the STRIP project were to estimate highway travel times by “Abis/A probing” location technology. Estimated travel time from mobile phones was compared with data from loop detectors both on inter-city motorways and intra-urban motorways, with a larger variation in the second case (Yim, 2003; John et al., 2011). In 2002, Finnish Road Administration and mobile phone operators conducted a study that used mobile phone data to estimate travel time. The travel time estimation from the mobile phone position was compared to License Plate Recognition estimation. Good results were obtained when vehicles leaving or merging with the link or stopping on the link are rare (Kummala, 2002; Virtanen, 2002). The TTECP (Travel Time Estimation Using Cell Phone) project was initiated by the Florida Department of Transportation in 2004, with an objective of investigation on mature and applicability of using mobile phones to estimate travel time. The TTECP team found by virtue of their investigations that travel time estimation in congested condition is less accurate than in free flow condition (Wunnava et al., 2007). During January–March of 2005, Hillel (2007) compared speed and travel time measurements from a cellular phone-based system with loop detector data on a 14kilometer freeway. Good match between the two measurement methods indicated that the cellular phone-based system play a practical role for traffic information collection. From January to July of 2008, a project on traffic information acquisition from mobile phone location has been exhibited in China. Two mobile phone operators conducted experiments on several road segments of Beijing, Shanghai, Tianjin and Jinan city to obtain test values of average travel time. The accuracy of test values in the four cities is 71%, 77%, 68% and 61% respectively (Wang, 2009). Researchers from the University of California at Berkeley and Nokia Telecommunications Company performed a 7-hour field experiment to test the feasibility of using GPS-equipped cell phones as traffic probe. The travel time and velocity estimates proved to be accurate against video data (Saurabh et al., 2008). A project proposed by Transportation Development Centre of Canada showed that it is clearly feasible to use A-GPS-enabled cell phones to estimate speed. The testing on the highway was more successful than on the arterial roads (Kirk et al., 2005). Besides, simulation studies have shown the potential for the estimation of traffic measures using mobile phone location. Astarita et al. (2006) proposed a new method for estimation of vehicular flows and densities on motorways by fusing traffic counts with mobile phone counts. Numerical application on a test network showed that the precision of the estimate improves with an increase in the ratio between mobile phones on board and total vehicles on the network. Bolla and Davoli (2000) analyzed the possibility of collecting traffic parameters based on mobile phones in vehicles. The tests using traffic simulator showed a satisfactory result. Fontaine and Smith (2004) developed a test bed consisted of a microscopic traffic simulation model and an emulated WLT-based monitoring system to assess the quality of speed estimates. The researchers found that map matching, sample frequency, location error, geometric and traffic characteristics are major factors for speed estimation accuracy. David (2003) presented an invention to utilize cell phone position data for creating vehicles path profile and estimating travel time by vehicles clustering. Sohn and Hwang (2008) investigated main factors that affected the performance of the space-based mobile phones as traffic probes.

However, Most of these works including operational tests and simulated studies assumed that every vehicle has maximum one mobile phone. With the rapid popularity of mobile phone, it is necessary to consider the possibility that more than one phone locates in a vehicle. So this paper took into account the circumstance of multi-phones and proposed a clustering method to obtain individual vehicle counts and further to estimate traffic measures from mobile phone location data. The remainder of this paper is organized as follows: Section 2 describes the mobile-phone-based traffic information system. Section 3 elaborates the proposed method including path selection of mobile phone, location data preprocessing, the clustering method and traffic measures estimation. Section 4 presents a simulation experiment with the microscopic traffic simulation VISSIM which simulates the freeway network and records traffic data. Section 5 offers a conclusion along with future research topics.

The mobile-phone-based traffic information system consists of three parts: mobile phone location, map-matching and traffic measures estimation system. Mobile phone location system generates geographical coordinates of mobile phone according to AOA (Angle of Arrival) or TDOA (Time Difference of Arrival) location technique. Map-matching techniques are in charge of integrating phone location data with digital road network data to place a phone on the correct path. Since a moving vehicle has similarity in traveling discipline with corresponding phones subscribed by drivers or passengers (called vehicle based phones), traffic measures estimation system identifies individual vehicle counts on an observed segment based on clustering algorithm so that traffic measures can be acquired.

Path selection of mobile phone depends on each phone consecutive positions provided by the phone network operator periodically. The position information including phone’s unique ID number, geographical coordinates and signal receiving time are stored in the database. Based on the latest m (m is discussed in Section 4.1) recorded positions 
                           
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             im
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                         for a special phone i, the map-matching algorithm presented below is used to select the correct phone path and determined the phone position on the selected path. Given a position 
                           
                              
                                 
                                    p
                                 
                                 
                                    ik
                                 
                                 
                                    ′
                                 
                              
                           
                         at time k and digital road network, the map-matching algorithm takes the roads crossing the circle centered at 
                           
                              
                                 
                                    p
                                 
                                 
                                    ik
                                 
                                 
                                    ′
                                 
                              
                           
                         and having radius R (maximum phone location error) as candidates for locating 
                           
                              
                                 
                                    p
                                 
                                 
                                    ik
                                 
                                 
                                    ′
                                 
                              
                           
                        . Assume that 
                           
                              
                                 
                                    h
                                 
                                 
                                    ik
                                 
                                 
                                    l
                                 
                              
                           
                         represents the vertical distance from 
                           
                              
                                 
                                    p
                                 
                                 
                                    ik
                                 
                                 
                                    ′
                                 
                              
                           
                         to candidate road l. We define the probability of a position 
                           
                              
                                 
                                    p
                                 
                                 
                                    ik
                                 
                                 
                                    ′
                                 
                              
                           
                         on the candidate road l as 
                           
                              
                                 
                                    ζ
                                 
                                 
                                    ik
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    1
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ik
                                                   
                                                   
                                                      l
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         and the average probability of a series of positions 
                           
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             im
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                         on the candidate road l as 
                           
                              
                                 
                                    γ
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    ζ
                                 
                                 
                                    ik
                                 
                                 
                                    l
                                 
                              
                           
                        . The candidate road with the maximum γ
                        
                           l
                         is considered as phone path. Then the geographical positions 
                           
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             im
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                         are assigned the corresponding positions (p
                        
                           i1,
                        p
                        
                           i2,…,
                        p
                        
                           im
                        ) on the selected path by vertical projection.

As every mobile phone is a potential probe, location data collected from mobile phone do not completely originated from vehicles traveling on a freeway. For example, a number of information from mobile phones of pedestrian, of non-motorized vehicles or of stopping vehicles on a freeway can be located and interfere with the traffic measures estimation. So we should separate phones located in moving vehicles from all other phones. According to “Road Traffic Safety Law of the People’s Republic of China” seventy-eighth clause, the speed for vehicle traveling on the freeway should not be less than 60kilometers/hour and not exceed 120kilometers/hour. Under normal circumstances, the speed ranges for pedestrian and non-motor vehicles are about 2–6kilometers/hour and 8–16kilometers/hour respectively. The average speed for these phones is quite different from that of moving vehicles. Consider a mobile phone i whose path profile contains m continuous position data: (p
                        
                           i1,
                        p
                        
                           i2,…,
                        p
                        
                           im
                        ), p
                        
                           i1
                        =(x
                        
                           i1,
                        y
                        
                           i1) is the initial position, p
                        
                           im
                        
                        =(x
                        
                           im
                        ,
                        y
                        
                           im
                        ) is the current position. The average speed between p
                        
                           i1 and p
                        
                           im
                         is 
                           
                              
                                 
                                    
                                       
                                          vp
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                        . A mobile phone that travels with an average speed 
                           
                              
                                 
                                    
                                       
                                          vp
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         larger than predetermined speed, say, 16kilometers/hour is a vehicle based phone.

Limited to present mobile phone location technologies, missing or outlying positions may appear. If the phone location data is missed continuously, the phone probably left the observed segment and its position data should be removed. Otherwise, we use interpolation and extrapolation method to supplement missing positions and outlying positions. Using interpolation and extrapolation method, we should construct a linear regression function x
                        =
                        x(t) and y
                        =
                        y(t) based on the m observed-paired values (t
                        1,
                        x
                        
                           i1), (t
                        2,
                        x
                        
                           i2),…,(t
                        
                           m
                        ,
                        x
                        
                           im
                        ) and (t
                        1,
                        y
                        
                           i1),(t
                        2,
                        y
                        
                           i2),…,(t
                        
                           m
                        ,
                        y
                        
                           im
                        ) respectively. By function x
                        =
                        x(t) and y
                        =
                        y(t), the position of phone can be calculated at any moment t
                        
                           k
                        , as x
                        
                           ik
                        
                        =
                        x(t
                        
                           k
                        ), y
                        
                           ik
                        
                        =
                        y(t
                        
                           k
                        ).

The freeways are divided into segments according to its direction and characteristics. Freeway marks such as entry, exit, curve places, and places where the width changes, should be the starting node of freeway segments (Quang and Eiji, 2011). Except for the special point, the freeway segments are divided in every 2kilometers.

Suppose there are n phones located on an observed segment of freeway and their m consecutive location data can be sampled, and then we obtain a data set P:
                           
                              (1)
                              
                                 P
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                         m
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   …
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         n
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         n
                                                         2
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         nm
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where p
                        
                           ik
                        
                        =(x
                        
                           ik
                        ,
                        y
                        
                           ik
                        ) (i
                        =1,2,…,
                        n,
                        k
                        =1,2,…,
                        m) is the position coordinate of phone i at time k. Individual vehicle can be identified based on graph clustering because multi-phones in a common vehicle produce consistently similar positions at each sampling time. Clustering analysis partitions a given data set into clusters by maximizing intra-cluster similarity and minimizing inter-cluster similarity (Zaiane et al., 2002). A multitude of clustering methods have been extensively studied in the literature. The methods include partitional clustering, hierarchical clustering, density-based clustering and grid-based clustering, etc (Jain et al., 1999). As a hierarchical divisive algorithm, graph clustering algorithm would be appropriate for the identification of individual vehicle. Graph clustering denotes clustering object and its attribute value as a connected, undirected, the weighted graph G
                        =(P,
                        E,
                        ω), where P is the set of vertices, E is the set of edges between pairs of vertices, ω(e)=
                        ω(u,
                        v) is specifying weight for each edge e
                        =(u,
                        v),
                        e
                        ∈
                        E. A connected acyclic subgraph that includes all vertices is called a spanning tree of graph G. A minimum spanning tree is a spanning tree with minimum total weight, that is:
                           
                              (2)
                              
                                 ω
                                 (
                                 MST
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   e
                                                   ∈
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          ω
                                          (
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        Considering the requirement for real-time traffic measures collection, an improved graph clustering method was used to identify individual vehicle. The identification process consists of the following five steps.
                           
                              (1)
                              Take n phones as vertices to construct a connected, undirected graph G
                                 =(P,
                                 E,
                                 ω). In graph G, each edge e
                                 =(P
                                 
                                    u
                                 ,
                                 P
                                 
                                    v
                                 ) (u
                                 =1,2,…,n,
                                 v
                                 =1,2,…,n,
                                 u
                                 ≠
                                 v) has a corresponding weight ω(e)=
                                 ω(P
                                 
                                    u
                                 ,
                                 P
                                 
                                    v
                                 ) which is defined as Euclidean distance between P
                                 
                                    u
                                  and P
                                 
                                    v
                                 :
                                    
                                       (3)
                                       
                                          ω
                                          (
                                          e
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            u
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            v
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            uk
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            vk
                                                         
                                                      
                                                      
                                                         
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            uk
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            vk
                                                         
                                                      
                                                      
                                                         
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Determine the threshold value β
                                 1
                              

Considering the worst case, suppose a pair of phones in the same vehicle is located on two sides of the true position and their location errors reach the maximum location error +R and –R respectively at all sample time, where R is a predetermined value, β
                                 1 can be determined by the following formula:
                                    
                                       (4)
                                       
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          m
                                          ×
                                          (
                                          R
                                          -
                                          (
                                          -
                                          R
                                          )
                                          )
                                          =
                                          2
                                          mR
                                       
                                    
                                 
                              

If Euclidean distance of two phones on the observed segment is larger than β
                                 1, the two phones cannot be attributed to the same vehicle. So we remove the edge whose weight is larger than β
                                 1 in order to partition phones which cannot be attributed to the same vehicle. As a result, subgraphs S of graph G are formulated.

Generate minimum spanning tree for subgraphs S
                              

If subgraph S has no cycle, we regard S as a minimum spanning tree. For the cyclic subgraph S, we find its minimum spanning tree based on Prim’s algorithm (Prim, 1957). It lets T be an arbitrary vertex of subgraph S, and at each step adds the smallest edge connecting T with G
                                 −
                                 T to T until T includes all the vertices of subgraph S. Then T is the minimum spanning tree of S.

Remove the largest edge of all subgraph to get c clustering subset at each step until the function CH (discussed as follows) reach maximal value.

Identify the optimal number of clusters on the data set in an unsupervised way.

The principle of determining the optimal clustering solution is to minimize intra-cluster distance and maximize inter-cluster distance. In this paper, we selected CH (Calinski and Harabasz, 1974) function to search the optimal number of clusters. It is defined as:
                           
                              (5)
                              
                                 CH
                                 (
                                 c
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             c
                                          
                                       
                                       q
                                       ‖
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                          
                                       
                                       -
                                       μ
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       (
                                       c
                                       -
                                       1
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             c
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             q
                                          
                                       
                                       ‖
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       (
                                       n
                                       -
                                       c
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    c
                                 
                              
                              q
                              ‖
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                              -
                              μ
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                         is the error sum of squares for inter-cluster (phones distributed in different vehicles), 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    c
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    q
                                 
                              
                              ‖
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                         is the squared differences of intra-cluster (phones in a common vehicle), q is the number of phones in group j (vehicle j), n is the number of phones on the observed segment, c is the number of clusters, μ is means of data set P, μ
                        
                           j
                         is means of group j. CH function divides the intra-cluster variability of a solution by the corresponding inter-cluster variability, both corrected for their respective degrees of freedom. Calculated for each possible cluster solution, the largest CH-value indicates the optimal number of clusters c
                        ∗ corresponding to the vehicle counts on the observed segment.

Contrast to spot speed, average travel speed is more suitable to identify traffic condition on an observed segment. Path selection and freeway segments division have been discussed in Sections 3.1 and 3.3 respectively. Through clustering analysis, the number of vehicles on an observed segment and the number of phones in a common vehicle can be obtained. Then we calculate the speed of phone i in vehicle j during time period k:
                              
                                 (6)
                                 
                                    
                                       
                                          vp
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  k
                                                                  -
                                                                  1
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  k
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  k
                                                                  -
                                                                  1
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    q
                                    ,
                                    
                                    k
                                    =
                                    2
                                    ,
                                    3
                                    ,
                                    …
                                    ,
                                    m
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       vp
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                              
                            is the speed of phone i in vehicle j during time period 
                              
                                 k
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                ,
                                                k
                                                -
                                                1
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                                ,
                                                k
                                                -
                                                1
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                            are the position coordinates of phone i at sampling time k–1 and k, T is observing period, q is the number of phones in vehicle j, m is the number of continuous location data for phone i, c
                           ∗ is the estimated vehicle counts on the observed segment.

The speed of vehicle j during time period k is:
                              
                                 (7)
                                 
                                    
                                       
                                          vv
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                q
                                             
                                          
                                          
                                             
                                                vp
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                       
                                       
                                          q
                                       
                                    
                                    ,
                                    k
                                    =
                                    2
                                    ,
                                    3
                                    ,
                                    …
                                    ,
                                    m
                                 
                              
                           Average travel speed of an observed segment during time period k is the harmonic mean speed of all individual vehicles:
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          1
                                          /
                                          
                                             
                                                vv
                                             
                                             
                                                k
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

It is necessary to classify vehicles because different vehicle types have different influence to traffic condition. This work assumes that there are three kinds of vehicles including cars (sedan, van, SUV, jeep), intercity buses and heavy trucks on an observed segment. Suppose the maximum capacity for cars, intercity buses and heavy trucks are 7, 40 and 2 respectively. The flow chart of vehicle type identification is shown in Fig. 1
                           , where q is the number of phones in individual vehicle j, c
                           
                              c
                            is the number of vehicles per kilometer on the observed segment, 
                              
                                 
                                    
                                       
                                          
                                             vv
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                              
                            is average speed of individual vehicle j, that is: 
                              
                                 
                                    
                                       
                                          
                                             vv
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       o
                                       =
                                       2
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       vv
                                    
                                    
                                       o
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                                 /
                                 (
                                 m
                                 -
                                 1
                                 )
                                 ,
                                 
                                 max
                                 
                                    
                                       vv
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                              
                            is the maximum value of 
                              
                                 
                                    
                                       vv
                                    
                                    
                                       2
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       vv
                                    
                                    
                                       3
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       vv
                                    
                                    
                                       m
                                    
                                    
                                       (
                                       j
                                       )
                                    
                                 
                              
                           . According to the research of Changan University, the utilization rate for intercity buses is about 74.98% in 2009 (Xiao et al., 2011). So buses will be recognized by detecting the number of phones in a single vehicle at the 1st step as shown in Fig. 1. The 2nd step is to differentiate cars and heavy trucks based on their speed and the number of phones in an individual vehicle. If the number of phones in an individual vehicle is larger than two, then this vehicle should be in cars class. If there are one or two phones in an individual vehicle, we adopt average speed and maximum speed of a vehicle to identify cars and heavy trucks. According to statistical data from traffic information center of Shandong province, the speed of cars ranges from 90kilometers/hour to 130kilometers/hour, whereas the speed of heavy trucks is between 60kilometers/hour and 80kilometers/hour. Obviously, cars and heavy trucks have different speed patterns under normal traffic condition. But under congested traffic condition, the speed of cars is limited and becomes close to that of trucks. So we use average speed or maximum speed to differentiate cars and heavy trucks based on normal or congested traffic condition. Normal and congested traffic state is roughly classified by the number of vehicles per kilometer c
                           
                              c
                            on the observed segment.

Suppose the number of cars, heavy trucks and buses is c
                           1, c
                           2and c
                           3 respectively on the observed segment after vehicle type identification, where c
                           ∗
                           =
                           c
                           1
                           +
                           c
                           2
                           +
                           c
                           3. Let ρ(k) denote traffic density during time period k on the observed segment. ρ(k) is estimated by the following formula:
                              
                                 (9)
                                 
                                    ρ
                                    (
                                    k
                                    )
                                    =
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    ×
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    ×
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                    ×
                                    
                                       
                                          c
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    /
                                    L
                                 
                              
                           where λ
                           1, λ
                           2 and λ
                           3 are the conversion coefficient of cars, heavy trucks and buses respectively, L is length of the observed segment.

It should be noted that vehicles without mobile phones may affect the estimation accuracy of traffic measures. A survey conducted in Athens showed that 86.89% of the vehicles had at least one mobile phone in 2003 (Theodore and Efstathios, 2007). With the rapid popularity of mobile phone, the probability of vehicles without mobile phones is very small. If the proportion of vehicles without mobile phones to the total vehicles traveling on freeway is less than 10%, traffic measures estimated by the proposed approach can be considered truly representative traffic data (David, 2003). However, in the event that the proportion exceeds 10%, the estimated vehicle counts should be corrected according to the statistical ratio (vehicles with mobile phones to the total vehicles) collected through public survey.

In order to verify the efficiency of the proposed method, a complex simulation experiment has been devised. The simulation system consisted of two major parts: the simulation of the freeway network using microscopic simulation software and the simulation of a mobile-phone-based traffic information system. The traffic simulation provides the simulated mobile-phone-based traffic information system with actual traffic data.

We took a unidirectional two-lane freeway composed of five segments stretch of 10kilometers as simulation object and assumed that every vehicle has at least one mobile phone. Microscopic simulation software VISSIM was used to generate and record tracking data for all vehicles traveling on the freeway every second. Each record includes a unique vehicle identification number, a true position expressed in x, y coordinates, and a vehicle type. Traffic demand on the freeway was determined by configuration of traffic volume assigned to given pairs of trip origin and destination. At each simulation run, traffic demand was set to 500vehicle/hour/lane, 1000vehicle/hour/lane and 1500vehicle/hour/lane which represent free flow, stable flow and congested flow condition respectively. According to statistical data from traffic information center of Shandong province, traffic compositions were defined for the observed freeway: 70% car type, 20% truck type and 10% bus type. The setting speed range for cars, trucks and buses was 100–130kilometers/hour, 60–80kilometers/hour and 80–100kilometers/hour respectively.

The traffic data recorded by VISSIM were input to the mobile-phone-based traffic information system to generate phone counts and positions. The phone counts in an individual vehicle are randomly generated according to the maximum capacity for the different vehicle types. Related literatures (Cong and Zhuang, 2005; Zhang, 2005) showed that the phone location errors primarily came from non-line-of-sight propagation and system errors. Zhang (2005) also analyzed the errors statistical properties in detail and concluded that the errors approximately followed a normal distribution. So this paper assumed the phone location errors follow a normal distribution with 95 percentile of errors within radius R. R is set to 15/30/50/100 meters for each scenario. Assume (x,
                        y) and 
                           
                              (
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         represent the coordinates of individual vehicle and the coordinates of phones instructed in the vehicle respectively (see Fig. 2
                        ). Each phone position is generated by introducing a random location error to the corresponding vehicle position with the following formula:
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             x
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             ×
                                             cos
                                             α
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             y
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             ×
                                             sin
                                             α
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             q
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    x
                                    
                                       
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    (
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    y
                                    
                                       
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              q
                           
                         is the number of phones in a common vehicle. The range of angle α is [−180°,180°]. For each simulation, r
                        
                           i
                         is randomly generated following a normal distribution with mean R/2 and standard deviation R/2/1.96, and α is randomly generated following a uniform distribution between −180° and 180°.

The sampling period of phone location T is set to 30seconds and the predetermined number of each phone latest recorded positions on the observed segment is set 5, that is m
                        =5. Increasing the number of positions will lead to a better clustering effect. However, we have to consider the moving distance of vehicle during (m
                        −1)T interval. For example, a vehicle with speed of 100kilometers/hour (27.78meter/seconds) will move (m
                        −1)×833.3meter during (m
                        −1)T interval if T
                        =30seconds. Obviously, increasing the number of positions will increase the vehicle traveling distance and traveling route, which will also bring difficulty to map matching and path selection. This work took a compromise between these two problems and set m
                        =5. For each scenario, the simulation has run for one hour.

@&#RESULTS AND DISCUSSION@&#

Vehicle counts, average travel speed and traffic density on the observed segment stretch of 2kilometers between 1400seconds and 2000seconds are estimated at interval of 30seconds. Because phone counts and position are generated randomly, we take five times simulation for each traffic demand. The actual mean phone counts and vehicle counts at all observed moments for five simulations are presented in Table 1
                        .


                        Figs. 3–5
                        
                        
                         shows the comparison results between estimated traffic measures in different phone location errors and actual values derived from VISSIM (only the first simulation results have been given).


                        Fig. 6
                         gives the results of vehicle type identification when traffic demand is 1000vehicle/hour/lane.

Mean relative error and the percent of relative error within 10% for estimated vehicle counts in different traffic demands and phone location errors are presented in Table 2
                        . As illustrated in Table 2, estimation errors of vehicle counts increase as phone location errors increase. The difference of traffic demand does not seem to affect the accuracy of vehicle counts significantly. The main reasons for generating estimation errors of vehicle counts are as follows:

(1) Phone location errors

The larger the phone location errors are, the larger the Euclidean distance of phones in the same vehicle are, which may result in incorrect clustering.

(2) Parallel vehicles

Vehicles are traveling side by side on the two lanes during the observing period, especially under the circumstances of large traffic demand. At present, phone location technique cannot distinguish on which lane the phone locates. The phones in the parallel vehicles have the similar Euclidean distance so that these phones may be incorrectly classified into one group.

(3) Selection of clustering algorithm and optimal number of clusters

For the same clustering object, different clustering algorithm may lead to different clustering results, which affects estimation results of vehicle counts. How to determine the optimal number of clusters has always been the bottleneck of clustering analysis. In this paper, we chose CH validity function to determine the optimal number of clusters. But its performance in congested flow condition is inferior to that of in free flow condition.


                        Table 3
                         gives mean relative error and the percent of relative error within 5% for estimated average travel speed in different traffic demands and phone location errors. Table 3 indicates that the mean relative errors of average travel speed are relevant to phone location errors and the estimation errors of vehicle counts. In general, large phone location errors translate into large relative errors of average travel speed. The phone location errors have a less significant effect on the accuracy of average travel speed than on the accuracy of vehicle counts. Although the different traffic demands make no significant difference on the accuracy of average travel speed, the accuracy tends to improve with traffic demand increases.


                        Fig. 7
                         gives a comparison of the accuracy of speed estimates with the simple analysis option that considers every phone as a separate sensor (called no clustering method). No clustering method calculates mean travel speed by averaging speed of all phones located on the observed segment. Overall, the proposed method (called clustering method) has higher accuracy of average speed estimation than no clustering method. This is due to the fact that the positive and negative errors can be partly cancelled out by averaging with (7) and (8).

We use mean absolute error instead of mean relative error to evaluate the accuracy for each vehicle type because sometimes there is no truck or bus traveling on the observed segment during an aggregation period. Mean absolute error of vehicle type identification in different traffic demands and phone location errors are shown in Table 4
                        . A decrease of phone location errors causes the improvement of identification accuracy for vehicle types. If phone location errors are within 100meter, the mean identification accuracy (the estimation results are consistent with the actual values) for cars, trucks and buses are 52.93%, 55.95% and 82.22% respectively. When phone location errors are within 30meter, the mean identification accuracy for cars, trucks and buses increase to 74.44%, 76.19% and 99.04%. Among the three vehicle types, buses identification accuracy is highest because buses are identified according to phone counts in the same vehicle. However, phones distributed in different vehicles are probably classified into one group and further wrongly identified as buses in the case of congested condition. Cars and heavy trucks are distinguished according to their speed and corresponding phone counts. If the number of phones in an individual vehicle is larger than two, cars and heavy trucks can be effectively divided in the case of free flow. If there are one or two phones in an individual vehicle, we adopt average speed and maximum speed of a vehicle to identify cars and heavy trucks. Under the circumstances of free flow, the speed of cars and heavy trucks is different, so it is effective to distinguish them with average speed. As traffic demand increases, the speed of cars becomes close to that of heavy trucks. Under this circumstance, it is difficult to identify the two types even if we use maximum speed.


                        Table 5
                         summarizes the accuracy of density estimation in different traffic demands and phone location errors. Traffic density is estimated according to vehicle counts and vehicle types, so its estimation accuracy is affected by the accuracy of vehicle counts and vehicle type identification. Phone location errors directly affect the estimation accuracy of vehicle counts, which further affect the identification accuracy of vehicle types. As shown in Table 5, a decrease of phone location errors tends to result in more accurate estimation for traffic density. The different traffic demands suggest no significant tendency on the accuracy of density estimation.

The above analysis shows that the estimation accuracy of traffic measures has relation with mobile phone location accuracy, traffic demand as well as selection of clustering algorithm and optimal number of clusters. Among the above factors, mobile phone location accuracy is the most sensitive factor toward the estimation accuracy of traffic measures. If the phone location errors can be reduced within 50meter and the location signal can be consistently received, mobile-phone-based traffic information system is capable of acceptable accuracy for traffic measures estimation.

@&#CONCLUSIONS@&#

Considering the fact that a moving vehicle has multi-phones, this paper proposed an approach for traffic measures estimation based on mobile phone location information. An improved graph clustering method was used to identify individual vehicle and to estimate vehicle counts on the observed segment. Methods to estimate traffic measures including average travel speed, vehicle types and traffic density were introduced. Simulation experiment was developed to compare traffic measures from mobile phone and from simulation software VISSIM. Simulation results suggest that the estimation accuracy of traffic measures mainly depends on the location accuracy of mobile phone. Traffic demand and clustering method also affect the estimation accuracy of traffic measures to a certain extent. Contrast to no clustering method, clustering method gave more consistent estimation for average travel speed with actual values despite phone location errors reaching 100meter and heavy traffic condition. Further development of location technologies will improve the estimation accuracy of traffic measures to meet requirement of traffic management.

Mobile-phone-based traffic information system shows promise but needs further study such as location technologies and map matching challenges to make it reliable and practical for managing freeway network and providing navigation services for road users.

@&#ACKNOWLEDGMENT@&#

This work is supported by Research Project of “Shandong Soft Science”, No. 2010RKGB3040.

@&#REFERENCES@&#

