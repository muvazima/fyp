@&#MAIN-TITLE@&#Adaptive fractional differential approach and its application to medical image enhancement

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We use the improved Otsu algorithm to segment medical images.


                        
                        
                           
                           The function of order v is constructed based on the features of image areas.


                        
                        
                           
                           The fractional differential order of each pixel is obtained by the function.


                        
                        
                           
                           Each pixel of medical image is processed by adaptive fractional differential mask.


                        
                        
                           
                           The edge of medical image is enhanced while the weak texture is preserved.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Fractional differential

Adaptive

Medical image enhancement

Gradient

Otsu

Order

@&#ABSTRACT@&#


               
               
                  This paper presents a new medical image enhancement method that adjusts the fractional order according to the dynamic gradient feature of the entire image. The presented method can extract the edges of an image accurately and enhance them while preserving smooth areas and weak textures; these improvements can be particularly helpful to doctors’ diagnoses. The primary contribution of this paper is the Adaptive Fractional Differential Algorithm (AFDA), which uses the improved Otsu algorithm to segment the edges, textures and smooth areas of images. This algorithm allows the optimal fractional order of each pixel to be obtained using an adaptive fractional differential function constructed based on the area feature of image. As a result, the image can be enhanced adaptively. Experimental results show that for medical images, AFDA shows better image enhancement than other methods by making edges clearer and textures richer.
               
            

@&#INTRODUCTION@&#

Medical image quality has become an indispensable part of modern medicine and directly influences the accuracy of doctors’ diagnoses and treatments. Low resolution and contrast in medical images have made correct diagnosis difficult; this directly influences the speed and accuracy of doctors’ diagnoses. Therefore, it is necessary to improve medical image enhancement to reflect the information of an illness more clearly and accurately [1–3].

Fractional differentials, which is a theory of arbitrary order, are similar to integral differentials [4,5]. Compared with traditional integral differential approaches, fractional differentials applied to image processing can enhance edges, make texture details clearer, and preserve smooth areas [6–8]. Therefore, medical images processed by fractional differentials are clearer and have higher contrast. Traditional fractional differentials use the same fractional order to process edges, textures and smooth areas of image; however, while edges would be enhanced by high fractional orders, weak textures and smooth areas would be ignored, and while weaker textures and smoother areas would be preserved by low fractional orders, edges would be weakened. Thus, image enhancement is difficult to attain in practice. To manage these issues, traditional and improved fractional differential algorithms have been developed for digital image processing in [9–12]. Adaptive fractional derivatives for image denoising problems have also been considered [13–15]. In particular, Ref. [6] proposed six fractional differential masks and the operator YiFeiPu-2, which has the best performance in precision and convergence because the fractional orders in the differential operators mentioned above are constant values and determined by a human; thus, image enhancement cannot be optimized if area features of the image are modified.

To enhance medical images effectively, this paper presents a new AFDA method based on an improved Otsu algorithm [16]. First, the improved Otsu algorithm is used to segment edges, textures and smooth areas accurately. Second, the optimal fractional order of each pixel is obtained by an adaptive fractional differential function constructed based on the features of different image areas. Finally, an optimal fractional order is substituted into the fractional differential mask to process the corresponding pixel of the image. In the experimental comparison and analysis below, five typical medical images are processed by AFDA as examples, and evaluation parameters of image texture such as entropy, contrast, average gray, average gradient and the proportion of edges are used for quantitative analysis and experimental verification. The experimental results show that the proposed method produces better image enhancements than traditional methods by extracting and enhancing the edges of an image more accurately while preserving more smooth areas and weak textures.

The remainder of this paper is organized as follows. Section 2 describes the related fractional differential theories and the realization of fractional differential masks. Section 3 presents the adaptive fractional differential function of the proposed approach in detail. Section 4 discusses the experiments and comparisons. Lastly, Section 5 presents the conclusions.

Until now, no unified formula has been developed to define fractional calculus. Mathematicians have analyzed the problem from different points of view and obtained different definitions of fractional calculus. Currently, there are three classical definitions of fractional calculus: the Grünwald–Letnikov (G–L) definition, the Riemann–Liouville (R–L) definition and the Capotu definition [17–19]. Because the G–L definition is less complex than the others and only uses one coefficient, the G–L definition is suitable for signal processing.

The first, second and third order derivatives of function f(t) are obtained by L’Hospital’s rule:
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            lim
                                                         
                                                         
                                                            h
                                                            →
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                         (
                                                         t
                                                         +
                                                         h
                                                         )
                                                         -
                                                         f
                                                         (
                                                         t
                                                         )
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   
                                                      
                                                         [
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         (
                                                         t
                                                         )
                                                         ]
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            lim
                                                         
                                                         
                                                            h
                                                            →
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                         (
                                                         t
                                                         +
                                                         2
                                                         h
                                                         )
                                                         -
                                                         2
                                                         f
                                                         (
                                                         t
                                                         +
                                                         h
                                                         )
                                                         +
                                                         f
                                                         (
                                                         t
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ‴
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   
                                                      
                                                         [
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               ″
                                                            
                                                         
                                                         (
                                                         t
                                                         )
                                                         ]
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            lim
                                                         
                                                         
                                                            h
                                                            →
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         f
                                                         (
                                                         t
                                                         +
                                                         3
                                                         h
                                                         )
                                                         -
                                                         3
                                                         f
                                                         (
                                                         t
                                                         +
                                                         2
                                                         h
                                                         )
                                                         +
                                                         3
                                                         f
                                                         (
                                                         t
                                                         +
                                                         h
                                                         )
                                                         -
                                                         f
                                                         (
                                                         t
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The n-order derivative 
                           
                              (
                              n
                              
                              ∈
                              
                              N
                              )
                           
                         of function f(t) is obtained by mathematical induction:
                           
                              (2)
                              
                                 
                                    
                                       f
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          lim
                                       
                                       
                                          h
                                          →
                                          0
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       -
                                       n
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       (
                                       -
                                       1
                                       )
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 f
                                 (
                                 t
                                 -
                                 jh
                                 )
                              
                           
                        
                     

The fractional order from integer to fraction is generated by the gamma function. Considering function f(t) has (n
                        +1)-order derivatives on the interval [a,
                        b], the v-order fractional differential of function f(t) is defined as:
                           
                              (3)
                              
                                 
                                    
                                    
                                       a
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       b
                                    
                                    
                                       v
                                    
                                 
                                 f
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          lim
                                       
                                       
                                          h
                                          →
                                          0
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       -
                                       v
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          [
                                          (
                                          b
                                          -
                                          a
                                          )
                                          /
                                          h
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       (
                                       -
                                       1
                                       )
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                
                                                   j
                                                
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                                 f
                                 (
                                 t
                                 -
                                 jh
                                 )
                                 ,
                              
                           
                        where the integer part of (b
                        –
                        a)/h is [(b
                        –
                        a)/h] and 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             
                                                j
                                             
                                          
                                          
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    v
                                    !
                                 
                                 
                                    j
                                    !
                                    (
                                    v
                                    -
                                    j
                                    )
                                    !
                                 
                              
                           
                         is binomial coefficient.

Fractional differentials have been used to solve problems in signal processing [20–23]. For any square integrable signal 
                           
                              s
                              (
                              t
                              )
                              
                              ∈
                              
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              R
                              )
                           
                        , its v-order fractional differential is:
                           
                              (4)
                              
                                 
                                    
                                       D
                                    
                                    
                                       v
                                    
                                 
                                 s
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             v
                                          
                                       
                                       s
                                       (
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             dt
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

According to the basic theory of signal processing, its Fourier transform is:
                           
                              (5)
                              
                                 
                                    
                                       D
                                    
                                    
                                       v
                                    
                                 
                                 s
                                 (
                                 t
                                 )
                                 
                                    
                                       ⇔
                                    
                                    
                                       FT
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             v
                                          
                                       
                                       s
                                       )
                                    
                                    
                                       ∧
                                    
                                 
                                 (
                                 w
                                 )
                                 =
                                 
                                    
                                       (
                                       iw
                                       )
                                    
                                    
                                       v
                                    
                                 
                                 
                                    
                                       s
                                       (
                                       w
                                       )
                                    
                                    
                                       ∧
                                    
                                 
                                 =
                                 |
                                 w
                                 
                                    
                                       |
                                    
                                    
                                       v
                                    
                                 
                                 exp
                                 [
                                 i
                                 
                                    
                                       θ
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 w
                                 )
                                 ]
                                 
                                 
                                    
                                       s
                                       (
                                       w
                                       )
                                    
                                    
                                       ∧
                                    
                                 
                                 =
                                 |
                                 w
                                 
                                    
                                       |
                                    
                                    
                                       v
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                v
                                                π
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          sgn
                                          (
                                          w
                                          )
                                       
                                    
                                 
                                 
                                 
                                    
                                       s
                                       (
                                       w
                                       )
                                    
                                    
                                       ∧
                                    
                                 
                                 
                                 (
                                 v
                                 
                                 ∈
                                 
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 ,
                              
                           
                        where Dv
                         is the v-order differential multipliable operator, and (iw)
                           v
                        
                        =|w|
                           v
                        
                        exp[iθv
                        (w)] is the filter function of fractional differential filter.

According to the above equations, we can draw the amplitude-frequency curve shown in Fig. 1
                        . We find that a fractional differential operator can increase the high frequency components of a signal. However, a larger frequency and fractional differential order yield more significant enhancement. Fractional differentials can preserve low frequency components of signal. In an image, the variation of gradient magnitude near an edge is relatively high, corresponding to the high frequency components of the signal. The variation of gradient magnitude in weak texture regions is relatively low, corresponding to the intermediate frequency components of the signal. The variation of gradient magnitude in smooth areas is nearly zero, corresponding to the low frequency components of signal.

From the first-order differential and second-order differential in Fig. 1, we can infer that if operators such as Sobel and Gauss–Laplace are applied in image processing, edges in the image will be enhanced, while weak textures and smooth areas will be weakened. However, AFDA can enhance edges in an image and preserve more texture and smooth area data, making the image clearer. Therefore, the enhancement produced by fractional differentials is significantly better than that of integral differentials.

Based on the G–L definition [24,25] and Ref. [6], we set the duration of the signal f(t) to be 
                           
                              t
                              
                              ∈
                              
                              [
                              a
                              ,
                              
                              b
                              ]
                           
                        . The duration of signal is divided by equal intervals h
                        =1; thus, n
                        =[(b
                        –
                        a)/h]=[b
                        –
                        a]. The v-order fractional differential of f(t) is:
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             v
                                          
                                       
                                       f
                                       (
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             dt
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                                 ≈
                                 f
                                 (
                                 t
                                 )
                                 +
                                 (
                                 -
                                 v
                                 )
                                 f
                                 (
                                 t
                                 -
                                 1
                                 )
                                 +
                                 
                                    
                                       (
                                       -
                                       v
                                       )
                                       (
                                       -
                                       v
                                       +
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 f
                                 (
                                 t
                                 -
                                 2
                                 )
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       Γ
                                       (
                                       -
                                       v
                                       +
                                       1
                                       )
                                    
                                    
                                       n
                                       !
                                       Γ
                                       (
                                       -
                                       v
                                       -
                                       n
                                       +
                                       1
                                       )
                                    
                                 
                                 f
                                 (
                                 t
                                 -
                                 n
                                 )
                              
                           
                        
                     

The backward difference of fractional partial differentials on the negative x- and y-coordinate are respectively expressed as:
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             v
                                          
                                       
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       dx
                                    
                                 
                                 ≈
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 (
                                 -
                                 v
                                 )
                                 f
                                 (
                                 x
                                 -
                                 1
                                 ,
                                 y
                                 )
                                 +
                                 
                                    
                                       (
                                       -
                                       v
                                       )
                                       (
                                       -
                                       v
                                       +
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 f
                                 (
                                 x
                                 -
                                 2
                                 ,
                                 y
                                 )
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       Γ
                                       (
                                       -
                                       v
                                       +
                                       1
                                       )
                                    
                                    
                                       n
                                       !
                                       Γ
                                       (
                                       -
                                       v
                                       -
                                       n
                                       +
                                       1
                                       )
                                    
                                 
                                 f
                                 (
                                 x
                                 -
                                 n
                                 ,
                                 y
                                 )
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             v
                                          
                                       
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       dy
                                    
                                 
                                 ≈
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 (
                                 -
                                 v
                                 )
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 -
                                 1
                                 )
                                 +
                                 
                                    
                                       (
                                       -
                                       v
                                       )
                                       (
                                       -
                                       v
                                       +
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 -
                                 2
                                 )
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       Γ
                                       (
                                       -
                                       v
                                       +
                                       1
                                       )
                                    
                                    
                                       n
                                       !
                                       Γ
                                       (
                                       -
                                       v
                                       -
                                       n
                                       +
                                       1
                                       )
                                    
                                 
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 -
                                 n
                                 )
                              
                           
                        
                     

According to Eqs. (7) and (8), the first three coefficients are 1, −v, and (−v)(−v
                        +1)/2, and the 3×3 masks are shown in Fig. 2
                        .

Additionally, we can obtain eight masks in each direction (e.g., 0°, 45°, 90°, 135°, 180°, 225°, 270°, and 315°) and add them to obtain the 5×5 mask shown in Fig. 3
                        .

Finally, we can obtain the 5×5 fractional differential mask by dividing every element by 8−12v
                        +4v
                        2, and the image can be processed by v-order fractional differentials by considering airspace filtering of this mask convolution.

The best effect of image enhancement is to make edges clearer and preserve weak textures and smooth areas in an image. According to the characteristics of fractional differentials, we construct the corresponding adaptive fractional differential function, which has a high order in edge pixels and a relatively small order in the weak texture pixels. The piecewise function of v-order fractional differential is given as:
                           
                              (9)
                              
                                 v
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         M
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                         -
                                                         t
                                                      
                                                      
                                                         M
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   M
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ⩾
                                                   t
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         M
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                         -
                                                         t
                                                      
                                                      
                                                         M
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   M
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ⩾
                                                   t
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         M
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                         -
                                                         t
                                                      
                                                      
                                                         M
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   2
                                                   <
                                                   M
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   <
                                                   t
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         M
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         M
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   2
                                                   <
                                                   M
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   <
                                                   t
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         M
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   0
                                                   ⩽
                                                   M
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ⩽
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the parameter t is the optimal gradient threshold of an image edge, v
                        1 is the threshold of adaptive fractional differential order of image edge, and v
                        2 is the threshold of adaptive fractional differential order of weak texture. Parameters v
                        1 and v
                        2 are defined as:
                           
                              (10)
                              
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ed
                                          
                                       
                                       -
                                       Q
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ed
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       Q
                                       -
                                       
                                          
                                             M
                                          
                                          
                                             tex
                                          
                                       
                                    
                                    
                                       Q
                                    
                                 
                                 ,
                              
                           
                        where the parameter Q is the average gradient of the original image, and Med
                         and Mtex
                         are the average gradients of edge pixels and texture pixels segmented by Otsu algorithm, respectively. If the edge of an image is stronger, Med
                         is larger, and v
                        1 becomes larger, resulting in a strongly enhanced edge. If the texture of an image is richer, Mtex
                         is larger, and v
                        2 becomes smaller, resulting in more texture being preserved. For a digital image f(i,
                        j) with a size of A
                        ×
                        B, and M(i,
                        j) is the average gradient of each pixel in eight directions:
                           
                              
                                 M
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    
                                       |
                                       8
                                       f
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       -
                                       f
                                       (
                                       i
                                       -
                                       1
                                       ,
                                       j
                                       -
                                       1
                                       )
                                       -
                                       f
                                       (
                                       i
                                       -
                                       1
                                       ,
                                       j
                                       )
                                       -
                                       f
                                       (
                                       i
                                       -
                                       1
                                       ,
                                       j
                                       +
                                       1
                                       )
                                       -
                                       f
                                       (
                                       i
                                       ,
                                       j
                                       -
                                       1
                                       )
                                       -
                                       f
                                       (
                                       i
                                       ,
                                       j
                                       +
                                       1
                                       )
                                       -
                                       f
                                       (
                                       i
                                       +
                                       1
                                       ,
                                       j
                                       -
                                       1
                                       )
                                       -
                                       f
                                       (
                                       i
                                       +
                                       1
                                       ,
                                       j
                                       )
                                       -
                                       f
                                       (
                                       i
                                       +
                                       1
                                       ,
                                       j
                                       +
                                       1
                                       )
                                       |
                                    
                                    
                                       8
                                    
                                 
                                 .
                              
                           
                        
                     

When M(i,
                        j) is larger than the optimal threshold t, these pixels can be regarded as strong edges in the image, and relatively high fractional order is used to enhance these pixels. If the gradient M(i,
                        j) varies randomly between the duration [0,255], we further divide these pixels based on the ratio of gradient and the threshold selected. When 
                           
                              M
                              (
                              i
                              ,
                              j
                              )
                              ⩾
                              t
                           
                         and 
                           
                              (
                              M
                              (
                              i
                              ,
                              j
                              )
                              -
                              t
                              )
                              /
                              M
                              (
                              i
                              ,
                              j
                              )
                              ⩾
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           
                        , the gradient M(i,
                        j) is much larger than the optimal threshold t, and the pixels are at relatively strong edge. We set v
                        =(M(i,
                        j)–
                        t)/M(i,
                        j); a larger gradient M(i,
                        j) yields a larger v and thus better edge enhancement. When 
                           
                              M
                              (
                              i
                              ,
                              j
                              )
                              ⩾
                              t
                           
                         and (M(i,
                        j)–
                        t)/M(i,
                        j)<
                        v
                        1, the gradient M(i,
                        j) and the optimal threshold t are relatively close, and the pixels are at relatively weak edge; thus, v
                        =
                        v
                        1 to enhance the weak edge of the image.

When 2<
                        M(i,
                        j)<
                        t and 
                           
                              M
                              (
                              i
                              ,
                              j
                              )
                              /
                              t
                              ⩾
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           
                        , the gradient M(i,
                        j) and the optimal threshold t are relatively close, and the pixels are in a region of relatively strong texture; thus, v
                        =
                        v
                        2 to enhance texture. When 2<
                        M(i,
                        j)<
                        t and M(i,
                        j)/t
                        <
                        v
                        2, the gradient M(i,
                        j) is much smaller than the optimal threshold t, and the pixels are in a region of relatively weak texture. We set v
                        =
                        M(i,
                        j)/t; a smaller gradient M(i,
                        j) yields a smaller v and thus more weak textures can be preserved.

When M(i,
                        j) is larger than 0 and smaller than 2, the pixels are in a smooth area of the image. We set v
                        =0 to keep the gray of these pixels unchanged.

The Otsu algorithm was proposed by Otsu in 1979; it is a type of threshold segmentation method based on the maximum between-cluster variance. To obtain an improved image enhancement effect for AFDA, we improve the traditional Otsu algorithm by replacing the gray of each pixel f(i,
                        j) with the average gradient M(i,
                        j); this improved Otsu algorithm can segment edges, textures and smooth areas of an image more effectively. Because the integer portion of M(i,
                        j) belongs to {0, 1, 2, ⋯, k, ⋯, N(i,
                        j)}, for a digital image with a size of A
                        ×
                        B, p(k) is used to indicate the frequency of gradient k:
                           
                              (11)
                              
                                 p
                                 (
                                 k
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       A
                                       ×
                                       B
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          N
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          =
                                          k
                                       
                                    
                                 
                                 1
                                 .
                              
                           
                        
                     

The threshold t divides the image gradient into two part: C
                        1
                        ={1, 2, ⋯, t} and C
                        2
                        ={t
                        +1, t
                        +2, ⋯, max (N(i,
                        j))}, then, the ratios of C
                        1 and C
                        2 are:
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            1
                                                            ⩽
                                                            i
                                                            ⩽
                                                            t
                                                         
                                                      
                                                   
                                                   p
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                            ⩽
                                                            i
                                                            ⩽
                                                            max
                                                            (
                                                            N
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            )
                                                         
                                                      
                                                   
                                                   p
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The means of C
                        1 and C
                        2 are:
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            1
                                                            ⩽
                                                            i
                                                            ⩽
                                                            t
                                                         
                                                      
                                                   
                                                   ip
                                                   (
                                                   i
                                                   )
                                                   /
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                            ⩽
                                                            i
                                                            ⩽
                                                            max
                                                            (
                                                            N
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            )
                                                         
                                                      
                                                   
                                                   ip
                                                   (
                                                   i
                                                   )
                                                   /
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Thus, the total mean of a one-dimensional histogram is given as:
                           
                              (14)
                              
                                 μ
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                              
                           
                        
                     

The between-cluster variance of image edge and background is:
                           
                              (15)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             μ
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       -
                                       μ
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                       -
                                       μ
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 t
                                 
                                 ∈
                                 
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 ·
                                 ·
                                 ·
                                 ,
                                 
                                    max
                                 
                                 (
                                 N
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 )
                                 }
                              
                           
                        
                     

The gradient threshold t divides the gradient image into an edge and a background. When the variance σ
                        2 is large, the difference between the image edge and background is more significant. If part of the image edge is wrongly identified as background or part of the image background is wrongly identified as an edge, the difference between the two parts will decrease significantly. Thus, when the variance σ
                        2 reaches its maximum value, the corresponding t is the optimal gradient threshold.

Because the adaptive fractional differential function is critical to the proposed algorithm, we now discuss its characteristics to describe its enhancement mechanisms.

Five typical types of medical images have been chosen as examples (image of Ultrasonography, X-ray, CT, MRI and target of Molybdenum); their resolutions are all 256×256. The gradient threshold t of these five original medical images can be obtained using the improved Otsu algorithm. The parameters v
                        1 and v
                        2 of five images, which are shown in Table 1
                        , can be obtained by Eq. (10).

As shown in Fig. 5, the fractional differential order v varies with the gradient of pixel M(i,
                        j). When M(i,
                        j) is larger than threshold t, these pixels can be regarded as a strong edge in the image; the corresponding orders of the pixels are not less than v
                        1, and the parameter v
                        1 is used to enhance these pixels. When M(i,
                        j) is smaller than threshold t, these pixels can be regarded as weak textures in the image; the corresponding orders of these pixels are not larger than v
                        2, and the parameter v
                        2 is used to preserve these pixels. Thus, the AFDA can achieve improved medical image enhancement while preserving weak textures.

As introduced in Section 3.3, five typical types of medical images shown in Fig. 4
                     
                      were chosen as examples. The effect of image enhancement of AFDA is compared with that of the Histogram, Sobel, Laplacian and Traditional fractional differential methods, which are 0.5-order, 0.8-order and 1-order, respectively. The effect of image enhancement is evaluated by visual analysis, segment results and some metrics.

The experimental results are shown as Figs. 6–12
                     
                     
                     
                     
                     
                     
                      and Tables 2–6
                     
                     
                     
                     
                     .

The effect of image enhancement will be evaluated by visual comparison.

From Figs. 6–10, it is shown that the 0.5-order, 0.8-order and adaptive-order methods have enhanced the original image to some extent. Although the 0.8-order method strongly enhances edges, it also produces significantly more noise. The adaptive-order method can enhance image edges and preserve weak textures and smooth areas concurrently and produces better image enhancement than the 0.5-oreder method, as shown. From Figs. 6–10(f), we find that the AFDA method produces better image enhancement than traditional methods with higher adaptability.


                        Fig. 6 shows the enhancement effect of ultrasonography images using five different methods. Due to the characteristics of ultrasonography, the original image has a low resolution and significant amounts of noise. Although the histogram equalization method improves the brightness of the object, the grays of the processed image are reduced, and local texture details disappear. Although the 1-order method draws edges well, it strongly suppresses weak textures and smooth areas in the image. Thus, the enhancement effects of these two methods are not satisfactory.


                        Fig. 7 shows the enhancement of a chest X-ray. The histogram equalization method shows relatively good enhancement; however, the grays change unnaturally and not significantly. The 1-order method extracts less marginal information.


                        Fig. 8 shows a lung sectional CT image, whose grays change significantly. The 1-order method extracts a large amount of marginal information, but weak textures and smooth areas are severely reduced, making it difficult to see the complete structure of image.


                        Figs. 9 and 10 show a knee-joint MRI and a target of breast molybdenum images, respectively. It is shown that the edge of the original images are clear, and the texture is rich. Similarly, the histogram equalization algorithm shows certain enhancements, but the gray of the transitional area is unnatural, and the texture details of the image are incomplete; thus, the histogram method’s enhancement is not satisfactory.

From Figs. 6–10(f), the AFDA method is shown to enhance edges but also preserve weak textures and smooth areas by considering both global and local information in the image. Thus, the AFDA method shows the best image enhancement of the methods tested.

The validity of the enhancement can also be evaluated by the quality of object segmentation. Segmentation results using Sobel and Laplacian operators are used to evaluate enhancement quality. Using the X-ray and MRI images as examples, Figs. 7(a), (c), and (f), and 9(a), (c), and (f) are processed using Sobel and Laplacian operators, respectively. The experimental results are shown as follows.

Sobel and Laplacian operators are first-order and second-order linear differential operators, respectively, which can strongly enhance edges and strongly weaken weak textures and smooth areas of an image.

From Figs. 11 and 12, the effect of image segmentation using the fractional differential method is shown to be significantly better than that of the original image. Because the edges of Fig. 11(f) are the clearest among Figs. 11(d)–(f), and 12(c) has more edge pixels than Fig. 12(a)–(b), the AFDA method is shown to yield the best object segmentation quality among the methods tested.

The proportion of edge pixels, the average grays of texture, and the average gradients of edges and contrast are also calculated to analyze the effects of image enhancement using these methods. The definition of contrast is Co
                        =
                        Cprocessed
                        /Coriginal
                        , and we consider 3×3 pixels to be a unit of an image. The parameter C is the average contrast of all 3×3 units, Coriginal
                         and Cprocessed
                         are the contrast of the image before and after being processed, respectively. Information entropy is an important factor that evaluates the quality of the information in an image. The formula of entropy of information is given as:
                           
                              (16)
                              
                                 H
                                 =
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          0
                                       
                                       
                                          255
                                       
                                    
                                 
                                 p
                                 (
                                 k
                                 )
                                 ln
                                 p
                                 (
                                 k
                                 )
                                 ,
                              
                           
                        where p(k) is used to indicate the frequency of gray values k (i.e., 
                           
                              p
                              (
                              k
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    A
                                    ×
                                    B
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    f
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    k
                                 
                              
                              1
                           
                         for a digital image f(i,
                        j) whose resolution is A
                        ×
                        B). Accordingly, the evaluation parameters are given in Tables 2–6.

From these five tables, it is significant that the 0.8-order method segments too many edge pixels, including some image noise. Because the proportion of edge pixels of using the AFDA method is the nearest to that of the original image. Thus, the AFDA method segments the edge pixels the most accurately, and meanwhile the data of average gradient of the edge pixels shows that AFDA method also has a good effect of on medical image enhancement.

The entropies of images in the tables shows that images processed by AFDA have a similar information quality to that of the original images. The average texture grays show that the AFDA method preserves the weak textures of an image. However, the weak textures and smooth areas of an image are nearly eliminated in images processed by the 1-order method.

We can also see that although the 1-order method has a high contrast, its global information is not complete and lacks some textures and smooth areas that were present in the original image. Additionally, the images processed by the 0.8-order method are not clear. The contrasts of images processed by the AFDA method are better than those of other methods.

Consequently, the AFDA method has the best performance in enhancing the edges of medical images, preserving texture details, and improving the clarity and contrast of medical images. Thus, the proposed method can improve the visual quality of images while preserving more information in medical images, which can help doctors to diagnose illnesses more efficiently and accurately.

@&#CONCLUSIONS@&#

Fractional differentials applied to medical image processing are a new research topic. The methods of image enhancement can improve the quality of medical images and can thus be helpful to doctors’ diagnoses. The proposed AFDA method comprehensively considers global and local information in medical images and yields better enhancement effects than traditional image processing methods. The AFDA method uses the improved Otsu algorithm to segment every area of an image accurately and processes every pixel of an image based on the characteristics of local information specific to that pixel. The adaptive fractional differential function is critical to the effectiveness of the AFDA method and was constructed based on the characteristics of fractional differentials and the features of different image areas. A large number of simulation experiments have shown that AFDA achieves the best enhancement effect of medical images for medical diagnoses.

Medical images often have different disadvantages, such as low contrast and significant noise. Noise tends to significantly influence the effects of image enhancement. To manage this problem, an improved AFDA method will be considered in future work to enhance image edges and preserve weak textures while removing noise. In contrast to the fractional differentials used in this study, fractional integrals can attenuate high frequency components of a signal and enhance low frequency components; therefore, fractional integral can remove image noise while preserving texture information. In the future, we will extend the AFDA method using an adaptive fractional integral algorithm for image denoising while continuing to use the developed adaptive fractional differential algorithm to enhance and preserve image texture. As a result, both adaptive image denoising and enhancement could be achieved.

@&#ACKNOWLEDGEMENTS@&#

This work is supported in part by the National Natural Science Foundation of China (61174098), Guangdong Natural Science Foundation (S2013010012537) and Project on the Integration of Industry, Education and Research of Guangdong Province (2013B090600062).

@&#REFERENCES@&#

