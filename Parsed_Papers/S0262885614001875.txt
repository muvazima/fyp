@&#MAIN-TITLE@&#Robust regional bounding spherical descriptor for 3D face recognition and emotion analysis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A regional bounding spherical descriptor is used for 3D face and emotion analysis.


                        
                        
                           
                           Region segmentation is based on shape index and spherical band on 3D face.


                        
                        
                           
                           The regional descriptors are obtained by projecting regional bounding spheres.


                        
                        
                           
                           A regional and global regression is proposed for the weighted regional descriptor.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

3D face recognition

Emotion analysis

Regional bounding spherical descriptor

Regional and global regression

Kullback–Leiber divergence (KLD)

@&#ABSTRACT@&#


               
               
                  3D face recognition and emotion analysis play important roles in many fields of communication and edutainment. An effective facial descriptor, with higher discriminating capability for face recognition and higher descriptiveness for facial emotion analysis, is a challenging issue. However, in the practical applications, the descriptiveness and discrimination are independent and contradictory to each other. 3D facial data provide a promising way to balance these two aspects. In this paper, a robust regional bounding spherical descriptor (RBSR) is proposed to facilitate 3D face recognition and emotion analysis. In our framework, we first segment a group of regions on each 3D facial point cloud by shape index and spherical bands on the human face. Then the corresponding facial areas are projected to regional bounding spheres to obtain our regional descriptor. Finally, a regional and global regression mapping (RGRM) technique is employed to the weighted regional descriptor for boosting the classification accuracy. Three largest available databases, FRGC v2, CASIA and BU-3DFE, are contributed to the performance comparison and the experimental results show a consistently better performance for 3D face recognition and emotion analysis.
               
            

@&#INTRODUCTION@&#

Face recognition and emotion analysis are two important branches in biometric systems in remote communication, medical rescue, intelligent monitoring and so on. A large number of demands of face recognition and expression control are emerged due to the rapid development of 3D movies and entertainment [1–3]. More and more practice requirements are no longer satisfied by facial recognition or emotion analysis separately. The emerging industry needs to find an effective facial representation, which not only achieves a higher-quality discriminative power for the large size individuals but also provides a better expression description for control.

Our previous bounding sphere descriptor demonstrated superior performance in 3D face recognition, especially where there were large pose variations. For practical applications, the proposed feature descriptor should be able to simultaneously perform face recognition and expression analysis. Expression variations imply variations in specific facial regions. Therefore, in this paper, we extend the global bounding sphere descriptor to regional bounding sphere descriptors. Regional weighted selection is used to form a general feature descriptor, which can be used for face recognition and expression analysis simultaneously. The novel low-dimensional features of this approach facilitate both theoretical innovations and practical applications.

Sufficient broad investigations of 3D face processing have been achieved in the literature [4,5]. Although most of them independently analyze the issue of 3D face recognition and 3D facial expression classification, the literature illustrate that facial regional descriptor analysis can provide better accuracy for the two aspects simultaneously. For 3D face recognition, Faltemier et al. [6] divided a face into a group of regions and led to a better recognition performance. A region-based registration was employed to establish correspondence and 3D shape descriptor was used for statistical feature extraction [7]. Passalis et al. [8] used facial symmetry to overcome the challenges of large pose variations and the wavelet-based biometrics signature was used to evaluate the real-world applications. Local shape difference boosting [9] selected optimal local features for assembling three collective strong classifiers and found the most discriminative feature for 3D face recognition. Ioannis Marras [10] introduced novel subspace-based methods for learning the azimuth angle of subspace normal, which were well-suited for all types of 3D facial data for recognition. However, note that these algorithms focus on 3D face recognition. They cannot perform facial expression recognition.

Some scholars are concerned with the descriptions of the different facial expressions, without the discrimination of the different individuals. For example, the Facial Action Coding System (FACS) [11], as a human facial expression representation, has been found over 25years ago. Prominent regions can describe the variant facial characteristics on the different individuals [12]. However, practical application requirements, i.e. high recognition rate, low computational complexity, and easy implementation, are the issues of wide concern.

With the rapid development of science and technology, more and more systems need to distinguish the individual and his/her expression simultaneously, and then provide personalized services, as ours developed the system [2]. One barrier is how to precisely segment the facial regions on the different facial images, which is highly influenced on the accuracy of 3D face recognition and expression classification. In this paper, we first develop a facial segmentation mechanism, and then principally concentrate on how to find an effective facial descriptor with the capability of individuals' identification and expression description. The lower dimensional feature vectors can be used to compensate for computationally expensive.

Empirical study shows that facial shape has a significant variance in terms of different regions on the facial surface. In order to better reflect anatomical structure and describe the expression variations, we introduce the segmenting scheme to address the major challenges and present a new recognition framework for 3D processing. Our research consists of three important procedures: facial region segmentation, feature representation and feature extraction as shown in Fig. 1
                        .
                           
                              1.
                              Facial region segmentation: By combining the facial shape characteristics and shape index information, a committee of facial local regions can be coarsely located. Shape band [13] algorithm is introduced to detect the contours of facial regions and refine the localization to highlight the discriminative and descriptive regions.

Feature representation: Exploring our previous research [14], we further develop the robust regional bounding sphere descriptor (RBSR) on the facial surface, which are relatively consistent in the presence of expressions and poses. Combined with facial prior assumption, the region descriptors are weighted and projected into the spherical domain based on the contribution of the descriptiveness and discrimination.

Feature extraction: Facial poses, occlusions and corruptions, as the major challenging issues for facial recognition and expression classification, have varying degrees at different facial regions. Regional and global regression mapping (RGRM) is introduced to grasp the intrinsic manifold structure of our feature representation for weighted RBSR descriptors, which better reflect the geometrical properties of the different facial regions with low redundancy.

In our framework, a novel mechanism is proposed to overcome the unsolved challenging issues encountered for facial processing, called Regional Bounding Sphere Representation (RBSR). The main contributions of our scheme can be summarized in the following items:
                           
                              1.
                              Robustness: Facial segmentation scheme based on shape index and region selection can robustly extract facial shape regions. The regional bounding sphere representation can effectively reduce the impact of non-discriminant areas and provide a promising way to describe facial regional properties. RGRM algorithm can extract the low-dimensional information from RBSR descriptor, which contains the most discriminative face and descriptive expressions.

Efficiency: 3D data provides reliable data to support synergetic analysis for face recognition and expression classification. Large-capacity data analysis demands for high-performance and multi-task concurrency. The proposed framework can find a fast and general descriptor to learn different visual tasks simultaneously and compresses redundant data. Efficiency of our proposed framework is more suited to practical applications.

Synergy: The current mainstream of visual study focuses on the single visual task. Research is generally conducted on specific tasks, for a specific application, using a specific method to solve certain vision related problems. We propose a generic descriptor for facial information. By means of effective feature learning, the results of face recognition and expression classification can be output simultaneously. The proposed framework lays the foundation for synergetic analysis for multi-visual tasks and face real-time intelligent interactive systems.

The rest of this paper is organized as follows. Facial regional segmentation is described in Section 2. Section 3 presents the regional bounding sphere representation. In Section 4, regional and global regression mapping is used with RBSR for low dimensional feature extraction. The detailed experimental comparison with 3D face recognition and expression classification is analyzed in Section 5. Finally, we conclude the paper in Section 6.

The original 3D facial images in the databases usually contain some non-facial areas, spikes and holes as shown in Fig. 2(a) 
                        [15]. Exploiting our previous research [14], facial profile can be extracted by the robust ASM algorithm [12] on the 2D texture image. The main facial area can be coarsely extracted by the “and” logic processing between the 2D profile and its corresponding 3D valid matrix in Fig. 2(b).

In order to further refine the facial area, the position of the nose tip needs to be detected. The frontal face model is chosen as the reference model Fr
                        . Then, the mirror face F
                        
                           r
                        ′ is obtained by the coordinate plane Σ
                           xz
                        . The TPS-RPM algorithm [16] is used to register F
                        
                           r
                        
                        ' to Fr
                         and generates the registered image F
                        
                           r
                        
                        ″. The facial symmetry plane Σ
                           r
                         is fitted using the point set:
                           
                              (1)
                              
                                 
                                    p
                                    
                                       i
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       
                                          p
                                          i
                                       
                                       +
                                       
                                          p
                                          i
                                          ″
                                       
                                    
                                 
                                 /
                                 2
                                 ,
                                 1
                                 ≤
                                 i
                                 ≤
                                 N
                                 ,
                              
                           
                        where pi
                        
                        =(xi
                        , yi
                        , zi
                        )
                           T
                         is the point cloud of 3D reference face model and p
                        
                           i
                        
                        ″
                        =(x
                        
                           i
                        
                        ″,
                        y
                        
                           i
                        
                        ″,
                        z
                        
                           i
                        
                        ″)
                           T
                         is the point cloud of 3D registered face model. The cross curve of Fr
                         and Σ
                           r
                         with 1mm bandwidth is treated as the objective surface OSr
                         and the highest point on OSr
                         is determined as nose tip Nr
                         in Fig. 2(d). When there are nose occlusions, according to the proportion of prior knowledge of facial organs, we select the cross point on the fitted surface OSr
                         between two-thirds on the vertical direction and one-half on the horizontal direction, as the nose tip as illustrated in Fig. 3
                        . Nose tip refined detection under occlusion is the next stage of our research focus.

The following procedure is used to normalize the size of the various 3D input images. Firstly, we estimate the horizontal and vertical projection curves for the extracted facial area by calculating row and column sums of the valid point matrix. Next, we select the maximum value of the horizontal and vertical projection curves as the location of the maximum horizontal and vertical distance respectively on the facial area. The ratios of the longest horizontal and longest vertical facial locations in the input and reference images are then used to normalize the width and length of the 3D input images as follows:
                           
                              (2)
                              
                                 ratioX
                                 =
                                 distX
                                 /
                                 distXone
                                 ,
                                 ratioY
                                 =
                                 distY
                                 /
                                 distYone
                                 ,
                              
                           
                        where distX,
                        distY are respectively the values of horizontal and vertical lengths on the input 3D face image. distXone,
                        distYone are the values of horizontal and vertical lengths on the reference face model. Finally, the normalization is calculated using the ratio calculated above.

Then, the distance of two eyes' centers can be computed by locating the eyes' centers on 2D image by ASM [17] and project them to the corresponding 3D images. The ratio of eye center's distances between the input and reference models is introduced to refine the normalization results in Fig. 2(e). Empirical study shows that the results with facial normalization can significantly boost the accuracy for face recognition and expression classification.

Axis-angle representation can align the input with the reference model in Fig. 2(f) as follows:
                           
                              (3)
                              
                                 
                                    p
                                    ireg
                                 
                                 =
                                 
                                    p
                                    i
                                 
                                 cos
                                 θ
                                 +
                                 
                                    
                                       r
                                       ×
                                       
                                          p
                                          i
                                       
                                    
                                 
                                 sin
                                 θ
                                 +
                                 r
                                 
                                    
                                       r
                                       ⋅
                                       
                                          p
                                          i
                                       
                                    
                                 
                                 
                                    
                                       1
                                       −
                                       cos
                                       θ
                                    
                                 
                                 ,
                              
                           
                        where pi
                         is the input points of the 3D images and pireg
                         is the registered face points. The rotation axis r can be obtained via the cross product of the unit normal nr
                         and n of the reference and input images. The angle θ between the nr
                         and n describes the rotation magnitude. Unlike ICP, we just match the point clouds between input and reference models. As a result, our method can save a huge number of computational costs.

A 3D facial image contains more facial discriminative and expression descriptive information than a 2D image and the degree is different from the different facial regions and curvature. The derived shape index serves as an important descriptor of intrinsic surface properties and is used for segmenting the different facial regions.

We can segment that the points like cone shape as the upper nose. To find the inner eye pit locations, shape band [13] of eyes area extracted from the reference model is used as the search window on an input face and Gaussian curvature values, which is close to zero, is used to determine the local minimum inside the search window as the positions of eye pits. Then, we introduce the shape index values for searching nose borders as saddle rut-like shapes [18]. The nose border outline extracted by the shape band of the reference model is developed for searching the rightmost and leftmost points along the band, which can be treated as the left and right nose borders [7]. The shape band search window, based on the sign and values of curvature, is used to coarsely segment the mouth area. Considering facial prior information, the region, above the eyes, can be treated as forehead and the areas, between left/right eyes and mouth, can be determined as left/right cheek as shown in the bottom part of Fig. 2.

In order to balance the facial discriminative power and expression descriptiveness, extended with our previous research [14], a novel descriptor is proposed, denoted as regional bounding sphere representation (RBSR). For each region of a 3D facial image, the descriptor is formed from the projection of the facial point cloud into regional bounding spheres which are centered at the center points of the regions as shown in Fig. 4
                        . The distance between points in the region and the corresponding center point divided by the radius of regional bounding sphere produces the values of the spherical points. The value of points on the regional bounding sphere can be defined as follows:
                           
                              (4)
                              
                                 RBSR
                                 
                                    
                                       c
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   
                                                      i
                                                      x
                                                   
                                                
                                                −
                                                
                                                   c
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                          2
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   p
                                                   
                                                      i
                                                      y
                                                   
                                                
                                                −
                                                
                                                   c
                                                   
                                                      y
                                                      j
                                                   
                                                
                                             
                                          
                                          2
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   p
                                                   
                                                      i
                                                      z
                                                   
                                                
                                                −
                                                
                                                   c
                                                   
                                                      z
                                                      j
                                                   
                                                
                                             
                                          
                                          2
                                       
                                    
                                 
                                 /
                                 
                                    R
                                    
                                       b
                                       s
                                       j
                                    
                                 
                                 ,
                              
                           
                        where pi
                         is the coordinate value of each aligned 3D facial region point, Rbsj
                         denotes the maximum difference among the three different directions X, Y, Z on the Cartesian coordinates and cj
                         is the centroid point of the j-th region. Then, the RBSR descriptor of each region j is denoted as RBSR
                        
                           j
                        
                        ={RBSR
                        1
                        
                           j
                        ,⋅⋅⋅,
                        RBSR
                        
                           N
                        
                        
                           j
                        },1≤
                        i
                        ≤
                        N, where N is the number of points on the each facial region. The RBSR has successfully reduced computation complexity based on the discussion in our previous work.

In the following, we estimate a weight for each regional representation. Mutual information is introduced to describe the relativity and redundancy of the different facial regions [19]. We define the average value of all mutual information between the regional descriptor rbsri
                         and the region r as the relevance of the whole descriptor RBSR:
                           
                              (5)
                              
                                 D
                                 
                                    RBSR
                                    r
                                 
                                 =
                                 
                                    1
                                    
                                       RBSR
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          r
                                          b
                                          s
                                          
                                             r
                                             i
                                          
                                          ∈
                                          RBSR
                                       
                                    
                                    
                                       I
                                       
                                          
                                             r
                                             b
                                             s
                                             
                                                r
                                                i
                                             
                                             ;
                                             r
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The redundancy of the descriptor RBSR is summed by the average value of all mutual information between the regional descriptor rbsri
                         and the regional descriptor rbsrj
                        :
                           
                              (6)
                              
                                 R
                                 
                                    RBSR
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          RBSR
                                       
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          r
                                          b
                                          s
                                          
                                             r
                                             i
                                          
                                          ,
                                          r
                                          b
                                          s
                                          
                                             r
                                             j
                                          
                                          ∈
                                          RBSR
                                       
                                    
                                    
                                       I
                                       
                                          
                                             r
                                             b
                                             s
                                             
                                                r
                                                i
                                             
                                             ;
                                             r
                                             b
                                             s
                                             
                                                r
                                                j
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Suppose region pairs are conditionally independent, we can approximately calculate the probability of a descriptor set RBSR given a region r and select the r that maximizes this probability. We can treat the maximum probability as the regional weight for specified application in the following equation. To build the connection between a specific individual and the corresponding facial regions, the object label information is provided for each facial region:
                           
                              (7)
                              
                                 P
                                 
                                    
                                       RBSR
                                       |
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       ∏
                                       
                                          r
                                          b
                                          s
                                          
                                             r
                                             i
                                          
                                          ∈
                                          RBSR
                                       
                                    
                                    
                                       P
                                       
                                          
                                             
                                                l
                                                i
                                             
                                             |
                                             r
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∏
                                       
                                          r
                                          b
                                          s
                                          
                                             r
                                             j
                                          
                                          ∈
                                          RBSR
                                       
                                    
                                    
                                       P
                                       
                                          
                                             
                                                l
                                                j
                                             
                                             |
                                             
                                                l
                                                i
                                             
                                             ,
                                             r
                                          
                                       
                                       P
                                       
                                          
                                             D
                                             ,
                                             R
                                             |
                                             r
                                             ,
                                             
                                                l
                                                i
                                             
                                             ,
                                             
                                                l
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where l
                        
                           i
                        ,
                        l
                        
                           j
                        
                        ∈
                        L is the discrete quantized labels associated with descriptor rbsr
                        
                           i
                        
                        ∈
                        RBSR, and D, R are the values of relevance and redundancy computed by Eqs. (5) and (6), respectively. The detailed numerical solution method can be seen in Appendix A and the regional weights of RBSR descriptor can be calculated as follows:
                           
                              (8)
                              
                                 
                                    ω
                                    r
                                 
                                 =
                                 log
                                 
                                    
                                       P
                                       
                                          
                                             RBSR
                                             |
                                             r
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          l
                                          ∈
                                          L
                                       
                                    
                                    
                                       log
                                       
                                          
                                             P
                                             
                                                
                                                   
                                                      b
                                                      l
                                                   
                                                   |
                                                   r
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           log
                           
                              
                                 P
                                 
                                    
                                       
                                          b
                                          l
                                       
                                       |
                                       r
                                    
                                 
                              
                           
                           =
                           
                              
                                 ∑
                                 
                                    r
                                    b
                                    s
                                    
                                       r
                                       i
                                    
                                    ∈
                                    RBSR
                                 
                              
                              
                                 
                                    
                                       ∑
                                       
                                          r
                                          b
                                          s
                                          
                                             r
                                             j
                                          
                                          ∈
                                          RBSR
                                       
                                    
                                    
                                       log
                                       
                                          
                                             P
                                             
                                                
                                                   D
                                                   ,
                                                   R
                                                   |
                                                   r
                                                   ,
                                                   l
                                                   ,
                                                   
                                                      l
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         is the bin probability and ωr
                         is the weight of RBSR descriptor for the region r.

Thus, the descriptor of the whole 3D facial images can be expressed for the specified applications:
                           
                              (9)
                              
                                 
                                    x
                                    k
                                 
                                 =
                                 
                                    ω
                                    1
                                 
                                 
                                    
                                       r
                                       b
                                       s
                                       
                                          r
                                          1
                                       
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    ω
                                    i
                                 
                                 
                                    
                                       r
                                       b
                                       s
                                       
                                          r
                                          i
                                       
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    ω
                                    7
                                 
                                 
                                    
                                       r
                                       b
                                       s
                                       
                                          r
                                          7
                                       
                                    
                                 
                              
                           
                        where k is used for the specified 3D facial processing, which can be referred to face recognition and verification, expression analysis, and pose estimation. i ranges from 1 to 7 for the different facial regions, including nose, left/right eyes, left/right cheeks, forehead and mouth. The processing can further improve 3D facial region segmentation and selection, which not only details local properties but also enhances the shape information of 3D facial images.

In this section, we have two learning tasks for face recognition and expression classification when the same input feature descriptor is used. Here, we assume X
                     ⊂
                     R
                     
                        D
                      is the feature descriptor computed by Section 3. Our proposal is to learn two regression functions a
                     1 and a
                     2 and obtain their corresponding lower dimensional feature vectors z
                     1 and z
                     2. Robust regional and global regression mapping algorithm (RGRM) is proposed to dimension reduction and overcome some remaining artifacts left from the region segmentation, such as some stretched or misaligned images, hair occlusions, large data noises and corruptions.

In order to better cope with the unseen data and reflect the facial global properties, we introduce a nonparametric approach [20] for out-of-sample extrapolation. Since the regional structure of manifold in 3D face data is linear, the regression expression can be defined as a linear regression model, i.e., Y
                     =
                     W
                     
                        T
                     
                     X
                     +
                     E, where W is the local projection matrix, and E is the noise matrix. We map the weighted facial RBSR descriptor into a Hilbert space H and Rd
                     , i.e., y
                     
                        i
                     
                     =
                     ϕ(W)
                        T
                     
                     ϕ(x
                     
                        i
                     )+
                     e
                     
                        i
                     , where ϕ(W) is the regional regression matrix from H to Rd
                      and e
                     
                        i
                     
                     ∈
                     R
                     
                        d
                      is noise term.

The objective function can be rewritten to simultaneously learn the low dimensional embedding Y and the mapping matrix as
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                                
                                                   ω
                                                   i
                                                
                                                ,
                                                Y
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                         i
                                                         T
                                                      
                                                      
                                                         W
                                                         i
                                                      
                                                      +
                                                      
                                                         1
                                                         j
                                                      
                                                      
                                                         e
                                                         i
                                                         T
                                                      
                                                      −
                                                      
                                                         Y
                                                         i
                                                      
                                                   
                                                
                                                F
                                                2
                                             
                                             +
                                             γ
                                             
                                                
                                                   
                                                      ω
                                                      i
                                                   
                                                
                                                F
                                                2
                                             
                                          
                                       
                                       +
                                       μ
                                       
                                          
                                             
                                                
                                                   Φ
                                                   
                                                      
                                                         X
                                                      
                                                      T
                                                   
                                                   Φ
                                                   
                                                      W
                                                   
                                                   +
                                                   
                                                      1
                                                      n
                                                   
                                                   
                                                      E
                                                      T
                                                   
                                                   −
                                                   Y
                                                
                                             
                                             F
                                             2
                                          
                                       
                                       +
                                       γ
                                       
                                          
                                             
                                                Φ
                                                
                                                   W
                                                
                                             
                                          
                                          F
                                          2
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       s
                                       .
                                       t
                                       .
                                       
                                          Y
                                          T
                                       
                                       Y
                                       =
                                       I
                                    
                                 
                              
                           
                        
                     where 1
                        j
                     
                     ∈
                     R
                     
                        j
                      and 1
                        n
                     
                     ∈
                     R
                     
                        n
                      are two vectors of all ones. According to the literature [20], y can be computed by
                        
                           (11)
                           
                              y
                              =
                              
                                 Y
                                 T
                              
                              
                                 
                                    
                                       H
                                       K
                                       H
                                       +
                                       γ
                                       I
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              H
                              
                                 K
                                 x
                              
                              +
                              
                                 1
                                 n
                              
                              
                                 Y
                                 T
                              
                              
                                 1
                                 n
                              
                              −
                              
                                 1
                                 n
                              
                              
                                 Y
                                 T
                              
                              
                                 
                                    
                                       H
                                       K
                                       H
                                       +
                                       γ
                                       I
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              H
                              K
                              
                                 1
                                 n
                              
                           
                        
                     where 
                        H
                        =
                        I
                        −
                        
                           1
                           n
                        
                        
                           1
                           n
                        
                        
                           1
                           n
                           T
                        
                      denotes as the global centering matrix, K
                     
                        x
                     
                     ∈
                     R
                     
                        n
                      denotes as a vector with its i-th element K
                     
                        xi
                     
                     =
                     ϕ(x)
                        T
                     
                     ϕ(x
                     
                        i
                     )=exp(−‖x
                     −
                     x
                     
                        i
                     ‖2/σ
                     2), and x
                     
                        i
                     
                     ∈
                     χ is the i-th RBSR feature descriptor in the training set. In order to avoid overfitting, we perform local PCA to reduce the dimension of each facial RBSR descriptor as preprocessing.

In multi-task learning, given an extended training set of the RBSR descriptors 
                        
                           
                              
                                 
                                    x
                                    i
                                    k
                                 
                                 
                                    y
                                    i
                                    k
                                 
                              
                           
                           
                              i
                              =
                              1
                           
                           
                              m
                              k
                           
                        
                      computed by Eq. (11), x
                     
                        i
                     
                     
                        k
                     
                     ∈
                     R
                     
                        n
                      denotes the RBSR descriptor of the i-th training sample for the k-th application, y
                     
                        i
                     
                     
                        k
                      denotes the corresponding output, mk
                      is the number of facial points. Let 
                        
                           X
                           k
                        
                        =
                        
                           
                              
                                 x
                                 1
                                 k
                              
                              ,
                              ⋅
                              ⋅
                              ⋅
                              ,
                              
                                 x
                                 
                                    m
                                    k
                                 
                                 k
                              
                           
                        
                        ∈
                        
                           R
                           
                              
                                 m
                                 k
                              
                              ×
                              n
                           
                        
                      denote the data matrix for the k-th application, and 
                        
                           Y
                           k
                        
                        =
                        
                           
                              
                                 y
                                 1
                                 k
                              
                              ,
                              ⋅
                              ⋅
                              ⋅
                              ,
                              
                                 y
                                 
                                    m
                                    k
                                 
                                 k
                              
                           
                        
                        ∈
                        
                           R
                           
                              m
                              k
                           
                        
                      denote the lower dimensional embedding as the corresponding label of the whole image. The regression vector for all regions from the regression matrix A
                     =[a
                     1,⋅⋅⋅,
                     a
                     
                        k
                     ]∈
                     R
                     
                        n
                        ×
                        k
                      needs to be estimated by the discussion below . Then, we can obtain the maximum posterior estimation for face recognition and expression classification by the following equation:
                        
                           (12)
                           
                              
                                 
                                    
                                       A
                                       k
                                    
                                 
                                 *
                              
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    
                                       A
                                       k
                                    
                                 
                              
                              P
                              
                                 
                                    y
                                    |
                                    
                                       A
                                       k
                                    
                                    ,
                                    
                                       μ
                                       1
                                    
                                 
                              
                              P
                              
                                 
                                    y
                                    |
                                    
                                       μ
                                       2
                                    
                                 
                              
                              
                                 
                                    ∏
                                    
                                       j
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    P
                                    
                                       
                                          
                                             a
                                             j
                                             k
                                          
                                          |
                                          
                                             δ
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    ∏
                                    
                                       k
                                       =
                                       1
                                    
                                    2
                                 
                                 
                                    
                                       
                                          ∏
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             m
                                             i
                                          
                                       
                                       
                                          P
                                          
                                             
                                                
                                                   y
                                                   i
                                                   k
                                                
                                                |
                                                
                                                   A
                                                   k
                                                
                                                ,
                                                
                                                   x
                                                   i
                                                   k
                                                
                                                ,
                                                
                                                   σ
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where μ
                     1 and μ
                     2 are the parameters for specified application. We assume the corresponding target y
                     
                        k
                     
                     ∈
                     R for the k-th application has a Gaussian distribution with mean y
                     
                        k
                     
                     ∈
                     R and precision σk
                     
                     >0:
                        
                           (13)
                           
                              p
                              
                                 
                                    
                                       y
                                       i
                                       k
                                    
                                    |
                                    
                                       A
                                       k
                                    
                                    ,
                                    
                                       x
                                       i
                                       k
                                    
                                    ,
                                    
                                       σ
                                       k
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       σ
                                       k
                                    
                                    
                                       2
                                       π
                                    
                                 
                              
                              exp
                              
                                 
                                    
                                       −
                                       
                                          σ
                                          k
                                       
                                       
                                          
                                             
                                                y
                                                k
                                             
                                             −
                                             
                                                
                                                   
                                                      A
                                                      k
                                                   
                                                
                                                T
                                             
                                             
                                                x
                                                k
                                             
                                          
                                       
                                    
                                    2
                                 
                              
                              .
                           
                        
                     
                  

Assume the prior probability p(A
                     
                        k
                     |δ
                     
                        k
                     ) is generated according to the exponential prior: p(A
                     
                        k
                     |δ
                     
                        k
                     )∞exp(−‖A
                     
                        k
                     ‖δ
                     
                        k
                     ). Here, pairwise data x, y is drawn independently from the distribution (Eq. (12)) and A
                     1,⋅⋅⋅,
                     A
                     
                        n
                      are drawn independently from the prior in Eq. (13). Then, the likelihood function and prior can be expressed as follows and the classification result is obtained based on the maximum probability:
                        
                           (14)
                           
                              p
                              
                                 
                                    y
                                    |
                                    A
                                    ,
                                    X
                                    ,
                                    δ
                                 
                              
                              =
                              
                                 
                                    ∏
                                    
                                       k
                                       =
                                       1
                                    
                                    2
                                 
                                 
                                    
                                       
                                          ∏
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             m
                                             k
                                          
                                       
                                       
                                          p
                                          
                                             
                                                
                                                   y
                                                   i
                                                   k
                                                
                                                |
                                                
                                                   A
                                                   k
                                                
                                                ,
                                                
                                                   x
                                                   i
                                                   k
                                                
                                                ,
                                                
                                                   σ
                                                   k
                                                
                                             
                                          
                                          ,
                                          p
                                          
                                             
                                                A
                                                |
                                                δ
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∏
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    p
                                    
                                       
                                          
                                             A
                                             k
                                          
                                          |
                                          
                                             δ
                                             k
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

Then, we can obtain the optimal estimation of the regression matrix A
                     ⁎ as follows:
                        
                           (15)
                           
                              
                                 A
                                 *
                              
                              =
                              
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    A
                                 
                              
                              p
                              
                                 
                                    y
                                    |
                                    A
                                    ,
                                    
                                       μ
                                       1
                                    
                                 
                              
                              p
                              
                                 
                                    y
                                    |
                                    
                                       μ
                                       2
                                    
                                 
                              
                              p
                              
                                 
                                    y
                                    |
                                    A
                                    ,
                                    X
                                    ,
                                    δ
                                 
                              
                              p
                              
                                 
                                    A
                                    |
                                    δ
                                 
                              
                              .
                           
                        
                     
                  

Finally, the high-dimensional input RBSR descriptor X can be embedded into an intrinsic low-dimension feature vector by
                        
                           (16)
                           
                              Z
                              =
                              AX
                              .
                           
                        
                     
                  

Our method can effectively balance the discriminant power of face recognition and the descriptiveness of expression analysis and the extracted features can better reflect facial surface structure, which is immune to the distorted artifacts and noise corruptions.

@&#EXPERIMENTS@&#

In this section, we provide a performance comparison of our proposed framework for 3D face recognition and emotion analysis with state-of-the-art solutions. We validate our method using the FRGC v2 database [21], BU-3DFE database [22], and CASIA 3D face database [23]. FRGC is an international general database for 3D face recognition and verification, which is comprised of 4007 images from 466 different individuals. BU-3DFE is a 3D facial expression database, which consists of 2500 3D facial expression models from 100 different individuals. CASIA contains large pose variations for testing the effectiveness of our algorithm for pose variations.

Firstly, in Section 5.1, we show the efforts of 3D face preprocessing using our method described in Section 2. Then, we perform a performance evaluation of our proposed feature description for 3D face recognition and verification in Section 5.2. In Section 5.3, we report the results of 3D facial expression analysis on BU-3DFE database. Finally, we provide a comparative study of our proposed framework with large facial pose variations in Section 5.4.

The original 3D facial images in the database usually contain some non-facial areas, such as ears, necks and shoulders as shown in Fig. 2(a). There are also some spikes and holes captured by the 3D acquisition devices. Removing the non-facial areas and facial segmentation is critical for recognition accuracy. We first evaluate the performance of 3D facial preprocessing, including 3D facial regional segmentation and 3D facial alignment.

We first use the FRGC database for performance evaluation. We segment facial regions by manual and use our proposed method to segment automatically. We calculate Euclidean distance between the manual facial regions and automatic facial regions. If the distance exceeds a threshold, we treat there is a segmentation error. The threshold setting is associated with subsequent recognition results.


                           Table 1
                            shows the average Euclidean distances (mm) between manually and automatically found landmarks. Our proposed method satisfies the error constraints that can be used for the following feature extraction and classification.

In these experiments, we use FRGC and CASIA 3D face databases to evaluate the performance of 3D face alignment, including top/bottom view (TBV), in-plane rotation with small pose variations (IPRSPV), in-plane rotation with large pose variations (IPRLPV), in-plane rotation with small pose variations (IPRSPV), out-plane rotation with large pose variations (OPRLPV) and out-plane rotation with small pose variations (OPRSPV) as shown in Fig. 5
                           . Table 2
                            shows 3D face alignment results of our proposed method and traditional method. Our method can be aligned by gestures matched from different object models with the same attitude, which is more robust than the traditional method under the different pose variations and the computational efficiency.

Our proposed RBSR descriptor is used to evaluate the discriminating power with several alternatives for 3D facial representations. We consider five different representations for identification purposes: surface normal (SN), surface curvature (SC), depth images (DI), shape index descriptor (SID), and our proposed RBSR descriptor. The experimental set is the same as Section 6.1 of our previous work [14]. Table 3
                            summarizes the configurations of the test and training sets.


                           Table 4
                            shows the recognition accuracy based on the different descriptors. Our RBSR descriptor provides a consistently higher level of accuracy on all of the test configurations, especially for the test databases 3 and 4. The shape index achieves the second higher accuracy over the other representations. The surface curvature has a slightly higher performance compared with the surface normal and depth images. Surface normal is computed by differential geometry surface, and they can actually encode the rate of change of the surface [24]. But it is sensitive to the external conditions, especially for large pose and illumination variations. Surface curvature can treat the human face surface as a free-form object and indicate the local descriptor to represent facial shape information. However, with large noises and corruptions, the performance of surface curvature are significantly degraded by the non-rigid transformation. The depth images can actually reflect the distance between the individuals and the sensor for effectively discriminant feature extraction. The shape index descriptor combined with shape and distance information makes it have more discriminative power than the other three representations. Our RBSR descriptor can effectively overcome the challenging facial variations and illustrate a distinct improvement compared with the other representations.

In the subsection, some existing algorithms are used to evaluate the performance of 3D face verification with the standard protocols, ROC I, ROC II and ROC III of FRGC v2 [21] for the different acquisition times. Table 5
                            demonstrates the verification results with the FAR of 0.1% and Fig. 6
                            illustrates the ROC curves. All evaluation results come from the records of the corresponding authors in their paper.


                           Table 5 illustrates that our proposed scheme is better than the others for the standard protocol, except by Kakadiaris et al. [28] and Queirolo et al. [25]. Kakadiaris et al. [28] proposed a complex multistage method for 3D face verification, including multistage alignment, AFM fitting, feature signature and fusing. Just fitting the AFM had already spent more than 15s from the input data. For Queirolo's method [25], they pointed out that Simulated Annealing needs approximately 12.19s computation cost for the global convergence only with slightly better results. As shown in Table 6
                           , our method only spends 5.958s for the whole data processing, which effectively reduces the running time.

In addition, our proposed methods, compared to other methods with approximate performance, also take into account the accuracy for expression analysis, not only for face verification. Based on the above discussion, our method effectively balances the simple implementation and high accuracy with computational efficiency.

We conduct experiments on BU-3DFE to justify the descriptiveness of 3D facial expression analysis. Based on our previous research [30], we first introduce Kullback–Leibler divergence (KLD) [31] to evaluate superiority of our proposed feature compared with the other emotional features. From the view of Bayesian theory, the expression descriptive power relies on the class-conditional distribution [32]. And thus the facial expression descriptiveness of the feature set y can be calculated by KLD:
                              
                                 (17)
                                 
                                    D
                                    P
                                    
                                       y
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          c
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   i
                                                   +
                                                   1
                                                
                                                c
                                             
                                             
                                                D
                                                s
                                                
                                                   
                                                      
                                                         f
                                                         i
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         
                                                            
                                                               f
                                                               j
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where c is the number of the facial expression classes (six prototypic expressions), f
                           
                              i
                           (y) and f
                           
                              j
                           (y) are the i-th and j-th class-conditional probability of feature vector y respectively.

Referring to the feature sets designed in recent publications [30], a series of experiments detailed in Table 7
                            are implemented to validate expression classification. All of them are repeated for 100 times to lower the randomness and randomly selected 50 face models from each expression class each time. To better reflect the expression descriptive power, flow-matrix and geometry-matrix are introduced to 3D facial emotion analysis respectively and the results are illustrated in Fig. 7
                           .

Among all the features, our proposed feature provides the highest facial expression descriptiveness consistently. For all features, the descriptive power in flow-matrix form is much higher than that in geometry-matrix form. In both forms, Feature 4 performs the worst descriptiveness. Although Features 1 and 3 can obtain the higher descriptive power in flow-matrix form, the performances degrade sharply in geometry-matrix form. Features 2 and 7 can be treated as the median results of all features. As illustrated in Fig. 7, our features utilize more distinguishing descriptiveness than do the other algorithms and make it possible to encode more emotion descriptive information of 3D facial expression.

To verify the recognition results of expression classification, we provide the results based on BU-3DFE database. 50 subjects are randomly selected as a training set, and the rest as a testing set; each experiment is repeated 100 times to the average as shown in Fig. 8
                           .

Our proposed feature achieves the best recognition rate among all the features. The performance of Feature 6 and Feature 7 are slightly higher than the others. For all basic expressions, the recognition rates of our features are all higher than that of the second higher Feature 6. Especially in fear (FE) and disgust (DI) expressions, the discrepancy is 3.53% and 3.2% respectively. From Figs. 7 and 8, feature discrimination power and its corresponding expression descriptiveness are consistent. Our feature and slope features (Feature 6) possess much more emotion analysis power and higher recognition rates than the angle and distance features (Feature 7 and Feature 4). From Fig. 9
                           , among all prototypic expressions, our feature and slope features (Feature 6) have more emotion descriptiveness than the distance features (Feature 5), especially for HA (Happy) and SU (Surprise) expressions. Thus, our features achieve the best performance in the expression classification.

Large pose variations have a huge impact on 3D face recognition and emotion analysis. In this subsection, we evaluate the performance of the different facial descriptions with large pose variations. We follow our previous experimental design based on CASIA database [23], including small pose variations (SPV), large pose variations (LPV), small pose variations with smiling (SPVS) and large pose variations with smiling (LPVS).

From Table 8
                        , we can conclude that our method obtains the best results among all the testing sets. Xu et al. [33] considered that the fusion schemes with different characteristics to describe a subject. The “feature” level has a superior performance than the “decision” level fusion. However, pose variations can result in self-occlusions due to missing data, which significantly reduce the performance of the fusion scheme. Our method can project the 3D facial data into the regional bounding spheres to overcome the patched occlusions caused by large pose variations and improve the recognition accuracy.

@&#CONCLUSIONS@&#

In this paper, we have presented a novel framework for 3D face recognition and emotion analysis at the same time. We propose a multistage preprocessing method to segment a group of facial regions. Then, the RBSR descriptor is proposed to describe the different facial regions with different discrimination and descriptiveness. The RGRM model developed by local and global regression scheme is used to extract facial intrinsic manifold and realize the ability of facial discrimination and emotional descriptiveness. We present experimental results on the three largest standard 3D face databases, FRGC v2, BU-3DFE and CASIA. The performance of our proposed framework is with the properties of effectiveness, robustness and generality for 3D face recognition and emotion analysis.

In practice, log probability is employed to avoid extremely small values with numerical precision [34] and the above equation can be expressed as follows:
                        
                           (A.1)
                           
                              
                                 
                                    
                                       log
                                       
                                          
                                             P
                                             
                                                
                                                   RBSR
                                                   |
                                                   r
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ∑
                                             
                                                r
                                                b
                                                s
                                                
                                                   r
                                                   i
                                                
                                                ∈
                                                RBSR
                                             
                                          
                                          
                                             log
                                             
                                                
                                                   P
                                                   
                                                      
                                                         
                                                            l
                                                            i
                                                         
                                                         |
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                             
                                                r
                                                b
                                                s
                                                
                                                   r
                                                   j
                                                
                                                ∈
                                                RBSR
                                             
                                          
                                          
                                             log
                                             
                                                
                                                   P
                                                   
                                                      
                                                         
                                                            l
                                                            j
                                                         
                                                         |
                                                         
                                                            l
                                                            i
                                                         
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       +
                                       log
                                       
                                          
                                             P
                                             
                                                
                                                   D
                                                   ,
                                                   R
                                                   |
                                                   r
                                                   ,
                                                   
                                                      l
                                                      i
                                                   
                                                   ,
                                                   
                                                      l
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

To decrease the computational complexity, we assume P(l
                     
                        i
                     |r) and P(l
                     
                        j
                     |l
                     
                        i
                     ,
                     r) as the uniform probabilities. Nonuniform label probability can be computed by concatenating the individual label histogram to the pairwise regional descriptor vector in the probability expression:
                        
                           (A.2)
                           
                              log
                              
                                 
                                    P
                                    
                                       
                                          RBSR
                                          |
                                          r
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       r
                                       b
                                       s
                                       
                                          r
                                          i
                                       
                                       ∈
                                       RBSR
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                          
                                             r
                                             b
                                             s
                                             
                                                r
                                                j
                                             
                                             ∈
                                             RBSR
                                          
                                       
                                       
                                          log
                                          
                                             
                                                P
                                                
                                                   
                                                      D
                                                      ,
                                                      R
                                                      |
                                                      r
                                                      ,
                                                      
                                                         l
                                                         i
                                                      
                                                      ,
                                                      
                                                         l
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          C
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

Since the uniform probabilities for labels approximately estimated by a constant C are not depended on the region r, we can omit for clarify. The above equation can be rewritten as to bin probability based on the individual descriptor label:
                        
                           (A.3)
                           
                              
                                 ω
                                 r
                              
                              =
                              log
                              
                                 
                                    P
                                    
                                       
                                          RBSR
                                          |
                                          r
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       l
                                       ∈
                                       L
                                    
                                 
                                 
                                    log
                                    
                                       
                                          P
                                          
                                             
                                                
                                                   b
                                                   l
                                                
                                                |
                                                r
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        log
                        
                           
                              P
                              
                                 
                                    
                                       b
                                       l
                                    
                                    |
                                    r
                                 
                              
                           
                        
                        =
                        
                           
                              ∑
                              
                                 r
                                 b
                                 s
                                 
                                    r
                                    i
                                 
                                 ∈
                                 RBSR
                              
                           
                           
                              
                                 
                                    ∑
                                    
                                       r
                                       b
                                       s
                                       
                                          r
                                          j
                                       
                                       ∈
                                       RBSR
                                    
                                 
                                 
                                    log
                                    
                                       
                                          P
                                          
                                             
                                                D
                                                ,
                                                R
                                                |
                                                r
                                                ,
                                                l
                                                ,
                                                
                                                   l
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      is the bin probability and ωr
                      is the weight of RBSR descriptor for the region r.

@&#REFERENCES@&#

