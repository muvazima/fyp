@&#MAIN-TITLE@&#A simple strategy for defining polynomial spline spaces over hierarchical T-meshes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A strategy for defining cubic tensor product spline functions is proposed.


                        
                        
                           
                           Simple rules for inferring local knot vectors to define blending functions for a given T-mesh.


                        
                        
                           
                           Examples of application of the strategy for adaptive refinement in isogeometric analysis and CAD.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Isogeometric analysis

Multivariate splines

Local refinement

T-mesh

Nested spaces

@&#ABSTRACT@&#


               
               
                  We present a new strategy for constructing spline spaces over hierarchical T-meshes with quad- and octree subdivision schemes. The proposed technique includes some simple rules for inferring local knot vectors to define 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -continuous cubic tensor product spline blending functions. Our conjecture is that these rules allow to obtain, for a given T-mesh, a set of linearly independent spline functions with the property that spaces spanned by nested T-meshes are also nested, and therefore, the functions can reproduce cubic polynomials. In order to span spaces with these properties applying the proposed rules, the T-mesh should fulfill the only requirement of being a 0-balanced mesh. The straightforward implementation of the proposed strategy can make it an attractive tool for its use in geometric design and isogeometric analysis. In this paper we give a detailed description of our technique and illustrate some examples of its application in isogeometric analysis performing adaptive refinement for 2D and 3D problems.
               
            

@&#INTRODUCTION@&#

The main drawback of using B-splines and NURBS for geometric design is the impossibility to perform local refinement. T-splines were introduced by Sederberg et al.  [1] as an alternative to NURBS. Based on the idea of admitting meshes with T-junctions and inferring local knot vectors by traversing T-mesh edges, T-splines have provided a promising tool for geometric modeling that allows to perform local refinement without introducing a large number of superfluous control points. Later, in  [2], T-splines were incorporated to the framework of isogeometric analysis. Isogeometric analysis (IGA) was introduced in 2005 by Hughes et al. in  [3,4]. It has arisen as an attempt to unify the fields of CAD and classical finite element methods. The main idea of IGA consists in using for analysis the same functions that are used in CAD representation of the geometry.

To use spline functions for numerical analysis and obtain a proper convergence behavior, these functions must meet some requirements: linear independence, polynomial reproduction property, local supports and possibility to perform local adaptive refinement. This issue has been the object of numerous research works in recent years.

Analysis-suitable T-splines, proposed by Scott et al. in  [5], are a class of T-splines defined over T-meshes that should meet certain topological restrictions formulated in terms of T-junction extensions. Basis functions defined over an extended analysis-suitable T-mesh are linearly independent  [6] and form a partition of unity. The refinement algorithm allows to accomplish highly localized refinements and constructs nested T-spline spaces, but it presents an elevated implementation complexity and, as far as we know, the generalization of the strategy to 3D cases is still an open question.

Another approach to the problem of local enrichment of the approximation space is the hierarchical refinement, originally introduced by Forsey and Bartels in  [7] and later developed in  [8]. Recently, hierarchical refinement technique in the context of isogeometric analysis was described in  [9–11]. This approach is based on a simple and natural idea to construct multilevel spaces by replacing coarse level functions with finer basis functions. Starting from an initial uniform mesh, hierarchical refinement scheme leads to sequential construction of nested spline spaces with linearly independent basis functions. Simplicity of its implementation and straightforward generalization to 3D make it an attractive option for local refinement. However, a drawback of this strategy is the impossibility to define a spline space over a given arbitrary T-mesh as well as the presence of redundant basis functions and excessive support overlapping. An interesting theoretical approach to the latter problem was given in  [12]. The truncation technique is applied to redefine the function supports and reduce their overlapping.

Other options for performing local refinement of spline spaces are 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -continuous PHT-splines  [13] or local refined splines (LR-splines)  [14].

In the present paper we propose another possible alternative for the construction of spline functions that span spaces with nice properties. The technique we present here is designed for hierarchical T-meshes (multilevel meshes) with a quad- and octree subdivision scheme. This type of meshes can be efficiently implemented with tree data structures  [15] which are frequently used in engineering. Due to the elevated complexity of all current strategies, the main goal we pursue here is the simplicity and low computational cost of the implementation, both in 2D and 3D. For that, we have to assume a restriction on the T-mesh. Namely, the T-mesh should fulfill the requirement of being a 0-balanced mesh. A balanced mesh condition is usually imposed to have gradual transition from the coarse mesh to the finer zones. In addition, for our technique, this condition is an obligatory prerequisite that the T-mesh should fulfill. Assuming this reasonable restriction over the T-mesh, we can define easily cubic spline functions that span spaces with desirable properties: linear independence, 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -continuous, cubic polynomial reproduction property, nestedness of spanned spaces and a straightforward implementation. The key of the strategy lies in some simple rules used for inferring local knot vectors for each blending function.

The paper is organized as follows. Some basic concepts about B-splines and T-meshes are given in Section  2. Section  3 includes the general scheme of our strategy and the description of its main stages. In Section  4 we explain in detail the key of our technique, that is, the rules used for inferring function supports in order to span spaces with desirable properties. In Section  5 the properties of the defined functions are given and the issue of support overlapping and sparsity of stiffness matrix is discussed. Computational examples of performing adaptive refinement for 2D and 3D Poisson problems are presented in Section  6. Conclusions are given in Section  7.

We start with a brief summary of the main concepts about B-splines.

A set of B-spline basis functions 
                           
                              
                                 B
                              
                              
                                 i
                                 ,
                                 p
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              )
                           
                         of degree 
                           p
                        , inferred from a non-decreasing sequence 
                           Ξ
                           =
                           
                              {
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    n
                                    +
                                    p
                                    +
                                    1
                                 
                              
                              }
                           
                        , called knot vector, is defined by the Cox–de Boor recursion formula
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          ,
                                          0
                                       
                                    
                                    
                                       (
                                       ξ
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if  
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ≤
                                                ξ
                                                <
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise.
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    
                                       (
                                       ξ
                                       )
                                    
                                    =
                                    
                                       
                                          ξ
                                          −
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                +
                                                p
                                             
                                          
                                          −
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          ,
                                          p
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       ξ
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                +
                                                p
                                                +
                                                1
                                             
                                          
                                          −
                                          ξ
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                +
                                                p
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          p
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       ξ
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

A knot vector 
                           Ξ
                         is called open knot vector if the first and the last knots are repeated 
                           p
                           +
                           1
                         times. At each knot of multiplicity 
                           m
                         the basis functions are 
                           
                              
                                 C
                              
                              
                                 p
                                 −
                                 m
                              
                           
                        .

A B-spline curve is defined as a linear combination of B-spline basis functions 
                           
                              
                                 
                                    S
                                 
                                 
                                    (
                                    ξ
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       p
                                    
                                 
                                 
                                    (
                                    ξ
                                    )
                                 
                                 ,
                              
                           
                         where coefficients 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 s
                              
                           
                         are called control points, typically 
                           s
                           =
                           2
                         or 3.

Multivariate B-splines are defined as a tensor product of univariate B-spline functions 
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       
                                          i
                                       
                                       ,
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              ξ
                           
                           =
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    d
                                 
                              
                              )
                           
                         and the multi-index 
                           
                              i
                           
                           =
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    i
                                 
                                 
                                    d
                                 
                              
                              )
                           
                           ∈
                           I
                        . The multi-index set is defined by 
                           I
                           =
                           
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              }
                           
                           ×
                           ⋯
                           ×
                           
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    d
                                 
                              
                              }
                           
                        .

A B-spline surface (solid) is defined as a linear combination of bivariate (trivariate) B-spline functions 
                           
                              
                                 
                                    S
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          i
                                       
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          i
                                       
                                       ,
                                       p
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 ,
                              
                           
                         where the control points 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 s
                              
                           
                         (
                           s
                           =
                           2
                         or 3) form a control mesh.

For more details about B-splines see  [16].

In order to overcome the drawback of tensor product structure, which does not allow to perform local refinement, it is necessary to admit T-junctions in the mesh. The concept T-junction is similar to hanging node in the classical finite element method. An axes-aligned grid that allows T-junctions is called T-mesh. As was mentioned in the previous section, there are several strategies to define tensor product spline functions over T-meshes and one of these strategies is T-splines. The underlying idea of T-splines consists in defining blending functions by means of a set of local knot vectors instead of a global knot vector, as in the case of B-splines or NURBS. A local knot vector for each bivariate function 
                           
                              
                                 B
                              
                              
                                 α
                              
                           
                         is inferred by traversing the T-mesh edges in both parametric directions starting from a vertex 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 α
                              
                           
                         of the mesh (the anchor), see Fig. 1
                        . For a pair of local knot vectors 
                           
                              
                                 Ξ
                              
                              
                                 α
                              
                              
                                 j
                              
                           
                           =
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    3
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    4
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    5
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           ,
                           
                           j
                           =
                           1
                           ,
                           2
                         the bicubic spline function 
                           
                              
                                 B
                              
                              
                                 α
                              
                           
                         is defined as 
                           
                              
                                 B
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           =
                           B
                           
                              [
                              
                                 
                                    Ξ
                                 
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              ]
                           
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           B
                           
                              [
                              
                                 
                                    Ξ
                                 
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , where 
                           B
                           
                              [
                              
                                 
                                    Ξ
                                 
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                              ]
                           
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         is an univariate B-spline corresponding to the knot vector 
                           
                              
                                 Ξ
                              
                              
                                 α
                              
                              
                                 j
                              
                           
                        . In general, T-spline blending functions do not span a polynomial space. Some additional restrictions on the T-mesh configuration  [5] should be satisfied in order to span a polynomial spline space. If these restrictions are not verified, the T-splines should be normalized in order to form a partition of unity. This leads to rational blending functions: 
                           
                              
                                 R
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           =
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       α
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ξ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       β
                                       ∈
                                       A
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       β
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ξ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                        , where 
                           A
                         is the index set of the basis spanned by the T-mesh. These rational blending functions are capable of reproducing a constant function, but, in general, cannot reproduce a polynomial of a higher order. A T-spline approximation is constructed as a linear combination of all blending functions: 
                           S
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 α
                                 ∈
                                 A
                              
                           
                           
                              
                                 P
                              
                              
                                 α
                              
                           
                           
                           
                              
                                 R
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        .

In this section we describe our strategy to define tensor product spline functions over hierarchical T-meshes. The strategy we propose has some similarity with T-splines in as much as we define the blending functions from local knot vectors that are inferred by traversing the T-mesh edges. Some additional rules and requirements are imposed for the local knot vectors in order to obtain spline spaces with nice properties. The strategy is mainly motivated by the idea of preserving an original basis function if it cannot be reproduced with the basis of the new space after a refinement. For example, in the initial mesh of Fig. 2
                     (a), we define a basis function 
                        
                           
                              N
                           
                           
                              α
                           
                        
                      associated to the vertex 
                        α
                     . Then, we perform some cell refinements as shown in Fig. 2(b). It is easy to check that the new T-spline space obtained in Fig. 2(b) is not capable of reproducing the original basis function 
                        
                           
                              N
                           
                           
                              α
                           
                        
                     . However, if we define the function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              α
                           
                        
                      as shown in Fig. 2(c), keeping in this case the initial basis unaltered in the new refined space, we guarantee the nestedness of spline spaces.

In our strategy, the process of spline space construction for a given T-mesh can be divided in the following three steps: 
                        
                           1.
                           
                              Mesh pretreatment (0-balancing).


                              Inferring local knot vectors.


                              Modification of local knot vectors.

Next, we give a description of each step of the process.

Due to their simplicity, quadtree and octree meshes are attractive tools for performing adaptive refinement in IGA and geometric modeling. To guarantee a good quality of the approximation space constructed over a mesh, it is preferable to have a gradual transition from the coarse mesh to the finely refined zone. That is why it is common to work with balanced quadtree and octree meshes. The strategy we propose in this paper is designed exclusively for the 0-balanced T-meshes. A mesh with tree structure is said to be 0-balanced if for any 
                           k
                        , no cell at level 
                           k
                         shares a vertex (0-face) with a cell at level greater than 
                           k
                           +
                           1
                        . In other words, a 0-balanced quadtree mesh implies that any cell has contact (through vertex, edge or face) only with cells that differ at most in one level of depth. An example of 0-balanced procedure quadtree is shown in Fig. 3
                        (b). To obtain a 0-balanced quadtree, a standard balancing procedure is applied. Note that refinements performed during the 0-balancing procedure do not propagate, see  [17].

It should be highlighted that 0-balancing the T-mesh is an essential prerequisite for the construction of spline spaces by means of our technique. In general, if the T-mesh is not 0-balanced, our rules for inferring local knot vectors do not lead to polynomial spaces. Also, it is important to emphasize that, for our 2D (3D) T-meshes, a subdivision of any cell is performed by subdividing the cell in 4 (8) equal subcells so that, all cells of the same level have the same size and the edge size of a 
                           k
                        -level cell is twice larger than the edge size of a 
                           
                              (
                              k
                              +
                              1
                              )
                           
                        -level cell.

Let us consider a T-mesh 
                           T
                         of the squared parametric domain 
                           Ω
                           =
                           
                              
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 d
                              
                           
                        , 
                           d
                           =
                           2
                         or 3. We call regular node the node of the mesh that is not a T-junction. We associate a blending function only to regular nodes of the mesh, as it is usual in classical finite element methods when working with hanging nodes. The skeleton of a 
                           d
                        -dimensional mesh 
                           T
                         is the geometric set of points composed of the union of all 
                           
                              (
                              d
                              −
                              1
                              )
                           
                        -faces of the mesh and it is denoted by 
                           
                              skt
                           
                           
                              (
                              T
                              )
                           
                        . That is, for a 2D space, the mesh skeleton is the union of all the edges of the mesh, and the skeleton of a 3D mesh is the union of all its faces.

To define our cubic tensor product spline blending functions over a given 
                           d
                        -dimensional T-mesh, a local knot vector for 
                           d
                         parametric directions should be assigned to each function 
                           
                              
                                 N
                              
                              
                                 α
                              
                           
                        : 
                           
                              
                                 Ξ
                              
                              
                                 α
                              
                              
                                 j
                              
                           
                           =
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    3
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    4
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    5
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        , 
                           j
                           =
                           1
                           ,
                           …
                           ,
                           d
                        . Similarly to  [1], these knot vectors are inferred by traversing the T-mesh skeleton. For simplicity, let us describe this procedure for a two-dimensional T-mesh. Starting from the central knot 
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    3
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    3
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , i.e., the anchor of the function, we walk across the T-mesh until intersecting perpendicularly a mesh edge. According to our strategy, we should skip over the T-junctions where the missing edge is perpendicular to the direction of our marching, see Fig. 4
                        . When the boundary of the parametric domain is reached while walking across the mesh, we repeat knots creating an open knot vector structure along the boundary, see Fig. 4(c). Note that all interior knots have multiplicity 1. Thus, we obtain for mesh 
                           T
                         a set of blending functions 
                           
                              
                                 
                                    {
                                    
                                       
                                          N
                                       
                                       
                                          α
                                       
                                    
                                    }
                                 
                              
                              
                                 α
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        , where 
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                         is the index set. Fig. 5
                         illustrates an example of T-mesh in the parameter space and the anchors of all blending functions defined over this mesh. Any interior regular node has exactly one function associated to it and the boundary nodes have more than one function associated due to the open knot vector structure.

The process of inferring local knot vectors can be resumed as follows: 
                           
                              •
                              
                                 Blending functions are associated only to regular nodes of the mesh.


                                 Local knot vectors are inferred by walking across the mesh until intersecting the mesh skeleton. This intersection should not coincide with a T-junction perpendicular to the marching direction.


                                 Boundary knots are repeated to create an open knot vector structure along the boundary.
                              

Next, in order to span a spline space with good properties, some function supports should be modified. This issue is addressed in the next subsection.

The key of our strategy lies in some simple rules used for the modification of the function supports that lead to the construction of a polynomial spline space over a given 0-balanced T-mesh. In order to describe the idea, let us introduce some notation. For the local knot vectors 
                           
                              
                                 Ξ
                              
                              
                                 α
                              
                              
                                 j
                              
                           
                           =
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    3
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    4
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    5
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           ,
                           
                           j
                           =
                           1
                           ,
                           …
                           ,
                           d
                         let us denote the length of each knot interval as 
                           
                              
                                 Δ
                              
                              
                                 i
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 ξ
                              
                              
                                 i
                                 +
                                 1
                              
                              
                                 j
                              
                           
                           −
                           
                              
                                 ξ
                              
                              
                                 i
                              
                              
                                 j
                              
                           
                           ,
                           
                           j
                           =
                           1
                           ,
                           …
                           ,
                           d
                         and 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           4
                        .

The support of a 
                           d
                        -variate blending function 
                           
                              
                                 N
                              
                              
                                 α
                              
                           
                         is a 
                           d
                        -dimensional rectangular box: 
                           
                              [
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    5
                                 
                                 
                                    1
                                 
                              
                              ]
                           
                           ×
                           ⋯
                           ×
                           
                              [
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                                 
                                    d
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    5
                                 
                                 
                                    d
                                 
                              
                              ]
                           
                        . We are going to call frame of a function support the union of all 
                           
                              (
                              d
                              −
                              2
                              )
                           
                        -faces of this box and we will denote it by 
                           
                              frm
                           
                           
                              (
                              
                                 supp
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    α
                                 
                              
                              )
                           
                        . That is, for the rectangular support of a bivariate function, the frame is the union of the four vertices of this rectangle. For the cuboidal support of a trivariate function, its frame is composed of the union of the twelve edges of this cuboid.

Once the function supports are inferred, we modify them in such a way that, for each blending function 
                           
                              
                                 N
                              
                              
                                 α
                              
                           
                        , its knot vectors 
                           
                              
                                 Ξ
                              
                              
                                 α
                              
                              
                                 j
                              
                           
                           
                           j
                           =
                           1
                           ,
                           …
                           ,
                           d
                         verify the following simple conditions:


                        
                           Condition 1
                           
                              Local knot vectors of the 
                              
                                 d
                              
                              -variate function 
                              
                                 
                                    
                                       N
                                    
                                    
                                       α
                                    
                                 
                               
                              verify
                              
                                 1
                              
                              
                                 1
                                 Except the cases involving repeated knots that are explained at the end of Section  4.1.
                              
                              
                                 
                                    (1)
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             1
                                          
                                          
                                             j
                                          
                                       
                                       ⩾
                                       
                                          
                                             Δ
                                          
                                          
                                             2
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             Δ
                                          
                                          
                                             3
                                          
                                          
                                             j
                                          
                                       
                                       ⩽
                                       
                                          
                                             Δ
                                          
                                          
                                             4
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       d
                                       .
                                    
                                 
                              
                           


                        
                           Condition 2
                           
                              The frame of the function support should be situated over the mesh skeleton:
                              
                                 
                                    (2)
                                    
                                       
                                          frm
                                       
                                       
                                          (
                                          
                                             supp
                                          
                                          
                                          
                                             
                                                N
                                             
                                             
                                                α
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          skt
                                       
                                       
                                          (
                                          T
                                          )
                                       
                                       .
                                    
                                 
                              
                           

Thus, the function supports that do not meet Condition 1 or 2 should be modified. To perform this modification we extend the original support by changing some knot intervals until the resulting support satisfies both conditions. We are going to refer to these support modifications as Extension rule 1 and 2, respectively. In the next section we give a detailed description of this procedure for 2D and 3D cases.

Here, we present simple support Extension rule 1 and 2 to obtain local knot vectors that fulfill Conditions 1 and 2 formulated in the previous section. We proceed as follows. First, if after traversing the T-mesh skeleton the local knot vectors of a function do not satisfy Condition 1, we modify some of their knots in order to meet Condition 1. Then, the fulfillment of Condition 2 is checked and, if it is not satisfied, another appropriate modification of the support is carried out. As a result of these modifications we obtain a new extended support with local knot vectors which verify both conditions. These modifications are easily implemented taking into account the balanced tree structure of the mesh. Let see in detail this procedure.

To clarify the notation, in the rest of the paper we denote the parametric coordinates as 
                        
                           (
                           ξ
                           ,
                           η
                           ,
                           ζ
                           )
                        
                      and it is related to the previous notation as 
                        
                           (
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           )
                        
                        =
                        
                           (
                           ξ
                           ,
                           η
                           ,
                           ζ
                           )
                        
                     . Consequently, 
                        
                           (
                           
                              
                                 Ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 Ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 Ξ
                              
                              
                                 3
                              
                           
                           )
                        
                        =
                        
                           (
                           Ξ
                           ,
                           H
                           ,
                           Z
                           )
                        
                      and 
                        
                           (
                           
                              
                                 Δ
                              
                              
                                 i
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 Δ
                              
                              
                                 i
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 Δ
                              
                              
                                 i
                              
                              
                                 3
                              
                           
                           )
                        
                        =
                        
                           (
                           
                              
                                 Δ
                              
                              
                                 i
                              
                              
                                 ξ
                              
                           
                           ,
                           
                              
                                 Δ
                              
                              
                                 i
                              
                              
                                 η
                              
                           
                           ,
                           
                              
                                 Δ
                              
                              
                                 i
                              
                              
                                 ζ
                              
                           
                           )
                        
                     .

In order to facilitate the description and illustration of the strategy, some concepts and notation introduced in Section  3 have to be particularized to the 2D case. The skeleton 
                        
                           
                              skt
                           
                           
                              (
                              T
                              )
                           
                         of a two-dimensional mesh 
                           T
                         is the union of all edges of the mesh. For a bivariate function let us denote the vertices of its rectangular support as 
                           
                              
                                 V
                              
                              
                                 1
                                 ,
                                 1
                              
                           
                           =
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        , 
                           
                              
                                 V
                              
                              
                                 5
                                 ,
                                 1
                              
                           
                           =
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        , 
                           
                              
                                 V
                              
                              
                                 5
                                 ,
                                 5
                              
                           
                           =
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    η
                                 
                                 
                                    5
                                 
                              
                              )
                           
                         and 
                           
                              
                                 V
                              
                              
                                 1
                                 ,
                                 5
                              
                           
                           =
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    η
                                 
                                 
                                    5
                                 
                              
                              )
                           
                        . Then, the frame of a function support is the union of its four vertices, i.e., 
                           
                              frm
                           
                           
                              (
                              
                                 supp
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    α
                                 
                              
                              )
                           
                           =
                           
                              {
                              
                                 
                                    V
                                 
                                 
                                    n
                                    ,
                                    m
                                 
                              
                              ,
                              
                              n
                              ,
                              m
                              ∈
                              
                                 {
                                 1
                                 ,
                                 5
                                 }
                              
                              }
                           
                        . Fig. 6
                         illustrates the introduced notation for a bivariate function support.

Formulation of Condition 1 for the local knot vectors 
                           Ξ
                         and 
                           H
                         is simple and does not need any clarification. Condition 2 adapted to 2D case is formulated as follows: The four vertices of a function support should be situated over the mesh edges.


                        
                           Extension rule 1
                           If the local knot vector 
                                 Ξ
                               of a function does not satisfy Condition 1, we modify this vector by skipping over the minimal number of knots until 
                                 
                                    
                                       Δ
                                    
                                    
                                       1
                                    
                                    
                                       ξ
                                    
                                 
                                 ⩾
                                 
                                    
                                       Δ
                                    
                                    
                                       2
                                    
                                    
                                       ξ
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                    
                                    
                                       3
                                    
                                    
                                       ξ
                                    
                                 
                                 ⩽
                                 
                                    
                                       Δ
                                    
                                    
                                       4
                                    
                                    
                                       ξ
                                    
                                 
                               is verified, and analogously, for 
                                 H
                              . This modification is made independently for each parametric direction applying certain extension rules. Let us see an example of support extension for a bivariate function. Leftmost function support shown in Fig. 7
                              (a) does not meet Condition 1. For the knot vector 
                                 Ξ
                               we have 
                                 
                                    
                                       Δ
                                    
                                    
                                       3
                                    
                                    
                                       ξ
                                    
                                 
                                 >
                                 
                                    
                                       Δ
                                    
                                    
                                       4
                                    
                                    
                                       ξ
                                    
                                 
                              , so the knot interval 
                                 
                                    
                                       Δ
                                    
                                    
                                       4
                                    
                                    
                                       ξ
                                    
                                 
                               should be modified. Let us denote 
                                 h
                                 =
                                 max
                                 
                                    (
                                    
                                       
                                          Δ
                                       
                                       
                                          2
                                       
                                       
                                          ξ
                                       
                                    
                                    ,
                                    
                                       
                                          Δ
                                       
                                       
                                          3
                                       
                                       
                                          ξ
                                       
                                    
                                    )
                                 
                                 =
                                 max
                                 
                                    (
                                    
                                       
                                          Δ
                                       
                                       
                                          2
                                       
                                       
                                          η
                                       
                                    
                                    ,
                                    
                                       
                                          Δ
                                       
                                       
                                          3
                                       
                                       
                                          η
                                       
                                    
                                    )
                                 
                              . Note that both maxima coincide due to the quadtree structure and the fact that the T-junctions are skipped. Then, the fifth knot 
                                 
                                    
                                       ξ
                                    
                                    
                                       5
                                    
                                 
                               is redefined as 
                                 
                                    
                                       ξ
                                    
                                    
                                       5
                                    
                                    
                                       ∗
                                    
                                 
                                 ←
                                 
                                    
                                       ξ
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 2
                                 h
                              . For the local knot vector 
                                 H
                               we have 
                                 
                                    
                                       Δ
                                    
                                    
                                       2
                                    
                                    
                                       η
                                    
                                 
                                 >
                                 
                                    
                                       Δ
                                    
                                    
                                       3
                                    
                                    
                                       η
                                    
                                 
                              , so the knots 
                                 
                                    
                                       η
                                    
                                    
                                       4
                                    
                                 
                               and 
                                 
                                    
                                       η
                                    
                                    
                                       5
                                    
                                 
                               should be modified as 
                                 
                                    
                                       η
                                    
                                    
                                       4
                                    
                                    
                                       ∗
                                    
                                 
                                 ←
                                 
                                    
                                       η
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 h
                              , 
                                 
                                    
                                       η
                                    
                                    
                                       5
                                    
                                    
                                       ∗
                                    
                                 
                                 ←
                                 
                                    
                                       η
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 2
                                 h
                              .


                        
                           Extension rule 2
                           Once Condition 1 is satisfied, in order to fulfill Condition 2, we check whether the vertices of the function support are situated over the mesh edges. If not, we modify the knot vectors by skipping over a knot for both parametric directions and placing this vertex over the mesh edges. Fig. 7(b) illustrates this procedure. The checking is performed independently for each of the four quadrants of the function support. Note that for our 0-balanced quadtree we should make this checking only for some functions. For example, without loss of generality, the support vertex 
                                 
                                    
                                       V
                                    
                                    
                                       5
                                       ,
                                       5
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    
                                       
                                          η
                                       
                                       
                                          5
                                       
                                    
                                    )
                                 
                               must be checked only if 
                                 
                                    
                                       Δ
                                    
                                    
                                       3
                                    
                                    
                                       ξ
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                    
                                    
                                       4
                                    
                                    
                                       ξ
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                    
                                    
                                       3
                                    
                                    
                                       η
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                    
                                    
                                       4
                                    
                                    
                                       η
                                    
                                 
                              . An example of a function support violating Condition 2 is illustrated in Fig. 7(b). The vertex 
                                 
                                    
                                       V
                                    
                                    
                                       5
                                       ,
                                       5
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    
                                       
                                          η
                                       
                                       
                                          5
                                       
                                    
                                    )
                                 
                               of this support is not situated over a mesh edge, so the fifth knots for both parametric directions should be redefined as 
                                 
                                    
                                       ξ
                                    
                                    
                                       5
                                    
                                    
                                       ∗
                                    
                                 
                                 ←
                                 
                                    
                                       ξ
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 3
                                 h
                              , 
                                 
                                    
                                       η
                                    
                                    
                                       5
                                    
                                    
                                       ∗
                                    
                                 
                                 ←
                                 
                                    
                                       η
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 3
                                 h
                              , and thus, the new vertex 
                                 
                                    
                                       V
                                    
                                    
                                       5
                                       ,
                                       5
                                    
                                 
                               is placed over the mesh edges.

The extension of any other function support is completely analogous to these two examples. In all possible cases, the extension of a function support implies to change one or two knot intervals by duplicating its size.

Detailed algorithms for Extension rule 1 and 2 used to modify a bivariate function support according to Conditions 1 and 2 are given in Algorithms 1 and 2.


                        Fig. 8
                         shows some examples of support modification. Functions that satisfy both conditions and should not be modified are given in Fig. 8(a). Examples of support extension according to Condition 1 are shown in Fig. 8(b)–(e). And Fig. 8(f)–(h) illustrates support extension according to Condition 2 or both.

Note that an exception for Condition 1 is a knot vector that contains a knot interval of length 0 due to the open knot vector structure along the boundary. In this case, a knot vector should fulfill the inequality (1) not taking into account the knot intervals of length 0. Consequently, an exception for the application of the extension rules is the case when the boundary of the parametric domain is reached traversing the T-mesh edges, see Fig. 8(c)–(e). 
                           Remark 1
                           It is important to highlight that the application of the extension rules always places the new knots over the mesh edges, i.e., the extension rules just skip over some knots, but do not create knots that are not induced by the T-mesh.


                        
                           Remark 2
                           Note that in the case when a function support violates Condition 2, the extension of this support in order to place its vertex over the mesh skeleton can be made by modifying only one of the knot vectors instead of both. This option leads to the loss of symmetry for the spline space and to the non-uniqueness of the resulting function support. So, for simplicity, we extend the knot vectors in both parametric directions.


                        
                           
                              
                           
                        
                     


                        
                           
                              
                           
                        
                     

In this section we give a description and illustration of the proposed strategy for defining trivariate spline functions over 0-balanced octree T-meshes.

The skeleton 
                        
                           
                              skt
                           
                           
                              (
                              T
                              )
                           
                         of a three-dimensional mesh 
                           T
                         is the union of all faces of the mesh. For a trivariate function let us denote the vertices of its support as 
                           
                              
                                 V
                              
                              
                                 n
                                 ,
                                 m
                                 ,
                                 k
                              
                           
                           =
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                                 
                                    η
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                                 
                                    ζ
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         where 
                           n
                           ,
                           m
                           ,
                           k
                           ∈
                           
                              {
                              1
                              ,
                              5
                              }
                           
                        . And the edge of a support formed by the two vertices 
                           
                              
                                 V
                              
                              
                                 n
                                 ,
                                 m
                                 ,
                                 k
                              
                           
                         and 
                           
                              
                                 V
                              
                              
                                 p
                                 ,
                                 q
                                 ,
                                 r
                              
                           
                         is denoted as 
                           
                              
                                 E
                              
                              
                                 
                                    (
                                    n
                                    ,
                                    m
                                    ,
                                    k
                                    )
                                 
                                 ,
                                 
                                    (
                                    p
                                    ,
                                    q
                                    ,
                                    r
                                    )
                                 
                              
                           
                        . Then, the frame 
                        
                           
                              frm
                           
                           
                              (
                              
                                 supp
                              
                              
                              
                                 
                                    N
                                 
                                 
                                    α
                                 
                              
                              )
                           
                         of a trivariate function support is the union of its twelve edges. Fig. 9
                         illustrates the introduced notation for the support of a trivariate blending function.

The formulation of Condition 1 for the local knot vectors of a trivariate function is analogue to the 2D case. Condition 2 adapted to 3D meshes is stated as follows: Edges of the cuboidal function support should be situated over the mesh faces.

The implementation of the strategy for 3D is similar to the 2D case. To satisfy Condition 1, Extension rule 1 is applied to each of the three local knot vectors of a function analogously to the 2D case using Algorithm 1.


                        Extension rule 2. In order to fulfill Condition 2, we check whether the edges of a function support are situated over the mesh faces. If not, the two knot vectors perpendicular to this edge should be modified by skipping over a knot for both parametric directions and placing this edge over the mesh faces. This checking is performed independently for each of the eight quadrants of the function support and, in each quadrant, three edges should be checked. Fig. 10
                         illustrates the support extension procedure for the quadrant of the vertex 
                           
                              
                                 V
                              
                              
                                 5
                                 ,
                                 1
                                 ,
                                 1
                              
                           
                        . Due to the octree structure only two cases can take place: (i) the quadrant contains one edge that is not situated over the mesh faces or (ii) the quadrant contains three edges and a vertex that are not situated over the mesh skeleton. Now we study each case. 
                           
                              (i)
                              If a quadrant contains one edge that does not fulfill Condition 2, then two knot vectors perpendicular to this edge are modified, see Fig. 10(a). For the function support shown in Fig. 10(a) left, the edge 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             (
                                             5
                                             ,
                                             1
                                             ,
                                             1
                                             )
                                          
                                          ,
                                          
                                             (
                                             5
                                             ,
                                             1
                                             ,
                                             5
                                             )
                                          
                                       
                                    
                                  is not situated over the mesh faces. Therefore, its two knot vectors 
                                    Ξ
                                  and 
                                    H
                                  perpendicular to this edge are modified in order to place the edge over the mesh faces, namely, knots 
                                    
                                       
                                          ξ
                                       
                                       
                                          5
                                       
                                    
                                  and 
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                    
                                  are redefined as 
                                    
                                       
                                          ξ
                                       
                                       
                                          5
                                       
                                       
                                          ∗
                                       
                                    
                                    ←
                                    
                                       
                                          ξ
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    3
                                    h
                                  and 
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                       
                                          ∗
                                       
                                    
                                    ←
                                    
                                       
                                          η
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    3
                                    h
                                 , where 
                                    h
                                    =
                                    max
                                    
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             2
                                          
                                          
                                             ξ
                                          
                                       
                                       ,
                                       
                                          
                                             Δ
                                          
                                          
                                             3
                                          
                                          
                                             ξ
                                          
                                       
                                       )
                                    
                                    =
                                    max
                                    
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             2
                                          
                                          
                                             η
                                          
                                       
                                       ,
                                       
                                          
                                             Δ
                                          
                                          
                                             3
                                          
                                          
                                             η
                                          
                                       
                                       )
                                    
                                    =
                                    max
                                    
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             2
                                          
                                          
                                             ζ
                                          
                                       
                                       ,
                                       
                                          
                                             Δ
                                          
                                          
                                             3
                                          
                                          
                                             ζ
                                          
                                       
                                       )
                                    
                                 .

If a quadrant contains three edges that are not situated over the mesh faces, then the three knot vectors are modified by skipping over a knot for each of the three parametric directions, see Fig. 10(b). Vertex 
                                    
                                       
                                          V
                                       
                                       
                                          5
                                          ,
                                          1
                                          ,
                                          1
                                       
                                    
                                  and the three edges connected to it are not situated over the mesh skeleton, so all the three knot vectors are modified to place the three edges over the mesh faces: 
                                    
                                       
                                          ξ
                                       
                                       
                                          5
                                       
                                       
                                          ∗
                                       
                                    
                                    ←
                                    
                                       
                                          ξ
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    3
                                    h
                                 , 
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                       
                                          ∗
                                       
                                    
                                    ←
                                    
                                       
                                          η
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    3
                                    h
                                 , 
                                    
                                       
                                          ζ
                                       
                                       
                                          1
                                       
                                       
                                          ∗
                                       
                                    
                                    ←
                                    
                                       
                                          ζ
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    3
                                    h
                                 .

Algorithm 3 explains the Extension rule 2 used to modify a trivariate function support according to Condition 2.


                        
                           
                              
                           
                        
                     

Here, we summarize the properties and some characteristics of the spline spaces constructed by means of our method.

For any 0-balanced mesh 
                           T
                        , the set of blending functions defined according to our strategy spans the space 
                           
                              
                                 S
                              
                              
                                 T
                              
                           
                           =
                           
                              span
                           
                           
                           
                              {
                              
                                 
                                    N
                                 
                                 
                                    α
                                 
                              
                              :
                              α
                              ∈
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              }
                           
                         with the following properties: 
                           
                              1.
                              
                                 Functions 
                                 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   N
                                                
                                                
                                                   α
                                                
                                             
                                             }
                                          
                                       
                                       
                                          α
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                  
                                 are 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                 
                                 -continuous.


                                 Functions 
                                 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   N
                                                
                                                
                                                   α
                                                
                                             
                                             }
                                          
                                       
                                       
                                          α
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                  
                                 are linearly independent.


                                 Spaces spanned by nested T-meshes are also nested: 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                1
                                             
                                          
                                          ⊂
                                          
                                             
                                                T
                                             
                                             
                                                2
                                             
                                          
                                          ⇒
                                          
                                             
                                                S
                                             
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          ⊂
                                          
                                             
                                                S
                                             
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              


                                 Polynomial reproduction property: 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          T
                                       
                                    
                                 .

A rigorous proof of these properties is currently under preparation and we plan to give it in a future work. However, for a better understanding of the strategy, some clues should be mentioned.

For the proof of linear independence of our blending functions it is essential to take into account that we do not repeat knots in the interior of the domain, and each regular node of the T-mesh has only one function assigned to it. Some reasoning from  [18] can be used to proof the linear independence of such functions.

A brief outline of the proof of the property (3) is given in the Appendix of the present paper.

It is worth mentioning that we have carried out numerous numerical experiments and the claimed properties were verified in all of them.

It should be pointed out that the proposed strategy can lead, in some cases, to increased overlapping of the function supports of different refinement levels, which can affect the conditioning and sparsity of the stiffness matrix. This effect can take place in some problems with a very sharp singularity when the area marked to refine by the error indicator at each iteration is smaller than the area occupied by the supports of the previous level. According to our strategy, a cell refinement always adds at least one new blending function, while a function of the coarse level is replaced by the finer ones only if all the cells that share their anchor are refined. To avoid a possible accumulation of the functions of different refinement levels, the following strategy can be adopted: if a function support intersects a cell marked to be refined, then the coarsest cells sharing the anchor of the function are refined, see Fig. 11
                        (a) and (b).

Application of this strategy is illustrated in Fig. 11(c) and (d). In this example, let us suppose that the problem has a singularity at the center of the domain, and at each iteration, we refine only the four cells adjacent to the singularity point. Then, at each iteration there are functions whose support is not changed, see Fig. 11(c). However, if at each iteration we perform additional refinements, functions of the coarser level are replaced by the finer ones, see Fig. 11(d). This approach is similar to the one used in hierarchical refinement where all supports that intersect the marked cell are also refined in order to guarantee the replacing of the supports of the previous level by the finer ones at each refinement step. Application of this additional refinement, where needed, can reduce an excessive function overlapping and improve the stiffness matrix conditioning and sparsity. However, due to the unnecessary extension of the refined zone, the optimal rate of convergence can be lost. In practice, we did not observe a significant advantage of this approach, and taking into account its computational cost, we do not apply this strategy in the computational examples presented in this paper. Moreover, it was observed that for a large variety of problems, the excessive support overlapping is avoided naturally after various refinement steps due to the behavior of the error indicator.

On the other hand, another possible solution for this problem is a more accurate and selective definition of the function supports in order to obtain a space with better support locality. The strategy we propose in this paper can be improved by including more sophisticated rules for inferring function supports, but that would probably lead to a more expensive implementation.

In this section we present computational examples of the application of our technique in geometric design and analysis for problems involving adaptive refinement. The proposed method is tested by performing surface interpolation and resolution of 2D and 3D Poisson problems using IGA.

Here we construct a spline representation of a surface given by a triangulation. First, a global parameterization of the surface triangulation is obtained by means of the method proposed by M. Floater in  [19]. As a result, we have one-to-one mapping from planar triangulation of the parametric domain (unit square) to the surface triangulation. Then, a quadtree T-mesh adapted to the planar triangulation is constructed. For this purpose we have chosen the following simple criterion. We start from a coarse T-mesh and refine it until each cell of the mesh contains no more than a certain number of points of the input triangulation (3 in our case). The spline approximation of the surface is built as a linear combination of our blending functions 
                           
                              
                                 S
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       α
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       α
                                    
                                 
                                 
                                 
                                    
                                       N
                                    
                                    
                                       α
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

The control points 
                           
                              
                                 C
                              
                              
                                 α
                              
                           
                         are found by imposing the interpolation conditions 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       β
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       α
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       α
                                    
                                 
                                 
                                 
                                    
                                       N
                                    
                                    
                                       α
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       
                                          β
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 ∀
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    
                                       β
                                    
                                 
                                 ,
                                 
                                 β
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    ξ
                                 
                              
                              
                                 β
                              
                           
                         are interpolation points in the parametric domain and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 β
                              
                           
                         are their images in the physical space determined by the triangular parameterization. As interpolation points we use the anchors of the functions, i.e., the regular nodes of the T-mesh, and some additional interpolation points associated to functions whose local knot vectors contain repeated knots on the boundary. These additional points are situated at the midpoint of the edges that have contact with the boundary and coincide approximately with the maximum point of the corresponding blending functions. See  [20] for more details.

The resulting spline surface, parametric T-mesh and input surface triangulation are shown in Fig. 12
                        .

In this example we interpolate the function 
                           
                              (3)
                              
                                 u
                                 
                                    (
                                    r
                                    )
                                 
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         defined on the square domain 
                           
                              
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 2
                              
                           
                        , being 
                           r
                           =
                           
                              
                                 
                                    
                                       
                                          (
                                          x
                                          −
                                          0.5
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          y
                                          −
                                          0.5
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        .

The spline approximation of the surface (3) is built as a linear combination of our blending functions 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       α
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       α
                                    
                                 
                                 
                                 
                                    
                                       N
                                    
                                    
                                       α
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

And the control points 
                           
                              
                                 C
                              
                              
                                 α
                              
                           
                         are found by imposing the interpolation conditions
                           
                              
                                 u
                                 
                                    (
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       
                                          β
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       α
                                       ∈
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       α
                                    
                                 
                                 
                                 
                                    
                                       N
                                    
                                    
                                       α
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       
                                          β
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 ∀
                                 
                                    
                                       
                                          ξ
                                       
                                    
                                    
                                       β
                                    
                                 
                                 ,
                                 
                                 β
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     

Adaptive refinement is performed according to the indicator based on exact 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         interpolation error: 
                           
                              
                                 η
                                 
                                    
                                       
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                e
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          u
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          u
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    d
                                 
                                 Ω
                                 .
                              
                           
                        
                     

A cell 
                           
                              
                                 Ω
                              
                              
                                 e
                              
                           
                         is marked to be refined if 
                           η
                           
                              (
                              
                                 
                                    Ω
                                 
                                 
                                    e
                                 
                              
                              )
                           
                           >
                           γ
                           
                           
                              
                                 max
                              
                              
                                 i
                              
                           
                           
                              {
                              η
                              
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              }
                           
                        , being 
                           γ
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        .

Some steps of adaptive refinement for the surface interpolation (3) are shown in Fig. 13
                        , and Fig. 14
                         illustrates the convergence in 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        -norm and 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        -seminorm.

In this subsection we present an example of the resolution of a Poisson problem on a square domain 
                           Ω
                           =
                           
                              
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 2
                              
                           
                         using isogeometric analysis. Let us consider the problem 
                           
                              (4)
                              
                                 
                                    
                                       
                                          −
                                          △
                                          u
                                          =
                                          f
                                       
                                       
                                          in  
                                          Ω
                                          ,
                                       
                                    
                                    
                                       
                                          u
                                          =
                                          g
                                       
                                       
                                          on  
                                          ∂
                                          Ω
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Its variational formulation consists in finding 
                           u
                           ∈
                           
                              
                                 V
                              
                              
                                 g
                              
                           
                           
                              (
                              Ω
                              )
                           
                         such that 
                           
                              
                                 a
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    (
                                    f
                                    ,
                                    v
                                    )
                                 
                                 
                                 ∀
                                 v
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    Ω
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 a
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 ∇
                                 u
                                 ⋅
                                 ∇
                                 v
                                 
                                 
                                    d
                                 
                                 Ω
                                 
                                 and
                                 
                                 
                                    (
                                    f
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 f
                                 
                                 v
                                 
                                 
                                    d
                                 
                                 Ω
                                 .
                              
                           
                        
                     

The test function space is 
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    Ω
                                    )
                                 
                                 =
                                 
                                    {
                                    v
                                    ∈
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    :
                                    v
                                    
                                       
                                          ∣
                                       
                                       
                                          ∂
                                          Ω
                                       
                                    
                                    =
                                    0
                                    }
                                 
                                 ,
                              
                           
                         and the solution space is 
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       g
                                    
                                 
                                 
                                    (
                                    Ω
                                    )
                                 
                                 =
                                 
                                    {
                                    v
                                    ∈
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    :
                                    v
                                    
                                       
                                          ∣
                                       
                                       
                                          ∂
                                          Ω
                                       
                                    
                                    =
                                    g
                                    }
                                 
                                 .
                              
                           
                        
                     

Let 
                           T
                         be a T-mesh of 
                           Ω
                        . Then we denote with 
                           
                              
                                 V
                              
                              
                                 T
                              
                           
                           
                              (
                              Ω
                              )
                           
                         the finite dimensional space spanned by the spline blending functions defined over 
                           T
                        , and with 
                           
                              
                                 V
                              
                              
                                 
                                    
                                       g
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 T
                              
                           
                           
                              (
                              Ω
                              )
                           
                         the subspace of functions of 
                           
                              
                                 V
                              
                              
                                 T
                              
                           
                           
                              (
                              Ω
                              )
                           
                         that are equal to 
                           
                              
                                 g
                              
                              
                                 T
                              
                           
                         at the boundary, where 
                           
                              
                                 g
                              
                              
                                 T
                              
                           
                         is an interpolant of 
                           g
                        .

The isogeometric approximation consists in finding 
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                           ∈
                           
                              
                                 V
                              
                              
                                 
                                    
                                       g
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 T
                              
                           
                           
                              (
                              Ω
                              )
                           
                         such that 
                           
                              
                                 a
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          h
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    f
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          h
                                       
                                    
                                    )
                                 
                                 
                                 ∀
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       0
                                       ,
                                       T
                                    
                                 
                                 
                                    (
                                    Ω
                                    )
                                 
                                 .
                              
                           
                        
                     

The problem (4) is set up in such a way that its analytical solution is a function with singularities taken from  [12] and given by 
                           
                              (5)
                              
                                 u
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 exp
                                 
                                    (
                                    −
                                    7
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   0.5
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   0.5
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 exp
                                 
                                    (
                                    −
                                    7
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   0.25
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   0.25
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 exp
                                 
                                    (
                                    −
                                    7
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   0.75
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   0.75
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

We perform an adaptive refinement based on an a posteriori error indicator to improve the quality of the numerical solution. We have chosen a simple residual-type error estimator given by 
                           
                              
                                 η
                                 
                                    
                                       
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                e
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          h
                                          
                                             (
                                             f
                                             +
                                             
                                                Δ
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                          
                                          ‖
                                       
                                    
                                    
                                       0
                                       ,
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          (
                                          f
                                          +
                                          
                                             Δ
                                          
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    d
                                 
                                 Ω
                                 ,
                              
                           
                         where 
                           h
                         is the diameter of the cell 
                           
                              
                                 Ω
                              
                              
                                 e
                              
                           
                        . The estimator is jump free through the cell interfaces because of the smoothness of the isogeometric approximation. A cell 
                           
                              
                                 Ω
                              
                              
                                 e
                              
                           
                         is marked to be refined if 
                           η
                           
                              (
                              
                                 
                                    Ω
                                 
                                 
                                    e
                                 
                              
                              )
                           
                           >
                           γ
                           
                           
                              
                                 max
                              
                              
                                 i
                              
                           
                           
                              {
                              η
                              
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              }
                           
                        , being 
                           γ
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        .

During the assembly process we accomplish the numerical integration on each element (cell) of the mesh, therefore it should be taken into account that for exact integration results (when possible) the numerical integration should be performed on each Bezier element, that is, on the subregion of the cell where the blending functions are pure polynomials. For our balanced quadtree meshes it implies to subdivide some cells in 2 or 4 subelements. However, taking into account the smoothness of the functions across the subelements boundary, more efficient quadrature rules can be used. For example, in  [21] authors propose a numerical procedure to compute weights and points of quadrature rules on macro elements. These rules are exact for blending functions and efficient in the sense that requires less evaluations than classical Gauss rules on each element.

Some steps of adaptive refinement for the problem (4) and the numerical solution corresponding to the final refinement iteration are shown in Fig. 15
                        . The convergence behavior of the adaptive refinement in 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        -norm and 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        -seminorm is shown in Fig. 16
                        (a) and (b). The evolution of the density of the stiffness matrix 
                           A
                        , its condition number and the comparison of these values for an uniform refinement are represented in Fig. 16(c) and (d), respectively. The density of the matrix 
                           A
                         is the fraction of non-zero elements and the condition number is defined as 
                           κ
                           
                              (
                              A
                              )
                           
                           =
                           
                              
                                 
                                    ‖
                                    A
                                    ‖
                                 
                              
                              
                                 2
                              
                           
                           
                           
                              
                                 
                                    ‖
                                    
                                       
                                          A
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ‖
                                 
                              
                              
                                 2
                              
                           
                        .

In the next example, we present the result of the resolution of a Poisson problem on a complex domain. We denote by 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                           =
                           
                              
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 2
                              
                           
                         the parametric domain and by 
                           Ω
                         the physical or computational domain. Now the spline blending functions are defined over a mesh 
                           T
                         of the parametric domain. Given 
                           Ω
                        , we build a one to one parametric transformation 
                           
                              S
                           
                        , that maps 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                         to 
                           Ω
                        , i.e. 
                           
                              S
                           
                           :
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                           →
                           Ω
                        , using the algorithm described in our previous work  [20]. This technique, based on a T-mesh untangling and optimization procedure, allows us to obtain a good quality parameterization suitable for application of IGA. The procedure is an extension of the ideas presented in our works  [22–25]. Another method for parameterization of computational domain, based on pillowing technique, was given in  [26,27].

The mean ratio Jacobian is used to evaluate the quality of the parameterization in the sense of its orthogonality and uniformity. Fig. 17
                        (a) and (b) show the colormap of the parameterization quality for our parametric and physical domains. It should be mentioned that for all numerical examples the parameterization of the computational domain is performed using the same blending functions that are used for the solution approximation, so isoparametric concepts holds during isogeometric analysis. That is, if 
                           
                              
                                 V
                              
                              
                                 T
                              
                           
                           
                              (
                              
                                 
                                    Ω
                                 
                                 
                                    ̂
                                 
                              
                              )
                           
                         is the finite dimensional space spanned by the spline functions associated to a parametric mesh 
                           T
                        , then the parametric mapping 
                           
                              S
                           
                         is constructed as a linear combination of functions from 
                           
                              
                                 V
                              
                              
                                 T
                              
                           
                           
                              (
                              
                                 
                                    Ω
                                 
                                 
                                    ̂
                                 
                              
                              )
                           
                         and the discrete approximation space 
                           
                              
                                 V
                              
                              
                                 T
                              
                           
                           
                              (
                              Ω
                              )
                           
                         in physical domain is defined as follows: 
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       T
                                    
                                 
                                 
                                    (
                                    Ω
                                    )
                                 
                                 =
                                 
                                    {
                                    v
                                    ∈
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    :
                                    v
                                    =
                                    
                                       
                                          v
                                       
                                       
                                          ̂
                                       
                                    
                                    ∘
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ,
                                      for all  
                                    
                                       
                                          v
                                       
                                       
                                          ̂
                                       
                                    
                                    ∈
                                    
                                       
                                          V
                                       
                                       
                                          T
                                       
                                    
                                    
                                       (
                                       
                                          
                                             Ω
                                          
                                          
                                             ̂
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

Now we consider a Poisson problem with the Dirichlet boundary condition on 
                           Ω
                        , which exact solution is a function with steep wave front given by 
                           
                              
                                 u
                                 
                                    (
                                    r
                                    )
                                 
                                 =
                                 arctan
                                 
                                    (
                                    α
                                    
                                       (
                                       r
                                       −
                                       
                                          
                                             r
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           r
                           =
                           
                              
                                 
                                    
                                       
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                c
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , the parameter 
                           α
                         determines the steepness of the wave front and 
                           
                              
                                 r
                              
                              
                                 0
                              
                           
                         is its location. In this example 
                           α
                           =
                           200
                         and 
                           
                              
                                 r
                              
                              
                                 0
                              
                           
                           =
                           0.6
                        . The center of the wave front 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    c
                                 
                              
                              )
                           
                           =
                           
                              (
                              0
                              ,
                              0
                              )
                           
                         is situated outside our computational domain, so the function is smooth in 
                           Ω
                        . The numerical solution of the problem and the mesh corresponding to the final refinement iteration is shown in Fig. 18
                        . As expected, the error estimator has marked for refinement the zone of the wave front. The evolution of the exact error in 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        -norm and 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                        -seminorm are shown in Fig. 19
                        .

The next computational example is the resolution of a 3D Poisson problem using IGA. The computational domain is a spline approximation of a sphere portion, see Fig. 20
                        . The initial uniform mesh was composed of 4×4×4 cells. The approximation is constructed using our spline blending function. The Poisson problem with Dirichlet boundary condition is set up so that the analytical solution of the problem is 
                           
                              
                                 u
                                 
                                    (
                                    r
                                    )
                                 
                                 =
                                 sin
                                 
                                    (
                                    
                                       
                                          1
                                       
                                       
                                          α
                                          +
                                          r
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           r
                           =
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         and parameter 
                           α
                           =
                           1
                           /
                           10
                           π
                        . This is a smooth function with an oscillation near the origin. Results of the final refinement iteration are shown in Fig. 20. The convergence behavior of the adaptive refinement is illustrated in Fig. 21
                        .

In this paper we have proposed a strategy for defining 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -continuous cubic tensor product spline functions over quadtree and octree T-meshes. We only demand these T-meshes to be 0-balanced and this requirement can be easily satisfied by using a standard balancing procedure. The proposed strategy includes simple instructions used for inferring local knot vectors to define blending functions. We conjecture that the resulting spline spaces have nice properties: linear independence and the characteristic that spaces spanned by nested T-meshes are also nested. The above mentioned properties were verified in numerous numerical experiments and we plan to provide a rigorous proof in our next work.

The implementation of our technique is straightforward taking into account the balance mesh restriction. Examples of adaptive refinement using IGA for 2D and 3D Poisson problems have been presented. In all of them, optimal rates of convergence have been obtained. We believe that the simplicity of our technique can make it an attractive tool for its application in IGA and geometric design.

In future works we also plan to improve the strategy obtaining a better locality of the function supports.

@&#ACKNOWLEDGMENTS@&#

This work has been supported by the Spanish Government, “Secretaría de Estado de Universidades e Investigación,” “Ministerio de Economía y Competitividad”, “Programa de FPU del Ministerio de Educación, Cultura y Deporte”, “Programa de FPI propio de la ULPGC” and FEDER, grant contracts: CGL2011-29396-C03-01 and CGL2011-29396-C03-03; “Junta Castilla León,” grant contract: SA266A12-2. It has also been supported by CONACYT-SENER (“Fondo Sectorial CONACYT SENER HIDROCARBUROS”, grant contract: 163723).

Here we include an outline of the proof (2D case) of the nestedness of the spline spaces constructed via our strategy.

It is worth noting that the rules we propose and the 0-balanced restriction for the mesh lead to a very few number of all possible function supports that can be defined over a T-mesh. In order to prove the nestedness of the spaces for any two nested T-meshes 
                        
                           
                              T
                           
                           
                              1
                           
                        
                        ⊂
                        
                           
                              T
                           
                           
                              2
                           
                        
                     , we should verify that any blending function of 
                        
                           
                              S
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                           
                        
                      can be represented as linear combination of blending functions from 
                        
                           
                              S
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                           
                        
                     . To this end, we have to perform this verification for all types of function supports and for any possible mesh configuration. Applying some reasoning, it is easy to see that this verification can be reduced to a few number of basic cases. Firstly, to simplify the process, we assume that for any two 0-balanced meshes 
                        
                           
                              T
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              2
                           
                        
                      such that 
                        
                           
                              T
                           
                           
                              1
                           
                        
                        ⊂
                        
                           
                              T
                           
                           
                              2
                           
                        
                      there exists a sequence of meshes 
                        
                           
                              
                                 {
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       e
                                    
                                 
                                 }
                              
                           
                           
                              i
                              =
                              1
                              ,
                              n
                           
                        
                      such that


                     
                        
                           (i)
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                    
                                       e
                                    
                                 
                                 ⊂
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 ⊂
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                    
                                       e
                                    
                                 
                                 ⊂
                                 ⋯
                                 ⊂
                                 
                                    
                                       T
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                    
                                       e
                                    
                                 
                                 ⊂
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                              ,

any mesh 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       e
                                    
                                 
                               is obtained from mesh 
                                 
                                    
                                       T
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                    
                                       e
                                    
                                 
                               by refining only one cell,

all the meshes 
                                 
                                    
                                       
                                          {
                                          
                                             
                                                T
                                             
                                             
                                                i
                                             
                                             
                                                e
                                             
                                          
                                          }
                                       
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       n
                                    
                                 
                               are 0-balanced.

A pair of 0-balanced meshes 
                        
                           
                              T
                           
                           
                              2
                           
                           
                              e
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              1
                           
                           
                              e
                           
                        
                      is called elemental refinement if 
                        
                           
                              T
                           
                           
                              2
                           
                           
                              e
                           
                        
                      is obtained from 
                        
                           
                              T
                           
                           
                              1
                           
                           
                              e
                           
                        
                      by refining only one cell, see Fig. 22
                     . Since it is sufficient to verify the nestedness of spaces for any elemental refinement, from now on we assume that 
                        
                           
                              T
                           
                           
                              1
                           
                        
                        ⊂
                        
                           
                              T
                           
                           
                              2
                           
                        
                      is an elemental refinement. We have to verify that, after refining a cell, the blending functions of the new space 
                        
                           
                              S
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                           
                        
                      are able to represent any blending function of the previous space 
                        
                           
                              S
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                           
                        
                     . The proof can be divided in two steps. First, we analyze some basic cases corresponding to the simplest mesh configuration, then, more general mesh configuration should be considered applying some recursivity idea to prove the nestedness of spaces for arbitrary elemental refinement.

To make the necessary studies more graphic, first, we classify all function supports that can take place according to our strategy. Then, we study for each type all possible situations when a cell refinement affects this type function support.


                     Classification of function supports
                  

Let us consider any knot vector 
                        Ξ
                        =
                        
                           (
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 5
                              
                           
                           )
                        
                      and let 
                        
                           
                              Δ
                           
                           
                              i
                           
                           
                              ξ
                           
                        
                        =
                        
                           
                              ξ
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        
                           
                              ξ
                           
                           
                              i
                           
                        
                        ,
                        
                        i
                        =
                        1
                        ,
                        …
                        ,
                        4
                     ., so that, a set 
                        
                           
                              Δ
                           
                           
                              ξ
                           
                        
                        =
                        
                           (
                           
                              
                                 Δ
                              
                              
                                 
                                    1
                                 
                              
                              
                                 ξ
                              
                           
                           ,
                           
                              
                                 Δ
                              
                              
                                 
                                    2
                                 
                              
                              
                                 ξ
                              
                           
                           ,
                           
                              
                                 Δ
                              
                              
                                 
                                    3
                                 
                              
                              
                                 ξ
                              
                           
                           ,
                           
                              
                                 Δ
                              
                              
                                 
                                    4
                                 
                              
                              
                                 ξ
                              
                           
                           )
                        
                      corresponds to each knot vector 
                        Ξ
                     . Due to the Extension rule 1 and the balanced mesh condition we have the following possible configurations for the set 
                        
                           
                              Δ
                           
                           
                              ξ
                           
                        
                     : 
                        
                           (
                           h
                           ,
                           h
                           ,
                           h
                           ,
                           h
                           )
                        
                     , 
                        
                           (
                           h
                           ,
                           h
                           ,
                           h
                           ,
                           2
                           h
                           )
                        
                     , 
                        
                           (
                           2
                           h
                           ,
                           h
                           ,
                           h
                           ,
                           h
                           )
                        
                      and 
                        
                           (
                           2
                           h
                           ,
                           h
                           ,
                           h
                           ,
                           2
                           h
                           )
                        
                     , see Fig. 23
                     (a). All possible bivariate function supports are obtained by combining all configurations for 
                        Ξ
                      and 
                        H
                     , i.e., combining two sets 
                        
                           
                              Δ
                           
                           
                              ξ
                           
                        
                      and 
                        
                           
                              Δ
                           
                           
                              η
                           
                        
                     . Note that since we ignore the hanging nodes while inferring two knot vectors, the value of 
                        h
                      is the same for 
                        
                           
                              Δ
                           
                           
                              ξ
                           
                        
                      and 
                        
                           
                              Δ
                           
                           
                              η
                           
                        
                     , i.e., 
                        h
                        =
                        
                           
                              Δ
                           
                           
                              2
                           
                           
                              ξ
                           
                        
                        =
                        
                           
                              Δ
                           
                           
                              3
                           
                           
                              ξ
                           
                        
                        =
                        
                           
                              Δ
                           
                           
                              2
                           
                           
                              η
                           
                        
                        =
                        
                           
                              Δ
                           
                           
                              3
                           
                           
                              η
                           
                        
                      and the value of 
                        h
                      determines the level of a function. A blending function is said to be of level 
                        m
                      if the largest cell contacting its anchor is of level 
                        m
                     , see Fig. 23(b).

Also, we can distinguish different function supports according to the underlying local mesh that leads to this support. Basically, it depends on the position of the anchor of the function, see Fig. 24
                     . Scenario (a) the anchor of the 
                        m
                     -level function coincides with the center of a 
                        
                           (
                           m
                           −
                           1
                           )
                        
                     -level cell of the quadtree, scenario (b) the rest of the functions, i.e., the anchor of the 
                        m
                     -level function does not correspond to any center of a 
                        
                           (
                           m
                           −
                           1
                           )
                        
                     -level cell of the quadtree.

Finally, taking into account all the above considerations about values of 
                        
                           
                              Δ
                           
                           
                              ξ
                           
                        
                      and 
                        
                           
                              Δ
                           
                           
                              η
                           
                        
                      and the underlying local mesh, we can classify all function supports in nine types that are illustrated in Fig. 25
                     . First six types correspond to scenario (a) and the other three types correspond to scenario (b). Note that type 6 and type 9 function supports can be considered as the same type, although they come from different scenarios. Function supports with repeated knots across the domain boundary can be included in the nine types shown in Fig. 25.

Next, we have to see how an elemental refinement can affect a function support of each type. As it was said before, the proof of the nestedness can be reduced to the proof of nestedness for some basic cases.


                     Function recuperation for the basic cases
                  

For each support type, we have to analyze all possible elemental refinements that affect this function and verify that the blending functions of the finer mesh are able to reproduce the function under consideration. Let us see in detail an example of this study.

Here we illustrate type 2 function support. This type of function support has the largest number of cases to study. Namely, we should study four different situations that take place after a cell refinement. In these situations the original type 2 function 
                        
                           
                              N
                           
                           
                              0
                           
                        
                      associated to the anchor 
                        
                           
                              
                                 v
                              
                           
                           
                              0
                           
                        
                      is not a blending function of the new space 
                        
                           
                              S
                           
                           
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                           
                        
                     . The new function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              0
                           
                        
                      associated to 
                        
                           
                              
                                 v
                              
                           
                           
                              0
                           
                        
                      can be type 3, 4, 5 or 1, as shown below.


                     Type 2 to type 3. In this case, type 2 function 
                        
                           
                              N
                           
                           
                              0
                           
                        
                      of level 
                        m
                      can be recuperated by two new functions of the same level: type 3 function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              0
                           
                        
                      and type 7 function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              1
                           
                        
                     . Only one of local knot vectors undergoes a knot insertion. Without loss of generality, suppose that a new knot 
                        
                           
                              ξ
                           
                           
                              ˆ
                           
                        
                      is inserted between the fourth and the fifth knot of 
                        Ξ
                     , see Fig. 26
                     (a). Then, using the knot insertion formula, it is easy to see that 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 ξ
                                 ,
                                 η
                                 )
                              
                              =
                              B
                              
                                 [
                                 Ξ
                                 ]
                              
                              B
                              
                                 [
                                 H
                                 ]
                              
                              =
                              B
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              B
                              
                                 [
                                 H
                                 ]
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              B
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              B
                              
                                 [
                                 H
                                 ]
                              
                              =
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              Ξ
                           
                           
                              1
                           
                        
                        =
                        
                           (
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           )
                        
                      and 
                        
                           
                              Ξ
                           
                           
                              2
                           
                        
                        =
                        
                           (
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 5
                              
                           
                           )
                        
                     .


                     Type 2 to type 4. Function 
                        
                           
                              N
                           
                           
                              0
                           
                        
                      is split into two new functions of the same level: type 4 function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              0
                           
                        
                      and type 8 function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              1
                           
                        
                     . Local knot vector 
                        H
                      undergoes a knot insertion. A new knot 
                        
                           
                              η
                           
                           
                              ˆ
                           
                        
                      is inserted in its local knot vector 
                        H
                        =
                        
                           (
                           
                              
                                 η
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 5
                              
                           
                           )
                        
                      between the fourth and the fifth knot, see Fig. 26(b). Then 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 ξ
                                 ,
                                 η
                                 )
                              
                              =
                              B
                              
                                 [
                                 Ξ
                                 ]
                              
                              B
                              
                                 [
                                 H
                                 ]
                              
                              =
                              B
                              
                                 [
                                 Ξ
                                 ]
                              
                              B
                              
                                 [
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              B
                              
                                 [
                                 Ξ
                                 ]
                              
                              B
                              
                                 [
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              =
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              H
                           
                           
                              1
                           
                        
                        =
                        
                           (
                           
                              
                                 η
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 ˆ
                              
                           
                           )
                        
                      and 
                        
                           
                              H
                           
                           
                              2
                           
                        
                        =
                        
                           (
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 5
                              
                           
                           )
                        
                     .


                     Type 2 to type 5. For this case both local knot vectors undergo a knot insertion. New knot 
                        
                           
                              ξ
                           
                           
                              ˆ
                           
                        
                      is inserted between the fourth and the fifth knot of 
                        Ξ
                      and knot 
                        
                           
                              η
                           
                           
                              ˆ
                           
                        
                      is inserted between the fourth and the fifth knot of 
                        H
                     , see Fig. 26(c). Then function 
                        
                           
                              N
                           
                           
                              0
                           
                        
                      is split into four functions of the same level: type 5 function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              0
                           
                        
                     , type 8 function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              1
                           
                        
                     , type 9 function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              2
                           
                        
                      and type 9 (or 6) function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              3
                           
                        
                     . 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 ξ
                                 ,
                                 η
                                 )
                              
                              =
                              B
                              
                                 [
                                 Ξ
                                 ]
                              
                              B
                              
                                 [
                                 H
                                 ]
                              
                              =
                              
                                 (
                                 B
                                 
                                    [
                                    
                                       
                                          Ξ
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 B
                                 
                                    [
                                    
                                       
                                          Ξ
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 )
                              
                              
                                 (
                                 B
                                 
                                    [
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 B
                                 
                                    [
                                    
                                       
                                          H
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 )
                              
                              =
                              B
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              B
                              
                                 [
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              B
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              B
                              
                                 [
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              B
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              B
                              
                                 [
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    16
                                 
                              
                              B
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              B
                              
                                 [
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              =
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    16
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    3
                                 
                              
                           
                        
                      where 
                        
                           
                              H
                           
                           
                              1
                           
                        
                        =
                        
                           (
                           
                              
                                 η
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 ˆ
                              
                           
                           )
                        
                     , 
                        
                           
                              H
                           
                           
                              2
                           
                        
                        =
                        
                           (
                           
                              
                                 η
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 η
                              
                              
                                 5
                              
                           
                           )
                        
                     , 
                        
                           
                              Ξ
                           
                           
                              1
                           
                        
                        =
                        
                           (
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           )
                        
                      and 
                        
                           
                              Ξ
                           
                           
                              2
                           
                        
                        =
                        
                           (
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 5
                              
                           
                           )
                        
                     .


                     Type 2 to type 1. In this case, due to Extension rule 2, the support of a function becomes larger after a cell refinement, see Fig. 26(d). Using knot insertion formula, it is easy to see that 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              0
                           
                        
                        =
                        
                           
                              N
                           
                           
                              0
                           
                        
                        +
                        
                           
                              1
                           
                           
                              4
                           
                        
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              1
                           
                        
                     . So, the original function 
                        
                           
                              N
                           
                           
                              0
                           
                        
                      can be recuperated by two new functions: type 1 function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              0
                           
                        
                      and type 7 function 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              1
                           
                        
                      as follows 
                        
                           
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 ξ
                                 ,
                                 η
                                 )
                              
                              =
                              B
                              
                                 [
                                 Ξ
                                 ]
                              
                              B
                              
                                 [
                                 H
                                 ]
                              
                              =
                              B
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              
                                 (
                                 ξ
                                 )
                              
                              B
                              
                                 [
                                 H
                                 ]
                              
                              −
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              B
                              
                                 [
                                 
                                    
                                       Ξ
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              
                                 (
                                 ξ
                                 )
                              
                              B
                              
                                 [
                                 H
                                 ]
                              
                              =
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              −
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                           
                        
                      where 
                        
                           
                              Ξ
                           
                           
                              1
                           
                        
                        =
                        
                           (
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 4
                              
                           
                           )
                        
                      and 
                        
                           
                              Ξ
                           
                           
                              2
                           
                        
                        =
                        
                           (
                           
                              
                                 ξ
                              
                              
                                 ˆ
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 5
                              
                           
                           )
                        
                     .

For the rest of the function supports the necessary verifications are carried out in an analogous way. The graph given in Fig. 27
                      reflects the relation between different function types and the number of situations to study for each type. More specifically, an arrow coming out of a circle with type 
                        X
                      and pointing to another type 
                        Y
                      means that a type 
                        X
                      function can turn into the type 
                        Y
                      new function associated to the same anchor after a cell refinement. For example, there are four arrows coming out of type 2 function, in line with the four studied cases.

@&#REFERENCES@&#

