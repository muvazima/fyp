@&#MAIN-TITLE@&#Right ventricular segmentation in cardiac MRI with moving mesh correspondences

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We propose a semi-automatic segmentation method for right ventricular segmentation.


                        
                        
                           
                           The method removes the need for a time-consuming, manually built training set.


                        
                        
                           
                           The method does not make prior assumptions as to the intensity distributions or shape.


                        
                        
                           
                           The method is flexible for congenital heart disease where the RV undergoes high variations in shape.


                        
                        
                           
                           Evaluations over a RV challenge data and HLHS patient data show the robustness of the method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Right ventricular function

Segmentation

Moving mesh

Grid generation

Magnetic resonance imaging

Ejection fraction

@&#ABSTRACT@&#


               
               
                  This study investigates automatic propagation of the right ventricle (RV) endocardial and epicardial boundaries in 4D (3D+time) magnetic resonance imaging (MRI) sequences. Based on a moving mesh (or grid generation) framework, the proposed algorithm detects the endocardium and epicardium within each cardiac phase via point-to-point correspondences. The proposed method has the following advantages over prior RV segmentation works: (1) it removes the need for a time-consuming, manually built training set; (2) it does not make prior assumptions as to the intensity distributions or shape; (3) it provides a sequence of corresponding points over time, a comprehensive input that can be very useful in cardiac applications other than segmentation, e.g., regional wall motion analysis; and (4) it is more flexible for congenital heart disease where the RV undergoes high variations in shape. Furthermore, the proposed method allows comprehensive RV volumetric analysis over the complete cardiac cycle as well as automatic detections of end-systolic and end-diastolic phases because it provides a segmentation for each time step. Evaluated quantitatively over the 48-subject data set of the MICCAI 2012 RV segmentation challenge, the proposed method yielded an average Dice score of 0.84±0.11 for the epicardium and 0.79±0.17 for the endocardium. Further, quantitative evaluations of the proposed approach in comparisons to manual contours over 23 infant hypoplastic left heart syndrome patients yielded a Dice score of 0.82±0.14, which demonstrates the robustness of the algorithm.
               
            

@&#INTRODUCTION@&#

Right ventricular (RV) failure can have numerous aetiologies, which include pulmonary hypertension, cardiomyopathy, myocardial infarction, congenital heart disease, and sepsis [1]. Although clinically evidenced with several studies [2,3], the importance of RV analysis was overlooked in the last decade. Andersen et al. [2] showed that up to 50% of all regional infarcts are RV related. Cor pulmonale, the enlargement of the RV due to pulmonary hypertension, is the third most common cause of cardiac dysfunction in patients over the age of 50 [3]. RV analysis is much more complicated than LV analysis, and its clinical assessments are more labour-intensive. Both ventricles are composed of multiple layers that form a 3D network of fibres. However, the shape of the RV is more complex. It generally appears triangular when viewed longitudinally and crescent-shaped when observed from the short-axis view, whereas the LV is ellipsoidal. RV shortening is larger longitudinally than radially [4], and the RV has a wall much thinner than the LV as it ejects blood against approximately 25% of the LV after-load [5].

Early detection and analysis of the RV dysfunction are helpful in identifying RV dysfunction prior to progression of RV failure. For instance, untreated pulmonary arterial hypertension may evolve rapidly and, therefore, can lead to RV failure and death, with a median survival time of less than 3 years after the diagnosis [6]. The current state-of-the-art solutions in imaging provide an excellent tool for detecting abnormalities in RV function. Magnetic Resonance Imaging (MRI) is considered as the current gold standard for non-invasive anatomical and functional assessment of the RV; it allows detailed RV evaluation [1]. Cardiac MRI is used to evaluate the right ventricle in a number of congenital heart conditions [7] and in pulmonary artery hypertension [8]. MRI has several important advantages over echocardiography. These include excellent image quality, lack of geometric assumptions, no endocardial dropout, and no foreshortening of the apex. Clinical measurements such as the RV ejection fraction (RVEF) and volumes have important diagnostic, prognostic and therapeutic implications for patients with acquired heart disease, particularly those who need cardiac function follow-up [9,10]. For quantitative functional analysis, and to obtain clinical measurements such as volume or RVEF, it is essential to delineate the RV. Manual delineation of the RV boundaries in all magnetic resonance (MR) images
                        1
                     
                     
                        1
                        Typically, the number of images per subject is equal to 200.
                      is tedious and time-consuming. Therefore, it is a common clinical practice to delineate the RV boundaries only in end diastolic and end systolic phases. Automating the process has bestirred a significant research attention recently, and has been the subject of a Medical Image Computing and Computer Assisted Intervention (MICCAI) 2012 RV Segmentation Challenge (RVSC) [11–19].

Due to its complex morphology and function, RV segmentation in 3D+time is acknowledged more challenging than LV segmentation [4,20]. Most of the research efforts in the last decade focused on the LV [21–27]. RV segmentation remains an unsolved problem, with difficulties arising from the thin and ill-defined borders of the RV, its crescent-shaped structure and its complex deformations over time. Another problem associated with RV border detection is the presence of adjacent epicardial fat, which blurs the anterior margins of the RV [4]. Furthermore, RV segmentation methods need to consider the intensity similarities between different connected cardiac regions. For instance, the papillary muscles and heart wall have approximately the same intensity profiles. Therefore, standard segmentation methods based solely on intensity information cannot yield accurate results. To overcome these difficulties, most of the existing methods use either atlas-based techniques [11,15,18,28–30] or prior geometric properties [12,17,31–33], e.g., the shape of the RV is learned a priori from a finite training set. The main drawbacks of shape or atlas based approaches are (1) the requirement for large, manually segmented training sets; and (2) the high dependence of the results on the specific choice of a training set, which can lead to biases towards a particular cardiac pathology or towards the properties of normal subjects, e.g., the mean RV shape within the training data. The shape of the RV and its position relative to the LV may vary significantly from one subject to another (Refer to Fig. 1
                      for a typical RV and the RV of a hypoplastic left heart syndrome patient (HLHS)). HLHS is a congenital heart malformation, where the structures of the left side of the heart are underdeveloped or too small. The initial surgical palliation causes the RV to pump blood to the entire body and the lungs. Assessing the RV in MRI prior to further surgery is important but is difficult in the case of patients that are young infants. Methods that rely on the spatial correspondences between the LV and RV may not be accurate for diseased hearts because such correspondences may vary significantly. For example, the method in [34] assumes that the RV is to the left of, and generally above, the LV. This assumption may not be true for HLHS patients such as the one depicted in Fig. 1(b), where the LV is very small and the RV occupies a position different than usual.

The shape of the RV might be considerably different at end-systole in comparison to end-diastole. Therefore, in general, shape-based approaches have difficulty in capturing the RV at end-systole. The results published by the recent RVSC at the MICCAI 2012 conference confirm this. These results show that most of the existing methods have the highest segmentation error at end-systole [11–15,17,18]. The best reported Dice Metric (DM) values among the seven participants were 0.72 and 0.77 for endocardium and epicardium, respectively. Due to its smaller size, inaccuracies in the segmentation of the RV at end-systole affect the value of clinical measurements such as the RVEF.

To tackle the problem of 4D (3D+time) data sets, we propose a semi-automatic approach based on a moving mesh (or grid generation) framework. Given a user-provided segmentation of a single frame in a cardiac sequence, the proposed method segments both endocardial and epicardial borders of the RV via point-to-point correspondences (Refer to Fig. 3). The proposed method allows comprehensive RV volumetric analysis over the complete cardiac cycle as well as automatic detections of end-systolic and end-diastolic phases because it provides segmentation for each time step.

Our method is related to propagation/registration frameworks, which have been used previously for tracking the left ventricular boundaries. An example is the work in [35,36], which optimises a sum of energy terms consisting of a squared L
                     2 norm and a Sobolev smoothing term. Based on the concept of equivalent volume elements of a compact Riemannian manifold [37] and yielding a unique solution by solving an div-curl system, the proposed moving mesh approach is fundamentally different from [35,36]: The proposed moving mesh prevents mesh folding, i.e., grid lines of the same grid family will not cross each other, an essential attribute in tracking cardiac tissues from a sequence of images. Furthermore, it allows setting explicitly the minimum and maximum values for the compressibility of the mesh, which can be used to imitate cardiac tissue deformation, thereby yielding a better point correspondence mapping.

A preliminary conference version of this work appeared in IEEE EMBC 2013 [38]. This journal version expands on [38] with:
                        
                           (1)
                           A wider experimental investigation that includes more patient data and statistical validations. Additional experimental evaluations include: (a) 16 new subjects bringing the total adult subjects to 48; and (b) 23 infant HLHS patients.

A much broader, more informative/rigorous discussion of the subject. This includes an algorithmic description of the moving mesh generation and a more detailed discussion on the challenges in segmenting the RV under abnormal conditions such as HLHS.

The remainder of this paper is organized as follows. Section 2 describes the moving mesh framework used in the study. Experimental evaluations over RVSC and HLHS data sets as well as comparisons of the proposed method with other recent methods on RVSC data sets are described in Section 3. Section 4 provides a discussion and the limitations of the proposed study. Finally, conclusions are given in Section 5.

@&#METHODS@&#

We propose to use a 2D moving mesh (or grid generation) framework [37] to compute point-to-point correspondences between the kth image T
                     
                        k
                      and (k
                     +1)th image T
                     
                        k+1 (for k
                     =1, …, K
                     −1) defined over 
                        Ω
                        ⊂
                        
                           
                              
                                 ℝ
                              
                           
                           2
                        
                      (K is the total number of frames in a cardiac cycle), thereby obtaining a sequence of points over time. Fig. 2
                      depicts the flow diagram for computing such point-to-point correspondences. We state the problem as an optimisation of a similarity/dissimilarity measure [39]:
                        
                           (1)
                           
                              
                                 
                                    ϕ
                                    ˆ
                                 
                              
                              =
                              arg
                              
                                 opt
                                 ϕ
                              
                                 
                              
                                 E
                                 s
                              
                              (
                              
                                 T
                                 k
                              
                              ,
                              
                                 T
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              ϕ
                              (
                              ξ
                              )
                              )
                           
                        
                     where ξ
                     ∈Ω denotes pixel location, ϕ
                     :Ω→Ω a transformation function and E
                     
                        s
                     (·) a measure of dissimilarity. We will use the squared L
                     2 norm as the dissimilarity measure E
                     
                        s
                     (·) [40]. As this problem may not have a unique solution and require more constraints, we introduce in the following a deformation field using a monitor function μ and curl of end velocity field γ, where 
                        μ
                        :
                        Ω
                        →
                        
                           
                              ℝ
                           
                        
                      and 
                        γ
                        :
                        Ω
                        →
                        
                           
                              ℝ
                           
                        
                     .

Let μ(ξ) be a continuous monitor function constrained by:
                           
                              (2)
                              
                                 
                                    ∫
                                    Ω
                                 
                                 μ
                                 =
                                 |
                                 Ω
                                 |
                                 .
                              
                           
                        The purpose of this step is to find a transformation ϕ
                        :Ω→Ω, ∂Ω→∂Ω, so that
                           
                              (3)
                              
                                 
                                    J
                                    ϕ
                                 
                                 (
                                 ξ
                                 )
                                 =
                                 μ
                                 (
                                 ξ
                                 )
                                 ,
                              
                           
                        where J
                        
                           ϕ
                         is the Jacobian determinant of the transformation. The following computations yield a transformation ϕ, which verifies (3).


                        Step 1: Compute a vector field ρ(ξ), defined by
                           
                              (4)
                              
                                 div
                                 
                                 ρ
                                 (
                                 ξ
                                 )
                                 =
                                 μ
                                 (
                                 ξ
                                 )
                                 −
                                 1
                                 .
                              
                           
                        
                        Step 2: Build a velocity vector field from ρ(ξ):
                           
                              (5)
                              
                                 
                                    ν
                                    t
                                 
                                 (
                                 ξ
                                 )
                                 =
                                 
                                    
                                       ρ
                                       (
                                       ξ
                                       )
                                    
                                    
                                       t
                                       +
                                       (
                                       1
                                       −
                                       t
                                       )
                                       μ
                                       (
                                       ξ
                                       )
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                                 ,
                              
                           
                        where t is an artificially introduced (algorithmic) time.


                        Step 3: Finally, ϕ is obtained by solving the following ODE:
                           
                              (6)
                              
                                 
                                    
                                       d
                                       ψ
                                       (
                                       ξ
                                       ,
                                       t
                                       )
                                    
                                    dt
                                 
                                 =
                                 
                                    ν
                                    t
                                 
                                 (
                                 ψ
                                 (
                                 ξ
                                 ,
                                 t
                                 )
                                 )
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                                 ,
                                 ψ
                                 (
                                 ξ
                                 ,
                                 t
                                 =
                                 0
                                 )
                                 =
                                 ξ
                                 ,
                              
                           
                        and setting ϕ equal to ψ evaluated at t
                        =1: ϕ(ξ)=
                        ψ(ξ, t
                        =1).

The above problem may have multiple solutions. We solve the div-curl system under the Dirichlet boundary condition by adding to (4) a constraint on the curl of ρ(ξ), which guarantees obtaining a unique solution:


                        
                           
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                        with null boundary condition ρ(ξ)=0∀
                        ξ
                        ∈∂Ω, where γ(ξ) is a continuous function over Ω. Hence, the transformation can be fully parameterized by J
                        
                           ϕ
                        (ξ) and γ(ξ). We ensure the uniqueness of the solution using the Dirichlet boundary condition [41]. The transformation function μ(·) and curl γ(·) correspond to the radial and rotational components of the deformation field, respectively. The Dirichlet boundary conditions may cause the motion errors to be higher at the image boundaries and, therefore, we pad both images by zeros.

With the above parametrization, we reformulate (1) as the following constrained optimization problem:


                        Problem: Given two images T
                        
                           k
                         
                        and T
                        
                           k+1, defined over Ω, find a function pair {μ(ξ), γ(ξ)} that optimizes cost 
                        (1) 
                        s.t.:


                        
                           
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                        
                        where 0<
                        τ
                        
                           l
                         
                        ensuring that ϕ
                        
                           μ,γ
                         
                        is a diffeomorphism, and Ω′ is a sub-region of image domain Ω.

Constraint (8a) ensures that the areas of the domain and co-domain are equal after transformation, and constraint (8b) limits the amount of compressibility, which is controlled by parameters τ
                        
                           l
                         and τ
                        
                           h
                        , within sub-region Ω′. Note that a diffeomorphism corresponds to a positive transformation Jacobian determinant, which is enforced explicitly via the monitor function [37].

The above problem can be solved by a step-then-correct optimization strategy as described in Algorithm 1. We compute a sequence of corresponding points on endocardial as well as epicardial borders in all the frames of a cardiac sequence using transformation function 
                           
                              ϕ
                              ˆ
                           
                        , given the segmentation on the first frame. For current frame T
                        
                           k+1, the amount of deformation with respect to previous neighbouring frame T
                        
                           k
                         is smaller than the deformations with respect to other frames that occur further in the temporal domain, e.g., first frame T
                        1. Therefore, in computing the transfer function, we set the study image to previous frame T
                        
                           k
                         rather than first frame T
                        1. This improves accuracy and convergence time, and encourages consistency of the solutions over time. Fig. 3
                         shows the steps of computing the contours for all the frames of a cardiac cycle.


                        
                           Algorithm 1
                           Step-then-correct optimization

Given image pair T
                              1 and T
                              
                                 k
                              , consider the following steps.
                                 
                                    Step 1
                                    Compute the gradients of μ and γ which we denote respectively by ∇μ(T
                                       1, T
                                       
                                          k
                                       , ϕ) and ∇γ(T
                                       1, T
                                       
                                          k
                                       , ϕ)

Terminate if step size δ
                                       <
                                       δ
                                       
                                          th
                                        or a maximum number of iterations is reached; otherwise, update (μ, γ) by (i is the iteration number):
                                          
                                             
                                                
                                                   μ
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                =
                                                
                                                   μ
                                                   i
                                                
                                                +
                                                δ
                                                
                                                   
                                                      ∇
                                                      μ
                                                      
                                                         E
                                                         S
                                                      
                                                   
                                                   
                                                      max
                                                      
                                                         |
                                                         ∇
                                                         μ
                                                         
                                                            E
                                                            S
                                                         
                                                         |
                                                      
                                                   
                                                
                                                
                                                and
                                                
                                                
                                                   γ
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                =
                                                
                                                   γ
                                                   i
                                                
                                                +
                                                δ
                                                
                                                   
                                                      ∇
                                                      γ
                                                      
                                                         E
                                                         S
                                                      
                                                   
                                                   
                                                      max
                                                      
                                                         |
                                                         ∇
                                                         γ
                                                         
                                                            E
                                                            S
                                                         
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

For each pixel location ξ
                                       ∈Ω′⊂Ω, impose constraint (8b) by
                                          
                                             
                                                
                                                   μ
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                (
                                                ξ
                                                )
                                                ←
                                                max
                                                
                                                   (
                                                   
                                                      μ
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   ξ
                                                   )
                                                   ,
                                                   
                                                      τ
                                                      l
                                                   
                                                   )
                                                
                                                
                                                and
                                                
                                                
                                                   μ
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                (
                                                ξ
                                                )
                                                ←
                                                min
                                                
                                                   (
                                                   
                                                      μ
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   ξ
                                                   )
                                                   ,
                                                   
                                                      τ
                                                      h
                                                   
                                                   )
                                                
                                             
                                          
                                       For each pixel location ξ
                                       ∈Ω, impose constraint (8a) by
                                          
                                             
                                                
                                                   μ
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                (
                                                ξ
                                                )
                                                ←
                                                
                                                   μ
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                (
                                                ξ
                                                )
                                                
                                                   
                                                      |
                                                      Ω
                                                      |
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            ξ
                                                            ∈
                                                            Ω
                                                         
                                                      
                                                      
                                                         μ
                                                         
                                                            i
                                                            +
                                                            1
                                                         
                                                      
                                                      (
                                                      ξ
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    

Find a vector field ρ(ξ) which satisfies:
                                          
                                             
                                                
                                                   
                                                      
                                                   
                                                
                                             
                                          
                                       with null boundary condition ρ(ξ)=0, ∀
                                       ξ
                                       ∈∂Ω. Compute the transformation ϕ(ξ)=
                                       ψ(ξ, t
                                       =1) by finding the solution to the ordinary differential equation
                                          
                                             (10)
                                             
                                                
                                                   
                                                      d
                                                      ψ
                                                      (
                                                      ξ
                                                      ,
                                                      t
                                                      )
                                                   
                                                   dt
                                                
                                                =
                                                
                                                   ν
                                                   t
                                                
                                                (
                                                ψ
                                                (
                                                ξ
                                                ,
                                                t
                                                )
                                                )
                                                
                                                t
                                                ∈
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                          
                                       with ψ(ξ, t
                                       =0)=
                                       ξ. The velocity vector field ν
                                       
                                          t
                                        is given by
                                          
                                             (11)
                                             
                                                
                                                   ν
                                                   t
                                                
                                                (
                                                ξ
                                                )
                                                =
                                                
                                                   
                                                      ρ
                                                      (
                                                      ξ
                                                      )
                                                   
                                                   
                                                      t
                                                      +
                                                      (
                                                      1
                                                      −
                                                      t
                                                      )
                                                      
                                                         μ
                                                         
                                                            i
                                                            +
                                                            1
                                                         
                                                      
                                                      (
                                                      ξ
                                                      )
                                                   
                                                
                                                
                                                t
                                                ∈
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                          
                                       
                                    

Compute cost E
                                       
                                          S
                                       . If it improves, i
                                       ←
                                       i
                                       +1, go to Step 1; otherwise, decrease δ and go to Step 2.

@&#EXPERIMENTAL RESULTS@&#

The proposed method was evaluated over a data set composed of 48 subjects provided by the RVSC, MICCAI 2012 [16] and a data set composed of 23 Hypoplastic Left Heart Syndrome (HLHS) patients. For the moving mesh, grid sampling was set equal to the pixel spacing. The size of the grid was selected automatically based on a bounding box containing the initial segmentation drawn on the first frame. A margin of 5 pixels around the bounding box was added to allow deformations outside the bounding box. For the step-then-correct algorithm, we set δ
                     
                        th
                     
                     =0.02 and the maximum number of iterations to 30. The initial value of δ and the factor to reduce δ were set to 0.5 and 2/3, respectively. Given the high variability in right ventricular motion, the following parameter values were used for all cases so to allow large tissue deformations: τ
                     
                        h
                     
                     =4 and τ
                     
                        l
                     
                     =0.25.

For quantitative analysis, two criteria were used to evaluate the similarities between the manual and automatic segmentations:


                     The Dice Metric (DM). We computed the DM, a common measure of similarity between manual and automatic segmentations. The DM is given by
                        
                           (7)
                           
                              DM
                              (
                              
                                 V
                                 a
                              
                              ,
                              
                                 V
                                 m
                              
                              )
                              =
                              
                                 
                                    2
                                    
                                       V
                                       am
                                    
                                 
                                 
                                    
                                       V
                                       a
                                    
                                    +
                                    
                                       V
                                       m
                                    
                                 
                              
                              ,
                           
                        
                     where V
                     
                        a
                     , V
                     
                        m
                      and V
                     
                        am
                      are, respectively, the volumes of the automatically segmented region, the corresponding manually delineated region, and the intersection between them. Note that DM is always between 0 and 1, where 1 means a perfect match.


                     The Hausdorff Distance (HD). We computed the HD [42], a symmetric measure of distance between both automatic and manual contours. Let us denote automatic and manual contours by C
                     
                        a
                      and C
                     
                        m
                     , respectively. For each point 
                        
                           p
                           a
                           i
                        
                      on C
                     
                        a
                     , we compute the distances to all the points 
                        
                           p
                           m
                           j
                        
                      on C
                     
                        m
                     . The HD is given by
                        
                           (8)
                           
                              HD
                              (
                              
                                 C
                                 a
                              
                              ,
                              
                                 C
                                 m
                              
                              )
                              =
                              max
                              (
                              
                                 max
                                 i
                              
                              (
                              
                                 min
                                 j
                              
                              (
                              d
                              (
                              
                                 p
                                 a
                                 i
                              
                              ,
                              
                                 p
                                 m
                                 j
                              
                              )
                              )
                              )
                              ,
                              
                                 max
                                 j
                              
                              (
                              
                                 min
                                 i
                              
                              (
                              d
                              (
                              
                                 p
                                 a
                                 i
                              
                              ,
                              
                                 p
                                 m
                                 j
                              
                              )
                              )
                              )
                              )
                           
                        
                     where d(·) is the Euclidean distance. The HD is computed in mm, with the spatial resolution obtained from the pixel spacing in the DICOM header.

The proposed method was evaluated over the training and testing sets provided by the RVSC [16]. Each data set consists of short-axis MRI volumes of 16 subjects. The data sets were acquired on 1.5T MRI scanners (Symphony Tim, Siemens Medical Systems, Erlangen, Germany) with steady-state free precession acquisition mode. Sequence parameters were as follows: TR=50ms; TE=1.7ms; flip angle=55; slice thickness=7mm; matrix size=256×216; Field of view=360–420mm; 20 images per cardiac cycle. The details of the data sets are presented in Table 1
                        . The data was acquired from June 2008 to August 2008 at the Rouen University Hospital, Rouen, France and all patients gave written informed consent. Participants in the study had the following indications for MRI: myocarditis, ischaemic cardiomyopathy, suspicion of arrhythmogenic right ventricular dysplasia, dilated cardiomyopathy, hypertrophic cardiomyopathy, aortic stenosis. More details about the data can be found at the RVSC website.
                           2
                        
                        
                           2
                           
                              http://www.litislab.eu/rvsc/.
                         Ground truth manual segmentations were provided only for the training set. For testing data sets, initial manual contours were drawn using a programme developed in-house that uses spline smoothing, and therefore, require a small number of points to be provided by the user. In order to assess the performance of the proposed algorithm on the testing sets, we submitted the automatic contours to the RVSC organizers, who in return, provided us with the performance measures.


                           Table 2
                            reports the DM and HD values for the Training set at ES. Table 3
                            reports the DM and HD values for the Test1 set for the proposed approach and other methods from the MICCAI 2012 RVSC evaluated at the end-systole. The testing-set evaluations were performed by the challenge organizers. The higher the DM or the lower the HD, the better the performance. Two of the competing methods did not report epicardial segmentations and are denoted as N/A. The table shows that our method performed significantly better than the other methods for both endocardial and epicardial segmentations. Evaluated over the full data set (i.e., 48 subjects from the training and testing sets), the proposed method yielded average Dice scores of 0.79 and 0.84, respectively, for endocardial and epicardial segmentations.

We further evaluated the performance of the proposed method for estimating clinical measurements such as RV end-diastolic volume (RVEDV), RV end-systolic volume (RVESV) and RVEF. Fig. 4
                            reports the Bland–Altman analysis for RVEDV, RVESV, RVEF and right ventricular mass (RVM). In the analysis, two parameters were computed: (1) bias was calculated by the mean difference between the automatic and manual measurements; and (2) the limits of agreement (LOA) was calculated by 1.96 standard deviations of the differences and covers the range of values which includes 95% of all the differences between the automatic and manual measurements. Fig. 4(a) and (d) correspond to the manual contours on the initial frame, where manual contour 1 was drawn by the RVSC organizers and manual contour 2 was drawn by us. We excluded the training set in the analysis of RVEDV and RVM, since the manual contours were provided by the RVSC organizers and we did not draw contours on the initial frame. Fig. 4(b) and (c) correspond to the auto contours by the proposed method and the manual contours provided by the RVSC organizers. The bias and LOA values for RVEDV, RVESV, RVEF and RVM were 5.4(±21.0) ml, 7.1(±17.9)ml, −0.04(±0.09) and 7.3(±14.5), respectively.


                           Table 4
                            reports the overall results for endocardial segmentation over end-systolic and end-diastolic phases. Only anonymized results for RSVC participants are available since individual results for Test2 set are not publicly available [34]. Table 5
                            reports the overall results for epicardial segmentation. The overall values for our method in Tables 4 and 5 include the manual segmentation at end-diastole. The results show that the proposed method yielded the best performance in comparison to other related methods.

In Fig. 5
                           , we give representative examples of segmented endocardial and epicardial borders of the RV over a complete cardiac cycle. These examples show that the proposed method accurately included the papillary muscles inside the target cavity, although these have intensity profiles similar to the RV myocardium. We could also see that the contours closely follow the RV wall even though parts of the borders are not visible in many frames.

The MATLAB parallel implementation of our algorithm running on a MacPro with dual 6-core Intel Xeon processors took 4.7±1.7s to process a sequence of 19 image slices for both endocardial and epicardial borders.

The proposed method was evaluated over 23 Hypoplastic Left Heart Syndrome (HLHS) patients. The data sets were acquired on 1.5T MR scanners (Avanto and Sonata; Siemens Healthcare, Erlangen, Germany). The protocol was approved by the University of Alberta Health Research Ethics Board. The average age of subjects is 0.45±0.30 years. The minimum and maximum ages of subjects are 0.12 and 1.39 years, respectively. The details of the datasets are presented in Table 6
                        . The ground truth manual delineations were performed by an experienced radiologist using a commercial software (Argus, Siemens).

In Fig. 6
                        , we give representative examples showing RV deformations and endocardial segmentations computed using the proposed method. As depicted in the figure, the shape of the RV of the HLHS patients is significantly different from a normal RV. The example demonstrates that our method yielded accurate tracking of the boundary despite the variability in shape.

We computed the DM and HD to evaluate the similarities between the manual and automatic segmentations. Table 7
                            reports the DM and HD values for the HLHS patient data set at ES. We computed the reliability which is given by (number of volumes segmented with DM higher than d)/(total number of volumes), i.e., 
                              Rl
                              (
                              d
                              )
                              =
                              Pr
                              (
                              DM
                              >
                              d
                              )
                           , d
                           ∈[0, 1]. Table 7 also reports the reliability at different accuracy levels (d
                           =0.70, d
                           =0.75, d
                           =0.80) evaluated over 23 subjects. The analysis shows that 72% of the automatic contours yielded a Dice score greater than 0.8. The average DM values for endocardium for each subject in the HLHS patient data sets are depicted in Fig. 7
                           .

We evaluated the performance of the proposed method in estimating the RVESV and RVEF for the HLHS patient data. Fig. 8
                            reports the Bland–Altman analysis of conformity between manual and automatic contours for RVESV and RVEF estimation. The bias and LOA for RVESV and RVEF were 3.22(±4.38) ml and −0.12(±0.11), respectively.

@&#DISCUSSION@&#

Our algorithm has the following advantages over prior RV segmentation works: (1) it removes the need for a time-consuming, manually built training set; (2) it does not make prior assumptions as to the distributions of intensity and shape; (3) it provides a sequence of corresponding points over time, a comprehensive input that can be very useful in cardiac applications other than segmentation, e.g., regional wall motion analysis; and (4) it is more flexible for congenital heart disease where the RV undergoes high variations in shape.

An important advantage of our automated method is the ability to measure the volume over the entire cardiac cycle. This allows us to analyse the cardiac function over the entire cardiac in addition to the computation of common clinical measures such as RVEF.

The average size (mean ± standard deviation) of the moving mesh grid were (89.1×103.1)±(27.7×30.9) pixels for the RVSC data. The grid size was smaller for the infant HLHS patient data: (81.3×83.1)±(25.9×26.2). The step-then-correct optimization algorithm took an average of 14.7±9.1 iterations to converge, and 85% of the cases converged within a maximum number of iterations equal to 30.

Limitations of our study were the lack of a gold standard and the limited number of test subjects. The proposed study assumes manual contours as the gold standard and the automatic contours were compared against manual contours to evaluate the performance of the algorithm. The algorithm was tested only over a data set of 48 adults and a data set of 23 HLHS infants after their initial surgery. Another limitation of our method is that it requires manual contouring of one time frame for a given slice position. Although more time-consuming than automated methods, the method allows for greater accuracy through the remainder of the cardiac cycle.

Although the proposed method does not impose any shape constraints for the heart, its performance depends on the image quality. The presence of any artefacts, including fat, will disrupt the point correspondence mapping. Measuring the global agreement between the manual and automatic contours, the Dice score will not correctly reflect any local imperfections. However, the Hausdorff distance is always higher than or equal to any local point error: it evaluates for each point on the contour the distance between the point and its closest point on the ground truth. The proposed method does not include any temporal characteristics of the cardiac motion in computing the segmentations.


                     Table 8
                      reports the mean and standard deviation values for clinical parameter values estimated from the RSVC data and for reference normal value for adults [43]. The RVEF and RVESV values computed using the automatic method is significantly different from the reference normal values. The patients from the RVSC data set have various heart conditions, and therefore, the mean RVEF is lower than the reference normal value. Also, the standard deviation values are higher than the reference normal values.


                     Table 9
                      reports the mean and standard deviation values for normalized clinical parameter values estimated from the HLHS data and the corresponding reference normal values for children. The proposed method was evaluated over infants with HLHS whereas the normal values were based on children with normal heart condition.

@&#CONCLUSION@&#

In this study, we presented a semi-automated method based on a 2D moving mesh approach to segment the RV from 4D cardiac MR images. The proposed method computes point-to-point correspondences within a cardiac sequence via grid generation. Given a user-provided segmentation of a single frame in the sequence, the proposed method segments both endocardial and epicardial borders of the RV, and does not require a training data set. Evaluated quantitatively over the 48 subjects of the MICCAI 2012 RV segmentation challenge data set, the proposed method yielded average Dice scores of 0.79 and 0.84, respectively, for endocardial and epicardial segmentations. The proposed method also yielded an average Dice score of 0.81 over 23 hypoplastic left heart syndrome patients, which demonstrates the robustness of the algorithm.

MN and KP have submitted a provisional patent application based on the proposed RV segmentation approach. Authors declare that they have no other competing interests.

@&#ACKNOWLEDGEMENTS@&#

Authors wish to thank Servier Canada Inc. for the grant which supported this work.

@&#REFERENCES@&#

