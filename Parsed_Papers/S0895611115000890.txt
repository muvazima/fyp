@&#MAIN-TITLE@&#Tissue-specific sparse deconvolution for brain CT perfusion

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Tissue-specific deconvolution is proposed to preserve the low-contrast tissues.


                        
                        
                           
                           Tissue-specific dictionaries are learned from tissue segments of high-dose maps.


                        
                        
                           
                           Weighted sparse deconvolution is based on the tissue classification probability.


                        
                        
                           
                           A unified reconstruction framework for the low-dose perfusion deconvolution.


                        
                        
                           
                           Outperforms state-of-art in extensive evaluation on clinical datasets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Low-dose CT perfusion

Tissue-specific

Dictionary learning

Ischemic detection

Deconvolution

@&#ABSTRACT@&#


               
               
                  Enhancing perfusion maps in low-dose computed tomography perfusion (CTP) for cerebrovascular disease diagnosis is a challenging task, especially for low-contrast tissue categories where infarct core and ischemic penumbra usually occur. Sparse perfusion deconvolution has been recently proposed to effectively improve the image quality and diagnostic accuracy of low-dose perfusion CT by extracting the complementary information from the high-dose perfusion maps to restore the low-dose using a joint spatio-temporal model. However the low-contrast tissue classes where infarct core and ischemic penumbra are likely to occur in cerebral perfusion CT tend to be over-smoothed, leading to loss of essential biomarkers. In this paper, we propose a tissue-specific sparse deconvolution approach to preserve the subtle perfusion information in the low-contrast tissue classes. We first build tissue-specific dictionaries from segmentations of high-dose perfusion maps using online dictionary learning, and then perform deconvolution-based hemodynamic parameters estimation for block-wise tissue segments on the low-dose CTP data. Extensive validation on clinical datasets of patients with cerebrovascular disease demonstrates the superior performance of our proposed method compared to state-of-art, and potentially improve diagnostic accuracy by increasing the differentiation between normal and ischemic tissues in the brain.
               
            

@&#INTRODUCTION@&#

Cerebral computed tomography perfusion (CTP) imaging has been advocated to detect and characterize the ischemic penumbra, and assess blood–brain barrier permeability with acute stroke or chronic cerebrovascular disease. In cerebral studies, perfusion hymodynamic parameters such as cerebral blood flow (CBF), cerebral blood volume (CBV) and mean transit time (MTT) can be computed from the time sequence of enhanced CT images to provide important guidance to clinicians. However, the associated excessive radiation exposure in the repeated scan during CTP examination is raising a great concern due to numerous recent reports from patients on over-dosage leading to biological effects including hair loss, skin burn and increased cancer risk. The issue is that reducing the radiation dose in CTP will introduce noise and artifacts into the acquired data and lead to quality deterioration in the perfusion maps that may mislead interpretation. Thus a key challenge remains in low-dose CTP is to obtain high-quality perfusion maps for accurate diagnosis.

In this paper, we propose a tissue-specific sparse deconvolution method to address the limitations above. Previous methods fail to preserve the low-contrast, delicate tissue categories which are essential for cerebrovascular disease diagnosis. We overcome this difficulty by incorporating segmentation and deconvolution in the a unified framework and learning different dictionaries for each tissue category from the high-dose data, as shown in Fig. 1
                     . Our method starts from segmenting the brain into different tissue classes. A modified version of automated model-based tissue classification [1] is employed to segment the brain tissue classes. Then tissue-specific dictionaries are learned from the training segments of each class. Then this model is propagated to a spatio-temporal energy function and minimized iteratively, where we use weighted sparse deconvolution method to restore each tissue class and stitch them together. The extensive experiments demonstrate the superior performance of our method. It is important to note that all the preprocessing methods to denoise the dynamic CT data can be complimented with our proposed deconvolution algorithm to achieve better performance.

Our main contribution is two-fold: (1) tissue-specific dictionaries for each tissue class are employed in place of the global dictionary to capture the low-contrast tissue class and delicate structural details. (2) Weighted sparse deconvolution based on the probability of the tissue classification is proposed for a unified reconstruction of the low-dose perfusion maps. In vivo brain acute stroke and aneurysmal SAH patients data, we demonstrate the superiority of our proposed method in CBF estimation that leads to better separation between normal and ischemic tissue.

@&#RELATED WORK@&#

Prior art in low-dose CTP perfusion map enhancement is limited. The most widely clinically adopted computational model to quantify perfusion parameters in CTP is truncated singular value decomposition (TSVD) [2,3] and its variants, such as block-circulant TSVD (cTSVD) [4]. However, the TSVD-based methods tend to introduce unwanted oscillations [5,6] and results in overestimation of CBF and underestimation of MTT. Numerous works have been proposed and have successfully improved the quality of CT data and therefore CBF maps at low-dose to some extent, including bilateral filtering, non-local means, nonlinear diffusion filter, wavelet-based methods, and adaptive statistical iterative reconstruction (ASIR). However all these work attempted to remove the noise in the dynamic CT data and do not specifically consider the deconvolution model in CTP. The oscillatory nature of TSVD-based methods has initiated research that introduces different regularization terms to stabilize the deconvolution, and have shown varying degrees of success in stabilizing the residue functions by enforcing either temporal [5,7–9] and spatial regularization [10,11] on the residue functions.

The main limitation of these methods is that prior knowledge of regularization is assumed instead of learned from the data, which may fail to capture the local details of perfusion maps. Sparse perfusion deconvolution (SPD) [12] was the first to introduce a data-driven approach to learn a dictionary from the high-dose perfusion maps to enhance low-dose CTP data and has successfully improved the quantification of perfusion maps and diagnostic accuracy. However, the dictionary is learned globally from the whole perfusion maps, which is problematic for two reasons.


                     First, given the diversity of tissue textures in the perfusion maps, the number of atoms needed to model their statistical characterization is important. The global dictionary tends to emphasize the high-contrast tissues such as vessel structure, and has fewer atoms for the low-contrast and fine structures such as white matter (WM). On top of that, global dictionary is not adequate for perfusion map modeling since each tissue category has a rather unique characterization, where tissue-specific dictionaries might be feasibly learned.

While most methods use a global dictionary learned from the training samples. A recently proposed discriminative dictionary learning [13] allows jointly optimizing sparse reconstruction and class discrimination. Class-specific dictionaries have also been studied in other scenarios such as face recognition [14], medical image segmentation [15], edge detection, image classification and texture segmentation [16,17], our scenarios and goals are different from these work. They aim to predict labels in recognition and segmentation problems, with one class per example. Our proposed algorithm is for reconstruction purpose. The category-specific dictionaries are not optimized to be more discriminative, but for more accurate reconstruction of each category. Reconstructive dictionaries allow us to recover the pixels belonging to neighboring tissue classes in the same patch.

The sparse representation of signals in transformed domains is crucial to the success of various optimization-based tasks. Sparsity methods have been widely investigated and sparsity prior has been vastly used in computer vision and multimedia communities. In medical image analysis, it has been applied to MR reconstruction [18–21], deformable segmentation [22–24], low-dose CT perfusion [12,11,25–29], image annotation [30] and image segmentation [31], etc.

@&#METHODOLOGY@&#

In this section, we will first briefly introduce sparse perfusion deconvolution (SPD). Tissue-specific dictionary learning and reconstruction algorithms will be presented afterwards.

SPD is designed to improve low-dose CTP deconvolution by combining the temporal convolution model with the spatial regularization using sparse representation of dictionary atoms learned from high-dose perfusion maps. Accordingly, the spatial priors can be incorporated on-the-fly through patch composition, which is formulated as a sparse optimization problem as follows.

In SPD, a 4D CTP data is represented by 
                           C
                           (
                           x
                           ,
                           y
                           ,
                           z
                           ,
                           t
                           )
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 N
                                 ×
                                 T
                              
                           
                         composing of N tissue enhancement curves (TEC) at voxels of interest (VOI) [x, y, z]
                           T
                         and T time points, where x, y and z are the respective row, column and slice coordinates of the spatio-temporal data and t is the temporal stamp. The residue impulse function (RIF) is represented by 
                           R
                           (
                           x
                           ,
                           y
                           ,
                           z
                           ,
                           t
                           )
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 N
                                 ×
                                 T
                              
                           
                        , indicating the delaying of the remaining contrast tracer in the VOI. Let us assume 
                           f
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              N
                           
                         as the CBF map to be estimated at [x, y, z] and 
                           
                              
                                 D
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 N
                                 ×
                                 K
                              
                           
                         as the learned dictionary from the high-dose perfusion maps. 
                           α
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              K
                           
                         is a sparse vector to make D
                        α an approximation to f with certain error tolerance. To learn the dictionary D of high-dose perfusion map patches, K-SVD [32] is used by solving


                        
                           
                              (1)
                              
                                 
                                    min
                                    
                                       
                                          
                                             D
                                             ,
                                             A
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    N
                                 
                                 ∥
                                 α
                                 
                                    ∥
                                    0
                                 
                                 ,
                                 
                                 
                                    subject
                                       
                                    to
                                 
                                 ∥
                                 
                                    z
                                    j
                                 
                                 −
                                 
                                    
                                       D
                                    
                                 
                                 
                                    α
                                    j
                                 
                                 
                                    ∥
                                    2
                                 
                                 ≤
                                 ϵ
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 N
                              
                           
                        Then the approximation of f by D is then formulated as an optimization problem:


                        
                           
                              (2)
                              
                                 J
                                 =
                                 
                                    μ
                                    1
                                 
                                 ∥
                                 
                                    
                                       C
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             C
                                             a
                                          
                                          R
                                       
                                    
                                 
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 ∥
                                 f
                                 −
                                 
                                    
                                       D
                                    
                                 
                                 α
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 
                                    μ
                                    2
                                 
                                 ∥
                                 α
                                 
                                    ∥
                                    0
                                 
                              
                           
                        
                     

where f
                        =
                        R(t
                        =0) by the definition of residue impulse function [2]. The first term is based on the indicator dilution theory [33], where 
                           
                              
                                 C
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 T
                                 ×
                                 N
                              
                           
                         is the contrast concentration curves of the VOI, and 
                           
                              
                                 
                                    
                                       C
                                       a
                                    
                                 
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 T
                                 ×
                                 T
                              
                           
                         is the circulant matrix for the arterial input function (AIF). The second and third terms are the key idea of SPD. The details of the notation can be found in [25]. Then Eq. (2) is optimized using an expectation-maximization (EM) style algorithm, which alternatively optimizes α (“E” step) using orthogonal matching pursuit (OMP) and f (“M” step) as a linear inverse problem.

Patch-based dictionary learning is widely used in computer vision for image de-noising and enhancement [32,34,35]. The key requirement in constructing an effective dictionary is that the dictionary should be universal enough to represent every possible patch with sufficient accuracy. To achieve this, the dictionary should have enough atoms for every texture category. However, a global dictionary tends to have more atoms for the high-contrast and edge patches, and much fewer atoms for the low-contrast and delicate patches.

To solve this problem, we resort to constructing several dictionaries that is adapted to each tissue category based on a segmentation of CTP images, instead of a general dictionary for the whole 4D-CT. This allows us to locate sufficient atoms for each distinct tissue category.

To segment the cerebral CTP data into different tissue categories, we use the average enhancement (AE). AE is defined as the mean value of TEC in Hounsfield Units (HU) over all temporal points. Let us denote 
                           
                              
                                 M
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              N
                           
                        , a column vector of size N, as the AE of a 4-D CTP data 
                           
                              
                                 C
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 N
                                 ×
                                 T
                              
                           
                        , then


                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          M
                                       
                                    
                                    i
                                 
                                 =
                                 
                                    1
                                    T
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    C
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 
                                 for
                                    
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              
                           
                        where C
                        
                           i,t
                         denotes the HU value at position i and time point t.

Because the tissue enhancement varies depending on the tissue type, we could segment the brain CT image by thresholding the value of AE into four categories: vessel, gray matter (GM), white matter (WM) and cerebrospinal fluid (CSF). Since computational efficiency is very important in our framework for real-time clinical diagnosis, we choose a simple yet effective segmentation approach by adapting a tissue classification algorithm for MRI [1].

We first compute the median value for each voxel along the temporal axis since different tissue classes have different contrast perfusion characteristics. Expectation-maximization segmentation is employed on the median map to obtain probability maps of GM, WM and CSF, We initialize the bias field to zero and start the iterations by providing the algorithm with a rough prior estimation of the classification. The prior distribution is derived from a digital brain atlas that contains spatially varying prior probability maps for the location of GM, WM and CSF [36]. Affine transformation is employed to warp the prior distributions into the target CT image space. EM algorithm is used to estimate the hidden class labels and the parameters of the model, while contexture information is incorporated by a Markov random field (MRF). The reason for choosing median map as a robust measurement of the tissue contrast in CTP is because of its higher tissue contrast compared to other statistics in our experiments. Vessel is segmented by thresholding the original CBF value. The vessel voxels in other tissue probability maps are set to zero to guarantee mutually occlusive segmentations. Tissue probability maps on a representative dataset are shown in Fig. 2
                        . The following reconstruction does not heavily depend on the segmentation accuracy, since each tissue dictionary is learned from over 10,000 patches and represents dominant patterns in the training patches.

After segmenting the training CTP data into four tissue types using AE thresholds, we apply the segmentation map of each tissue type to the corresponding high-dose CBF maps to obtain training samples for tissue-specific dictionary learning. To avoid too much blank area in the training samples, we remove the training patches with more than half zero-value voxels in the segments. In this way, we collected four sets of training samples for the four tissue categories from the high-dose training CTP data.

To learn the tissue-specific dictionary D
                        
                           m
                        , m
                        =vessel, GM,WM,CSF, we use the recently developed online learning algorithm [37]. Dictionary learning algorithm such as K-SVD [32] as used in [12] which requires all training samples available in the “dictionary update” step. However this cannot be satisfied in many medical application because of the limited patient data and de-identification process gradually carried on by different radiologists/technicians. Learning the tissue-specific dictionary Dm
                         with every batch of new training samples can be very time consuming and not always feasible. Online dictionary learning algorithm is therefore employed to tackle this problem.

Online dictionary learning algorithm learns the dictionary by processing one sample (or a mini-batch) at a time and updating the dictionary using block coordinate descent with warm restart. Given a set of high-dose CBF patches 
                           
                              Z
                              m
                           
                           =
                           
                              
                                 {
                                 
                                    z
                                    j
                                    m
                                 
                                 }
                              
                              
                                 j
                                 =
                                 1
                              
                              N
                           
                         for a specific tissue type m, each as a column vector of size N, we seek the dictionary D
                        
                           m
                         that minimizes


                        
                           
                              (4)
                              
                                 
                                    min
                                    
                                       
                                          
                                             
                                                D
                                             
                                          
                                          m
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    N
                                 
                                 ∥
                                 
                                    z
                                    i
                                    m
                                 
                                 −
                                 
                                    
                                       
                                          D
                                       
                                    
                                    m
                                 
                                 
                                    α
                                    i
                                 
                                 
                                    ∥
                                    2
                                 
                                 +
                                 
                                    μ
                                    2
                                 
                                 ∥
                                 
                                    α
                                    i
                                 
                                 
                                    ∥
                                    1
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              
                           
                        Starting from an initial dictionary of DCT, the algorithm iteratively employs two stages until convergence, sparse coding and dictionary update. Sparse coding aims to find the sparse coefficient α
                        
                           i
                         for each signal 
                           
                              z
                              i
                              m
                           
                        :


                        
                           
                              (5)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       
                                          α
                                          i
                                       
                                       ∈
                                       
                                          
                                             
                                                ℝ
                                             
                                          
                                          K
                                       
                                    
                                 
                                 ∥
                                 
                                    z
                                    i
                                    m
                                 
                                 −
                                 
                                    
                                       
                                          D
                                       
                                    
                                    m
                                 
                                 
                                    α
                                    i
                                 
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 
                                    μ
                                    2
                                 
                                 ∥
                                 
                                    α
                                    i
                                 
                                 
                                    ∥
                                    1
                                 
                              
                           
                        where D
                        
                           m
                         is the initial dictionary or dictionary computed from the previous iteration. LARS-Lasso algorithm [38] is employed to solve this step. The dictionary update stage aims to update D
                        
                           m
                         based on all discovered α
                        
                           i
                        , i
                        ∈[1, K]:


                        
                           
                              (6)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       
                                          
                                             
                                                D
                                             
                                          
                                          m
                                       
                                    
                                 
                                 
                                    1
                                    K
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    ∥
                                    
                                       z
                                       i
                                       m
                                    
                                    −
                                    
                                       
                                          
                                             D
                                          
                                       
                                       m
                                    
                                    
                                       α
                                       i
                                    
                                    
                                       ∥
                                       2
                                       2
                                    
                                    +
                                    
                                       μ
                                       2
                                    
                                    ∥
                                    
                                       α
                                       i
                                    
                                    
                                       ∥
                                       1
                                    
                                 
                              
                           
                        
                     

Based on stochastic approximation, the dictionary is updated efficiently using block-coordinate descent. It is a parameter free method and does not require any learning rate tuning. Because it only exploits a small batch of newly coming data in the “dictionary update” step, it is therefore much faster than K-SVD or other off-line learning algorithms. In this way, we can efficiently update the tissue-specific dictionaries with newly coming data.

Assuming that a low-dose perfusion map has been divided into overlapping patches, we use f
                        
                           r
                        , a column vector to denote an arbitrary patch in the low-dose perfusion image at location 
                           
                              
                                 r
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 X
                                 ×
                                 Y
                                 ×
                                 Z
                              
                           
                        , and m
                        
                           r
                         to denote the mean AE (mAE) over all voxels in the patch. Since the dictionary is patch-based, we assign one tissue category to each patch using the AE threshold values in Section 3.2.

The tissue-specific sparse perfusion deconvolution algorithm computes the CBF map of low-dose CTP data using both temporal convolution model and tissue-specific dictionary-based spatial regularization by solving:


                        
                           
                              (7)
                              
                                 J
                                 =
                                 
                                    μ
                                    1
                                 
                                 ∥
                                 
                                    
                                       
                                          C
                                       
                                    
                                    m
                                 
                                 −
                                 
                                    
                                       
                                          
                                             
                                                C
                                                a
                                             
                                             R
                                          
                                       
                                    
                                    m
                                 
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 ∥
                                 
                                    f
                                    m
                                 
                                 −
                                 
                                    
                                       
                                          D
                                       
                                    
                                    m
                                 
                                 α
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 
                                    μ
                                    2
                                 
                                 ∥
                                 α
                                 
                                    ∥
                                    1
                                 
                              
                           
                        where C
                        
                           m
                        , R
                        
                           m
                        , D
                        
                           m
                         and f
                        
                           m
                         are the corresponding TEC, RIF, dictionary and CBF for tissue category m.

Eq. (7) is solved by an EM style algorithm with iterative employment of two processes: (1) sparse coding process which minimizes with respect to α with f fixed, (2) quadratic solver which efficiently minimizes this simplified linear inverse problem. In the “E” step, f is estimated using the result of the previous step. The initial value of f is obtained by cTSVD, which applies voxel-independent deconvolution on the low-dose CTP data. In the “M” step, the following simplified problem is minimized:


                        
                           
                              (8)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       
                                          x
                                          m
                                       
                                    
                                 
                                    
                                 
                                    μ
                                    1
                                 
                                 ∥
                                 
                                    
                                       
                                          C
                                       
                                    
                                    m
                                 
                                 −
                                 
                                    
                                       
                                          
                                             
                                                C
                                                a
                                             
                                             R
                                          
                                       
                                    
                                    m
                                 
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 ∥
                                 f
                                 −
                                 
                                    
                                       
                                          D
                                       
                                    
                                    m
                                 
                                 α
                                 
                                    ∥
                                    2
                                    2
                                 
                              
                           
                        Because f
                        
                           m
                        
                        =
                        R
                        
                           m
                        (t
                        =0), Eq. (8) can be rewritten as
                           
                              (9)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       
                                          x
                                          m
                                       
                                    
                                 
                                 
                                    μ
                                    1
                                 
                                 ∥
                                 
                                    
                                       
                                          C
                                       
                                    
                                    m
                                 
                                 −
                                 
                                    
                                       
                                          
                                             
                                                C
                                                a
                                             
                                             R
                                          
                                       
                                    
                                    m
                                 
                                 ·
                                 diag
                                 (
                                 
                                    x
                                    m
                                 
                                 )
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 ∥
                                 
                                    f
                                    m
                                 
                                 −
                                 
                                    
                                       
                                          D
                                       
                                    
                                    m
                                 
                                 α
                                 
                                    ∥
                                    2
                                    2
                                 
                              
                           
                        where R
                        
                           m
                         is the residue functions normalized by x
                        
                           m
                         so that R
                        
                           m
                        (t
                        =0)=1. Eq. (9) is a quadratic term that has a closed-form solution.

If vec(B
                        
                           m
                        ) denotes the vector formed by the entries of a matrix B
                        
                           m
                         in column major order, and define P
                        
                           m
                        
                        =
                        CaR
                        
                           m
                        , then


                        
                           
                              (10)
                              
                                 vec
                                 (
                                 
                                    
                                       
                                          C
                                       
                                    
                                    m
                                 
                                 −
                                 
                                    
                                       
                                          
                                             
                                                C
                                                a
                                             
                                             R
                                          
                                       
                                    
                                    m
                                 
                                 ·
                                 diag
                                 (
                                 
                                    f
                                    m
                                 
                                 )
                                 )
                                 =
                                 vec
                                 (
                                 
                                    
                                       
                                          C
                                       
                                    
                                    m
                                 
                                 −
                                 
                                    
                                       
                                          P
                                       
                                    
                                    m
                                 
                                 ·
                                 diag
                                 (
                                 
                                    f
                                    m
                                 
                                 )
                                 )
                                 =
                                 vec
                                 (
                                 
                                    
                                       
                                          C
                                       
                                    
                                    m
                                 
                                 )
                                 −
                                 
                                    
                                       
                                          M
                                       
                                    
                                    m
                                 
                                 
                                    f
                                    m
                                 
                              
                           
                        where M
                        
                           m
                         is a TN
                        ×
                        N matrix in form of
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             m
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               P
                                                               
                                                                  .
                                                                  ,
                                                                  1
                                                               
                                                               m
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            ⋯
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               P
                                                               
                                                                  .
                                                                  ,
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            ⋯
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                         
                                                            ⋮
                                                         
                                                         
                                                            ⋱
                                                         
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            ⋯
                                                         
                                                         
                                                            
                                                               P
                                                               
                                                                  .
                                                                  ,
                                                                  N
                                                               
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                    
                                 
                              
                           
                        
                     

where 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 .
                                 ,
                                 i
                              
                              m
                           
                         dictates the ith column of matrix P
                        
                           m
                         in its column vector form. Eq. (9) can be transformed into the conventional least square problem


                        
                           
                              (11)
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       
                                          f
                                          m
                                       
                                    
                                 
                                 ∥
                                 (
                                 
                                    
                                       
                                          I
                                       
                                    
                                    n
                                 
                                 ;
                                 
                                    
                                       
                                          M
                                       
                                    
                                    m
                                 
                                 )
                                 
                                    f
                                    m
                                 
                                 −
                                 (
                                 
                                    
                                       
                                          D
                                       
                                    
                                    m
                                 
                                 α
                                 ;
                                 vec
                                 (
                                 
                                    
                                       
                                          C
                                       
                                    
                                    m
                                 
                                 )
                                 
                                    ∥
                                    2
                                    2
                                 
                              
                           
                        
                     

Let A
                        
                           m
                        
                        =(In
                        
                        ;
                        M
                        
                           m
                        ) and B
                        
                           m
                        
                        =(D
                        
                           m
                        
                        α
                        ;
                        vec(C
                        
                           m
                        )), we get


                        
                           
                              (12)
                              
                                 
                                    f
                                    m
                                 
                                 =
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       m
                                       +
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                    
                                    m
                                 
                              
                           
                        where A
                        
                           m+ is the pseudo-inverse of matrix A
                        
                           m
                        , (.;.) denotes a vector or matrix by stacking the arguments vertically.

Two procedures are iteratively employed to obtain x
                        
                           m
                         and α
                        
                           m
                         for each tissue type. Note that theoretically this iterative algorithm might lead to local minima. However, in our extensive experiments (Section 4), we did not observe this situation yet. We also observe our results are quite stable with respect to the training dataset.

Using tissue-specific dictionaries to enhance low-dose CTP perfusion maps with online learning and tissue-specific deconvolution, SPD obtains three additional advantages: (1) Segmentation information is incorporated into the dictionary learning and reconstruction to preserve the unique image characteristics of different tissue types and employ tissue-sensitive parameter settings. (2) The dictionaries become more robust to variations in the training data due to pre-segmented data. (3) The run-time efficiency is not sacrificed with more dictionaries to be trained and SPD can be gracefully scaled-up to contain tissue-specific high-dose perfusion image priors from, theoretically, infinite number of training shapes.

@&#EXPERIMENTS@&#

In this sections, we evaluate the proposed tissue-specific sparse perfusion deconvolution (TS-SPD) method in clinical subjects with cerebrovascular disease and normal subjects, and compare the proposed method with the clinically adopted cTSVD [4] method, SPD using a global dictionary (Global-SPD) [12], and two popular image denoising algorithms anisotropic diffusion (AD) [39] and non-local means (NLM) [40] by applying them to the low-dose CBF maps. The four baseline algorithms are tuned with optimal parameters to get best possible performance on the data. Out of 20 subjects, 10 are used as training data (7 with CTP deficits in the brain and 3 normal), and the rest 10 are used for testing purpose (5 with CTP deficits and 5 normal). A board-certified neuro-radiologist with 12 years experience reviewed CTP data in a blinded fashion to determine the type and location of CTP deficits.

For all experiments of SPD, the dictionary used are of size 64×256 designed to handle perfusion image patches of 8×8 pixels with 256 atoms in the dictionary. In all experiments, the denoising process uses a sparse coding of each patch of size 8×8 pixels from noisy image. We download the online dictionary learning for sparse representation code from the authors’ website.
                           1
                        
                        
                           1
                           
                              http://spams-devel.gforge.inria.fr/
                           
                         AE thresholding is determined as: above 70HU for vessel, between 32HU and 70HU for GM, between 17HU and 32HU for WM, and between 0HU and 17HU for CSF [41–43]. When applying the model, we constantly use the same parameters values for all CTP data, i.e., μ
                        1
                        =0.01, 0.02, 0.04, 0.08 and μ
                        2
                        =0.2, 0.4, 0.8, 1 for vessel, GM, WM and CSF.

Repetitive scanning of the same patient at different radiation doses is unethical. Thereby, Gaussian noise is added to the high-dose CTP data to simulate low-dose CTP data at I mA following the practice in [44]:


                        
                           
                              (13)
                              
                                 I
                                 =
                                 
                                    
                                       
                                          K
                                          2
                                       
                                       ·
                                       
                                          I
                                          0
                                       
                                    
                                    
                                       
                                          K
                                          2
                                       
                                       +
                                       
                                          σ
                                          a
                                          2
                                       
                                       ·
                                       
                                          I
                                          0
                                       
                                    
                                 
                              
                           
                        where σ
                        
                           a
                         is the standard deviation of the added noise, I
                        0
                        =190mA is the tube current at high-dose, K
                        =103.09mA1/2 is a constant. When σ
                        
                           a
                        
                        =25, the simulated low-dose I
                        =15.6mA.

The noise model is built on the inverse relationship between the tube current I (mA) and the noise standard deviation σ in CT images
                           
                              (14)
                              
                                 σ
                                 =
                                 
                                    K
                                    
                                       
                                          I
                                       
                                    
                                 
                              
                           
                        
                     

The value K is computed by analyzing the Gaussian noise in the CTP images of 22 patients under I
                        0
                        =190mA tube current and the average K value is 103.09mA1/2. Assume I is the simulated tube current level in mA, and σ
                        0 is the noise standard deviation in CTP images scanned under I
                        0
                        mA. We can rewrite Eq. (14) as


                        
                           
                              (15)
                              
                                 
                                    σ
                                    
                                       
                                          σ
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                I
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          I
                                       
                                    
                                 
                              
                           
                        Because noise distribution is statistically independent, the relationship between σ, σ
                        0 and the standard deviation of the added Gaussian noise σ
                        
                           a
                         is


                        
                           
                              (16)
                              
                                 
                                    σ
                                    2
                                 
                                 =
                                 
                                    σ
                                    0
                                    2
                                 
                                 +
                                 
                                    σ
                                    a
                                    2
                                 
                              
                           
                        From Eq. (15) and (16), we can compute the simulated tube current I given added noise standard deviation σ
                        
                           a
                        
                     


                        
                           
                              (17)
                              
                                 I
                                 =
                                 
                                    
                                       
                                          I
                                          0
                                       
                                       ·
                                       
                                          σ
                                          0
                                          2
                                       
                                    
                                    
                                       
                                          σ
                                          0
                                          2
                                       
                                       +
                                       
                                          σ
                                          a
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          K
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             K
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             I
                                             0
                                          
                                       
                                       )
                                       +
                                       
                                          σ
                                          a
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          K
                                          2
                                       
                                       ·
                                       
                                          I
                                          0
                                       
                                    
                                    
                                       
                                          K
                                          2
                                       
                                       +
                                       
                                          σ
                                          a
                                          2
                                       
                                       ·
                                       
                                          I
                                          0
                                       
                                    
                                 
                              
                           
                        or compute σ
                        
                           a
                         from I
                     


                        
                           
                              (18)
                              
                                 
                                    σ
                                    a
                                 
                                 =
                                 K
                                 
                                    
                                       
                                          
                                             
                                                1
                                                I
                                             
                                             −
                                             
                                                1
                                                
                                                   
                                                      I
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                              
                           
                        
                     

The corresponding added noise standard deviation or the simulated tube current levels are computed using Eq. (13) or (18) in this paper.


                        
                           
                              (19)
                              
                                 I
                                 =
                                 
                                    
                                       
                                          I
                                          0
                                       
                                       ·
                                       
                                          σ
                                          0
                                          2
                                       
                                    
                                    
                                       
                                          σ
                                          0
                                          2
                                       
                                       +
                                       
                                          σ
                                          a
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          K
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             K
                                             2
                                          
                                       
                                       /
                                       
                                          
                                             I
                                             0
                                          
                                       
                                       )
                                       +
                                       
                                          σ
                                          a
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          K
                                          2
                                       
                                       ·
                                       
                                          I
                                          0
                                       
                                    
                                    
                                       
                                          K
                                          2
                                       
                                       +
                                       
                                          σ
                                          a
                                          2
                                       
                                       ·
                                       
                                          I
                                          0
                                       
                                    
                                 
                              
                           
                        
                     

Peak signal-to-noise ratio (PSNR) is widely used in signal and image processing to measure the denoising performance. PSNR is defined as the ratio between the maximum intensity value in the ground truth image I
                        
                           max
                         and the power of corrupting noise σ (the average sum of squared difference between the ground truth and enhanced image) that affects representation fidelity. PSNR is usually expressed in the logarithmic decibel scale as


                        
                           
                              (20)
                              
                                 PSNR
                                 =
                                 20
                                 log
                                 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                   max
                                                
                                             
                                             σ
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                           Fig. 3
                            shows the globally learned dictionary using K-SVD and the four tissue-specific dictionaries using our proposed method. The global dictionary is trained on a dataset of 40,000 8×8 patches of high-dose CBF perfusion maps randomly sampled from 10 training subjects and initialized with the redundant DCT dictionary. Each tissue-specific dictionary is trained using 10,000 8×8 patches of the corresponding tissue category from the same training subjects.

We could observe from the global dictionary that high-contrast patches with edges and corners dominate the dictionary atoms, while the atoms needed to reconstruct the tissue categories with lower contrast and more delicate textures tend to be omitted. In comparison, the tissue specific dictionaries are trained specifically for each tissue category and are expected to preserve the texture and image characteristics for each category, especially for the low-contrast tissues such as WM and CSF. The stability of the dictionaries are also improved due to the independent training datasets of the mutually exclusive tissue categories.

We then compare five methods by visually observing the estimated CBF perfusion maps of two patients, a 63-year-old female patient with acute stroke in right hemisphere of the brain and a 35-year-old female patient with left middle cerebral artery (LMCA) CTP deficit due to aneurysmal SAH (Note in medical the left and right are opposite on the image). Low tube current of 15.6mA was simulated by adding Gaussian noise with standard deviation of 25 [44]. CBF maps computed from CTP data obtained at high cube current of 190mA were regarded as the reference standard.

As shown in Figs. 4 and 5
                           
                           , among the five low-dose CBF maps, the CBF maps generated using our proposed TS-SPD algorithm recovers the information of high-dose CBF maps from the low-dose CTP data with best overall performance. The arteries and veins as well as the micro-vessels are more evidently defined, while the delicate structures of the white matter and CSF are preserved. While the noise is greatly suppressed in the low-dose CBF maps for all four enhancement algorithms, Global-SPD, AD and NLM tend to smooth the image too much. AD smoothes both the vessel and non-vessel structures to remove the noise. The vessels in the CBF maps become discontinuous and the boundaries of the vessels are less clear-cut. NLM performs better at preserving the edges of the vessels but introduces image artifacts in the CBF map in the white matter and CSF. Global-SPD does a better job relatively compared to AD and NLM at preserving a clear-cut boundary of the vessel structures and not introducing additional artifacts into the CBF map. However the non-vessel structures still tend to be over-smoothed, since the dictionaries learned from the high-dose CBF maps are dominated by the atoms for vessel structure reconstruction. And for all these three methods, CSF and WM are overestimated because of the smoothing effect over the whole image which is contaminated by Gaussian noise. Our TS-SPD algorithm overcomes these drawbacks and preserves both the vessel boundaries and the low-contrast structures of WM and CSF with tissue-specific dictionaries and adaptive parameter setting for each tissue category. PSNR of CBF maps estimated by the five methods for the two patients in Figs. 4 and 5 are shown in Table 1
                            as Case 1 and 2.

We report the PSNR values for all testing subjects on the whole brain, GM and WM in Table 1. GM and WM are the tissue categories in the brain where acute stroke and chronic cerebrovascular disease mostly effect. The infarct core (dead tissue) occurs mostly in GM. The ischemic penumbra (risky tissue) occurs mostly in WM. It is clear that our method achieves highest PSNR values in all cases for the whole brain, and achieves even better PSNR in GM and WM (usually 1–2dB higher). It is important to note that though the PSNR gain may not be very significant for some cases, the qualitative improvement is significant in the WM and GM where the delicate tissue structure is preserved for cerebrovascular disease diagnosis by the neuro-radiologists, as shown in Figs. 4 and 5.

As shown in Figs. 4 and 5, the intensity difference of CBF values between LMCA and right middle cerebral artery (RMCA) is more evident in the low-dose CBF map estimated using our method. To visualize the asymmetry in the left and right middle cerebral artery of these two patient, we compute the intensity difference maps between LMCA and RMCA for five methods, as shown in Fig. 6
                           . We can observe that the intensity different map of cTSVD is too noisy to identify the asymmetry of LMCA and RMCA vessel structures, while AD, NLM and Global-SPD blurs the details of the vessel structure. Our proposed TS-SPD generates the different map with better contrast and spatial resolution for diagnosis of asymmetry in LMCA and RMCA.

By aggregating all voxels (within VOI) from the normal hemisphere into a single “normal” cluster and the pathologic hemisphere into an “abnormal” cluster, we have two clusters of n
                           1 normal voxels and n
                           2 ischemic voxels. To quantify the separability between normal and ischemic CBF values, we define the distance between these two clusters as:


                           
                              
                                 (21)
                                 
                                    d
                                    =
                                    
                                       
                                          
                                             m
                                             1
                                          
                                          −
                                          
                                             m
                                             2
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      σ
                                                      1
                                                      2
                                                   
                                                
                                                /
                                                
                                                   
                                                      n
                                                      1
                                                   
                                                
                                                )
                                                +
                                                (
                                                
                                                   
                                                      σ
                                                      2
                                                      2
                                                   
                                                
                                                /
                                                
                                                   
                                                      n
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           where m
                           1, m
                           2 are the means, and σ
                           1 and σ
                           2 are the standard deviations of CBF in the normal and ischemic clusters, respectively. We hypothesized that our TS-SPD algorithm to produce larger distance d as defined in Eq. (21), that is, to more definitely differentiate between normal and ischemic tissues. Table 2
                            shows the distance between normal and abnormal clusters for Case 1, 2 and all subjects with CTP deficits. Both SPD algorithms perform better than cTSVD, AD and NLM at low-dose and TS-SPD separates the two clusters with largest distance. More importantly, the other three enhancement methods tend to overestimate the CBF values of ischemic voxels due to the smoothing effect, while our proposed TS-SPD method recovers the true values of the ischemic voxels with better accuracy while removing the noise in the low-dose CBF maps.

Let us define sensitivity as the proportion of samples with abnormal CBF values, which test positive, and specificity as the proportion of samples with normal CBF values that test negative, at a specific threshold. Fig. 7
                            is the receiver operator characteristic (ROC) curve drawn based on 828 abnormal samples and 828 normal samples from the ischemic penumbra and its symmetric region of SAH patient in Fig. 5, in which we examine a spectrum of thresholds. The plot shows the tradeoff between true positive rate (sensitivity) and false positive rate (1−specificity). The closer the curve is to the upper left corner, the more accurate the test. Fig. 7 shows that TS-SPD is considerably more accurate than other four methods, leading to more efficient diagnosis.

In this paper, we have proposed a novel tissue-specific dictionary learning and deconvolution approach for CBF perfusion map enhancement in low-dose cerebral CTP. We take advantage of the distinctive image information of each tissue category available in the high-dose CBF maps to recover the missing texture and structural information in the low-dose CBF maps. This is achieved by performing a spatio-temporal sparse perfusion deconvolution based on tissue-specific dictionaries learned from high-dose CBF map segmentation. Our method consistently outperforms the state-of-art methods, especially in GM and WM where the cerebrovascular disease diagnosis mostly rely.

In spite of the fact that the tissue-specific dictionaries are learned from the segments of each type, the dictionaries and the deconvolution procedures do not heavily depend on the segmentation accuracy. This is because each tissue-specific dictionary is learned from over 10,000 patches and represents dominant patterns in training patches. The deconvolution will not only consider the dictionary but also the blood flow convolution model as well. From our in-vivo experiments, a certain amount of segmentation errors (e.g. >75% dice similarity of the segmentation accuracy) will not influence the overall quality of the dictionaries.

The running time for all the comparison algorithms is summarized in Table 3
                     , where the time required for the tissue-specific SPD is about 2min for a 512×512 voxel slice of the brain with 119 times points, compared to 28s for the KSVD-SPD without tissue class differentiation. This is clinically acceptable time for post-processing and parameter map computation, taking into account the improved accuracy and contrast at ischemic areas to assist clinical diagnosis.

There are two sets of parameters in this algorithm: μ
                     1 for the weight of the temporal convolution term, and μ
                     2 for the weight of the sparsity term. Because the reconstruction error from the temporal convolution term is larger compared to the sparsity penalty, a relatively smaller μ
                     1 around 1/10 or 1/20 of the value of μ
                     2 would be appropriate. For different tissue types, since vessels are more structured than other tissue types, and the anatomical structural complexity decreases for the four tissue types: vessels, gray matter, white matter and CSF, we give smaller sparsity penalty to the structured tissue types, and larger sparsity penalty to the smoother tissue type.

In the future, we will evaluate the feasibility of applying our method to facilitating low-dose radiation therapy in cerebrovascular disease diagnosis and evaluate its extension to other imaging modalities such as magnetic resonance perfusion (MRP) and PEC/SPECT.

@&#REFERENCES@&#

