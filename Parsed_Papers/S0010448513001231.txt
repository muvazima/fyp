@&#MAIN-TITLE@&#Efficient feature tracking of time-varying surfaces using multi-scale motion flow propagation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Present a multi-scale geometry motion flow for feature tracking of time-varying surfaces.


                        
                        
                           
                           We can track features on the time-varying surfaces in large deformation.


                        
                        
                           
                           We can process both mesh-based and point based time-varying surfaces.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multi-scale filtering

Time-varying surfaces

Geometry feature tracking

Geometry motion flow

Gaussian mixture model

@&#ABSTRACT@&#


               
               
                  This paper presents a framework for efficient feature tracking of time-varying surfaces. The framework can not only capture the dynamic geometry features on time-varying surfaces, but can also compute the accurate boundaries of the geometry features. The basic idea of the proposed approach is using the multi-scale motion flow and surface matching information to propagate the feature frame on time-varying surfaces. We first define an effective multi-scale geometry motion flow for the time-varying surfaces, which efficiently propagates the geometry features along the time direction of the time-varying surfaces. By combining both the approximately invariant signature vectors and geometry motion flow vectors, we also incorporate the shape matching into the system to process feature tracking for time-varying surfaces in large deformation while with low frame sampling rate. Our approach does not depend on the topological connection of the underlying surfaces. Thus, it can process both mesh-based and point-based time-varying surfaces without vertex-to-vertex correspondence across the frames. Feature tracking results on different kinds of time-varying surfaces illustrate the efficiency and effectiveness of the proposed method.
               
            

@&#INTRODUCTION@&#

Time-varying surfaces, also called animated objects or dynamic shapes, are given as a sequence of surface frames, each of which is a static geometry model (mesh based surface or point based surface). Recently, with the progress of advanced scanning technologies, it is possible to reconstruct time-varying surfaces from the point clouds scanned for deformed or animated objects  [1]. Time-varying surfaces are more expressive compared with static geometry models, and they are now a popular data representation method with wide applications in various fields, such as virtual reality, computer games, 3D animated films, product design and scientific computation visualization. As a promising data representation, a large number of research works on time-varying surfaces have been proposed, such as segmentation  [2–4], geometry reconstruction [1,5,6], geometry editing and modeling  [7,8].

In this paper, we aim at tracking geometry features of time-varying surfaces, namely, tracking the features’ motion paths of time-varying surfaces. Similar to video object tracking  [9], efficient feature tracking of time-varying surfaces is one of the critical tasks in many geometry processing applications such as geometry editing and modeling, geometry transmission, feature detection, and geometry description. However, unlike video tracking, where there are pixel-to-pixel correspondences among the consequent image frames, time-varying surfaces such as point-based geometry usually do not hold point-to-point correspondence among adjacent surfaces. Feature tracking of time-varying surfaces is a challenging job considering the following aspects:
                        
                           •
                           Capturing the dynamic geometry features with accurate boundaries over time-varying surfaces is difficult, especially when the boundaries of time-varying feature are fuzzy.

Time-varying surfaces usually do not hold point-to-point correspondence among adjacent surfaces, especially for point sampled geometry sequences, which increases the complexity of feature tracking of time-varying surfaces.

Data amount of time-varying surfaces is usually much larger than a single static object, thus the efficiency of feature tracking is one performance bottleneck which needs to be addressed.

To address aforementioned problems, we present a novel framework for efficient feature tracking of time-varying surfaces. The basic idea of the presented approach is to compute an efficient multi-scale geometry motion field for time-varying surfaces, which propagates the current geometry feature to the next frame according to the motion field variation. For time-varying surfaces with large deformation while with low frame sampling rate, we first perform surface matching between the neighboring frames, and then combine both the surface matching results and geometry motion flow vectors for accurate feature tracking. We build localized classifiers based on GMMs (Gaussian Mixture Models) over initial boundaries of the tracked feature to compute accurate and smooth feature boundaries. Our approach does not depend on the topological connection of the underlying surfaces, thus, it can process both mesh-based and point-based time-varying surfaces.

This paper introduces the following contributions: 
                        
                           •
                           Present a multi-scale geometry motion flow for efficient feature tracking of time-varying surfaces, which can process both mesh-based and point-based time-varying surfaces without vertex-to-vertex correspondence across the frames.

Integrate shape matching in the feature tracking system to process time-varying surfaces in large deformation with low frame sampling rate.

The rest of our paper is organized as follows. Section  2 reviews related work. Section  3 gives single-frame features and a multi-frame propagation method. In Section  4, we show experimental results and discussions. Finally, we conclude our paper in Section  5.

@&#RELATED WORK@&#

Many works on geometry processing of time-varying surfaces have been proposed; a comprehensive overview for these topics is beyond the scope of this paper. We only give the most related works such as feature tracking, shape matching, and surface reconstruction of time-varying surfaces.

Several methods have been proposed for feature tracking of time-varying surfaces. Some approaches use strong shape prior knowledge to find feature tracking of time-varying surfaces, such as parametric models  [10,11], machine learning  [12] or modal approaches  [13]. Vlasic et al.  [10] and Gall et al.  [11] optimized the pose of skeletal models before fitting the surface to visual data. In the case of data-driven time-varying face surfaces, Chai et al.  [12] tracked a low number of facial features. By using machine learning techniques and a database of laser scanned faces, they mapped these features back onto a linear combination of previously acquired high resolution motion data to complete the feature tracking. Salzmann et al.  [13] tracked a piece of 3D deforming cloth, and they applied Principal Component Analysis on a randomly generated set of possible configurations to constrain the space of acceptable deformations and to reduce the optimization complexity. One drawback of these approaches is that they depend on a strong shape prior knowledge.

Other approaches  [14,15] used little prior knowledge to perform geometry feature tracking for time-varying surfaces. For example, segmentation methods  [15] applied vertex position optimization techniques and used prior knowledge as a regularization term to control vertex moving. However, these two methods operated at each vertex and would lead to difficult non-linear optimization for time-varying surfaces with strong noise. A patch based mesh tracking method  [15] can receive satisfactory tracking optimization for time-varying surfaces with local deformation, however, this method assumed that the local deformations should be rigid transformations, and may not work well for tracking non-rigid features.

In the fluid simulation community, many methods have been presented to track fluid surfaces. These method usually track topology-changing evolving surfaces incorporating with velocity fields or prescribed motions. Level set methods  [16] and particle level set methods  [17] are two preventive techniques for describing a dynamic implicit surface. These two methods consider the zero level set of a voxelized signed distance function, and integrate velocity information into the distance function to move the function, which can effectively track the surface evolution. Mesh-based surface tracking methods in surface evolvers also have been proposed, the idea behind these techniques is to evolve a triangle mesh according to a velocity field  [18]. More recently, Hansen et al.  [19] tracked temporally coherent, deforming triangle mesh with topology changing. They solved this problem using the surface geometry alone, without prior information like surface templates or velocity fields.

Shape matching is critical for geometry processing. A variety of methods have been proposed; refer to  [20] for a survey. Shape matching between inconsistent surfaces is also critical for dynamic geometry processing and reconstruction; several methods have also been proposed  [8,21,22]. Inspired by the SIFT method  [23], Li et al.  [24] extracted feature points and proposed a multi-scale representation for surface matching; in our paper, we will borrow some shape matching ideas from  [24] for our feature tracking. Mitra et al.  [5] computed a globally consistent motion spanning multiple frames for shape matching. They added a time coordinate to all the input points based on the ordering of the respective frames, and considered the problem of computing the motion of each frame as an estimation of certain kinematic properties of the resulting space–time surfaces. Wand et al.  [6] estimated a globally consistent template matching model for the reconstruction of deforming geometry from unstructured noisy point cloud sequences, they later improved their method in  [25]. More recently, Li et al.  [1] proposed a temporally coherent completion method for scanned dynamic shapes using a non-rigid surface registration algorithm.

There are some other works that are closely related to ours, such as tracking and modeling of non-rigid objects  [26], surface reconstruction for time-varying surfaces  [27,6], and performance capture  [28–32]. For example, Torresani et al.  [26] computed the deformable template and the motion directly from the image sequences. They recovered non-rigid structure from one single video assuming the shape lies within a linear subspace. This method is promising and works well from regular video streams. Sharf et al.  [27] introduced a volumetric space–time technique for the reconstruction of deforming objects from point data, they described the motion of the object as an incompressible flow of material through time, and reconstructed coherent sequences of watertight models from incomplete scanner data. Bradley et al.  [28] and De Aguiar et al.  [29] took advantage of temporal information to deform or to track key models for topology-preserving reconstruction.

We assume that the initial frame of the features in time-varying surfaces have been extracted, which can be specified by interactive features segmentation  [33,34]. Then with input time-varying surfaces without vertex-to-vertex correspondence across the frames, the desired output is the tracked dynamic feature with accurate boundaries over time-varying surfaces. In order to efficiently track the dynamic features of time-varying surfaces, we first compute the multi-scale geometry motion flow vectors 
                        
                           
                              v
                           
                           →
                        
                       for the time-varying surfaces, and with the motion flow vectors, we track the geometry features by propagating the features to successive frames. Then we build localized classifiers based on GMMs to compute more accurate feature boundaries. Finally, we integrate the surface matching method into the tracking system to track dynamic features in large deformations with low frame sampling rates.

Let the time-varying surfaces 
                           P
                           =
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    T
                                 
                              
                              )
                           
                         be a sequence of 
                           T
                         frame surfaces, where 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         is the 
                           t
                        th frame surface with 
                           
                              
                                 n
                              
                              
                                 t
                              
                           
                         points; we refer to the index 
                           t
                         as “time”. Let 
                           F
                         be a feature on 
                           P
                        . In our method, the feature 
                           F
                         is a connected subpart of the surface 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                        , and is usually a non-trivial local shape and contains salient parts of the model. The boundaries of the feature are usually edges of the model. Inspired by the optic flow computation in image sequences  [35–38], we track the geometry feature 
                           F
                         by propagating the initial frame 
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                         of 
                           F
                         along the motion flow field 
                           
                              
                                 V
                              
                              →
                           
                         of 
                           P
                         to the next successive frames.

To estimate the flow field between frame 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                         and its successive frame 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 δ
                                 t
                              
                           
                         to propagate the geometry feature 
                           F
                        , we consider a point 
                           p
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              ,
                              t
                              )
                           
                         in 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                         with normal 
                           N
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              ,
                              t
                              )
                           
                        , where 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         denotes the location of 
                           p
                        , and 
                           t
                           ∈
                           
                              [
                              0
                              ,
                              T
                              ]
                           
                         denotes time (frame). Let 
                           N
                           
                              (
                              x
                              +
                              δ
                              x
                              ,
                              y
                              +
                              δ
                              y
                              ,
                              z
                              +
                              δ
                              z
                              ,
                              t
                              +
                              δ
                              t
                              )
                           
                         denote the normal of its corresponding point 
                           p
                           
                              (
                              x
                              +
                              δ
                              x
                              ,
                              y
                              +
                              δ
                              y
                              ,
                              z
                              +
                              δ
                              z
                              ,
                              t
                              +
                              δ
                              t
                              )
                           
                         in frame 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 δ
                                 t
                              
                           
                        . The motion flow computation requires both the position of the points and their normals. More specially, the motion flow computation for each point 
                           p
                         on 
                           P
                         is based on the normal constancy assumption, that is, we assume the deviation 
                           δ
                         from normal constancy is minimal for each point of the feature 
                           F
                         in the subsequent frames: 
                           
                              
                                 δ
                                 =
                                 N
                                 
                                    (
                                    x
                                    +
                                    δ
                                    x
                                    ,
                                    y
                                    +
                                    δ
                                    y
                                    ,
                                    z
                                    +
                                    δ
                                    z
                                    ,
                                    t
                                    +
                                    δ
                                    t
                                    )
                                 
                                 −
                                 N
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    ,
                                    t
                                    )
                                 
                                 .
                              
                           
                        
                     

The deviation 
                           δ
                         can be approximated by using the first order Taylor expansion: 
                           δ
                           =
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           u
                           +
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                           v
                           +
                           
                              
                                 N
                              
                              
                                 z
                              
                           
                           w
                           +
                           
                              
                                 N
                              
                              
                                 t
                              
                           
                        , where 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                           ,
                           
                              
                                 N
                              
                              
                                 z
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 t
                              
                           
                         are vectors of 3×1, and denote the normal gradient of 
                           N
                         in the 
                           x
                           ,
                           y
                           ,
                           z
                           ,
                           t
                         axes, respectively. More specially, 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                         is computed as the difference between the normal of 
                           p
                         and the average normal of the spatially neighboring points of point 
                           p
                         in the 
                           X
                         axis direction, and 
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 z
                              
                           
                         are defined in the same way. 
                           
                              
                                 N
                              
                              
                                 t
                              
                           
                         is computed as the difference of normal of 
                           p
                         and the average normal of the points in the temporal neighborhood of 
                           p
                        . The three-dimensional vectors 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 p
                              
                           
                           =
                           
                              (
                              u
                              ,
                              v
                              ,
                              w
                              )
                           
                         are the 3D motion flow vectors of point 
                           p
                        , where 
                           u
                           =
                           δ
                           x
                           /
                           δ
                           t
                           ,
                           v
                           =
                           δ
                           y
                           /
                           δ
                           t
                           ,
                           w
                           =
                           δ
                           z
                           /
                           δ
                           t
                        . Assume that 
                           δ
                           =
                           
                              (
                              0
                              ,
                              0
                              ,
                              0
                              )
                           
                        , we have 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           u
                           +
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                           v
                           +
                           
                              
                                 N
                              
                              
                                 z
                              
                           
                           w
                           =
                           −
                           
                              
                                 N
                              
                              
                                 t
                              
                           
                        , which is considered as a motion flow constraint for motion flow computation. Motion flow 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 p
                              
                           
                         computed in this strategy is called the local flow computation method.

However, the local method does not allow a reliable determination of full motion flow, especially at the homogeneous regions on the time-varying surfaces, which may result in nondense flow fields. Inspired by Horn and Schunck’s global optical flow computation in image sequences  [35], the neighboring points should have similar motion velocities in regions where the surface varies smoothly almost everywhere. We express this so as to minimize the square of the magnitude of the gradient of the motion flow vector 
                           
                              
                                 v
                              
                              →
                           
                        , and add an additional smoothing regulation term to the local method. We come to minimize the following energy function: 
                           
                              (1)
                              
                                 F
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                N
                                             
                                             
                                                x
                                             
                                          
                                          u
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                y
                                             
                                          
                                          v
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                z
                                             
                                          
                                          w
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             |
                                             ∇
                                             u
                                             |
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             |
                                             ∇
                                             v
                                             |
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             |
                                             ∇
                                             w
                                             |
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 d
                                 x
                                 d
                                 y
                                 d
                                 z
                                 ,
                              
                           
                         where 
                           D
                         is the spatio-temporal neighborhood domain of point 
                           p
                         over the surfaces 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                        , and the magnitude of 
                           α
                         reflects the relative influence of the regulation term. 
                           ∇
                           u
                           =
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    y
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    z
                                 
                              
                              )
                           
                         are the 3D velocity derivatives at point 
                           p
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              ,
                              t
                              )
                           
                           ,
                           
                              
                                 u
                              
                              
                                 x
                              
                           
                         is computed as the difference between 
                           u
                         and the average 
                           u
                         value of the spatial neighboring points of point 
                           p
                         in the 
                           X
                         axis direction, with a similar definition for 
                           
                              
                                 u
                              
                              
                                 y
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 z
                              
                           
                        . 
                           ∇
                           v
                         and 
                           ∇
                           w
                         can be defined in the same way.

Minimizing the functional equation (1) can be obtained by solving its corresponding Euler–Lagrange equations. Let 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                         be the dot product between two vectors: 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           ⋅
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                        , and 
                           
                              
                                 N
                              
                              
                                 x
                              
                              
                                 2
                              
                           
                         be dot product between vectors: 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                           ⋅
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                        , with a similar definition for other vectors; we can rewrite the Euler–Lagrange equations as: 
                           
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    u
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    v
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    w
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          2
                                       
                                    
                                    u
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    u
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    v
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    w
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          2
                                       
                                    
                                    v
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    u
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    v
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    w
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          2
                                       
                                    
                                    w
                                    .
                                 
                              
                           
                         By approximating 
                           
                              
                                 ∇
                              
                              
                                 2
                              
                           
                           u
                           ≈
                           
                              
                                 u
                              
                              ¯
                           
                           −
                           u
                           ,
                           
                              
                                 ∇
                              
                              
                                 2
                              
                           
                           v
                           ≈
                           
                              
                                 v
                              
                              ¯
                           
                           −
                           v
                           ,
                           
                              
                                 ∇
                              
                              
                                 2
                              
                           
                           w
                           ≈
                           
                              
                                 w
                              
                              ¯
                           
                           −
                           w
                        , where 
                           
                              
                                 u
                              
                              ¯
                           
                           ,
                           
                              
                                 v
                              
                              ¯
                           
                         and 
                           
                              
                                 w
                              
                              ¯
                           
                         are three components of 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 ̄
                              
                           
                        , and 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 ̄
                              
                           
                         is the velocity average of those points in the spatial neighborhood of point 
                           p
                         in current frame. Then we receive: 
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    u
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    v
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    w
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          u
                                       
                                       ¯
                                    
                                    −
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    u
                                    +
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    v
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    w
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          v
                                       
                                       ¯
                                    
                                    −
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    u
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    v
                                    +
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    w
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          w
                                       
                                       ¯
                                    
                                    −
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    .
                                 
                              
                           
                         This can be rewritten in an alternative form: 
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       u
                                       −
                                       
                                          
                                             u
                                          
                                          ¯
                                       
                                       )
                                    
                                    =
                                    −
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                       
                                       
                                          
                                             u
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                       
                                       
                                          
                                             v
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                       
                                       
                                          
                                             w
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       v
                                       −
                                       
                                          
                                             v
                                          
                                          ¯
                                       
                                       )
                                    
                                    =
                                    −
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                       
                                       
                                          
                                             u
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                       
                                       
                                          
                                             v
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                       
                                       
                                          
                                             w
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       w
                                       −
                                       
                                          
                                             w
                                          
                                          ¯
                                       
                                       )
                                    
                                    =
                                    −
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                       
                                       
                                          
                                             u
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                       
                                       
                                          
                                             v
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                       
                                       
                                          
                                             w
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

We can use the Gauss–Seidel iteration to solve the motion flow field 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 p
                              
                           
                         from the above equations, which can be performed in the following formulation: 
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                u
                                             
                                             ¯
                                          
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                x
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                v
                                             
                                             ¯
                                          
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                y
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                w
                                             
                                             ¯
                                          
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                z
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   z
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The 
                           
                              
                                 
                                    
                                       u
                                    
                                    ¯
                                 
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 
                                    
                                       v
                                    
                                    ¯
                                 
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    
                                       w
                                    
                                    ¯
                                 
                              
                              
                                 k
                              
                           
                         are velocity averages of points in the neighborhoods at iteration 
                           k
                        . The initial values of 
                           
                              
                                 
                                    
                                       u
                                    
                                    ¯
                                 
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 
                                    
                                       v
                                    
                                    ¯
                                 
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 
                                    
                                       w
                                    
                                    ¯
                                 
                              
                              
                                 0
                              
                           
                         are typically set to 0.0. The motion flow field 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 p
                              
                           
                         can also be solved using the multi-grid method, which can be accelerated about 50 times more than the Gauss–Seidel method.

The geometry details and noises of time-varying surfaces will perturb the geometry motion flow computation. To make the motion flow computation more robust and receive more accurate results, we build the motion flow models over the coarser time-varying surfaces with the detail layers attenuated. Since progressively coarser levels increase the degree of smoothness in the resulting time-varying surfaces, we build a motion flow for each level of time-varying surfaces and combine them together in a spatially varying manner to provide more consistent motion flow results. Based on this observation, we present a multi-scale optical flow method.

Inspired by the geometry bilateral filter  [39], we first compute a multi-scale representation for the time-varying surfaces. For the input time-varying surface 
                           P
                        , the goal of the multi-scale spatio-temporal bilateral filtering is to build a series of filtered surfaces 
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                         that preserve the strongest features while smoothing small changes in geometry. At the finest scale 
                           j
                           =
                           0
                        , we set 
                           
                              
                                 P
                              
                              
                                 0
                              
                           
                           =
                           P
                         and then iteratively apply the bilateral filter to compute 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       D
                                       
                                          (
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       ‖
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             j
                                          
                                       
                                       ‖
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       G
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       〈
                                       
                                          
                                             n
                                          
                                          
                                             
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             j
                                          
                                       
                                       〉
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       q
                                    
                                    
                                       j
                                    
                                 
                              
                           
                         with 
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       D
                                       
                                          (
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       ‖
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             j
                                          
                                       
                                       ‖
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       G
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       〈
                                       
                                          
                                             n
                                          
                                          
                                             
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             j
                                          
                                       
                                       〉
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         and 
                           
                              
                                 q
                              
                              
                                 j
                              
                           
                         denote the points 
                           p
                         and 
                           q
                         at scale 
                           j
                        . 
                           D
                           
                              (
                              p
                              )
                           
                         is the spatio-temporal neighborhood of vertex 
                           p
                         and 
                           
                              
                                 G
                              
                              
                                 σ
                              
                           
                         is a Gaussian function, and 
                           
                              
                                 σ
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 r
                              
                           
                         are the widths of the spatial and range Gaussians respectively. In our experiments, 
                           
                              
                                 σ
                              
                              
                                 s
                              
                           
                         is set to the radius of the spatio-temporal neighborhood, and 
                           
                              
                                 σ
                              
                              
                                 r
                              
                           
                         is set to the standard deviation of the offsets 
                           
                              〈
                              
                                 
                                    n
                                 
                                 
                                    
                                       
                                       
                                          p
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              −
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                              
                              〉
                           
                         in the neighborhood. In our experiments, the size of the spatio-temporal neighborhood includes 12–18 points, which depends on the sampling density of the point set. For a dense point set, the size is set to a relatively large value, and for a coarse point set, the size is set to a relatively small value. If the data set is filtered using the weighted average of a large size of points, the features of the point set may be smoothed. With the filtered time-varying surfaces, we then compute motion flows 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 j
                              
                           
                         for each scale representation 
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                         of the time-varying surfaces.

To make the 
                           j
                        th scale motion flow 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 j
                              
                           
                         smoother, we propose a motion flow vector filtering function that incorporates the information from both the spatial and temporal domains in each scale of the time-varying surface. Let 
                           
                              
                                 D
                              
                              
                                 ∗
                              
                           
                           
                              (
                              p
                              )
                           
                         be the spatio-temporal neighborhood of point 
                           p
                           ,
                           
                              
                                 D
                              
                              
                                 t
                              
                              
                                 ∗
                              
                           
                           
                              (
                              p
                              )
                           
                           ∈
                           
                              
                                 D
                              
                              
                                 ∗
                              
                           
                           
                              (
                              p
                              )
                           
                         be the neighborhood of point 
                           p
                         from the 
                           t
                        th frame, 
                           k
                         be the number of the neighboring frames of 
                           t
                        th frame in time axis (
                           k
                           =
                           2
                         in our experiments). For each scale 
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                         of time-varying surfaces, we compute the optimized motion flow 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 p
                              
                              
                                 j
                              
                           
                         for each surface frame as follows: 
                           
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          →
                                       
                                    
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             f
                                             =
                                             t
                                             −
                                             k
                                          
                                          
                                             t
                                             +
                                             k
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             ∈
                                             
                                                
                                                   D
                                                
                                                
                                                   f
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             ‖
                                             p
                                             −
                                             q
                                             ‖
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             G
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             ‖
                                             
                                                
                                                   N
                                                
                                                
                                                   p
                                                
                                             
                                             −
                                             
                                                
                                                   N
                                                
                                                
                                                   q
                                                
                                             
                                             ‖
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                →
                                             
                                          
                                          
                                             q
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             f
                                             =
                                             t
                                             −
                                             k
                                          
                                          
                                             t
                                             +
                                             k
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             ∈
                                             
                                                
                                                   D
                                                
                                                
                                                   f
                                                
                                                
                                                   ∗
                                                
                                             
                                             
                                                (
                                                p
                                                )
                                             
                                          
                                       
                                       
                                          
                                             G
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             ‖
                                             p
                                             −
                                             q
                                             ‖
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             G
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             ‖
                                             
                                                
                                                   N
                                                
                                                
                                                   p
                                                
                                             
                                             −
                                             
                                                
                                                   N
                                                
                                                
                                                   q
                                                
                                             
                                             ‖
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

With the computed optical flows 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 j
                              
                           
                         for each point in each scale, we compute the final geometry flow of the point 
                           p
                         as the weighted average of motion flow in each scale: 
                           
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          →
                                       
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             M
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ω
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                →
                                             
                                          
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             M
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ω
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ω
                              
                              
                                 j
                              
                           
                         is weight for each scale and is defined as 
                           
                              
                                 ω
                              
                              
                                 j
                              
                           
                           =
                           1
                           .
                           
                              
                                 2
                              
                              
                                 j
                              
                           
                           −
                           0.6
                        , and 
                           M
                         is the number of the scales. The weight 
                           
                              
                                 ω
                              
                              
                                 j
                              
                           
                         prefers a coarser surface by giving them larger weight because the geometry noise is smoothed more. In our experiments, we find that setting number 
                           M
                           =
                           4
                         generates good results.

In Figs. 1 and 2
                        
                        , we give the comparison results between the motion flow computed on the single-scale strategy and multi-scale strategy. As illustrated in Figs. 1 and 2, the motion flow computed on multi-scale time-varying surfaces are smoother and more accurate.

After computing the motion flow 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 p
                              
                           
                           =
                           
                              (
                              u
                              ,
                              v
                              ,
                              w
                              )
                           
                         for each point 
                           p
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              ,
                              t
                              )
                           
                         on frame 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                        , we can find its corresponding point in the next frame 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 1
                              
                           
                         by propagating this point along its motion flow 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 p
                              
                           
                        . For point 
                           p
                        , we compute its propagated points along 
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 p
                              
                           
                         as 
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                           =
                           p
                           +
                           
                              
                                 
                                    
                                       v
                                    
                                    →
                                 
                              
                              
                                 p
                              
                           
                        , then we search a point 
                           
                              
                                 p
                              
                              
                                 ∗
                              
                           
                         in 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 1
                              
                           
                         that is nearest to point 
                           
                              
                                 p
                              
                              
                                 ′
                              
                           
                        . We apply the ANN method  [40] for nearest neighbor point search, and the 
                           ϵ
                         used in ANN is chosen as 0.3. Using this method, for each frame 
                           
                              
                                 F
                              
                              
                                 t
                              
                           
                         in feature 
                           F
                        , we can find its corresponding feature frame 
                           
                              
                                 F
                              
                              
                                 t
                                 +
                                 1
                              
                           
                         in 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 1
                              
                           
                        , and the feature 
                           F
                         propagates along the motion flow.

Note that using this feature propagation method, there are cases that some points in feature frame 
                           
                              
                                 F
                              
                              
                                 t
                                 +
                                 1
                              
                           
                         cannot find corresponding points in 
                           
                              
                                 F
                              
                              
                                 t
                              
                           
                        , for example, when the features become larger. In this case, we apply the local flood filling techniques to make 
                           
                              
                                 F
                              
                              
                                 t
                                 +
                                 1
                              
                           
                         coherent and compact. For each point 
                           p
                         in 
                           
                              
                                 F
                              
                              
                                 t
                                 +
                                 1
                              
                           
                         that has a corresponding point in 
                           
                              
                                 F
                              
                              
                                 t
                              
                           
                        , we detect its neighboring points in 
                           
                              
                                 F
                              
                              
                                 t
                                 +
                                 1
                              
                           
                         that have no corresponding points in 
                           
                              
                                 F
                              
                              
                                 t
                              
                           
                        , and include these points in the feature.

The dynamic features can be tracked effectively using above tracking method, however, sometimes the feature boundaries may look rough and not smooth, which need to be refined further.

Inspired by  [41], Lee et al.  [2] applied the maximum flow minimum cut algorithm to process boundary refinement of the deforming mesh. However, this method is applicable for a triangle mesh, and is inappropriate for point-sampled geometry. Furthermore, it processes the boundary smoothing frame by frame, thus it is difficult to maintain the boundaries temporally coherent. In this section, inspired by  [4], we apply a probability optimization method to generate convincing and coherent results.

The main idea of our boundaries smoothing operations is to use the geometric information (normal) and motion velocities around the initial boundaries to determine accurate boundaries  [4]. As shown in Fig. 3
                        , a narrow boundary band 
                           W
                         is built around the initial boundaries which envelops the whole boundaries. Our target is to decide the accurate boundaries in 
                           W
                        . The size of 
                           W
                         can vary with regard to the size of the object features.

We build both foreground band 
                           F
                         and background band 
                           B
                         regions around 
                           W
                        , and build Gaussian Mixture Models (GMMs) for both 
                           F
                         and 
                           B
                         using the geometric information and motion velocities. Every point 
                           p
                         inside the band 
                           W
                         can be assigned a foreground probability. Depending on the probability value belonging to the foreground 
                           F
                         or the background 
                           B
                        , accurate boundaries can be determined.

For a point 
                           p
                         in the band 
                           W
                        , its foreground probability 
                           
                              
                                 
                                    GMM
                                 
                              
                              
                                 F
                              
                           
                           
                              (
                              p
                              )
                           
                         is computed as follows: 
                           
                              
                                 
                                    GMM
                                 
                              
                              
                                 F
                              
                           
                           
                              (
                              p
                              )
                           
                           =
                           
                              GMM
                           
                           
                              (
                              p
                              |
                              F
                              )
                           
                           /
                           
                              (
                              
                                 GMM
                              
                              
                                 (
                                 p
                                 |
                                 F
                                 )
                              
                              +
                              
                                 GMM
                              
                              
                                 (
                                 p
                                 |
                                 B
                                 )
                              
                              )
                           
                         where 
                           
                              GMM
                           
                           
                              (
                              p
                              |
                              F
                              )
                           
                         and 
                           
                              GMM
                           
                           
                              (
                              p
                              |
                              B
                              )
                           
                         are the corresponding probabilities for point 
                           p
                         computed from the two GMMs for 
                           F
                         and 
                           B
                        , respectively. The background probability 
                           
                              
                                 
                                    GMM
                                 
                              
                              
                                 B
                              
                           
                           
                              (
                              p
                              )
                           
                         of point 
                           p
                         is defined in a similar way. Then, the point 
                           p
                         can be classified efficiently by evaluating foreground and background probability value: if 
                           
                              
                                 
                                    GMM
                                 
                              
                              
                                 B
                              
                           
                           
                              (
                              p
                              )
                           
                           >
                           
                              
                                 
                                    GMM
                                 
                              
                              
                                 F
                              
                           
                           
                              (
                              p
                              )
                           
                        , point 
                           p
                         belongs to the foreground 
                           F
                        , otherwise 
                           p
                         belongs to background 
                           B
                        . Note that to keep the boundaries of the dynamic feature temporally coherent, both foreground band 
                           F
                         and background band 
                           B
                         should be in the spatio-temporal neighborhood of the current frame. For more details refer to  [4].

The size of 
                           W
                         can vary according to the complexity of the boundary. Usually, in our experiments, for each point on the boundary, its nearest 10 points are included in 
                           W
                        , and receive satisfactory results. As illustrated in Fig. 3, using the proposed boundary refinement operator, the initial boundaries of dynamic features are refined to receive more accurate results.

For time-varying surfaces in large deformation with low frame sampling rate, we also integrate shape matching into our system to obtain more accurate feature tracking results. To perform surface matching, for two successive frames 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 1
                              
                           
                        , we first estimate SIFT feature points  [24] for each frame of the time-varying surfaces, then incorporating both the SIFT feature points and the motion flow vectors, we perform multi-scale surface matching.

More specially, inspired by the SIFT method  [23,24], we extract salient feature points on the time-varying surfaces for surface matching. These feature points need not to represent visually important portions of the time-varying surfaces, but be a stable set of feature points for surface matching. As illustrated in Fig. 4
                        , we detect the salient features for each frame of the time-varying surfaces. We can observe that the most salient features exist on each frame. These feature points have several attributes (the position, the normal, and the scale) that can be used to perform surface matching. However, these attributes are not invariant under shape rigid transformation or scaling. In order to enable efficient matching for the surfaces, we endow each feature point 
                           p
                         with a signature vector 
                           
                              
                                 σ
                              
                              
                                 p
                              
                           
                           
                              (
                              p
                              ,
                              n
                              ,
                              h
                              )
                           
                         that is invariant under shape rigid transformation or scaling  [24]. By applying the repeatability of the feature points on surfaces, we compare the feature sets with the signature set for shape matching.

To perform surface matching between the neighboring frames, for each frame 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                        , based on the detected surface feature points and their corresponding signature vectors, we compute a transformation combined rotation matrix 
                           
                              
                                 R
                              
                              
                                 t
                              
                           
                         and translation vector 
                           
                              
                                 S
                              
                              
                                 t
                              
                           
                        . With this transformation we match 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                         with its consequent frame 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 1
                              
                           
                        , such that 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                         overlaps 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 1
                              
                           
                         within some common regions. For more accurate matching, we can combine both the neighboring frame information of 
                           
                              
                                 P
                              
                              
                                 t
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 2
                              
                           
                         into surface matching. With the surface matching results, for each point in the current frame, we can find a more accurate spatio-temporal neighborhood used in Eq. (1) for motion flow estimation from 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                         to 
                           
                              
                                 P
                              
                              
                                 t
                                 +
                                 1
                              
                           
                        , which is more accurate than the results computed without using surface matching.

As illustrated in Fig. 4, we present a feature tracking example for time-varying surfaces in large deformation with low frame sampling rate; the features are effectively tracked out.

So far we have only described a forward propagation workflow, where the user sets an initial starting surface for the dynamic feature, and lets the features propagate forward. The feature tracking generated by the single-frame propagation system may contain errors. These errors might lead to more errors in the next frame if a simple frame-by-frame propagation is adopted, especially for processing time-varying surfaces with large deformation, fuzzy boundary region, feature splitting and merging, or time-varying surfaces with long sequences. Thus, if no constraints are applied, the tracked dynamic features might gradually drift away, resulting in amplified errors in the propagation process. For example, dynamic objects often present topology changes; a robust system needs to be able to handle these topological changes. Inspired by video object tracking  [9], in this section, we present multi-scale propagation to address these problems.

Alternatively, we can define two key frames for the dynamic feature 
                           F
                         at time 
                           
                              
                                 P
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                         (we assume 
                           
                              
                                 P
                              
                              
                                 s
                              
                           
                         comes before 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                         in the time order), and track all intermediate frames using both constraints. To achieve this we carry out two individual propagation processes: a forward propagation from 
                           
                              
                                 P
                              
                              
                                 s
                              
                           
                         to 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                        , and a backward propagation from 
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                         to 
                           
                              
                                 P
                              
                              
                                 s
                              
                           
                        . For an intermediate frame 
                           r
                        , the two processes merge. Formally, the feature tracking map on frame 
                           r
                         is computed as 
                           
                              
                                 p
                              
                              
                                 F
                              
                              
                                 r
                              
                           
                           
                              (
                              
                                 
                                    v
                                 
                                 →
                              
                              )
                           
                           =
                           
                              
                                 
                                    (
                                    r
                                    −
                                    s
                                    )
                                 
                                 ⋅
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                    
                                       s
                                       →
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       →
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    t
                                    −
                                    r
                                    )
                                 
                                 ⋅
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                    
                                       t
                                       →
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       →
                                    
                                    )
                                 
                              
                              
                                 t
                                 −
                                 s
                              
                           
                        , where 
                           
                              
                                 p
                              
                              
                                 F
                              
                              
                                 s
                                 →
                                 r
                              
                           
                           
                              (
                              
                                 
                                    v
                                 
                                 →
                              
                              )
                           
                         and 
                           
                              
                                 p
                              
                              
                                 F
                              
                              
                                 t
                                 →
                                 r
                              
                           
                           
                              (
                              
                                 
                                    v
                                 
                                 →
                              
                              )
                           
                         are the corresponding feature tracking maps for frame 
                           r
                         computed from the forward and backward processes, respectively. The tracking map 
                           
                              
                                 p
                              
                              
                                 F
                              
                              
                                 r
                              
                           
                           
                              (
                              
                                 
                                    v
                                 
                                 →
                              
                              )
                           
                         is more accurate than 
                           
                              
                                 p
                              
                              
                                 F
                              
                              
                                 s
                                 →
                                 r
                              
                           
                           
                              (
                              
                                 
                                    v
                                 
                                 →
                              
                              )
                           
                         and 
                           
                              
                                 p
                              
                              
                                 F
                              
                              
                                 t
                                 →
                                 r
                              
                           
                           
                              (
                              
                                 
                                    v
                                 
                                 →
                              
                              )
                           
                        , which results in more accurate tracking results. For more complex time-varying surfaces, we can specify more keyframes on the feature. With the single-frame propagation system and multi-frame propagation system, our system thus has the flexibility of switching between different workflows based on the user’s choice.


                        Fig. 5
                         shows feature tracking results on time-varying surfaces consisting of 110 frames. In this example, we track a disappearing and reappearing feature using the presented multi-frame propagation system, and achieve desired results.

In this section, we present experimental results received using the presented method, and provide feature tracking examples for both mesh based and point based time-varying surfaces. We also compare our algorithm to related works on both performance and quality. Our approach is implemented using C
                        +
                        +
                      on a machine equipped with a Pentium (R) Dual-Core CPU E5200@2.50 GHz with 2 GB RAM.

In Fig. 5, we present a tracking result using the multi-frame propagation method for mesh-based time-varying surfaces with 110 frames. As the specified feature is disappearing and reappearing, single-frame propagation does not work well for this case, so we apply the multi-frame propagation method to track the feature. In this example, we use the first and the last frame as the key frames, and receive satisfactory results.

In Fig. 6
                     , we give multi-feature tracking results for point based time-varying surfaces, which are elephant to horse morphing sequences. We track three object features, the tusk, trunk and ears of the elephant. The time-varying surfaces consist of 201 frame surfaces. The number of sampled points in each frame is not identical, and the average number of points in each frame is 85,000. The computational time for each frame in the tracking process is 1.89 s. In this example, we use simple single-frame propagation and do not employ the multi-frame propagation method, we also do not apply shape matching in the feature tracking procedure.

In Figs. 7 and 8
                     
                     , we give comparison results with the feature tracking results of method  [15]. Cagniart et al.  [15] considered deformation of the time-varying surfaces using patches and assumed that each one transformed rigidly. In addition, Cagniart et al.  [15] needed a reference mesh to constrain the topological nature of the time-varying surfaces for feature tracking. In these examples, the features have large deformation and some features are rigid. As shown in Figs. 7 and 8, our method can achieve the better feature tracking results than  [15]. In Figs. 7 and 8, the time-varying cat surfaces consist of 
                        30
                        ∖
                        80
                      frame surfaces, the averaged number of vertices in each frame is 
                        17
                        ,
                        800
                        ∖
                        42
                        ,
                        300
                     , and the cost time using our method for tracking each frame is 
                        0.62
                        ∖
                        0.92
                        
                        
                           s
                        
                     , respectively.

In Fig. 9
                     , we give a feature tracking result for point-based time-varying face surfaces. We track three object features, left eye, right eye and mouth. The time-varying surfaces consist of 385 frame surfaces. In this example, the boundaries of the features are fuzzy, and the surface sequence is long, the errors occurring in one frame might lead to more errors in the next frame if a single-frame propagation is adopted. We use multi-frame propagation and select three key frames. We give comparison results with the segmentation results of the time-varying surfaces  [4]. Liao et al.  [4] considered the time-varying surfaces as a whole and extracted the near-rigid components. In these examples, the features are non-rigid components, although method  [4] works well in time-varying surfaces segmentation, it is not an ideal tool for tracking non-rigid features. The average number of vertices in each frame is 23,725; the cost time using our method for tracking each frame is 0.73 s.

In Fig. 10
                     , we present feature tracking results for another point-based based time-varying surface with non-rigid components. In this example, we track three features on a deforming penguin. The feature tracking methods that focus on tracking the rigid components may not work well on this example. Our feature tracking method based on geometry motion flow is the appropriate tool for this example. As illustrated in Fig. 10, the three features are effectively tracked.


                     Figs. 11 and 12
                     
                      gives more feature tracking results for two dancing time-varying surfaces. In these two examples, we first perform a segmentation process for the first (key) frame using the interactive mesh segmentation method  [33], and segment it into several parts and each part is considered a feature. As the time-varying surfaces are in large deformation with low frame sampling rate, we integrate the SIFT features matching into our system for obtaining effective feature tracking results. In Figs. 11 and 12, there are 90 and 101 frames in the animations, with an average of 31,775 and 35,648 points in each frame, respectively. We detect about 321 and 343 feature points for each frame for shape matching in these two examples, respectively. As the input time-varying surfaces are smooth, we use a two-scale representation for computing the motion-flow and find that works well. We also apply the GMM boundary refinement to compute accurate boundaries, and take about 0.78 and 0.83 s to perform the boundary processing.

In Figs. 13 and 14
                     
                     , we have performed feature tracking processing on data with a highly varying numbers of vertices. The data is from INRIA (http://4drepository.inrialpes.fr/public/datasets). In these examples, the original surfaces from INRIA are triangular meshes. Note that in these models, the motions of individual vertices are not smooth, and local geometry features almost change in a short time window. To show the robustness of the proposed method, we further resample the input data into two kinds of point sets, one kind of resampling result is uniform sampling, and one kind of resampling result is non-uniform sampling. In Figs. 13 and 14, the minimum points of one surface frame are 5704, and 5336, respectively, and the maximum points are 59,853, and 82,914, respectively. In Fig. 13, we tracked the moving head and the two moving arms for both kinds of data, and received pleasing results for these two kinds of data. In Fig. 14, we track the leg of a moving character. In these examples, as the time-varying surfaces are in large deformation with different frame sampling rates, we integrate both shape matching and multi-frame propagation into our system for computing more accurate feature tracking results.

In Figs. 15 and 16
                     
                     , we give feature tracking results on the time-varying surfaces captured by Microsoft Kinect. The data set captured by Kinect usually contain noise, and there is no temporal coherence (vertex to vertex correspondence) between the frames. Furthermore, the input data set does not move smoothly, as shown in the supplementary video (see Appendix), the original captured time-varying surfaces are flickering. In Fig. 15, we give the tracking results on both depth image sequence (point-based time-varying surfaces) and the results for the depth images with corresponding textures (RGB images). In this example, we are tracking the motion of the arm and receive satisfactory results. In Fig. 16, we track one feature of the deforming face, and when the face is deforming, the moving feature is effectively tracked.


                     Table 1
                      presents the average, minimum, and maximum number of the vertices for each frame of time-varying surfaces.


                     Limitations: When decomposing the animated objects with extremely large deformation while with small amounts of surface sampling frames, as shown the collapsing camel in Fig. 17
                     , our method cannot work very well. In this example, we track 6 components of the camel, including its 4 legs. As in this case, the shape deformation in each frame is large, even the adjacent frames are matched in high accuracy, and the overlapped regions between adjacent frames is small (limited), for example, the leg regions. Thus, the points in the time-varying surfaces cannot find desirable neighboring points for motion flow computation, which results in inaccurate motion flow computation, especially on the regions with large deformation.

In this paper, we have presented a framework for efficient feature tracking of time-varying surfaces. We define an effective multi-scale geometry motion flow for the time-varying surfaces, which efficiently propagates the geometry features on the time-varying surfaces. By combining both the approximately invariant signature vectors and geometry motion flow vectors, we also corporate shape matching techniques into our system to process feature tracking for time-varying surfaces in large deformation with low frame sampling rate. Furthermore, multi-frame propagation system have also been developed to improve our feature tracking results.

In the future, we will report the following progress in latter publications. Firstly, optical flow computation has been widely investigated by computer vision researchers. When the objects in the input image sequences have the occlusion artifacts, these methods cannot correctly handle the flow estimation for the occluded region. Similarly, due to the occlusion and low surface albedo, scanned surface sequences usually exhibit large holes, such as the scanned data from Microsoft Kinect. In this case, motion flow computing for geometric features may not be accurate due to geometry incompletion in time-varying surfaces. We would like to develop a more stable motion flow computation to address this issue. Secondly, though SIFT matching of object features work well, the matching efficiency needs to be addressed when the data of time-varying surfaces is very large.

@&#ACKNOWLEDGMENTS@&#

We would like to thank the reviewers for their comments. We also thank Robert W. Sumner, Li Zhang and many other researchers for presenting the mesh and point cloud data.

This work was partly supported by the National Basic Research Program of China (No. 2012CB725303), the NSFC (No. 61070081 and 41271431), the Open Project Program of the State Key Lab of CAD&CG (Grant No. A1208), and the Luojia Outstanding Young Scholar Program of Wuhan University.

We give more technical details for geometry motion flow computation.

Minimizing the functional (1) comes down to solving its corresponding Euler–Lagrange equations. They are given by: 
                        
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       u
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       y
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       z
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             z
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 =
                                 0
                              
                           
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       v
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       y
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       z
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             z
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 =
                                 0
                              
                           
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       w
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       y
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       z
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             z
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       d
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                      where: 
                        
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    (
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    u
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    v
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    w
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    (
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    u
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    v
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    w
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       w
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 
                                    (
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    u
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    v
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    w
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       y
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             z
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       z
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       y
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             z
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       z
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             y
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       y
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             z
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       z
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       y
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       z
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       z
                                       z
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       t
                                       t
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       y
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       z
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       z
                                       z
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       t
                                       t
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       x
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       y
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       z
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       z
                                       z
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       d
                                       z
                                    
                                 
                                 =
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                       t
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Since 
                        
                           
                              ∇
                           
                           
                              2
                           
                        
                        u
                        =
                        
                           
                              u
                           
                           
                              x
                              x
                           
                        
                        +
                        
                           
                              u
                           
                           
                              y
                              y
                           
                        
                        +
                        
                           
                              u
                           
                           
                              z
                              z
                           
                        
                        +
                        
                           
                              u
                           
                           
                              t
                              t
                           
                        
                        ,
                        
                           
                              ∇
                           
                           
                              2
                           
                        
                        v
                        =
                        
                           
                              v
                           
                           
                              x
                              x
                           
                        
                        +
                        
                           
                              v
                           
                           
                              y
                              y
                           
                        
                        +
                        
                           
                              v
                           
                           
                              z
                              z
                           
                        
                        +
                        
                           
                              v
                           
                           
                              t
                              t
                           
                        
                        ,
                        
                           
                              ∇
                           
                           
                              2
                           
                        
                        w
                        =
                        
                           
                              w
                           
                           
                              x
                              x
                           
                        
                        +
                        
                           
                              w
                           
                           
                              y
                              y
                           
                        
                        +
                        
                           
                              w
                           
                           
                              z
                              z
                           
                        
                        +
                        
                           
                              w
                           
                           
                              t
                              t
                           
                        
                     , we can rewrite the Euler–Lagrange equations as: 
                        
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 u
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 v
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 w
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       2
                                    
                                 
                                 u
                              
                           
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 u
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 w
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 w
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       2
                                    
                                 
                                 v
                              
                           
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 u
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 v
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                    
                                       2
                                    
                                 
                                 w
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∇
                                    
                                    
                                       2
                                    
                                 
                                 w
                                 .
                              
                           
                        
                     
                  

Using 
                        
                           
                              ∇
                           
                           
                              2
                           
                        
                        u
                        ≈
                        
                           
                              u
                           
                           ¯
                        
                        −
                        u
                        ,
                        
                           
                              ∇
                           
                           
                              2
                           
                        
                        v
                        ≈
                        
                           
                              v
                           
                           ¯
                        
                        −
                        v
                        ,
                        
                           
                              ∇
                           
                           
                              2
                           
                        
                        w
                        ≈
                        
                           
                              w
                           
                           ¯
                        
                        −
                        w
                     , where 
                        
                           
                              u
                           
                           ¯
                        
                        ,
                        
                           
                              v
                           
                           ¯
                        
                      and 
                        
                           
                              w
                           
                           ¯
                        
                      are the averages of neighborhoods of velocities, we can receive: 
                        
                           
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 u
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 v
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 w
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       u
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 u
                                 +
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 v
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 w
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 u
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 v
                                 +
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 w
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       w
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                        
                     
                  

We can solve for 
                        u
                        ,
                        v
                      and 
                        w
                      as: 
                        
                           
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 u
                                 =
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       u
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       v
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 
                                    
                                       w
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 v
                                 =
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       v
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       u
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 
                                    
                                       w
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 w
                                 =
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       w
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 
                                    
                                       u
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 
                                    
                                       v
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                        
                      The above equations can be written as: 
                        
                           
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    u
                                    −
                                    
                                       
                                          u
                                       
                                       ¯
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 
                                    (
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          u
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          v
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    
                                       
                                          w
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    v
                                    −
                                    
                                       
                                          v
                                       
                                       ¯
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       y
                                    
                                 
                                 
                                    (
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          u
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          v
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    
                                       
                                          w
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                              
                           
                           
                              
                                 
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    w
                                    −
                                    
                                       
                                          w
                                       
                                       ¯
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       z
                                    
                                 
                                 
                                    (
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    
                                       
                                          u
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          v
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          z
                                       
                                    
                                    
                                       
                                          w
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

We can use the Gauss–Seidel iteration method to solve the above equations: 
                        
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             u
                                          
                                          ¯
                                       
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                       
                                       
                                          (
                                          
                                             
                                                N
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   ¯
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                y
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   ¯
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                z
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   ¯
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             v
                                          
                                          ¯
                                       
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                       
                                       
                                          (
                                          
                                             
                                                N
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   ¯
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                y
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   ¯
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                z
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   ¯
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             w
                                          
                                          ¯
                                       
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                       
                                       
                                          (
                                          
                                             
                                                N
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   ¯
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                y
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   ¯
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                z
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   ¯
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                N
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  


                     
                        
                           
                              
                                 
                                    u
                                 
                                 ¯
                              
                           
                           
                              k
                           
                        
                        ,
                        
                           
                              
                                 
                                    v
                                 
                                 ¯
                              
                           
                           
                              k
                           
                        
                      and 
                        
                           
                              
                                 
                                    w
                                 
                                 ¯
                              
                           
                           
                              k
                           
                        
                      are averages of neighborhoods of velocities at iteration 
                        k
                     , and typically set to 0.0.

Supplementary material related to this article can be found online at http://dx.doi.org/10.1016/j.cad.2013.06.015.

The following is the Supplementary material related to this article. 
                        
                           Video S1
                           
                              Feature tracking results of time-varying surfaces.
                           
                           
                        
                     
                  

@&#REFERENCES@&#

