@&#MAIN-TITLE@&#Fenced in? Stochastic and deterministic planning models in a time-fenced, rolling-horizon scheduling system


@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We analyze a time-fenced planning system with penalized expediting and canceling.


                        
                        
                           
                           We formulate deterministic and stochastic dynamic programs and develop bounds.


                        
                        
                           
                           Allowing both expediting and canceling lowered costs 28% versus 11% for expediting only.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Supply chain management

Stochastic versus deterministic inventory models

Linear programming

Scheduling

@&#ABSTRACT@&#


               
               
                  We analyze a time-fenced planning system where both expediting and canceling are allowed inside the time fence, but only with a penalty. Previous research has allowed only for the case of expediting inside the time fence and has overlooked the opportunity for additional improvement by also allowing for cancelations. Some researchers also have found that for traditional time-fenced models, the choice of the more complex stochastic linear programming approach versus the simpler deterministic approach is not justified. We formulate both the deterministic and stochastic problems as dynamic programs and develop analytic bounds that limit the search space (and reduce the complexity) of the stochastic approach. We run extensive simulations and numerical experiments to understand better the benefit of adding cancelation and to compare the performance of the stochastic model with the more common deterministic model when they are employed as heuristics in a rolling-horizon setting. Across all experiments, we find that allowing expediting (but not canceling) lowered costs by 11.3% using the deterministic approach, but costs were reduced by 27.8% if both expediting and canceling are allowed. We find that the benefit of using the stochastic model versus the deterministic model varies widely across demand distributions and levels of recourse—the ratio of stochastic average costs to deterministic average costs ranged from 43.3% to 78.5%.
               
            

@&#INTRODUCTION@&#

A significant challenge for production scheduling models is the dynamic nature of the schedule—today's schedule becomes obsolete and must be modified into a new schedule tomorrow; this is the rolling-horizon production scheduling problem. The complexity of rolling-horizon models necessitates heuristic modeling approaches that generally ignore the “rolling” aspect of the problem and optimize the multi-period schedule assuming that it will not be rolled forward. In practice, as time advances and the schedule is rolled forward, the planned production for each period must be revised to account for the realization of stochastic demand from the prior period.

To reduce the number of near-term schedule changes as the schedule rolls forward, many firms enforce (through their scheduling systems) a “time fence”—a period within which changes are restricted. The time fence covers a set number of periods, for example four weeks, and is rolled forward along with the schedule. As the schedule is rolled forward, schedule changes outside the time fence are not constrained. In contrast, within the time fence expediting and cancelation activities incur a penalty (if they are permitted at all).

The rolling-horizon scheduling problem traditionally is addressed heuristically through a linear programming (LP) approach (Salomon, 1991), where future demand is assumed to equal its expected value, and the fact that the schedule will be rolled forward is ignored. We refer to this heuristic approach as deterministic linear programming (DetLP): demand is treated as deterministic in the LP solution process—disregarding the fact that actual demand is stochastic, and ignoring the implications of a rolling schedule. At the beginning of each period, the DetLP produces a new production schedule, accounting for the realized demand as well as the previous period's production plan, the current inventory position, and time-fencing constraints.

If there is no time fence, rolling the schedule forward generates a new production plan (in the DetLP process) that updates production in the upcoming period to compensate for the difference between the expected demand that was used to create the incumbent plan and the realization of stochastic demand for the previous period. The consideration of a time fence changes and complicates the analysis. In particular, an inviolable time fence prevents any expediting and cancelation inside the time fence. In cases where changes to the schedule are permitted inside the time fence (at a cost), the expediting and cancelation costs incurred can lead to a lower overall cost (compared to the inviolable time fence) since the solution space is expanded with the relaxation of the (inviolable) time-fence constraint.

In contrast to the more common deterministic approach to production scheduling problems described above, a few existing works have examined the value of a stochastic linear programming solution (StoLP), which accounts for demand variability as schedules are developed. The StoLP is an optimal approach (rather than heuristic) if it considers demand to the end of the horizon. In practice, the StoLP does not scale well across long time horizons (since it has to consider all possible demand convolutions across all periods) and so the StoLP is typically formulated as a heuristic that considers the randomness only for a few periods out (rather than for the entire horizon). To evaluate the relative merits of the deterministic and stochastic approaches over a rolling horizon, researchers have employed simulation, and have found that the stochastic approach offers advantages only in limited situations.

Specifically, we build on Brandimarte (2006), which extends the DetLP model to examine the use of StoLP (as a heuristic) to reflect the variability of demand in a rolling production schedule. Brandimarte does not consider time fences per se, but rather considers that when capacity is “tightly constrained,” the ability to secure additional “reactive capacity” can be more valuable than producing safety stock and consequently the benefit of using a stochastic model—in which safety stock is used as a hedging mechanism along with extra capacity—is of little value. In this case, Brandimarte notes that while StoLP results in a lower cost than that of a DetLP formulation, the difference between the two often does not justify the added computational complexity of the stochastic formulation. The model that Brandimarte considers is equivalent to a time fence model where expediting (i.e., the use of reactive capacity) is allowed (at a cost). We test a similar comparison between stochastic and deterministic models and find that the stochastic model can be more attractive when there is the opportunity for both expediting and cancelation.

Allowing both cancelation and expediting activities enables the StoLP model to benefit from hedging opportunities. In particular, with both activities available it may be advantageous to schedule additional production because there is opportunity to reduce the schedule (via cancelation) if actual demand is low or to increase the schedule (via expediting) if actual demand is high. Allowing only one adjustment strategy (either expediting or cancelation) may be of limited use depending upon the realized demand, while the two strategies employed together ensure recourse across a broader range of possible outcomes. In addition, having the ability to cancel orders can be more beneficial than having the ability to expedite because of the nature of recourse outside the time fence. In particular, even without expediting, production can be increased outside the time fence (essentially with no limits) when there is a large shortfall. In contrast, if there is a large surplus and demand falls off dramatically, production can be decreased outside the time fence, but only to zero. This means that the surplus could last a long time, if not indefinitely.

The option of cancelations inside the time fence reflects reality for many manufacturers and their customers. As the global economy has suffered through downturns, many businesses, governments, and individuals have responded by reigning in both spending and commitments. In many cases, this has included the cancelation of planned production and/or purchases. However, cancelation of committed orders can come with significant consequences; changes to plans inside the time fence can result in supplier-assessed penalties as the manufacturers seek to recoup some of their costs. Some manufacturers even provide a scale of cancellation fees depending on how far into the manufacturing period the order is. ScintiTech, Inc. specifies on its website that if “25% of the manufacture[sic] period has passed, a 20% order cancellation fee will be assessed.” This cancellation fee is increased to 30% for orders 50% into the manufacturing period, 70% for orders 75% in and 100% for orders 90% in.
                        1
                     
                     
                        1
                        
                           http://www.scintitech.com/Support.aspx?MenuId=26&MainId=5, accessed 3/18/2015.
                      While examples such as this are not particularly unusual in times of economic duress, existing operations management literature does not adequately address the effects of order cancelations in either production or purchasing systems in a rolling-horizon setting.

In the next section, we review the relevant literature covering production planning problems. We then formulate a multi-period model and develop analytical results for upper and lower bounds and for special cases of the problem. Next, through a numeric experiment and simulations, we compare the performance of the stochastic model with the more common deterministic model under varying conditions. We are interested in three aspects of this problem. First, is the benefit to adding cancelation along with expediting such that it allows a significantly higher level of performance than is realized with the expediting-only policy? Second, considering the increased computational complexity, is the magnitude of solution improvement between DetLP and StoLP significant? Third, under what conditions does the benefit from the opportunity to cancel or expedite depend upon the solution methodology (DetLP versus StoLP)?

@&#LITERATURE REVIEW@&#

Our topic is part of the broad Capacitated Lot-Sizing Problem (CLSP) genre. This term is applied to a range of discrete-time scheduling problems (Sox, Jackson, Bowman, & Muckstadt, 1999). The CLSP has been subdivided into a large number of related problems, but all maintain the common characteristic that time is modeled as being divided into discrete segments. Another extensive body of work treats time in a continuous manner, and generally is referred to as Economic Lot-Sizing Problems (ELSP).

Our problem falls within the stochastic programming sub-group of CLSP problems. Specifically, we are modeling a single-item, single-level lot-sizing problem with recourse. In our case, we define recourse to not only include allowing backlogging of unfilled demand, but also to encompass the use of expediting and cancelation of planned orders. Because our analysis includes a comparison of both deterministic and stochastic approaches, we review the programming literature for both.

A number of papers have presented substantial reviews of elements of the deterministic CLSP literature. Drexl and Kimms (1997) summarized work in the field of lot sizing and scheduling and note that “taking into account that planning in practice has to be done on a rolling horizon basis is yet another topic worth attacking.” Staggemeier and Clark (2001) reviewed research on the single-stage lot-sizing and scheduling problem. In addition to providing a basic description of the deterministic lot-sizing problem and its extensions, as well as a discussion of many heuristic solution methodologies, Karimi, Ghomi, and Wilson (2003) provided a thorough review of the CLSP and solution methodologies, which use both exact methods and heuristics. Brahimi, Dauzere-Peres, Najid, and Nordli (2006) reviewed the single-item lot-sizing problem, both capacitated and uncapacitated.


                        Li, Tao, and Wang (2012) developed an approximation technique for the deterministic lot-sizing problem when demand varies from period to period. Their study highlighted the complexity of extending the standard assumption of steady demand as well as the importance of identifying superior solutions to this problem. Baciarello, D'Avino, Onori, and Schiraldi (2013) compared the performance of eight heuristic approaches to the uncapacitated single item lot-sizing problem and found that, in the case of deterministic demand, the heuristics matched the performance of an optimal solution in 44%–84% of their scenarios. The best-performing heuristic (maximum part-period gain) was found to increase the nervousness of the schedule, an outcome that was likely exacerbated by the lack of penalties for schedule changes in this particular heuristic. Our model considers stationary demand, but we allow for penalties for changes inside a time fence, and we consider a rolling horizon.

The importance of considering the rolling-horizon nature of the scheduling problem was highlighted by Rafiei, Nourelfath, Gaudreault, Santa-Eulalia, and Bouchard (2012), which studied the re-planning problem (as the schedule rolls forward) in a wood remanufacturing application. Their approach involves solving a deterministic problem multiple times, each with a different objective (associated with key performance indicators for the firm). Chen (2015) examined the use of several search mechanisms (fix and optimize as well as variable neighborhood search) to improve the quality of solutions identified in a CLSP. Meistering and Stadtler (2015) developed a deterministic CLSP model which includes both capacity and service level constraints. Their approach freezes the first period of the schedule unless the service level constraint is violated. This improves solution stability but does not consider the option of changing the schedule (expediting or cancellation with a penalty) as we do in our study. Cao (2015) examined the development of a deterministic, rolling horizon model for long-distance procurement planning. Although the model considers long lead-time scenarios, no mechanism for changing the existing schedule is presented. A recent review of production planning models (Díaz-Madroñero, Mula, & Peidro, 2014) provided a classification of models based upon factors such as problem type, number of products, nature of demand, and other factors. Extensions identified by Díaz-Madroñero et al. (2014) include consideration of multiple product sources (near and offshore) which can have varying delivery times. In our study, we address the possibility of different delivery times for a product by modeling faster delivery (expediting) as well as standard delivery times (normal production).

Significant levels of effort have also been focused on the stochastic production scheduling problem. Baker and Peterson (1979) examined the stochastic demand problem in terms of the effects of planning horizon length on the quality of a rolling-horizon solution, again considering production, holding, and backorder costs. Bitran and Yanasse (1984) examined the usefulness of deterministic approximations of stochastic production problems and found that, for many common distributions, the error introduced through a deterministic approximation is small. It does not, however, include expediting or cancelation as possible actions.

In recent years, additional articles have addressed the stochastic production scheduling problem. Arslan, Ayhan, and Olsen (2001) used a queueing framework to derive the structure of the optimal expediting policy for deciding when and how to expedite in a single-product make-to-order environment. Pochet and Wolsey (2006) (PW) examined the use of mixed-integer programs in production planning problems. In addition to providing a summary of algorithms and heuristics developed for use in the production planning problem, PW also provides a means of classifying the various lot-sizing problem models and a detailed discussion of reformulation techniques used to simplify the solution process. Van Vyve (2006) also provided several reformulations of the capacity-constrained single-item lot-sizing problem. As noted earlier, Brandimarte (2006) compared the results of the stochastic and deterministic models using a scenario-tree heuristic, and considers expediting (but not cancelation). Jans and Degraeve (2007) provided a review of more recent developments in heuristic approaches. Buschkühl, Sahling, Helber, and Tempelmeier (2008) also presented a review of stochastic production planning problem research. Heitsch and Romisch (2009) applied scenario tree heuristics to planning problems, including the management of electricity supplies. Sahin, Narayanan, and Robinson (2013) provided a review of rolling-horizon planning in supply chains, and suggest that “rolling horizon planning research under demand uncertainty is attracting new activity after laying dormant for much of the early 2000s.” A tertiary review of the lot-sizing problem and related literature can be found in Glock, Grosse, and Ries (2013).

In recent years, a number of manuscripts have attempted to address the issue of random demand in the CLSP. Tempelmeier and Herpers (2010) provided a heuristic approach to the CLSP that addresses demand randomness through the inclusion of a fillrate constraint that enforces a target service level using the β service level concept. Kazemi Zanjani, Nourelfath, and Ait-Kadi (2010) modeled a sawmill production scenario with both random demand and random yield. Their scenario tree approach allowed full recourse in terms of production plan changes, but did not include any penalty for schedule changes. Zhang, Prajapati, and Peden (2011) used a scenario tree approach to model random demand, but included the freezing of a portion of the schedule to facilitate planning and resource allocation. Our model, in contrast, allows changes over the entire planning horizon, but enforces a penalty to accurately reflect the costs associated with those changes. Tiacci and Saetta (2012) evaluated a rolling-horizon scheduling model that implicitly considers demand randomness (in the form of forecast inaccuracy) by purposely simplifying the modeling of future periods. This reduces the complexity of the model being solved, but introduces schedule instability as future periods often require adjustment as actual demand becomes apparent. The study found that freezing a portion of the production schedule led to better cost performance than allowing unrestricted recourse. In contrast, our model explicitly considers demand uncertainty and uses recourse costs (expediting and cancellation penalties) to reduce schedule instability while still allowing changes if the situation merits adjustment of the schedule. By
Kazemi Zanjani, Ait-Kadi, and Nourelfath (2013), the sawmill production scenario is analyzed with a heuristic approach which also allowed full recourse without penalty. In Helber, Sahling, and Schimmelpfeng (2013) investigated the use of scenarios and a piecewise linear approximation to represent random demand. The authors find that the piecewise linear approximation can lead to better performance, but that the scenario approach is also robust. Our model adopts the scenario tree representation of random demand, but rather than simplifying demand to a subset of possible outcomes, our scenario tree incorporates all demand outcomes (for a discrete distribution).

The concept of full recourse (not only backorders, but also changing existing plans through expediting and cancelation) has been addressed much less often in the literature. The benefit of using both expediting and canceling was considered by DeYong and Cattani (2012), which finds a closed-form solution for a two-period newsvendor model with canceling and expediting allowed (at a cost) in the second period. A numerical analysis suggests that low-margin products with a low probability of low demand benefit from the ability to cancel (at a relatively low cost) while high-margin products with a high probability of low demand benefit from the ability to expedite. Fu, Xu, and Miao (2013) also examined the scheduling problem using a single-period newsvendor scenario and focus on expediting as an option.

To our knowledge, our research is the first to test the benefits of both expediting and cancelation in a general time-fenced, rolling-horizon setting.

We formulate the multi-period inventory problem as a dynamic program that considers the rolling schedule, and limits the problem to a finite horizon. In this section, we formulate the general model and seek insights through analytic results for upper and lower bounds for the problems and special cases of the problem.

We assume the following sequence of events:

At the beginning of a period, the decision maker observes the current on-hand inventory position and prepares (updates) production plans for both current and future periods, covering at least one period beyond the time fence. Changes to the production plan that are inside the time fence may be prohibited, or may be permitted with expediting or canceling costs assessed. Expediting increases the production schedule while cancelation reduces the production schedule. We assume there are no capacity constraints. System costs are calculated, and include costs for backorders, inventory holding, expediting, and cancelation. We assume that demand is stationary and discrete, drawn from a general (discrete) distribution. During the period, actual demand is revealed. At the end of the period, supply from the realized production plan is added to inventory, while realized demand is subtracted from the on-hand inventory. Backorders are assumed (at a cost each period) until sufficient stock is available to satisfy the orders. The schedule is then rolled forward: ending inventory becomes beginning inventory and the production plan from the previous period becomes the incumbent production plan for the new horizon. The process then repeats.

Notation is described in Table 1.

The base model is a dynamic program with state variables

                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             t
                                          
                                          ,
                                          
                                             x
                                             t
                                          
                                       
                                       )
                                    
                                    :
                                    =
                                    
                                       (
                                       
                                          
                                             z
                                             
                                                t
                                                +
                                                1
                                                ,
                                                t
                                             
                                          
                                          ,
                                          
                                             z
                                             
                                                t
                                                +
                                                1
                                                ,
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             z
                                             
                                                t
                                                +
                                                1
                                                ,
                                                t
                                                −
                                                N
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             x
                                             t
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        that specify (at the beginning of period t) the incumbent production plan that is inside the time fence (
                           
                              
                                 z
                                 →
                              
                              t
                           
                        ) and the inventory position (xt
                        ). The optimality equations can be written as

                           
                              
                                 
                                    
                                       f
                                       t
                                    
                                    
                                       (
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             t
                                          
                                          ,
                                          
                                             x
                                             t
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                       
                                          
                                             a
                                             t
                                          
                                          ∈
                                          A
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         z
                                                         →
                                                      
                                                      t
                                                   
                                                
                                                
                                                   
                                                   ′
                                                
                                             
                                             )
                                          
                                       
                                       min
                                    
                                    
                                       g
                                       t
                                    
                                    
                                       (
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             t
                                          
                                          ,
                                          
                                             x
                                             t
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    subject
                                    
                                    
                                    to
                                    
                                    
                                    A
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   z
                                                   →
                                                
                                                t
                                             
                                          
                                          
                                             
                                             ′
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             z
                                             
                                                t
                                                ,
                                                t
                                             
                                          
                                          ,
                                          
                                             z
                                             
                                                t
                                                ,
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             z
                                             
                                                t
                                                ,
                                                t
                                                −
                                                N
                                             
                                          
                                       
                                       )
                                    
                                    ≥
                                    0
                                 
                              
                           
                        where expected costs given state variables 
                           
                              
                                 
                                    z
                                    →
                                 
                                 t
                              
                              
                              and
                              
                              
                                 x
                                 t
                              
                           
                         and decision 
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    t
                                 
                              
                              
                                 
                                 ′
                              
                           
                         are:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                t
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         z
                                                         →
                                                      
                                                      t
                                                   
                                                   ,
                                                   
                                                      x
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             :
                                             =
                                          
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   h
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            )
                                                         
                                                      
                                                      +
                                                   
                                                   +
                                                   b
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            )
                                                         
                                                      
                                                      −
                                                   
                                                
                                                ]
                                             
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   0
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                               
                                                                  E
                                                                  k
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           z
                                                                           
                                                                              t
                                                                              ,
                                                                              t
                                                                              −
                                                                              k
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           z
                                                                           
                                                                              t
                                                                              +
                                                                              1
                                                                              ,
                                                                              t
                                                                              −
                                                                              k
                                                                           
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               +
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            +
                                                            
                                                               c
                                                               
                                                                  C
                                                                  k
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           z
                                                                           
                                                                              t
                                                                              +
                                                                              1
                                                                              ,
                                                                              t
                                                                              −
                                                                              k
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           z
                                                                           
                                                                              t
                                                                              ,
                                                                              t
                                                                              −
                                                                              k
                                                                           
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               +
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             α
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   0
                                                
                                                
                                                   D
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             
                                                f
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         z
                                                         →
                                                      
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      x
                                                      t
                                                   
                                                   +
                                                   
                                                      z
                                                      
                                                         t
                                                         ,
                                                         t
                                                      
                                                   
                                                   −
                                                   d
                                                   
                                                
                                                )
                                             
                                             ϕ
                                             
                                                (
                                                d
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with 
                           
                              
                                 
                                    (
                                    x
                                    )
                                 
                                 +
                              
                              =
                              m
                              a
                              x
                              
                                 (
                                 
                                    x
                                    ,
                                    0
                                 
                                 )
                              
                           
                        , and 
                           
                              
                                 
                                    (
                                    x
                                    )
                                 
                                 −
                              
                              =
                              m
                              a
                              x
                              
                                 (
                                 
                                    −
                                    x
                                    ,
                                    0
                                 
                                 )
                              
                           
                        .

The equation that governs the state evolution for the inventory position is 
                           
                              
                                 x
                                 
                                    t
                                    −
                                    1
                                 
                              
                              =
                              
                                 x
                                 t
                              
                              +
                              
                                 z
                                 
                                    t
                                    ,
                                    t
                                 
                              
                              −
                              d
                           
                         and the terminal condition is 
                           
                              
                                 f
                                 0
                              
                              
                                 (
                                 
                                    
                                       
                                          z
                                          →
                                       
                                       0
                                    
                                    ,
                                    
                                       x
                                       0
                                    
                                 
                                 )
                              
                              =
                              h
                              
                                 
                                    (
                                    
                                       x
                                       0
                                    
                                    )
                                 
                                 +
                              
                              +
                              b
                              
                                 
                                    (
                                    
                                       x
                                       0
                                    
                                    )
                                 
                                 −
                              
                           
                        . The constraints ensure that the admissible actions 
                           
                              A
                              
                                 (
                                 
                                    
                                       
                                          
                                             z
                                             →
                                          
                                          t
                                       
                                    
                                    
                                       
                                       ′
                                    
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       z
                                       
                                          t
                                          ,
                                          t
                                       
                                    
                                    ,
                                    
                                       z
                                       
                                          t
                                          −
                                          1
                                          ,
                                          t
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       z
                                       
                                          t
                                          −
                                          N
                                          ,
                                          t
                                       
                                    
                                 
                                 )
                              
                           
                         are comprised of feasible production values, greater than or equal to zero.

The general model solves the problem considering T periods. Thus, there are T vectors 
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    t
                                 
                              
                              
                                 
                                 ′
                              
                           
                         corresponding to the production decisions made each period in the planning horizon. Overall costs are minimized considering backlogging, holding, expediting, and canceling costs. The expediting and canceling costs are summed across all periods inside the time fence N.

As is typical with such formulations, the problem quickly becomes intractable for even moderately-sized problems. Thus, as in Brandimarte (2006), in Sections 4 and 5 we consider two approaches: DetLP and StoLP. The DetLP approach is a heuristic that uses linear programming and solves the multi-period problem as though demand is deterministic. Thus, while actual demand is stochastic and results in the need for updated schedules as the schedule rolls forward each period, the DetLP ignores the randomness as it develops the schedule. In contrast to the DetLP, the stochastic approach (StoLP) is much more computationally intensive, but optimally accounts for randomness of demand as it considers schedule changes inside the time fence. We employ DetLP and StoLP models for making the scheduling decisions; expected costs are determined through simulations.

In the model formulation, the difference between the StoLP and the DetLP is that demand d (in the state evolution equation) is random for the StoLP and deterministic (equal to μ) for the DetLP. For both the StoLP and the DetLP, the planning horizon (that is, the horizon modeled and which we denote as τ) is usually less than T, with minimal costs denoted 
                           
                              
                                 f
                                 τ
                              
                              
                                 (
                                 
                                    
                                       
                                          z
                                          →
                                       
                                       τ
                                    
                                    ,
                                    
                                       x
                                       τ
                                    
                                 
                                 )
                              
                           
                        .

The DetLP can be rewritten as a linear program as follows:

DetLP:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  z
                                                                  →
                                                               
                                                               τ
                                                            
                                                         
                                                         
                                                            
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  z
                                                                  →
                                                               
                                                               
                                                                  τ
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                            ′
                                                         
                                                      
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  z
                                                                  →
                                                               
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                            ′
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             [
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   0
                                                
                                                τ
                                             
                                             
                                                α
                                                t
                                             
                                             {
                                             
                                                (
                                                
                                                   x
                                                   t
                                                   
                                                      N
                                                      e
                                                      g
                                                   
                                                
                                                )
                                             
                                             b
                                             +
                                             
                                                (
                                                
                                                   x
                                                   t
                                                   
                                                      P
                                                      o
                                                      s
                                                   
                                                
                                                )
                                             
                                             h
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   0
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      c
                                                      
                                                         E
                                                         k
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         Δ
                                                         
                                                            t
                                                            ,
                                                            k
                                                         
                                                         
                                                            P
                                                            o
                                                            s
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      c
                                                      
                                                         C
                                                         k
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         Δ
                                                         
                                                            t
                                                            ,
                                                            k
                                                         
                                                         
                                                            N
                                                            e
                                                            g
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ]
                                             
                                             }
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        subject to

                           
                              
                                 
                                    
                                       x
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       x
                                       t
                                    
                                    +
                                    
                                       z
                                       
                                          t
                                          ,
                                          t
                                       
                                    
                                    −
                                    μ
                                    
                                    ∀
                                    t
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       x
                                       t
                                       
                                          P
                                          o
                                          s
                                       
                                    
                                    ≥
                                    
                                       x
                                       t
                                    
                                    
                                    ∀
                                    t
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       x
                                       t
                                       
                                          N
                                          e
                                          g
                                       
                                    
                                    ≥
                                    −
                                    
                                       x
                                       t
                                    
                                    
                                    ∀
                                    t
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Δ
                                       
                                          t
                                          ,
                                          k
                                       
                                       
                                          P
                                          o
                                          s
                                       
                                    
                                    ≥
                                    
                                       (
                                       
                                          
                                             z
                                             
                                                t
                                                ,
                                                t
                                                −
                                                k
                                             
                                          
                                          −
                                          
                                             z
                                             
                                                t
                                                +
                                                1
                                                ,
                                                t
                                                −
                                                k
                                             
                                          
                                       
                                       )
                                    
                                    
                                    ∀
                                    t
                                    ,
                                    k
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Δ
                                       
                                          t
                                          ,
                                          k
                                       
                                       
                                          N
                                          e
                                          g
                                       
                                    
                                    ≥
                                    
                                       (
                                       
                                          
                                             z
                                             
                                                t
                                                +
                                                1
                                                ,
                                                t
                                                −
                                                k
                                             
                                          
                                          −
                                          
                                             z
                                             
                                                t
                                                ,
                                                t
                                                −
                                                k
                                             
                                          
                                       
                                       )
                                    
                                    
                                    ∀
                                    t
                                    ,
                                    k
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       x
                                       t
                                       
                                          N
                                          e
                                          g
                                       
                                    
                                    ,
                                    
                                       x
                                       t
                                       
                                          P
                                          o
                                          s
                                       
                                    
                                    ,
                                    
                                       Δ
                                       
                                          t
                                          ,
                                          k
                                       
                                       
                                          P
                                          o
                                          s
                                       
                                    
                                    ,
                                    
                                       Δ
                                       
                                          t
                                          ,
                                          k
                                       
                                       
                                          N
                                          e
                                          g
                                       
                                    
                                    ≥
                                    0
                                    
                                    ∀
                                    t
                                    ,
                                    k
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       z
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    ≥
                                    0
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                 
                              
                           
                        where

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             t
                                          
                                       
                                       
                                          
                                          ′
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             z
                                             
                                                t
                                                ,
                                                t
                                             
                                          
                                          ,
                                          
                                             z
                                             
                                                t
                                                ,
                                                t
                                                −
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             z
                                             
                                                t
                                                ,
                                                t
                                                −
                                                N
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

The first constraint is the inventory balance equation. The next two equations determine 
                           
                              
                                 (
                                 
                                    x
                                    t
                                 
                                 )
                              
                              +
                           
                         and 
                           
                              
                                 (
                                 
                                    x
                                    t
                                 
                                 )
                              
                              −
                           
                         while the following two equations determine expediting and canceling: 
                           
                              
                                 (
                                 
                                    
                                       z
                                       
                                          t
                                          ,
                                          t
                                          −
                                          k
                                       
                                    
                                    −
                                    
                                       z
                                       
                                          t
                                          +
                                          1
                                          ,
                                          t
                                          −
                                          k
                                       
                                    
                                 
                                 )
                              
                              +
                           
                         and 
                           
                              
                                 (
                                 
                                    
                                       z
                                       
                                          t
                                          +
                                          1
                                          ,
                                          t
                                          −
                                          k
                                       
                                    
                                    −
                                    
                                       z
                                       
                                          t
                                          ,
                                          t
                                          −
                                          k
                                       
                                    
                                 
                                 )
                              
                              +
                           
                        , respectively. All variables, except inventory position, xt
                        , are strictly non-negative, and given discrete integer values for demand there is no need for integer constraints.

In Sections 4 and 5, we determine the effectiveness of the approaches across a rolling horizon through an experiment that simulates a schedule with a three-period planning horizon as it is rolled across 100 periods. We employ both DetLP and StoLP for a full-factorial experiment across a wide range of parameters.

In this section, we seek insights into the model through comparisons of special cases and we develop lower and upper bounds to help limit the search space for the StoLP model. We first note that the StoLP approach has lower expected costs.


                        
                           Proposition 1
                           
                              The StoLP results dominate the DetLP results.
                           


                        
                           Proof
                           The StoLP is a generalized version of the DetLP: the DetLP assumes that demand is equal each period to mean demand while the StoLP relaxes this assumption. Thus, 
                                 
                                    
                                       f
                                       T
                                       
                                          D
                                          e
                                          t
                                          L
                                          P
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             T
                                          
                                          ,
                                          
                                             x
                                             T
                                          
                                       
                                       )
                                    
                                    ≥
                                    
                                       f
                                       T
                                       
                                          S
                                          t
                                          o
                                          L
                                          P
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             T
                                          
                                          ,
                                          
                                             x
                                             T
                                          
                                       
                                       )
                                    
                                 
                              .□

It is possible to develop lower bounds for both the DetLP and the StoLP models by recognizing that without the time-fence (expediting and canceling) costs, the models revert back to traditional models that thus provide lower bounds. We begin with a result from Porteus (2002) that applies to our base models if time fence costs are ignored. Proposition 2 provides a lower bound for DetLP and StoLP.


                           
                              Proposition 2
                              
                                 There is a base-stock policy that provides a lower bound for both the DetLP and StoLP.
                              


                           
                              Proof
                              Relaxing the time-fence assumption, the base model becomes equivalent to a traditional dynamic inventory model, specifically a T-period inventory problem with backlogging. In particular, the expected cost equation becomes

                                    
                                       
                                          
                                             
                                                g
                                                t
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         z
                                                         →
                                                      
                                                      t
                                                   
                                                   ,
                                                   
                                                      x
                                                      t
                                                   
                                                
                                                )
                                             
                                             :
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            h
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        x
                                                                        t
                                                                     
                                                                     )
                                                                  
                                                               
                                                               +
                                                            
                                                            +
                                                            b
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        x
                                                                        t
                                                                     
                                                                     )
                                                                  
                                                               
                                                               −
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             +
                                             α
                                             
                                                ∫
                                                0
                                                ∞
                                             
                                             
                                                f
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         z
                                                         →
                                                      
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      x
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                )
                                             
                                             ϕ
                                             
                                                (
                                                ξ
                                                )
                                             
                                             d
                                             ξ
                                          
                                       
                                    
                                 
                              

The optimality of a base-stock policy for this formulation is shown by Porteus (2002). The (optimal) base-stock policy thus provides a lower bound for the StoLP. Since (by Proposition 1) the StoLP dominates the DetLP, the base-stock policy also provides a lower bound for the DetLP. □


                           Proposition 2 assures that the standard and well-known base-stock policy provides a lower bound for our time-fence models by ignoring time-fence costs. Our experimental results in Section 5 provide an example of the magnitude of this bound.

The next results are straightforward and intuitive, but also quite useful:


                           
                              Proposition 3
                              
                                 
                                    
                                       a.
                                       If 
                                             
                                                
                                                   c
                                                   
                                                      E
                                                      i
                                                   
                                                
                                                ≥
                                                b
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            α
                                                            i
                                                         
                                                         −
                                                         
                                                            α
                                                            j
                                                         
                                                      
                                                      
                                                         1
                                                         −
                                                         α
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   
                                                      E
                                                      j
                                                   
                                                
                                                
                                                with
                                                
                                                i
                                                <
                                                j
                                             
                                          , then it is not optimal to expedite i periods out.

If 
                                             
                                                
                                                   c
                                                   
                                                      C
                                                      i
                                                   
                                                
                                                ≥
                                                h
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            α
                                                            i
                                                         
                                                         −
                                                         
                                                            α
                                                            j
                                                         
                                                      
                                                      
                                                         1
                                                         −
                                                         α
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   c
                                                   
                                                      C
                                                      j
                                                   
                                                
                                                
                                                with
                                                
                                                i
                                                <
                                                j
                                             
                                          , then it is not optimal to cancel i periods out.


                           
                              Proof
                              Please see the Appendix

It is intuitive that if expediting costs (canceling costs) are sufficiently high, then it is not optimal to expedite (cancel). In our discussion of experimental results (Section 5), Proposition 3 is found to significantly reduce problem complexity in a large portion of the experimental scenarios.

The next proposition provides insights to the optimal actions for the special cases where holding costs or backorder costs are exorbitant.


                           
                              Proposition 4
                              
                                 
                                    
                                       a.
                                       As h → ∞ (or similarly, there is a policy to never hold inventory), if cEi
                                           is finite ∀i, then it is never optimal to plan any (future) positive production amount greater than the minimum demand plus backorders.

As b → ∞ (or similarly, there is a policy to never miss demand), if cCi
                                           is finite ∀i and the demand distribution has a finite maximum, then it is always optimal to plan to produce up to the maximum demand and use cancelation to drop down to actual demand.


                           
                              Proof
                              Please see the Appendix

In the next section, we formulate a numerical study to provide further insights to our research questions to determine when synergies might arise from having the ability to both expedite and cancel within the time fence. In Section 5, we provide an analysis of the results of the study.

In this section, we formulate an experiment and experimental design to measure the response of the two scheduling models (DetLP and StoLP) in the context of a rolling horizon and to examine the effectiveness of the approaches. The goals of our experiments are to examine the interactions between expediting and cancelation as well as to develop an understanding of the conditions in a rolling horizon which are most (or least) conducive to being modeled through the two scheduling models.

We are interested in the effects of holding, backorder, expediting, and canceling costs on production scheduling systems, and consider values as shown in Table 2
                        . The range of values considered allows for low (1:8) to high ratios (8:1) of the various costs, and allows for an inviolable time fence (when cE0, cE1, cC0
                         and cC1
                         are prohibitively high) or no time fence (when canceling and expediting costs are zero). We develop a full-factorial experiment for both models (StoLP and DetLP) for each condition (in Table 2), under four different demand distributions (Table 3
                        ), with 10 replications of each set of conditions and N = 2. This results in a total of 9,000 experimental runs (3 × 3×5 × 5×4 × 10).

The four demand distributions selected for the experiments all have the same mean value (8.0). Three distributions are designed to provide examples of symmetric, left-skewed, and right-skewed demand while maintaining an identical mean and variance. The fourth distribution has the same mean but a much lower variance. These distributions are summarized in Table 3 and the probability density functions are graphed in Fig. 1.
                        
                     

All linear programming problems (for both DetLP and StoLP) were solved using the Gurobi Optimizer, version 5.6.3, running on a Dell Optiplex 9010 system with an i7-3770 CPU (3.40 GHz) and 16 GB RAM using a 64 bit Windows 7 operating system. The Gurobi Optimizer was selected on the basis of its superior performance (Meindl & Templ, 2012) on linear optimization problems and its support of programming languages, which simplified the construction of a scheduling simulation with embedded linear optimization.

Problem sizes and solution times (to produce a schedule for the three period planning horizon) are shown in Table 4
                        . Note that the DetLP assumes deterministic demand (and thus solves the same problem regardless of the actual demand distribution) while the StoLP becomes more complex as the number of possible demand values increases.

@&#ANALYSIS@&#

In this section, we analyze the results from the experiments described in Section 4. We are interested in evaluating what experimental conditions were (1) more favorable to either the stochastic or deterministic model and (2) more likely to rely on the expediting and/or cancelation options.

The most straightforward means of analyzing the performance of the stochastic versus the deterministic scheduling algorithms is through a comparison of total scheduling costs across the simulated rolling horizon. We compare the average cost (across all experiments) for the two algorithms for each demand distribution using a two-tailed paired t-test, which compares the period cost matrices generated by the experiments. These results are presented in Table 5
                      and discussed below.

As we see in Table 5, the StoLP model outperformed the DetLP model by a significant amount, statistically and managerially, across all demand distributions.

Interestingly, the StoLP/DetLP ratio is lowest for the low-variance case (43.3%). Table 5 shows that for the high-variance case, the average costs are $11.32 and $15.71 for StoLP and DetLP respectively for a ratio of 72%. For the low-variance case, StoLP drops (by 84%) to $1.85 while DetLP drops (by 73%) to $4.27. Thus, StoLP drops more (in percentage terms) as intuition would suggest, but StoLP costs decrease less than those of DetLP in absolute magnitude. However, the resulting ratio of StoLP/DetLP decreases to 43.3%. Thus, although the ratio of costs show the StoLP performing best when variance is low, the actual performance in terms of cost per period for the DetLP model deteriorates more quickly as variances increase.

Given that each demand distribution has a mean demand of 8 units per period, it also is interesting to compare the performance (in Table 5) of the StoLP and DetLP models across demand distributions. Recall that the skewed demand distributions and the symmetric distribution have identical means (8.0) and variance (8.17) while the low-variance distribution has a much lower variance (0.67). Not surprisingly, both the StoLP and DetLP models perform significantly better with the low-variance distribution than with the other distributions. Interestingly, the StoLP and DetLP models perform significantly better managerially and statistically (p < 0.01) with the left-skewed distribution even though all three distributions have the same variance. The DetLP model performs worst with the right-skewed distribution.

This performance advantage with the left-skewed distribution is due to the increased likelihood that the left-skewed distribution will experience an above average demand value, allowing the system to be cleared of excess inventory. In contrast, the symmetric and right-skewed distributions have a greater possibility of relatively long-lasting periods with high inventory (due to the higher probability of low demand). The scheduling systems (both StoLP and DetLP) can quickly accommodate low inventory situations by ordering additional inventory (with a delay of at most two periods), but an excess inventory situation can be rectified only by demand high enough to consume the overage or by cancelation of future orders, which may be prohibitively expensive.

We examined the relative attractiveness of the four levels of recourse (no recourse, expedite only, cancel only, and full recourse) for the StoLP and DetLP model (Table 6
                     ). As noted in Proposition 1, the StoLP model dominates the DetLP model, but to varying degrees. Both models benefit from the full recourse option compared to the single recourse (expediting or cancelation) and no recourse options. For both the StoLP and DetLP models, addition of either cancelation or expediting is equally effective. Overall, the option to expedite or cancel widens the performance gap between the StoLP and DetLP models. For the StoLP model, expedite and cancel reduce average costs by more than 23% (from 11.53 down to 8.86 or 8.80). However, having both options available lowers costs by 29.2% (down to 8.16), providing some evidence of synergy between the two forms of recourse. The pattern is even more pronounced for the DetLP model, lowering costs by approximately 11.3% (from 14.7 down to 13.04 or 13.15) for the expedite or cancel only cases, but by 27.8% (down to 10.62) when both options are available.

To gain further insights into the findings of Proposition 2, we compared the StoLP results when expediting and cancelation costs were zero (indicating no time fence) to scenarios where positive expediting and cancelation costs enforced a time fence. As noted in Proposition 2, ignoring the time fence creates a lower bound; for the StoLP model the cost of the no-time fence experiments is on average 81.4% of the cost when the time fence is enforced. This lower bound can prove useful when using solution methodologies such as branch-and-bound.


                     Proposition 3 further addresses solution methodologies by indicating when the LP model can be significantly simplified. Specifically, Proposition 3a identifies situations where expediting will not be utilized while Proposition 3b identifies situations where cancelation is financially unattractive. For our experiments (which model three periods), the ability to ignore expediting (or cancelation) reduces the problem complexity significantly. For example, by applying the results of Proposition 3 to the case of the symmetric distribution (with 15 demand levels) the number of decision variables and constraints in our experiment are reduced by 6.5% when both expediting and cancelation can be disallowed. In our experiments, Proposition 3 allows us to ignore one action (expediting or cancelation) 60% of the time, while both expediting and cancelation can be disregarded 36% of the time. Of course, the actual number of cases where expediting and/or cancelation can be disregarded depend on the cost parameters of the scenario modeled, but the computational benefits of Proposition 3 are clear.

Expanding the solution set by allowing expediting and/or cancelation results in an improved solution. Determining the magnitude of the improvement, as well as the ability of expediting (or cancelation) alone to improve the solution is one of the key objectives of our study. To examine the relative effectiveness of expediting and cancelation, in Table 7
                      we compare the results of scenarios where cancelation and expediting were not allowed (by setting cC
                      or cE
                      to be prohibitively high) to identical (in all other attributes) scenarios where cancelation (or expediting) was allowed at a low cost (cC0
                     =1/ cC1
                     =0.5 or cE0
                     =1/ cE1
                     =0.5). This allows us to compare results across 36 unique combinations of demand distribution, holding cost, and backorder cost. For the StoLP model, allowing cancelation improved the solution (p < 0.01) in 35 of 36 cases. On average, allowing cancelation reduced total system cost by 21.7% in these cases. Allowing expediting improved the solution (p < 0.01) in 33 of 36 cases and reduced costs by 17.8%. When both expediting and cancelation are allowed, improvement in the solution was noted (p < 0.01) in 35 of the 36 cases with a cost reduction of 27.4%. The benefits of expanding the solution space (by allowing either expediting or cancelation) are significant but show some decreasing marginal returns—the benefit from using both forms of recourse is greater, but not equal to the sum of the individual recourse cases.

For the DetLP model, allowing cancelation improved the solution (p < 0.01) in 34 of 36 cases (with an average cost reduction of 11.8%). Allowing expediting improved the solution (p < 0.01) in 33 of 36 cases, with an average cost reduction of 10.7%. As noted earlier, when both expediting and cancelation are allowed the DetLP model gains are particularly striking. When both expediting and cancelation are allowed, significant improvement (p < 0.01) is noted in all cases and costs are reduced by 27.7%—greater than the sum of the individual recourse cases.

Our results thus show evidence that there is a benefit to adding cancelation along with expediting in order to achieve a higher level of performance than is realized with the expediting-only policy, particularly for the DetLP model. To further evaluate this possibility, we isolated cases where expediting (or cancelation) improved the solution, then determined if additionally allowing cancelation (or expediting) led to further improvement to the average cost. In the 35 cases where allowing cancelation improved the StoLP solution, further allowing expediting improved performance in just 3 cases. In the 33 cases where allowing expediting improved the StoLP solution, further allowing cancelation resulted in a lower cost in 29 cases (p < 0.01). For the DetLP model, cancelation improved the solution in 34 cases, and the addition of expediting further improved the solution in 17 of these cases. Similarly, expediting alone improved the DetLP solution in 33 cases, with the addition of cancelation further improving the solution in 28 of these cases. This indicates that in most cases solutions that utilize both expediting and cancelation can improve upon solutions that allow only one form of recourse. The exception to this general rule is observed in the StoLP results, where cancelation captured most of the improvement possible from full recourse for a large number of cases. This is likely due to the unique ability of cancelation to relieve an overstock situation. Only cancelation can decrease the inventory position of the firm. Across all experiments, allowing both expediting and cancelation in the StoLP model reduced total system costs by 29.2%. For the DetLP model, a similar improvement is noted, with a reduction of total system costs by 27.7%.

The following tables (Tables 8–10
                     ) compare results for the StoLP model under the three possible configurations of holding and backorder costs.


                     Table 8 shows that, while there is little difference between cancelation or expediting with symmetric and right-skewed distributions, cancelation is significantly more attractive with the left-skewed distribution. This is, of course, consistent with our earlier discussion of the importance of cancelation when holding costs are high. However, when holding costs are high, the ability to cancel is advantageous even when demand is left-skewed.

When backorder and holding costs are equal (Table 9
                     ), the two strategies noted earlier are combined. When demand is right-skewed, expediting is clearly advantageous. When demand is left-skewed, results are more ambiguous, although the cancel-only option achieves equal results to the full-recourse model.

When backorder costs dominate (Table 10
                     ), expediting and cancelation are equally valuable, except when demand is right-skewed. An effective strategy for the right-skewed distribution is to expedite when particularly high demands occur. This allows the system to avoid holding costs most of the time (when demand is low) and still makes it possible to avoid high backorder costs when demand is high by taking advantage of the ability to expedite.

These StoLP model results are consistent with the findings of DeYong and Cattani (2012) where (in a two-period, non-rolling horizon model) high-margin products benefit more from the expedite option while low-margin products benefit more from the cancelation option. In Table 10, we observe that when backorder costs are high (implying a high-margin product), adding an expediting option with a right-skewed distribution leads to a significant (p < 0.01) savings over the no-recourse and cancelation-only models, with costs decreasing by 23.0% and 8.0%, respectively. When holding costs are high (implying a low-margin product), adding a cancelation option with a left-skewed distribution leads to a significant (p < 0.01) 21.5% decrease in costs over the no-recourse model and achieves a 6.3% savings over the expediting-only option.

@&#CONCLUSIONS@&#

Previous literature has studied the value of expediting in a rolling-horizon model and has overlooked the opportunity for additional improvement by also allowing for cancelation. In this study, we examine the production scheduling problem with both expediting and cancelation recourse options, and conduct both mathematical and simulation analyses of a rolling-horizon problem. We find that the addition of cancelation to an existing expediting option broadens the appeal of both the deterministic and the stochastic approaches.

Our simulation results suggest that both cancelation and expediting are key additions to both the stochastic and deterministic approaches and that the benefits of expanding the solution space by adding either expediting or cancelation appears to be additive in some cases. Interestingly, the benefit to having both options available is most pronounced for the DetLP model. This suggests that firms using a DetLP model have a greater incentive to consider the ability to cancel inside the time fence.

In our experiments, the stochastic model outperforms the deterministic model—use of the stochastic model led to reductions in average costs ranging from 28% to over 50% when compared to the deterministic model. Although the stochastic model is significantly more complex, this level of performance improvement is highly appealing. Furthermore, the value of the stochastic solution is consistently apparent across a variety of demand distributions (i.e. skewed and symmetric, high and low variability).

Under the StoLP model, cancelation shows more promise when holding costs are high while expediting is more impactful when backorder costs are high. However, cancelation appears more likely to capture the full value of recourse without the need to include expediting as an option than vice versa. In contrast, the deterministic model is equally likely to benefit from canceling or expediting, but benefits to a higher degree from having both options available.

Our analysis of the multi-period case provides some insight into the value of both the stochastic linear programming planning approach and the conditions which are most likely to benefit from the ability to expedite and/or cancel orders. In particular, we find that stochastic planning techniques are beneficial across a range of demand distributions. In addition, it appears that deterministic models benefit more from full-recourse options (both expediting and cancelation), which are more likely to improve the solution in the deterministic model than in the better-performing stochastic model. From our experiments, we find that the more computationally complex stochastic model returns significant benefits over the simpler deterministic model. Our analytical results provide guidance which can significantly accelerate solution processes by identifying conditions which allow an analyst to simplify the stochastic model. Finally, our findings indicate that cancelation is a more valuable option when holding costs are relatively high, while expediting is more appealing when backorder costs are high.

@&#ACKNOWLEDGMENTS@&#

This research was supported in part by Lilly Endowment, Inc., through its support for the Indiana University Pervasive Technology Institute, and in part by the Indiana METACyt Initiative. The Indiana METACyt Initiative at IU is also supported in part by Lilly Endowment, Inc.


                     
                        Proposition 3a
                        
                           If
                           
                              
                                 
                                    c
                                    
                                       E
                                       i
                                    
                                 
                                 ≥
                                 b
                                 
                                    (
                                    
                                       
                                          
                                             α
                                             i
                                          
                                          −
                                          
                                             α
                                             j
                                          
                                       
                                       
                                          1
                                          −
                                          α
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    c
                                    
                                       E
                                       j
                                    
                                 
                              
                           
                           , then it is not optimal to expedite i periods out.
                        

Proof for 3a (the proof for 3b is similar):

From (1) (and intuitively), we note that if we expedite (as a decision in the current period t) a unit i periods out instead of j periods out (with i<j), we incur—immediately and for sure—an additional cost cEi
                     –cEj
                     . This cost may be offset (in future periods) by expected savings in backorder costs between periods i and j (of b per backorder saved per period) but may also lead to an increase in expected holding costs (of h per unit of increased inventory per period). Let 
                        
                           
                              
                                 
                                    z
                                    →
                                 
                                 
                                    t
                                    E
                                    i
                                 
                              
                           
                           
                              
                              ′
                           
                        
                      and 
                        
                           
                              
                                 
                                    z
                                    →
                                 
                                 
                                    t
                                    E
                                    j
                                 
                              
                           
                           
                              
                              ′
                           
                        
                      represent alternative decisions (for the current period t) that differ only in the choice to expedite in period i or j respectively (and assume that both are from the set of admissible actions 
                        
                           A
                           (
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    t
                                 
                              
                              
                                 
                                 ′
                              
                           
                           )
                        
                     ). That is, if 
                        
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    t
                                 
                              
                              
                                 
                                 ′
                              
                           
                           =
                           
                           
                              (
                              
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                       −
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                       −
                                       j
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                       −
                                       N
                                    
                                 
                              
                              )
                           
                        
                     , then 
                        
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    
                                       t
                                       E
                                       i
                                    
                                 
                              
                              
                                 
                                 ′
                              
                           
                           =
                           
                              (
                              
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                       −
                                       i
                                    
                                 
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                       −
                                       j
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                       −
                                       N
                                    
                                 
                              
                              )
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    
                                       t
                                       E
                                       j
                                    
                                 
                              
                              
                                 
                                 ′
                              
                           
                           =
                           
                              (
                              
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                       −
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                       −
                                       j
                                    
                                 
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    z
                                    
                                       t
                                       ,
                                       t
                                       −
                                       N
                                    
                                 
                              
                              )
                           
                        
                     . Let 
                        
                           B
                           (
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    
                                       t
                                       E
                                       i
                                    
                                 
                              
                              
                                 
                                 ′
                              
                           
                           )
                        
                      and 
                        
                           B
                           (
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    
                                       t
                                       E
                                       j
                                    
                                 
                              
                              
                                 
                                 ′
                              
                           
                           )
                        
                      represent the expected backorder costs over the horizon (T) given 
                        
                           
                              
                                 
                                    z
                                    →
                                 
                                 
                                    t
                                    E
                                    i
                                 
                              
                           
                           
                              
                              ′
                           
                        
                      and 
                        
                           
                              
                                 
                                    z
                                    →
                                 
                                 
                                    t
                                    E
                                    j
                                 
                              
                           
                           
                              
                              ′
                           
                        
                     . The maximum savings that could be achieved by expediting in i rather than j would be to prevent a backorder in each of the periods (between i and j). That is, 
                        
                           B
                           
                              (
                              
                                 
                                    
                                       
                                          z
                                          →
                                       
                                       
                                          t
                                          E
                                          j
                                       
                                    
                                 
                                 
                                    
                                    ′
                                 
                              
                              )
                           
                           −
                           B
                           
                              (
                              
                                 
                                    
                                       
                                          z
                                          →
                                       
                                       
                                          t
                                          E
                                          i
                                       
                                    
                                 
                                 
                                    
                                    ′
                                 
                              
                              )
                           
                           ≤
                           
                              α
                              i
                           
                           b
                           +
                           
                              α
                              
                                 i
                                 +
                                 1
                              
                           
                           b
                           +
                           ⋯
                           +
                           
                              α
                              
                                 j
                                 −
                                 1
                              
                           
                           b
                        
                     . Thus, 
                        
                           B
                           
                              (
                              
                                 
                                    
                                       
                                          z
                                          →
                                       
                                       
                                          t
                                          E
                                          j
                                       
                                    
                                 
                                 
                                    
                                    ′
                                 
                              
                              )
                           
                           −
                           B
                           
                              (
                              
                                 
                                    
                                       
                                          z
                                          →
                                       
                                       
                                          t
                                          E
                                          i
                                       
                                    
                                 
                                 
                                    
                                    ′
                                 
                              
                              )
                           
                           ≤
                           b
                           
                              (
                              
                                 
                                    α
                                    i
                                 
                                 −
                                 
                                    α
                                    j
                                 
                              
                              )
                           
                           /
                           
                              (
                              
                                 1
                                 −
                                 α
                              
                              )
                           
                           
                              )
                           
                        
                     . Note that actual backorder savings will be less than this maximum since there is a (significant) probability that not every one of these backorders will occur, depending on demand.

Similarly, let 
                        
                           H
                           (
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    
                                       t
                                       E
                                       i
                                    
                                 
                              
                              
                                 
                                 ′
                              
                           
                           )
                        
                      and 
                        
                           H
                           (
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    
                                       t
                                       E
                                       j
                                    
                                 
                              
                              
                                 
                                 ′
                              
                           
                           )
                        
                      represent the expected holding costs over the horizon (T) given 
                        
                           
                              
                                 
                                    z
                                    →
                                 
                                 
                                    t
                                    E
                                    i
                                 
                              
                           
                           
                              
                              ′
                           
                        
                      and 
                        
                           
                              
                                 
                                    z
                                    →
                                 
                                 
                                    t
                                    E
                                    j
                                 
                              
                           
                           
                              
                              ′
                           
                        
                     .

The decision to expedite in i (instead of j) can thus be expressed as follows: it is better to expedite a unit i periods out instead of j periods out if and only if the additional cost of expediting in i added to the expected additional holding costs is less than the expected additional backorder costs:

                        
                           
                              
                                 
                                    c
                                    
                                       E
                                       i
                                    
                                 
                                 −
                                 
                                    c
                                    
                                       E
                                       j
                                    
                                 
                                 +
                                 
                                    (
                                    
                                       H
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      z
                                                      →
                                                   
                                                   
                                                      t
                                                      E
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          )
                                       
                                       −
                                       H
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      z
                                                      →
                                                   
                                                   
                                                      t
                                                      E
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                    )
                                 
                                 <
                                 
                                    (
                                    
                                       B
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      z
                                                      →
                                                   
                                                   
                                                      t
                                                      E
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          )
                                       
                                       −
                                       B
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      z
                                                      →
                                                   
                                                   
                                                      t
                                                      E
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                    )
                                 
                              
                           
                        
                     Thus, if 
                        
                           
                              c
                              
                                 E
                                 i
                              
                           
                           −
                           
                              c
                              
                                 E
                                 j
                              
                           
                           +
                           
                              (
                              
                                 H
                                 
                                    (
                                    
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             
                                                t
                                                E
                                                i
                                             
                                          
                                       
                                       
                                          
                                          ′
                                       
                                    
                                    )
                                 
                                 −
                                 H
                                 
                                    (
                                    
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             
                                                t
                                                E
                                                j
                                             
                                          
                                       
                                       
                                          
                                          ′
                                       
                                    
                                    )
                                 
                              
                              )
                           
                           ≥
                           
                              (
                              
                                 B
                                 
                                    (
                                    
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             
                                                t
                                                E
                                                j
                                             
                                          
                                       
                                       
                                          
                                          ′
                                       
                                    
                                    )
                                 
                                 −
                                 B
                                 
                                    (
                                    
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             
                                                t
                                                E
                                                i
                                             
                                          
                                       
                                       
                                          
                                          ′
                                       
                                    
                                    )
                                 
                              
                              )
                           
                        
                     , then it is not optimal to expedite i periods out (because you'd be better off to expedite in j).

Since the right hand side is less than 
                        
                           b
                           
                              (
                              
                                 
                                    α
                                    i
                                 
                                 −
                                 
                                    α
                                    j
                                 
                              
                              )
                           
                           /
                           
                              (
                              
                                 1
                                 −
                                 α
                              
                              )
                           
                           
                              )
                           
                        
                     , we can replace the right hand side with the larger 
                        
                           b
                           
                              (
                              
                                 
                                    α
                                    i
                                 
                                 −
                                 
                                    α
                                    j
                                 
                              
                              )
                           
                           /
                           
                              (
                              
                                 1
                                 −
                                 α
                              
                              )
                           
                           
                              )
                           
                        
                     , then we continue to conclude that if 
                        
                           
                              c
                              
                                 E
                                 i
                              
                           
                           −
                           
                              c
                              
                                 E
                                 j
                              
                           
                           +
                           
                              (
                              
                                 H
                                 
                                    (
                                    
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             
                                                t
                                                E
                                                i
                                             
                                          
                                       
                                       
                                          
                                          ′
                                       
                                    
                                    )
                                 
                                 −
                                 H
                                 
                                    (
                                    
                                       
                                          
                                             
                                                z
                                                →
                                             
                                             
                                                t
                                                E
                                                j
                                             
                                          
                                       
                                       
                                          
                                          ′
                                       
                                    
                                    )
                                 
                              
                              )
                           
                           ≥
                           b
                           
                              (
                              
                                 
                                    α
                                    i
                                 
                                 −
                                 
                                    α
                                    j
                                 
                              
                              )
                           
                           /
                           
                              (
                              
                                 1
                                 −
                                 α
                              
                              )
                           
                           
                              )
                           
                        
                     , then it is not optimal to expedite i periods out.

Similarly, since 
                        
                           (
                           
                              H
                              
                                 (
                                 
                                    
                                       
                                          
                                             z
                                             →
                                          
                                          
                                             t
                                             E
                                             i
                                          
                                       
                                    
                                    
                                       
                                       ′
                                    
                                 
                                 )
                              
                              −
                              H
                              
                                 (
                                 
                                    
                                       
                                          
                                             z
                                             →
                                          
                                          
                                             t
                                             E
                                             j
                                          
                                       
                                    
                                    
                                       
                                       ′
                                    
                                 
                                 )
                              
                           
                           )
                           ≥
                           0
                        
                     , if we drop it from the left hand side, then we continue to conclude that if

                        
                           
                              
                                 
                                    c
                                    
                                       E
                                       i
                                    
                                 
                                 −
                                 
                                    c
                                    
                                       E
                                       j
                                    
                                 
                                 ≥
                                 b
                                 
                                    (
                                    
                                       
                                          α
                                          i
                                       
                                       −
                                       
                                          α
                                          j
                                       
                                    
                                    )
                                 
                                 /
                                 
                                    (
                                    
                                       1
                                       −
                                       α
                                    
                                    )
                                 
                                 
                                    )
                                 
                              
                           
                        
                     Thus, while the exact calculation of 
                        
                           H
                           (
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    
                                       t
                                       E
                                       i
                                    
                                 
                              
                              
                                 
                                 ′
                              
                           
                           )
                        
                      and 
                        
                           H
                           (
                           
                              
                                 
                                    
                                       z
                                       →
                                    
                                    
                                       t
                                       E
                                       j
                                    
                                 
                              
                              
                                 
                                 ′
                              
                           
                           )
                        
                      is complex, it can be ignored and we continue to have a bound (albeit not as tight). To the extent that the difference between these costs is great, our bound is less tight.

Thus, if
                     
                        
                           
                              c
                              
                                 E
                                 i
                              
                           
                           ≥
                           b
                           
                              (
                              
                                 
                                    
                                       α
                                       i
                                    
                                    −
                                    
                                       α
                                       j
                                    
                                 
                                 
                                    1
                                    −
                                    α
                                 
                              
                              )
                           
                           +
                           
                              c
                              
                                 E
                                 j
                              
                           
                        
                     
                     , then it is not optimal to expedite i periods out. 
                     □


                     
                        Proposition 4a
                        
                           As h → ∞ (or similarly, there is a policy to never hold inventory) and cEi
                            < ∞ ∀i, then it is never optimal to plan any (future) positive production amount greater than the minimum demand plus backorders.
                        


                     
                        Proof
                        Because producing more than the minimum demand would pose a risk of incurring holding costs however small the production amount is, the only strategy to ensure avoiding holding costs would be to never place any order for future production that exceeds the minimum demand. Once the demand is realized, the decision maker knows the exact amount to produce to meet the demand with zero probability of incurring holding costs. The decision maker's options are expediting in any period within the time fence, or producing right when the time fence expires. The optimal strategy is obtained by minimizing the sum of expediting costs and backorder costs. □


                     
                        Proposition 4b
                        As b → ∞ (or similarly, there is a policy to never miss demand) and cCi
                            < ∞ ∀i, if the demand distribution has a finite maximum, then it is always optimal to plan to produce up to the maximum demand, then use cancelation to drop down to actual demand.


                     
                        Proof
                        To ensure avoiding backorder cost at all times, it is optimal to plan to produce up to the maximum demand. Once the demand is realized, the decision maker knows the excess inventory and can cancel future production plan accordingly, either in a period within the time fence or right after the time fence expires. The optimal period to cancel is obtained by minimizing the sum of canceling costs and holding costs. □

For this example, we use the experimental parameters from Table 2 and model demand with the symmetric distribution. 
                     Table B1
                      shows parameters used in a sample run where the scheduling process details for the two models are shown in Table B2
                      (DetLP) and Table B3
                      (StoLP) for ten periods “rolled” through periods 60 – 51.

In Table B2, we note that the deterministic model does not “foresee” the possibility that demand may be either higher or lower than the mean (of 8). In this example, deviations from average are compensated for by either expediting or canceling actions. However, as the schedule is rolled forward in the next period (i.e., the next row of the table) the compensation often turns out to have been unnecessary, leading to additional adjustments to the schedule and increased costs.

In the StoLP example, shown in Table B3 for the same parameters and demand, we see that the schedule better accommodates the anticipated randomness by acknowledging that demand may be more or less than 8 units per period. For the 10 periods displayed in this example, the StoLP model outperforms the DetLP model with a cost of $69 versus $157, or 56% lower. Over the course of the entire simulation run (100 periods replicated ten times), the costs of the StoLP for these particular parameters are on average 49.6% lower than those of the DetLP.

@&#REFERENCES@&#

