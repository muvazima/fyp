@&#MAIN-TITLE@&#Generalized quantum splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Quantum splines are extended to splines whose divided differences agree at the joins.


                        
                        
                           
                           Generalized quantum blossoms are used to derive properties of generalized quantum splines.


                        
                        
                           
                           Algorithms and formulas are extended from quantum splines to generalized quantum splines.


                        
                        
                           
                           Generalized quantum B-spline bases and generalized quantum B-spline curves are also studied.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Generalized quantum blossom

Generalized quantum differentiation

Generalized quantum B-splines

de Boor algorithm

Knot insertion algorithms

Marsden's identity

@&#ABSTRACT@&#


               
               
                  Generalized quantum splines are piecewise polynomials whose generalized quantum derivatives agree up to some order at the joins. Just like classical and quantum splines, generalized quantum splines admit a canonical basis with compact support: the generalized quantum B-splines. Here we study generalized quantum B-spline bases and generalized quantum B-spline curves, using a very general variant of the blossom: the generalized quantum blossom. Applying the generalized quantum blossom, we develop algorithms and identities for generalized quantum B-spline bases and generalized quantum B-spline curves, including generalized quantum variants of the de Boor algorithms for recursive evaluation and generalized quantum differentiation, knot insertion procedures for converting from generalized quantum B-spline to piecewise generalized quantum Bézier form, and a generalized quantum variant of Marsden's identity.
               
            

@&#INTRODUCTION@&#

Quantum splines are piecewise polynomials whose quantum derivatives up to some order agree at the joins (Simeonov and Goldman, 2013). But what precisely are quantum derivatives? The primary objectives of this paper are to provide the most general definition of quantum derivatives and then to investigate the most general types of quantum splines.

In the quantum calculus there are two standard notions of quantum derivatives: h-derivatives and q-derivatives (Kac and Cheung, 2002). The h-derivative is defined by the difference quotient
                        
                           
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              f
                              )
                              (
                              t
                              )
                              =
                              (
                              f
                              (
                              t
                              +
                              h
                              )
                              −
                              f
                              (
                              t
                              )
                              )
                              /
                              h
                              .
                           
                        
                      The q-derivative is expressed by another difference quotient
                        
                           
                              
                                 
                                    D
                                 
                                 
                                    q
                                 
                              
                              (
                              f
                              )
                              (
                              t
                              )
                              =
                              (
                              f
                              (
                              q
                              t
                              )
                              −
                              f
                              (
                              t
                              )
                              )
                              /
                              (
                              (
                              q
                              −
                              1
                              )
                              t
                              )
                              .
                           
                        
                      The classical derivative is a limiting case of these quantum derivatives, since
                        
                           
                              D
                              (
                              f
                              )
                              (
                              t
                              )
                              =
                              
                                 lim
                                 
                                    h
                                    →
                                    0
                                 
                              
                              ⁡
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              f
                              )
                              (
                              t
                              )
                              ,
                              
                              D
                              (
                              f
                              )
                              (
                              t
                              )
                              =
                              
                                 lim
                                 
                                    q
                                    →
                                    1
                                 
                              
                              ⁡
                              
                                 
                                    D
                                 
                                 
                                    q
                                 
                              
                              (
                              f
                              )
                              (
                              t
                              )
                              .
                           
                        
                      Thus these quantum derivatives are discrete approximations to the classical derivative.

But there are many other ways to approximate the classical derivative with difference quotients. For example, we could take the symmetric differences
                        
                           
                              S
                              
                                 
                                    D
                                 
                                 
                                    h
                                 
                              
                              (
                              f
                              )
                              (
                              t
                              )
                              =
                              (
                              f
                              (
                              t
                              +
                              h
                              )
                              −
                              f
                              (
                              t
                              −
                              h
                              )
                              )
                              /
                              (
                              2
                              h
                              )
                              ,
                           
                        
                      which are perhaps a more natural way to approximate the classical derivative. Or we could combine the h-derivative and the q-derivative into a single 
                        (
                        q
                        ,
                        h
                        )
                     -derivative
                        
                           
                              
                                 
                                    D
                                 
                                 
                                    q
                                    ,
                                    h
                                 
                              
                              (
                              f
                              )
                              (
                              t
                              )
                              =
                              (
                              f
                              (
                              q
                              t
                              +
                              h
                              )
                              −
                              f
                              (
                              t
                              )
                              )
                              /
                              (
                              (
                              q
                              −
                              1
                              )
                              t
                              +
                              h
                              )
                              .
                           
                        
                      Evidently then there are many different types of quantum derivatives.

Quantum splines based on the h-derivative were introduced in the early 1970s by Schumaker and Mangasarian (1971, 1973) in order to investigate some constrained minimization problems in Euclidean space, which are suggested by certain minimization problems in Banach space whose solutions are generalized splines. These h-splines were then studied extensively a few years later by Lyche (1975) using divided differences. Lyche's motivation included finding best summation formulas, computing nonlinear splines, performing spline interpolation with curved constraints, solving discrete operator equations, and computing discrete least squares.

More recently Simeonov and Goldman (2013) examined quantum splines based on the q-derivative using a generalization of classical blossoming, which they call quantum blossoming (Simeonov et al., 2012). Simeonov and Goldman were motivated by two properties of quantum B-splines not available in classical B-splines: tolerances and interpolation. Quantum derivatives approximate classical derivatives, so quantum splines are natural if one wants to do design for manufacture. During manufacturing two adjacent surfaces will never meet with exact matching derivatives; manufacturing smooth joins is only possible within some tolerance. Quantum splines can include these tolerances as approximations to the derivatives during design, rather than putting tolerances in by hand after the fact as is necessary with classical splines. In addition, for special knot sequences quantum B-splines interpolate all their control points; this interpolation property is not available with classical B-splines without solving systems of linear equations. Simeonov and Goldman also show that h-splines are a limiting case of q-splines, so the theory of q-splines includes the theory of h-splines as a limiting case.


                     The primary purpose of this paper is to investigate the most general type of quantum splines based on the most general form of the quantum derivative. To perform this analysis, we shall apply the most general form of the quantum blossom. As a running example, we shall study 
                     
                        (
                        q
                        ,
                        h
                        )
                     
                     -splines based on the 
                     
                        (
                        q
                        ,
                        h
                        )
                     
                     -derivative, where more explicit formulas often exist. The theory of 
                     
                        (
                        q
                        ,
                        h
                        )
                     
                     -splines completes the theory of q-splines and h-splines first investigated in 
                     
                        Mangasarian and Schumaker (1971, 1973)
                     
                     , 
                     
                        Lyche (1975)
                     
                     , and 
                     
                        Simeonov and Goldman (2013)
                     
                     .
                  

Quantum derivatives are difference quotients, and difference quotients are divided differences. Thus
                        
                           
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       f
                                       )
                                       (
                                       t
                                       )
                                       =
                                       (
                                       f
                                       (
                                       t
                                       +
                                       h
                                       )
                                       −
                                       f
                                       (
                                       t
                                       )
                                       )
                                       /
                                       h
                                       =
                                       f
                                       [
                                       t
                                       ,
                                       t
                                       +
                                       h
                                       ]
                                       .
                                    
                                 
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             q
                                          
                                       
                                       (
                                       f
                                       )
                                       (
                                       t
                                       )
                                       =
                                       (
                                       f
                                       (
                                       q
                                       t
                                       )
                                       −
                                       f
                                       (
                                       t
                                       )
                                       )
                                       /
                                       (
                                       (
                                       q
                                       −
                                       1
                                       )
                                       t
                                       )
                                       =
                                       f
                                       [
                                       t
                                       ,
                                       q
                                       t
                                       ]
                                       .
                                    
                                 
                              
                           
                        
                      Moreover higher order h-derivatives and q-derivatives are also divided differences up to constant multiples, since
                        
                           
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       f
                                       )
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             h
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       f
                                       )
                                       )
                                       (
                                       t
                                       )
                                       =
                                       m
                                       !
                                       f
                                       [
                                       t
                                       ,
                                       t
                                       +
                                       h
                                       ,
                                       …
                                       ,
                                       t
                                       +
                                       m
                                       h
                                       ]
                                    
                                 
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             q
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       f
                                       )
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             D
                                          
                                          
                                             q
                                          
                                       
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             q
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       (
                                       f
                                       )
                                       )
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             [
                                             m
                                             ]
                                          
                                          
                                             q
                                          
                                       
                                       !
                                       f
                                       [
                                       t
                                       ,
                                       q
                                       t
                                       ,
                                       …
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             m
                                          
                                       
                                       t
                                       ]
                                       ,
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              [
                              m
                              ]
                           
                           
                              q
                           
                        
                      is a q-integer (see Section 2). Therefore, to generalize our notions of quantum splines, we shall consider quantum derivatives based on divided differences.

To define the general concept of an m-th order quantum derivative, we start with an arbitrary collection of linear functions 
                        G
                        (
                        t
                        )
                        =
                        (
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        t
                        )
                        )
                     . We set the m-th order quantum G-derivative to be
                        
                           (1.1)
                           
                              
                                 
                                    D
                                 
                                 
                                    G
                                 
                                 
                                    m
                                 
                              
                              (
                              f
                              )
                              (
                              t
                              )
                              =
                              f
                              [
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    m
                                    +
                                    1
                                 
                              
                              (
                              t
                              )
                              ]
                              ,
                              
                              m
                              =
                              0
                              ,
                              …
                              ,
                              d
                              −
                              1
                              .
                           
                        
                      A generalized quantum spline or G-spline is a piecewise polynomial whose G-derivatives up to some order agree at the knots.

We begin our investigation of these generalized quantum splines in Section 2 with a brief review of divided differences. We then define quantum derivatives as in (1.1) in terms of divided differences composed with linear functions.

In Section 3 we recall the notion of the generalized quantum blossom from Goldman and Simeonov (in press), which is our main tool for analyzing quantum splines. The generalized quantum blossom or the quantum G-blossom of a degree d polynomial 
                        P
                        (
                        t
                        )
                      is the unique symmetric, multiaffine function 
                        p
                        (
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              u
                           
                           
                              d
                           
                        
                        ;
                        G
                        )
                      that reduces to 
                        P
                        (
                        t
                        )
                      along the G-diagonal-that is, 
                        p
                        (
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        t
                        )
                        ;
                        G
                        )
                        =
                        P
                        (
                        t
                        )
                     . Under mild restrictions on the linear functions 
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        t
                        )
                     , the G-blossom does indeed exist and is unique (Goldman and Simeonov, in press).

We apply this G-blossom in Section 4 to construct the local quantum analogue of the de Boor recursive evaluation algorithm for one polynomial segment of a quantum spline. Since at this point we are dealing with a single polynomial segment, here we also investigate quantum Bernstein basis functions, the generalized quantum analogues of the classical Bernstein basis functions.

Section 5 is devoted to the study of piecewise polynomials generated locally by the quantum analogue of the de Boor recursive evaluation algorithm. We call these curves generalized quantum B-spline curves or G-B-spline curves, and we show that these G-B-spline curves are indeed piecewise polynomials whose quantum G-derivatives up to some order agree at the joins. In the rest of this paper we shall often omit the adjective generalized when speaking about quantum blossoms, quantum B-splines, and quantum Bernstein bases.

In Section 6 we study multiplicity. For quantum splines there are two kinds of multiplicity: multiplicity in the knots 
                        T
                        =
                        {
                        
                           
                              t
                           
                           
                              i
                           
                        
                        }
                      and multiplicity in the linear functions 
                        G
                        (
                        t
                        )
                        =
                        (
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        t
                        )
                        )
                     . We show that multiplicity in the knots T decreases the order of smoothness at the knots, but multiplicity in the functions 
                        G
                        (
                        t
                        )
                      increases the order of smoothness at the knots.

In Section 7 we consider the question of whether all quantum spline curves are quantum B-spline curves-that is, can all piecewise polynomials whose quantum derivatives up to some order agree at the knots be generated by the quantum de Boor algorithm? Classically all spline curves are indeed B-spline curves-that is, all piecewise polynomials whose classical derivatives up to some order agree at the knots can be generated by the de Boor algorithm (Goldman, 2003). For quantum splines we show that in certain important special cases all quantum spline curves are indeed quantum B-spline curves, but in the Appendix we provide an example to show that this result fails to hold in full generality.

Some elementary properties of quantum B-spline curves that mostly mimic the elementary properties of classical B-spline curves are presented in Section 8. Some non-classical properties such as interpolation of all the control points for certain special knot sequences are also derived.

In Section 9 standard knot insertion algorithms for classical B-spline curves are shown to hold as well for quantum B-spline curves. However, the control polygons generated by these knot insertion algorithms do not converge to the original quantum B-spline curves, so we cannot use standard knot insertion algorithms to analyze quantum B-spline curves. Nevertheless, we can use these standard knot insertion procedures to convert from quantum B-spline to piecewise quantum Bézier form. Subdivision algorithms for quantum Bézier curves based on knot insertion procedures do converge to the original quantum Bézier curves (Goldman and Simeonov, in press; Simeonov et al., 2012, 2011). So by converting to piecewise quantum Bézier form, we can apply knot insertion procedures to render and intersect quantum B-spline curves.

We close in Section 10 by studying quantum B-spline bases, the quantum analogues of classical B-spline bases. We show that these quantum B-spline bases share many of the properties of classical B-spline bases: they form a partition of unity, have compact support, and satisfy a de Boor recurrence, a two term differentiation formula, a Marsden identity, a truncated powers formula, and a de Boor–Fix formula. Some non-classical properties such as cardinal conditions for certain special knot sequences are also investigated.

Quantum splines are piecewise polynomials whose quantum derivatives up to some order agree at the joins. Since quantum derivatives are defined in terms of divided differences, we begin here with a brief review of divided differences.

The d-th order divided difference of a function f evaluated at the nodes 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ≤
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ≤
                           …
                           ≤
                           
                              
                                 t
                              
                              
                                 d
                              
                           
                         is denoted by 
                           f
                           [
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 d
                              
                           
                           ]
                         and can be defined recursively by setting (Goldman, 2003, Section 4.2):
                           
                              
                                 
                                    
                                       
                                          f
                                          [
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          ]
                                          =
                                          f
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          f
                                          [
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                d
                                             
                                          
                                          ]
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                            [
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                            ]
                                                            −
                                                            f
                                                            [
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  d
                                                                  −
                                                                  1
                                                               
                                                            
                                                            ]
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      ≠
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  f
                                                               
                                                               
                                                                  (
                                                                  d
                                                                  )
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            d
                                                            !
                                                         
                                                      
                                                      ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         We extend this definition by setting
                           
                              
                                 f
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       σ
                                       (
                                       0
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       σ
                                       (
                                       d
                                       )
                                    
                                 
                                 ]
                                 =
                                 f
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                                 ]
                              
                           
                         for every permutation σ of the integers 
                           0
                           ,
                           …
                           ,
                           d
                        . It follows easily by induction on d that the divided difference is well-defined. We shall also need the following result about divided differences.


                        
                           Proposition 2.1
                           
                              The following statements are equivalent:
                           


                              1. 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       m
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       m
                                    
                                 
                                 ]
                              
                              , 
                              
                                 m
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                              
                              .
                           


                              2. 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 ]
                               
                              for every subset 
                              
                                 {
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 }
                               
                              of 
                              
                                 {
                                 0
                                 ,
                                 …
                                 ,
                                 d
                                 }
                              
                              .
                           


                              3. For every 
                              
                                 0
                                 ≤
                                 i
                                 ≤
                                 d
                              
                              , 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              , 
                              
                                 r
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 1
                              
                              , where 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                               
                              is the multiplicity of 
                              
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                               
                              in the set 
                              
                                 
                                    
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                       }
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       d
                                    
                                 
                              
                              .
                           


                        
                           Proof
                           
                              
                                 1
                                 ⇔
                                 2
                              : This equivalence follows from Lemma 2.2 below.


                              
                                 2
                                 ⇒
                                 3
                              : Follows from the definition of divided difference.


                              
                                 3
                                 ⇒
                                 2
                              : Follows easily by induction on k. □


                        
                           Lemma 2.2
                           
                              The following statements are equivalent:
                           


                              1. 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       m
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       m
                                    
                                 
                                 ]
                              
                              , 
                              
                                 m
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                              
                              .
                           


                              2. 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       k
                                    
                                 
                                 ]
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       k
                                    
                                 
                                 ]
                              
                              , 
                              
                                 0
                                 ≤
                                 i
                                 ≤
                                 i
                                 +
                                 k
                                 ≤
                                 d
                              
                              .
                           


                        
                           Proof
                           
                              
                                 1
                                 ⇒
                                 2
                              : Follows easily by induction on i.


                              
                                 2
                                 ⇒
                                 1
                              : Obvious. □

Quantum derivatives are defined in terms of divided differences. For example, given 
                           h
                           ≠
                           0
                         the quantum h-derivative is defined by
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 f
                                 )
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       f
                                       (
                                       t
                                       +
                                       h
                                       )
                                       −
                                       f
                                       (
                                       t
                                       )
                                    
                                    h
                                 
                                 =
                                 f
                                 [
                                 t
                                 ,
                                 t
                                 +
                                 h
                                 ]
                                 .
                              
                           
                         Similarly, given 
                           q
                           ≠
                           1
                         the quantum q-derivative is defined by
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 f
                                 )
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       f
                                       (
                                       q
                                       t
                                       )
                                       −
                                       f
                                       (
                                       t
                                       )
                                    
                                    
                                       (
                                       q
                                       −
                                       1
                                       )
                                       t
                                    
                                 
                                 =
                                 f
                                 [
                                 t
                                 ,
                                 q
                                 t
                                 ]
                                 .
                              
                           
                        
                     

We can extend these standard notions of a quantum derivative to a quantum 
                           (
                           q
                           ,
                           h
                           )
                        -derivative. Given 
                           q
                           ≠
                           0
                         and 
                           (
                           q
                           ,
                           h
                           )
                           ≠
                           (
                           1
                           ,
                           0
                           )
                        , the 
                           (
                           q
                           ,
                           h
                           )
                        -derivative of a function 
                           f
                           (
                           t
                           )
                         is defined by
                           
                              (2.1)
                              
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 (
                                 f
                                 )
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       f
                                       (
                                       q
                                       t
                                       +
                                       h
                                       )
                                       −
                                       f
                                       (
                                       t
                                       )
                                    
                                    
                                       (
                                       q
                                       −
                                       1
                                       )
                                       t
                                       +
                                       h
                                    
                                 
                                 =
                                 f
                                 [
                                 t
                                 ,
                                 q
                                 t
                                 +
                                 h
                                 ]
                                 .
                              
                           
                         If 
                           f
                           (
                           t
                           )
                         is differentiable at t, then
                           
                              (2.2)
                              
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       ,
                                       0
                                    
                                 
                                 (
                                 f
                                 )
                                 (
                                 t
                                 )
                                 :
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    lim
                                    
                                       (
                                       q
                                       ,
                                       h
                                       )
                                       →
                                       (
                                       1
                                       ,
                                       0
                                       )
                                    
                                 
                                 ⁡
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 (
                                 f
                                 )
                                 (
                                 t
                                 )
                                 .
                              
                           
                         The product rule for 
                           
                              
                                 D
                              
                              
                                 q
                                 ,
                                 h
                              
                           
                         is
                           
                              (2.3)
                              
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 (
                                 t
                                 )
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 q
                                 t
                                 +
                                 h
                                 )
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 (
                                 t
                                 )
                                 .
                              
                           
                        
                     

For a function 
                           f
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                         we define the quantum 
                           (
                           q
                           ,
                           h
                           )
                        -partial derivatives by
                           
                              (2.4)
                              
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 (
                                 f
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    
                                       f
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             j
                                             −
                                             1
                                          
                                       
                                       ,
                                       q
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       h
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       q
                                       −
                                       1
                                       )
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       h
                                    
                                 
                                 .
                              
                           
                         It follows immediately from (2.4) that these partial derivatives commute, that is
                           
                              (2.5)
                              
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 (
                                 f
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 )
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 (
                                 f
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 )
                                 ,
                                 
                                 1
                                 ≤
                                 j
                                 ≠
                                 l
                                 ≤
                                 n
                                 .
                              
                           
                        
                     

Higher order 
                           (
                           q
                           ,
                           h
                           )
                        -derivatives can also be expressed in terms of divided differences. To see how, we need to employ composite functions. Set 
                           g
                           (
                           t
                           )
                           =
                           q
                           t
                           +
                           h
                         with 
                           q
                           ≠
                           0
                        . It follows by induction on m that the m-fold composition of 
                           g
                           (
                           t
                           )
                         with itself is
                           
                              (2.6)
                              
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                 
                                    
                                       
                                          g
                                          ∘
                                          ⋯
                                          ∘
                                          g
                                       
                                       ︸
                                    
                                    m
                                 
                                 )
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       m
                                    
                                 
                                 t
                                 +
                                 
                                    
                                       [
                                       m
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 h
                              
                           
                         where the q-integer 
                           
                              
                                 [
                                 m
                                 ]
                              
                              
                                 q
                              
                           
                         is defined by
                           
                              
                                 
                                    
                                       [
                                       m
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 =
                                 1
                                 +
                                 q
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       [
                                       m
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             m
                                          
                                       
                                       −
                                       1
                                    
                                    
                                       q
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                 q
                                 ≠
                                 1
                                 .
                              
                           
                         We set 
                           
                              
                                 g
                              
                              
                                 [
                                 0
                                 ]
                              
                           
                           (
                           t
                           )
                           =
                           t
                         and for later use we also introduce the inverse functions
                           
                              (2.7)
                              
                                 
                                    
                                       g
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 t
                                 /
                                 q
                                 −
                                 h
                                 /
                                 q
                                 ,
                                 
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       −
                                       m
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 .
                              
                           
                         From (2.6) it follows that
                           
                              (2.8)
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          m
                                          ]
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    t
                                    =
                                    
                                       
                                          [
                                          m
                                          ]
                                       
                                       
                                          q
                                       
                                    
                                    (
                                    g
                                    (
                                    t
                                    )
                                    −
                                    t
                                    )
                                    ,
                                 
                              
                           
                        
                        
                           
                              (2.9)
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          m
                                          ]
                                       
                                    
                                    (
                                    y
                                    )
                                    −
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          m
                                          ]
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          q
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    y
                                    −
                                    x
                                    )
                                    .
                                 
                              
                           
                        
                     

Using the composite functions 
                           
                              
                                 g
                              
                              
                                 [
                                 m
                                 ]
                              
                           
                           (
                           t
                           )
                        , we can now compute higher order 
                           (
                           q
                           ,
                           h
                           )
                        -derivatives in terms of divided differences. Indeed by (2.8) and induction on m, we have
                           
                              (2.10)
                              
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 f
                                 )
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 f
                                 (
                                 t
                                 )
                                 )
                                 =
                                 
                                    
                                       [
                                       m
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 !
                                 f
                                 [
                                 t
                                 ,
                                 g
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       m
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 ]
                                 ,
                              
                           
                         where 
                           
                              
                                 [
                                 m
                                 ]
                              
                              
                                 q
                              
                           
                           !
                         denotes the q-shifted factorial of m defined by Andrews et al. (1999), Kac and Cheung (2002)
                        
                           
                              
                                 
                                    
                                       [
                                       m
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 !
                                 =
                                 
                                    
                                       [
                                       1
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       [
                                       2
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 ⋯
                                 
                                    
                                       [
                                       m
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 ,
                                 
                                 m
                                 ≥
                                 1
                                 ,
                                 
                                 
                                    
                                       [
                                       0
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 !
                                 =
                                 1
                                 .
                              
                           
                         Later in the paper we shall also use the q-binomial coefficients defined for 
                           q
                           ≠
                           −
                           1
                         by Andrews et al. (1999), Kac and Cheung (2002)
                        
                           
                              (2.11)
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                m
                                             
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             [
                                             m
                                             ]
                                          
                                          
                                             q
                                          
                                       
                                       !
                                    
                                    
                                       
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             q
                                          
                                       
                                       !
                                       
                                          
                                             [
                                             m
                                             −
                                             i
                                             ]
                                          
                                          
                                             q
                                          
                                       
                                       !
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 .
                              
                           
                         The following rule is an immediate consequence of definitions (2.1), (2.10), and (2.6):
                           
                              (2.12)
                              
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          q
                                          ,
                                          h
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    f
                                    )
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          
                                             
                                                m
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    )
                                 
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 (
                                 f
                                 )
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          
                                             
                                                m
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                 
                                 .
                              
                           
                        
                     

As an example of the 
                           (
                           q
                           ,
                           h
                           )
                        -derivative, we compute the 
                           (
                           q
                           ,
                           h
                           )
                        -derivative on monomials. Notice the similarities and differences between the 
                           (
                           q
                           ,
                           h
                           )
                        -derivative on monomials and the classical derivative on monomials. 
                           Lemma 2.3
                           
                              Let 
                              
                                 q
                                 ≠
                                 0
                               
                              and 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              . Then
                           


                              1. 
                              
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       [
                                       d
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    lower order terms
                                 
                              
                              .
                           


                              2. 
                              
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       [
                                       d
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 !
                              
                              .
                           


                              3. 
                              
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 =
                                 0
                               
                              for 
                              
                                 m
                                 >
                                 d
                              
                              .
                           


                        
                           Proof
                           1. By the definition of 
                                 
                                    
                                       D
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                              , we have
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             q
                                             ,
                                             h
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   q
                                                   t
                                                   +
                                                   h
                                                   )
                                                
                                                
                                                   d
                                                
                                             
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   d
                                                
                                             
                                          
                                          
                                             (
                                             q
                                             t
                                             +
                                             h
                                             )
                                             −
                                             t
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             (
                                             q
                                             t
                                             +
                                             h
                                             )
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             d
                                             −
                                             1
                                             −
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             d
                                             ]
                                          
                                          
                                             q
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       +
                                       lower order terms
                                       .
                                    
                                 
                               2. This result easily follows from part 1.

3. This result easily follows from part 2. □

Motivated by the 
                           (
                           q
                           ,
                           h
                           )
                        -derivatives, we now introduce the following general notion of quantum derivatives (or G-derivatives) for a vector of linear functions 
                           G
                           (
                           t
                           )
                           =
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 d
                              
                           
                           (
                           t
                           )
                           )
                         by setting
                           
                              (2.13)
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             G
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       f
                                       )
                                       (
                                       t
                                       )
                                       =
                                       f
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                       ,
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             G
                                          
                                          
                                             m
                                          
                                       
                                       (
                                       f
                                       )
                                       (
                                       t
                                       )
                                       =
                                       f
                                       [
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             m
                                             +
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       ]
                                       ,
                                       
                                       m
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       d
                                       −
                                       1
                                       .
                                    
                                 
                              
                           
                         Typically, but not always, we shall set 
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           =
                           t
                        . We shall see in Sections 5–7 that generalized quantum splines can be defined in terms of this general notion of the quantum derivative.

In the study of quantum B-splines we need to determine when two polynomial segments have matching quantum derivatives. Therefore we close this section with criteria for two functions to have matching quantum derivatives.


                        
                           Proposition 2.4
                           
                              The following statements are equivalent:
                           


                              1. 
                              
                                 
                                    
                                       D
                                    
                                    
                                       G
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       G
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 (
                                 t
                                 )
                              
                              , 
                              
                                 m
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                                 −
                                 1
                              
                              .
                           


                              2. 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 [
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 t
                                 )
                                 ]
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 t
                                 )
                                 ]
                              
                              , 
                              
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              
                              .
                           


                              3. 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              , 
                              
                                 r
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 1
                              
                              , where 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                               
                              is the multiplicity of 
                              
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                               
                              in 
                              
                                 
                                    
                                       {
                                       
                                          
                                             g
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       t
                                       )
                                       }
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                              
                              .
                           


                              4. 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 [
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 ]
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 [
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 ]
                               
                              for every 
                              
                                 {
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 }
                                 ⊆
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 d
                                 }
                              
                              .
                           


                              5. 
                              
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             G
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 )
                               
                              for every subset 
                              
                                 
                                    
                                       G
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                               
                              of 
                              
                                 G
                                 (
                                 t
                                 )
                               
                              and 
                              
                                 0
                                 ≤
                                 m
                                 ≤
                                 k
                              
                              .
                           


                        
                           Proof
                           This result follows immediately from definition (2.13) and Proposition 2.1. □

The generalized quantum blossom lies at the very heart of our construction of generalized quantum B-splines. This blossom was introduced and studied in Goldman and Simeonov (in press). Here we recall the definition and main properties of this generalized quantum blossom.

Let
                        
                           (3.1)
                           
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          d
                                          ,
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    =
                                    1
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          d
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          1
                                          ≤
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          <
                                          ⋯
                                          <
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          ≤
                                          d
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ⋯
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    d
                                 
                              
                           
                        
                      denote the 
                        d
                        +
                        1
                      elementary symmetric functions in d variables.


                     
                        Definition 3.1
                        A vector 
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                            of d linear functions 
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                              
                              t
                              +
                              
                                 
                                    h
                                 
                                 
                                    j
                                 
                              
                           , 
                              j
                              =
                              1
                              ,
                              …
                              ,
                              d
                            is called an admissible vector if 
                              
                                 
                                    φ
                                 
                                 
                                    d
                                    ,
                                    k
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    q
                                 
                                 
                                    d
                                 
                              
                              )
                              ≠
                              0
                           , 
                              k
                              =
                              1
                              ,
                              …
                              ,
                              d
                           .

Notice that if 
                        
                           
                              q
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              q
                           
                           
                              d
                           
                        
                      all have the same sign then 
                        G
                        (
                        t
                        )
                      is admissible. Moreover, let 
                        g
                        (
                        t
                        )
                        =
                        q
                        t
                        +
                        h
                     , where 
                        q
                        ≠
                        0
                        ,
                        −
                        1
                     . Then 
                        G
                        (
                        t
                        )
                        =
                        (
                        t
                        ,
                        g
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              [
                              d
                              −
                              1
                              ]
                           
                        
                        (
                        t
                        )
                        )
                      is admissible, since by Simeonov et al. (2012), Lemma 3.2 
                        
                           
                              φ
                           
                           
                              d
                              ,
                              k
                           
                        
                        (
                        1
                        ,
                        q
                        ,
                        …
                        ,
                        
                           
                              q
                           
                           
                              d
                              −
                              1
                           
                        
                        )
                        =
                        
                           
                              q
                           
                           
                              k
                              (
                              k
                              −
                              1
                              )
                              /
                              2
                           
                        
                        
                           
                              [
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       k
                                    
                                 
                              
                              ]
                           
                           
                              q
                           
                        
                        ≠
                        0
                     , 
                        k
                        =
                        1
                        ,
                        …
                        ,
                        d
                     .


                     
                        Theorem 3.2
                        
                           Let 
                           
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                            
                           be an admissible vector and let 
                           
                              P
                              (
                              t
                              )
                            
                           be a polynomial of degree d. Then there exists a unique function 
                           
                              p
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              ;
                              G
                              )
                            
                           that has the following properties:
                           
                              
                                 •
                                 
                                    Symmetry: 
                                    
                                       p
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             σ
                                             (
                                             1
                                             )
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             σ
                                             (
                                             d
                                             )
                                          
                                       
                                       ;
                                       G
                                       )
                                       =
                                       p
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             d
                                          
                                       
                                       ;
                                       G
                                       )
                                     
                                    for every 
                                    
                                       σ
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                       
                                    
                                 


                                    Multiaffine:
                                    
                                       
                                          
                                             
                                                p
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                c
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                (
                                                1
                                                −
                                                c
                                                )
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ;
                                                G
                                                )
                                                =
                                                c
                                                p
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ;
                                                G
                                                )
                                                +
                                                (
                                                1
                                                −
                                                c
                                                )
                                                p
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ;
                                                G
                                                )
                                             
                                          
                                       
                                    
                                 


                                    G-diagonal evaluation: 
                                    
                                       p
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       )
                                       ;
                                       G
                                       )
                                       =
                                       P
                                       (
                                       t
                                       )
                                    
                                    .
                                 

The proof of Theorem 3.2 is given in Goldman and Simeonov (in press). The function 
                        p
                        (
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              u
                           
                           
                              d
                           
                        
                        ;
                        G
                        )
                      is called the generalized blossom or the G-blossom of the polynomial 
                        P
                        (
                        t
                        )
                     . When 
                        G
                        (
                        t
                        )
                        =
                        (
                        t
                        ,
                        g
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              [
                              d
                              −
                              1
                              ]
                           
                        
                        (
                        t
                        )
                        )
                      with 
                        g
                        (
                        t
                        )
                        =
                        q
                        t
                        +
                        h
                     , the G-blossom is called 
                        (
                        q
                        ,
                        h
                        )
                     
                     -blossom and is denoted by 
                        p
                        (
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              u
                           
                           
                              d
                           
                        
                        ;
                        q
                        ,
                        h
                        )
                      (Goldman and Simeonov, 2015).

In order to represent certain quantum derivatives in terms of quantum blossom values, we need the notion of a multilinear G-blossom or multilinear quantum blossom for homogeneous polynomials. The homogenization of a degree d polynomial 
                        P
                        (
                        t
                        )
                        =
                        
                           
                              ∑
                           
                           
                              k
                              =
                              0
                           
                           
                              d
                           
                        
                        
                           
                              a
                           
                           
                              k
                           
                        
                        
                           
                              t
                           
                           
                              k
                           
                        
                      is the bivariate polynomial 
                        P
                        (
                        t
                        ,
                        w
                        )
                        =
                        
                           
                              ∑
                           
                           
                              k
                              =
                              0
                           
                           
                              d
                           
                        
                        
                           
                              a
                           
                           
                              k
                           
                        
                        
                           
                              t
                           
                           
                              k
                           
                        
                        
                           
                              w
                           
                           
                              d
                              −
                              k
                           
                        
                     . Clearly, 
                        P
                        (
                        t
                        ,
                        1
                        )
                        =
                        P
                        (
                        t
                        )
                      and 
                        P
                        (
                        c
                        t
                        ,
                        c
                        w
                        )
                        =
                        
                           
                              c
                           
                           
                              d
                           
                        
                        P
                        (
                        t
                        ,
                        w
                        )
                     .


                     
                        Theorem 3.3
                        
                           Given a homogeneous polynomial 
                           
                              P
                              (
                              t
                              ,
                              w
                              )
                            
                           and an admissible vector 
                           
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                           
                           , there exists a unique multilinear G-blossom of 
                           
                              P
                              (
                              t
                              ,
                              w
                              )
                           
                           . That is, there exists a unique function 
                           
                              p
                              (
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              …
                              ,
                              (
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    d
                                 
                              
                              )
                              ;
                              G
                              )
                            
                           satisfying the following three axioms:
                           
                              
                                 •
                                 
                                    Symmetry: 
                                    
                                       p
                                       (
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             σ
                                             (
                                             1
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             σ
                                             (
                                             1
                                             )
                                          
                                       
                                       )
                                       ,
                                       …
                                       ,
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             σ
                                             (
                                             d
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             σ
                                             (
                                             d
                                             )
                                          
                                       
                                       )
                                       ;
                                       G
                                       )
                                       =
                                       p
                                       (
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ,
                                       …
                                       ,
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       ;
                                       G
                                       )
                                     
                                    for every 
                                    
                                       σ
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                       
                                    
                                 


                                    Multilinear:
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                      (
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                      ;
                                                      G
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                      =
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      p
                                                      (
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                      ;
                                                      G
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                      +
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      p
                                                      (
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      (
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      ,
                                                      …
                                                      ,
                                                      (
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      )
                                                      ;
                                                      G
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 


                                    G-diagonal evaluation: 
                                    
                                       p
                                       (
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       ,
                                       w
                                       )
                                       ,
                                       w
                                       )
                                       ,
                                       …
                                       ,
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ,
                                       w
                                       )
                                       ,
                                       w
                                       )
                                       ;
                                       G
                                       )
                                       =
                                       P
                                       (
                                       t
                                       ,
                                       w
                                       )
                                    
                                    .
                                 

The proof of Theorem 3.3 is given in Goldman and Simeonov (in press).

We shall treat the multilinear G-blossom of a degree d homogeneous polynomial 
                        P
                        (
                        t
                        ,
                        w
                        )
                      as the multilinear G-blossom of the polynomial 
                        P
                        (
                        t
                        )
                        =
                        P
                        (
                        t
                        ,
                        1
                        )
                     . We shall also denote the multilinear G-blossom of 
                        P
                        (
                        t
                        ,
                        w
                        )
                      or 
                        P
                        (
                        t
                        )
                      by 
                        p
                        (
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              d
                           
                        
                        ;
                        G
                        )
                      where 
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              i
                           
                        
                        =
                        (
                        
                           
                              u
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              w
                           
                           
                              i
                           
                        
                        )
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        d
                     , and we shall identify a blossom value u with the blossom pair 
                        (
                        u
                        ,
                        1
                        )
                     .

The classical multilinear blossom can be used to differentiate polynomials (Goldman, 2003). Moreover, the q-multilinear and the h-multilinear blossoms can be used to q-differentiate and to h-differentiate polynomials (Simeonov et al., 2012, 2011). This blossoming approach has also been extended to find certain 
                        (
                        q
                        ,
                        h
                        )
                     -derivatives of polynomials (Goldman and Simeonov, in press).


                     
                        Definition 3.4
                        Given a vector 
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                           , we set 
                              
                                 
                                    G
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                              )
                            for 
                              m
                              =
                              1
                              ,
                              …
                              ,
                              d
                           .


                     
                        Proposition 3.5
                        
                           Let 
                           
                              g
                              (
                              t
                              )
                              =
                              q
                              t
                              +
                              h
                            
                           with 
                           
                              q
                              ≠
                              0
                            
                           and 
                           
                              (
                              q
                              ,
                              h
                              )
                              ≠
                              (
                              1
                              ,
                              0
                              )
                           
                           , and let 
                           
                              P
                              (
                              t
                              )
                            
                           be a degree d polynomial with multilinear 
                           
                              (
                              q
                              ,
                              h
                              )
                           
                           -blossom 
                           
                              p
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    d
                                 
                              
                              ;
                              q
                              ,
                              h
                              )
                           
                           . Then
                           
                              
                                 (3.2)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          1
                                          /
                                          q
                                          ,
                                          −
                                          h
                                          /
                                          q
                                       
                                       
                                          m
                                       
                                    
                                    P
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                [
                                                d
                                                ]
                                             
                                             
                                                q
                                             
                                          
                                          !
                                       
                                       
                                          
                                             
                                                [
                                                d
                                                −
                                                m
                                                ]
                                             
                                             
                                                q
                                             
                                          
                                          !
                                       
                                    
                                    p
                                    (
                                    t
                                    ,
                                    g
                                    (
                                    t
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          d
                                          −
                                          m
                                          −
                                          1
                                          ]
                                       
                                    
                                    (
                                    t
                                    )
                                    ,
                                    
                                       
                                          
                                             δ
                                             ,
                                             …
                                             ,
                                             δ
                                          
                                          ︸
                                       
                                       m
                                    
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    ,
                                 
                              
                            
                           
                              m
                              =
                              0
                              ,
                              …
                              ,
                              d
                           
                           , where 
                           
                              δ
                              =
                              (
                              1
                              ,
                              0
                              )
                           
                           . Moreover
                           
                              
                                 (3.3)
                                 
                                    
                                       
                                          
                                             
                                                [
                                                d
                                                ]
                                             
                                             
                                                q
                                             
                                          
                                          !
                                       
                                       
                                          
                                             
                                                [
                                                d
                                                −
                                                m
                                                ]
                                             
                                             
                                                q
                                             
                                          
                                          !
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          d
                                          −
                                          m
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             δ
                                             ,
                                             …
                                             ,
                                             δ
                                          
                                          ︸
                                       
                                       m
                                    
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                 
                              
                            
                           is the multilinear 
                           
                              (
                              q
                              ,
                              h
                              )
                           
                           -blossom of 
                           
                              
                                 
                                    D
                                 
                                 
                                    1
                                    /
                                    q
                                    ,
                                    −
                                    h
                                    /
                                    q
                                 
                                 
                                    m
                                 
                              
                              P
                              (
                              t
                              )
                           
                           , 
                           
                              m
                              =
                              0
                              ,
                              …
                              ,
                              d
                              −
                              1
                           
                           .
                        

The proof of Proposition 3.5 is given in Goldman and Simeonov (2015).

Equations (3.2) and (2.10) yield the following result.


                     
                        Corollary 3.6
                        
                           Let 
                           
                              g
                              (
                              t
                              )
                              =
                              q
                              t
                              +
                              h
                            
                           with 
                           
                              q
                              ≠
                              0
                            
                           and 
                           
                              (
                              q
                              ,
                              h
                              )
                              ≠
                              (
                              1
                              ,
                              0
                              )
                           
                           . Then the following expressions are equivalent:
                        


                           1. 
                           
                              
                                 
                                    D
                                 
                                 
                                    1
                                    /
                                    q
                                    ,
                                    −
                                    h
                                    /
                                    q
                                 
                                 
                                    m
                                 
                              
                              P
                              (
                              t
                              )
                           
                        


                           2. 
                           
                              
                                 
                                    
                                       
                                          [
                                          d
                                          ]
                                       
                                       
                                          q
                                       
                                    
                                    !
                                 
                                 
                                    
                                       
                                          [
                                          d
                                          −
                                          m
                                          ]
                                       
                                       
                                          q
                                       
                                    
                                    !
                                 
                              
                              p
                              (
                              t
                              ,
                              g
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    [
                                    d
                                    −
                                    m
                                    −
                                    1
                                    ]
                                 
                              
                              (
                              t
                              )
                              ,
                              
                                 
                                    
                                       δ
                                       ,
                                       …
                                       ,
                                       δ
                                    
                                    ︸
                                 
                                 m
                              
                              ;
                              q
                              ,
                              h
                              )
                           
                        


                           3. 
                           
                              
                                 
                                    [
                                    m
                                    ]
                                 
                                 
                                    1
                                    /
                                    q
                                 
                              
                              !
                              P
                              [
                              t
                              ,
                              
                                 
                                    g
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    [
                                    −
                                    m
                                    ]
                                 
                              
                              (
                              t
                              )
                              ]
                           
                           .
                        


                     
                        Proposition 3.7
                        
                           Let 
                           
                              g
                              (
                              t
                              )
                              =
                              q
                              t
                              +
                              h
                            
                           with 
                           
                              q
                              ≠
                              0
                            
                           and 
                           
                              (
                              q
                              ,
                              h
                              )
                              ≠
                              (
                              1
                              ,
                              0
                              )
                           
                           , and set
                           
                              
                                 (3.4)
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    t
                                    ,
                                    x
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    =
                                    1
                                    ,
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    t
                                    ,
                                    x
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    =
                                    
                                       ∏
                                       
                                          ν
                                          =
                                          0
                                       
                                       
                                          d
                                          −
                                          1
                                       
                                    
                                    (
                                    x
                                    −
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          ν
                                          ]
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    ,
                                    
                                    d
                                    ≥
                                    1
                                    .
                                 
                              
                            
                           Then
                           
                              
                                 (3.5)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          1
                                          /
                                          q
                                          ,
                                          −
                                          h
                                          /
                                          q
                                          ,
                                          t
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    t
                                    ,
                                    x
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    =
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          
                                             
                                                [
                                                d
                                                ]
                                             
                                             
                                                q
                                             
                                          
                                          !
                                       
                                       
                                          
                                             
                                                [
                                                d
                                                −
                                                m
                                                ]
                                             
                                             
                                                q
                                             
                                          
                                          !
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          d
                                          −
                                          m
                                       
                                    
                                    (
                                    t
                                    ,
                                    x
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    ,
                                    
                                    m
                                    ≤
                                    d
                                    ,
                                 
                              
                            
                           and zero otherwise. Furthermore
                           
                              
                                 (3.6)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          1
                                          /
                                          q
                                          ,
                                          −
                                          h
                                          /
                                          q
                                          ,
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    t
                                    ,
                                    x
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                [
                                                d
                                                ]
                                             
                                             
                                                1
                                                /
                                                q
                                             
                                          
                                          !
                                       
                                       
                                          
                                             
                                                [
                                                d
                                                −
                                                m
                                                ]
                                             
                                             
                                                1
                                                /
                                                q
                                             
                                          
                                          !
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          d
                                          −
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          m
                                          ]
                                       
                                    
                                    (
                                    t
                                    )
                                    ,
                                    x
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    ,
                                    
                                    m
                                    ≤
                                    d
                                    ,
                                 
                              
                            
                           and zero otherwise.
                        


                     
                        Proof
                        The multilinear 
                              (
                              q
                              ,
                              h
                              )
                           -blossom of 
                              
                                 
                                    ψ
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              ,
                              x
                              ;
                              q
                              ,
                              h
                              )
                            is 
                              
                                 
                                    ∏
                                 
                                 
                                    ν
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    ν
                                 
                              
                              x
                              −
                              
                                 
                                    u
                                 
                                 
                                    ν
                                 
                              
                              )
                           . Therefore (3.5) follows from (3.2). Equation (3.6) is the special case 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              =
                              0
                           , 
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              =
                              d
                              −
                              1
                            of the more general formula
                              
                                 (3.7)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          1
                                          /
                                          q
                                          ,
                                          −
                                          h
                                          /
                                          q
                                          ,
                                          x
                                       
                                       
                                          m
                                       
                                    
                                    
                                       ∏
                                       
                                          ν
                                          =
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                    
                                    (
                                    x
                                    −
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          ν
                                          ]
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                1
                                                ]
                                             
                                             
                                                1
                                                /
                                                q
                                             
                                          
                                          !
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                1
                                                −
                                                m
                                                ]
                                             
                                             
                                                1
                                                /
                                                q
                                             
                                          
                                          !
                                       
                                    
                                    
                                       ∏
                                       
                                          ν
                                          =
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          m
                                       
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                    
                                    (
                                    x
                                    −
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          ν
                                          ]
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    ,
                                 
                              
                            for 
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              ≤
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                            and 
                              0
                              ≤
                              m
                              ≤
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                           . Formula (3.7) is easily verified by induction on m. □

The local de Boor algorithm evaluates points on a degree d polynomial curve 
                           P
                           (
                           t
                           )
                         recursively starting from 
                           d
                           +
                           1
                         control points which can be represented in terms of the blossom of 
                           P
                           (
                           t
                           )
                         (Goldman, 2003). In this section we will construct a G-version of the classical local de Boor algorithm. Throughout the rest of this paper 
                           G
                           (
                           t
                           )
                         will denote an admissible vector of d linear functions 
                           
                              
                                 g
                              
                              
                                 j
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 q
                              
                              
                                 j
                              
                           
                           t
                           +
                           
                              
                                 h
                              
                              
                                 j
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           …
                           ,
                           d
                        .


                        
                           Definition 4.1
                           A sequence 
                                 
                                    
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       2
                                       d
                                    
                                 
                               is called a progressive knot sequence if 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ≠
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                               whenever 
                                 i
                                 ≤
                                 d
                                 <
                                 j
                                 ≤
                                 i
                                 +
                                 d
                              .

A sequence 
                                 
                                    
                                       {
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       2
                                       d
                                    
                                 
                               is called a progressive homogeneous knot sequence if 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       j
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 ≠
                                 0
                               whenever 
                                 i
                                 ≤
                                 d
                                 <
                                 j
                                 ≤
                                 i
                                 +
                                 d
                              .


                        Recursive evaluation for the G-blossom. Let 
                           
                              
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 2
                                 d
                              
                           
                         be a progressive knot sequence. Set 
                           
                              
                                 Q
                              
                              
                                 k
                              
                              
                                 0
                              
                           
                           =
                           p
                           (
                           
                              
                                 t
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 k
                                 +
                                 d
                              
                           
                           ;
                           G
                           )
                        , 
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                        , and define recursively
                           
                              (4.1)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                    
                                       s
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                    
                                       s
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                                 −
                                 s
                                 ,
                                 
                                 s
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                                 .
                              
                           
                         It follows by induction on s and the symmetry and multiaffine properties of the G-blossom that
                           
                              (4.2)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 p
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       s
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       s
                                    
                                 
                                 ;
                                 G
                                 )
                                 ,
                              
                           
                         
                        
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                           −
                           s
                        , 
                           s
                           =
                           0
                           ,
                           …
                           ,
                           d
                        . In particular, 
                           
                              
                                 Q
                              
                              
                                 0
                              
                              
                                 d
                              
                           
                           =
                           p
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 u
                              
                              
                                 d
                              
                           
                           ;
                           G
                           )
                        . Since the knot sequence is progressive the denominators in equation (4.1) do not vanish, so this algorithm is well-defined.


                        Recursive evaluation for the multilinear G-blossom. Let 
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 2
                                 d
                              
                           
                         be a progressive homogeneous knot sequence. Set 
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                              
                              
                                 0
                              
                           
                           =
                           p
                           (
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                                 +
                                 d
                              
                           
                           ;
                           G
                           )
                        , 
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                        , and define recursively
                           
                              (4.3)
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                    
                                    
                                       s
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                    
                                       s
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                         
                        
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                           −
                           s
                        , 
                           s
                           =
                           1
                           ,
                           …
                           ,
                           d
                        . Using the identity
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       d
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 s
                              
                           
                           =
                           (
                           
                              
                                 u
                              
                              
                                 s
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 s
                              
                           
                           )
                        , 
                           s
                           =
                           1
                           ,
                           …
                           ,
                           d
                        , the symmetry and the multilinear properties of the multilinear G-blossom and induction on s, we derive
                           
                              (4.4)
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 p
                                 (
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       s
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                       +
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       s
                                    
                                 
                                 ;
                                 G
                                 )
                                 ,
                              
                           
                         
                        
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                           −
                           s
                        , 
                           s
                           =
                           0
                           ,
                           …
                           ,
                           d
                        . In particular, 
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 0
                              
                              
                                 d
                              
                           
                           =
                           p
                           (
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 d
                              
                           
                           ;
                           G
                           )
                        . Clearly, when 
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                           =
                           1
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           2
                           d
                        , (4.3) and (4.4) reduce to (4.1) and (4.2). The recursive evaluation algorithm for the multilinear G-blossom in the cubic case is illustrated schematically in Fig. 1
                        . In Figs. 1 and 2
                        , the value at each node is computed by multiplying the values at the nodes one level below directly to the left and to the right by the quantity along the arrow exiting that node, and then adding the two products.

Notice that these two evaluation algorithms for the G-blossom are identical to the evaluation algorithms for the classical blossom, since these algorithms depend only on the symmetry and multiaffine or multilinear properties of the G-blossom. Only when we perform polynomial evaluation with the G-blossom and make use of the diagonal property do we get new algorithms.


                        Recursive polynomial evaluation. By the symmetry and diagonal properties of the G-blossom it follows that for any permutation 
                           σ
                           ∈
                           
                              
                                 S
                              
                              
                                 d
                              
                           
                         we can set 
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 g
                              
                              
                                 σ
                                 (
                                 i
                                 )
                              
                           
                           (
                           t
                           )
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           d
                         in (4.1) and evaluate 
                           P
                           (
                           t
                           )
                         recursively. In particular,
                           
                              (4.5)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 p
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       σ
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       σ
                                       (
                                       d
                                       )
                                    
                                 
                                 (
                                 t
                                 )
                                 ;
                                 G
                                 )
                                 =
                                 P
                                 (
                                 t
                                 )
                                 .
                              
                           
                         In this way for a degree d polynomial we can generate d! recursive evaluation algorithms starting from the G-blossom values at any progressive knot sequence.

The m-th order quantum derivative 
                           
                              
                                 D
                              
                              
                                 1
                                 /
                                 q
                                 ,
                                 −
                                 h
                                 /
                                 q
                              
                              
                                 m
                              
                           
                         of a degree d polynomial 
                           P
                           (
                           t
                           )
                         can be evaluated using equation (3.2) and the recursive evaluation algorithm for the multilinear G-blossom. There are 
                           
                              (
                              
                                 
                                    
                                       d
                                    
                                 
                                 
                                    
                                       m
                                    
                                 
                              
                              )
                           
                           (
                           d
                           −
                           m
                           )
                           !
                           =
                           d
                           !
                           /
                           m
                           !
                         such distinct recursive evaluation algorithms for 
                           
                              
                                 D
                              
                              
                                 1
                                 /
                                 q
                                 ,
                                 −
                                 h
                                 /
                                 q
                              
                              
                                 m
                              
                           
                           P
                           (
                           t
                           )
                        .


                        The G-de Boor algorithm. The G-de Boor algorithm is the recursive polynomial evaluation algorithm generated by using the permutation 
                           σ
                           (
                           i
                           )
                           =
                           d
                           +
                           1
                           −
                           i
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           d
                        . Therefore in the G-de Boor algorithm 
                           
                              
                                 P
                              
                              
                                 k
                              
                              
                                 0
                              
                           
                           =
                           p
                           (
                           
                              
                                 t
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 k
                                 +
                                 d
                              
                           
                           ;
                           G
                           )
                        , 
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                        , and
                           
                              (4.6)
                              
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             d
                                             −
                                             s
                                             +
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                    
                                       s
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             d
                                             −
                                             s
                                             +
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             s
                                          
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                    
                                       s
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                         
                        
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                           −
                           s
                        , 
                           s
                           =
                           1
                           ,
                           …
                           ,
                           d
                        . In this case by (4.2)
                        
                           
                              (4.7)
                              
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 p
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       s
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       d
                                    
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                       −
                                       s
                                       +
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 )
                                 ;
                                 G
                                 )
                                 ,
                              
                           
                         
                        
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                           −
                           s
                        , 
                           s
                           =
                           1
                           ,
                           …
                           ,
                           d
                        . In particular, 
                           
                              
                                 P
                              
                              
                                 0
                              
                              
                                 d
                              
                           
                           =
                           p
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 d
                              
                           
                           (
                           t
                           )
                           ;
                           G
                           )
                           =
                           P
                           (
                           t
                           )
                        . We shall see in Section 5 that this particular evaluation algorithm is especially important for developing the theory of generalized quantum B-splines. The G-de Boor algorithm for cubic polynomials is illustrated schematically in Fig. 2.


                        
                           Example
                           Consider the polynomial
                                 
                                    (4.8)
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ,
                                       x
                                       ;
                                       G
                                       )
                                       =
                                       (
                                       x
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                       ⋯
                                       (
                                       x
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                       .
                                    
                                 
                               The multiaffine and the multilinear G-blossoms of 
                                 
                                    
                                       ψ
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ,
                                 x
                                 ;
                                 G
                                 )
                               are given by 
                                 (
                                 x
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⋯
                                 (
                                 x
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       d
                                    
                                 
                                 )
                               and 
                                 (
                                 x
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ⋯
                                 (
                                 x
                                 
                                    
                                       w
                                    
                                    
                                       d
                                    
                                 
                                 −
                                 
                                    
                                       u
                                    
                                    
                                       d
                                    
                                 
                                 )
                              . Using the preceding algorithms, we can evaluate 
                                 
                                    
                                       ψ
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ,
                                 x
                                 ;
                                 G
                                 )
                              , the multiaffine G-blossom of 
                                 
                                    
                                       ψ
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ,
                                 x
                                 ;
                                 G
                                 )
                              , and the multilinear G-blossom of 
                                 
                                    
                                       ψ
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ,
                                 x
                                 ;
                                 G
                                 )
                               recursively from the initial values 
                                 
                                    
                                       {
                                       (
                                       x
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       )
                                       ⋯
                                       (
                                       x
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                          
                                       
                                       )
                                       }
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       d
                                    
                                 
                               and 
                                 
                                    
                                       {
                                       (
                                       x
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       )
                                       ⋯
                                       (
                                       x
                                       
                                          
                                             r
                                          
                                          
                                             k
                                             +
                                             d
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                          
                                       
                                       )
                                       }
                                    
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       d
                                    
                                 
                              .

Let 
                           
                              
                                 B
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           G
                           )
                         be the function generated by any G-recursive evaluation algorithm from the initial values 
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 δ
                              
                              
                                 j
                                 ,
                                 k
                              
                           
                        , where 
                           G
                           (
                           t
                           )
                           =
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 d
                              
                           
                           (
                           t
                           )
                           )
                         is an admissible vector and 
                           T
                           =
                           {
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 2
                                 d
                              
                           
                           }
                         is a progressive knot sequence. Then for any degree d polynomial 
                           P
                           (
                           t
                           )
                        , by the G-recursive evaluation algorithm and linearity we have
                           
                              (4.9)
                              
                                 P
                                 (
                                 t
                                 )
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    d
                                 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                                 p
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                                 .
                              
                           
                         In particular, the functions 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 d
                              
                           
                         form a basis for the space of polynomials of degree d because every polynomial has a G-blossom. This basis is called the progressive G-basis for the progressive knot sequence T. We shall see in Section 10 that the progressive basis functions 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 d
                              
                           
                         represent the generalized quantum B-splines over a single polynomial segment.

When 
                           G
                           (
                           t
                           )
                           =
                           (
                           t
                           ,
                           g
                           (
                           t
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 [
                                 d
                                 −
                                 1
                                 ]
                              
                           
                           (
                           t
                           )
                           )
                         with 
                           g
                           (
                           t
                           )
                           =
                           q
                           t
                           +
                           h
                        , we denote these progressive basis functions by 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 q
                                 ,
                                 h
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 d
                              
                           
                        .

Since the control points of a polynomial relative to a fixed basis are unique, equation (4.9) implies the following dual functional property:


                        Dual functional property. Let 
                           
                              
                                 P
                              
                              
                                 0
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 P
                              
                              
                                 d
                              
                           
                         be the control points of a degree d polynomial 
                           P
                           (
                           t
                           )
                         relative to a progressive basis 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 d
                              
                           
                        , that is, let 
                           P
                           (
                           t
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 d
                              
                           
                           
                              
                                 B
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           G
                           )
                           
                              
                                 P
                              
                              
                                 k
                              
                           
                        . Then
                           
                              (4.10)
                              
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 p
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                                 ,
                                 
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                                 .
                              
                           
                        
                     

Using the de local Boor algorithm, we can generate a recurrence for the progressive basis functions. Let 
                           G
                           (
                           t
                           )
                           =
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 d
                              
                           
                           (
                           t
                           )
                           )
                         be an admissible vector and let 
                           T
                           =
                           {
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 2
                                 d
                              
                           
                           }
                         be a progressive knot sequence. By the definition of a progressive G-basis and the G-de Boor algorithm, for any degree d polynomial 
                           P
                           (
                           t
                           )
                         we have
                           
                              (4.11)
                              
                                 P
                                 (
                                 t
                                 )
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    d
                                 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       2
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 ;
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       2
                                       d
                                       −
                                       1
                                    
                                 
                                 ;
                                 
                                    
                                       G
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                                 .
                              
                           
                         Now from (4.11) and (4.6) with 
                           s
                           =
                           1
                         and 
                           
                              
                                 P
                              
                              
                                 k
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 δ
                              
                              
                                 k
                                 ,
                                 i
                              
                           
                        , 
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                        , it follows that
                           
                              (4.12)
                              
                                 
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                d
                                             
                                          
                                          (
                                          t
                                          ;
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                2
                                                d
                                             
                                          
                                          ;
                                          G
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                t
                                                )
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      d
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          (
                                          t
                                          ;
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                2
                                                d
                                                −
                                                1
                                             
                                          
                                          ;
                                          
                                             
                                                G
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                       
                                          +
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          (
                                          t
                                          ;
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                2
                                                d
                                                −
                                                1
                                             
                                          
                                          ;
                                          
                                             
                                                G
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                         
                        
                           i
                           =
                           0
                           ,
                           …
                           ,
                           d
                        , where 
                           
                              
                                 B
                              
                              
                                 −
                                 1
                              
                              
                                 d
                                 −
                                 1
                              
                           
                           :
                           =
                           0
                         and 
                           
                              
                                 B
                              
                              
                                 d
                              
                              
                                 d
                                 −
                                 1
                              
                           
                           :
                           =
                           0
                        .

We can also generate a two-term recurrence for the multilinear G-blossom of the progressive basis functions. Let 
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 2
                                 d
                              
                           
                         be a progressive homogeneous knot sequence and let 
                           
                              
                                 b
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 d
                              
                           
                           ;
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                                 d
                              
                           
                           ;
                           G
                           )
                         denote the G-blossom of 
                           
                              
                                 B
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 2
                                 d
                              
                           
                           ;
                           G
                           )
                        , 
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                        . For the homogeneous G-blossom 
                           p
                           (
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 d
                              
                           
                           ;
                           G
                           )
                         of a degree d polynomial 
                           P
                           (
                           t
                           )
                         by linearity we have
                           
                              (4.13)
                              
                                 
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          ;
                                          G
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             d
                                          
                                          
                                             
                                                b
                                             
                                             
                                                k
                                             
                                             
                                                d
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          ;
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                                d
                                             
                                          
                                          ;
                                          G
                                          )
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                k
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                k
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          ;
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                                d
                                                −
                                                1
                                             
                                          
                                          ;
                                          
                                             
                                                G
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                         It follows from equations (4.13) and (4.3) with 
                           s
                           =
                           1
                         and 
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 δ
                              
                              
                                 k
                                 ,
                                 i
                              
                           
                        , 
                           k
                           =
                           0
                           ,
                           …
                           ,
                           d
                        , that 
                           
                              
                                 b
                              
                              
                                 i
                              
                              
                                 d
                              
                           
                           (
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 d
                              
                           
                           ;
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                                 d
                              
                           
                           ;
                           G
                           )
                         satisfies the recurrence relation
                           
                              (4.14)
                              
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                             
                                                i
                                             
                                             
                                                d
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          ;
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                                d
                                             
                                          
                                          ;
                                          G
                                          )
                                       
                                    
                                    
                                       
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      d
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                      +
                                                      d
                                                   
                                                
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          ;
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                                d
                                                −
                                                1
                                             
                                          
                                          ;
                                          
                                             
                                                G
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                      +
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                      +
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                i
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                d
                                             
                                          
                                          ;
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                2
                                                d
                                                −
                                                1
                                             
                                          
                                          ;
                                          
                                             
                                                G
                                             
                                             
                                                d
                                                −
                                                1
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                         
                        
                           i
                           =
                           0
                           ,
                           …
                           ,
                           d
                        , where 
                           
                              
                                 b
                              
                              
                                 −
                                 1
                              
                              
                                 d
                                 −
                                 1
                              
                           
                           :
                           =
                           0
                         and 
                           
                              
                                 b
                              
                              
                                 d
                              
                              
                                 d
                                 −
                                 1
                              
                           
                           :
                           =
                           0
                        .

One canonical set of progressive basis functions 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 d
                              
                           
                         are the G-Bernstein basis functions. For any admissible vector 
                           G
                           (
                           t
                           )
                           =
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 d
                              
                           
                           (
                           t
                           )
                           )
                         and any interval 
                           [
                           a
                           ,
                           b
                           ]
                         such that 
                           
                              
                                 g
                              
                              
                                 j
                              
                           
                           (
                           b
                           )
                           ≠
                           
                              
                                 g
                              
                              
                                 i
                              
                           
                           (
                           a
                           )
                        , 
                           1
                           ≤
                           j
                           <
                           i
                           ≤
                           d
                        , the G-Bernstein basis functions are the progressive basis functions 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 d
                              
                           
                         for the knots 
                           T
                           =
                           {
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           a
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 d
                              
                           
                           (
                           a
                           )
                           ,
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           b
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 d
                              
                           
                           (
                           b
                           )
                           }
                        . We denote these basis functions by 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 [
                                 a
                                 ,
                                 b
                                 ]
                                 ;
                                 G
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 d
                              
                           
                        , and we call the curves using 
                           
                              
                                 {
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 [
                                 a
                                 ,
                                 b
                                 ]
                                 ;
                                 G
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 0
                              
                              
                                 d
                              
                           
                         as blending functions G-Bézier curves over the interval 
                        
                           [
                           a
                           ,
                           b
                           ]
                        .

Explicit formulas for the G-Bernstein basis functions for an arbitrary admissible vector 
                           G
                           (
                           t
                           )
                         are not known. But for a special class of admissible vectors 
                           G
                           (
                           t
                           )
                        , one can write an explicit formula for the G-Bernstein basis functions (Nowak, 2009; Goldman and Simeonov, 2015).


                        
                           Proposition 4.2
                           
                              (See 
                              
                                 Goldman and Simeonov, 2015
                              
                              , Proposition 4.12.) Let 
                              
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 t
                                 ,
                                 g
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       d
                                       −
                                       1
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              , where 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              with 
                              
                                 q
                                 ≠
                                 0
                              
                              . Let 
                              
                                 [
                                 a
                                 ,
                                 b
                                 ]
                               
                              be an interval such that 
                              
                                 b
                                 ≠
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       j
                                       ]
                                    
                                 
                                 (
                                 a
                                 )
                              
                              , 
                              
                                 j
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                                 −
                                 1
                              
                              . Define the knot sequence 
                              
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       j
                                       −
                                       1
                                       ]
                                    
                                 
                                 (
                                 a
                                 )
                              
                              , 
                              
                                 
                                    
                                       t
                                    
                                    
                                       d
                                       +
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       j
                                       −
                                       1
                                       ]
                                    
                                 
                                 (
                                 b
                                 )
                              
                              , 
                              
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              
                              , and the progressive basis functions 
                              
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 [
                                 a
                                 ,
                                 b
                                 ]
                                 ;
                                 q
                                 ,
                                 h
                                 )
                                 :
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       2
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                              
                              , 
                              
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                              
                              . Then
                              
                                 
                                    (4.15)
                                    
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       [
                                       a
                                       ,
                                       b
                                       ]
                                       ;
                                       q
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      k
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             q
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                t
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      j
                                                      ]
                                                   
                                                
                                                (
                                                a
                                                )
                                                )
                                             
                                             
                                             
                                                
                                                   ∏
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   d
                                                   −
                                                   k
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                b
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      j
                                                      ]
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   d
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                b
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      j
                                                      ]
                                                   
                                                
                                                (
                                                a
                                                )
                                                )
                                             
                                          
                                       
                                       ,
                                    
                                 
                               
                              
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                              
                              .
                           

The functions in equation (4.15) are called the 
                           (
                           q
                           ,
                           h
                           )
                        
                        -Bernstein basis functions on the interval 
                        
                           [
                           a
                           ,
                           b
                           ]
                        . Notice that these 
                           (
                           q
                           ,
                           h
                           )
                        -Bernstein basis functions reduce to the classical Bernstein basis functions when 
                           g
                           (
                           t
                           )
                           =
                           t
                        . Moreover in the case 
                           g
                           (
                           t
                           )
                           =
                           q
                           t
                        , the 
                           (
                           q
                           ,
                           h
                           )
                        -Bernstein basis functions reduce to the q-Bernstein basis functions (Lewanowicz and Woźny, 2004), (Simeonov et al., 2012, Theorem 6.3), and in the case 
                           g
                           (
                           t
                           )
                           =
                           t
                           −
                           h
                        , the 
                           (
                           q
                           ,
                           h
                           )
                        -Bernstein basis functions reduce to the h-Bernstein basis functions (Stancu, 1984), (Simeonov et al., 2011, Theorem 4.3).

For the classical Bernstein bases, there is a two-term formula for the derivative of a Bernstein basis function in terms of Bernstein basis functions of lower degree. Next we shall show that there is an analogous two-term formula for the 
                           (
                           1
                           /
                           q
                           ,
                           −
                           h
                           /
                           q
                           )
                        -derivatives of the progressive 
                           (
                           q
                           ,
                           h
                           )
                        -Bernstein basis functions.


                        
                           Proposition 4.3
                           
                              Let 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              with 
                              
                                 q
                                 ≠
                                 0
                               
                              and 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              . Then
                              
                                 
                                    (4.16)
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                      
                                                         [
                                                         d
                                                         ]
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                      /
                                                      q
                                                      ,
                                                      −
                                                      h
                                                      /
                                                      q
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                t
                                                ;
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      2
                                                      d
                                                   
                                                
                                                ;
                                                q
                                                ,
                                                h
                                                )
                                             
                                          
                                          
                                             
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            i
                                                            −
                                                            1
                                                         
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                      (
                                                      t
                                                      ;
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                      ;
                                                      q
                                                      ,
                                                      h
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                            +
                                                            d
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                      (
                                                      t
                                                      ;
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                      ;
                                                      q
                                                      ,
                                                      h
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                            +
                                                            d
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Proof
                           Setting 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 δ
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 )
                              , 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ν
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       ν
                                       −
                                       2
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 1
                                 )
                              , 
                                 ν
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 d
                              , and 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 2
                                 d
                               in (4.14) and applying (3.2) yields (4.16). □

For many additional interesting properties of 
                           (
                           q
                           ,
                           h
                           )
                        -Bernstein basis functions and 
                           (
                           q
                           ,
                           h
                           )
                        -Bézier curves, see Goldman and Simeonov (2015).

In Section 4 we examined one segment of a polynomial curve. Here we are going to investigate piecewise polynomials whose quantum derivatives agree at the knots. We begin by extending the notion of progressive knot sequences of length 2d for polynomials of degree d to knot sequences of arbitrary length for piecewise polynomials of degree d.


                     
                        Definition 5.1
                        A knot sequence 
                              T
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              }
                            is called a progressive knot sequence of order d if whenever 
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ≠
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                            the sequence 
                              
                                 
                                    t
                                 
                                 
                                    i
                                    −
                                    d
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    d
                                 
                              
                            is progressive and no knot has local multiplicity greater than d-that is, if 
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              =
                              ⋯
                              =
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    d
                                    −
                                    1
                                 
                              
                           , then 
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    d
                                 
                              
                              ≠
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    d
                                    −
                                    1
                                 
                              
                           .

Progressive knot sequences of order d will be used to construct quantum B-spline curves of degree d. When the degree d is fixed, we shall simply say progressive knot sequence instead of saying progressive sequence of order d.

Notice that in a progressive knot sequence the knots need not be non-decreasing; as the indices get larger, the knots can increase, decrease, or repeat. Moreover, in a progressive knot sequence knot intervals can even repeat or overlap, as long as the repeating or overlapping knot intervals are far enough apart. All we require is that the local de Boor algorithm is well defined for all non-empty knot intervals and that the local multiplicity of any knot is at most d.

Progressive knot sequences, though unorthodox, are not without precedent in the theory of splines. Peters (2013) investigated classical splines with progressive knot sequences; Peters calls these progressive knot sequences unsorted or collocated knot sequences. In addition, splines with complex knots where the notion of non-decreasing is not meaningful have been investigated by Tsianos and Goldman (2011).


                     
                        Definition 5.2
                        Let 
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                            be an admissible vector and let 
                              T
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              }
                            be a progressive knot sequence. A G-B-spline curve of degree d is a piecewise polynomial curve 
                              B
                              (
                              t
                              )
                            whose polynomial segments are generated by the local G-de Boor algorithm for the knot sequence 
                              T
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              }
                            and a sequence of control points 
                              {
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                              }
                           . The polynomial segments of 
                              B
                              (
                              t
                              )
                            are the segments of the polynomial curves 
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            over the corresponding intervals 
                              [
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ]
                           , where each 
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            is generated by the local G-de Boor algorithm for the knots 
                              
                                 
                                    t
                                 
                                 
                                    k
                                    −
                                    d
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    k
                                    +
                                    d
                                 
                              
                            and the control points 
                              
                                 
                                    P
                                 
                                 
                                    k
                                    −
                                    d
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    k
                                 
                              
                           . When 
                              G
                              (
                              t
                              )
                              =
                              (
                              t
                              ,
                              g
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    [
                                    d
                                    −
                                    1
                                    ]
                                 
                              
                              (
                              t
                              )
                              )
                           , where 
                              g
                              (
                              t
                              )
                              =
                              q
                              t
                              +
                              h
                            with 
                              q
                              ≠
                              0
                              ,
                              −
                              1
                            and 
                              (
                              q
                              ,
                              h
                              )
                              ≠
                              (
                              1
                              ,
                              0
                              )
                           , a G-B-spline curve of degree d is called 
                              (
                              q
                              ,
                              h
                              )
                           
                           -B-spline curve of degree d.

Our goal in this section is to show that adjacent segments of a G-B-spline curve of degree d meet with 
                        d
                        −
                        1
                      matching quantum derivatives. Here we shall assume that in our progressive knot sequence 
                        
                           
                              t
                           
                           
                              i
                              +
                              1
                           
                        
                        ≠
                        
                           
                              t
                           
                           
                              i
                           
                        
                      for all i. G-B-splines with multiple knots will be investigated in Section 6.2. As promised our main tool for analyzing these G-B-spline curves will be the quantum G-blossom.


                     
                        Theorem 5.3
                        
                           Let 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            
                           and 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            
                           be adjacent segments of a G-B-spline curve with progressive knots 
                           
                              T
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              }
                            
                           and admissible vector 
                           
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                           
                           . Let 
                           
                              
                                 
                                    b
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              ;
                              G
                              )
                            
                           and 
                           
                              
                                 
                                    b
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              ;
                              G
                              )
                            
                           be the multiaffine or multilinear G-blossoms of 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            
                           and 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                           
                           . Then for all blossom values 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                    −
                                    1
                                 
                              
                            (either affine or homogeneous)
                              
                                 (5.1)
                                 
                                    
                                       
                                          b
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                          −
                                          1
                                       
                                    
                                    ;
                                    G
                                    )
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                          −
                                          1
                                       
                                    
                                    ;
                                    G
                                    )
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        The polynomial curves 
                              
                                 
                                    B
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            and 
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            have d common control points 
                              
                                 
                                    {
                                    
                                       
                                          P
                                       
                                       
                                          j
                                       
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    k
                                    −
                                    d
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                            and 
                              2
                              d
                              −
                              1
                            common knots 
                              
                                 
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    k
                                    −
                                    d
                                    +
                                    1
                                 
                                 
                                    k
                                    +
                                    d
                                    −
                                    1
                                 
                              
                           . By the dual functional property (4.10)
                           
                              
                                 (5.2)
                                 
                                    
                                       
                                          b
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          d
                                       
                                    
                                    ;
                                    G
                                    )
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          d
                                       
                                    
                                    ;
                                    G
                                    )
                                    ,
                                 
                              
                            
                           
                              i
                              =
                              k
                              −
                              d
                              ,
                              …
                              ,
                              k
                              −
                              1
                           . Applying the recursive evaluation algorithm (4.3)–(4.4) for the G-blossom to the G-blossom values in (5.2) and observing that 
                              
                                 
                                    ∩
                                 
                                 
                                    i
                                    =
                                    k
                                    −
                                    d
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    d
                                 
                              
                              }
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              }
                           , we obtain (5.1). □


                     
                        Theorem 5.4
                        
                           Let 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            
                           and 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            
                           be adjacent polynomial segments of a G-B-spline curve with progressive knots 
                           
                              T
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              }
                            
                           and admissible vector 
                           
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                           
                           . Then
                           
                              
                                 (5.3)
                                 
                                    
                                       
                                          B
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                    
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             j
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                    
                                    =
                                    
                                       
                                          B
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                    
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             j
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                    
                                    ,
                                    
                                    r
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    
                                       
                                          μ
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    1
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    d
                                    ,
                                 
                              
                            
                           where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                            
                           is the multiplicity of 
                           
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                            
                           in the set 
                           
                              
                                 
                                    {
                                    
                                       
                                          g
                                       
                                       
                                          l
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    }
                                 
                                 
                                    l
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                           
                           .
                        


                     
                        Proof
                        Set 
                              
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                              −
                              
                                 
                                    B
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            and let 
                              
                                 
                                    l
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              ;
                              G
                              )
                            be the G-blossom of 
                              
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                           . Suppose that 
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                              :
                              =
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                            has multiplicity 
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                            in the set 
                              
                                 
                                    {
                                    
                                       
                                          g
                                       
                                       
                                          l
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    }
                                 
                                 
                                    l
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                           . By the symmetry of the G-blossom we may assume that 
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                           , 
                              j
                              =
                              1
                              ,
                              …
                              ,
                              μ
                           , where 
                              μ
                              =
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                              
                           . Then 
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              =
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                           , 
                              j
                              =
                              1
                              ,
                              …
                              ,
                              μ
                           . We are going to show that the first μ terms in the Taylor expansion of 
                              
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            vanish at 
                              t
                              =
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                            and therefore that 
                              
                                 
                                    L
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              =
                              0
                           , 
                              r
                              =
                              0
                              ,
                              …
                              ,
                              μ
                              −
                              1
                           .

By Theorem 5.3 we have
                              
                                 (5.4)
                                 
                                    
                                       
                                          l
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    1
                                    )
                                    ,
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    1
                                    )
                                    ,
                                    …
                                    ,
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          d
                                          −
                                          1
                                       
                                    
                                    ,
                                    1
                                    )
                                    ;
                                    G
                                    )
                                    =
                                    0
                                 
                              
                            for all values of the blossom variables 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                    −
                                    1
                                 
                              
                           . Moreover by the G-diagonal property and the linearity of the functions 
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                              
                              t
                              +
                              
                                 
                                    h
                                 
                                 
                                    j
                                 
                              
                           , 
                              j
                              =
                              1
                              ,
                              …
                              ,
                              d
                           , it follows that
                              
                                 (5.5)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                                
                                                   ⁎
                                                
                                             
                                             +
                                             ϵ
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                                
                                                   ⁎
                                                
                                             
                                             +
                                             ϵ
                                             )
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   g
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                                
                                                   ⁎
                                                
                                             
                                             +
                                             ϵ
                                             )
                                             ;
                                             G
                                             )
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             ϵ
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   μ
                                                
                                             
                                             ϵ
                                             ,
                                             
                                                
                                                   g
                                                
                                                
                                                   μ
                                                   +
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                                
                                                   ⁎
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   μ
                                                   +
                                                   1
                                                
                                             
                                             ϵ
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   g
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                                
                                                   ⁎
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   d
                                                
                                             
                                             ϵ
                                             ;
                                             G
                                             )
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             1
                                             )
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             ϵ
                                             δ
                                             ,
                                             …
                                             ,
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             1
                                             )
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   μ
                                                
                                             
                                             ϵ
                                             δ
                                             ,
                                          
                                       
                                       
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   μ
                                                   +
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                                
                                                   ⁎
                                                
                                             
                                             )
                                             ,
                                             1
                                             )
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   μ
                                                   +
                                                   1
                                                
                                             
                                             ϵ
                                             δ
                                             ,
                                             …
                                             ,
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                                
                                                   ⁎
                                                
                                             
                                             )
                                             ,
                                             1
                                             )
                                             +
                                             
                                                
                                                   q
                                                
                                                
                                                   d
                                                
                                             
                                             ϵ
                                             δ
                                             ;
                                             G
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                            where 
                              δ
                              =
                              (
                              1
                              ,
                              0
                              )
                           . By (5.5) and the multilinear property of the homogeneous G-blossom, for every 
                              r
                              =
                              0
                              ,
                              …
                              ,
                              μ
                              −
                              1
                            the coefficient of 
                              
                                 
                                    ϵ
                                 
                                 
                                    r
                                 
                              
                            in the Taylor expansion of 
                              
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                              +
                              ϵ
                              )
                            as a polynomial in ϵ is a linear combination of G-blossom values of the form 
                              
                                 
                                    l
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                    −
                                    1
                                 
                              
                              ;
                              G
                              )
                            and therefore vanishes by (5.4). Hence 
                              
                                 
                                    L
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    r
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              =
                              
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                              +
                              ϵ
                              )
                              /
                              d
                              
                                 
                                    ϵ
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    ϵ
                                    =
                                    0
                                 
                              
                              =
                              0
                           , 
                              r
                              =
                              0
                              ,
                              …
                              ,
                              μ
                              −
                              1
                           . Therefore (5.3) holds. □


                     
                        Corollary 5.5
                        
                           Let 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            
                           and 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            
                           be adjacent polynomial segments of a G-B-spline curve with progressive knots 
                           
                              T
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              }
                            
                           and admissible vector 
                           
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                           
                           . Then
                           
                              
                                 (5.6)
                                 
                                    
                                       
                                          B
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    [
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ]
                                    =
                                    
                                       
                                          B
                                       
                                       
                                          k
                                       
                                    
                                    [
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ]
                                 
                              
                            
                           for every 
                           
                              1
                              ≤
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              <
                              ⋯
                              <
                              
                                 
                                    i
                                 
                                 
                                    m
                                 
                              
                              ≤
                              d
                            
                           and 
                           
                              m
                              =
                              1
                              ,
                              …
                              ,
                              d
                           
                           .
                        


                     
                        Proof
                        This result follows immediately from Theorem 5.4 and Proposition 2.1. □


                     
                        Corollary 5.6
                        
                           Let 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            
                           and 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            
                           be adjacent polynomial segments of a G-B-spline curve with progressive knots 
                           
                              T
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              }
                            
                           and admissible vector 
                           
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                           
                           . Set 
                           
                              
                                 
                                    G
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                              )
                           
                           . Then for every 
                           
                              I
                              =
                              
                                 
                                    {
                                    
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              ⊆
                              {
                              1
                              ,
                              …
                              ,
                              d
                              }
                           
                           ,
                           
                              
                                 (5.7)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                I
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                I
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ,
                                    
                                    r
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    m
                                    −
                                    1
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        This result follows immediately from Theorem 5.4 and Proposition 2.4. □


                     
                        Corollary 5.7
                        
                           Let 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            
                           and 
                           
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              t
                              )
                            
                           be adjacent polynomial segments of a 
                           
                              (
                              q
                              ,
                              h
                              )
                           
                           -B-spline curve of degree d with progressive knots 
                           
                              T
                              =
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              }
                           
                           . Then
                           
                              
                                 (5.8)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          1
                                          /
                                          q
                                          ,
                                          −
                                          h
                                          /
                                          q
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          1
                                          /
                                          q
                                          ,
                                          −
                                          h
                                          /
                                          q
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ,
                                    
                                    m
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    d
                                    −
                                    1
                                    .
                                 
                              
                           
                        


                     
                        Proof
                        This result follows immediately from Corollary 5.5 and equation (2.10). □

Classical B-spline curves can have multiple knots: knots where the smoothness decreases by the multiplicity of the knot. G-B-spline curves can have two kinds of multiplicity: multiplicity along the G-diagonal and multiplicity in the knots. These two kinds of multiplicity have inverse effects: multiplicity along the G-diagonal increases the order of smoothness of certain quantum derivatives; multiplicity in the knots decreases the order of smoothness. In addition, we shall see that each of these two kinds of multiplicity have two subcategories of multiplicity: 
                        (
                        q
                        ,
                        h
                        )
                     -multiplicity and t-multiplicity. In this section we shall study each of these kinds of multiplicity and their effects on the quantum smoothness of the corresponding G-B-spline curves.

There are two interesting kinds of multiplicity along the G-diagonal: 
                           (
                           q
                           ,
                           h
                           )
                        -multiplicity and t-multiplicity. Each of these multiplicities increases the smoothness of certain quantum or classical derivatives. We begin here with the definitions of these two kinds of multiplicity.


                        
                           Definition 6.1
                           Let 
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               with 
                                 q
                                 ≠
                                 0
                               and 
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              . We say that an admissible vector 
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                               has 
                                 (
                                 q
                                 ,
                                 h
                                 )
                              
                              -multiplicity m if the functions 
                                 (
                                 t
                                 ,
                                 g
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       m
                                       −
                                       1
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                               are a subset of 
                                 G
                                 (
                                 t
                                 )
                              . (Note that the order does not matter.) In particular, 
                                 G
                                 (
                                 t
                                 )
                               has q-multiplicity m if the functions 
                                 (
                                 t
                                 ,
                                 q
                                 t
                                 ,
                                 …
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 t
                                 )
                               are a subset of 
                                 G
                                 (
                                 t
                                 )
                               and h-multiplicity m if the functions 
                                 (
                                 t
                                 ,
                                 t
                                 −
                                 h
                                 ,
                                 …
                                 ,
                                 t
                                 −
                                 (
                                 m
                                 −
                                 1
                                 )
                                 h
                                 )
                               are a subset of 
                                 G
                                 (
                                 t
                                 )
                              .


                        
                           Definition 6.2
                           We say that an admissible vector 
                                 G
                                 (
                                 t
                                 )
                               has t-multiplicity m if the functions 
                                 (
                                 
                                 
                                    
                                       
                                          t
                                          ,
                                          …
                                          ,
                                          t
                                       
                                       ︸
                                    
                                    m
                                 
                                 )
                               are a subset of 
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              .


                        
                           Theorem 6.3
                           
                              Let 
                              
                                 
                                    
                                       B
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                               
                              and 
                              
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 t
                                 )
                               
                              be adjacent polynomial segments of a G-B-spline curve 
                              
                                 B
                                 (
                                 t
                                 )
                               
                              with progressive knots 
                              
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              and admissible vector 
                              
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              . Suppose that 
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 g
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       m
                                       −
                                       1
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 )
                               
                              is a subset of 
                              
                                 G
                                 (
                                 t
                                 )
                               
                              for some 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                              
                              , where 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                               
                              and 
                              
                                 g
                                 ∘
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 ∘
                                 g
                              
                              . Then
                              
                                 
                                    (6.1)
                                    
                                       
                                          
                                             D
                                          
                                          
                                             1
                                             /
                                             q
                                             ,
                                             −
                                             h
                                             /
                                             q
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             s
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                       =
                                       
                                          
                                             D
                                          
                                          
                                             1
                                             /
                                             q
                                             ,
                                             −
                                             h
                                             /
                                             q
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             s
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                       ,
                                       
                                       r
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       m
                                       −
                                       1
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           By the symmetry of the G-blossom we may assume that 
                                 s
                                 =
                                 1
                               and 
                                 
                                    
                                       g
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       j
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              , 
                                 j
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 1
                              . Since 
                                 g
                                 ∘
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 ∘
                                 g
                              , we have 
                                 
                                    
                                       g
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       −
                                       j
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              , 
                                 j
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 1
                              . Therefore by Theorem 5.4, 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       −
                                       j
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 )
                                 )
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       −
                                       j
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 )
                                 )
                              , 
                                 j
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 1
                              . Now the result follows immediately from equation (2.10) and Proposition 2.1. □

To see when the composition of two linear functions is commutative, suppose that 
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           t
                           +
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                           t
                           +
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                        . Then 
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           ∘
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           )
                           (
                           t
                           )
                           =
                           (
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           ∘
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           )
                           (
                           t
                           )
                         if and only if
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 t
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 t
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       h
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         or equivalently if and only if 
                           (
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           −
                           1
                           )
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                           =
                           (
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                           −
                           1
                           )
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                        . In particular, 
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           ∘
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           )
                           (
                           t
                           )
                           =
                           (
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           ∘
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           )
                           (
                           t
                           )
                         if either 
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                           =
                           1
                         or 
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                           =
                           0
                        . One can also show that 
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           ∘
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           )
                           (
                           t
                           )
                           =
                           (
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           ∘
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           )
                           (
                           t
                           )
                         if an only if 
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 q
                              
                              
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           t
                           +
                           
                              
                                 [
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              
                                 q
                              
                           
                           h
                         and 
                           
                              
                                 g
                              
                              
                                 2
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 q
                              
                              
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           t
                           +
                           
                              
                                 [
                                 
                                    
                                       r
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              
                                 q
                              
                           
                           h
                         for some q, h, 
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                        , and 
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                        .

We could try to derive a result similar to Theorem 6.3 for t-multiplicity, by taking limits as 
                           (
                           q
                           ,
                           h
                           )
                           →
                           (
                           1
                           ,
                           0
                           )
                        . But then we would need to worry about the meaning of divided differences for multiple nodes and taking these limits can be a bit tricky. Also there is no need for analytic methods (e.g. limits) here. Since we are dealing with polynomials, everything can be defined and derived algebraically, including the notions of derivative and Taylor expansion. Therefore we shall use Taylor expansion to derive the result about t-multiplicity.


                        
                           Theorem 6.4
                           
                              Let 
                              
                                 B
                                 (
                                 t
                                 )
                               
                              be a G-B-spline curve with progressive knots 
                              
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              and admissible vector 
                              
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                               
                              with t-multiplicity m. Then 
                              
                                 B
                                 (
                                 t
                                 )
                               
                              is 
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                               
                              continuous at the knots.
                           


                        
                           Proof
                           This theorem is a particular case of the following theorem. □


                        
                           Theorem 6.5
                           
                              Let 
                              
                                 B
                                 (
                                 t
                                 )
                               
                              be a G-B-spline curve with progressive knots 
                              
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              and admissible vector 
                              
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              . Suppose that 
                              
                                 G
                                 (
                                 t
                                 )
                               
                              contains 
                              
                                 (
                                 
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                s
                                             
                                          
                                          (
                                          t
                                          )
                                          ,
                                          …
                                          ,
                                          
                                             
                                                g
                                             
                                             
                                                s
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                       ︸
                                    
                                    m
                                 
                                 )
                              
                              . Then 
                              
                                 B
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                               
                              is 
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                               
                              continuous at the knots.
                           


                        
                           Proof
                           For every knot 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                               where adjacent segments of 
                                 B
                                 (
                                 t
                                 )
                               meet, the multiplicity of the value 
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                               in the set 
                                 
                                    
                                       {
                                       
                                          
                                             g
                                          
                                          
                                             l
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       }
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                               is at least m. Therefore this result follows immediately from Theorem 5.4. □


                        
                           Example
                           Let 
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 t
                                 ,
                                 t
                                 ,
                                 t
                                 ,
                                 q
                                 t
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 t
                                 ,
                                 t
                                 −
                                 h
                                 ,
                                 t
                                 −
                                 h
                                 )
                               and let 
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               be a progressive knot sequence. Then at the knots, any G-B-spline curve has two matching classical derivatives (corresponding to 
                                 (
                                 t
                                 ,
                                 t
                                 ,
                                 t
                                 )
                               – Theorem 6.4), two matching 
                                 1
                                 /
                                 q
                              -derivatives (corresponding to 
                                 (
                                 t
                                 ,
                                 q
                                 t
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 t
                                 )
                               – Theorem 6.3), and one matching h-derivative (corresponding to 
                                 (
                                 t
                                 ,
                                 t
                                 −
                                 h
                                 )
                               – Theorem 6.3). For all knots 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                               there is also one matching classical derivative at 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 h
                               (corresponding to 
                                 (
                                 t
                                 −
                                 h
                                 ,
                                 t
                                 −
                                 h
                                 )
                               – Theorem 6.5).

Just like multiplicity along the G-diagonal, there are two interesting kinds of multiplicity in the knots: 
                           (
                           q
                           ,
                           h
                           )
                        -multiplicity and standard multiplicity (or simply multiplicity). When these multiplicities are combined with the corresponding multiplicities along the G-diagonal, the smoothness of certain classical or quantum derivatives decreases.


                        
                           Definition 6.6
                           Let 
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               with 
                                 q
                                 ≠
                                 0
                               and 
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                               and let 
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               be a progressive knot sequence. We say that a knot 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                               has 
                                 (
                                 q
                                 ,
                                 h
                                 )
                              
                              -multiplicity 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 ≤
                                 d
                               if 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       i
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 1
                              , and 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 ≠
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                              .


                        
                           Definition 6.7
                           Let 
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               be a progressive knot sequence. We say that a knot 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                               has multiplicity 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 ≤
                                 d
                               if 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 1
                              , and 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 ≠
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                              .

When a knot 
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                         has multiplicity 
                           
                              
                                 μ
                              
                              
                                 k
                              
                           
                        , the segments 
                           
                              
                                 B
                              
                              
                                 k
                              
                           
                           (
                           t
                           )
                           ,
                           …
                           ,
                           
                              
                                 B
                              
                              
                                 k
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 2
                              
                           
                           (
                           t
                           )
                         of a B-spline curve 
                           B
                           (
                           t
                           )
                         are empty.


                        
                           Theorem 6.8
                           
                              Let 
                              
                                 B
                                 (
                                 t
                                 )
                               
                              be a G-B-spline curve with progressive knots 
                              
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              and admissible vector 
                              
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              . Suppose that 
                              
                                 G
                                 (
                                 t
                                 )
                               
                              has 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                              
                              -multiplicity m and that the knot 
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                               
                              has 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                              
                              -multiplicity 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 ≤
                                 m
                              
                              . If 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              , then
                              
                                 
                                    (6.2)
                                    
                                       
                                          
                                             D
                                          
                                          
                                             1
                                             /
                                             q
                                             ,
                                             −
                                             h
                                             /
                                             q
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             D
                                          
                                          
                                             1
                                             /
                                             q
                                             ,
                                             −
                                             h
                                             /
                                             q
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ,
                                    
                                 
                               
                              
                                 r
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                              
                              .
                           


                              If 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              , then
                              
                                 
                                    (6.3)
                                    
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                          
                                             (
                                             r
                                             )
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             (
                                             r
                                             )
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       ,
                                       
                                       r
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       m
                                       −
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        Theorem 6.8 is a special case of the following theorem.


                        
                           Theorem 6.9
                           
                              Let 
                              
                                 B
                                 (
                                 t
                                 )
                               
                              be a G-B-spline curve with progressive knots 
                              
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              and admissible vector 
                              
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              . Suppose that 
                              
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 g
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       m
                                       −
                                       1
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 )
                               
                              is contained in 
                              
                                 G
                                 (
                                 t
                                 )
                              
                              , where 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              and 
                              
                                 g
                                 ∘
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       s
                                    
                                 
                                 ∘
                                 g
                              
                              . Suppose too that the knot 
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                               
                              has 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                              
                              -multiplicity 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 ≤
                                 m
                              
                              . If 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              , then
                              
                                 
                                    (6.4)
                                    
                                       
                                          
                                             D
                                          
                                          
                                             1
                                             /
                                             q
                                             ,
                                             −
                                             h
                                             /
                                             q
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             s
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                       =
                                       
                                          
                                             D
                                          
                                          
                                             1
                                             /
                                             q
                                             ,
                                             −
                                             h
                                             /
                                             q
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             s
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                       ,
                                    
                                 
                               
                              
                                 r
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                              
                              .
                           


                              If 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              , then
                              
                                 
                                    (6.5)
                                    
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                          
                                             (
                                             r
                                             )
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             s
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             (
                                             r
                                             )
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             s
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                       ,
                                       
                                       r
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       m
                                       −
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           First suppose that 
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                               and let 
                                 1
                                 ≤
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                              . The curves 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                               and 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                       −
                                       1
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                               have 
                                 d
                                 +
                                 1
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                               common control points 
                                 
                                    
                                       P
                                    
                                    
                                       k
                                       −
                                       1
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       d
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                               and 
                                 2
                                 d
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                               common knots 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       d
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       −
                                       1
                                       +
                                       d
                                    
                                 
                              . By the dual functional property (4.10)
                              
                                 
                                    (6.6)
                                    
                                       
                                          
                                             b
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             d
                                          
                                       
                                       ;
                                       G
                                       )
                                       =
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             b
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             d
                                          
                                       
                                       ;
                                       G
                                       )
                                       ,
                                    
                                 
                               
                              
                                 i
                                 =
                                 k
                                 −
                                 1
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 d
                                 ,
                                 …
                                 ,
                                 k
                                 −
                                 1
                              . The common knots that appear in the G-blossom values in (6.6) are 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       −
                                       1
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              . Consider the symmetric, multiaffine functions
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ν
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             d
                                             −
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             b
                                          
                                          
                                             ν
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             d
                                             −
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ;
                                       G
                                       )
                                       ,
                                    
                                 
                               
                              
                                 ν
                                 =
                                 k
                                 −
                                 1
                                 ,
                                 k
                                 −
                                 1
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                              . From (6.6) it follows that for each 
                                 i
                                 =
                                 k
                                 −
                                 1
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 d
                                 ,
                                 …
                                 ,
                                 k
                                 −
                                 1
                              ,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             d
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             d
                                          
                                       
                                       )
                                       .
                                    
                                 
                               Thus, for the knot vector 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       d
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       d
                                       −
                                       1
                                    
                                 
                                 )
                               of size 
                                 2
                                 (
                                 d
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 )
                              , the functions 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       −
                                       1
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                               agree at each sequence of 
                                 d
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                               consecutive knots. Therefore by the recursive evaluation algorithm for symmetric multilinear functions
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             d
                                             −
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             d
                                             −
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                               or equivalently,
                                 
                                    (6.7)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                      −
                                                      1
                                                      +
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      d
                                                      −
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ;
                                                G
                                                )
                                             
                                          
                                          
                                             
                                                
                                                =
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      k
                                                      −
                                                      1
                                                      +
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                      −
                                                      1
                                                      +
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      d
                                                      −
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ;
                                                G
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                               By the symmetry of the G-blossom we may assume that 
                                 s
                                 =
                                 1
                               and 
                                 
                                    
                                       g
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       j
                                       −
                                       1
                                       ]
                                    
                                 
                                 ∘
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 (
                                 t
                                 )
                              , 
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                              . Moreover by assumption for 
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                               we have 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       i
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 1
                              . Now let 
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                              . Then, since 
                                 g
                                 ∘
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 ∘
                                 g
                              , for each 
                                 r
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                               we can write
                                 
                                    (6.8)
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                      −
                                                      1
                                                      +
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                =
                                             
                                             
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                g
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      1
                                                      ]
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                )
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                (
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      r
                                                      ]
                                                   
                                                
                                                ∘
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      −
                                                      r
                                                      ]
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                )
                                                ,
                                                …
                                                ,
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      r
                                                      +
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      1
                                                      ]
                                                   
                                                
                                                ∘
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      −
                                                      r
                                                      ]
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                )
                                                )
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      r
                                                      +
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      −
                                                      r
                                                      ]
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                )
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      r
                                                      +
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      −
                                                      r
                                                      ]
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                )
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              Now let 
                                 0
                                 ≤
                                 r
                                 ≤
                                 m
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                               and in (6.7) set
                                 
                                    (6.9)
                                    
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         [
                                                         −
                                                         r
                                                         ]
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   )
                                                   ,
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   r
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         i
                                                         +
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         [
                                                         −
                                                         r
                                                         ]
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   )
                                                   ,
                                                   
                                                
                                                
                                                   i
                                                   =
                                                   r
                                                   +
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   d
                                                   −
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               From (6.7), (6.8), (6.9), and the diagonal property of the G-blossom it follows that
                                 
                                    (6.10)
                                    
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             [
                                             −
                                             r
                                             ]
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   m
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             [
                                             −
                                             r
                                             ]
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       )
                                       ,
                                    
                                 
                               
                              
                                 r
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                              . Now (6.4) follows from (6.10), (2.10), and Proposition 2.1.

Next, suppose that 
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 )
                              , that is 
                                 g
                                 (
                                 t
                                 )
                                 =
                                 t
                              . Once again we can assume that 
                                 s
                                 =
                                 1
                              . In this case we can use the previous argument to establish (6.7) but only for 
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                              . We get
                                 
                                    (6.11)
                                    
                                       
                                          
                                             b
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             d
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       ;
                                       G
                                       )
                                       =
                                       
                                          
                                             b
                                          
                                          
                                             k
                                             −
                                             1
                                             +
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       (
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             ︸
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             d
                                             −
                                             
                                                
                                                   μ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       ;
                                       G
                                       )
                                       .
                                    
                                 
                               By the diagonal property of the homogeneous G-blossom
                                 
                                    (6.12)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                ϵ
                                                )
                                                )
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                (
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         1
                                                         )
                                                         +
                                                         ϵ
                                                         δ
                                                         ,
                                                         …
                                                         ,
                                                         (
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         1
                                                         )
                                                         +
                                                         ϵ
                                                         δ
                                                      
                                                      ︸
                                                   
                                                   m
                                                
                                                ,
                                             
                                          
                                          
                                             
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      m
                                                      +
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                ,
                                                1
                                                )
                                                +
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      m
                                                      +
                                                      1
                                                   
                                                
                                                ϵ
                                                δ
                                                ,
                                                …
                                                ,
                                                (
                                                
                                                   
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                ,
                                                1
                                                )
                                                +
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ϵ
                                                δ
                                                ;
                                                G
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                               
                              
                                 ν
                                 =
                                 k
                                 −
                                 1
                                 ,
                                 
                                 k
                                 −
                                 1
                                 +
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                              , where 
                                 δ
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 )
                               and 
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 t
                                 +
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                              , 
                                 j
                                 =
                                 m
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              . By (6.12) and the linearity of the homogeneous G-blossom, for every 
                                 r
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                               the coefficient of 
                                 
                                    
                                       ϵ
                                    
                                    
                                       r
                                    
                                 
                               in 
                                 
                                    
                                       B
                                    
                                    
                                       ν
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 ϵ
                                 )
                                 )
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       ν
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 ϵ
                                 /
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 )
                               is a linear combination of G-blossom values that appear in (6.11). Therefore by (6.11), for every 
                                 r
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                               the coefficients of 
                                 
                                    
                                       ϵ
                                    
                                    
                                       r
                                    
                                 
                               in 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 ϵ
                                 /
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                       −
                                       1
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 ϵ
                                 /
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 )
                               are equal. This fact and the simple property 
                                 
                                    
                                       F
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                 
                                 (
                                 a
                                 +
                                 b
                                 ϵ
                                 )
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       −
                                       r
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 F
                                 (
                                 a
                                 +
                                 b
                                 ϵ
                                 )
                                 )
                                 /
                                 d
                                 
                                    
                                       ϵ
                                    
                                    
                                       r
                                    
                                 
                               yield (6.5). □


                        
                           Example
                           Let 
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 t
                                 ,
                                 t
                                 ,
                                 t
                                 ,
                                 q
                                 t
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 t
                                 ,
                                 t
                                 −
                                 h
                                 )
                               and let 
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               be a progressive knot sequence of order 3 containing the knots
                                 
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             8
                                          
                                       
                                       )
                                       =
                                       (
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       q
                                       
                                          
                                             τ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             τ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       h
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       2
                                       h
                                       )
                                       .
                                    
                                 
                               Let 
                                 B
                                 (
                                 t
                                 )
                               be a G-B-spline curve with knots T and polynomial segments 
                                 
                                    
                                       B
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 t
                                 )
                              . Then
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                      /
                                                      q
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                      /
                                                      q
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      3
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                
                                                r
                                                =
                                                0
                                                ,
                                                1
                                                ,
                                                2
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                      /
                                                      q
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                      /
                                                      q
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      4
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ,
                                                
                                                r
                                                =
                                                0
                                                ,
                                                1
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      5
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      5
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      6
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                ,
                                                
                                                r
                                                =
                                                0
                                                ,
                                                1
                                                ,
                                                2
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      5
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      7
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                ,
                                                
                                                r
                                                =
                                                0
                                                ,
                                                1
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      5
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      k
                                                      +
                                                      8
                                                   
                                                
                                                (
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           

Here we introduce the notion of generalized quantum spline curves or G-spline curves, and we explore under what conditions G-spline curves are G-B-spline curves.


                     
                        Definition 7.1
                        Let 
                              
                                 
                                    {
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                            be an increasing sequence of knots and let 
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                            be an admissible vector. A G-spline curve of degree d with knots 
                              
                                 
                                    {
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                            is a function that is a polynomial 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                            of degree d on 
                              [
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ]
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              −
                              1
                           , and for every 
                              i
                              =
                              2
                              ,
                              …
                              ,
                              I
                              −
                              1
                            there exists a non-empty set 
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                              =
                              {
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    j
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              }
                              ⊆
                              {
                              1
                              ,
                              …
                              ,
                              d
                              }
                            such that
                              
                                 (7.1)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    
                                    r
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    1
                                    ,
                                 
                              
                            that is, 
                              S
                              (
                              t
                              )
                            is 
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                            continuous at 
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                           . When 
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                              =
                              {
                              1
                              ,
                              …
                              ,
                              d
                              }
                           , we say that 
                              S
                              (
                              t
                              )
                            is 
                              
                                 
                                    G
                                 
                                 
                                    −
                                    1
                                 
                              
                            continuous at the knots 
                              {
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              }
                           .


                     
                        Definition 7.2
                        Let 
                              G
                              (
                              t
                              )
                              =
                              (
                              t
                              ,
                              g
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    [
                                    d
                                    −
                                    1
                                    ]
                                 
                              
                              (
                              t
                              )
                              )
                           , where 
                              g
                              (
                              t
                              )
                              =
                              q
                              t
                              +
                              h
                            with 
                              q
                              ≠
                              0
                              ,
                              −
                              1
                            and 
                              (
                              q
                              ,
                              h
                              )
                              ≠
                              (
                              1
                              ,
                              0
                              )
                           . A G-spline curve 
                              S
                              (
                              t
                              )
                            of degree d with knots 
                              
                                 
                                    {
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                            is called 
                              (
                              q
                              ,
                              h
                              )
                           
                           -spline curve if there exist constants 
                              
                                 
                                    {
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    2
                                 
                                 
                                    I
                                    −
                                    1
                                 
                              
                            such that for every 
                              i
                              =
                              2
                              ,
                              …
                              ,
                              I
                              −
                              1
                           , 
                              S
                              (
                              t
                              )
                            has continuous 
                              (
                              1
                              /
                              q
                              ,
                              −
                              h
                              /
                              q
                              )
                           -derivatives of order 
                              r
                              =
                              0
                              ,
                              …
                              ,
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              −
                              1
                            at the knot 
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                           .

It follows from Corollary 5.6 that every G-B-spline curve with a non-decreasing knot sequence is a G-spline curve. However, not every G-spline curve is a G-B-spline curve. This fact is demonstrated in the Appendix with an example.

Next we explore two important special cases where every G-spline curve is a G-B-spline curve: 
                        
                           
                              G
                           
                           
                              −
                              1
                           
                        
                     -continuous spline curves and 
                        (
                        q
                        ,
                        h
                        )
                     -spline curves.


                     
                        Theorem 7.3
                        
                           Let 
                           
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              t
                              )
                              )
                            
                           be admissible and let 
                           
                              S
                              (
                              t
                              )
                            
                           be a G-spline curve that is 
                           
                              
                                 
                                    G
                                 
                                 
                                    −
                                    1
                                 
                              
                            
                           continuous at the knots 
                           
                              {
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              }
                           
                           . Then 
                           
                              S
                              (
                              t
                              )
                            
                           is a G-B-spline curve.
                        


                     
                        Proof
                        Let 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                            be the polynomial segment of 
                              S
                              (
                              t
                              )
                            defined over the interval 
                              [
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ]
                            and let 
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              ;
                              G
                              )
                            be the G-blossom of 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              −
                              1
                           . We begin by constructing an increasing knot sequence 
                              {
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              }
                            for the corresponding G-B-spline curve. Define the knots 
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    d
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                           , and let the knots 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              <
                              ⋯
                              <
                              
                                 
                                    t
                                 
                                 
                                    d
                                    −
                                    1
                                 
                              
                              <
                              
                                 
                                    τ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    τ
                                 
                                 
                                    I
                                 
                              
                              <
                              
                                 
                                    t
                                 
                                 
                                    I
                                    +
                                    d
                                 
                              
                              <
                              ⋯
                              <
                              
                                 
                                    t
                                 
                                 
                                    I
                                    +
                                    2
                                    d
                                    −
                                    2
                                 
                              
                            be arbitrary. We shall now construct the G-B-spline curve corresponding to 
                              S
                              (
                              t
                              )
                            segment by segment. Let 
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                            be the polynomial of degree d generated by the local G-de Boor algorithm from the control points 
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    d
                                 
                              
                              ;
                              G
                              )
                           , 
                              j
                              =
                              0
                              ,
                              …
                              ,
                              d
                            and the knots 
                              
                                 
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    2
                                    d
                                 
                              
                           . By the dual functional property-equation (4.9),
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       d
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    t
                                    ;
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          2
                                          d
                                       
                                    
                                    ;
                                    G
                                    )
                                    
                                       
                                          P
                                       
                                       
                                          j
                                       
                                    
                                    ≡
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    .
                                 
                              
                            In particular, 
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ≡
                              
                                 
                                    B
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                            on 
                              [
                              
                                 
                                    τ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    2
                                 
                              
                              ]
                           . Now we proceed by induction on 
                              1
                              ≤
                              i
                              ≤
                              I
                              −
                              1
                           . Suppose that for some 
                              1
                              ≤
                              i
                              <
                              I
                              −
                              1
                           , we have already constructed the polynomial 
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                            by applying the local G-de Boor algorithm to the control points 
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    d
                                 
                              
                              ;
                              G
                              )
                           , 
                              j
                              =
                              i
                              −
                              1
                              ,
                              …
                              ,
                              i
                              +
                              d
                              −
                              1
                            and the knots 
                              
                                 
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    i
                                 
                                 
                                    i
                                    +
                                    2
                                    d
                                    −
                                    1
                                 
                              
                           . Again it follows from equation (4.9) that 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              ≡
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                           . Next we construct a polynomial 
                              
                                 
                                    B
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              (
                              t
                              )
                            by applying the local G-de Boor algorithm to the control points 
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    d
                                 
                              
                              ;
                              G
                              )
                           , 
                              j
                              =
                              i
                              ,
                              …
                              ,
                              i
                              +
                              d
                              −
                              1
                           , and a (yet to be determined) control point 
                              
                                 
                                    P
                                 
                                 
                                    i
                                    +
                                    d
                                 
                              
                           , and the knots 
                              
                                 
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    i
                                    +
                                    1
                                 
                                 
                                    i
                                    +
                                    2
                                    d
                                 
                              
                           . By Corollary 5.5 and the 
                              
                                 
                                    G
                                 
                                 
                                    −
                                    1
                                 
                              
                            continuity of 
                              S
                              (
                              t
                              )
                            at 
                              
                                 
                                    τ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            we have
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             [
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   g
                                                
                                                
                                                   r
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ]
                                             =
                                             
                                                
                                                   B
                                                
                                                
                                                   i
                                                
                                             
                                             [
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   g
                                                
                                                
                                                   r
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ]
                                          
                                       
                                       
                                          
                                             
                                             =
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                
                                             
                                             [
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   g
                                                
                                                
                                                   r
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ]
                                             =
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             [
                                             
                                                
                                                   g
                                                
                                                
                                                   1
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   g
                                                
                                                
                                                   r
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   τ
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             ]
                                             ,
                                          
                                       
                                    
                                 
                              
                            
                           
                              r
                              =
                              1
                              ,
                              …
                              ,
                              d
                           . These equations hold independent of the choice of the control point 
                              
                                 
                                    P
                                 
                                 
                                    i
                                    +
                                    d
                                 
                              
                           . Now we pick a value 
                              
                                 
                                    τ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                                 
                                    ⁎
                                 
                              
                              ∉
                              
                                 
                                    {
                                    
                                       
                                          g
                                       
                                       
                                          j
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                            and determine the control point 
                              
                                 
                                    P
                                 
                                 
                                    i
                                    +
                                    d
                                 
                              
                            from the condition 
                              
                                 
                                    B
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              =
                              
                                 
                                    S
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                                 
                                    ⁎
                                 
                              
                              )
                           , that is, by solving the linear equation
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          j
                                          =
                                          i
                                       
                                       
                                          i
                                          +
                                          d
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                          −
                                          i
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    ;
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          2
                                          d
                                       
                                    
                                    ;
                                    G
                                    )
                                    
                                       
                                          P
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       
                                          ⁎
                                       
                                    
                                    )
                                 
                              
                            for the unknown control point 
                              
                                 
                                    P
                                 
                                 
                                    i
                                    +
                                    d
                                 
                              
                           . Then by Proposition 2.1 the degree d polynomials 
                              
                                 
                                    S
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              (
                              t
                              )
                            and 
                              
                                 
                                    B
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              (
                              t
                              )
                            agree at the 
                              d
                              +
                              1
                            values 
                              
                                 
                                    {
                                    
                                       
                                          g
                                       
                                       
                                          j
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                    }
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    d
                                 
                              
                              ∪
                              {
                              
                                 
                                    τ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                                 
                                    ⁎
                                 
                              
                              }
                            counting multiplicity. Hence, 
                              
                                 
                                    S
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              (
                              t
                              )
                              ≡
                              
                                 
                                    B
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              (
                              t
                              )
                           . Therefore the G-spline curve 
                              S
                              (
                              t
                              )
                            coincides with the G-B-spline curve 
                              B
                              (
                              t
                              )
                            over the interval 
                              [
                              
                                 
                                    τ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    I
                                 
                              
                              ]
                           . □

As we mentioned at the start of this section, not every G-spline is a G-B-spline. Problems occur when the G-spline of degree d is not 
                        
                           
                              G
                           
                           
                              −
                              1
                           
                        
                      continuous. However both for classical splines and for 
                        (
                        q
                        ,
                        h
                        )
                     -splines, lower order continuity can be modeled with multiple knots.


                     
                        Theorem 7.4
                        
                           Let 
                           
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              g
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    [
                                    d
                                    −
                                    1
                                    ]
                                 
                              
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              )
                              )
                            
                           be admissible, where 
                           
                              g
                              (
                              t
                              )
                              =
                              q
                              t
                              +
                              h
                            
                           with 
                           
                              (
                              q
                              ,
                              h
                              )
                              ≠
                              (
                              1
                              ,
                              0
                              )
                            
                           and 
                           
                              g
                              ∘
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              ∘
                              g
                           
                           , and let 
                           
                              S
                              (
                              t
                              )
                            
                           be a G-spline curve with knots 
                           
                              
                                 
                                    {
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                           
                           . Then 
                           
                              S
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              )
                            
                           is a G-B-spline curve with knots 
                           
                              
                                 
                                    {
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                           
                           . In particular, if 
                           
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              =
                              t
                           
                           , then 
                           
                              S
                              (
                              t
                              )
                            
                           is a G-B-spline curve.
                        


                     
                        Proof
                        Let 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                            be the polynomial segment of 
                              S
                              (
                              t
                              )
                            defined over the interval 
                              [
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ]
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              −
                              1
                           . Set 
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                           . Since 
                              S
                              (
                              t
                              )
                            is a G-spline curve, there are constants 
                              
                                 
                                    {
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    2
                                 
                                 
                                    I
                                    −
                                    1
                                 
                              
                            such that
                              
                                 (7.2)
                                 
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          S
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    [
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          −
                                          r
                                          ]
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                    =
                                    0
                                    ,
                                    
                                    r
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    1
                                    ,
                                 
                              
                            
                           
                              i
                              =
                              2
                              ,
                              …
                              ,
                              I
                              −
                              1
                           . Let 
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    d
                                 
                              
                              ;
                              q
                              ,
                              h
                              )
                            be the 
                              (
                              q
                              ,
                              h
                              )
                           -blossom of 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                            and let 
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    d
                                 
                              
                              ;
                              G
                              )
                            be the G-blossom of 
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              )
                           . Now observe that
                              
                                 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    ;
                                    G
                                    )
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          d
                                       
                                    
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    ,
                                 
                              
                            because the right-hand side is symmetric, multiaffine, and along the G-diagonal
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    ,
                                    g
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          d
                                          −
                                          1
                                          ]
                                       
                                    
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    t
                                    )
                                    .
                                 
                              
                            From (7.2) and Corollary 3.6 it follows that
                              
                                 
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          s
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    g
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    …
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          d
                                          −
                                          r
                                          −
                                          1
                                          ]
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    δ
                                    ,
                                    …
                                    ,
                                    δ
                                    ;
                                    q
                                    ,
                                    h
                                    )
                                    =
                                    0
                                 
                              
                            or equivalently,
                              
                                 (7.3)
                                 
                                    (
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    g
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    …
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          d
                                          −
                                          r
                                          −
                                          1
                                          ]
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    δ
                                    ,
                                    …
                                    ,
                                    δ
                                    ;
                                    G
                                    )
                                    =
                                    0
                                    ,
                                 
                              
                            
                           
                              r
                              =
                              0
                              ,
                              …
                              ,
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              −
                              1
                           , 
                              i
                              =
                              2
                              ,
                              …
                              ,
                              I
                              −
                              1
                           .

To construct the knots for 
                              
                                 
                                    S
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              t
                              )
                           , define the numbers 
                              
                                 
                                    {
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                            by
                              
                                 (7.4)
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    d
                                    ,
                                    
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    d
                                    +
                                    1
                                    ,
                                    
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    d
                                    −
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                    ,
                                    
                                    i
                                    =
                                    2
                                    ,
                                    …
                                    ,
                                    I
                                    −
                                    1
                                    .
                                 
                              
                            Then define the knots 
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                           , and
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          ν
                                       
                                    
                                    =
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          ν
                                          ]
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    
                                    ν
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    d
                                    −
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    2
                                    ,
                                    …
                                    ,
                                    I
                                    −
                                    1
                                    ,
                                 
                              
                            and choose knots 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ≤
                              ⋯
                              ≤
                              
                                 
                                    t
                                 
                                 
                                    d
                                    −
                                    1
                                 
                              
                              ≤
                              
                                 
                                    τ
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    τ
                                 
                                 
                                    I
                                 
                              
                              ≤
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          I
                                       
                                    
                                    +
                                    1
                                 
                              
                              ≤
                              ⋯
                              ≤
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          I
                                       
                                    
                                    +
                                    
                                       
                                          m
                                       
                                       
                                          I
                                          −
                                          1
                                       
                                    
                                    −
                                    1
                                 
                              
                            so that the knot sequence 
                              
                                 
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          I
                                       
                                    
                                    +
                                    d
                                    −
                                    1
                                 
                              
                            is progressive.

Now notice that for every 
                              i
                              =
                              2
                              ,
                              …
                              ,
                              I
                              −
                              1
                           , the intersection of the 
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                            sets of G-blossom parameter values in (7.3) is
                              
                                 
                                    
                                       
                                          ∩
                                       
                                       
                                          r
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    {
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    g
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          [
                                          d
                                          −
                                          r
                                          −
                                          1
                                          ]
                                       
                                    
                                    (
                                    
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    }
                                    =
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    }
                                    .
                                 
                              
                            Applying the recursive evaluation algorithm for symmetric multilinear functions to the 
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                            
                           G-blossom values in (7.3) yields
                              
                                 (7.5)
                                 
                                    (
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    ;
                                    G
                                    )
                                    =
                                    0
                                 
                              
                            for all values of the parameters 
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    1
                                 
                              
                           , 
                              i
                              =
                              2
                              ,
                              …
                              ,
                              I
                              −
                              1
                           . In particular,
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          j
                                          +
                                          d
                                       
                                    
                                    ;
                                    G
                                    )
                                    =
                                    0
                                    ,
                                    
                                    j
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    d
                                    −
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    1
                                    ,
                                 
                              
                            
                           
                              i
                              =
                              2
                              ,
                              …
                              ,
                              I
                              −
                              1
                           . Therefore the control points
                              
                                 (7.6)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          j
                                          +
                                          d
                                       
                                    
                                    ;
                                    G
                                    )
                                    ,
                                    
                                    j
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    d
                                    −
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                    ,
                                 
                              
                            
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              −
                              1
                           , are well-defined.

Let 
                              B
                              (
                              t
                              )
                            be the G-B-spline whose polynomial segments are the polynomials 
                              
                                 
                                    B
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            generated by the local G-de-Boor algorithm from the knots 
                              
                                 
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    d
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    +
                                    d
                                    −
                                    1
                                 
                              
                            and the control points 
                              
                                 
                                    {
                                    
                                       
                                          P
                                       
                                       
                                          j
                                       
                                    
                                    }
                                 
                                 
                                    j
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    d
                                    −
                                    1
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                 
                              
                            defined over the interval 
                              [
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                              ]
                              =
                              [
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ]
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              −
                              1
                           . By (7.6), the evaluation algorithms for 
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                            and 
                              
                                 
                                    B
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                            are the same; hence 
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              ≡
                              
                                 
                                    B
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                           , 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              I
                              −
                              1
                           . Therefore the piecewise polynomial curve 
                              
                                 
                                    S
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              t
                              )
                            coincides with the G-B-spline curve 
                              B
                              (
                              t
                              )
                           . □


                     
                        Corollary 7.5
                        
                           All 
                           
                              (
                              q
                              ,
                              h
                              )
                           
                           -spline curves are 
                           
                              (
                              q
                              ,
                              h
                              )
                           
                           -B-spline curves.
                        

The case 
                        (
                        q
                        ,
                        h
                        )
                        =
                        (
                        q
                        ,
                        0
                        )
                     , 
                        q
                        ≠
                        1
                      of Corollary 7.5 is Theorem 6.3 in Simeonov and Goldman (2013). The classical case 
                        (
                        q
                        ,
                        h
                        )
                        =
                        (
                        1
                        ,
                        0
                        )
                      not covered by Corollary 7.5 is treated by Theorem 7.3 in Goldman (2003).

A G-B-spline curve of degree d is a piecewise polynomial curve specified by an admissible vector 
                        G
                        (
                        t
                        )
                        =
                        (
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        t
                        )
                        )
                     , a progressive knot sequence 
                        T
                        =
                        {
                        
                           
                              t
                           
                           
                              i
                           
                        
                        }
                     , and an arbitrary set of control points 
                        {
                        
                           
                              P
                           
                           
                              j
                           
                        
                        }
                     , where each individual polynomial segment is generated by the local G-de Boor algorithm.

By construction (Definition 5.2), each segment 
                        
                           
                              B
                           
                           
                              k
                           
                        
                        (
                        t
                        )
                      of a G-B-spline curve of degree d
                     
                        
                           •
                           lies over the parameter interval 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ]
                              
                           

depends on the 2d knots 
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       −
                                       d
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       d
                                    
                                 
                              
                           

is specified by 
                                 d
                                 +
                                 1
                               control points 
                                 
                                    
                                       P
                                    
                                    
                                       k
                                       −
                                       d
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                              .

Below we list some elementary properties of G-B-spline curves:

1. Piecewise polynomial. Obvious by construction.

2. Quantum continuity of order 
                     
                        m
                        −
                        μ
                      
                     at knots of 
                     
                        (
                        q
                        ,
                        h
                        )
                      
                     -multiplicity μ when 
                     
                        G
                        (
                        t
                        )
                      
                     has 
                     
                        (
                        q
                        ,
                        h
                        )
                     
                     -multiplicity m, where 
                     
                        0
                        ≤
                        μ
                        ≤
                        m
                        ≤
                        d
                     . This property follows from Theorem 6.8.

3. Local control. On an interval 
                        [
                        
                           
                              t
                           
                           
                              k
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              k
                              +
                              1
                           
                        
                        ]
                      the values of a G-B-spline curve 
                        B
                        (
                        t
                        )
                      depend only on the control points 
                        
                           
                              P
                           
                           
                              k
                              −
                              d
                           
                        
                        ,
                        …
                        ,
                        
                           
                              P
                           
                           
                              k
                           
                        
                     . So a control point 
                        
                           
                              P
                           
                           
                              j
                           
                        
                      influences 
                        B
                        (
                        t
                        )
                      only over intervals 
                        [
                        
                           
                              t
                           
                           
                              k
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              k
                              +
                              1
                           
                        
                        ]
                      with 
                        j
                        ≤
                        k
                        ≤
                        j
                        +
                        d
                     .

Similarly, since the segment of 
                        B
                        (
                        t
                        )
                      over the interval 
                        [
                        
                           
                              t
                           
                           
                              k
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              k
                              +
                              1
                           
                        
                        ]
                      depends only on the knots 
                        
                           
                              t
                           
                           
                              k
                              −
                              d
                              +
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              t
                           
                           
                              k
                              +
                              d
                           
                        
                     , a knot 
                        
                           
                              t
                           
                           
                              j
                           
                        
                      influences 
                        B
                        (
                        t
                        )
                      only over intervals 
                        [
                        
                           
                              t
                           
                           
                              k
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              k
                              +
                              1
                           
                        
                        ]
                      with 
                        j
                        −
                        d
                        ≤
                        k
                        ≤
                        j
                        +
                        d
                        −
                        1
                     .

4. Affine invariance. Since each intermediate point in the G-de Boor algorithm is an affine combination of two other points at a lower level, applying an affine transformation to the control points will transform each intermediate point in the G-de Boor algorithm and therefore each point on the G-B-spline curve by the same affine transformation.

5. Interpolation of control points at knots of G-multiplicity d. Let 
                        B
                        (
                        t
                        )
                      be a G-B-spline curve of degree d, where 
                        G
                        (
                        t
                        )
                        =
                        (
                        t
                        ,
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                              −
                              1
                           
                        
                        (
                        t
                        )
                        )
                      is admissible. Let 
                        
                           
                              B
                           
                           
                              k
                           
                        
                        (
                        t
                        )
                      be the segment of 
                        B
                        (
                        t
                        )
                      over the interval 
                        [
                        
                           
                              t
                           
                           
                              k
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              k
                              +
                              d
                           
                        
                        ]
                      and let 
                        
                           
                              b
                           
                           
                              k
                           
                        
                        (
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              u
                           
                           
                              d
                           
                        
                        ;
                        G
                        )
                      be the G-blossom of 
                        
                           
                              B
                           
                           
                              k
                           
                        
                        (
                        t
                        )
                     . Suppose that the knots 
                        
                           
                              t
                           
                           
                              k
                           
                        
                        ,
                        …
                        ,
                        
                           
                              t
                           
                           
                              k
                              +
                              d
                              −
                              1
                           
                        
                      satisfy 
                        
                           
                              t
                           
                           
                              k
                              +
                              ν
                           
                        
                        =
                        
                           
                              g
                           
                           
                              ν
                           
                        
                        (
                        
                           
                              t
                           
                           
                              k
                           
                        
                        )
                     , 
                        ν
                        =
                        1
                        ,
                        …
                        ,
                        d
                        −
                        1
                     . Then
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    k
                                    +
                                    d
                                    −
                                    1
                                 
                              
                              ;
                              G
                              )
                              =
                              
                                 
                                    b
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                              ;
                              G
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              B
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                              .
                           
                        
                      In particular if 
                        
                           
                              g
                           
                           
                              ν
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              g
                           
                           
                              [
                              ν
                              ]
                           
                        
                        (
                        t
                        )
                     , 
                        ν
                        =
                        1
                        ,
                        …
                        ,
                        d
                        −
                        1
                      and the knots satisfy 
                        
                           
                              t
                           
                           
                              k
                              +
                              1
                           
                        
                        =
                        g
                        (
                        
                           
                              t
                           
                           
                              k
                           
                        
                        )
                      for all k, then the G-B-spline curve interpolates all of its control points.

A knot insertion algorithm is a procedure for introducing additional knots called pseudo-knots, knots where the same polynomial lies on both sides of the knot, to represent the same underlying B-spline curve. In this section, we review for completeness some basic insights from Simeonov and Goldman (2013) concerning knot insertion algorithms for quantum B-spline curves.

In order to express a B-spline curve relative to a new set of knots, the control points change, even though the curve itself remains the same. A knot insertion procedure is a technique for computing these new control points from the original control points, the original knots, and the new knots. For classical B-splines, as the knot spacing approaches zero, the control polygons generated by knot insertion converge to the original underlying B-spline curve. This convergence is what makes knot insertion such a powerful tool for analyzing the geometry of B-spline curves: as the distance between the knots approaches zero, we can effectively replace the original B-spline curve with the simple piecewise linear curve represented by the control polygons generated from a knot insertion procedure.

Many effective knot insertion algorithms are known for classical B-spline curves, including Boehm's knot insertion algorithm (Boehm, 1980), the Oslo algorithm (Cohen et al., 1980), the Lane–Riesenfeld algorithm for uniform B-splines (Lane and Riesenfeld, 1980), and Schaefer's algorithm for arbitrary B-splines (Schaefer and Goldman, 2009). All of these algorithms can be derived from blossoming, using only the symmetry and the multiaffine properties of the blossom. But as observed by Simeonov and Goldman (2013), any algorithm for classical B-spline curves derived from blossoming without invoking the diagonal property must also be valid for quantum (or G-) B-spline curves, since the symmetry and multiaffine properties hold as well for the quantum (or G-) blossoms. Therefore, Boehm's knot insertion algorithm, the Oslo algorithm, the Lane–Riesenfeld algorithm, and Schaefer's algorithm all remain valid for quantum (or G-) B-spline curves.

Nevertheless there is a problem because the control polygons generated by these knot insertion procedures for quantum (or G-) B-splines will not converge to the original underlying quantum (or G-) B-spline curves. Instead, since the knot insertion algorithms for quantum (or G-) B-spline curves are identical to the knot insertion algorithms for classical B-spline curves, as the knot spacing approaches zero these control polygons will converge to the classical B-spline curve with the original knots and the original control points. Thus we cannot use knot insertion in this naive way to analyze the geometry of quantum (or G-) B-spline curves.

Instead we will use knot insertion algorithms for quantum (or G-) B-spline curves to convert to piecewise quantum (or G-) Bézier form. For quantum (or G-) Bézier curves, there is a straightforward subdivision algorithm that generates control polygons that do converge to the quantum (or G-) Bézier curve as the length of the domain (knot interval) approaches zero (Simeonov et al., 2011, 2012; Goldman and Simeonov, in press, 2015). Now we have two choices: we can either use knot insertion to convert the original quantum (or G-) B-spline curve directly to piecewise quantum (or G-) Bézier form and then use quantum (or G-) Bézier subdivision to generate control polygons that converge to the original quantum (or G-) B-spline curve, or we can use knot insertion to generate control polygons for which the knot spacing approaches zero and then convert to piecewise quantum (or G-) Bézier form. Both of these approaches generate control polygons that converge to the original quantum (or G-) B-spline curve. Now we can replace the original quantum (or G-) B-spline curve with this piecewise linear approximation to analyze the geometry of the original quantum (or G-) B-spline curve.

To convert a quantum (or G-) B-spline curve to piecewise quantum (or G-) Bézier form, we can proceed in the following fashion. Recall from Section 4.2 that for G-Bézier curves of degree d over the interval 
                        [
                        a
                        ,
                        b
                        ]
                      with an admissible vector 
                        G
                        (
                        t
                        )
                        =
                        (
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        t
                        )
                        )
                     , the corresponding knot sequence is 
                        {
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        a
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        a
                        )
                        ,
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        b
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        b
                        )
                        }
                     . Suppose, as usual, that 
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        =
                        t
                     . Then to convert a G-B-spline curve with knots 
                        {
                        
                           
                              t
                           
                           
                              i
                           
                        
                        }
                      to piecewise G-Bézier form, we simply use any of our knot insertion algorithms to insert the knots 
                        
                           
                              g
                           
                           
                              2
                           
                        
                        (
                        
                           
                              t
                           
                           
                              k
                           
                        
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        
                           
                              t
                           
                           
                              k
                           
                        
                        )
                      in each interval 
                        [
                        
                           
                              t
                           
                           
                              k
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              k
                              +
                              1
                           
                        
                        ]
                     . The result is a control polygon for a piecewise G-Bézier curve that is identical to the original G-B-spline curve.

In this section we introduce the G-B-spline basis functions and study some of their properties. All of these results for the G-B-spline basis functions have analogues for the classical B-spline basis functions, except for Proposition 10.7 on cardinal splines. Our main tools for deriving these formulas will be the dual functional property of the G-blossom and the G-de Boor recurrences from Section 4.

Let 
                           G
                           (
                           t
                           )
                           =
                           (
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                           (
                           t
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 d
                              
                           
                           (
                           t
                           )
                           )
                         be an admissible vector and let 
                           T
                           =
                           {
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           }
                         be a progressive knot sequence. The G-B-spline basis function 
                           
                              
                                 N
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           G
                           )
                         of degree d is the G-B-spline curve generated by the local G-de Boor algorithm with control points 
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 δ
                              
                              
                                 j
                                 ,
                                 k
                              
                           
                        .

When 
                           G
                           (
                           t
                           )
                           =
                           (
                           t
                           ,
                           g
                           (
                           t
                           )
                           ,
                           …
                           ,
                           
                              
                                 g
                              
                              
                                 [
                                 d
                                 −
                                 1
                                 ]
                              
                           
                           (
                           t
                           )
                           )
                        , where 
                           g
                           (
                           t
                           )
                           =
                           q
                           t
                           +
                           h
                         with 
                           q
                           ≠
                           0
                         and 
                           (
                           q
                           ,
                           h
                           )
                           ≠
                           (
                           1
                           ,
                           0
                           )
                        , we denote the G-B-spline basis functions by 
                           
                              
                                 N
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           q
                           ,
                           h
                           )
                         and we call these functions 
                           (
                           q
                           ,
                           h
                           )
                        -B-spline basis functions.

Since a control point 
                           
                              
                                 P
                              
                              
                                 k
                              
                           
                         influences a G-B-spline curve only over the intervals 
                           [
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           ]
                         with 
                           k
                           ≤
                           j
                           ≤
                           k
                           +
                           d
                        , we have
                           
                              (10.1)
                              
                                 
                                    support
                                 
                                 
                                    (
                                    
                                       
                                          N
                                       
                                       
                                          k
                                       
                                       
                                          d
                                       
                                    
                                    (
                                    t
                                    ;
                                    T
                                    ;
                                    G
                                    )
                                    )
                                 
                                 ⊆
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       d
                                       +
                                       1
                                    
                                 
                                 ]
                                 .
                              
                           
                         Furthermore, by the local G-de Boor algorithm (4.6)–(4.7) and the definition of 
                           
                              
                                 N
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           G
                           )
                         it follows that 
                           
                              
                                 P
                              
                              
                                 k
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 P
                              
                              
                                 k
                              
                           
                         affects only the values of 
                           
                              
                                 P
                              
                              
                                 j
                              
                              
                                 s
                              
                           
                        , 
                           j
                           =
                           k
                           −
                           s
                           ,
                           …
                           ,
                           k
                        , 
                           s
                           =
                           1
                           ,
                           …
                           ,
                           d
                         whose evaluation involves only the functions 
                           
                              
                                 α
                              
                              
                                 s
                                 ,
                                 j
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       d
                                       −
                                       s
                                       +
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       j
                                       +
                                       s
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       j
                                       +
                                       d
                                       +
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       j
                                       +
                                       s
                                    
                                 
                              
                           
                        , 
                           j
                           =
                           k
                           −
                           s
                           ,
                           …
                           ,
                           k
                        , 
                           s
                           =
                           1
                           ,
                           …
                           ,
                           d
                        . Therefore 
                           
                              
                                 N
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           G
                           )
                         depends only on the knots 
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 k
                                 +
                                 d
                                 +
                                 1
                              
                           
                        .

By linearity every G-B-spline curve 
                           S
                           (
                           t
                           )
                         of degree d with progressive knots 
                           T
                           =
                           {
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           }
                         and control points 
                           {
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                           }
                         has the representation
                           
                              (10.2)
                              
                                 S
                                 (
                                 t
                                 )
                                 =
                                 
                                    ∑
                                    k
                                 
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                         Thus the functions 
                           {
                           
                              
                                 N
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           G
                           )
                           }
                         span the space of G-B-spline curves of degree d. In addition, for every j the functions 
                           
                              
                                 {
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 j
                                 −
                                 d
                              
                              
                                 j
                              
                           
                         are linearly independent over the interval 
                           [
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           ]
                        , since by (4.9) these functions form a basis for the polynomials of degree d over interval 
                           [
                           
                              
                                 t
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           ]
                        . Therefore 
                           {
                           
                              
                                 N
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           G
                           )
                           }
                         is a locally supported basis for the G-B-splines of degree d.

To introduce the dual functional property for the G-B-spline basis functions, we first need to extend the G-blossom from polynomials to splines. Let 
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           (
                           t
                           )
                         be the polynomial of degree d that represents the G-B-spline curve 
                           S
                           (
                           t
                           )
                         over the interval 
                           [
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           ]
                         and let 
                           
                              
                                 s
                              
                              
                                 k
                              
                           
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 u
                              
                              
                                 d
                              
                           
                           ;
                           G
                           )
                         be the G-blossom of 
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           (
                           t
                           )
                        . By the dual functional property (4.10)
                        
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                                 ,
                                 
                                 k
                                 −
                                 d
                                 ≤
                                 i
                                 ≤
                                 k
                                 .
                              
                           
                         Therefore
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                              
                           
                         provided that 
                           j
                           −
                           d
                           ≤
                           i
                           ≤
                           j
                         and 
                           k
                           −
                           d
                           ≤
                           i
                           ≤
                           k
                        . We define the G-blossom of 
                           S
                           (
                           t
                           )
                         evaluated at the knots 
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 d
                              
                           
                         by setting
                           
                              
                                 s
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                              
                           
                         for any index k such that 
                           i
                           ≤
                           k
                           ≤
                           i
                           +
                           d
                        . Now we have the following dual functional property for the basis functions 
                           {
                           
                              
                                 N
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           G
                           )
                           }
                        .


                        
                           Proposition 10.1
                           
                              (Dual functional property) Let 
                              
                                 S
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                               
                              be a G-B-spline curve of degree d with progressive knots 
                              
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              and control points 
                              
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                                 }
                              
                              . Then
                              
                                 
                                    (10.3)
                                    
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       s
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                          
                                       
                                       ;
                                       G
                                       )
                                       .
                                    
                                 
                               
                              Equivalently
                              
                                 
                                    (10.4)
                                    
                                       S
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∑
                                          k
                                       
                                       s
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                          
                                       
                                       ;
                                       G
                                       )
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       G
                                       )
                                       .
                                    
                                 
                              
                           

The G-de Boor algorithm generates a recurrence for the basis functions 
                           {
                           
                              
                                 N
                              
                              
                                 k
                              
                              
                                 d
                              
                           
                           (
                           t
                           ;
                           T
                           ;
                           G
                           )
                           }
                        . This recurrence is the global analogue of the local recurrence in (4.12).


                        
                           Proposition 10.2
                           
                              (G-de Boor recurrence)
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       G
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                   ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ≤
                                                   t
                                                   <
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   
                                                      otherwise
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (10.5)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       G
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             t
                                             )
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                   +
                                                   d
                                                
                                             
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       
                                          
                                             G
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                   +
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                   +
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       
                                          
                                             G
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           Let 
                                 B
                                 (
                                 t
                                 )
                               be a G-B-spline curve of degree d with control points 
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 }
                              . By (10.2) and the local G-de Boor algorithm (4.6)–(4.7)
                              
                                 
                                    (10.6)
                                    
                                       B
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∑
                                          l
                                       
                                       
                                          
                                             N
                                          
                                          
                                             l
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       G
                                       )
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          ∑
                                          l
                                       
                                       
                                          
                                             N
                                          
                                          
                                             l
                                             +
                                             1
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       
                                          
                                             G
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       )
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                               where
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             t
                                             )
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             l
                                             +
                                             1
                                          
                                          
                                             0
                                          
                                       
                                       .
                                    
                                 
                               Now (10.5) follows directly from these two equations by setting 
                                 
                                    
                                       P
                                    
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       l
                                       ,
                                       k
                                    
                                 
                              . □


                        
                           Proposition 10.3
                           
                              (Generalized G-de Boor recurrence)
                              
                                 
                                    (10.7)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       G
                                       )
                                       =
                                       
                                          ∑
                                          
                                             l
                                             =
                                             k
                                             −
                                             r
                                          
                                          k
                                       
                                       
                                          
                                             N
                                          
                                          
                                             l
                                             +
                                             r
                                          
                                          
                                             d
                                             −
                                             r
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       
                                          
                                             G
                                          
                                          
                                             d
                                             −
                                             r
                                          
                                       
                                       )
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             −
                                             l
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       t
                                       ;
                                       
                                          
                                             t
                                          
                                          
                                             l
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                             +
                                             2
                                             r
                                          
                                       
                                       ;
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             d
                                             −
                                             r
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       )
                                       ,
                                    
                                 
                               
                              
                                 r
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                              
                              .
                           


                        
                           Proof
                           Let 
                                 S
                                 (
                                 t
                                 )
                               be a G-B-spline curve with control points 
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                                 }
                               and let 
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       l
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 t
                                 )
                                 }
                               be the points defined by (4.7) in terms of the G-blossom 
                                 s
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                               of 
                                 S
                                 (
                                 t
                                 )
                              , that is
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       s
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             l
                                             +
                                             r
                                             +
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             l
                                             +
                                             d
                                          
                                       
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             d
                                             −
                                             r
                                             +
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       )
                                       ;
                                       G
                                       )
                                       ,
                                       
                                       r
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       d
                                       .
                                    
                                 
                               Then starting from the control points 
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       l
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 t
                                 )
                                 }
                               at any level 
                                 0
                                 ≤
                                 r
                                 ≤
                                 d
                               and using linearity, we can write
                                 
                                    (10.8)
                                    
                                       S
                                       (
                                       t
                                       )
                                       =
                                       
                                          ∑
                                          l
                                       
                                       
                                          
                                             N
                                          
                                          
                                             l
                                             +
                                             r
                                          
                                          
                                             d
                                             −
                                             r
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       
                                          
                                             G
                                          
                                          
                                             d
                                             −
                                             r
                                          
                                       
                                       )
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       t
                                       )
                                       .
                                    
                                 
                               Setting 
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                              , we get 
                                 S
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                               and
                                 
                                    (10.9)
                                    
                                       
                                          
                                             P
                                          
                                          
                                             l
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         k
                                                         −
                                                         l
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   t
                                                   ;
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         l
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         l
                                                         +
                                                         2
                                                         r
                                                      
                                                   
                                                   ;
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         d
                                                         −
                                                         r
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                   )
                                                   ,
                                                   
                                                
                                                
                                                   l
                                                   ∈
                                                   {
                                                   k
                                                   −
                                                   r
                                                   ,
                                                   …
                                                   ,
                                                   k
                                                   }
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   l
                                                   ∉
                                                   {
                                                   k
                                                   −
                                                   r
                                                   ,
                                                   …
                                                   ,
                                                   k
                                                   }
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                               in terms of the progressive 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       d
                                       −
                                       r
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 )
                              -basis functions 
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                    
                                       r
                                    
                                 
                               defined in Section 4.2. Substituting equation (10.9) into equation (10.8) yields formula (10.7). □


                        
                           Proposition 10.4
                           
                              (G-de Boor blossoming recurrence) Let 
                              
                                 
                                    
                                       n
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                               
                              denote the homogeneous G-blossom of the basis function 
                              
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 G
                                 )
                              
                              . Then
                              
                                 
                                    (10.10)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ;
                                                G
                                                )
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                            +
                                                            d
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ;
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                             
                                             
                                                +
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                            +
                                                            d
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                            +
                                                            d
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                   
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      d
                                                   
                                                
                                                ;
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Proof
                           By (10.2) and the G-de Boor recursive evaluation algorithm (4.3)–(4.4), the G-blossom 
                                 s
                                 (
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                               of a G-B-spline curve 
                                 S
                                 (
                                 t
                                 )
                               of degree d with control points 
                                 {
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                    
                                       0
                                    
                                 
                                 }
                               satisfies
                                 
                                    (10.11)
                                    
                                       s
                                       (
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       ;
                                       G
                                       )
                                       =
                                       
                                          ∑
                                          l
                                       
                                       
                                          
                                             n
                                          
                                          
                                             l
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       ;
                                       G
                                       )
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          ∑
                                          l
                                       
                                       
                                          
                                             n
                                          
                                          
                                             l
                                             +
                                             1
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             d
                                          
                                       
                                       ;
                                       
                                          
                                             G
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                       
                                       )
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                               where
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             l
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   t
                                                
                                                
                                                   l
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             l
                                             +
                                             1
                                          
                                          
                                             0
                                          
                                       
                                       .
                                    
                                 
                               Setting 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       l
                                       ,
                                       k
                                    
                                 
                               in the last two equations yields (10.10). □


                        
                           Proposition 10.5
                           
                              (Differentiation recurrence) Let 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              with 
                              
                                 q
                                 ≠
                                 0
                               
                              and 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              . Then
                              
                                 
                                    (10.12)
                                    
                                       
                                          
                                             D
                                          
                                          
                                             1
                                             /
                                             q
                                             ,
                                             −
                                             h
                                             /
                                             q
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       q
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             [
                                             d
                                             ]
                                          
                                          
                                             q
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                t
                                                ;
                                                T
                                                ;
                                                q
                                                ,
                                                h
                                                )
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                      +
                                                      d
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                   
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                t
                                                ;
                                                T
                                                ;
                                                q
                                                ,
                                                h
                                                )
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                      +
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           Equation (10.12) follows from (10.10) and the case 
                                 m
                                 =
                                 1
                               of (3.2) by setting in (10.10) 
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 δ
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 )
                               and 
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       ν
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       ν
                                       −
                                       2
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 1
                                 )
                              , 
                                 ν
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 d
                              . □

Using the dual functional property of the G-blossom, we can prove some additional identities for the G-B-basis functions.


                        
                           Proposition 10.6
                           
                              (Partition of unity)
                              
                                 
                                    (10.13)
                                    
                                       
                                          ∑
                                          k
                                       
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       G
                                       )
                                       =
                                       1
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           This result follows immediately from the dual functional property, Proposition 10.1, of the G-blossom applied to the constant function 
                                 S
                                 (
                                 t
                                 )
                                 ≡
                                 1
                               whose G-blossom is 
                                 s
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       d
                                    
                                 
                                 ;
                                 G
                                 )
                                 =
                                 1
                              . □


                        
                           Proposition 10.7
                           
                              (Cardinal 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                              
                              -splines) Let 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              with 
                              
                                 q
                                 ≠
                                 0
                               
                              and 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              , and suppose that the knots satisfy 
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 g
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                               
                              for all k. Then
                              
                                 
                                    (10.14)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             j
                                          
                                       
                                       ;
                                       T
                                       ;
                                       q
                                       ,
                                       h
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   j
                                                   ≠
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                   ,
                                                   
                                                
                                                
                                                   j
                                                   =
                                                   k
                                                   +
                                                   1
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Proof
                           By construction, the control points for the basis function 
                                 
                                    
                                       N
                                    
                                    
                                       k
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 ;
                                 q
                                 ,
                                 h
                                 )
                               are 
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                              . Therefore, from the diagonal property of the 
                                 (
                                 q
                                 ,
                                 h
                                 )
                              -blossom and the dual functional property, Proposition 10.1, it follows that
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ;
                                                T
                                                ;
                                                q
                                                ,
                                                h
                                                )
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                g
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      d
                                                      −
                                                      1
                                                      ]
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                                ;
                                                q
                                                ,
                                                h
                                                )
                                                =
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      d
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                      +
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                                ;
                                                q
                                                ,
                                                h
                                                )
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      j
                                                      −
                                                      1
                                                      ,
                                                      k
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                               □


                        
                           Corollary 10.8
                           
                              (Spline interpolation) Let 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              with 
                              
                                 q
                                 ≠
                                 0
                               
                              and 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              , and suppose that the knots satisfy 
                              
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 g
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                               
                              for all k. Let 
                              
                                 S
                                 (
                                 t
                                 )
                               
                              be a 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                              
                              -spline with progressive knots 
                              
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              and control points 
                              
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       j
                                    
                                 
                                 }
                              
                              . Then 
                              
                                 S
                                 (
                                 t
                                 )
                               
                              interpolates all of its control points. In particular, 
                              
                                 S
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                               
                              for all k.
                           


                        
                           Proof
                           This result follows immediately from Propositions 10.1 and 10.7. □

Here we derive an analogue of the Marsden identity for the G-B-spline basis functions. We shall also derive two important consequences of this Marsden identity: truncated powers formula for the G-B-spline basis functions and a de Boor–Fix formula for the dual functionals.


                        
                           Proposition 10.9
                           
                              (Marsden's identity)
                              
                                 
                                    (10.15)
                                    
                                       
                                          ∏
                                          
                                             j
                                             =
                                             1
                                          
                                          d
                                       
                                       (
                                       x
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                       =
                                       
                                          ∑
                                          k
                                       
                                       (
                                       x
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       )
                                       ⋯
                                       (
                                       x
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                          
                                       
                                       )
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       G
                                       )
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           The G-blossom of the polynomial 
                                 P
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 x
                                 −
                                 
                                    
                                       g
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                               is
                                 
                                    
                                       p
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             d
                                          
                                       
                                       ;
                                       G
                                       )
                                       =
                                       (
                                       x
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ⋯
                                       (
                                       x
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             d
                                          
                                       
                                       )
                                       .
                                    
                                 
                               Therefore formula (10.15) follows immediately from equation (10.4). □


                        
                           Definition 10.10
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             x
                                             −
                                             t
                                             )
                                          
                                          
                                             +
                                          
                                          
                                             m
                                          
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         x
                                                         −
                                                         t
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   ,
                                                   
                                                
                                                
                                                   x
                                                   >
                                                   t
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                
                                                
                                                   x
                                                   ≤
                                                   t
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Proposition 10.11
                           
                              (Truncated powers formula) Let 
                              
                                 G
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                               
                              be an admissible vector and let 
                              
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              be an increasing knot sequence. Then
                              
                                 
                                    (10.16)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       G
                                       )
                                       =
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       {
                                       
                                          ∏
                                          
                                             j
                                             =
                                             1
                                          
                                          d
                                       
                                       (
                                       x
                                       −
                                       
                                          
                                             g
                                          
                                          
                                             j
                                          
                                       
                                       (
                                       t
                                       )
                                       )
                                       }
                                       
                                          
                                             (
                                             x
                                             −
                                             t
                                             )
                                          
                                          
                                             +
                                          
                                          
                                             0
                                          
                                       
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             k
                                             +
                                             d
                                             +
                                             1
                                          
                                       
                                       ]
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           This result is a consequence of Marsden's identity. The proof is almost identical to the proof of the analogous result for classical B-splines in de Boor (1993) which was also applied in Budakçi et al. (2015), Theorem 5 for q-B-splines. Therefore we do not repeat this proof here. □

We finish this section with two de Boor–Fix type formulas for 
                           (
                           q
                           ,
                           h
                           )
                        -B-splines: one for the 
                           (
                           q
                           ,
                           h
                           )
                        -dual functionals and one for the 
                           (
                           q
                           ,
                           h
                           )
                        -blossom. Let 
                           g
                           (
                           t
                           )
                           =
                           q
                           t
                           +
                           h
                         with 
                           q
                           ≠
                           0
                         and 
                           (
                           q
                           ,
                           h
                           )
                           ≠
                           (
                           1
                           ,
                           0
                           )
                        . For a sequence of constants 
                           
                              
                                 {
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                                 }
                              
                              
                                 l
                                 =
                                 0
                              
                              
                                 d
                              
                           
                        , we define the corresponding bilinear bracket operator by
                           
                              (10.17)
                              
                                 
                                    
                                       [
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       d
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    ∑
                                    
                                       l
                                       =
                                       0
                                    
                                    d
                                 
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       /
                                       q
                                       ,
                                       −
                                       h
                                       /
                                       q
                                    
                                    
                                       l
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 (
                                 t
                                 )
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       /
                                       q
                                       ,
                                       −
                                       h
                                       /
                                       q
                                    
                                    
                                       d
                                       −
                                       l
                                    
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       d
                                       −
                                       l
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 .
                              
                           
                        
                     


                        
                           Lemma 10.12
                           
                              Let 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              with 
                              
                                 q
                                 ≠
                                 0
                               
                              and 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                               
                              and let 
                              
                                 
                                    
                                       [
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       d
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                               
                              be the bracket operator for a sequence 
                              
                                 
                                    
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             l
                                          
                                       
                                       }
                                    
                                    
                                       l
                                       =
                                       0
                                    
                                    
                                       d
                                    
                                 
                              
                              . Then the bracket operator satisfies the following two properties:
                           


                              1. 
                              
                                 
                                    
                                       [
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       d
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 (
                                 t
                                 )
                               
                              is a constant whenever 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                               
                              are polynomials of degree at most d;
                           


                              2. 
                              
                                 
                                    
                                       [
                                       1
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             d
                                          
                                       
                                       ]
                                    
                                    
                                       d
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 =
                                 1
                              
                              ;
                           


                              if and only if
                              
                                 
                                    (10.18)
                                    
                                       
                                          
                                             c
                                          
                                          
                                             l
                                          
                                       
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             d
                                             ,
                                             l
                                          
                                       
                                       (
                                       q
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   l
                                                
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   (
                                                   d
                                                   −
                                                   l
                                                   )
                                                   (
                                                   d
                                                   −
                                                   l
                                                   −
                                                   1
                                                   )
                                                   /
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   [
                                                   d
                                                   ]
                                                
                                                
                                                   q
                                                
                                             
                                             !
                                          
                                       
                                       ,
                                       
                                       l
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       d
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           Suppose that the bracket operator satisfies properties 1 and 2, and let 
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                               be polynomials of degree at most d. By (10.17), the product rule (2.3), and (2.12), we have
                                 
                                    (10.19)
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                      /
                                                      q
                                                      ,
                                                      −
                                                      h
                                                      /
                                                      q
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         [
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ]
                                                      
                                                      
                                                         d
                                                      
                                                      
                                                         q
                                                         ,
                                                         h
                                                      
                                                   
                                                   )
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      ν
                                                      =
                                                      0
                                                   
                                                   d
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                         /
                                                         q
                                                         ,
                                                         −
                                                         h
                                                         /
                                                         q
                                                      
                                                      
                                                         ν
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   (
                                                   t
                                                   )
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                         /
                                                         q
                                                         ,
                                                         −
                                                         h
                                                         /
                                                         q
                                                      
                                                      
                                                         d
                                                         −
                                                         ν
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         [
                                                         d
                                                         −
                                                         ν
                                                         −
                                                         1
                                                         ]
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                +
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                         /
                                                         q
                                                         ,
                                                         −
                                                         h
                                                         /
                                                         q
                                                      
                                                      
                                                         ν
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   (
                                                   t
                                                   )
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                         /
                                                         q
                                                         ,
                                                         −
                                                         h
                                                         /
                                                         q
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            1
                                                            /
                                                            q
                                                            ,
                                                            −
                                                            h
                                                            /
                                                            q
                                                         
                                                         
                                                            d
                                                            −
                                                            ν
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      (
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            [
                                                            d
                                                            −
                                                            ν
                                                            ]
                                                         
                                                      
                                                      (
                                                      t
                                                      )
                                                      )
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      ν
                                                      =
                                                      0
                                                   
                                                   d
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                         /
                                                         q
                                                         ,
                                                         −
                                                         h
                                                         /
                                                         q
                                                      
                                                      
                                                         ν
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   (
                                                   t
                                                   )
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                         /
                                                         q
                                                         ,
                                                         −
                                                         h
                                                         /
                                                         q
                                                      
                                                      
                                                         d
                                                         −
                                                         ν
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         [
                                                         d
                                                         −
                                                         ν
                                                         −
                                                         1
                                                         ]
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                +
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                         /
                                                         q
                                                         ,
                                                         −
                                                         h
                                                         /
                                                         q
                                                      
                                                      
                                                         ν
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   (
                                                   t
                                                   )
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         d
                                                         −
                                                         ν
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                         /
                                                         q
                                                         ,
                                                         −
                                                         h
                                                         /
                                                         q
                                                      
                                                      
                                                         d
                                                         −
                                                         ν
                                                         +
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                   (
                                                   
                                                      
                                                         g
                                                      
                                                      
                                                         [
                                                         d
                                                         −
                                                         ν
                                                         ]
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   )
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      ν
                                                      =
                                                      1
                                                   
                                                   d
                                                
                                                [
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ν
                                                      −
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      d
                                                      −
                                                      ν
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                ]
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                      /
                                                      q
                                                      ,
                                                      −
                                                      h
                                                      /
                                                      q
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                (
                                                t
                                                )
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                      /
                                                      q
                                                      ,
                                                      −
                                                      h
                                                      /
                                                      q
                                                   
                                                   
                                                      d
                                                      −
                                                      ν
                                                      +
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      d
                                                      −
                                                      ν
                                                      ]
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                               Setting 
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       l
                                    
                                 
                               and 
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       d
                                       −
                                       l
                                       +
                                       1
                                    
                                 
                              , by Lemma 2.3 we get 
                                 0
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       ν
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 [
                                 
                                    
                                       c
                                    
                                    
                                       ν
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       d
                                       −
                                       ν
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ν
                                    
                                 
                                 ]
                                 
                                    
                                       δ
                                    
                                    
                                       ν
                                       ,
                                       l
                                    
                                 
                              ; hence 
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       −
                                       d
                                       +
                                       l
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       l
                                       −
                                       1
                                    
                                 
                              , 
                                 l
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              . Therefore
                                 
                                    (10.20)
                                    
                                       
                                          
                                             c
                                          
                                          
                                             l
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             −
                                             1
                                             )
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             −
                                             l
                                             d
                                             +
                                             l
                                             (
                                             l
                                             +
                                             1
                                             )
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                       l
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       d
                                       .
                                    
                                 
                               We determine 
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                               from the condition 
                                 
                                    
                                       [
                                       1
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             d
                                          
                                       
                                       ]
                                    
                                    
                                       d
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 =
                                 1
                              . From Lemma 2.3 with 
                                 (
                                 q
                                 ,
                                 h
                                 )
                               replaced by 
                                 (
                                 1
                                 /
                                 q
                                 ,
                                 −
                                 h
                                 /
                                 q
                                 )
                               it follows that 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       /
                                       q
                                       ,
                                       −
                                       h
                                       /
                                       q
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       [
                                       d
                                       ]
                                    
                                    
                                       1
                                       /
                                       q
                                    
                                 
                                 !
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       −
                                       d
                                       (
                                       d
                                       −
                                       1
                                       )
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       [
                                       d
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 !
                              . Therefore by (10.17) we get 
                                 1
                                 =
                                 
                                    
                                       [
                                       1
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             d
                                          
                                       
                                       ]
                                    
                                    
                                       d
                                    
                                    
                                       q
                                       ,
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       −
                                       d
                                       (
                                       d
                                       −
                                       1
                                       )
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       [
                                       d
                                       ]
                                    
                                    
                                       q
                                    
                                 
                                 !
                              , which together with (10.20) yields (10.18).

To prove the converse, we first note that the case 
                                 l
                                 =
                                 0
                               of (10.18) implies property 2. To show that (10.18) implies property 1, we follow the proof forward omitting the 0= at the start of (10.19) and then inserting the values of the c's from (10.18) in the last line of (10.19) to obtain 0 for the quantum derivative. □

In the remainder of this section we shall assume that the coefficients 
                           
                              
                                 {
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                                 }
                              
                              
                                 l
                                 =
                                 0
                              
                              
                                 d
                              
                           
                         of the bracket operator (10.17) are defined by (10.18).


                        
                           Proposition 10.13
                           
                              Let 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              with 
                              
                                 q
                                 ≠
                                 0
                               
                              and 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              , and set 
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 t
                                 ,
                                 x
                                 ;
                                 q
                                 ,
                                 h
                                 )
                                 =
                                 1
                               
                              and 
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ,
                                 x
                                 ;
                                 q
                                 ,
                                 h
                                 )
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       0
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 (
                                 x
                                 −
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       l
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              
                              , 
                              
                                 d
                                 ≥
                                 1
                              
                              . Then for any polynomial 
                              
                                 P
                                 (
                                 t
                                 )
                               
                              of degree at most d
                              
                                 
                                    (10.21)
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   ψ
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             t
                                             ,
                                             x
                                             ;
                                             q
                                             ,
                                             h
                                             )
                                             ,
                                             P
                                             (
                                             t
                                             )
                                             ]
                                          
                                          
                                             d
                                          
                                          
                                             q
                                             ,
                                             h
                                          
                                       
                                       =
                                       P
                                       (
                                       x
                                       )
                                    
                                 
                               
                              and
                              
                                 
                                    (10.22)
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   ψ
                                                
                                                
                                                   d
                                                   −
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   [
                                                   r
                                                   ]
                                                
                                             
                                             (
                                             t
                                             )
                                             ,
                                             x
                                             ;
                                             q
                                             ,
                                             h
                                             )
                                             ,
                                             P
                                             (
                                             t
                                             )
                                             ]
                                          
                                          
                                             d
                                          
                                          
                                             q
                                             ,
                                             h
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   [
                                                   d
                                                   −
                                                   r
                                                   ]
                                                
                                                
                                                   1
                                                   /
                                                   q
                                                
                                             
                                             !
                                          
                                          
                                             
                                                
                                                   [
                                                   d
                                                   ]
                                                
                                                
                                                   1
                                                   /
                                                   q
                                                
                                             
                                             !
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             1
                                             /
                                             q
                                             ,
                                             −
                                             h
                                             /
                                             q
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       P
                                       )
                                       (
                                       x
                                       )
                                       ,
                                    
                                 
                               
                              
                                 r
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                              
                              .
                           


                        
                           Proof
                           By Lemma 10.12 and equations (10.17) and (3.5), the expression
                                 
                                    (10.23)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            ψ
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      (
                                                      t
                                                      ,
                                                      x
                                                      ;
                                                      q
                                                      ,
                                                      h
                                                      )
                                                      ,
                                                      P
                                                      (
                                                      t
                                                      )
                                                      ]
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      q
                                                      ,
                                                      h
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      0
                                                   
                                                   d
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      d
                                                      ,
                                                      l
                                                   
                                                
                                                (
                                                q
                                                ,
                                                h
                                                )
                                                
                                                   
                                                      (
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      l
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            [
                                                            d
                                                            ]
                                                         
                                                         
                                                            q
                                                         
                                                      
                                                      !
                                                   
                                                   
                                                      
                                                         
                                                            [
                                                            d
                                                            −
                                                            l
                                                            ]
                                                         
                                                         
                                                            q
                                                         
                                                      
                                                      !
                                                   
                                                
                                                
                                                   
                                                      ψ
                                                   
                                                   
                                                      d
                                                      −
                                                      l
                                                   
                                                
                                                (
                                                t
                                                ,
                                                x
                                                ;
                                                q
                                                ,
                                                h
                                                )
                                             
                                          
                                          
                                             
                                             
                                             
                                                ×
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      1
                                                      /
                                                      q
                                                      ,
                                                      −
                                                      h
                                                      /
                                                      q
                                                   
                                                   
                                                      d
                                                      −
                                                      l
                                                   
                                                
                                                (
                                                P
                                                )
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      [
                                                      d
                                                      −
                                                      l
                                                      ]
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                          
                                       
                                    
                                 
                               is a function 
                                 C
                                 (
                                 x
                                 )
                               independent of t. Now notice that 
                                 
                                    
                                       ψ
                                    
                                    
                                       l
                                    
                                 
                                 (
                                 x
                                 ,
                                 x
                                 ;
                                 q
                                 ,
                                 h
                                 )
                                 =
                                 0
                               when 
                                 l
                                 ≥
                                 1
                              . Thus, setting 
                                 t
                                 =
                                 x
                               in (10.23) yields
                                 
                                    
                                       C
                                       (
                                       x
                                       )
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             d
                                             ,
                                             d
                                          
                                       
                                       (
                                       q
                                       ,
                                       h
                                       )
                                       
                                          
                                             (
                                             −
                                             1
                                             )
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             [
                                             d
                                             ]
                                          
                                          
                                             q
                                          
                                       
                                       !
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       x
                                       ,
                                       x
                                       ;
                                       q
                                       ,
                                       h
                                       )
                                       P
                                       (
                                       x
                                       )
                                       =
                                       P
                                       (
                                       x
                                       )
                                       .
                                    
                                 
                               Formula (10.22) is derived by applying 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       /
                                       q
                                       ,
                                       −
                                       h
                                       /
                                       q
                                       ,
                                       x
                                    
                                    
                                       r
                                    
                                 
                               to (10.21) and using (10.17) along with the fact that 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       /
                                       q
                                       ,
                                       −
                                       h
                                       /
                                       q
                                       ,
                                       x
                                    
                                 
                               and 
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       /
                                       q
                                       ,
                                       −
                                       h
                                       /
                                       q
                                       ,
                                       t
                                    
                                 
                               commute, and (3.6). □

For our next result we need a simple lemma.


                        
                           Lemma 10.14
                           
                              Let 
                              
                                 T
                                 =
                                 
                                    
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       2
                                       d
                                    
                                 
                               
                              be a progressive knot sequence. Then the polynomials defined by 
                              
                                 
                                    
                                       p
                                    
                                    
                                       d
                                       ,
                                       i
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 )
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       l
                                    
                                 
                                 )
                              
                              , 
                              
                                 i
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                              
                              , are linearly independent.
                           


                        
                           Proof
                           We use induction on d. For 
                                 d
                                 =
                                 1
                               the result is straightforward. Next suppose that the lemma is true for some 
                                 d
                                 −
                                 1
                                 ≥
                                 1
                              . Since, by assumption, 
                                 T
                                 =
                                 
                                    
                                       {
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       2
                                       d
                                    
                                 
                               is a progressive knot sequence, 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ≠
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                               for all 
                                 i
                                 ≤
                                 d
                                 <
                                 j
                                 ≤
                                 i
                                 +
                                 d
                              . Suppose that there exist constants 
                                 
                                    
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       d
                                    
                                 
                               such that 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       d
                                       ,
                                       i
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 )
                                 =
                                 0
                               for all t. Setting 
                                 t
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                               yields 
                                 
                                    
                                       c
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       d
                                       +
                                       l
                                    
                                 
                                 )
                                 =
                                 0
                              , hence 
                                 
                                    
                                       c
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 0
                              . Thus 
                                 (
                                 t
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       d
                                       −
                                       1
                                       ,
                                       i
                                    
                                 
                                 (
                                 t
                                 ;
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 0
                              , where 
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       2
                                       d
                                       −
                                       1
                                    
                                 
                                 }
                               is a progressive sequence. Therefore by the inductive hypothesis 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              , 
                                 i
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                                 −
                                 1
                              . □


                        
                           Proposition 10.15
                           
                              (de Boor–Fix formula for the dual functionals) Let 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              with 
                              
                                 q
                                 ≠
                                 0
                               
                              and 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              . Let 
                              
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              be a progressive knot sequence and set 
                              
                                 
                                    
                                       p
                                    
                                    
                                       d
                                       ,
                                       i
                                    
                                 
                                 (
                                 t
                                 ;
                                 T
                                 )
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 −
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       l
                                    
                                 
                                 )
                              
                              . Then
                              
                                 
                                    (10.24)
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             t
                                             ;
                                             T
                                             ;
                                             q
                                             ,
                                             h
                                             )
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   d
                                                   ,
                                                   i
                                                
                                             
                                             (
                                             t
                                             ;
                                             T
                                             )
                                             ]
                                          
                                          
                                             d
                                          
                                          
                                             q
                                             ,
                                             h
                                          
                                       
                                       =
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                             ,
                                             i
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           Let 
                                 t
                                 ∈
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 ]
                               and let 
                                 
                                    
                                       ψ
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 t
                                 ,
                                 x
                                 ;
                                 q
                                 ,
                                 h
                                 )
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       l
                                       =
                                       0
                                    
                                    
                                       d
                                       −
                                       1
                                    
                                 
                                 (
                                 x
                                 −
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       l
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              , 
                                 d
                                 ≥
                                 1
                              , 
                                 
                                    
                                       ψ
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 t
                                 ,
                                 x
                                 ;
                                 q
                                 ,
                                 h
                                 )
                                 =
                                 1
                              . From (10.1) and Marsden's identity (10.15) it follows that
                                 
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ,
                                       x
                                       ;
                                       q
                                       ,
                                       h
                                       )
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             j
                                             −
                                             d
                                          
                                          j
                                       
                                       
                                          
                                             p
                                          
                                          
                                             d
                                             ,
                                             k
                                          
                                       
                                       (
                                       x
                                       ;
                                       T
                                       )
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                          
                                             d
                                          
                                       
                                       (
                                       t
                                       ;
                                       T
                                       ;
                                       q
                                       ,
                                       h
                                       )
                                       .
                                    
                                 
                               Applying (10.21) to 
                                 P
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       d
                                       ,
                                       i
                                    
                                 
                                 (
                                 x
                                 ;
                                 T
                                 )
                              , we get
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      d
                                                      ,
                                                      i
                                                   
                                                
                                                (
                                                x
                                                ;
                                                T
                                                )
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            ψ
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      (
                                                      t
                                                      ,
                                                      x
                                                      ;
                                                      q
                                                      ,
                                                      h
                                                      )
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            d
                                                            ,
                                                            i
                                                         
                                                      
                                                      (
                                                      t
                                                      ;
                                                      T
                                                      )
                                                      ]
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      q
                                                      ,
                                                      h
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      j
                                                      −
                                                      d
                                                   
                                                   j
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      d
                                                      ,
                                                      k
                                                   
                                                
                                                (
                                                x
                                                ;
                                                T
                                                )
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      (
                                                      t
                                                      ;
                                                      T
                                                      ;
                                                      q
                                                      ,
                                                      h
                                                      )
                                                      ,
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            d
                                                            ,
                                                            i
                                                         
                                                      
                                                      (
                                                      t
                                                      ;
                                                      T
                                                      )
                                                      ]
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      q
                                                      ,
                                                      h
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                               Now (10.24) follows from Lemma 10.14. □


                        
                           Proposition 10.16
                           
                              (de Boor–Fix formula for the 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                              
                              -blossom) Let 
                              
                                 g
                                 (
                                 t
                                 )
                                 =
                                 q
                                 t
                                 +
                                 h
                               
                              with 
                              
                                 q
                                 ≠
                                 0
                               
                              and 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                                 ≠
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              , and let 
                              
                                 T
                                 =
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 }
                               
                              be a progressive knot sequence. Then for every polynomial 
                              
                                 P
                                 (
                                 t
                                 )
                               
                              of degree d, the 
                              
                                 (
                                 q
                                 ,
                                 h
                                 )
                              
                              -blossom of 
                              
                                 P
                                 (
                                 t
                                 )
                               
                              is given by
                              
                                 
                                    (10.25)
                                    
                                       p
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             d
                                          
                                       
                                       ;
                                       q
                                       ,
                                       h
                                       )
                                       =
                                       
                                          
                                             q
                                          
                                          
                                             −
                                             d
                                             (
                                             d
                                             −
                                             1
                                             )
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             [
                                             
                                             
                                                ∏
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                d
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   [
                                                   d
                                                   −
                                                   1
                                                   ]
                                                
                                             
                                             (
                                             t
                                             )
                                             )
                                             ,
                                             P
                                             (
                                             t
                                             )
                                             ]
                                          
                                          
                                             d
                                          
                                          
                                             q
                                             ,
                                             h
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           To verify (10.25) first notice that the right-hand side of (10.25) is a symmetric and multiaffine function of 
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       d
                                    
                                 
                              . Moreover, setting 
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       j
                                       −
                                       1
                                       ]
                                    
                                 
                                 (
                                 x
                                 )
                              , 
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                               on the right-hand side of (10.25), using the fact that 
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       d
                                       −
                                       1
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       j
                                       −
                                       1
                                       ]
                                    
                                 
                                 (
                                 
                                    
                                       g
                                    
                                    
                                       [
                                       d
                                       −
                                       j
                                       ]
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                              , and applying (2.9) and (10.21), we obtain
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             −
                                             d
                                             (
                                             d
                                             −
                                             1
                                             )
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             [
                                             
                                             
                                                ∏
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                d
                                             
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   [
                                                   j
                                                   −
                                                   1
                                                   ]
                                                
                                             
                                             (
                                             x
                                             )
                                             −
                                             
                                                
                                                   g
                                                
                                                
                                                   [
                                                   d
                                                   −
                                                   1
                                                   ]
                                                
                                             
                                             (
                                             t
                                             )
                                             )
                                             ,
                                             P
                                             (
                                             t
                                             )
                                             ]
                                          
                                          
                                             d
                                          
                                          
                                             q
                                             ,
                                             h
                                          
                                       
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   ψ
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             t
                                             ,
                                             x
                                             ;
                                             q
                                             ,
                                             h
                                             )
                                             ,
                                             P
                                             (
                                             t
                                             )
                                             ]
                                          
                                          
                                             d
                                          
                                          
                                             q
                                             ,
                                             h
                                          
                                       
                                       =
                                       P
                                       (
                                       x
                                       )
                                       .
                                    
                                 
                                □

@&#ACKNOWLEDGEMENT@&#

Plamen Simeonov's research was supported by 2014 and 2015 ORCA awards from the University of Houston–Downtown.

Here we shall demonstrate that, unlike classical splines (Goldman, 2003), and q-splines and h-splines (Simeonov and Goldman, 2013), not every G-spline can be represented by a G-B-spline. To demonstrate this fact, we will first derive a necessary condition for a G-spline to be a G-B-spline. Then we will give an example of a cubic G-spline that does not satisfy this necessary condition and therefore is not a G-B-spline.

Let 
                        G
                        (
                        t
                        )
                        =
                        (
                        
                           
                              g
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ,
                        …
                        ,
                        
                           
                              g
                           
                           
                              d
                           
                        
                        (
                        t
                        )
                        )
                      be an admissible vector and 
                        S
                        (
                        t
                        )
                      be a G-spline that is also a G-B-spline. Then there exists a progressive knot sequence 
                        {
                        
                           
                              t
                           
                           
                              k
                           
                        
                        }
                      and a sequence of control points 
                        {
                        
                           
                              P
                           
                           
                              j
                           
                        
                        }
                      for which the corresponding G-B-spline 
                        B
                        (
                        t
                        )
                      is identical to the G-spline 
                        S
                        (
                        t
                        )
                     . As usual let 
                        
                           
                              B
                           
                           
                              k
                           
                        
                        (
                        t
                        )
                      be a non-empty segment of 
                        B
                        (
                        t
                        )
                      generated by the local G-de Boor algorithm from the knots 
                        
                           
                              t
                           
                           
                              k
                              −
                              d
                              +
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              t
                           
                           
                              k
                              +
                              d
                           
                        
                      and the control points 
                        
                           
                              P
                           
                           
                              k
                              −
                              d
                           
                        
                        ,
                        …
                        ,
                        
                           
                              P
                           
                           
                              k
                           
                        
                     . For each segment 
                        
                           
                              S
                           
                           
                              i
                           
                        
                        (
                        t
                        )
                      of 
                        S
                        (
                        t
                        )
                      there is an index 
                        
                           
                              k
                           
                           
                              i
                           
                        
                      (see below) such that 
                        
                           
                              S
                           
                           
                              i
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              B
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              1
                           
                        
                        (
                        t
                        )
                      on the interval 
                        [
                        
                           
                              t
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                        
                        ]
                        =
                        [
                        
                           
                              τ
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              τ
                           
                           
                              i
                              +
                              1
                           
                        
                        ]
                     .

By Definition 7.1, for every 
                        2
                        ≤
                        i
                        ≤
                        I
                        −
                        1
                      there exists a set 
                        
                           
                              J
                           
                           
                              i
                           
                        
                        ⊆
                        {
                        1
                        ,
                        …
                        ,
                        d
                        }
                     , 
                        |
                        
                           
                              J
                           
                           
                              i
                           
                        
                        |
                        =
                        
                           
                              m
                           
                           
                              i
                           
                        
                     , such that
                        
                           (A.1)
                           
                              
                                 
                                    D
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    r
                                 
                              
                              (
                              
                                 
                                    B
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                 
                              
                              −
                              
                                 
                                    B
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    1
                                 
                              
                              )
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    D
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    r
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    S
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              0
                              ,
                              
                              r
                              =
                              0
                              ,
                              …
                              ,
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              −
                              1
                              .
                           
                        
                      We shall now assume that the values 
                        
                           
                              {
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                              }
                           
                           
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                           
                        
                      are distinct. Then by Proposition 2.4, equation (A.1) is equivalent to
                        
                           (A.2)
                           
                              (
                              
                                 
                                    B
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                 
                              
                              −
                              
                                 
                                    B
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    1
                                 
                              
                              )
                              (
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                              =
                              (
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    S
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                              (
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                              =
                              0
                              ,
                              
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                      It is known that for standard B-splines in the presence of multiple knots (Goldman, 2003) (as well as for quantum q-B-splines in the presence of q-multiple knots (Simeonov and Goldman, 2013) and for the G-B-splines discussed in Theorems 6.8 and 6.9) the order of smoothness (quantum smoothness) of two adjacent segments of a B-spline (q-B-spline) of degree d at the join is m when the indices of these segments differ by 
                        d
                        −
                        m
                        +
                        1
                     . Thus we shall define the numbers 
                        {
                        
                           
                              k
                           
                           
                              i
                           
                        
                        }
                      by (7.4).

Let 
                        
                           
                              s
                           
                           
                              i
                           
                        
                        (
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              u
                           
                           
                              d
                           
                        
                        ;
                        G
                        )
                      be the G-blossom of 
                        
                           
                              S
                           
                           
                              i
                           
                        
                        (
                        t
                        )
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        I
                        −
                        1
                     . By the dual functional property of the G-blossom applied to the common control points of 
                        
                           
                              B
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              −
                              1
                           
                        
                        (
                        t
                        )
                      and 
                        
                           
                              B
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              1
                           
                        
                        (
                        t
                        )
                     , we have
                        
                           (A.3)
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    d
                                 
                              
                              ;
                              G
                              )
                              =
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    j
                                    +
                                    d
                                 
                              
                              ;
                              G
                              )
                              ,
                           
                        
                      
                     
                        
                           
                              k
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        d
                        −
                        1
                        ≤
                        j
                        ≤
                        
                           
                              k
                           
                           
                              i
                           
                        
                        −
                        1
                     . The common knots that appear in (A.3) are 
                        
                           
                              t
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                           
                        
                        =
                        
                           
                              τ
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              t
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              t
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              1
                           
                        
                     , and by (7.4) their number is 
                        
                           
                              k
                           
                           
                              i
                              +
                              1
                           
                        
                        −
                        
                           
                              k
                           
                           
                              i
                           
                        
                        =
                        d
                        −
                        
                           
                              m
                           
                           
                              i
                           
                        
                        +
                        1
                     . From (A.3) and the recursive evaluation algorithm for symmetric multiaffine functions it follows that
                        
                           (A.4)
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    s
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                    −
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              ;
                              G
                              )
                              =
                              0
                           
                        
                      for all values of the G-blossom variables 
                        
                           
                              u
                           
                           
                              d
                              −
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              +
                              2
                           
                        
                        ,
                        …
                        ,
                        
                           
                              u
                           
                           
                              d
                           
                        
                     . Let
                        
                           (A.5)
                           
                              (
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    s
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              ;
                              G
                              )
                              =
                              
                                 ∑
                                 
                                    k
                                    =
                                    0
                                 
                                 d
                              
                              
                                 
                                    A
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    d
                                    ,
                                    k
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              )
                              ,
                           
                        
                      where 
                        
                           
                              {
                              
                                 
                                    φ
                                 
                                 
                                    d
                                    ,
                                    k
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    d
                                 
                              
                              )
                              }
                           
                           
                              k
                              =
                              0
                           
                           
                              d
                           
                        
                      are the elementary symmetric functions defined by (3.1).


                     
                        Lemma A.1
                        
                           
                              
                                 (A.6)
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          0
                                       
                                       d
                                    
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          d
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          r
                                          =
                                          0
                                       
                                       m
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          m
                                          ,
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          d
                                          −
                                          m
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    
                                       ∑
                                       
                                          l
                                          =
                                          0
                                       
                                       
                                          d
                                          −
                                          m
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          r
                                          +
                                          l
                                       
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          d
                                          −
                                          m
                                          ,
                                          l
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                          −
                                          m
                                       
                                    
                                    )
                                    ,
                                 
                              
                            
                           
                              m
                              =
                              0
                              ,
                              …
                              ,
                              d
                           
                           .
                        


                     
                        Proof
                        Formula (A.6) follows immediately by linearity from the identity
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          d
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    =
                                    
                                       ∑
                                       
                                          r
                                          =
                                          max
                                          ⁡
                                          {
                                          0
                                          ,
                                          m
                                          +
                                          k
                                          −
                                          d
                                          }
                                       
                                       
                                          min
                                          ⁡
                                          {
                                          m
                                          ,
                                          k
                                          }
                                       
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          m
                                          ,
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          d
                                          −
                                          m
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                       
                                    
                                    )
                                    
                                       
                                          φ
                                       
                                       
                                          d
                                          −
                                          m
                                          ,
                                          k
                                          −
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          d
                                          −
                                          m
                                       
                                    
                                    )
                                    .
                                 
                              
                             □

By (A.5) and Lemma A.1, (A.4) holds for all values of the G-blossom variables if and only if the 
                        d
                        −
                        
                           
                              m
                           
                           
                              i
                           
                        
                      knots 
                        
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              }
                           
                           
                              k
                              =
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              1
                           
                        
                      satisfy the system
                        
                           (A.7)
                           
                              
                                 ∑
                                 
                                    l
                                    =
                                    0
                                 
                                 
                                    d
                                    −
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    r
                                    +
                                    l
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    d
                                    −
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                    ,
                                    l
                                 
                              
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                 
                              
                              )
                              =
                              0
                              ,
                           
                        
                      
                     
                        r
                        =
                        0
                        ,
                        …
                        ,
                        
                           
                              m
                           
                           
                              i
                           
                        
                        −
                        1
                      (to derive (A.7) set all G-blossom variables in (A.4) equal to a variable u). On the other hand by (A.2), the diagonal property of the G-blossom, and (A.5) the coefficients 
                        {
                        
                           
                              A
                           
                           
                              k
                           
                        
                        }
                      satisfy the system of constraints
                        
                           (A.8)
                           
                              
                                 ∑
                                 
                                    k
                                    =
                                    0
                                 
                                 d
                              
                              
                                 
                                    A
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    d
                                    ,
                                    k
                                 
                              
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    d
                                 
                              
                              (
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                              )
                              =
                              0
                              ,
                              
                              j
                              ∈
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                              .
                           
                        
                     
                  

Now we are ready to give the example promised at the start of the Appendix. With this example we will show that the system (A.7) with the constraints (A.8) does not always have a solution.


                     
                        Example
                        Let 
                              G
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              ,
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                              (
                              t
                              )
                              ,
                              
                                 
                                    g
                                 
                                 
                                    3
                                 
                              
                              (
                              t
                              )
                              )
                            be an admissible vector with 
                              
                                 
                                    g
                                 
                                 
                                    j
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                              
                              t
                              +
                              
                                 
                                    h
                                 
                                 
                                    j
                                 
                              
                           , 
                              j
                              =
                              1
                              ,
                              2
                              ,
                              3
                           . Suppose that for some i, 
                              
                                 
                                    J
                                 
                                 
                                    i
                                 
                              
                              =
                              {
                              1
                              ,
                              2
                              }
                           , 
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                              =
                              τ
                              ≠
                              0
                           , and set 
                              L
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    S
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                              (
                              t
                              )
                           . Assume that 
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              τ
                              )
                              ≠
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              τ
                              )
                           . Then by (A.2), 
                              L
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              τ
                              )
                              )
                              =
                              L
                              (
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              τ
                              )
                              )
                              =
                              0
                           . Assume also that 
                              L
                              (
                              t
                              )
                            is a polynomial of exact degree 3. Then up to a constant factor
                              
                                 
                                    L
                                    (
                                    t
                                    )
                                    =
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    τ
                                    )
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    τ
                                    )
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    c
                                    )
                                    .
                                 
                              
                            The G-blossom of 
                              L
                              (
                              t
                              )
                            can be written as
                              
                                 (A.9)
                                 
                                    l
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    =
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    τ
                                    )
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    τ
                                    )
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    τ
                                    )
                                    +
                                    (
                                    τ
                                    −
                                    c
                                    )
                                    
                                       ∑
                                       
                                          k
                                          =
                                          0
                                       
                                       2
                                    
                                    
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          3
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    τ
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    τ
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    τ
                                    )
                                    ,
                                 
                              
                            where
                              
                                 (A.10)
                                 
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    τ
                                    )
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    τ
                                    )
                                    =
                                    
                                       ∑
                                       
                                          k
                                          =
                                          0
                                       
                                       2
                                    
                                    
                                       
                                          a
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          φ
                                       
                                       
                                          3
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    τ
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    τ
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    τ
                                    )
                                    .
                                 
                              
                            If (A.4) holds, there exists a value 
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    τ
                                 
                                 
                                    ′
                                 
                              
                            such that 
                              l
                              (
                              τ
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                              )
                              =
                              0
                            for all values of 
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                           . Assume that 
                              c
                              ≠
                              τ
                           . From (A.9) it follows that
                              
                                 
                                    l
                                    (
                                    τ
                                    ,
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    /
                                    (
                                    τ
                                    −
                                    c
                                    )
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    τ
                                    )
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    τ
                                    )
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    2
                                    τ
                                    )
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    0
                                 
                              
                            for all values of 
                              
                                 
                                    u
                                 
                                 
                                    3
                                 
                              
                           . Therefore
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    τ
                                    )
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    0
                                    
                                    and
                                    
                                    −
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    τ
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    τ
                                    )
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    2
                                    τ
                                    )
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                              
                            or equivalently
                              
                                 (A.11)
                                 
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    τ
                                    )
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    0
                                    
                                    and
                                    
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    τ
                                    )
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                            From (A.11) and (A.10) it follows that 
                              
                                 
                                    τ
                                 
                                 
                                    ′
                                 
                              
                              ≠
                              τ
                           , since 
                              
                                 
                                    τ
                                 
                                 
                                    ′
                                 
                              
                              =
                              τ
                            would imply 
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              τ
                              )
                              =
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              τ
                              )
                            which contradicts our earlier assumption that 
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              τ
                              )
                              ≠
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              τ
                              )
                           . Then (A.11) and (A.10) imply 
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                              ≠
                              0
                           , 
                              k
                              =
                              0
                              ,
                              1
                              ,
                              2
                           , while by (A.11) we have
                              
                                 (A.12)
                                 
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            Now assume that 
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                              =
                              0
                           . Equating the coefficients of equal powers of t on both sides of (A.10), we obtain the system
                              
                                 (A.13)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      3
                                                      ,
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                −
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                τ
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                −
                                                2
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      3
                                                      ,
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                τ
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      3
                                                      ,
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                             
                                             
                                                =
                                                
                                             
                                             
                                                3
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                3
                                                τ
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      0
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            In the case 
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                              =
                              1
                           , 
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                              =
                              q
                              ≠
                              2
                           , 
                              
                                 
                                    q
                                 
                                 
                                    3
                                 
                              
                              =
                              2
                              q
                           , the solution of this system is
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          2
                                          q
                                          +
                                          3
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          −
                                          2
                                          
                                             
                                                q
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          q
                                          −
                                          1
                                          )
                                          τ
                                       
                                       
                                          (
                                          2
                                          q
                                          +
                                          3
                                          )
                                          (
                                          3
                                          q
                                          +
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          a
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          5
                                          q
                                          −
                                          3
                                          )
                                          
                                             
                                                τ
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          (
                                          2
                                          q
                                          +
                                          3
                                          )
                                          (
                                          3
                                          q
                                          +
                                          1
                                          )
                                       
                                    
                                    ,
                                 
                              
                            which clearly does not satisfy (A.12).

It is easy to check that when 
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                              =
                              1
                           , 
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                              =
                              q
                              ≠
                              1
                           , and 
                              
                                 
                                    q
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                           , the solution of system (A.13) satisfies equation (A.12), which is to be expected, since according to Theorem 7.4 no contradiction should occur in this case.

@&#REFERENCES@&#

