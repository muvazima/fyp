@&#MAIN-TITLE@&#Branch-and-price algorithm for the Resilient Multi-level Hop-constrained Network Design

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose three mathematical formulations to model the Resilient Multi-level Hop-constrained Network Design problem.


                        
                        
                           
                           We evaluate the performance of algorithms based on the proposed formulations.


                        
                        
                           
                           We show that two formulations are equivalent and provide the same bounds for the problem.


                        
                        
                           
                           A Branch-and-price approach for the problem presents a much better performance than other traditional optimization tools


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Integer programming

Branch-and-price

Multi-level

Resilience

Hop-constrained

@&#ABSTRACT@&#


               
               
                  In this work, we investigate the Resilient Multi-level Hop-constrained Network Design (RMHND) problem, which consists of designing hierarchical telecommunication networks, assuring resilience against random failures and maximum delay guarantees in the communication. Three mathematical formulations are proposed and algorithms based on the proposed formulations are evaluated. A Branch-and-price algorithm, which is based on a delayed column generation approach within a Branch-and-bound framework, is proven to work well, finding optimal solutions for practical telecommunication scenarios within reasonable time. Computational results show that algorithms based on the compact formulations are able to prove optimality for instances of limited size in the scenarios of interest while the proposed Branch-and-price algorithm exhibits a much better performance.
               
            

@&#INTRODUCTION@&#

Network Design problems arise in diverse settings ranging from telecommunication to transportation planning. In the telecommunication context, we have been facing evolving technologies which offer a variety of services such as audio, video and general data transmission. The increasing demand from customers and the concern about service reliability in order to avoid customer dissatisfaction require grades of organization, leading to a hierarchical telecommunication network. The basic idea is that priorities are associated to sets of customers so that network providers can offer higher levels of service in both serviceability (e.g., low delay, high bandwidth) and survivability (failure protection) to certain key customers.

The need to integrate priorities in the design of networks has led to the introduction by Balakrishnan et al. (1991) of the Multi-level Network Design (MLND) problem. This problem generalizes several well-known optimization models and addresses design decisions for hierarchical telecommunication, transportation, and electrical power distribution networks. The nodes of the network under consideration have different levels of importance (priorities are associated with the nodes), requiring different levels of facilities in communication. More precisely, the problem is defined over an undirected graph whose nodes are partitioned into L levels; each edge can contain one of the L different levels of facility, with higher priority levels having higher fixed costs. The goal is to select a connected subset of edges assigned to a facility level so that each origin–destination pair communicate via its minimal necessary level or higher-priority level facilities, minimizing the total cost of the assignment. This paper investigates the application of Integer Programming techniques to the Resilient Multi-level Hop-constrained Network Design (RMHND), an extension of MLND, in which the subgraph of selected edges must include at least two edge-disjoint paths with at most H hops for each pair of nodes, i.e., single-edge failure resilience and a maximum delay are assured.


                     Fig. 1
                      shows a RMHND example for a network with 16 nodes, two sets of nodes and edges (two different levels) and a hop constraint where H
                     =9. Fig. 1a depicts the original network, in which dotted lines represent the edges that might be included in the solution. Fig. 1b displays the resulting network for the RMHND. Let us consider, for instance, pair (5,14), where nodes 5 and 14 belong to the first level (the higher priority level with higher fixed costs). Note that two edge-disjoint paths using only first level technology edges are available, one with 4 hops (5-9-10-13-14) and another with 6 hops (5-6-7-8-12-11-14). Taking pair (2,16), where both nodes belong to the second level, we can also observe two edge-disjoint paths. The first path, represented by (2-3-4-8-12-16) with 5 hops and the second path (2-1-5-9-10-13-14-11-15-16) with 9 hops, cross edges of its minimal required level (second one) or a higher-priority level (the first level). It is important to point out that two edge-disjoint paths are available for any pair of nodes.

In the present study, we devise two compact formulations for the RMHND which solution is accomplished by solving a Mixed Integer Program (MIP) to optimality through a Branch-and-bound (BB) solver. Given the complexity of the problem, the main drawback of both compact formulations of a MIP is certainly the very limited size of the instances likely to be solved. In order to overcome this, we propose a column generation embedded in a Branch-and-bound algorithm, leading to an exact Branch-and-price (BP) algorithm, which has been applied successfully in the solution of large-scale problems (Lasdon, 1970; Barnhart et al., 1998).

The remainder of this paper is organized as follows. In Section 2, we review some existing approaches in the literature to design multi-level networks. In Section 3, we introduce the Integer Programming formulations while, in Section 4, the Branch-and-price algorithm is described. Our computational experiments are presented and discussed in Section 5. The conclusion and future directions are given in Section 6. Finally, A is devoted to present the equivalence between two formulations for the problem.

@&#BACKGROUND@&#

The Multi-level Network Design has theoretical importance since it generalizes the well-known Steiner Tree (Chopra and Rao, 1994) problem and the Hierarchical Network Design (HND) problem, defined by Current et al. (1986), in which only two primary nodes belong to the first level of the network while all others are in the second level. The MLND was first introduced by Balakrishnan et al. (1994b), which describes alternative model formulations for the problem and analyzes the worst-case performance of heuristics based upon Steiner and spanning tree computations. For the HND special case with only two primary nodes, the worst-case performance ratio of their composite heuristic is 4/3. For the general case, this heuristic has a worst-case performance ratio of r
                     +1, where r is the worst-case performance ratio r of the Steiner tree heuristic embedded in it.

By the same time, Balakrishnan et al. (1994a) had developed an optimization-based heuristic methodology for solving the MLND problem. This method first applies certain preprocessing tests to reduce the problem by eliminating or installing primary or secondary technologies before solving the problem. The core of the method consists of a dual ascent algorithm to generate good linear programming-based lower bounds and heuristic upper bounds. Computational results on large-scale problems (containing up to 500 nodes and 5000 edges) show that the method provides very good approximation solutions (guaranteed to be within 0.9% from optimality).

The survivability idea was incorporated into the MLND in (Balakrishnan et al., 1998). For this, backup paths are provided for pairs of nodes belonging to the primary level. The authors propose and analyze the worst-case performance of tailored heuristics for several special cases of the two level problem. Depending upon the particular problem setting, the heuristics have worst-case performance ratios ranging between 1.25 and 2.6.

Formulations for the Two-Level Network Design (TLND), a special case of MLND, are discussed Gouveia and Telhada (2001). The authors present an augmented arborescence formulation combining a directed formulation for the Steiner tree problem with a directed formulation for the spanning tree problem. They show that the Linear Programming (LP) value of the new formulation is theoretically weaker than the LP bound given by a flow-based formulation, although for certain classes of instances the two LP bounds are quite close. In addition, a Lagrangian-based relaxation is presented, where an arborescence minimization problem is solved as the relaxed subproblem. Computational results indicate that the Lagrangian relaxation-based method is quite efficient, providing a reasonable alternative to handle the problem.

As an extension of (Gouveia and Telhada, 2001), a new formulation for the Multi-Weighted Steiner Tree (a general case of TLND) problem is proposed in Gouveia and Telhada, 2008. In the previous work, the authors propose a non-symmetric formulation for the problem in the sense that depending on the node selected as a root of the tree, the corresponding LP bounds could vary. Thus, a reformulation by intersection is proposed, obtained by the intersection of feasible sets of the models corresponding to each root selection for the problem. It is showed that the linear programming relaxation of the reformulation dominates the linear programming relaxation of the previous formulation for all possible root selections. They also present a Lagrangian relaxation scheme derived from the reformulation, with quite favorable results, on instances with up to 500 nodes and 5000 edges.

An optimal approach for the HND problem is devised in Obreque et al. (2010) using a Branch-and-cut procedure. They present how to find valid cuts and how separation works. A Branch-and-bound procedure completes the algorithm when no more cuts can be added. Computational results show that large instances are likely to be solved in a short CPU time.

Another important related problem is known as Hop-constrained Survivable Network Design (HSND), which seeks for the minimum cost subgraph with at least M edge-disjoint paths containing at most H edges between each origin–destination pair. The RMHND generalizes the HSND, when considering only a single level in the network (i.e., all nodes in the network belong to the same level) and M
                     =2. Huygens et al. (2007) consider the HSND problem when M
                     =2. The cutting plane method devised for the integer programming formulation is valid for H
                     ⩽3. For H
                     =4, Huygens and RidhaMahjoub (2007) have given a valid integer programming formulation. They also introduce a new class of inequalities.

Recently, an extended formulation valid for any M, H
                     ⩾1 with multiple origin–destination pairs has been proposed in Botton et al. (2011). They apply a Benders decomposition approach to efficiently handle the large number of variables and constraints of the formulation. A through computational study of various cutting plane and Branch-and-cut algorithms is presented over three sets of instances. Finally, they present a LP-based heuristic that provides the optimal solution for more than half of the instances.

To the best of our knowledge, there is no literature dealing with the problem of Multi-level Network Design with hop constraints and resilience against single-arc failure, as proposed in this paper.

Let us now formally introduce the Resilient Multi-level Hop-constrained Network Design problem. For the sake of convenience, we define our problem over a directed graph to allow an easier transition over the different formulations. Given a directed graph D
                     = (N,
                     A) with set of nodes N and arcs A, installation costs 
                        
                           {
                           
                              
                                 c
                              
                              
                                 ij
                              
                              
                                 g
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 ji
                              
                              
                                 g
                              
                           
                           ⩾
                           0
                           :
                           ∀
                           (
                           i
                           ,
                           j
                           )
                           ∈
                           A
                           ,
                           ∀
                           g
                           ∈
                           G
                           }
                        
                      are assigned to the arcs of A, where G denotes the set of different technologies, numbered from 1 to ∣G∣. A technology g on arc (i,
                     j) costs 
                        
                           
                              
                                 c
                              
                              
                                 ij
                              
                              
                                 g
                              
                           
                        
                     , with 
                        
                           
                              
                                 c
                              
                              
                                 ij
                              
                              
                                 g
                              
                           
                           >
                           
                              
                                 c
                              
                              
                                 ij
                              
                              
                                 
                                    
                                       g
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      if g
                     <
                     g′.

Let K
                     ⊆
                     N
                     ×
                     N be a set of requests; K
                     =⋃
                     
                        g∈G
                     
                     K
                     
                        g
                     , where K
                     
                        g
                      is the set of requests with technology g. The technology g of a request k is defined by the higher priority level of its end-nodes. This means that the communication for request k must take place in the higher priority technology between its end-nodes. The RMHND problem consists in finding a subset of arcs S
                     ⊆
                     A, such that each arc is assigned to exactly one technology and the subgraph of D implied by (N,
                     S) provides two arc-disjoint paths with length at most H for each request.

Three Integer Programming Formulations for RMHND are presented here. In the first two formulations, named Arc-Flow Formulation and Aggregated Hop-Indexed Formulation, connectivity between each pair of nodes is enforced through network flow (Ahuja et al., 1993) arguments. In the third one, Arc-Path Formulation, connectivity is guaranteed by imposing that two arc-disjoint paths connecting every pair of nodes must be available in the subgraph of D implied by the selected arcs. These formulations are discussed next.

Let us assume that, given 
                           
                              D
                              =
                              (
                              N
                              ,
                              A
                              )
                              ,
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                                 
                                    -
                                 
                              
                           
                         and 
                           
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                                 
                                    +
                                 
                              
                           
                         respectively denote the set of arcs arriving and leaving j
                        ∈
                        N;o(k) and d(k) denote the origin and destination nodes of request k
                        ∈
                        K and g(k) is the technology required by request k
                        ∈
                        K. To model RMHND, we make use of the following sets of decision variables: (i) 
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                                 
                                    kp
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                           
                        , indicating if the flow of request k passes through arc (i,
                        j) which composes path p
                        ∈{1,2}; (ii) 
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                                 
                                    g
                                 
                              
                           
                        , taking value 1 if arc (i,
                        j)= (j,
                        i) is assigned to technology g and therefore included in the solution (0, otherwise). RMHND can now be stated as:
                           
                              (1)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          :
                                          i
                                          <
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          ∈
                                          G
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                              
                           
                        s.t.
                           
                              (2)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          {
                                          1
                                          ,
                                          2
                                          }
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                s
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       sj
                                    
                                    
                                       kp
                                    
                                 
                                 ⩾
                                 2
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 s
                                 =
                                 o
                                 (
                                 k
                                 )
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          {
                                          1
                                          ,
                                          2
                                          }
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                t
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       it
                                    
                                    
                                       kp
                                    
                                 
                                 ⩾
                                 2
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 t
                                 =
                                 d
                                 (
                                 k
                                 )
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       kp
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       jl
                                    
                                    
                                       kp
                                    
                                 
                                 =
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 j
                                 ∈
                                 N
                                 ,
                                 j
                                 
                                 ≠
                                 
                                 o
                                 (
                                 k
                                 )
                                 
                                 ≠
                                 
                                 d
                                 (
                                 k
                                 )
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 {
                                 1
                                 ,
                                 2
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          ∈
                                          G
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 ⩽
                                 1
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 (
                                 j
                                 ,
                                 i
                                 )
                                 ∈
                                 A
                                 ,
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          {
                                          1
                                          ,
                                          2
                                          }
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       kp
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                          ⩽
                                          g
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 (
                                 j
                                 ,
                                 i
                                 )
                                 ∈
                                 A
                                 ,
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       kp
                                    
                                 
                                 ⩽
                                 H
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 {
                                 1
                                 ,
                                 2
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       ji
                                    
                                    
                                       g
                                    
                                 
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 ,
                                 
                                 ∀
                                 g
                                 ∈
                                 G
                                 ,
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       kp
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 {
                                 1
                                 ,
                                 2
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 ,
                                 ∀
                                 g
                                 ∈
                                 G
                                 .
                              
                           
                        
                     

Constraints (2)–(4) are flow balance constraints for each request k. Note that inequalities (2) imply that at least two units of flow will leave the origin node of request k, while inequalities (3) indicate that every unit of flow for request k will arrive its destination node. Constraints (4) guarantee the flow conservation in transshipment nodes. Inequalities (5) assure that on each arc (i,
                        j)∈
                        A at most one of the technologies is installed. Inequalities (6) couple flow and design variables, imposing that g(k) flows are only allowed to cross g′ arcs (arcs with higher priority technologies), where g′⩽
                        g(k). Note that inequalities (5) along with inequalities (6) impose that paths p
                        ∈{1,2} are arc disjoint. Constraints (7) assure that paths implied by the flows are no longer than H. Constraints (8) impose that arcs (i,
                        j) and (j,
                        i) are symmetric. Finally, objective function (1) minimizes the total cost of selected arcs. Note that whenever arcs (i,
                        j) and (j,
                        i) are included in the solution, the cost 
                           
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                                 
                                    g
                                 
                              
                           
                         is considered only once in the objective function.

Formulation (1)–(10) has O(n
                        4) variables and constraints and therefore, only RMHND instances of limited size are expected be solved to proven optimality by BB algorithms based on it. Moreover, as we will see in the following, the LP bounds provided by the Arc-Flow Formulation may be improved by indexing flow variables with a hop counter, since constraints (7) are considered weak when we are dealing with the LP relaxation of the problem.

In this formulation, the previous constraints (7) are handled by adding another index on flow variables, as proposed in Gouveia et al. (2006) chapter 9, except that we do not make use of “loop” variables. Through this indexing strategy, even when we are dealing with the LP relaxation of the problem, the paths imposed by the flows are guaranteed to have no more than H hops, making the bounds stronger than in the former formulation.

In addition to variables 
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                                 
                                    g
                                 
                              
                           
                         previously defined, our second formulation uses variables 
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                                 
                                    hk
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                           
                        , indicating if the flow of request k crosses arc (i,
                        j) in the hth hop of one of the paths. Thus, the problem can be stated as:
                           
                              (11)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          :
                                          i
                                          <
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          ∈
                                          G
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                              
                           
                        s.t.
                           
                              (12)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                s
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       sj
                                    
                                    
                                       1
                                       k
                                    
                                 
                                 ⩾
                                 2
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 s
                                 =
                                 o
                                 (
                                 k
                                 )
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          =
                                          1
                                       
                                       
                                          H
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                t
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       it
                                    
                                    
                                       hk
                                    
                                 
                                 ⩾
                                 2
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 t
                                 =
                                 d
                                 (
                                 k
                                 )
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                    
                                       hk
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          ∈
                                          
                                             
                                                A
                                             
                                             
                                                j
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       jl
                                    
                                    
                                       h
                                       +
                                       1
                                       k
                                    
                                 
                                 =
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 j
                                 ∈
                                 N
                                 ,
                                 
                                 j
                                 ≠
                                 o
                                 (
                                 k
                                 )
                                 ≠
                                 d
                                 (
                                 k
                                 )
                                 ,
                                 
                                 h
                                 =
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 H
                                 -
                                 1
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          ∈
                                          G
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 ⩽
                                 1
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 (
                                 j
                                 ,
                                 i
                                 )
                                 ∈
                                 A
                                 ,
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          =
                                          1
                                       
                                       
                                          H
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                    
                                       hk
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                          ⩽
                                          g
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 (
                                 j
                                 ,
                                 i
                                 )
                                 ∈
                                 A
                                 ,
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       ji
                                    
                                    
                                       g
                                    
                                 
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 ,
                                 
                                 ∀
                                 g
                                 ∈
                                 G
                                 ,
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                    
                                       hk
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 ,
                                 h
                                 =
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 H
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 ,
                                 
                                 ∀
                                 g
                                 ∈
                                 G
                                 .
                              
                           
                        
                     

Flow balance constraints for each request k are given by constraints (12)–(14). Inequalities (12) ensure that at least two units of flow will leave the origin node of request k, indexed by the 1st hop. Inequalities (13) guarantee that every unit of flow for request k will arrive its destination node disregarding the number of hops used to reach it. Constraints (14) guarantee the flow conservation in transshipment nodes, assuring that each unit of flow leaving a node has an incremented hop index than in its arrival. Inequalities (15) assure that on each arc (i,
                        j)∈
                        A at most one of the technologies is installed. Inequalities (16) couple flow and design variables, as in the previous formulation. Note that inequalities (15) along with inequalities (16) impose that the paths implied by the flows are arc disjoint. Constraints (17) impose that arcs (i,
                        j) and (j,
                        i) are symmetric. The objective function (11) minimizes the total cost of selected arcs, as in the Arc-Flow Formulation.

Formulation (11)–(19) also has O(n
                        4) constraints and far more variables (O(n
                        5)) than the Arc-Flow Formulation. Although the LP bounds provided by this formulation are tighter, over again, the size of RMHND instances expected to be solved is limited.

A third formulation, named Arc-Path Formulation is presented in the sequence. Despite having exponentially many variables, this formulation is suitable for the implementation of a Branch-and-price (Barnhart et al., 1998) method, by combining Delayed Column Generation (Lasdon, 1970) and Branch-and-bound.

In this formulation, we assume that P
                        
                           k
                         denotes the set of admissible directed paths connecting the endpoints of request k in D, including a hop constraint (all p
                        ∈
                        P
                        
                           k
                         are no longer than H). The main idea of the Arc-Path Formulation to enforce connectivity and single arc failure resilience is to impose that, at least two paths connecting every request in the corresponding or higher priority level technologies must be available in the subgraph implied by the selected assignment whose cost we aim to minimize.

Assume that 
                           
                              
                                 
                                    a
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                           
                         indicates that arc (i,
                        j) or (j,
                        i) belongs to path p taking value 1 (0, otherwise). In addition to variables 
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                                 
                                    g
                                 
                              
                           
                         previously defined, we make use of the following set of decision variables: 
                           
                              
                                 
                                    λ
                                 
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                           
                         taking value 1 if path p
                        ∈
                        P
                        
                           k
                         is selected for request k (0, otherwise). The Arc-Path Formulation for RMHND is given by the Integer Program:
                           
                              (20)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          :
                                          i
                                          <
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          ∈
                                          G
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                              
                           
                        s.t.
                           
                              (21)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 2
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          ∈
                                          G
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 :
                                 i
                                 <
                                 j
                                 ,
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                          ⩽
                                          g
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 :
                                 i
                                 <
                                 j
                                 ,
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 :
                                 i
                                 <
                                 j
                                 ,
                                 
                                 ∀
                                 g
                                 ∈
                                 G
                                 .
                              
                           
                        
                     

The objective function (20) minimizes the total cost of the selected arcs. Constraints (21) ensure that at least two paths connecting each request will be selected. Inequalities (22) assure that on each arc (i,
                        j)∈
                        A at most one technology is installed. Inequalities (23) imply that g(k) paths are only allowed to cross g′ arcs, where g′⩽
                        g(k), i.e., arcs with higher technologies. Following the idea used in the other formulations, inequalities (22) along with inequalities (23) guarantee that the selected paths are arc disjoint.

Bounds provided by formulation (20)–(25) are equivalent to bounds provided by the former formulation (11)–(19). A shows that the Arc-Path formulation can be derived from the Aggregated Hop-Indexed formulation by applying the DW decomposition principle.

For solving RMHND by a LP-based BB algorithm, we have chosen the state-of-the-art commercial solver IBM-ILOG(2013). The advantage of the LP-based BB approach is that little programming effort is needed, once one has in hands an Integer Programming solver like CPLEX.

However, the Arc-Flow Formulation and the Aggregated Hop-Indexed Formulation have O(n
                        4) variables and constraints and O(n
                        5) variables and O(n
                        4) constraints, respectively. Therefore, even with the help of a highly sophisticated optimization package like CPLEX, only RMHND instances of limited size are expected be solved to proven optimality by LP-based BB algorithms that rely on these formulations. Consequently, the drawback of this approach is that, in practice, only limited size instances of RMHND can be actually solved in a reasonable amount of time.

In order to overcome this difficulty, in the following, we present a Branch-and-price algorithm based on a reformulation for RMHND (Arc-Path Formulation). Despite having exponentially many variables, the Arc-Path Formulation can lead to a specialized Branch-and-bound procedure, named Branch-and-price algorithm (Barnhart et al., 1998; Barnhart et al., 2000). Roughly speaking, the procedure consists in applying the Delayed Column Generation method (Lasdon, 1970) to derive lower bounds to be used in the search.

The exponentially many columns in (20)–(25) does not refrain us to use the Arc-Path Formulation in an exact BB approach to solve RMHND. That could be attained by embedding a Delayed Column Generation (to evaluate the Linear Programming bounds implied by (20)–(25) in a BB algorithm, leading to an exact BP algorithm (Barnhart et al., 1998).

To understand how the LP bounds given by (20)–(25) are evaluated, let π
                        
                           k
                        
                        ⩾0,
                        β
                        
                           ij
                        
                        ⩽0 and 
                           
                              
                                 
                                    γ
                                 
                                 
                                    ij
                                 
                                 
                                    k
                                 
                              
                              ⩽
                              0
                           
                         be the dual variables associated to constraints (21)–(23), respectively. The dual problem associated to the LP relaxation of (20)–(25) is given by:
                           
                              (26)
                              
                                 
                                    max
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          K
                                       
                                    
                                 
                                 2
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          :
                                          i
                                          <
                                          j
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        s.t.
                           
                              (27)
                              
                                 
                                    
                                       β
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                          ⩾
                                          g
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 :
                                 i
                                 <
                                 j
                                 ,
                                 ∀
                                 g
                                 ∈
                                 G
                                 ,
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          :
                                          i
                                          <
                                          j
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 0
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       β
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 ,
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       γ
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 .
                              
                           
                        
                     

The LP relaxation of (20)–(25) can be computed as follows. Assume that sets of simple directed paths C
                        
                           k
                        
                        ⊂
                        P
                        
                           k
                        , ∀k
                        ∈
                        K (∣C
                        
                           k
                        ∣≪∣P
                        
                           k
                        ∣) are made available. Also, assume that the Restricted Master Problem
                           
                              (32)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          :
                                          i
                                          <
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          ∈
                                          G
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                              
                           
                        s.t.
                           
                              (33)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                C
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 2
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          g
                                          ∈
                                          G
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 :
                                 i
                                 <
                                 j
                                 ,
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                C
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                          ⩽
                                          g
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 :
                                 i
                                 <
                                 j
                                 ,
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 0
                                 
                                 ∀
                                 k
                                 ∈
                                 K
                                 ,
                                 
                                 ∀
                                 p
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       g
                                    
                                 
                                 ⩾
                                 0
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 :
                                 i
                                 <
                                 j
                                 ,
                                 
                                 ∀
                                 g
                                 ∈
                                 G
                                 .
                              
                           
                        has one basic feasible solution 
                           
                              
                                 
                                    y
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    ˆ
                                 
                              
                           
                        . Let 
                           
                              
                                 
                                    π
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    γ
                                 
                                 
                                    ˆ
                                 
                              
                           
                         be the corresponding dual optimal solution. If, for all requests k, no path p
                        ∈
                        P
                        
                           k
                        ⧹C
                        
                           st
                         violates the dual constraints
                           
                              (38)
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          :
                                          i
                                          <
                                          j
                                       
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 0
                                 ,
                              
                           
                        then, 
                           
                              
                                 
                                    y
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    ˆ
                                 
                              
                           
                         solves the LP relaxation of (20)–(25) and the corresponding optimal LP function gives a lower bound on (20). Otherwise, for a given request k there must be a path in P
                        
                           k
                        ⧹C
                        
                           k
                         that violates (38) that must be included in C
                        
                           k
                        . The new RMP, enlarged with the sets of paths associated to violated constraints (38), is re-optimized. The procedure goes on, until no inequality (38) is violated.

In our implementation, the initial sets C
                        
                           k
                         are generated as follows. In order to guarantee a feasible solution for the problem, two arc disjoint paths must be provided for each request k
                        ∈
                        K. Therefore, we computed the first two minimum disjoint paths connecting request k in terms of number of hops (seeking a feasible solution). Whenever the length of the maximal path in the generated sets is no greater than H, (20)–(25) admits at least one solution.

The pricing problem, consists in finding a path p
                        ∈
                        P
                        
                           k
                        ⧹C
                        
                           k
                         that violates (38) or proving that such path does not exist. Therefore, if there is no path for any request k
                        ∈
                        K yielding negative reduced costs 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              =
                              -
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              -
                              
                                 
                                    ∑
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    :
                                    i
                                    <
                                    j
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ij
                                 
                                 
                                    k
                                 
                              
                           
                        , the LP relaxation is solved. Since 
                           
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ij
                                 
                                 
                                    k
                                 
                              
                              ⩽
                              0
                              ,
                              ∀
                              k
                              ∈
                              K
                              ,
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                              :
                              i
                              <
                              j
                           
                         (and therefore 
                           
                              -
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ij
                                 
                                 
                                    k
                                 
                              
                              ⩾
                              0
                           
                        ), the pricing problems could be solved in polynomial time by any hop-constrained shortest path algorithm due to the positive costs. In order to solve the subproblems, we use the truncated version of Lawler’s algorithm (Lawler, 1976) to solve the associated shortest path problem with hop-constraint. Based on dynamic programming, the complexity of the algorithm is O(n
                        3).

As previously described, when no more columns with negative reduced costs are found, the associated solution corresponds to the optimal value for the LP relaxation of the root node. If the LP solution is integer, it also solves the original problem (20)–(25). Otherwise, being fractional, an enumeration algorithm is required.

One important issue in the implementation of BP algorithms is how branching is performed. Since the pricing subproblems are iteratively solved along the BP procedure, ideally, the branching rule should not destroy the structure of the pricing subproblems.

To avoid destroying the structure of pricing subproblems, we chose to apply two different kinds of branching rules; one for each type of variables. Firstly, we start with the topology branching rule, based on fractional 
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                                 
                                    g
                                 
                              
                           
                         variables. Once all 
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                                 
                                    g
                                 
                              
                           
                         variables are integer, we apply the path branching rule, based on 
                           
                              
                                 
                                    λ
                                 
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                           
                         variables. It is important to point out that during the branching procedure we must be able to generate new columns if necessary. Moreover, while branching on 
                           
                              
                                 
                                    λ
                                 
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                           
                         variables, 
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                                 
                                    g
                                 
                              
                           
                         variables can become fractional, requiring that we branch on the first set of variables again.

The idea of branching on 
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                                 
                                    g
                                 
                              
                           
                         variables is the creation of as many branches as the number of technologies ∣G∣+1. The first branch concerns the case in which all technologies g of arc (i,
                        j)= (j,
                        i) are forbidden, i.e., arc (i,
                        j)= (j,
                        i) is actually forbidden to belong to the solution. The other ∣G∣ branches treat the cases where one of the technologies is imposed to be 1 and the remainder 0. The main advantage of this branching rule is that it does not affect the pricing subproblem, requiring only the elimination of the corresponding arc from the input graph when necessary.

The branching rule we adopted for 
                           
                              
                                 
                                    λ
                                 
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                           
                         variables is proposed in Parker and Ryan (1994). Since a branching rule based on variable dichotomy in which one branch forces commodity k to use path p, i.e., 
                           
                              
                                 
                                    λ
                                 
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              =
                              1
                           
                        ; and the other branch does not allow commodity k to use path p (
                           
                              
                                 
                                    λ
                                 
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              =
                              0
                           
                        ) is not enforced by solving a simple hop-constrained shortest path problem, we should apply another strategy. Therefore, the idea to deal with 
                           
                              
                                 
                                    λ
                                 
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              =
                              0
                           
                         is the creation of several branches, one for each edge of path p. Indeed, in each branch we are avoiding path p and any other path containing the corresponding edge. This branching rule does not affect the pricing problem, requiring only the elimination of the corresponding edge when calculating the subproblem.

The selection of the next fractional 
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                                 
                                    g
                                 
                              
                           
                         variable to branch on is performed at random. The selection of which 
                           
                              
                                 
                                    λ
                                 
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                           
                         variable to branch on is based on the fractional variable associated to the maximal integer unfeasibility (farthest from integrality). This means that among all fractional paths, the one closest to 0.5 is to be selected. Moreover, the Branch-and-bound tree is explored choosing a node according to a best bound policy. According to our experiments, the best bound policy presents a better performance than the breadth first or depth first ones.

In order to evaluate the behavior of our algorithm under stabilization, we apply an interior point stabilization method proposed by Rousseau et al. (2007). The main idea of this method is to select a dual solution inside the optimal space rather than retrieving an extreme point. To obtain a point inside the polyhedron, one can simply define a random objective function and solve the associated dual problem using complementary slackness conditions. If the problem is solved with a simplex method, then the optimal solution obtained will always be an extreme point. Solving the dual problem for a number of random values, we obtain a set of extreme points, whose combinations will lead to an interior point that gives much more centered dual values. The only parameter to set is the number of points to identify in order to calculate an interior point of the dual optimal space. The trade-off is that a larger number of points will produce a more centered point, but also requires more computing time (since a LP has to be solved for each point).

Evaluating our experiments, it is observed that although the number of iterations of the procedure indeed decreases, the computational times are not improved. Different values for the number of points to be calculated were tested, but none advantage was achieved. The reason for that consists in the fact that the bottleneck of our problem is the time spent while solving the LP. Since the stabilization method is based on a number of runs of the associated dual LP, the gain obtained in the number of iterations of the column generation do not pay off the time spent to compute better dual values.

A common acceleration strategy in column generation concerns the addition of a large set of good columns in the beginning of the procedure. As presented in Section 4.1, the set of initial paths for each request is initialized with only two arc-disjoint paths. A larger set of paths was also tested to initialize the algorithm, but according to our computational results, this strategy does not improve our current solutions.

In this section, we present optimal solutions obtained with the BP algorithm and feasible solutions within a time limit of 3600s for a specific set of instances. We also present the LP relaxations provided by all three formulations. For the Arc-Flow Formulation and the Aggregated Hop-Indexed Formulation, within a time limit of 3600s, the integer (eventually optimal) solutions found by the BB algorithm based on them are shown. All computational testings in this study were conducted on a Intel Xeon 2.40GHz, with 32Gb of RAM memory, running under Linux operating system. For all algorithms, CPLEX LP solver release 12.5 (IBM-ILOG , 2013) was used.

Two sets of instances are tested. The first set of instances is composed by networks from SNDlib (available online at http://sndlib.zib.de/). These networks allow a very interesting scenario, as their topological structures are very representative regarding a real telecommunication structure. Usually, telecommunication networks consist of mesh networks with a high number of requests among their nodes. Although there are many possibilities for telecommunication network structures, it is not very common the existence of full-mesh topologies (a fully connected network). Therefore, our main focus in this work regards the study of sparse network scenarios.

In order to create different instances for each topology, a random generator was adopted, requiring the following parameters: ∣G∣ – number of technologies (or levels) and 
                        
                           
                              
                                 m
                              
                              
                                 ˆ
                              
                           
                        
                      – array with the number of nodes in each level. Costs based on the Euclidean distance between their endpoints are assigned to the arcs of these topologies and levels are attributed at random to the nodes, according to a parameter specifying how many nodes exist in each level. The costs of the technologies in the arcs are multiplied by a constant factor δ
                     
                        g
                      to indicate how many times a technology costs more than the cheapest one. Table 1
                      details the instances characteristics, where ∣N∣ is the number of nodes, ∣A∣ is the number of arcs and ∣K∣ corresponds to the number of requests. Note that we consider the whole set of requests, i.e., requests connecting every pair of nodes (this number is given by ∣K∣=∣N∣× (∣N∣−1)/2).

In Tables 2–5
                     
                     
                     
                      we present the results of all three formulations for instances from Table 1. The first two columns of the tables, indicate the number of nodes in the first level l
                     1
                     ∈{2,4,8} and the number of hops H in the interval [hmin,
                     hmax]. Parameter hmin corresponds to the minimum number of hops necessary to provide two arc disjoint paths for all requests while hmax is the maximum number of hops chosen to guarantee a certain level of quality regarding the delay. In the next four columns, results attained by the Branch-and-bound algorithm based on the Arc-Flow Formulation are presented: GAP (the LP duality gap), t
                     
                        LP
                      (the time taken to evaluate the LP relaxation), followed by the number of instances that were proven optimality (#opt) and the respective time, t
                     
                        opt
                     . In the next four columns, similar entries are given for the Aggregated Hop-Indexed Formulation: the LP duality gaps (GAP) and the time taken to compute them (t
                     
                        LP
                     ), followed by the number of instances that were proven optimality (#opt) and the respective time, t
                     
                        opt
                     . Results for the Arc-Path Formulation include the LP duality gaps (GAP), the time taken to compute them and the number of columns (#col) generated at the root node. Finally, in the last three columns, we provide the time taken to compute the optimal solutions given by BP (t
                     
                        BP
                     ), the final number of columns (#col) and the number of nodes (#nod) explored in the enumeration tree. It is important to point out that each line corresponds to average values of 5 randomly generated instances owning the same features. The best computing times (when optimality is achieved) are highlighted in boldface.

Results in Tables 2–5 indicate that BP is able to solve all instances for each network topology. On the other hand, it can be observed that the BB algorithm based on the Arc-Flow Formulation and the Aggregated Hop-Indexed Formulation is not capable to prove optimality for all tested instances within the time limit imposed (3600s). Note that column #opt indicates the number of instances solved to optimality (from a set of 5 instances). Although the time taken to compute the bounds for the Arc-Flow Formulation is smaller in most of the cases compared to the times needed to compute them by the other two formulations, the provided gaps are weaker, reaching values up to 29.36% on average. On the other hand, the gaps provided by the Aggregated Hop-Indexed Formulation and the Arc-Path Formulation are stronger and identical, since these formulations are equivalent. However, the times taken to find optimal solutions (when the time limit is not achieved) by the Aggregated Hop-Indexed Formulation are higher than the Arc-Path Formulation for most of the tests.

Analyzing the results achieved by the three formulations, it can be observed that on average, the BP algorithm based on the Arc-Path Formulation has obtained the best computational times compared to a BB algorithm based on the other two formulations. The BB based on the Arc-Flow and Aggregated Hop-Indexed Formulations was not able to find optimal solutions for all instances, especially when the number of nodes (and consequently the number of requests) increases. Due to the tighter bounds provided by the Aggregated Hop-Indexed Formulation, the overall behavior of BB is better then that one based on the Arc-Flow Formulation. Regarding the Arc-Flow Formulation, the main observation is that gaps improve as the number of hops (H) increases. This occurs because relaxing the value of H, the problem is “closer” to the traditional multi-level Network Design and the hop-constraint is less effective. We also note that for the Aggregated Hop-Indexed Formulation and the Arc-Path Formulation, the gaps are tighter as H increases, except for the smallest value of H. Even though, in general, the computational times increase as H increases. This occurs because the latter two formulations are based on “paths”. As the number of hops increases, there are more possibilities of different paths for the Arc-Path Formulation and far more variables for the Aggregated Hop-Indexed Formulation.

The second set of instances refers to dense graphs, more precisely, fully connected networks. This kind of network frequently appears in the related literature. Table 6
                      shows results for complete graphs with ∣N∣=12 and different number of requests ∣K∣. It is possible to note that in this case, the BP algorithm presents a worse performance compared to the BB algorithm based on the Aggregated Hop-Indexed Formulation. For all values of ∣K∣ and H, BB outperforms BP. Note, however, that increasing the number of requests ∣K∣, the performance of BP is closer to BB.

None of the algorithms has reached optimality for the whole set of instances within the time limit imposed. Moreover, we can see that gap values are worse for complete graphs than sparse ones (presented in the tables before). Also, as the number of requests ∣K∣ decreases, the computational times also decrease. We can conclude that in this scenario, BP is not the best choice for solving RMHND, since the Aggregated Hop-Indexed Formulation presents a more suitable approach when the complete graph is explored. However, for larger networks, it is possible to say that none of the algorithms will work well. Finally, it is important to emphasize that this type of network does not have the common structure of real world telecommunication networks, not being the main focus of this work.

The results show that the proposed BP algorithm is capable of solving real world instances for the RMHND within very reasonable times. It is also demonstrated that BP outperforms the BB based on the compact formulations for the scenarios of interest. It is important to highlight why larger size instances will demand a higher effort to be solved. Observe that the hardness involved is not only related to the number of nodes in the network, but more importantly, the number of requests. Once we work with requests for all pairs of nodes, the task becomes harder as the number of requests belongs to O(n
                     2).

In this work, we present a Branch-and-price algorithm for solving the Resilient Multi-level Hop-constrained Network Design problem. Our motivation concerns in devising an exact approach to an important problem in the telecommunications field, comprising issues related to resilience against random failures and delay guarantees. Extensive computational experiments were held to check the performance of the proposed algorithm. Our computational experience demonstrates that with the proposed Branch-and-price method we could solve more problems whose dimensions are out of reach for other traditional optimization tools for scenarios of interest.

Some future directions for investigation include the study of acceleration methods for the column generation algorithm and the implementation of other branching rules. Also, we intend to combine our BP algorithm with a heuristic in order to achieve good integer solutions early. At last, we will develop heuristics for the problem to compare to our current exact approach.

@&#ACKNOWLEDGMENTS@&#

We would like to thank the reviewers for very constructive and detailed comments. This work is supported by CNPq, CAPES and FAPEMIG.


                     
                        Theorem 1
                        
                           The LP relaxations of AHF and APF provide the same solution set and objective function values for RMHND.
                        

The proof for the theorem is based on applying the DWD principle to obtain an extended reformulation for the problem. For that, we start by dissociating AHF in order to follow a sequence of steps to explain how we apply the DW decomposition.

Let AHF
                              D
                            be the dissociated version of AHF. AHF
                              D
                            can be written as:
                              
                                 (A.1)
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             :
                                             i
                                             <
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             g
                                             ∈
                                             G
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          ij
                                       
                                       
                                          g
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          ij
                                       
                                       
                                          g
                                       
                                    
                                 
                              
                           s.t.
                              
                                 (A.2)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   A
                                                
                                                
                                                   s
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          sj
                                       
                                       
                                          1
                                          kr
                                       
                                    
                                    =
                                    1
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    s
                                    =
                                    o
                                    (
                                    k
                                    )
                                    ,
                                    
                                    ∀
                                    r
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 (A.3)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             h
                                             =
                                             1
                                          
                                          
                                             H
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          it
                                       
                                       
                                          hkr
                                       
                                    
                                    =
                                    1
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    t
                                    =
                                    d
                                    (
                                    k
                                    )
                                    ,
                                    
                                    ∀
                                    r
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 (A.4)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                                
                                                   -
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          ij
                                       
                                       
                                          hkr
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             ∈
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          jl
                                       
                                       
                                          h
                                          +
                                          1
                                          kr
                                       
                                    
                                    =
                                    0
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    ∀
                                    j
                                    ∈
                                    N
                                    ,
                                    
                                    j
                                    ≠
                                    o
                                    (
                                    k
                                    )
                                    
                                    ≠
                                    
                                    d
                                    (
                                    k
                                    )
                                    ,
                                    
                                    h
                                    =
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    H
                                    -
                                    1
                                    }
                                    ,
                                    
                                    ∀
                                    r
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 (A.5)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             g
                                             ∈
                                             G
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          ij
                                       
                                       
                                          g
                                       
                                    
                                    ⩽
                                    1
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    :
                                    i
                                    <
                                    j
                                    ,
                                 
                              
                           
                           
                              
                                 (A.6)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             h
                                             =
                                             1
                                          
                                          
                                             H
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             {
                                             1
                                             ,
                                             2
                                             }
                                          
                                       
                                    
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ij
                                       
                                       
                                          hkr
                                       
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          ji
                                       
                                       
                                          hkr
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   ′
                                                
                                             
                                             ⩽
                                             g
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          ij
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    :
                                    i
                                    <
                                    j
                                    ,
                                 
                              
                           
                           
                              
                                 (A.7)
                                 
                                    0
                                    ⩽
                                    
                                       
                                          w
                                       
                                       
                                          ij
                                       
                                       
                                          hkr
                                       
                                    
                                    ⩽
                                    1
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    ,
                                    
                                    h
                                    =
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    H
                                    }
                                    ,
                                    
                                    ∀
                                    r
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 (A.8)
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ij
                                       
                                       
                                          g
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    :
                                    i
                                    <
                                    j
                                    ,
                                    
                                    ∀
                                    g
                                    ∈
                                    G
                                    .
                                 
                              
                           Note that AHF
                              D
                            is similar to AHF, except that the constraints to guarantee the existence of two routes for each commodity are separated, leading to an additional index (r) on variables w. However, it is important to point out that the linear relaxation bounds provided by both are identical.

We apply the DWD principle to AHF
                              D
                           , as follows. The subproblems are defined with constraints (A.2), (A.3), (A.4) and (A.7). Thus, our subproblem is a set of 2×∣K∣ hop-constrained shortest path problems, one for each commodity and route, and therefore its feasible region has no extreme rays, and each extreme point of the feasible region of the subproblem kr is associated with a path r from o(k) to d(k). The set of all extreme points of the subproblem kr is denoted by P
                           
                              kr
                           . A given extreme point with index p and associated with the subproblem kr can be represented by 
                              
                                 
                                    
                                       z
                                    
                                    
                                       p
                                    
                                    
                                       kr
                                    
                                 
                              
                           . The entry in the vector corresponding to the original variable 
                              
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                    
                                       hkr
                                    
                                 
                              
                            is denoted by 
                              
                                 
                                    
                                       a
                                    
                                    
                                       pij
                                    
                                    
                                       hkr
                                    
                                 
                              
                           , which takes value 1 if arc (i,
                           j) id the hth hop in path p of commodity k and route r, and 0 otherwise.

At last, we define the weight variable associated with each extreme point 
                              
                                 
                                    
                                       z
                                    
                                    
                                       p
                                    
                                    
                                       kr
                                    
                                 
                              
                           , as 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       p
                                    
                                    
                                       kr
                                    
                                 
                              
                           . According to the DWD principle, we get the following master problem (APF
                              D
                           ):
                              
                                 (A.9)
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             :
                                             i
                                             <
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             g
                                             ∈
                                             G
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          ij
                                       
                                       
                                          g
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          ij
                                       
                                       
                                          g
                                       
                                    
                                 
                              
                           s.t.
                              
                                 (A.10)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               kr
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      p
                                                   
                                                   
                                                      kr
                                                   
                                                
                                                =
                                                1
                                                
                                                ∀
                                                k
                                                ∈
                                                K
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                ∀
                                                r
                                                ∈
                                                {
                                                1
                                                ,
                                                2
                                                }
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (A.11)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             g
                                             ∈
                                             G
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          ij
                                       
                                       
                                          g
                                       
                                    
                                    ⩽
                                    1
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    :
                                    i
                                    <
                                    j
                                    ,
                                 
                              
                           
                           
                              
                                 (A.12)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             h
                                             =
                                             1
                                          
                                          
                                             H
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   kr
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             {
                                             1
                                             ,
                                             2
                                             }
                                          
                                       
                                    
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          pij
                                       
                                       
                                          hkr
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          p
                                       
                                       
                                          kr
                                       
                                    
                                    +
                                    
                                       
                                          a
                                       
                                       
                                          pji
                                       
                                       
                                          hkr
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          p
                                       
                                       
                                          kr
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   ′
                                                
                                             
                                             ⩽
                                             g
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          ij
                                       
                                       
                                          
                                             
                                                g
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    :
                                    i
                                    <
                                    j
                                    ,
                                 
                              
                           
                           
                              
                                 (A.13)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          p
                                       
                                       
                                          kr
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    ∀
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          kr
                                       
                                    
                                    ,
                                    
                                    ∀
                                    r
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    }
                                    ,
                                 
                              
                           
                           
                              
                                 (A.14)
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ij
                                       
                                       
                                          g
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    :
                                    i
                                    <
                                    j
                                    ,
                                    
                                    ∀
                                    g
                                    ∈
                                    G
                                    .
                                 
                              
                           A decision variable of 
                              
                                 
                                    
                                       APF
                                    
                                    
                                       D
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       p
                                    
                                    
                                       kr
                                    
                                 
                              
                           , can be seen as the proportion of the demand of route r of commodity k that uses path p. Constraints (A.10) are convexity constraints, forcing each demand to be routed twice. Constraints (A.12) are the coupling constraints after the redefinition of variables subjacent to the DWD principle. A solution to APF
                              D
                            can be represented as the convex combination of the extreme points of the subproblem. Given a solution of APF
                              D
                           , we can recover a solution to AHF
                              D
                            by using:
                              
                                 (A.15)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ij
                                       
                                       
                                          hkr
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   kr
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          pij
                                       
                                       
                                          hkr
                                       
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          p
                                       
                                       
                                          kr
                                       
                                    
                                    ,
                                    ∀
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    ,
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                    ,
                                    
                                    ∀
                                    r
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    }
                                    ,
                                    
                                    h
                                    =
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    H
                                    }
                                 
                              
                           The linear relaxation of APF
                              D
                            gives a lower bound that is equal to the one given by AHF
                              D
                           , since the solution of each subproblem will always be a path (considering that there are no upper bounds in the arcs and the arc costs are non-negative).

Finally, we say that APF is the aggregated version of APF
                              D
                           . Observe that APF is similar to APF
                              D
                           , giving the same bounds for the problem. The main difference is that constraints (A.10) can be aggregated in APF.□

@&#REFERENCES@&#

