@&#MAIN-TITLE@&#An automatic segmentation system of acetabulum in sequential CT images for the personalized artificial femoral head design

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop an automatic method for segmenting the acetabulum from CT images.


                        
                        
                           
                           We can obtain the accurate sequential contours of the acetabulum.


                        
                        
                           
                           3D models of the acetabulum obtained by our method are accurate and satisfactory.


                        
                        
                           
                           We can reconstruct the personalized femoral head 3D prosthesis models.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Acetabulum segmentation

Personalized modeling

Artificial femoral head

Sequential CT images

Snake model

Avascular necrosis of femoral head

@&#ABSTRACT@&#


               
               
                  This paper describes an automatic and accurate segmentation method to extract the acetabulum tissue from sequential CT images. The hip joint consists of acetabulum and femoral head. In the personalized femoral head prosthesis designing by reverse engineering technology, obtaining the accurate acetabulum shape is the most important task. However, due to the necrotic femoral head's complex shape and the extremely narrow inter-bone region, obtaining the accurate acetabulum shape remains a challenging work. In this paper, we overcame these difficulties and developed an automatic segmentation method. First, we obtain the rough contour of the femoral head by utilizing the constraints of the great trochanter and the shape of femoral head in the initial slice. Second, we refine the rough contour by an orthogonal line edge detection approach and obtain a refined contour which will be used as the initial contour of the snake algorithm. Then, the snake algorithm is performed slice by slice upwards and downwards to generate the adjacent contours. During this process, the contour of the femoral head in a segmented slice is used as the initial contour of the next unsegmented slice. Finally, we can obtain the accurate sequential contours of the acetabulum by removing the femoral head and the femoral regions. And the 3D models of the acetabulum can be obtained correspondingly. The experimental result shows that the 3D models obtained by the proposed method are accurate and satisfactory. On this condition, we can reconstruct the personalized femoral head 3D models and design the personalized femoral head prosthesis.
               
            

@&#INTRODUCTION@&#

Avascular necrosis of femoral head (ANFH) is a universal disease. A common method to treat the disease is artificial femoral head replacement [1]. The shapes of the femoral head are various from people to people, whereas the artificial femoral head prosthesis are manufactured under a uniform producing and supplying mode. Thus the prosthesis often does not work well, which will lead to the patient's inconvenient action. Therefore, it seems significantly necessary of designing and manufacturing the personalized artificial femoral head prosthesis based on the parameters of patient's own bone structure.

The femoral head of the patient has already been necrotic and even collapsed. Therefore, if we utilize its parameters to reconstruct the femoral head prosthesis model, it may lead to erroneous results. However, we can utilize the acetabulum parameters to reconstruct the femoral head model. So removing the necrosis femoral head and segmenting the acetabulum in the CT image data set are the first and very important steps of the personalized femoral head modeling.

However, it remains a challenging task, because of: (a) uneven bone density in the CT images, (b) extremely narrow inter-bone regions between femoral head and acetabulum, (c) deformed shapes of the femoral head. Some related segmentation strategies have been proposed to extract the femoral head tissue. Among these reported methods [2–5], created a statistical model of the acetabulum by training a number of image sets of acetabulum, and then made use of deformation models or other methods to search the precise contour of a specific image. Seim et al. employed the Generalized Hough Transform to obtain the prior shape of the acetabulum, and then a free-from deformation step was used to obtain the optimal result [6]. Johanna Pettersson et al. developed a similarity idea, and they used a shape of well-segmented dataset as the prior shape [7]. Luo Sanding et al. proposed a method based on 2D contour characteristic matching in multilayer by measuring healthy hip joints and then extracted 3D data [8]. Alathari et al. proposed a technique based on pressure analogy that depends on the local features of image to segment the femur bone [9]. Yan Kang et al. developed a multistep approach based on 3D region-growing and anatomically oriented boundary adjustment [10]. Horácek J et al. proposed an approach based on finding an optimal path through a polar transformation of axial slices [11]. Weiwei Song et al. proposed a method that constructed 3D statistical shape model as the prior knowledge model, and then employed deformation models to search the final shape [12]. De Luis-Garcia et al. proposed an approach based on energy formulation of the segmentation problem to estimate the optimal parameters of the femoral head and acetabulum [13]. Westin et al. applied 3D tensors to segmentation of bone from CT data [14]. Schmid et al. proposed a multi-resolution SSM algorithm with an adapted initialization to address the segmentation of MRI bone [15]. Marti et al. applied active rays to represent the contour and obtained the solution using dynamic programming [16]. Yoo presented an effective method for the 3D Bio-CAD model reconstruction of human bone from a scanned point cloud data or a sequence of CT image data based on a B-spline interpolation scheme. The method was able to create the three dimensional shapes of human bones [17]. These methods have promoted the development of bone segmentation for the clinical medicine. Nevertheless, most of them need other persons’ parameter data to compute the target patient's result. However, there is a significant individual difference in skeletal structure among different patients. Therefore, how to reconstruct the personalized femoral head prosthesis model by using the target patient's own image data has become a new research focus. Moreover, the above mentioned methods mainly focus on the femoral head segmentation. There has not been a specialized method for acetabulum segmentation to reconstruct the personalized femoral head prosthesis model. In order to achieve this goal, a reasonable, effective and straightforward acetabulum segmentation method for individual patient has become an urgent need.

In this paper, we aim to develop an automatic method for segmenting the acetabulum from CT image data. The steps are shown as Fig. 1
                     .

The rest of this paper is organized as follows: Section 2 describes the main strategy of segmentation. Section 3 is dedicated for experiments and the performance analysis. Finally, the work is concluded in Section 4.

The CT image datasets we used in this study were acquired from the axis direction. Each slice of the CT image is of 512×512 pixels. In the image, there are two joints: left joint and right joint. We do not process both of these two joints at the same time. And only one joint (left joint or right joint) is considered at a time. So the region of interest (ROI) should be selected firstly. In this paper, a rectangular window that contains the whole left joint or right joint is used to set the ROI. The window size does not have to be a constant, but it must accommodate the whole joint. The original image and the ROI image are shown in Fig. 2
                           . The number of slices in each dataset ranges from 100 to 500. We just need to draw a rectangle on one slice and ROI of all the other slices are extracted automatically according to the size of the rectangle. So the selection of ROI is performed for all of the slices in the dataset.

Data set acquired from CT scanners usually contains much noise. The noise seriously affected the accuracy of the segmentation result. Thus, denoising is necessary and is the first step to be taken before the images data are analyzed. There are two basic approaches of images denoising: spatial filtering and frequency filtering [18]. The spatial filtering is simple and effective. So in this paper, a 3D Gaussian filter is utilized to remove the image noise (as shown in Fig. 3
                           ).

By extracting the serialized 2D contour lines of the hip joint, we can obtain the 3D model by Marching Cubes algorithm [19]. However, the shape of the acetabulum in 2D image is irregular, and the shape is various from slice to slice in the same one dataset. So it is difficult to compute the 2D contour lines of the acetabulum. Fortunately, the 3D model of the femoral head is approximated to be a sphere, and the 2D contour line is approximated to be a circle. So the region of the femoral head in each image slice can be relatively easy to be extracted. Thereby, we can segment the acetabulum by removing the femoral head.

In this paper, we drew on the experience of a technique proposed by Zoroofi et al. to estimate the rough contour of the femoral head in the initial slice [20]. This process will be introduced in Section 2.2.

The image we refer to as the initial slice is a slice in which the greater trochanter and the femoral head are detached from each other. According to Zoroofi's paper, the special shape of bone issue is useful for identifying the center of the femoral head. Moreover, this initial slice (as shown in Fig. 4
                           ) is more likely to show the largest femoral head contour.

In the CT image, bone tissues often have a higher gray value than the muscle tissues. So we can obtain the bone tissues by image binarization. In this paper, Otsu threshold method is utilized for automatic threshold selection [21]. Then the convex hull of the extracted bone tissues in the slice can be obtained by Graham scan algorithm [22,23]. As shown in Fig. 5
                           , the obtained convex hull (red polygonal lines) surrounds all the bone tissue.

In Fig. 5, take the right joint as instance. We can compute three control points of the anatomical structure. Firstly, the centroid of the region inside the convex hull is calculated and enumerated as p
                           
                              m
                           , from which the farthest point near to the greater trochanter is enumerated as p
                           
                              F
                           . From point p
                           
                              m
                           , the up and right directions normal to the convex hull can also be calculated. The intersections of these normals and the convex hull are enumerated as p
                           
                              up
                            and p
                           
                              E
                            respectively. Then, the middle point of the line between p
                           
                              m
                            and p
                           
                              E
                            can be obtained and enumerated as p
                           
                              e
                           . Similarly, the middle point of the line between p
                           
                              m
                            and p
                           
                              E
                            can also be achieved and enumerated as p
                           
                              f
                           . Lastly, three control points (p
                           
                              e
                           , p
                           
                              f
                            and p
                           
                              up
                           ) are all obtained. Similarly, the control points of the left joint can also be computed.

Then, a circle can be drawn with the above three control points. In order to be convenient for detecting edge points in the radial lines within the subsequent rough contour refinement step, we should ensure the circle is inside the femoral head. So the radius of the circle is reduced to be 1/1.7, which is different from Zoroofi's method. Finally, the rough contour (the purple circle) of the femoral head can be extracted.

In the CT image, the joint space between the acetabulum and the femoral head is extremely narrow. And the contrast between the joint space and bone edge is not very obvious. Thus, it tends to mistake the edge of acetabulum as that of femoral head when we update the point in the rough contour. Therefore, enhancing the contrast of the joint space is necessary.

Frangi et al. proposed a multiscale vessel enhancement filter which can enhance vessels effectively in [24]. We can see that the joint space is very similar to a vessel. So we can enhance it as the vessel by Hessian eigenvalues [25–27]. In the Hessian enhanced image, the narrower the joint space is, the brighter the pixel in the joint space will be. After enhancing the image with Hessian filter, the original image needs to subtract the Hessian enhanced image. So the contrast between the pixel in the joint space and the pixel in the edge of femoral head is enlarged, followed by the increasing of the edge pixel's gradient. Then, it will not mistake the pixel in the edge of acetabulum as that of femoral head. The result is as shown in Fig. 6
                           .

To refine the rough contour, Zoroofi RA et al. proposed a technique which is called ‘moving disk’. They replace each point in the rough contour with the pixel whose value minimizes the total variances inside the circle. However, this method often does not work well due to the extremely narrow inter-bone region. Moreover, the gap between the acetabulum and the femoral head is not constant. It is various for different people. So the refined boundary points often fall on the contour of the acetabulum or inside the femoral head outline.

In this paper, we proposed a method to refine the rough contour. For each point in the rough contour, we utilize the following steps to detect the edge point. The process is as shown in Fig. 7
                           .
                              
                                 (a)
                                 Compute the normal line of each blue point;

For each point in the normal line, compute its gradient magnitude and its gradient angle;

Select the point as the candidate edge point if its gradient magnitude is larger than its previous point in the normal line and if it satisfies the gradient angle condition. The gradient angle condition is: the gradient angle of the femoral head edge points in the joint space should be between 0° and 90°, or between 270° and 360°. And the gradient angle of points in other locations should be between 90° and 270°. It is the same for the left joint. This process is as shown in Fig. 8
                                    . The 3D sketch map of the slice is shown in Fig. 9
                                    , in which the point that satisfies the gradient angle condition and the gradient magnitude condition can be seen;

Then, non-maximum suppression is utilized to reserve the local maximum and delete the false edge point [28]. Test whether the gradient magnitude of the point is local maximum in its eight-neighbor. If it is, reserve it. Otherwise, delete it.

There are lots of error points in the point set due to noises in the CT slice after updating the rough contour. So elimination of error points is a necessary step. The contour of the femoral head in 2D image is an approximate circle [29], so the points we obtained via the above method will form a rough circle. Suppose the circle equation is
                              
                                 (1)
                                 
                                    
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                x
                                                0
                                             
                                             )
                                          
                                          2
                                       
                                       +
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                y
                                                0
                                             
                                             )
                                          
                                          2
                                       
                                       =
                                       
                                          r
                                          2
                                       
                                    
                                 
                              
                           
                        

The elimination process of the error points is as follows:

Firstly, the Hough transform is implemented on the candidate points obtained in Section 2). So the parameters of the circle can be computed. Suppose the center coordinate of the circle is (x
                           0, y
                           0) and the radius is r. Then, the fitting residual error of each point is calculated by traversing the point set:
                              
                                 (2)
                                 
                                    
                                       
                                          v
                                          i
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      x
                                                      i
                                                   
                                                   −
                                                   
                                                      x
                                                      0
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      y
                                                      i
                                                   
                                                   −
                                                   
                                                      y
                                                      0
                                                   
                                                   )
                                                
                                                2
                                             
                                             −
                                             
                                                r
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The histogram of fitting residual error has a Gaussian distribution, so the points with significant error can be eliminated. The Laiyite Criterion (3σ rule) is adopted to eliminate the error points. Compute the standard deviation estimator s according to the Bessel equation:
                              
                                 (3)
                                 
                                    
                                       s
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                               i
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

If some point (x
                           
                              i
                           , y
                           
                              i
                           ) satisfies |v
                           
                              i
                           |>3s, it can be regarded as a gross error point.

Updating the point set and repeating the elimination process circularly. When there is no gross error point, the elimination ends. Finally, the coordinate points in the point set are all effective data and they form the refined contour. The sampling point sets before elimination and after elimination are as shown in Fig. 10
                           .

Cao et al. proposed a method called hierarchical Hough transform (as shown in Fig. 11
                           ) to detect parameters of a sphere [30]. The femoral head in 3D space is an approximate sphere, so in the paper, this method can be utilized to generate the parameters of the femoral head. And then the range of slices that contain femoral head can be automatically computed.

In the section of ‘Error points elimination’, the approximate circle in the initial slice can be computed. Also, the slice number Znum of the initial slice can be obtained. Because we do not have the coordinate information of the femoral head organ, we can suppose [Znum
                           −
                           r
                           0, Znum
                           
                           +
                           
                           r
                           0] as the sampling range (an “estimated slice range”), where r
                           0 is the radius of the circle in the initial slice. For each slice in the sampling range, the snake algorithm is implemented repeatedly [31]. Therefore, the femoral head edge point set of each slice can be computed.

Just as the initial slice, Hough transform is utilized to detect the parameter of each sample slice, so the center (x
                           
                              i
                           , y
                           
                              i
                           ) and the radius r
                           
                              i
                            of each slice can be computed. We can obtain the sphere-center coordinate (X
                           0, Y
                           0) with the dataset {(x
                           0, y
                           0),(x
                           1, y
                           1),(x
                           2, y
                           2), … (x
                           
                              i
                           , y
                           
                              i
                           )} by accumulating the frequency of the coordinate, and the coordinate of most times is (X
                           0, Y
                           0).

Suppose the distance between adjacent slices is m pixels and the slice number of each slice is znum
                           
                              i
                           , so the coordinate of each slice in z direction z
                           
                              i
                            is znum
                           
                              i
                           
                           ×
                           m. Therefore, we can obtain a new dataset {(z
                           0, r
                           0), (z
                           1, r
                           1), (z
                           2, r
                           2), …, (z
                           i, r
                           i)}.

In the X–Z plane, suppose R is the radius of sphere, and an equation can be derived as follows:
                              
                                 (4)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                Z
                                                0
                                             
                                             −
                                             
                                                z
                                                i
                                             
                                             )
                                          
                                          2
                                       
                                       +
                                       
                                          r
                                          i
                                          2
                                       
                                       =
                                       
                                          R
                                          2
                                       
                                    
                                 
                              
                           where Z
                           0 is the z coordinate of sphere. We have a dataset of {(z
                           0, r
                           0), (z
                           1, r
                           1), (z
                           2, r
                           2), … (z
                           
                              i
                           , r
                           
                              i
                           )} and we want to find the best sphere parameters Z
                           0 and R. Following the basic principle of Hough transform: parameter space transformation (regard the known quantities in the equation as unknown ones, and the unknown quantities as known ones) [32], it is easy to transform the slice parameters (z
                           
                              i
                           , r
                           
                              i
                           ) into a new (Z
                           0, R) parameter space based on Eq. (4) (as shown in Fig. 12
                           ).

Finally, the range [(Z
                           0
                           −
                           R)/m, (Z
                           0
                           
                           +
                           
                           R)/m] of slices that contain the femoral head will be obtained.

In this step, the Snake algorithm can be iteratively utilized to extract the contour of the femoral head in each slice [33–37]. This process is implemented in two directions: the up direction and the down direction. In both of the two directions, the refined contour of the initial slice is taken as the initial contour for the snake algorithm.

In the up direction, the refined contour of the initial slice is used as the initial contour of slice Znum
                           +1, and as the initial contour of slice Znum
                           −1 in the down direction similarly. The generated contour of the current slice is used as the initial contour of the next unprocessed slice. The snake algorithm is implemented in each slice that contains the femoral head. The slice range is [(Z
                           0
                           −
                           R)/m, (Z
                           0
                           
                           +
                           
                           R)/m], which has been computed via hierarchical Hough transform. And the slices in the “estimated slice range” have been processed by snake algorithm in previous step. So we just need to implement this operation in the unprocessed slice. Then the sequential contours of the femoral head can be obtained (as shown in Fig. 13
                           ).

In the above steps, the sequential contours of the femoral head in each slice have been computed. In order to obtain the sequential contours of the acetabulum, the femoral head is filled in each slice. And then only the femoral body and the acetabulum are left (only some slices have the femoral head) (as shown in Fig. 14
                        ).

According to the structure of the hip joint, the femoral body lies in the right side of the left joint (while femoral body lies in the left side of the right joint). The femoral head spherical center (X
                        0, Y
                        0) has been obtained by the hierarchical Hough transform. In each slice, the x-coordinate of the femoral body of the left joint is larger than (X
                        0
                        +
                        R), while that of the right joint is smaller than (X
                        0
                        −
                        R). Consequently, we can obtain the sequential contours of the acetabulum by removing the femoral body in each slice.

Finally, only the acetabulum tissue is left in each slice. The Marching Cubes algorithm is utilized to extract the largest connected isosurface of the sequential images. Consequently, the 3D model of the acetabulum can be created (as shown in Fig. 15
                        ).

@&#EXPERIMENTS AND RESULTS@&#

The method described in this paper was developed by C++ language (platform: Microsoft® Visual Studio 2010), OpenCV (Open Source Computer Vision Library), VTK (Visualization Toolkit) and MITK (Medical Imaging ToolKit). On the basis of this method, the system, which we named it ‘HipAssistant’ (Version 1.0), was designed. The system interface is shown as Fig. 16
                     .

To evaluate the performance of the segmentation strategy, our method is compared with the manual segmentation results from Dalian Medical University (as shown in Fig. A.1). Manual segmentation of each dataset was implemented slice by slice.

Several CT image data sets of actual patients collected from Affiliated Zhongshan Hospital of Dalian University were utilized as the experimental subjects. Among them, 8 CT image data sets of the hip joint with different degrees of necrosis were selected to display the experimental effect. They were labeled from #1 to #8 according to the degree of deformation. The automatic segmentation results are shown in Fig. A.2. It can be seen that the segmented acetabulum of these cases are satisfactory.

There may be two questions for the above experimental results: (1) the refined contour may not contain all of the femoral head region especially when the osteolysis is very severe. Will it affect the acetabulum segmentation result? (2) There may be some holes in the 3D models of the acetabulum in some cases. Is it due to the imperfection of the segmentation strategy?

The answers are no. Firstly, even if the refined contour does not contain the entire femoral head region, the residual tissue will also be removed when we extract the largest connected isosurface. What matters is that the part of the contour near to the acetabulum is well refined, which will break the connectivity between the femoral head and the acetabulum. Secondly, the holes occurred when the density of bone is nonuniform in the CT images. So it is that the image quality leads to the holes in 3D model.

Time consuming is an important indicator for evaluating the performance of a method. So a time cost experiment was also implemented. The time cost of each step in the method is indicated in Table 1
                        .

In Table 1, step I stands for rough estimation of the rough contour of the femoral head in the initial slice; step II stands for extracting refined contour of the femoral head in initial slice; step III stands for sequential segmentation of the femoral head; step IV stands for sequential segmentation of the acetabulum; and step V stands for 3D reconstruction of the acetabulum. In our software, step III is integrated with step IV, so their time consuming is calculated together.

From Table 1, we can see that the total time consuming is satisfactory and step III+step IV cost most of the total time. The time consuming is increasing with the increasement of the slice number. And the total time consuming of our method is acceptable.

In order to further verify the effectiveness and accuracy of the method in our system, a computational validation in 2D CT image was implemented. The missing pixel rate (MR) Q
                        
                           m
                         and faulting pixel rate (FR) Q
                        
                           f
                         are calculated assess the performance of our method in pixel level.

Missing pixel: pixels that should be segmented but not.

Faulting pixel: pixels that are wrongly segmented due to the algorithmic error.

Then we can define the missing rate and faulting rate of the segmentation result for a CT image:
                           
                              (5)
                              
                                 
                                    
                                       Q
                                       m
                                    
                                    =
                                    |
                                    O
                                    ∩
                                    
                                       S
                                       ¯
                                    
                                    |
                                    /
                                    O
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       Q
                                       f
                                    
                                    =
                                    |
                                    
                                       O
                                       ¯
                                    
                                    ∩
                                    S
                                    |
                                    /
                                    O
                                 
                              
                           
                        
                     

where O is the pixel set of the reference segmentation result (manual segmentation result); S is the pixel set of the experiment segmentation result; || is the number of the element in the set; 
                           
                              ⋅
                              ¯
                           
                         is the complementary set.

In our segmentation strategy, our main goal is to separate the acetabulum from the femoral head in sequential CT images. However, not all of the slices contained the femoral head in a data set. Therefore, only the pixels on the acetabulum were considered in the experiment. The computational result is indicated in Table 2
                        .

As shown in Table 2, #8 has a higher faulting rate, while the others keep a lower missing rate and faulting rate. So we can see that this method tends to be more effective when the pathological change is less. The computational results prove that the segmentation strategy in this paper is effective and satisfactory.

Validation only from 2D CT image is not sufficient and scientific. A 3D geometric numerical calculation validation was also implemented. In this experiment, the reference model obtained by manual segmentation and the model obtained by our method were nested together. Then the degree of overlap was calculated.

The future work (personalized femoral head prosthesis reverse and reconstruction) is mainly influenced by the coordinate data of the acetabulum. So the degree of the overlap for the acetabulum is focused.

As shown in Fig. A.3, it can be seen that each pair of models closely overlapped together. Geometric error analysis for each pair of acetabulum models was implemented. Different color represents different geometric error value. From the colorized analysis results, it can be seen that the geometric error is uniform and small (±1.882mm) for those whose malformation are slight. Only for those whose malformations were severe (for example: #7 and #8), there is a slightly large error (±2.406mm). However, these isolated gross error data will be eliminated in the pretreatment of the femoral head prosthesis reconstruction [38]. So these 3D validation results also prove that the segmentation strategy in this paper is accurate and satisfactory.

After the serialized segmentation, the obtained acetabulum models can be used for personalized femoral head modeling by our system ‘FemoAssist’ [38]. In this process, firstly, data points on the acetabulum concave surface are collected. Then, the prosthetic modeling of the femoral head can be implemented by using these data points (as shown in Fig. A.4). In our opinion, in the future, there may be a kind of special machine which can manufacture the femoral head prosthesis automatically. On this condition, we can load the obtained 3D femoral head prosthesis geometric models into this special machine. However, this kind of machine does not exist now. Therefore, as a simulation of this future manufacturing process, we utilized a 3D printer (manufacturer and model: Myriwell RL200A) to substitute this machine, as shown in Fig. 17
                        . The manufactured personalized femoral head prostheses (original model, sphere model and ellipsoid model) for dataset #1 are shown in Fig. 18
                        . In the figure, the blue femoral head is being in necrotic status, and the green prostheses are prosthetic femoral head models.

@&#DISCUSSION AND CONCLUSIONS@&#

In this paper, we have presented an automatic method to segment the acetabulum tissue in CT images. Firstly, we obtain the rough contour of the femoral head in the initial slice based on Zoroofi's method. Secondly, the rough contour is refined. Thirdly, taking the refined contour as the initial contour, perform the snake algorithm in each slice that contains femoral head. The image traverse range is computed via hierarchical Hough transform method. Finally, the largest connected isosurface of the acetabulum tissue can be extracted and the 3D model can be reconstructed.

The strengths of this system include high automation, high practicability and high quality. By this system, we can complete an automatic segmentation process for the femoral head CT images. The segmentation result can provide great convenience for the personalized artificial femoral head design. However, this system also has some limitations. When the adhesion degree is high, there may be some segmentation error.

Moreover, the sequential segmentation is implemented in all of the slices and cost lots of time. Therefore, the total time consuming may be reduced largely by optimizing the code of sequential segmentation. The precision of the sequential segmentation is seriously affected in the clinical cases with severe abnormalities due to severe pathological changes. And it leads to the erroneous prosthetic modeling of the femoral head. The future work is to investigate a more precise and less time consuming strategy of automatic segmentation of acetabulum.

@&#ACKNOWLEDGMENTS@&#

This work is supported by the National Natural Science Foundation of China (Grant Nos. 61300085 and 61572101), the Scientific Research Fund of Liaoning Provincial Education Department of China (Grant No. L2013012) and the Fundamental Research Funds for the Central Universities of China (Grant No. DUT14QY18). Thanks to Ms. Xiuyan Peng, Mr. Yuxiang Liu and Ms. Chao Wan for providing the datasets and the experimental material. Over the past few years, they assisted us to complete the investigative work in many cities of China. They also put forward many reasonable and excellent opinions for our research work. Thanks very much for their contribution.


                     
                     
                     
                     
                  

@&#REFERENCES@&#

