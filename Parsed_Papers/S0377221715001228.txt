@&#MAIN-TITLE@&#The economic lot-sizing problem with perishable items and consumption order preference

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Introduction of an ELS model accounting for perishability (ELS-PI).


                        
                        
                           
                           Analysis of ELS-PI under FEFO, LEFO, LIFO, FIFO consumption orders.


                        
                        
                           
                           Uncapacitated ELS-PI is polynomially solved under FEFO, LEFO, LIFO, FIFO.


                        
                        
                           
                           With constant production capacities ELS-PI is NP-hard under LIFO, FEFO.


                        
                        
                           
                           With constant production capacities ELS-PI is polynomially solved under FIFO, LEFO.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Lot-sizing

Dynamic programming

Perishable items

Complexity analysis

@&#ABSTRACT@&#


               
               
                  We consider the economic lot-sizing problem with perishable items (ELS-PI), where each item has a deterministic expiration date. Although all items in stock are equivalent regardless of procurement or expiration date, we allow for an allocation mechanism that defines an order in which the items are allocated to the consumers. In particular, we consider the following allocation mechanisms: First Expiration, First Out (FEFO), Last Expiration, First Out (LEFO), First In, First Out (FIFO) and Last In, First Out (LIFO). We show that the ELS-PI can be solved in polynomial time under all four allocation mechanisms in case of no procurement capacities. This result still holds in case of time-invariant procurement capacities under the FIFO and LEFO allocation mechanisms, but the problem becomes 
                        NP
                     -hard under the FEFO and LIFO allocation mechanisms.
               
            

@&#INTRODUCTION@&#

The dynamic economic lot-sizing problem (ELS), introduced in Wagner and Whitin (1958), is described as follows. Demands for a single item over a finite and discrete planning horizon have to be satisfied by producing in a facility with no capacity restrictions. An item produced in a period can satisfy demands in that period and the following periods. Whenever there is positive production in a period, a setup has to take place, which entails a fixed setup cost. Any item produced incurs a unit production cost and any item carried to the next period incurs a unit inventory holding cost. The goal is to find a minimum cost production plan.

This basic model has been extended in several ways by, for example, considering backlogging (Zangwill, 1968), production capacities (Bitran and Yanasse, 1982 and Florian, Lenstra, and Rinnooy Kan, 1980), and inventory bounds (Atamtürk and Küçükyavuz, 2005; Hwang and van den Heuvel, 2012; Liu, 2008; Toczylowski, 1995). In all these models it is assumed that items can be kept in stock indefinitely. However, items such as agricultural products, dairy products and pharmaceutical products may deteriorate over time. For the procurement and inventory control decisions of such items, models that account for item perishability should be used.

Broadly, past research has modeled perishability in two ways. In the first one, items deteriorate continuously, and in the second one items have certain lifetimes after which they deteriorate completely. Seminal work on the first category of models includes Ghare and Schrader (1963), Covert and Philip (1973), and Philip (1974). For an extensive review of early work, see Raafat (1991) and for more recent reviews, see Goyal and Giri (2001) and Bakker, Riezebos, and Teunter (2012). Regarding the second category of models, in some it is assumed that demand follows a deterministic function (see Hwang and Hahn, 2000; Zhou and Yang, 2003), while in others demand is stochastic (see Fries, 1975; Liu and Lian, 1999; Nahmias and Pierskalla, 1973; Olsson and Tydesjö, 2010; Tekin, Gürler, and Berk, 2001). For a review of recent literature on these models, we refer the readers to Urban (2005), Bakker et al. (2012) and the related chapter in Kempf, Keskinocak, and Uzsoy (2012).

When the items are perishable, the order in which they are consumed becomes an important factor to consider. In Derman and Klein (1958) and Eilon (1962), the problem of optimally allocating items of different ages in stock to maximize total utility is considered, and the performance of a FIFO (First In, First Out) and a LIFO (Last In, First Out) allocation mechanism is evaluated. Assuming that items procured earlier deteriorate faster, FIFO (LIFO) corresponds to the mechanism where the oldest (freshest) item is issued first. In Nose, Ishii, and Nishida (1984), a perishable inventory system with stochastic procurement leadtime under both a FIFO and a LIFO allocation mechanism is discussed. Procurement policies when the demand rate depends on the inventory level under a FIFO and a LIFO allocation mechanism are considered in Hwang and Hahn (2000) and Zhou and Yang (2003), respectively. A model with interaction between a retailer and a supplier under both a LIFO and a FIFO allocation mechanism is studied in Hahn, Hwang, and Shinn (2004). The items have fixed lifetimes and the supplier needs to determine the amount of discount on the items so that the retailer does not return perished items. A stochastic input–output inventory system for perishable items under a FIFO and a LIFO allocation mechanism is considered in Parlar, Perry, and Stadje (2011).

ELS models that account for item perishability have been studied in the literature as well. An ELS model where a certain fraction of the inventory spoils at the end of each period is considered in Friedman and Hoch (1978). It is assumed that the fraction of items that spoil in each period increases as the items get older, so that, in a given period, items that were produced earlier deteriorate faster. A similar model with concave procurement and holding costs, where holding older items is never cheaper than holding newer items in stock, is considered in Hsu (2000). In turn, Chu, Hsu, and Shen (2005) generalize the model in Hsu (2000) by assuming economies of scale costs.

In the ELS models above, it is assumed that the allocation mechanism is FIFO and that older items deteriorate at a rate faster than newer ones (as we shall see (Section 4.6), under these assumptions there is a close link between our model and lot-sizing models with time windows). However, these assumptions may not hold in general. For example, consider the case of a retailer who orders from multiple suppliers, say, for risk mitigation. If supplier lead times are different (e.g., if they are located at different distances from the retailer), it is possible that an item may expire after a subsequently delivered item. In particular, newly received items may have an earlier expiration date than items that are already in stock. In this situation it may be suboptimal to use a FIFO policy. If the retailer is an online grocer, it might prefer to issue items in a First Expiration, First Out (FEFO) manner in order to minimize wastage. However, if the retailer is a brick-and-mortar supermarket, it loses power to control the issuance of items. In that case, when products with different expiration dates are displayed together, the customers will prefer the items with maximum remaining lifetimes. This means that the items will be issued in a Last Expiration, First Out (LEFO) manner.

Based on the above discussion, in this paper we consider a retailer who needs to solve an economic lot-sizing model with perishable items (ELS-PI), where lifetimes are general, such that an item procured later might expire earlier. We assume that items deteriorate completely after a certain expiration date, until which items remain undamaged and good for consumption. Furthermore, we consider the model both with and without capacity restrictions on the amount of procurement in each period. Because of the general lifetimes, a FIFO allocation mechanism does not imply the issuance of the oldest items first. Likewise, LIFO does not imply the issuance of the freshest items first either. Therefore, we analyze the ELS-PI explicitly under a FEFO and a LEFO allocation mechanism as well. Although the discussion above suggests that the most common settings in which items that are procured later may have an earlier expiration date are ones with multiple suppliers, for the sake of clarity in presentation, we assume that there is only a single supplier in each period to order the items from. The model with multiple suppliers was studied in the first author’s doctoral thesis (Onal, 2009), and it turns out (see Section 2) that the difficulties that arise in the presence of multiple suppliers do not introduce significant changes in the analysis.

The rest of the paper is organized as follows. In Section 2, we introduce and formulate the economic lot sizing problem with perishable items (ELS-PI). In Section 3, we discuss the effect of allocation mechanisms on the optimal objective function values. We derive structural properties of optimal solutions to the ELS-PI with no procurement capacities in Section 4, and propose solution algorithms. In Section 5, we analyze the computational complexity of the ELS-PI with procurement capacities. We conclude the paper, and discuss future research subjects in Section 6.

The ELS-PI is an economic lot-sizing problem over a discrete and finite planning horizon consisting of T periods. Demand in each period is satisfied by procurement from a single supplier with zero lead time. As soon as the items are procured, they are stored in a single location from where they are distributed to satisfy demands. The procurement amount in each period may be subject to limited capacity.

Each item in stock has a certain expiration date that depends on the period in which it is procured. Particularly, an item procured in period t expires after period vt
                      ≥ t (
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     ). Since we have a planning horizon of T periods, we assume that vt
                      ≤ T. We assume that there is no degradation in the quality of the item as long as its expiration date has not passed. Although all items in the stock are equivalent regardless of procurement or expiration date, we allow for an allocation mechanism that defines a preference order in the allocation of items to the consumers. More formally, an allocation mechanism is characterized by a preference order of the procurement periods, where we write i≻j if and only if items procured in period i must be consumed earlier than items procured in period j. Moreover, we write i ∼ j to denote indifference between items procured in periods i and j. This leads to the notation i≿j to indicate that items procured in period i are at least as preferred as items procured in period j, i.e., i≻j or i ∼ j.

We say that a period t (partially) satisfies the demand in period i if some items procured in period t are allocated to (partially) satisfy the demand in period i. For convenience, we associate a supply interval 
                        
                           F
                           
                              (
                              t
                              )
                           
                           =
                           
                              {
                              t
                              ,
                              …
                              ,
                              
                                 v
                                 t
                              
                              }
                           
                        
                      with each period t, consisting of periods whose demand can be satisfied by items procured in period t. To formulate the ELS-PI, we use the following additional notation:


                     Parameters:

                        
                           
                              
                                 
                                    
                                       
                                          D
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          demand
                                          
                                          in
                                          
                                          period
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          C
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          procurement
                                          
                                          capacity
                                          
                                          in
                                          
                                          period
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          S
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          fixed
                                          
                                          setup
                                          
                                          cost
                                          
                                          of
                                          
                                          procurement
                                          
                                          in
                                          
                                          period
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          p
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          unit
                                          
                                          procurement
                                          
                                          cost
                                          
                                          in
                                          
                                          period
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          h
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          unit
                                          
                                          inventory
                                          
                                          holding
                                          
                                          cost
                                          
                                          in
                                          
                                          period
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          c
                                          
                                             t
                                             i
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          variable
                                          
                                          cost
                                          
                                          to
                                          
                                          satisfy
                                          
                                          one
                                          
                                          unit
                                          
                                          of
                                          
                                          demand
                                          
                                          in
                                          
                                          period
                                          
                                          i
                                          
                                          by
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          procurement
                                          
                                          in
                                          
                                          period
                                          
                                          t
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             p
                                             t
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                t
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          
                                             h
                                             j
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                     Decision variables:

                        
                           
                              
                                 
                                    
                                       
                                          x
                                          
                                             t
                                             i
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          quantity
                                          
                                          procured
                                          
                                          in
                                          
                                          period
                                          
                                          t
                                          
                                          used
                                          
                                          to
                                          
                                          (partially)
                                          
                                          satisfy
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          demand
                                          
                                          in
                                          
                                          period
                                          
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          z
                                          
                                             t
                                             i
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          1
                                          
                                          if
                                          
                                          period
                                          
                                          t
                                          
                                          satisfies
                                          
                                          some
                                          
                                          demand
                                          
                                          in
                                          
                                          period
                                          
                                          i
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          (i.e.,
                                          
                                          if
                                          
                                          
                                             x
                                             
                                                t
                                                i
                                             
                                          
                                          >
                                          0
                                          ),
                                          
                                          0
                                          
                                          otherwise
                                       
                                    
                                 
                                 
                                    
                                       
                                          y
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          1
                                          
                                          if
                                          
                                          there
                                          
                                          is
                                          
                                          procurement
                                          
                                          in
                                          
                                          period
                                          
                                          t
                                          
                                          (i.e.,
                                          
                                          if
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                t
                                             
                                             
                                                v
                                                t
                                             
                                          
                                          
                                             x
                                             
                                                t
                                                i
                                             
                                          
                                          
                                             >
                                             0
                                             )
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          0
                                          
                                          otherwise
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Using the parameters and decision variables above, we formulate the ELS-PI as follows:

                        
                           (P)
                           
                              
                                 
                                    
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             T
                                          
                                          
                                             (
                                             
                                                S
                                                t
                                             
                                             
                                                y
                                                t
                                             
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   t
                                                
                                                
                                                   v
                                                   t
                                                
                                             
                                             
                                                c
                                                
                                                   t
                                                   i
                                                
                                             
                                             
                                                x
                                                
                                                   t
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          subject
                                          
                                          to
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                :
                                                i
                                                ∈
                                                F
                                                (
                                                t
                                                )
                                             
                                          
                                          
                                             x
                                             
                                                t
                                                i
                                             
                                          
                                          =
                                          
                                             D
                                             i
                                          
                                          
                                          for
                                          
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                t
                                             
                                             
                                                v
                                                t
                                             
                                          
                                          
                                             x
                                             
                                                t
                                                i
                                             
                                          
                                          ≤
                                          
                                             C
                                             t
                                          
                                          
                                          for
                                          
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                t
                                                i
                                             
                                          
                                          ≤
                                          
                                             D
                                             i
                                          
                                          
                                             z
                                             
                                                t
                                                i
                                             
                                          
                                          
                                          for
                                          
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ;
                                          
                                          i
                                          =
                                          t
                                          ,
                                          …
                                          ,
                                          
                                             v
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          
                                             z
                                             
                                                t
                                                i
                                             
                                          
                                          ≤
                                          
                                             y
                                             t
                                          
                                          
                                          for
                                          
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ;
                                          
                                          i
                                          =
                                          t
                                          ,
                                          …
                                          ,
                                          
                                             v
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                s
                                             
                                          
                                          +
                                          
                                             z
                                             
                                                j
                                                t
                                             
                                          
                                          ≤
                                          1
                                          
                                          for
                                          
                                          1
                                          ≤
                                          i
                                          ≤
                                          s
                                          ≤
                                          
                                             v
                                             i
                                          
                                          ;
                                          1
                                          ≤
                                          j
                                          ≤
                                          s
                                          <
                                          t
                                          ≤
                                          
                                             v
                                             j
                                          
                                          
                                          with
                                          
                                          j
                                          ≻
                                          i
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                             
                                                t
                                                i
                                             
                                          
                                          ≥
                                          0
                                          
                                          for
                                          
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ;
                                          
                                          i
                                          =
                                          t
                                          ,
                                          …
                                          ,
                                          
                                             v
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    
                                       
                                          
                                             z
                                             
                                                t
                                                i
                                             
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                          
                                          for
                                          
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ;
                                          
                                          i
                                          =
                                          t
                                          ,
                                          …
                                          ,
                                          
                                             v
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                             t
                                          
                                          ∈
                                          
                                             [
                                             0
                                             ,
                                             1
                                             ]
                                          
                                          
                                          for
                                          
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The objective function minimizes total procurement and holding costs. Constraints (1) ensure that demand in period i can only be satisfied by periods that contain period i in their supply intervals. Constraints (2) are the capacity constraints. Constraints (3) ensure that a period t can (partially) satisfy the demand in period i only if 
                        
                           
                              z
                              
                                 t
                                 i
                              
                           
                           =
                           1
                           ,
                        
                      while constraints (4) ensure that a period can (partially) satisfy the demand in period i only if a setup takes place in that period. Constraints (5) model the assumed allocation mechanism: for any pair of procurement periods j≻i, if period i (partially) satisfies period s, then a period j ≤ s cannot (partially) satisfy demand in a period t > s. Finally, constraints (6)–(8) specify the domains of the decision variables. Combining constraints (4) with (8) ensures that in an optimal solution the setup variables are binary.

Besides model (P), in which capacities are general, we consider two special cases: the problem with time-invariant procurement capacities (i.e., 
                        
                           
                              C
                              t
                           
                           =
                           C
                        
                      for 
                        
                           t
                           =
                           1
                           ,
                           ⋯
                           ,
                           T
                        
                     ) and the uncapacitated problem (i.e., 
                        
                           
                              C
                              t
                           
                           =
                           ∞
                        
                      for 
                        
                           t
                           =
                           1
                           ,
                           ⋯
                           ,
                           T
                        
                     ). To distinguish between problems with different allocation mechanisms and capacity assumptions, we refer to PU(M), PC(M) and P
                        
                           
                           
                              C
                              t
                           
                        
                     (M) as problem (P) under some allocation mechanism M with no, time-invariant, and time-variant capacities, respectively. For example, the uncapacitated version of problem (P) under the FEFO allocation mechanism (see also the next section) is denoted by PU(FEFO). Finally, we refer to P
                        
                           
                           
                              C
                              t
                           
                        
                     ( ∼ ) as the problem without a preference order.

In our analysis it will be useful to distinguish between an allocation plan and an aggregate plan. An allocation plan is characterized by the quantities {xti
                     } (
                        
                           i
                           =
                           t
                           ,
                           …
                           ,
                           
                              v
                              t
                           
                           ,
                        
                     
                     
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     ), where the variable xti
                      is called an allocation, and specifies how the procured items are distributed to satisfy demands. An allocation plan is called feasible if it is part of a feasible solution to (P). In contrast, an aggregate plan is characterized by the aggregate procurement quantities 
                        
                           
                              x
                              t
                           
                           :
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 t
                              
                              
                                 v
                                 t
                              
                           
                           
                              x
                              
                                 t
                                 i
                              
                           
                        
                      and the implied ending inventory levels 
                        
                           
                              I
                              t
                           
                           :
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              t
                           
                           
                              (
                              
                                 x
                                 i
                              
                              −
                              
                                 D
                                 i
                              
                              )
                           
                        
                      in each period t (
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     ). An aggregate plan is called feasible if the procurement in each period can satisfy demands disregarding the underlying preference order. A feasible allocation plan implies an associated feasible aggregate plan. However, a feasible aggregate plan may not have an associated feasible allocation plan for some allocation mechanisms. Throughout the paper, we use the notation x to either refer to an allocation plan or an aggregate plan, where the correct interpretation will be clear from the context. These x-variables can be represented as flows in a network. Fig. 1
                      is a representation of a three period problem with 
                        
                           
                              v
                              1
                           
                           =
                           3
                           ,
                        
                     
                     
                        
                           
                              v
                              2
                           
                           =
                           2
                        
                      and 
                        
                           
                              v
                              3
                           
                           =
                           3
                        
                     . The flows on the upper level arcs correspond to the aggregate plan, while the flows on the lower level arcs correspond to the allocations. The network representation can also help to graphically illustrate different allocation mechanisms. For example, a feasible solution to the problem with a FIFO mechanism cannot have any crossing arcs with positive flows.

In the remainder of the paper we will focus particularly on ‘natural’ allocation mechanisms that either represent the power structure between retailer and customer, or are dictated by the physical properties of the inventory system.

A customer who is allowed to select from the items in stock is likely to choose the ones with the longest remaining lifetime. In that case, the inventory is consumed in Last Expiration, First Out (LEFO) order. Formally, this allocation mechanism corresponds to the preference order defined by i≻j and i ∼ j if and only if vi
                      > vj
                      and 
                        
                           
                              v
                              i
                           
                           =
                           
                              v
                              j
                           
                           ,
                        
                      respectively. On the other hand, a retailer who controls the allocation of items will sell the ones with the shortest remaining life first. In this case the inventory is consumed in First Expiration, First Out (FEFO) order, and we have i≻j and i ∼ j if and only if vi
                      < vj
                      and 
                        
                           
                              v
                              i
                           
                           =
                           
                              v
                              j
                           
                           ,
                        
                      respectively.

If the inventory system is designed as a queue, so that newly procured items are placed at the back of the queue and demands are satisfied from the front of the queue, then items are allocated in First In, First Out order (FIFO). Formally, in this allocation mechanism we have i≻j if and only if i < j. On the other hand, if the inventory system is designed as a stack, then items are allocated in Last In, First Out (LIFO) order, and we have i≻j if and only if i > j.

Finally, our model can handle a setting with multiple suppliers as studied in Onal (2009). In this setting there are Kt
                      suppliers to choose from in each period t, where we let the pair (t, k) represent the supplier k in period t. Each supplier (t, k) has an associated expiration date vtk
                     , setup cost Stk
                     , unit purchase cost ptk
                      and procurement capacity Ctk
                     . We can easily transform such a multiple supplier problem with T periods to a 
                        
                           
                              ∑
                              
                                 t
                                 =
                                 1
                              
                              T
                           
                           
                              K
                              t
                           
                        
                      period problem with a single supplier in each period as follows. Between each pair of periods t
                     
                        
                           −
                           1
                        
                      and t we insert Kt
                     
                     
                        
                           −
                           1
                        
                      dummy periods with zero demand and zero inventory holding cost. We then associate the Kt
                      suppliers with these dummy periods (including the original period t) such that there is only one supplier in each period. All the supplier related costs remain the same but we transform the expiration periods of the items procured from each supplier accordingly. Therefore, all properties and algorithms that we derive for the single supplier case will also hold for the above multiple supplier case.

In this section we will show that, in terms of retailer costs, the FEFO allocation mechanism is the most attractive one, while the LEFO allocation mechanism is the least attractive one among all possible allocation mechanisms. Moreover, we will show that there exists no ordering w.r.t. the optimal costs between the FIFO and LIFO allocation mechanisms in general.

As is common in lot-sizing models, we use the concept of a regeneration interval (RI). An RI [t
                     1, t
                     2] (1 ≤ t
                     1 ≤ t
                     2 ≤ T) is an interval of periods [t
                     1, t
                     2] for which the aggregate plan satisfies 
                        
                           
                              I
                              
                                 
                                    t
                                    1
                                 
                                 −
                                 1
                              
                           
                           =
                           
                              I
                              
                                 t
                                 2
                              
                           
                           =
                           0
                        
                      and It
                      > 0 for t
                     1 ≤ t < t
                     2. Note that we use [t
                     1, t
                     2] as a shorthand notation for the set 
                        
                           {
                           
                              t
                              1
                           
                           ,
                           ⋯
                           ,
                           
                              t
                              2
                           
                           }
                        
                     . Clearly, any feasible solution to (P) can be decomposed into such RIs. Moreover, as long as the aggregate plan does not change, the composition of the RIs does not change either.

To prove the main theorem of this section, we will transform solutions that are feasible w.r.t. one mechanism into solutions that are feasible w.r.t. another mechanism. In order to facilitate this, we introduce a generic allocation algorithm. Given a feasible aggregate solution, Algorithm 1
                         allocates procurements to demands such that some allocation mechanism M is satisfied.

In each iteration t of the for loop, the variables d′ and Ii
                         represent the demand of period t that still needs to be allocated and the inventory of items procured in period i, respectively. Those variables are initialized by the demand and procurement quantity of that period (lines 4–5). In the while loop, the demand of some period t is satisfied by the inventory (probably consisting of items procured in different periods). We first select some inventory with the highest preference (line 7) and allocate as much of this inventory as possible to the current demand (line 8). The current demand and inventory levels are updated (lines 9–10) and the procedure continues, so that the allocation mechanism is satisfied in the end. For ease of notation, we denote by A(M) the algorithm with the assumed allocation mechanism M.


                        Lemmas 3.2 and 3.4 show that any feasible solution to P
                           
                              
                              
                                 C
                                 t
                              
                           
                        (M) can be transformed into a feasible solution to P
                           
                              
                              
                                 C
                                 t
                              
                           
                        (FEFO), and any feasible solution to P
                           
                              
                              
                                 C
                                 t
                              
                           
                        (LEFO) can be transformed into a feasible solution to P
                           
                              
                              
                                 C
                                 t
                              
                           
                        (M) for any arbitrary allocation mechanism M without changing the aggregate plans. To prove this, we will establish a few additional properties, which we state in Lemmas 3.1 and 3.3.

                           Lemma 3.1
                           Let x be a feasible allocation plan of P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (FEFO). Let j be a period in some RI [t
                              1, t
                              2] and t ∈ [t
                              1, j] be the procurement period with the latest expiration date satisfying period j. Then there exists a period u ∈ [t
                              1, t] such that for r ∈ [u, j], 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             ′
                                          
                                          r
                                       
                                    
                                    >
                                    0
                                 
                               implies t′ ∈ [u, j] and 
                                 
                                    
                                       v
                                       
                                          t
                                          ′
                                       
                                    
                                    ≤
                                    
                                       v
                                       t
                                    
                                 
                              .

We will show how to locate period u. Let period i
                              0 be the procurement period with the latest expiration date that satisfies period j ≥ i
                              0. Then 
                                 
                                    
                                       v
                                       t
                                    
                                    ≤
                                    
                                       v
                                       
                                          i
                                          0
                                       
                                    
                                 
                               for all t with xtr
                               > 0 for r ∈ [i
                              0, j], since x satisfies the FEFO rule. If t ≥ i
                              0 for all t with xtr
                               > 0 and r ∈ [i
                              0, j], then 
                                 
                                    u
                                    =
                                    
                                       i
                                       0
                                    
                                 
                              . Otherwise, there exist periods 
                                 
                                    u
                                    =
                                    
                                       i
                                       n
                                    
                                    <
                                    ⋯
                                    <
                                    
                                       i
                                       0
                                    
                                 
                               such that 
                                 
                                    
                                       i
                                       1
                                    
                                    =
                                    min
                                    
                                       {
                                       t
                                       :
                                       t
                                       <
                                       
                                          i
                                          0
                                       
                                       ,
                                       
                                          x
                                          
                                             t
                                             r
                                          
                                       
                                       >
                                       0
                                       ,
                                       r
                                       ∈
                                       
                                          [
                                          
                                             i
                                             0
                                          
                                          ,
                                          j
                                          ]
                                       
                                       }
                                    
                                 
                               and 
                                 
                                    
                                       i
                                       k
                                    
                                    =
                                    min
                                    
                                       {
                                       t
                                       :
                                       t
                                       <
                                       
                                          i
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                          x
                                          
                                             t
                                             r
                                          
                                       
                                       >
                                       0
                                       ,
                                       r
                                       ∈
                                       
                                          [
                                          
                                             i
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             i
                                             
                                                k
                                                −
                                                2
                                             
                                          
                                          −
                                          1
                                          ]
                                       
                                       }
                                    
                                 
                               for 
                                 
                                    k
                                    =
                                    2
                                    ,
                                    …
                                    ,
                                    n
                                 
                               with n as large as possible. By construction of the sequence, we have 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             ′
                                          
                                          r
                                       
                                    
                                    =
                                    0
                                 
                               for periods t′ < in
                               and r ∈ [in, j]. Furthermore, since x satisfies the FEFO rule, we have that (i) 
                                 
                                    
                                       v
                                       
                                          i
                                          k
                                       
                                    
                                    ≤
                                    
                                       v
                                       
                                          i
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                    
                                    ≤
                                    
                                       v
                                       
                                          i
                                          0
                                       
                                    
                                 
                               for 
                                 
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    ,
                                 
                               and (ii) if 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             ′
                                          
                                          r
                                       
                                    
                                    >
                                    0
                                 
                               for some 
                                 
                                    r
                                    ∈
                                    [
                                    
                                       i
                                       k
                                    
                                    ,
                                    
                                       i
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    −
                                    1
                                    ]
                                    ,
                                 
                               then 
                                 
                                    
                                       v
                                       
                                          t
                                          ′
                                       
                                    
                                    ≤
                                    
                                       v
                                       
                                          i
                                          k
                                       
                                    
                                    ≤
                                    
                                       v
                                       
                                          i
                                          0
                                       
                                    
                                 
                               for 
                                 
                                    k
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    n
                                 
                              . In conclusion, the interval [u, j] has the desired properties.□

To illustrate Lemma 3.1, Fig. 2
                         shows an RI 
                           
                              [
                              
                                 t
                                 1
                              
                              =
                              1
                              ,
                              
                                 t
                                 2
                              
                              =
                              7
                              ]
                           
                         in some allocation plan. If we start with period 
                           
                              j
                              =
                              7
                              ,
                           
                         then 
                           
                              
                                 i
                                 0
                              
                              =
                              1
                              ,
                           
                         leading to 
                           
                              u
                              =
                              1
                           
                         and the interval [1, 7]. Furthermore, because of the FEFO rule, we must have vi
                         ≤ v
                        1 for 
                           
                              i
                              =
                              2
                              ,
                              ⋯
                              ,
                              5
                           
                        . On the other hand, if we have 
                           
                              j
                              =
                              6
                              ,
                           
                         then 
                           
                              
                                 i
                                 0
                              
                              =
                              5
                              ,
                           
                        
                        
                           
                              
                                 i
                                 1
                              
                              =
                              3
                           
                         and 
                           
                              
                                 i
                                 2
                              
                              =
                              2
                              ,
                           
                         leading to 
                           
                              u
                              =
                              2
                           
                         and the interval [2, 6]. Again because of the FEFO rule, we must have v
                        2 ≤ v
                        3 ≤ v
                        5 but also v
                        4 ≤ v
                        3 ≤ v
                        5. Hence, both intervals [1, 7] and [2, 6] are examples that satisfy the properties of Lemma 3.1.

                           Lemma 3.2
                           Let x be a feasible allocation plan of P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (M) for some allocation mechanism M. Applying A(FEFO) to the aggregate plan of x leads to a feasible allocation plan x′ of P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (FEFO) with the same cost.

See Appendix A.□

Let x be a feasible allocation plan of P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (LEFO). If xτs
                               > 0 in RI [t
                              1, t
                              2], then vτ
                               ≥ t
                              2.

The proof is by contradiction. Assume there is some allocation 
                                 
                                    
                                       x
                                       
                                          
                                             i
                                             1
                                          
                                          
                                             s
                                             1
                                          
                                       
                                    
                                    >
                                    0
                                 
                               in the RI [t
                              1, t
                              2] with 
                                 
                                    
                                       v
                                       
                                          i
                                          1
                                       
                                    
                                    <
                                    
                                       t
                                       2
                                    
                                 
                              . Clearly, we have 
                                 
                                    
                                       s
                                       1
                                    
                                    ≤
                                    
                                       v
                                       
                                          i
                                          1
                                       
                                    
                                    <
                                    
                                       t
                                       2
                                    
                                 
                              . Since Iτ
                               > 0 for 
                                 
                                    τ
                                    ∈
                                    [
                                    
                                       t
                                       1
                                    
                                    ,
                                    
                                       t
                                       2
                                    
                                    −
                                    1
                                    ]
                                 
                               and hence 
                                 
                                    
                                       I
                                       
                                          s
                                          1
                                       
                                    
                                    >
                                    0
                                    ,
                                 
                               there exists some 
                                 
                                    
                                       x
                                       
                                          
                                             i
                                             2
                                          
                                          
                                             s
                                             2
                                          
                                       
                                    
                                    >
                                    0
                                 
                               with i
                              2 ≤ s
                              1 and s
                              2 > s
                              1. Since the solution satisfies the LEFO rule, we have 
                                 
                                    
                                       v
                                       
                                          i
                                          2
                                       
                                    
                                    ≤
                                    
                                       v
                                       
                                          i
                                          1
                                       
                                    
                                    <
                                    
                                       t
                                       2
                                    
                                 
                              . Repeating this argument, we find a sequence of 
                                 
                                    n
                                    ∈
                                    N
                                 
                               allocations 
                                 
                                    
                                       x
                                       
                                          
                                             i
                                             1
                                          
                                          
                                             s
                                             1
                                          
                                       
                                    
                                    ,
                                    
                                       x
                                       
                                          
                                             i
                                             2
                                          
                                          
                                             s
                                             2
                                          
                                       
                                    
                                    ,
                                    ⋯
                                    ,
                                    
                                       x
                                       
                                          
                                             i
                                             n
                                          
                                          
                                             s
                                             n
                                          
                                       
                                    
                                    >
                                    0
                                 
                               with 
                                 
                                    
                                       s
                                       n
                                    
                                    =
                                    
                                       t
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       v
                                       
                                          i
                                          n
                                       
                                    
                                    <
                                    
                                       t
                                       2
                                    
                                 
                              . This clearly contradicts the feasibility of the solution.□

Let x be a feasible allocation plan of P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (LEFO). If we apply A(M) to the aggregate plan of x for some allocation mechanism M, then the output x′ is a feasible allocation plan of P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (M) with the same cost.

As Algorithm 1 does not change the aggregate quantities, the RIs and costs of x and x′ are equal. Furthermore, due to Lemma 3.3, any procurement period t in some RI [t
                              1, t
                              2] has vt
                               ≥ t
                              2. Therefore, no items perish and hence, x′ is feasible.□

We are now ready to prove the main theorem.

                           Theorem 3.5
                           Problems P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (FEFO) and P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (LEFO) have the lowest and highest optimal objective function value, respectively, among all allocation mechanisms M.

It is sufficient to show that the following properties hold: (i) for each feasible solution to P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              ( ∼ ), there exists a feasible solution to the corresponding instance of P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (FEFO) with the same cost; and (ii) for a feasible solution to P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (LEFO) there exists a feasible solution for the corresponding instance of P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (M) with the same cost. Clearly, statements (i) and (ii) immediately follow from Lemmas 3.2 and 3.4, respectively.□


                        Theorem 3.5 identifies two allocation mechanisms that lead to the smallest (FEFO) and largest (LEFO) optimal cost. This implies that the other two common allocation mechanisms, FIFO and LIFO, have costs that are between these two extremes. The next theorem shows that, in general, neither the FIFO nor the LIFO allocation mechanism is guaranteed to dominate the other in terms of costs. In fact, the ratio of the optimal costs under these two mechanisms can be arbitrarily large or small.

                           Theorem 3.6
                           Let ϕFIFO
                              (I) and ϕLIFO
                              (I) denote the optimal costs of PU(FIFO) and PU(LIFO), respectively, for some instance I. Let 
                                 
                                    I
                                    U
                                 
                               denote the set of all uncapacitated problem instances. Then

                                 
                                    
                                       
                                          
                                             sup
                                             
                                                I
                                                ∈
                                                
                                                   I
                                                   U
                                                
                                             
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      ϕ
                                                      
                                                         L
                                                         I
                                                         F
                                                         O
                                                      
                                                   
                                                   
                                                      (
                                                      I
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                      
                                                         F
                                                         I
                                                         F
                                                         O
                                                      
                                                   
                                                   
                                                      (
                                                      I
                                                      )
                                                   
                                                
                                             
                                             }
                                          
                                          =
                                          ∞
                                          =
                                          
                                             sup
                                             
                                                I
                                                ∈
                                                
                                                   I
                                                   U
                                                
                                             
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      ϕ
                                                      
                                                         F
                                                         I
                                                         F
                                                         O
                                                      
                                                   
                                                   
                                                      (
                                                      I
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                      
                                                         L
                                                         I
                                                         F
                                                         O
                                                      
                                                   
                                                   
                                                      (
                                                      I
                                                      )
                                                   
                                                
                                             
                                             }
                                          
                                          .
                                       
                                    
                                 
                              Moreover, the result still holds for capacitated instances, even if the capacities are time-invariant.

The proof is based on two examples. To be precise, consider two uncapacitated problem instances I
                              1(α) and I
                              2(α), parameterized by a scalar α > 1, with planning horizon 
                                 
                                    T
                                    =
                                    3
                                    ,
                                 
                              
                              
                                 
                                    
                                       S
                                       t
                                    
                                    =
                                    
                                       h
                                       t
                                    
                                    =
                                    0
                                 
                               and 
                                 
                                    
                                       C
                                       t
                                    
                                    =
                                    ∞
                                 
                               (
                                 
                                    t
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                 
                              ), and the other problem data as in Table 1
                              .

The optimal aggregate plan for instance I
                              1(α) under the LIFO allocation mechanism is 
                                 
                                    x
                                    =
                                    (
                                    1
                                    ,
                                    α
                                    +
                                    1
                                    ,
                                    0
                                    )
                                 
                               with cost 
                                 
                                    
                                       ϕ
                                       LIFO
                                    
                                    
                                       (
                                       
                                          I
                                          1
                                       
                                       
                                          (
                                          α
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       α
                                       2
                                    
                                    +
                                    α
                                    +
                                    1
                                    ,
                                 
                               while the optimal aggregate plan under the FIFO allocation mechanism is 
                                 
                                    x
                                    =
                                    (
                                    1
                                    +
                                    α
                                    ,
                                    1
                                    ,
                                    0
                                    )
                                 
                               with cost 
                                 
                                    
                                       ϕ
                                       FIFO
                                    
                                    
                                       (
                                       
                                          I
                                          1
                                       
                                       
                                          (
                                          α
                                          )
                                       
                                       )
                                    
                                    =
                                    2
                                    α
                                    +
                                    1
                                 
                              . This implies that

                                 
                                    
                                       
                                          
                                             lim
                                             
                                                α
                                                →
                                                ∞
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                   LIFO
                                                
                                                
                                                   (
                                                   
                                                      I
                                                      1
                                                   
                                                   
                                                      (
                                                      α
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ϕ
                                                   FIFO
                                                
                                                
                                                   (
                                                   
                                                      I
                                                      1
                                                   
                                                   
                                                      (
                                                      α
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                          =
                                          
                                             lim
                                             
                                                α
                                                →
                                                ∞
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                   2
                                                
                                                +
                                                α
                                                +
                                                1
                                             
                                             
                                                2
                                                α
                                                +
                                                1
                                             
                                          
                                          =
                                          ∞
                                          .
                                       
                                    
                                 
                              Furthermore, the optimal aggregate plan for instance I
                              2(α) under the LIFO allocation mechanism is 
                                 
                                    x
                                    =
                                    (
                                    2
                                    ,
                                    α
                                    ,
                                    0
                                    )
                                 
                               with cost 
                                 
                                    
                                       ϕ
                                       LIFO
                                    
                                    
                                       (
                                       
                                          I
                                          2
                                       
                                       
                                          (
                                          α
                                          )
                                       
                                       )
                                    
                                    =
                                    3
                                    α
                                    ,
                                 
                               while the optimal aggregate plan under the FIFO allocation mechanism is 
                                 
                                    x
                                    =
                                    (
                                    α
                                    +
                                    2
                                    ,
                                    0
                                    ,
                                    0
                                    )
                                 
                               with cost 
                                 
                                    
                                       ϕ
                                       FIFO
                                    
                                    
                                       (
                                       
                                          I
                                          2
                                       
                                       
                                          (
                                          α
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       α
                                       2
                                    
                                    +
                                    2
                                    α
                                 
                              . This implies that

                                 
                                    
                                       
                                          
                                             lim
                                             
                                                α
                                                →
                                                ∞
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                   FIFO
                                                
                                                
                                                   (
                                                   
                                                      I
                                                      2
                                                   
                                                   
                                                      (
                                                      α
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ϕ
                                                   LIFO
                                                
                                                
                                                   (
                                                   
                                                      I
                                                      2
                                                   
                                                   
                                                      (
                                                      α
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                          =
                                          
                                             lim
                                             
                                                α
                                                →
                                                ∞
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                   2
                                                
                                                +
                                                2
                                                α
                                             
                                             
                                                3
                                                α
                                             
                                          
                                          =
                                          ∞
                                          .
                                       
                                    
                                 
                              
                           

Since any uncapacitated problem instance can be converted into an equivalent capacitated problem instance by choosing 
                                 
                                    
                                       C
                                       t
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             t
                                             ′
                                          
                                          =
                                          1
                                       
                                       T
                                    
                                    
                                       d
                                       
                                          t
                                          ′
                                       
                                    
                                 
                               (
                                 
                                    t
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    T
                                 
                              ), the results hold for the ELS-PI with (time-invariant) procurement capacities as well.□

We will use a few structural properties of optimal solutions to develop efficient algorithms for the uncapacitated ELS-PI. The first structural property we introduce is the unique procurement property, which holds true under any allocation mechanism.

                           Theorem 4.1
                           Let M be an allocation mechanism. Then there exists an optimal solution to PU(M) such that demand in each period is satisfied by a unique procurement period.

Problem P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (M) (and hence PU(M)) can be viewed as a concave network flow problem (see also Fig. 1) with additional constraints imposed by the allocation mechanism. Following Zangwill (1968), given that there are no capacity restrictions, an extreme point solution does not contain any cycle (constraints (3)–(5) will not be violated after removing a cycle). Clearly, in an extreme point solution to PU(M), every demand is satisfied by a unique procurement period. Since we can find an optimal solution among the extreme point solutions, the theorem follows.□

If the allocation mechanism is FEFO, LEFO, FIFO or LIFO (or if there is no allocation mechanism at all), we can generalize the unique procurement property to Theorem 4.2, which states that periods i and j do not both partially satisfy the demand in the interval F(i)∩F(j).

                           Theorem 4.2
                           There is an optimal solution to PU(M) for M ∈ {FEFO, LEFO, FIFO, LIFO}, such that for any two procurement periods i and j (i ≠ j), either 
                                 
                                    
                                       x
                                       
                                          i
                                          r
                                       
                                    
                                    =
                                    0
                                 
                               or 
                                 
                                    
                                       x
                                       
                                          j
                                          r
                                       
                                    
                                    =
                                    0
                                 
                               for all r ∈ F(i)∩F(j).

See Appendix B.□

We emphasize that Theorem 4.2 does not necessarily hold for all allocation mechanisms. For example, consider a 4-period instance with preference order 1≻3≻2≻4, 
                           
                              
                                 S
                                 t
                              
                              =
                              
                                 h
                                 t
                              
                              =
                              0
                           
                         (
                           
                              t
                              =
                              1
                              ,
                              ⋯
                              ,
                              4
                           
                        ) and other parameters as in Table 2
                        . It can be verified that the unique optimal solution has 
                           
                              
                                 x
                                 12
                              
                              =
                              
                                 x
                                 24
                              
                              =
                              
                                 x
                                 33
                              
                              =
                              1
                           
                         with cost 10. Clearly, this solution does not satisfy Theorem 4.2 since 
                           
                              F
                              (
                              1
                              )
                              ∩
                              F
                              (
                              2
                              )
                              =
                              [
                              2
                              ,
                              4
                              ]
                           
                         and x
                        12, x
                        24 > 0.

                           Corollary 4.3
                           Let x be an optimal solution to PU(M) for M ∈ {FEFO, LEFO, FIFO, LIFO} satisfying Theorems 4.1 and 4.2. Suppose that 
                                 
                                    
                                       x
                                       
                                          t
                                          i
                                       
                                    
                                    =
                                    
                                       D
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       x
                                       
                                          t
                                          ℓ
                                       
                                    
                                    =
                                    
                                       D
                                       ℓ
                                    
                                 
                               for some procurement period t with t ≤ i ≤ ℓ ≤ vt
                              . Then, if 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             ′
                                          
                                          k
                                       
                                    
                                    =
                                    
                                       D
                                       k
                                    
                                 
                               for some 
                                 
                                    k
                                    ∈
                                    [
                                    i
                                    +
                                    1
                                    ,
                                    ℓ
                                    −
                                    1
                                    ]
                                    ,
                                 
                               we have that 
                                 
                                    k
                                    ∈
                                    
                                       [
                                       
                                          t
                                          ′
                                       
                                       ,
                                       
                                          v
                                          
                                             t
                                             ′
                                          
                                       
                                       ]
                                    
                                    ⊆
                                    
                                       [
                                       i
                                       +
                                       1
                                       ,
                                       ℓ
                                       −
                                       1
                                       ]
                                    
                                 
                              .

The above result, following from Theorem 4.2, implies that if the earliest and the latest periods satisfied by a period t are i and l respectively, the allocation plan within periods i and l is independent of the allocation plan prior to period i (except that period t can satisfy any demand in the interval [i, ℓ]) and after period l. Therefore, we can independently optimize the allocation plan between i and ℓ. In other words, an optimal solution is composed of independent subintervals [τ
                        1, τ
                        2] such that (i) periods τ
                        1 and τ
                        2 are the first and the last periods satisfied by the same period t
                        1, 
                           
                              
                                 t
                                 1
                              
                              ≤
                              
                                 τ
                                 1
                              
                              ≤
                              
                                 τ
                                 2
                              
                              ≤
                              
                                 v
                                 
                                    t
                                    1
                                 
                              
                           
                        ; (ii) no period before period τ
                        1, other than t
                        1, can satisfy the demand in [τ
                        1, τ
                        2]. We refer to such intervals as subplans and denote such a subplan by SP [t
                        1; τ
                        1, τ
                        2]. We note that a subplan is not equal to a regeneration interval. In fact, a regeneration interval may consist of a sequence of subplans. More importantly, inside any subplan, there might exist several other subplans. These observations are summarized in the following corollary.

                           Corollary 4.4
                           Let x be an optimal solution to PU(M) for M ∈ {FEFO, LEFO, FIFO, LIFO} satisfying Theorems 4.1 and 4.2. Let periods j and ℓ be such that (a) 
                                 
                                    j
                                    =
                                    0
                                 
                               and 
                                 
                                    ℓ
                                    =
                                    T
                                    +
                                    1
                                    ,
                                 
                               or (b) 
                                 
                                    
                                       x
                                       
                                          t
                                          j
                                       
                                    
                                    =
                                    
                                       D
                                       j
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       
                                          t
                                          ℓ
                                       
                                    
                                    =
                                    
                                       D
                                       ℓ
                                    
                                 
                               and t′ ≠ t for all 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             ′
                                          
                                          k
                                       
                                    
                                    =
                                    
                                       D
                                       k
                                    
                                 
                               with 
                                 
                                    k
                                    ∈
                                    [
                                    j
                                    +
                                    1
                                    ,
                                    ℓ
                                    −
                                    1
                                    ]
                                 
                              . Then there exists a sequence of N subplans SP 
                                 
                                    [
                                    
                                       t
                                       k
                                    
                                    ;
                                    
                                       i
                                       k
                                    
                                    ,
                                    
                                       i
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                    ]
                                 
                               (
                                 
                                    k
                                    =
                                    1
                                    ,
                                    ⋯
                                    ,
                                    N
                                 
                              ) such that

                                 
                                    (i)
                                    
                                       
                                          
                                             j
                                             +
                                             1
                                             =
                                             
                                                t
                                                1
                                             
                                             =
                                             
                                                i
                                                1
                                             
                                             <
                                             
                                                i
                                                2
                                             
                                             <
                                             ⋯
                                             <
                                             
                                                i
                                                
                                                   N
                                                   +
                                                   1
                                                
                                             
                                             =
                                             ℓ
                                             ,
                                          
                                       
                                    


                                       j < tk
                                        < ℓ (
                                          
                                             k
                                             =
                                             1
                                             ,
                                             ⋯
                                             ,
                                             N
                                          
                                       ), and


                                       
                                          
                                             
                                                t
                                                k
                                             
                                             ≠
                                             
                                                t
                                                
                                                   k
                                                   ′
                                                
                                             
                                          
                                        for k ≠ k′ (
                                          
                                             k
                                             ,
                                             
                                                k
                                                ′
                                             
                                             =
                                             1
                                             ,
                                             ⋯
                                             ,
                                             N
                                          
                                       ).

Under condition (a) the corollary states that the whole horizon [1, T] can be decomposed into a sequence of subplans, while under condition (b) it states that a subplan itself may contain a sequence of subplans as well. In the following sections, we are going to investigate additional properties of optimal solutions of the ELS-PI under the FEFO, LEFO, FIFO and LIFO allocation mechanisms and propose solution algorithms.

We will develop a dynamic programming (DP) algorithm that is based on Corollary 4.4. To be more precise, we will develop an algorithm that produces a solution satisfying Corollary 4.4(i), but not necessarily Corollary 4.4(ii) or (iii). As a result, the obtained solution may not satisfy the FEFO allocation mechanism, as we will discuss in more detail later. However, by Lemma 3.2, any allocation plan can always be transformed into a plan that is feasible under the FEFO allocation mechanism.

In order to develop the DP algorithm, let f(t; τ
                        1, τ
                        2), 1 ≤ t ≤ τ
                        1 ≤ τ
                        2 ≤ vt
                        , be the minimal cost of SP [t; τ
                        1, τ
                        2]. Furthermore, let g(t; τ
                        1, τ
                        2), 1 ≤ t ≤ τ
                        1 ≤ vt
                         and τ
                        1 ≤ τ
                        2 ≤ T, be the minimal cost of a sequence of subplans on the interval [τ
                        1, τ
                        2], where demand in period τ
                        1 is satisfied by period t. Note that outside the specified ranges, the (sequences of) subplans are not feasible and hence not defined. Finally, we let f(τ
                        1, τ
                        2) be the minimal cost subplan and g(τ
                        1, τ
                        2) the minimal cost sequence of subplans over all procurements periods in the interval [τ
                        1, τ
                        2], 1 ≤ τ
                        1 ≤ τ
                        2 ≤ T, which are given by

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                (
                                                
                                                   τ
                                                   1
                                                
                                                ,
                                                
                                                   τ
                                                   2
                                                
                                                )
                                             
                                             =
                                             
                                                min
                                                
                                                   t
                                                   :
                                                   t
                                                   ≤
                                                   
                                                      τ
                                                      1
                                                   
                                                   ≤
                                                   
                                                      τ
                                                      2
                                                   
                                                   ≤
                                                   
                                                      v
                                                      t
                                                   
                                                
                                             
                                             
                                                {
                                                f
                                                
                                                   (
                                                   t
                                                   ;
                                                   
                                                      τ
                                                      1
                                                   
                                                   ,
                                                   
                                                      τ
                                                      2
                                                   
                                                   )
                                                
                                                }
                                             
                                             
                                             and
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             g
                                             
                                                (
                                                
                                                   τ
                                                   1
                                                
                                                ,
                                                
                                                   τ
                                                   2
                                                
                                                )
                                             
                                             =
                                             
                                                min
                                                
                                                   t
                                                   :
                                                   t
                                                   ≤
                                                   
                                                      τ
                                                      1
                                                   
                                                   ≤
                                                   
                                                      v
                                                      t
                                                   
                                                
                                             
                                             
                                                {
                                                g
                                                
                                                   (
                                                   t
                                                   ;
                                                   
                                                      τ
                                                      1
                                                   
                                                   ,
                                                   
                                                      τ
                                                      2
                                                   
                                                   )
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Since any sequence of subplans starts with a single SP [t; τ
                        1, τ
                        2] followed by a (possibly empty) sequence of subplans, it follows that

                           
                              (11)
                              
                                 
                                    g
                                    
                                       (
                                       t
                                       ;
                                       
                                          τ
                                          1
                                       
                                       ,
                                       
                                          τ
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       min
                                       
                                          τ
                                          :
                                          
                                             τ
                                             1
                                          
                                          ≤
                                          τ
                                          ≤
                                          
                                             τ
                                             2
                                          
                                       
                                    
                                    
                                       {
                                       f
                                       
                                          (
                                          t
                                          ;
                                          
                                             τ
                                             1
                                          
                                          ,
                                          τ
                                          )
                                       
                                       +
                                       g
                                       
                                          (
                                          τ
                                          +
                                          1
                                          ,
                                          
                                             τ
                                             2
                                          
                                          )
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        If we substitute (11) into (10), then we can equivalently define g(τ
                        1, τ
                        2) as

                           
                              
                                 
                                    
                                       
                                          
                                             g
                                             (
                                             
                                                τ
                                                1
                                             
                                             ,
                                             
                                                τ
                                                2
                                             
                                             )
                                          
                                       
                                       
                                          
                                             =
                                             
                                                min
                                                
                                                   t
                                                   :
                                                   t
                                                   ≤
                                                   
                                                      τ
                                                      1
                                                   
                                                   ≤
                                                   
                                                      v
                                                      t
                                                   
                                                
                                             
                                             
                                                {
                                                g
                                                
                                                   (
                                                   t
                                                   ;
                                                   
                                                      τ
                                                      1
                                                   
                                                   ,
                                                   
                                                      τ
                                                      2
                                                   
                                                   )
                                                
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                min
                                                
                                                   t
                                                   :
                                                   t
                                                   ≤
                                                   
                                                      τ
                                                      1
                                                   
                                                   ≤
                                                   
                                                      v
                                                      t
                                                   
                                                
                                             
                                             
                                                {
                                                
                                                   min
                                                   
                                                      τ
                                                      :
                                                      
                                                         τ
                                                         1
                                                      
                                                      ≤
                                                      τ
                                                      ≤
                                                      
                                                         τ
                                                         2
                                                      
                                                   
                                                
                                                
                                                   {
                                                   f
                                                   
                                                      (
                                                      t
                                                      ;
                                                      
                                                         τ
                                                         1
                                                      
                                                      ,
                                                      τ
                                                      )
                                                   
                                                   +
                                                   g
                                                   
                                                      (
                                                      τ
                                                      +
                                                      1
                                                      ,
                                                      
                                                         τ
                                                         2
                                                      
                                                      )
                                                   
                                                   }
                                                
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                min
                                                
                                                   τ
                                                   :
                                                   
                                                      τ
                                                      1
                                                   
                                                   ≤
                                                   τ
                                                   ≤
                                                   
                                                      τ
                                                      2
                                                   
                                                
                                             
                                             
                                                {
                                                
                                                   min
                                                   
                                                      t
                                                      :
                                                      t
                                                      ≤
                                                      
                                                         τ
                                                         1
                                                      
                                                      ≤
                                                      
                                                         v
                                                         t
                                                      
                                                   
                                                
                                                
                                                   {
                                                   f
                                                   (
                                                   t
                                                   ;
                                                   
                                                      τ
                                                      1
                                                   
                                                   ,
                                                   τ
                                                   )
                                                   }
                                                
                                                +
                                                g
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   ,
                                                   
                                                      τ
                                                      2
                                                   
                                                   )
                                                
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                min
                                                
                                                   τ
                                                   :
                                                   
                                                      τ
                                                      1
                                                   
                                                   ≤
                                                   τ
                                                   ≤
                                                   
                                                      τ
                                                      2
                                                   
                                                
                                             
                                             
                                                {
                                                f
                                                
                                                   (
                                                   
                                                      τ
                                                      1
                                                   
                                                   ,
                                                   τ
                                                   )
                                                
                                                +
                                                g
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   ,
                                                   
                                                      τ
                                                      2
                                                   
                                                   )
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The interpretation is similar to that of (11), but now we start with a minimum cost subplan on the interval [τ
                        1, τ
                        2]. Furthermore, since a subplan extends an existing subplan or it contains a (possibly empty) sequence of subplans by Corollary 4.4(i), it follows that for τ
                        1 < τ
                        2
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             f
                                             (
                                             t
                                             ;
                                             
                                                τ
                                                1
                                             
                                             ,
                                             
                                                τ
                                                2
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                             
                                             =
                                             
                                             
                                          
                                       
                                       
                                          
                                             min
                                             {
                                             f
                                             
                                                (
                                                t
                                                ;
                                                
                                                   τ
                                                   1
                                                
                                                ,
                                                
                                                   τ
                                                   2
                                                
                                                
                                                −
                                                
                                                1
                                                )
                                             
                                             
                                             +
                                             
                                             
                                                c
                                                
                                                   t
                                                   
                                                      τ
                                                      2
                                                   
                                                
                                             
                                             
                                                D
                                                
                                                   τ
                                                   2
                                                
                                             
                                             ,
                                             g
                                             
                                                (
                                                t
                                                ;
                                                
                                                   τ
                                                   1
                                                
                                                ,
                                                
                                                   τ
                                                   2
                                                
                                                
                                                −
                                                
                                                1
                                                )
                                             
                                             
                                             +
                                             
                                             
                                                c
                                                
                                                   t
                                                   
                                                      τ
                                                      2
                                                   
                                                
                                             
                                             
                                                D
                                                
                                                   τ
                                                   2
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             g
                                             
                                                (
                                                t
                                                ;
                                                
                                                   τ
                                                   1
                                                
                                                ,
                                                
                                                   τ
                                                   2
                                                
                                                −
                                                1
                                                )
                                             
                                             +
                                             
                                                c
                                                
                                                   t
                                                   
                                                      τ
                                                      2
                                                   
                                                
                                             
                                             
                                                D
                                                
                                                   τ
                                                   2
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where the equality holds because g(t; τ
                        1, τ
                        2) ≤ f(t; τ
                        1, τ
                        2) by (11). Finally, the DP recursion is initialized by

                           
                              
                                 
                                    
                                       
                                       
                                          
                                             f
                                             
                                                (
                                                t
                                                ;
                                                τ
                                                ,
                                                τ
                                                )
                                             
                                             =
                                             
                                                S
                                                t
                                             
                                             +
                                             
                                                c
                                                
                                                   t
                                                   τ
                                                
                                             
                                             
                                                D
                                                τ
                                             
                                             
                                             and
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             g
                                             (
                                             t
                                             ;
                                             τ
                                             ,
                                             τ
                                             −
                                             1
                                             )
                                             =
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Note that the above DP recursion is not a traditional forward or backward algorithm as often seen for lot-sizing problems. Since (sequences of) subplans may be contained in subplans, we should start with the subplans defined on the smallest intervals. Hence, the correct order of computation is to subsequently compute f(t; τ
                        1, τ
                        2), g(t; τ
                        1, τ
                        2), f(τ
                        1, τ
                        2) and g(τ
                        1, τ
                        2) for all feasible combinations of t, τ
                        1 and τ
                        2, where we start with 
                           
                              
                                 τ
                                 2
                              
                              −
                              
                                 τ
                                 1
                              
                              =
                              0
                           
                         and end with 
                           
                              
                                 τ
                                 2
                              
                              −
                              
                                 τ
                                 1
                              
                              =
                              T
                              −
                              1
                           
                        .

Our algorithm is summarized in Algorithm 2
                        . The algorithm is initiated in lines 1–7 by computing f(τ, τ) and g(τ, τ) for 
                           
                              τ
                              =
                              1
                              ,
                              …
                              ,
                              T
                           
                        . It is then continued in lines 8–16 by computing 
                           
                              g
                              (
                              τ
                              ,
                              τ
                              +
                              k
                              )
                           
                         for 
                           
                              τ
                              =
                              1
                              ,
                              …
                              ,
                              T
                           
                         in increasing order of k, 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              T
                              −
                              τ
                           
                        . Due to the order of operations, when we arrive at lines 11 and 12, all the values of 
                           
                              f
                              (
                              t
                              ;
                              τ
                              ,
                              τ
                              +
                              
                                 k
                                 ′
                              
                              )
                           
                         and 
                           
                              g
                              (
                              t
                              ;
                              τ
                              ,
                              τ
                              +
                              
                                 k
                                 ′
                              
                              )
                           
                         are known for 1 ≤ k′ < k, and hence those lines can be feasibly executed. It is not difficult to see that the bottleneck of the algorithm is the computation of all values 
                           
                              g
                              (
                              t
                              ;
                              τ
                              ,
                              τ
                              +
                              k
                              )
                           
                         in line 12 taking 
                           
                              O
                              (
                              
                                 T
                                 4
                              
                              )
                           
                         time. In conclusion, the optimal objective value g(1, T) of the overall problem can be found in 
                           
                              O
                              (
                              
                                 T
                                 4
                              
                              )
                           
                         time.

As mentioned before, the final solution may not satisfy all optimality properties derived so far. First, since we minimize over all feasible procurement periods in (9) and (10), a subplan within SP [t; τ
                        1, τ
                        2] may be satisfied by some procurement period t < τ
                        1, which violates Corollary 4.4(ii) (and Corollary 4.3). Second, we do not require in (11) that the sequence of subplans corresponding to 
                           
                              g
                              (
                              τ
                              +
                              1
                              ,
                              
                                 τ
                                 2
                              
                              )
                           
                         does not contain a subplan of which the first demand is procured by period t. Hence, in the final solution Corollary 4.4(iii) may be violated as well. However, since the costs are concave, this can only happen if the setup cost in period t is zero. Third, we do not require in (11) and (12) that the property of Theorem 4.2 holds. A violation of this theorem can only occur if the marginal procurement costs are the same in some periods. Nevertheless, a minimum cost solution satisfying Theorem 4.2 can be obtained by applying the procedure outlined in the proof of that theorem. Although the obtained minimum cost solution may fail to satisfy all corollaries, it is feasible with respect to perishability and demand satisfaction. Hence, by applying A(FEFO) to the obtained solution, we find an optimal solution that satisfies the FEFO allocation mechanism. In conclusion, problem PU(FEFO) can be solved in 
                           
                              O
                              (
                              
                                 T
                                 4
                              
                              )
                           
                         time.

Let x be a feasible allocation plan of the uncapacitated ELS-PI that satisfies Corollary 4.4. A necessary condition for x to satisfy the LIFO allocation mechanism is that 
                           
                              
                                 x
                                 
                                    t
                                    t
                                 
                              
                              =
                              
                                 D
                                 t
                              
                           
                         for every procurement period t. In other words, under the LIFO allocation mechanism, only subplans of the form SP [τ
                        1; τ
                        1, τ
                        2] exist. Therefore, we restate Corollary 4.4 as follows.

                           Corollary 4.5
                           Let x be an optimal solution to PU(LIFO) satisfying Theorems 4.1 and 4.2. Let periods j and ℓ be such that (a) 
                                 
                                    j
                                    =
                                    0
                                 
                               and 
                                 
                                    ℓ
                                    =
                                    T
                                    +
                                    1
                                    ,
                                 
                               or (b) 
                                 
                                    
                                       x
                                       
                                          t
                                          j
                                       
                                    
                                    =
                                    
                                       D
                                       j
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       
                                          t
                                          ℓ
                                       
                                    
                                    =
                                    
                                       D
                                       ℓ
                                    
                                 
                               and t′ ≠ t for all 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             ′
                                          
                                          k
                                       
                                    
                                    =
                                    
                                       D
                                       k
                                    
                                 
                               with 
                                 
                                    k
                                    ∈
                                    [
                                    j
                                    +
                                    1
                                    ,
                                    ℓ
                                    −
                                    1
                                    ]
                                 
                              . Then there exists a sequence of N subplans 
                                 
                                    S
                                    P
                                    [
                                    
                                       t
                                       k
                                    
                                    ;
                                    
                                       t
                                       k
                                    
                                    ,
                                    
                                       t
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                    ]
                                 
                               (
                                 
                                    k
                                    =
                                    1
                                    ,
                                    ⋯
                                    ,
                                    n
                                 
                              ) such that 
                                 
                                    j
                                    +
                                    1
                                    =
                                    
                                       t
                                       1
                                    
                                    <
                                    
                                       t
                                       2
                                    
                                    <
                                    ⋯
                                    <
                                    
                                       t
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    =
                                    ℓ
                                 
                              .

Our DP algorithm is based on Corollary 4.5 and the above mentioned special form of the subplans. Because of this special form, the DP variables have one less index compared to the FEFO case. Let f(τ
                        1, τ
                        2), 
                           
                              1
                              ≤
                              
                                 τ
                                 1
                              
                              ≤
                              
                                 τ
                                 2
                              
                              ≤
                              
                                 v
                                 
                                    τ
                                    1
                                 
                              
                              ,
                           
                         be the minimal cost of SP [τ
                        1; τ
                        1, τ
                        2]. Furthermore, let g(τ
                        1, τ
                        2), 1 ≤ τ
                        1 ≤ τ
                        2 ≤ T, be the minimal cost of a sequence of subplans on the interval [τ
                        1, τ
                        2]. Then, using similar arguments as in the FEFO case, we have

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             g
                                             
                                                (
                                                
                                                   τ
                                                   1
                                                
                                                ,
                                                
                                                   τ
                                                   2
                                                
                                                )
                                             
                                             =
                                             
                                                min
                                                
                                                   τ
                                                   :
                                                   
                                                      τ
                                                      1
                                                   
                                                   ≤
                                                   τ
                                                   ≤
                                                   
                                                      τ
                                                      2
                                                   
                                                
                                             
                                             
                                                {
                                                f
                                                
                                                   (
                                                   
                                                      τ
                                                      1
                                                   
                                                   ,
                                                   τ
                                                   )
                                                
                                                +
                                                g
                                                
                                                   (
                                                   τ
                                                   +
                                                   1
                                                   ,
                                                   
                                                      τ
                                                      2
                                                   
                                                   )
                                                
                                                }
                                             
                                             
                                             and
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                (
                                                
                                                   τ
                                                   1
                                                
                                                ,
                                                
                                                   τ
                                                   2
                                                
                                                )
                                             
                                             =
                                             g
                                             
                                                (
                                                
                                                   τ
                                                   1
                                                
                                                ,
                                                
                                                   τ
                                                   2
                                                
                                                −
                                                1
                                                )
                                             
                                             +
                                             
                                                c
                                                
                                                   
                                                      τ
                                                      1
                                                   
                                                   
                                                      τ
                                                      2
                                                   
                                                
                                             
                                             
                                                D
                                                
                                                   τ
                                                   2
                                                
                                             
                                             
                                             for
                                             
                                             
                                                τ
                                                1
                                             
                                             <
                                             
                                                τ
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with the initial conditions

                           
                              
                                 
                                    
                                       
                                       
                                          
                                             f
                                             
                                                (
                                                τ
                                                ,
                                                τ
                                                )
                                             
                                             =
                                             
                                                S
                                                τ
                                             
                                             +
                                             
                                                c
                                                
                                                   τ
                                                   τ
                                                
                                             
                                             
                                                D
                                                τ
                                             
                                             
                                             and
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             g
                                             (
                                             τ
                                             ,
                                             τ
                                             −
                                             1
                                             )
                                             =
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        As in Section 4.2, we subsequently compute f(τ
                        1, τ
                        2) and g(τ
                        1, τ
                        2) for all feasible combinations of τ
                        1 and τ
                        2, where we start with 
                           
                              
                                 τ
                                 2
                              
                              −
                              
                                 τ
                                 1
                              
                              =
                              0
                           
                         and end with 
                           
                              
                                 τ
                                 2
                              
                              −
                              
                                 τ
                                 1
                              
                              =
                              T
                              −
                              1
                           
                        . These computations can be handled by executing lines 2–5 and lines 11–12 only for 
                           
                              t
                              =
                              τ
                           
                         in Algorithm 2. Clearly, this reduces the overall complexity by a factor of T, and we conclude that problem PU(LIFO) can be solved in 
                           
                              O
                              (
                              
                                 T
                                 3
                              
                              )
                           
                         time.

When the allocation mechanism is FIFO, the consumption of items procured in a particular period does not start unless all the items that were procured in earlier periods have been consumed. Together with the unique procurement property, this implies that items procured in a period satisfy the demands of a set of consecutive periods as stated in Theorem 4.6.

                           Theorem 4.6
                           Suppose there are N procurement periods 1 ≤ t
                              1 < ⋅⋅⋅ < tN
                               ≤ T in an optimal solution to PU(FIFO) that satisfies Theorems 4.1 and 4.2. Then, this solution is decomposed into N subplans of the form SP 
                                 
                                    [
                                    
                                       t
                                       k
                                    
                                    ;
                                    
                                       i
                                       k
                                    
                                    ,
                                    
                                       i
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                    ]
                                    ,
                                 
                               where 
                                 
                                    
                                       i
                                       1
                                    
                                    =
                                    
                                       t
                                       1
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       i
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    =
                                    T
                                    +
                                    1
                                 
                               and 
                                 
                                    
                                       i
                                       k
                                    
                                    =
                                    
                                       t
                                       k
                                    
                                    ≤
                                    
                                       v
                                       
                                          
                                             t
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          −
                                          1
                                       
                                    
                                 
                               or 
                                 
                                    
                                       i
                                       k
                                    
                                    =
                                    
                                       v
                                       
                                          t
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                    
                                    +
                                    1
                                 
                               for 
                                 
                                    k
                                    =
                                    2
                                    ,
                                    …
                                    ,
                                    N
                                 
                              .

Due to the nature of the FIFO allocation mechanism, every procurement period tk
                               should completely satisfy demand of consecutive periods in some interval 
                                 
                                    [
                                    
                                       i
                                       k
                                    
                                    ,
                                    
                                       i
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                    ]
                                    ,
                                 
                               where 
                                 
                                    
                                       t
                                       k
                                    
                                    ≤
                                    
                                       i
                                       k
                                    
                                    ≤
                                    
                                       i
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    −
                                    1
                                    ≤
                                    
                                       v
                                       
                                          t
                                          k
                                       
                                    
                                 
                               for 
                                 
                                    k
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                              . Obviously, we have 
                                 
                                    
                                       i
                                       1
                                    
                                    =
                                    
                                       t
                                       1
                                    
                                    ,
                                 
                               because there exists no earlier period to satisfy the demand in i
                              1. We need to prove that in a solution that satisfies Theorem 4.2, we should have 
                                 
                                    
                                       i
                                       k
                                    
                                    =
                                    
                                       t
                                       k
                                    
                                 
                               or 
                                 
                                    
                                       i
                                       k
                                    
                                    =
                                    
                                       v
                                       
                                          
                                             t
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          −
                                          1
                                       
                                    
                                 
                               for 1 < k ≤ N.

For some k with 1 < k ≤ N, consider two procurement periods 
                                 
                                    t
                                    
                                       k
                                       −
                                       1
                                    
                                 
                               and tk
                              . Due to Theorem 4.2, we have either (i) 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             k
                                          
                                          i
                                       
                                    
                                    =
                                    0
                                 
                               or (ii) 
                                 
                                    
                                       x
                                       
                                          t
                                          
                                             k
                                             −
                                             1
                                             ,
                                             i
                                          
                                       
                                    
                                    =
                                    0
                                 
                               for 
                                 
                                    i
                                    ∈
                                    F
                                    
                                       (
                                       
                                          t
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    ∩
                                    F
                                    
                                       (
                                       
                                          t
                                          k
                                       
                                       )
                                    
                                    =
                                    
                                       [
                                       
                                          t
                                          k
                                       
                                       ,
                                       min
                                       
                                          {
                                          
                                             v
                                             
                                                t
                                                k
                                             
                                          
                                          ,
                                          
                                             v
                                             
                                                t
                                                
                                                   k
                                                   −
                                                   1
                                                
                                             
                                          
                                          }
                                       
                                       ]
                                    
                                 
                              . If (i) is true, then we have 
                                 
                                    min
                                    
                                       {
                                       
                                          v
                                          
                                             t
                                             k
                                          
                                       
                                       ,
                                       
                                          v
                                          
                                             t
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                       
                                       }
                                    
                                    =
                                    
                                       v
                                       
                                          t
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                    
                                 
                               (otherwise tk
                               cannot be a procurement period) and 
                                 
                                    
                                       i
                                       k
                                    
                                    =
                                    
                                       v
                                       
                                          t
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                    
                                    +
                                    1
                                 
                              . On the other hand, if (ii) is true, then 
                                 
                                    
                                       x
                                       
                                          t
                                          
                                             
                                                k
                                                ′
                                             
                                             i
                                          
                                       
                                    
                                    =
                                    0
                                 
                               for 
                                 
                                    
                                       k
                                       ′
                                    
                                    <
                                    k
                                    −
                                    1
                                 
                               and 
                                 
                                    i
                                    ∈
                                    [
                                    
                                       t
                                       k
                                    
                                    ,
                                    
                                       v
                                       
                                          t
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                    
                                    ]
                                    ,
                                 
                               which implies in particular that 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             k
                                          
                                          
                                             t
                                             k
                                          
                                       
                                    
                                    =
                                    
                                       D
                                       
                                          t
                                          k
                                       
                                    
                                 
                              . This further implies that 
                                 
                                    
                                       i
                                       k
                                    
                                    =
                                    
                                       t
                                       k
                                    
                                    ,
                                 
                               and completes the proof.□

To solve problem PU(FIFO), we exploit the property in Theorem 4.6 and use a slight modification of the algorithm in Hsu (2000) as follows. We define f(t; τ) to be the minimal cost of satisfying demands from period 1 to period τ (t ≤ τ ≤ vt
                        ), with the additional constraint that the latest period with positive procurement is t, and that it completely satisfies the demand of period τ. This definition implies that the minimum cost to satisfy demands over the whole planning horizon can be determined by computing min 1 ≤ t ≤ T
                        
                        f(t; T). This also leads to the following recursive equations for 
                           
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                           
                         and 
                           
                              τ
                              =
                              t
                              ,
                              …
                              ,
                              T
                           
                        :

                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                (
                                                t
                                                ;
                                                τ
                                                )
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            min
                                                            {
                                                            f
                                                            
                                                               (
                                                               t
                                                               ;
                                                               τ
                                                               −
                                                               1
                                                               )
                                                            
                                                            +
                                                            
                                                               c
                                                               
                                                                  t
                                                                  τ
                                                               
                                                            
                                                            
                                                               D
                                                               τ
                                                            
                                                            ,
                                                            
                                                               min
                                                               
                                                                  i
                                                                  ∈
                                                                  κ
                                                                  (
                                                                  t
                                                                  ,
                                                                  τ
                                                                  )
                                                               
                                                            
                                                            
                                                               {
                                                               f
                                                               
                                                                  (
                                                                  i
                                                                  ;
                                                                  τ
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            
                                                            
                                                            
                                                            
                                                            
                                                            +
                                                            
                                                            
                                                               S
                                                               t
                                                            
                                                            +
                                                            
                                                               c
                                                               
                                                                  t
                                                                  τ
                                                               
                                                            
                                                            
                                                               D
                                                               τ
                                                            
                                                            
                                                               }
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            t
                                                            <
                                                            τ
                                                            ≤
                                                            
                                                               v
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               min
                                                               
                                                                  i
                                                                  :
                                                                  i
                                                                  ≤
                                                                  t
                                                                  −
                                                                  1
                                                                  ≤
                                                                  
                                                                     v
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               {
                                                               f
                                                               
                                                                  (
                                                                  i
                                                                  ;
                                                                  t
                                                                  −
                                                                  1
                                                                  )
                                                               
                                                               +
                                                               
                                                                  S
                                                                  t
                                                               
                                                               +
                                                               
                                                                  p
                                                                  t
                                                               
                                                               
                                                                  D
                                                                  t
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            τ
                                                            =
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∞
                                                      
                                                      
                                                         
                                                            otherwise
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              κ
                              
                                 (
                                 t
                                 ,
                                 τ
                                 )
                              
                              =
                              
                                 {
                                 i
                                 :
                                 i
                                 <
                                 t
                                 
                                 and
                                 
                                 
                                    v
                                    i
                                 
                                 =
                                 τ
                                 −
                                 1
                                 }
                              
                           
                        . Observe that in (15), we can restrict our search to i ∈ κ(t; τ) due to Theorem 4.6. By performing a similar analysis as in Hsu (2000) (see Appendix C), we find that the overall time complexity of carrying out (15) and computing min 1 ≤ t ≤ T
                        
                        f(t; T) is 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                        . As a result, PU(FIFO) can be solved in 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                         time.

Under the LEFO allocation mechanism, there exists an optimal solution, where two items with different procurement periods are never held in stock together as stated in Theorem 4.7 (see Appendix D for the proof), implying that the zero-inventory-ordering (ZIO) property holds. As a result, a Wagner–Whitin-type algorithm can be developed, and PU(LEFO) can be solved in 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                         time.

                           Theorem 4.7
                           There exists an optimal solution to PU(LEFO) that possesses the ZIO property.

As stated in the Introduction, previous research has been limited to cases where vi
                         ≤ vj
                         for i < j. It is easy to see that under this assumption, the FIFO and FEFO mechanisms are equivalent, as well as the LIFO and LEFO mechanisms. Furthermore, under this assumption, problem PU(FIFO) (or PU(FEFO)) is equivalent to an ELS problem with inventory bounds (ELS-BI), where the bounds are set as

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                                t
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   t
                                                   +
                                                   1
                                                
                                                
                                                   v
                                                   t
                                                
                                             
                                             
                                                D
                                                i
                                             
                                             
                                             t
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        to prevent wastage of the items. The ELS-BI was first studied by Love (1973), who developed an 
                           
                              O
                              (
                              
                                 T
                                 3
                              
                              )
                           
                         algorithm for the problem. Toczylowski (1995) later proposed an 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                         algorithm for this problem, which is the fastest algorithm known to date. Moreover, under the aforementioned assumption, PU(FIFO) (or PU(FEFO)) can also be viewed as an ELS problem with procurement time windows (ELS-TW). In the ELS-TW, the demand in period t can only be satisfied by procuring in a period in the time window [bt, t]. Clearly, the equivalence of the problems holds by setting 
                           
                              
                                 b
                                 t
                              
                              =
                              min
                              
                                 {
                                 i
                                 :
                                 
                                    v
                                    i
                                 
                                 =
                                 t
                                 }
                              
                           
                        . In fact, Wolsey (2006) showed that the problems ELS-BI and ELS-TW are equivalent and provided an 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                         algorithm for both. Therefore, under the special assumption that vi
                         ≤ vj
                         for i < j, PU(FIFO) and PU(FEFO) can be solved in O(T
                        2) time by the algorithm of Toczylowski (1995) or Wolsey (2006).

It is well known that the ELS with procurement capacities is 
                           NP
                        -hard even under various special cost structures (see Bitran and Yanasse, 1982 and Florian et al., 1980). Since the ELS-PI generalizes the ELS by incorporating item deterioration, it follows that the ELS-PI with procurement capacities is also 
                           NP
                        -hard under these special cases. On the other hand, the ELS with time-invariant procurement capacities can be solved in polynomial time under general concave cost functions (see Florian and Klein, 1971 and Hoesel and Wagelmans, 1996). We would like to know whether this property holds in case of item deterioration. Hence, we analyze the ELS-PI under time-invariant procurement capacities (i.e., 
                           
                              
                                 C
                                 t
                              
                              =
                              C
                           
                         for 
                           
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                           
                        ). We first prove that the ELS-PI with time-invariant procurement capacities without any allocation mechanism is 
                           NP
                        -hard.

                           Theorem 5.1
                           Problem PC( ∼ ) is 
                                 NP
                              -hard.

We use a reduction from problem Partition, which is described as follows. Given positive integers at
                               (
                                 
                                    t
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                              ) and 
                                 
                                    A
                                    =
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       a
                                       t
                                    
                                    ,
                                 
                               is there a subset 
                                 
                                    S
                                    ⊆
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    }
                                 
                               such that 
                                 
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          S
                                       
                                    
                                    
                                       a
                                       t
                                    
                                    =
                                    
                                       A
                                       2
                                    
                                 
                              ?

We construct an instance for the ELS-PI with 
                                 
                                    N
                                    +
                                    1
                                 
                               periods and time-invariant procurement capacities, where periods are indexed from 0 to N. We set 
                                 
                                    
                                       v
                                       0
                                    
                                    =
                                    N
                                 
                               and 
                                 
                                    
                                       v
                                       t
                                    
                                    =
                                    t
                                 
                               for 
                                 
                                    t
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                              . Furthermore, we set 
                                 
                                    
                                       S
                                       0
                                    
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       D
                                       0
                                    
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       S
                                       t
                                    
                                    =
                                    
                                       D
                                       t
                                    
                                    =
                                    
                                       a
                                       t
                                    
                                    ,
                                 
                               for 
                                 
                                    t
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    ,
                                 
                               and 
                                 
                                    
                                       p
                                       t
                                    
                                    =
                                    
                                       h
                                       t
                                    
                                    =
                                    0
                                 
                               for 
                                 
                                    t
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    N
                                 
                              . Finally, we set the procurement capacity in each period equal to 
                                 
                                    C
                                    =
                                    
                                       A
                                       2
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       D
                                       t
                                    
                                 
                              . We refer to this problem instance as I. Note that the answer to Partition is no if 
                                 
                                    
                                       a
                                       t
                                    
                                    >
                                    
                                       A
                                       2
                                    
                                 
                               for some 
                                 
                                    t
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    }
                                 
                               and we disregard these trivial instances. Therefore, we assume that 
                                 
                                    
                                       a
                                       t
                                    
                                    ≤
                                    
                                       A
                                       2
                                    
                                 
                               for 
                                 
                                    t
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                               and hence Dt
                               ≤ C for 
                                 
                                    t
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                 
                              . We will prove that the answer to Partition is yes if and only if there is a feasible solution to I with total cost at most 
                                 
                                    A
                                    2
                                 
                              .

First, let x be a feasible solution of I with total cost at most 
                                 
                                    A
                                    2
                                 
                              . Let 
                                 
                                    S
                                    ⊆
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    }
                                 
                               be the set of positive procurement periods other than period 0. Because the cost is at most 
                                 
                                    
                                       A
                                       2
                                    
                                    ,
                                 
                               we have

                                 
                                    (16)
                                    
                                       
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                S
                                             
                                          
                                          
                                             a
                                             t
                                          
                                          =
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                S
                                             
                                          
                                          
                                             S
                                             t
                                          
                                          ≤
                                          
                                             A
                                             2
                                          
                                          .
                                       
                                    
                                 
                              Now consider the procurement quantities in periods 
                                 
                                    t
                                    =
                                    1
                                    ,
                                    ⋯
                                    ,
                                    N
                                 
                              . Since x is feasible with respect to perishability, we have that 
                                 
                                    
                                       x
                                       t
                                    
                                    =
                                    
                                       x
                                       
                                          t
                                          t
                                       
                                    
                                    ≤
                                    
                                       D
                                       t
                                    
                                    =
                                    
                                       a
                                       t
                                    
                                 
                               (since 
                                 
                                    
                                       v
                                       t
                                    
                                    =
                                    t
                                 
                               for t ∈ S). Moreover, since the capacity constraint should be satisfied in period 0, we have

                                 
                                    (17)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                   A
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   C
                                                   ≥
                                                   
                                                      x
                                                      0
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      D
                                                      t
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      x
                                                      t
                                                   
                                                   ≥
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      a
                                                      t
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      a
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   A
                                                   −
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      a
                                                      t
                                                   
                                                   ⇔
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         S
                                                      
                                                   
                                                   
                                                      a
                                                      t
                                                   
                                                   ≥
                                                   
                                                      1
                                                      2
                                                   
                                                   A
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Combining (16) and (17) shows that 
                                 
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          S
                                       
                                    
                                    
                                       a
                                       t
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    A
                                 
                               and hence the answer to Partition is yes.

Now suppose that the answer to Partition is yes, i.e., there exists a subset 
                                 
                                    S
                                    ⊆
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    }
                                 
                               with 
                                 
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          S
                                       
                                    
                                    
                                       a
                                       t
                                    
                                    =
                                    
                                       A
                                       2
                                    
                                 
                              . We construct a solution x′ for instance I such that 
                                 
                                    
                                       x
                                       t
                                       ′
                                    
                                    =
                                    
                                       x
                                       
                                          t
                                          t
                                       
                                       ′
                                    
                                    =
                                    
                                       D
                                       t
                                    
                                 
                               for t ∈ S, 
                                 
                                    
                                       x
                                       0
                                       ′
                                    
                                    =
                                    
                                       ∑
                                       
                                          t
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       D
                                       t
                                    
                                    −
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          S
                                       
                                    
                                    
                                       D
                                       t
                                    
                                 
                               and 
                                 
                                    
                                       x
                                       t
                                       ′
                                    
                                    =
                                    0
                                 
                               otherwise. Clearly, x′ is feasible with respect to demand satisfaction and perishability and the total cost of x′ is 
                                 
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          S
                                       
                                    
                                    
                                       S
                                       t
                                    
                                    =
                                    
                                       A
                                       2
                                    
                                 
                              . With respect to the capacity constraints, we have 
                                 
                                    
                                       x
                                       t
                                       ′
                                    
                                    =
                                    
                                       D
                                       t
                                    
                                    ≤
                                    C
                                 
                               for t ∈ S, and since 
                                 
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          S
                                       
                                    
                                    
                                       D
                                       t
                                    
                                    =
                                    
                                       A
                                       2
                                    
                                    ,
                                 
                               it follows that

                                 
                                    (18)
                                    
                                       
                                          
                                             x
                                             0
                                             ′
                                          
                                          =
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             D
                                             t
                                          
                                          −
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                S
                                             
                                          
                                          
                                             D
                                             t
                                          
                                          =
                                          
                                             A
                                             2
                                          
                                          =
                                          C
                                          .
                                       
                                    
                                 
                              Hence, x′ is feasible with respect to the capacity constraints. Therefore, if the answer to Partition is yes, then there is a feasible solution to I with total cost at most 
                                 
                                    A
                                    2
                                 
                              .□

The special instance constructed in the proof of Theorem 5.1 can also be used to derive the complexity of PC(FEFO) and PC(LIFO). Note that any item procured in some period t > 0 should be consumed in that period since otherwise it will expire. This means that any item procured in period t is consumed no later than any item in stock at the beginning of period t, which is procured in period 0. In turn, this implies that items with an earlier expiration date (vt
                         ≤ v
                        0) or that are procured later are consumed first. Hence, an optimal solution to the instance of the proof of Theorem 5.1 should satisfy both the FEFO and LIFO allocation mechanism. Therefore, we conclude that the ELS-PI with time-invariant capacities remains 
                           NP
                        -hard under the FEFO and LIFO allocation mechanisms as stated in Corollary 5.2. Moreover, this holds true even when there is no holding cost and the production cost functions have a fixed charge structure where the variable part is zero.

                           Corollary 5.2
                           Problems PC(FEFO) and PC(LIFO) are 
                                 NP
                              -hard.

As mentioned before, under the FIFO allocation mechanism, consumption of items procured in a period cannot start before the items procured in earlier periods are consumed. This implies the following property, which also holds for the uncapacitated case.

                           Theorem 5.3
                           There exists a feasible allocation plan x of P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (FIFO) if and only if 
                                 
                                    
                                       I
                                       t
                                    
                                    ≤
                                    
                                       ∑
                                       
                                          i
                                          =
                                          t
                                          +
                                          1
                                       
                                       
                                          v
                                          t
                                       
                                    
                                    
                                       D
                                       i
                                    
                                 
                               when xt
                               > 0 (t ∈ [1, T]) in the associated feasible aggregate plan.

Consider a feasible aggregate plan and assume that xr
                               > 0 and 
                                 
                                    
                                       I
                                       r
                                    
                                    >
                                    
                                       ∑
                                       
                                          j
                                          =
                                          i
                                          +
                                          1
                                       
                                       
                                          v
                                          r
                                       
                                    
                                    
                                       D
                                       j
                                    
                                 
                               for some period r. Because of the FIFO allocation mechanism  all items in stock at the beginning of period r should be consumed before the xr
                               items are consumed. Since 
                                 
                                    
                                       I
                                       r
                                    
                                    >
                                    
                                       ∑
                                       
                                          j
                                          =
                                          i
                                          +
                                          1
                                       
                                       
                                          v
                                          r
                                       
                                    
                                    
                                       D
                                       j
                                    
                                    ,
                                 
                               this implies that some items procured in period r are still in stock at the end of period vr
                               and hence they expire. This clearly contradicts the feasibility of x. The other direction of the proof is trivial and hence omitted.□

Following the lot-sizing literature, we call a procurement period t fractional if the procurement quantity in period t is strictly between 0 and the capacity, i.e., if 0 < xt
                         < C. Likewise, we call a procurement period t full if the procurement amount in that period is equal to the capacity, i.e., 
                           
                              
                                 x
                                 t
                              
                              =
                              C
                           
                        . In Florian and Klein (1971) it is shown that in a regeneration interval of an optimal solution of the ELS with procurement capacities, there is at most one fractional procurement period. This is equivalent to the property that there is at least one period where the inventory level drops down to zero between two fractional procurement periods. This property also holds in the case of time-variant capacities, and is referred to as the fractional procurement property in the literature. For the ELS-PI with procurement capacities, we generalize this property in Theorem 5.4.

                           Theorem 5.4
                           There exists an optimal aggregate plan x to P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (FIFO) such that between two fractional procurement periods t
                              1 and t
                              2, there is at least one period t, t
                              1 ≤ t < t
                              2, for which either of the following properties holds:

                                 
                                    (i)
                                    
                                       
                                          
                                             
                                                I
                                                t
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                    


                                       xt
                                        > 0 and 
                                          
                                             
                                                I
                                                t
                                             
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   t
                                                   +
                                                   1
                                                
                                                
                                                   v
                                                   t
                                                
                                             
                                             
                                                D
                                                i
                                             
                                          
                                       .

Let x be an optimal aggregate plan for P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (FIFO). Let t
                              1 and t
                              2 be two fractional procurement periods in x. By contradiction, assume that in this optimal solution It
                               > 0, and 
                                 
                                    
                                       I
                                       t
                                    
                                    <
                                    
                                       ∑
                                       
                                          i
                                          =
                                          t
                                       
                                       
                                          v
                                          t
                                       
                                    
                                    
                                       D
                                       i
                                    
                                 
                               when xt
                               > 0 for t
                              1 ≤ t < t
                              2 (due to Theorem 5.3, we cannot have 
                                 
                                    
                                       I
                                       t
                                    
                                    >
                                    
                                       ∑
                                       
                                          i
                                          =
                                          t
                                       
                                       
                                          v
                                          t
                                       
                                    
                                    
                                       D
                                       i
                                    
                                 
                              ).

First, let 
                                 
                                    
                                       
                                          ɛ
                                       
                                       1
                                    
                                    
                                    =
                                    
                                    min
                                    
                                       {
                                       
                                          x
                                          
                                             t
                                             2
                                          
                                       
                                       ,
                                       
                                          C
                                          
                                             t
                                             1
                                          
                                       
                                       
                                       −
                                       
                                       
                                          x
                                          
                                             t
                                             1
                                          
                                       
                                       ,
                                       
                                          min
                                          
                                             t
                                             :
                                             
                                                x
                                                t
                                             
                                             >
                                             0
                                             ,
                                             
                                                t
                                                1
                                             
                                             ≤
                                             t
                                             <
                                             
                                                t
                                                2
                                             
                                          
                                       
                                       
                                          {
                                          
                                             I
                                             t
                                          
                                          
                                          −
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                t
                                                +
                                                1
                                             
                                             
                                                v
                                                t
                                             
                                          
                                          
                                             D
                                             i
                                          
                                          }
                                       
                                       }
                                    
                                    
                                    >
                                    0
                                 
                              . Consider an aggregate plan x′, where 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             1
                                          
                                       
                                       ′
                                    
                                    =
                                    
                                       x
                                       
                                          t
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ɛ
                                       
                                       1
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             2
                                          
                                       
                                       ′
                                    
                                    =
                                    
                                       x
                                       
                                          t
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          ɛ
                                       
                                       1
                                    
                                    ,
                                 
                               and the other procurement quantities are the same as in x, implying that 
                                 
                                    
                                       I
                                       t
                                       ′
                                    
                                    =
                                    
                                       I
                                       t
                                    
                                    +
                                    
                                       
                                          ɛ
                                       
                                       1
                                    
                                 
                               for 
                                 
                                    t
                                    =
                                    
                                       t
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       t
                                       2
                                    
                                    −
                                    1
                                 
                              . By the choice of ɛ1, we have that either 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             1
                                          
                                       
                                       ′
                                    
                                    =
                                    
                                       C
                                       
                                          t
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             2
                                          
                                       
                                       ′
                                    
                                    =
                                    0
                                 
                               or 
                                 
                                    
                                       I
                                       t
                                       ′
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          t
                                          +
                                          1
                                       
                                       
                                          v
                                          t
                                       
                                    
                                    
                                       D
                                       i
                                    
                                 
                               for some procurement period t, t
                              1 ≤ t < t
                              2, so that property (ii) is satisfied between periods t
                              1 and t
                              2.

In a similar way, let 
                                 
                                    
                                       
                                          ɛ
                                       
                                       2
                                    
                                    
                                    =
                                    
                                    min
                                    
                                       {
                                       
                                          x
                                          
                                             t
                                             1
                                          
                                       
                                       ,
                                       
                                          C
                                          
                                             t
                                             2
                                          
                                       
                                       
                                       −
                                       
                                       
                                          x
                                          
                                             t
                                             2
                                          
                                       
                                       ,
                                       
                                          min
                                          
                                             t
                                             :
                                             
                                                t
                                                1
                                             
                                             ≤
                                             t
                                             <
                                             
                                                t
                                                2
                                             
                                          
                                       
                                       
                                          {
                                          
                                             I
                                             t
                                          
                                          }
                                       
                                       }
                                    
                                    
                                    >
                                    0
                                 
                               and construct an aggregate plan x′′, where 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             1
                                          
                                       
                                       
                                          ′
                                          ′
                                       
                                    
                                    =
                                    
                                       x
                                       
                                          t
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          ɛ
                                       
                                       2
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             2
                                          
                                       
                                       
                                          ′
                                          ′
                                       
                                    
                                    =
                                    
                                       x
                                       
                                          t
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ɛ
                                       
                                       2
                                    
                                    ,
                                 
                               and the other procurement quantities unchanged, implying that 
                                 
                                    
                                       I
                                       t
                                       
                                          ′
                                          ′
                                       
                                    
                                    =
                                    
                                       I
                                       t
                                    
                                    −
                                    
                                       
                                          ɛ
                                       
                                       2
                                    
                                 
                               for 
                                 
                                    t
                                    =
                                    
                                       t
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       t
                                       2
                                    
                                    −
                                    1
                                 
                              . By the choice of ɛ2, we have either 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             1
                                          
                                       
                                       
                                          ′
                                          ′
                                       
                                    
                                    =
                                    0
                                 
                               or 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             2
                                          
                                       
                                       
                                          ′
                                          ′
                                       
                                    
                                    =
                                    
                                       C
                                       
                                          t
                                          2
                                       
                                    
                                 
                               or 
                                 
                                    
                                       I
                                       t
                                       
                                          ′
                                          ′
                                       
                                    
                                    =
                                    0
                                 
                               for some procurement period t, t
                              1 ≤ t < t
                              2, so that property (i) is satisfied between periods t
                              1 and t
                              2.

By construction of x′ and x′′ and because of Theorem 5.3, there are feasible allocation plans corresponding to x′ and x′′ that satisfy the FIFO allocation mechanism. Furthermore, since (a) the aggregate plan x is optimal, (b) it is a convex combination of aggregate plans x′ and x′′, i.e., 
                                 
                                    x
                                    =
                                    λ
                                    
                                       x
                                       ′
                                    
                                    +
                                    
                                       (
                                       1
                                       −
                                       λ
                                       )
                                    
                                    
                                       x
                                       
                                          ′
                                          ′
                                       
                                    
                                 
                               for some λ ∈ (0, 1), and (c) the objective function is concave, x′ and x′′ should also be optimal. By repeating the above arguments (if necessary), we obtain an optimal solution to P
                                 
                                    
                                    
                                       C
                                       t
                                    
                                 
                              (FIFO) that obeys the desired properties.□


                        Theorem 5.4 implies that an optimal solution to P
                           
                              
                              
                                 C
                                 t
                              
                           
                        (FIFO) is composed of non-overlapping intervals [s, t], 1 ≤ s ≤ t ≤ T, which have the following properties:

                           
                              (i)
                              
                                 
                                    
                                       
                                          I
                                          
                                             s
                                             −
                                             1
                                          
                                       
                                       =
                                       0
                                       ,
                                    
                                  or 
                                    
                                       
                                          I
                                          
                                             s
                                             −
                                             1
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             s
                                          
                                          
                                             v
                                             
                                                s
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          D
                                          i
                                       
                                    
                                  and xs
                                  > 0,


                                 
                                    
                                       
                                          I
                                          t
                                       
                                       =
                                       0
                                       ,
                                    
                                  or 
                                    
                                       
                                          I
                                          t
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             t
                                             +
                                             1
                                          
                                          
                                             v
                                             t
                                          
                                       
                                       
                                          D
                                          i
                                       
                                    
                                  and xt
                                  > 0,

there is at most one fractional procurement period in [s, t].

Using these properties, we can now follow an approach similar to Wolsey (2006) (see also Atamtürk and Küçükyavuz, 2005 and Love, 1973) to find the optimal subplan on such an interval for PC(FIFO). To identify the amount of inventory entering in and leaving from such intervals we use the notation 
                           
                              
                                 I
                                 t
                                 0
                              
                              :
                              =
                              0
                           
                         and 
                           
                              
                                 I
                                 t
                                 1
                              
                              :
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    t
                                 
                                 
                                    v
                                    t
                                 
                              
                              
                                 D
                                 i
                              
                           
                         for t ∈ [1, T]. Furthermore, let 
                           
                              
                                 
                                    [
                                    s
                                    ,
                                    t
                                    ]
                                 
                                 u
                                 v
                              
                              ,
                           
                         
                        u, v ∈ {0, 1}, be the interval [s, t] with 
                           
                              
                                 I
                                 
                                    s
                                    −
                                    1
                                 
                              
                              =
                              
                                 I
                                 
                                    s
                                    −
                                    1
                                 
                                 u
                              
                           
                         and 
                           
                              
                                 x
                                 
                                    s
                                    −
                                    1
                                 
                              
                              >
                              0
                           
                         if 
                           
                              u
                              =
                              1
                              ,
                           
                         and 
                           
                              
                                 I
                                 t
                              
                              =
                              
                                 I
                                 t
                                 v
                              
                           
                         and xt
                         > 0 if 
                           
                              v
                              =
                              1
                           
                        . Moreover, let 
                           
                              
                                 H
                                 u
                                 v
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                         be the optimal cost in 
                           
                              
                                 [
                                 s
                                 ,
                                 t
                                 ]
                              
                              u
                              v
                           
                        . Finally, we define the DP variable F(s), 
                           
                              1
                              ≤
                              s
                              ≤
                              T
                              +
                              1
                              ,
                           
                         as the optimal cost of satisfying demands from period s to T provided that 
                           
                              
                                 I
                                 
                                    s
                                    −
                                    1
                                 
                              
                              =
                              0
                           
                        . Similarly, G(s), 
                           
                              1
                              ≤
                              s
                              ≤
                              T
                              +
                              1
                              ,
                           
                         is the optimal cost of satisfying the demands from s to T provided that 
                           
                              
                                 I
                                 
                                    s
                                    −
                                    1
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    s
                                 
                                 
                                    v
                                    
                                       s
                                       −
                                       1
                                    
                                 
                              
                              
                                 D
                                 i
                              
                           
                         and 
                           
                              
                                 x
                                 
                                    s
                                    −
                                    1
                                 
                              
                              >
                              0
                           
                        . With the initial conditions given by 
                           
                              F
                              (
                              T
                              +
                              1
                              )
                              =
                              G
                              (
                              T
                              +
                              1
                              )
                              =
                              0
                              ,
                           
                         the following recursions hold for 
                           
                              s
                              =
                              1
                              ,
                              …
                              ,
                              T
                           
                        :

                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             F
                                             (
                                             s
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             min
                                             
                                                {
                                                
                                                   min
                                                   
                                                      s
                                                      ≤
                                                      t
                                                      ≤
                                                      T
                                                   
                                                
                                                
                                                   {
                                                   
                                                      H
                                                      0
                                                      0
                                                   
                                                   
                                                      (
                                                      s
                                                      ,
                                                      t
                                                      )
                                                   
                                                   +
                                                   F
                                                   
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                   
                                                   }
                                                
                                                ,
                                                
                                                   min
                                                   
                                                      s
                                                      ≤
                                                      t
                                                      ≤
                                                      T
                                                   
                                                
                                                
                                                   {
                                                   
                                                      H
                                                      0
                                                      1
                                                   
                                                   
                                                      (
                                                      s
                                                      ,
                                                      t
                                                      )
                                                   
                                                   +
                                                   G
                                                   
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                   
                                                   }
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             G
                                             (
                                             s
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             min
                                             
                                                {
                                                
                                                   min
                                                   
                                                      s
                                                      ≤
                                                      t
                                                      ≤
                                                      T
                                                   
                                                
                                                
                                                   {
                                                   
                                                      H
                                                      1
                                                      0
                                                   
                                                   
                                                      (
                                                      s
                                                      ,
                                                      t
                                                      )
                                                   
                                                   +
                                                   F
                                                   
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                   
                                                   }
                                                
                                                ,
                                                
                                                   min
                                                   
                                                      s
                                                      ≤
                                                      t
                                                      ≤
                                                      T
                                                   
                                                
                                                
                                                   {
                                                   
                                                      H
                                                      1
                                                      1
                                                   
                                                   
                                                      (
                                                      s
                                                      ,
                                                      t
                                                      )
                                                   
                                                   +
                                                   G
                                                   
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                   
                                                   }
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Our goal is to determine F(1), which, if 
                           
                              
                                 H
                                 u
                                 v
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              ,
                           
                         
                        u, v ∈ {0, 1}, 1 ≤ s ≤ t ≤ T, are known, can be done in 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                         time using recursions (19) and (20). In fact, the 
                           
                              
                                 H
                                 u
                                 v
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                         values can be computed in 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                         time by finding a shortest path on a certain network. Since this approach is similar to Florian and Klein (1971), we omit the details. Since the number of possible (s, t) pairs is 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                              ,
                           
                         the total time complexity to compute 
                           
                              
                                 H
                                 u
                                 v
                              
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           
                         for u, v ∈ {0, 1}, 1 ≤ s ≤ t ≤ T is 
                           
                              O
                              (
                              
                                 T
                                 4
                              
                              )
                           
                        . This is also the overall complexity to solve PC(FIFO).

As mentioned in Section 3, any solution to (P) can be decomposed into consecutive RIs. Since there is no incoming and outgoing inventory in an RI, we can independently solve a subproblem for each RI. This observation, together with the property stated in Lemma 3.3, is sufficient to develop a DP algorithm for PC(LEFO).

Let f(t
                        1, t
                        2) be the minimal cost of RI [t
                        1, t
                        2]. Furthermore, let F(s) be the minimal cost of a sequence of RIs from period s to period T. Then, the following recursions hold for 
                           
                              s
                              =
                              1
                              ,
                              ⋯
                              ,
                              T
                           
                        :

                           
                              (21)
                              
                                 
                                    F
                                    
                                       (
                                       s
                                       )
                                    
                                    =
                                    
                                       min
                                       
                                          s
                                          ≤
                                          t
                                          ≤
                                          T
                                       
                                    
                                    
                                       {
                                       f
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       +
                                       F
                                       
                                          (
                                          t
                                          +
                                          1
                                          )
                                       
                                       }
                                    
                                 
                              
                           
                        with the initial condition 
                           
                              F
                              (
                              T
                              +
                              1
                              )
                              =
                              0
                           
                        .

Obviously, if all f(t
                        1, t
                        2) values are known, recursions (21) can be solved in 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                         time. So all that remains is to find the complexity of determining all f(t
                        1, t
                        2) values. Due to Lemma 3.3, a procurement period t that satisfies some demand in RI [t
                        1, t
                        2] has the property vt
                         ≥ t
                        2. This implies that when computing f(t
                        1, t
                        2) we should have 
                           
                              
                                 x
                                 t
                              
                              =
                              0
                           
                         for periods t, t
                        1 ≤ t ≤ t
                        2, with vt
                         < t
                        2. This can be accomplished by setting the procurement cost in such periods to infinity, and obtaining a minimal cost aggregate plan for RI [t
                        1, t
                        2] in 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                         time by using the algorithm of Florian and Klein (1971) (see also Section 5.3). We can do this because perishability is not an issue anymore in the RI. Since there are 
                           
                              O
                              (
                              
                                 T
                                 2
                              
                              )
                           
                         possible RIs, the time complexity to determine an optimal aggregate plan over the planning horizon is 
                           
                              O
                              (
                              
                                 T
                                 4
                              
                              )
                           
                        . If necessary, the corresponding allocation plan can be found by applying algorithm A(LEFO) to the aggregate solution.

@&#CONCLUSION@&#

In this paper, we consider the economic lot-sizing problem with perishable items (ELS-PI), where items have deterministic expiration periods that depend on their procurement periods. Furthermore, there is a preference order that dictates in which order items in stock are consumed. We show that the consumption order is a significant factor in (i) the time complexity of determining an optimal procurement plan, and (ii) the cost of an optimal plan.

Among all possible allocation mechanisms, we focus on four allocation mechanisms: FEFO, LEFO, FIFO and LIFO. These mechanisms either represent a power structure in the allocation of the items (i.e., FEFO and LEFO) or they are a natural consequence of the physical properties of the inventory system (i.e., FIFO and LIFO). We prove that among all allocation mechanisms, the FEFO and LEFO allocation mechanisms result in the least and most costly procurement plans, respectively. Moreover, there exist instances for which the ratio between the optimal cost under the FIFO and LIFO allocation mechanism is unbounded or zero.

In case of no procurement capacity constraints, we develop polynomial time algorithms under all four allocation mechanisms. On the other hand, in case of time-invariant procurement capacities, the ELS-PI without any consumption order is 
                        NP
                     -hard in general. This is an interesting result, considering the fact that the ELS with time-invariant procurement capacities can be solved in polynomial time. Finally, we show that the ELS-PI remains 
                        NP
                     -hard under the FEFO or LIFO allocation mechanisms, whereas it can be solved in polynomial time when the allocation mechanism is FIFO or LEFO.

The mathematical formulation of the ELS-PI presented in this paper is for a generic allocation mechanism. Therefore, it would be interesting to investigate (tighter) formulations tailored for specific allocation mechanisms. Further polyhedral properties of formulations for each allocation mechanism can then be studied as well. Another topic for future research is to develop heuristic algorithms for the ELS-PI. Due to the 
                        NP
                     -hardness of some cases and the relatively high complexity of some of the algorithms, heuristic solution approaches might be more appealing to use.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank two anonymous reviewers for their valuable comments and suggestions that improved the quality of the paper.

Due to line 7 in Algorithm 1, solution x′ is feasible w.r.t. the FEFO rule. Moreover, the algorithm does not change the aggregate quantities, i.e., 
                        
                           
                              x
                              t
                              ′
                           
                           =
                           
                              x
                              t
                           
                        
                      for 
                        
                           t
                           =
                           1
                           ,
                           ⋯
                           ,
                           T
                        
                     . This implies that x′ is feasible w.r.t. demand satisfaction, the RIs of x′ and x are equal and hence the costs are equal. So it is sufficient to show that items in x′ do not perish.

By contradiction, assume that an item perishes, i.e., there exists an allocation 
                        
                           
                              x
                              
                                 t
                                 ℓ
                              
                              ′
                           
                           >
                           0
                        
                      with ℓ > vt
                     . Clearly, period vt
                      satisfies t ≤ vt
                      < ℓ. Using Lemma 3.1 in an iterative process, we can find an interval [u, vt
                     ] such that u ≤ t, and for r ∈ [u, vt
                     ], 
                        
                           
                              x
                              
                                 i
                                 r
                              
                              ′
                           
                           >
                           0
                        
                      implies i ∈ [u, vt
                     ] and vi
                      ≤ vt
                     . Let i
                     0 ≤ vt
                      be the procurement period with the latest expiration date that satisfies the latest non-zero demand in [t, vt
                     ] (note that 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 t
                              
                              
                                 v
                                 t
                              
                           
                           
                              D
                              j
                           
                           >
                           0
                        
                      since xt
                      > 0 and hence such a period exists). Because x′ satisfies the FEFO rule, we have 
                        
                           
                              v
                              
                                 i
                                 0
                              
                           
                           ≤
                           
                              v
                              t
                           
                        
                     . Due to Lemma 3.1, we can identify u
                     0 such that for r ∈ [u
                     0, vt
                     ], 
                        
                           
                              x
                              
                                 i
                                 r
                              
                              ′
                           
                           >
                           0
                        
                      implies i ∈ [u
                     0, vt
                     ] and 
                        
                           
                              v
                              i
                           
                           ≤
                           
                              v
                              
                                 i
                                 0
                              
                           
                           ≤
                           
                              v
                              t
                           
                        
                     . If u
                     0 ≤ t, then we have 
                        
                           u
                           =
                           
                              u
                              0
                           
                        
                      and the iterative procedure is complete. Otherwise, i.e. if u
                     0 > t, we apply the same procedure on the interval 
                        
                           [
                           t
                           ,
                           
                              u
                              0
                           
                           −
                           1
                           ]
                        
                      to identify u
                     1. We continue this process until we locate the first period uk
                      such that either (i) uk
                      ≤ t, in which case we set 
                        
                           u
                           =
                           
                              u
                              k
                           
                           ,
                        
                      or (ii) there is no positive demand in the interval 
                        
                           [
                           t
                           ,
                           
                              u
                              k
                           
                           −
                           1
                           ]
                           ,
                        
                      in which case we can set 
                        
                           u
                           =
                           t
                        
                     .

We now argue that if items in x′ perish in [u, vt
                     ], this must also hold for x. Let S be the set of procurement periods in the interval [u, vt
                     ] and hence t ∈ S. Clearly, we have

                        
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                i
                                             
                                             
                                                v
                                                t
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             ′
                                          
                                          =
                                          
                                             ∑
                                             
                                                j
                                                =
                                                u
                                             
                                             
                                                v
                                                t
                                             
                                          
                                          
                                             D
                                             j
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Since vi
                      ≤ vt
                      for all i ∈ S, we also know that 
                        
                           
                              ∑
                              
                                 i
                                 ∈
                                 S
                              
                           
                           
                              ∑
                              
                                 j
                                 =
                                 i
                              
                              
                                 v
                                 i
                              
                           
                           
                              x
                              
                                 i
                                 j
                              
                              ′
                           
                           ≤
                           
                              ∑
                              
                                 i
                                 ∈
                                 S
                              
                           
                           
                              ∑
                              
                                 j
                                 =
                                 i
                              
                              
                                 v
                                 t
                              
                           
                           
                              x
                              
                                 i
                                 j
                              
                              ′
                           
                        
                     .

Let 
                        
                           I
                           t
                           r
                        
                      (
                        
                           I
                           t
                           
                              ′
                              r
                           
                        
                     ) the inventory of items procured in period r at the end of period t in allocation plan x (x′). Because x is feasible, it follows

                        
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                S
                                             
                                          
                                          
                                             I
                                             
                                                
                                                   v
                                                   t
                                                
                                             
                                             r
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             x
                                             i
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                i
                                             
                                             
                                                v
                                                i
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             x
                                             i
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                i
                                             
                                             
                                                v
                                                t
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ≥
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             x
                                             i
                                          
                                          −
                                          
                                             ∑
                                             
                                                j
                                                =
                                                u
                                             
                                             
                                                v
                                                t
                                             
                                          
                                          
                                             D
                                             j
                                          
                                          =
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             x
                                             i
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                i
                                             
                                             
                                                v
                                                t
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             ′
                                          
                                          =
                                          
                                             ∑
                                             
                                                r
                                                ∈
                                                S
                                             
                                          
                                          
                                             I
                                             
                                                
                                                   v
                                                   t
                                                
                                             
                                             
                                                ′
                                                r
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where the inequality follows from the fact that procurement periods not in S may satisfy demands in [u, vt
                     ] for x. Finally, since 
                        
                           
                              x
                              
                                 t
                                 ℓ
                              
                              ′
                           
                           >
                           0
                        
                      and t ∈ S, it follows that

                        
                           
                              
                                 0
                                 <
                                 
                                    I
                                    
                                       
                                          v
                                          t
                                       
                                    
                                    
                                       ′
                                       t
                                    
                                 
                                 ≤
                                 
                                    ∑
                                    
                                       r
                                       ∈
                                       S
                                    
                                 
                                 
                                    I
                                    
                                       
                                          v
                                          t
                                       
                                    
                                    
                                       ′
                                       r
                                    
                                 
                                 ≤
                                 
                                    ∑
                                    
                                       r
                                       ∈
                                       S
                                    
                                 
                                 
                                    I
                                    
                                       
                                          v
                                          t
                                       
                                    
                                    r
                                 
                                 .
                              
                           
                        
                     But then x is not feasible w.r.t. perishability as well, which is a contradiction.

Let x be a feasible allocation plan to PU(M) for M ∈ {FEFO, LEFO, FIFO, LIFO}. Let i < j be two procurement periods with a common supply interval 
                        
                           F
                           
                              (
                              i
                              )
                           
                           ∩
                           F
                           
                              (
                              j
                              )
                           
                           =
                           [
                           j
                           ,
                           min
                           
                              {
                              
                                 v
                                 i
                              
                              ,
                              
                                 v
                                 j
                              
                              }
                           
                           ]
                        
                     . By contradiction, assume that both periods partially satisfy demand in F(i)∩F(j). Let x′ (x′′) be the solution where all items in F(i)∩F(j) satisfied by period j (i) are now satisfied by period i (j). Because the costs are concave in the (aggregate) variables and the aggregate plan of x is a convex combination of the aggregate plans corresponding to x′ and x′′ (see also Zangwill, 1968), it follows that either x′ or x′′ has cost at most equal to the cost of x.

It is clear that the solutions x′ and x′′ are still feasible w.r.t. perishability (i.e., no items will deteriorate). So we still need to check whether the allocation mechanism is still satisfied. We will show that under the FIFO and LIFO allocation mechanisms, x′ and x′′ will remain feasible w.r.t. the allocation mechanism by appropriately choosing periods i and j. However, under the FEFO and LEFO allocation mechanism, some reallocations need to performed to make the plans x′ and x′′ feasible w.r.t. the allocation mechanism (while keeping them feasible w.r.t. perishability).

                        
                           (i)
                           If the allocation mechanism is FIFO, we choose i and j such that they are two consecutive procurement periods that violate the property of the theorem. It can be shown that there is no procurement period k with i < k < j that does not violate the property (since otherwise periods i and k also violate the property). Because i and j are consecutive, the allocations in x′ and x′′ corresponding to demands satisfied by i and j will be feasible w.r.t. to the FIFO rule. Moreover, if the property holds for all consecutive procurement periods, then it must hold through the planning horizon. So x′ and x′′ are both feasible.

If the allocation mechanism is LIFO, for any choice of j, we choose i to be the latest procurement period that precedes j and violates the property of the theorem. That is, 
                                 
                                    i
                                    =
                                    arg
                                    
                                       max
                                       t
                                    
                                    
                                       {
                                       t
                                       <
                                       j
                                       :
                                       
                                          x
                                          
                                             t
                                             q
                                          
                                       
                                       >
                                       0
                                       ,
                                       q
                                       ∈
                                       F
                                       
                                          (
                                          i
                                          )
                                       
                                       ∩
                                       F
                                       
                                          (
                                          j
                                          )
                                       
                                       }
                                    
                                 
                              . Let [r, s]⊆F(i)∩F(j) be the interval of periods such that r and s are the first and last period, respectively, that are (partially) satisfied by period i in F(i)∩F(j). Likewise, let [j, p]⊆F(i)∩F(j) be the interval of periods such that j is the first (due to the LIFO allocation mechanism) and p is the last period satisfied by period j. Due to the LIFO allocation mechanism, we should have p ≤ r. Furthermore, since x is feasible under the LIFO allocation mechanism, (a) there exists no t′ < i with 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             ′
                                          
                                          q
                                       
                                    
                                    >
                                    0
                                 
                               for i ≤ q < s in x, and (b) there exists no i < t′ < j with 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             ′
                                          
                                          q
                                       
                                    
                                    >
                                    0
                                 
                               for j ≤ q < s in x (because of the maximality of i). Finally, note that (c) if any two allocations xkv
                               > 0 and x
                              ℓw
                               > 0 with k < ℓ satisfy the LIFO rule, then 
                                 
                                    
                                       x
                                       
                                          
                                             k
                                             ′
                                          
                                          v
                                       
                                    
                                    >
                                    0
                                 
                               and x
                              ℓw
                               > 0 also satisfy the LIFO rule for all k′ < ℓ. Using (a)–(c), it can be verified that x′ and x′′ satisfy the LIFO rule.

If the allocation mechanism is FEFO, we can use Lemma 3.2 which shows that any feasible aggregate plan can be transformed into a feasible allocation plan that satisfies the FEFO allocation mechanism. Therefore, we can always transform x′ and x′′ into an allocation plan that obeys the FEFO allocation mechanism.

If the allocation mechanism is LEFO, consider the RI [t
                              1, t
                              2] containing periods i and j. According to Lemma 3.3, we know that the expiration date of each procurement period that satisfies demands in the RI exceeds the last period t
                              2. Therefore, we can always find an allocation plan that obeys any allocation mechanism, and in particular the LEFO allocation mechanism.

We initiate by setting 
                        
                           f
                           
                              (
                              1
                              ;
                              1
                              )
                           
                           =
                           
                              S
                              1
                           
                           +
                           
                              p
                              1
                           
                           
                              D
                              1
                           
                        
                     . We then compute f(1; τ) for 
                        
                           τ
                           =
                           2
                           ,
                           …
                           ,
                           T
                        
                     . Then, for increasing values of t, 
                        
                           t
                           =
                           2
                           ,
                           …
                           ,
                           T
                           ,
                        
                      we first compute f(t, t) and continue computing f(t; τ) for 
                        
                           τ
                           =
                           t
                           +
                           1
                           ,
                           …
                           ,
                           T
                        
                     .

It takes 
                        
                           O
                           (
                           T
                           )
                        
                      time to compute f(t; t) for a fixed t given 
                        
                           f
                           (
                           i
                           ;
                           t
                           −
                           1
                           )
                        
                      for i < t. On the other hand, for any fixed (t, τ) pair with τ > t, it takes 
                        
                           O
                           (
                           |
                           κ
                           
                              (
                              t
                              ,
                              τ
                              )
                           
                           |
                           )
                        
                      time to compute f(t; τ) given that the values of 
                        
                           f
                           (
                           i
                           ;
                           τ
                           −
                           1
                           )
                        
                      for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           t
                           ,
                        
                      are known. Then, the complexity to compute all f(t; τ) values, and also the complexity of the overall algorithm, is 
                        
                           O
                           (
                           
                              T
                              2
                           
                           +
                           
                              ∑
                              
                                 t
                                 =
                                 1
                              
                              T
                           
                           
                              ∑
                              
                                 τ
                                 =
                                 t
                                 +
                                 1
                              
                              T
                           
                           |
                           κ
                           
                              (
                              t
                              ,
                              τ
                              )
                           
                           |
                           )
                        
                     . Since for a fixed t, 
                        
                           κ
                           
                              (
                              t
                              ,
                              
                                 τ
                                 1
                              
                              )
                           
                           ∩
                           κ
                           
                              (
                              t
                              ,
                              
                                 τ
                                 2
                              
                              )
                           
                           =
                           ∅
                        
                      for τ
                     1 ≠ τ
                     2, we have 
                        
                           
                              ∑
                              
                                 τ
                                 =
                                 t
                                 +
                                 1
                              
                              T
                           
                           
                              |
                              κ
                              
                                 (
                                 t
                                 ,
                                 τ
                                 )
                              
                              |
                           
                           ≤
                           t
                           −
                           1
                        
                     . Therefore, the overall complexity of carrying out the recursions to compute min 1 ≤ t ≤ T
                     
                     f(t; T) is 
                        
                           O
                           (
                           
                              T
                              2
                           
                           )
                           ,
                        
                      and the conclusion follows.

We know that there exists an optimal solution to PU(LEFO) that satisfies Theorem 4.2. We are going to show that any solution that satisfies Theorem 4.2 together with the LEFO allocation constraints, should possess the ZIO property.

Let x be an optimal solution to PU(LEFO) that satisfies Theorem 4.2. By contradiction, assume that x does not satisfy the ZIO property. In particular, assume that there exist two periods t
                     1 < t
                     2 in x with strictly positive procurement such that 
                        
                           
                              x
                              
                                 
                                    t
                                    1
                                 
                                 r
                              
                           
                           >
                           0
                        
                      for some 
                        
                           r
                           ∈
                           [
                           
                              t
                              2
                           
                           ,
                           
                              v
                              
                                 t
                                 1
                              
                           
                           ]
                        
                     .

                        
                           (i)
                           Assume 
                                 
                                    
                                       v
                                       
                                          t
                                          1
                                       
                                    
                                    ≤
                                    
                                       v
                                       
                                          t
                                          2
                                       
                                    
                                 
                               and consider the periods in 
                                 
                                    F
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                    ∩
                                    F
                                    
                                       (
                                       
                                          t
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       [
                                       
                                          t
                                          2
                                       
                                       ,
                                       
                                          v
                                          
                                             t
                                             1
                                          
                                       
                                       ]
                                    
                                 
                              . Since 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             1
                                          
                                          r
                                       
                                    
                                    >
                                    0
                                 
                               for some 
                                 
                                    r
                                    ∈
                                    [
                                    
                                       t
                                       2
                                    
                                    ,
                                    
                                       v
                                       
                                          t
                                          1
                                       
                                    
                                    ]
                                    ,
                                 
                               we should have 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             2
                                          
                                          i
                                       
                                    
                                    =
                                    0
                                 
                               for 
                                 
                                    i
                                    ∈
                                    [
                                    
                                       t
                                       2
                                    
                                    ,
                                    
                                       v
                                       
                                          t
                                          1
                                       
                                    
                                    ]
                                 
                               due to Theorem 4.2. In case 
                                 
                                    
                                       v
                                       
                                          t
                                          1
                                       
                                    
                                    =
                                    
                                       v
                                       
                                          t
                                          2
                                       
                                    
                                    ,
                                 
                               this implies that 
                                 
                                    
                                       x
                                       
                                          t
                                          2
                                       
                                    
                                    =
                                    0
                                    ,
                                 
                               which is a contradiction. Furthermore, if 
                                 
                                    
                                       v
                                       
                                          t
                                          1
                                       
                                    
                                    <
                                    
                                       v
                                       
                                          t
                                          2
                                       
                                    
                                    ,
                                 
                               we should have 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             2
                                          
                                          s
                                       
                                    
                                    >
                                    0
                                 
                               for some 
                                 
                                    s
                                    >
                                    
                                       v
                                       
                                          t
                                          1
                                       
                                    
                                 
                              . This violates the LEFO allocation constraints and hence is a contradiction as well.

Assume 
                                 
                                    
                                       v
                                       
                                          t
                                          1
                                       
                                    
                                    >
                                    
                                       v
                                       
                                          t
                                          2
                                       
                                    
                                 
                               and consider the periods in 
                                 
                                    F
                                    
                                       (
                                       
                                          t
                                          1
                                       
                                       )
                                    
                                    ∩
                                    F
                                    
                                       (
                                       
                                          t
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       [
                                       
                                          t
                                          2
                                       
                                       ,
                                       
                                          v
                                          
                                             t
                                             2
                                          
                                       
                                       ]
                                    
                                 
                              . Since 
                                 
                                    
                                       x
                                       
                                          t
                                          2
                                       
                                    
                                    >
                                    0
                                 
                               by assumption, we have 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             2
                                          
                                          s
                                       
                                    
                                    >
                                    0
                                 
                               for some 
                                 
                                    s
                                    ∈
                                    [
                                    
                                       t
                                       2
                                    
                                    ,
                                    
                                       v
                                       
                                          t
                                          2
                                       
                                    
                                    ]
                                    ,
                                 
                               which implies that 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             1
                                          
                                          i
                                       
                                    
                                    =
                                    0
                                 
                               for 
                                 
                                    i
                                    ∈
                                    [
                                    
                                       t
                                       2
                                    
                                    ,
                                    
                                       v
                                       
                                          t
                                          2
                                       
                                    
                                    ]
                                 
                              . But 
                                 
                                    
                                       x
                                       
                                          
                                             t
                                             1
                                          
                                          r
                                       
                                    
                                    >
                                    0
                                 
                               for some 
                                 
                                    r
                                    ∈
                                    [
                                    
                                       t
                                       2
                                    
                                    ,
                                    
                                       v
                                       
                                          t
                                          1
                                       
                                    
                                    ]
                                 
                               by assumption. Then, we should have 
                                 
                                    r
                                    ∈
                                    [
                                    
                                       v
                                       
                                          t
                                          2
                                       
                                    
                                    ,
                                    
                                       v
                                       
                                          t
                                          1
                                       
                                    
                                    ]
                                 
                              . However, this is a violation of the LEFO allocation constraints, which is a contradiction.

In conclusion, this proves that a solution that satisfies the LEFO allocation constraints and Theorem 4.2 also satisfies the ZIO property.

@&#REFERENCES@&#

