@&#MAIN-TITLE@&#Evidence theory for high dynamic range reconstruction with linear digital cameras

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new unbiased method for HDR reconstruction based on evidence theory.


                        
                        
                           
                           Our method allows to locally minimizing the acquisition noise in the HDR image.


                        
                        
                           
                           Our method is adapted for very high dynamic range acquisition.


                        
                        
                           
                           For average user, no setting and no additional information are needed.


                        
                        
                           
                           Our method is less sensitive to object or people in motion into the scene.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

High dynamic range

Image processing

Evidence theory

Image capture

@&#ABSTRACT@&#


               
               
                  With the advent of the digital camera, a common popular imaging processing is high dynamic range (HDR) that aims to overcome the technological limitations of the irradiance sensor dynamic range. In this paper, we will present a new method to combine low dynamic range images (LDR) for HDR processing. This method is based on the theory of evidence. Without a prior knowledge of the sensor intrinsic parameters and no extra data, it allows to locally maximizing the signal to noise ratio over the entire acquisition dynamic. In addition, our method is less sensitive to object or people in motion into the scene that are causing ghost-like artifacts with the conventional methods. This technique require that the camera be absolutely still between exposures or need a translational alignment. Simulation and experimental results are presented to demonstrate both the accuracy and efficiency of our algorithm.
               
            

@&#INTRODUCTION@&#

Most camera systems, if not all, present technical limitations which affect the image acquisition quality. On a conventional photography (LDR), the most visible one is the lack of the irradiance dynamic range between natural scenes which produces over or under-exposure depending on the choice of the exposure time. In order to overcome this limitation, the solution commonly used was a combination of photographs acquired at different exposure times to achieve a high dynamic range image (HDR) [1]. But it is really democratized with the arrival of the digital camera [2]. A increase of the irradiance dynamic range is also possible through a variation of the ISO value [3], or for indoor photographs, the power of the light source [4]. In the field of digital photography, the second technological limitation for the irradiance is the data quantization. However, the HDR imaging methods may be used to decrease the quantization step [4,5].

To combine a series of image acquisitions to accurately match an HDR image corresponding to the irradiance variations, it is absolutely necessary to estimate the irradiance value for each pixel in every image. Several methods have been published to determine the irradiance response curve of the acquisition system [6,7], the ratios between the exposure times [8] and more complex transformation from cameras [9]. Then, the HDR algorithms would use a weighted average for each pixel to estimate irradiance value. The weighting function enables to limit the noise acquisition and remove over and under-exposed values resulting from long and short exposure times. The first weighting functions suggested in the literature does not have recourse to additional information in relation to the sensor. Only the response curve is necessary to determine the most appropriate weighting function [2,8,7,10] or more simply a hat function to limit the extreme values [6]. To improve the results, weighting functions which use a noise and acquisition model are proposed [11–13,3]. These provide significant improvements in the visual quality of HDR images and the opportunity to use ISO variations [3]. However, these are much more complex to implement as a noise model and the sensor intrinsic parameters are needed (number of electrons per photosite, shot noise, quantization noise, read noise, etc.). Furthermore, the use of all the estimated irradiance values may be problematic in the instance of very high dynamic range. Indeed, it is essential to use a large number of different acquisitions or significant ratio between various exposure times to acquire a very high irradiance dynamic range. An error of a single quantization step for the lowest exposure time is bound to be very prejudicial for the estimation of low irradiance value. Fig. 1
                      shows the evolution of the irradiance estimation error or the size of the quantization step depending on the exposure time. This error is far more important than the image dynamic range in case of the longest exposure time. In addition, viewing HDR images typically use a tone mapping algorithm which compresses the dynamic, on the one hand and increases the visual errors for low irradiance value on the other [14–18].

Last, but not least, if an object or person moves during the various acquisitions, ghosts appear in the HDR image. These artefacts are more or less visible subject to the object’s irradiance, the exposure times and the weighting function. Many algorithms are proposed to remove the ghost artefacts in the final result [19–21].

In this paper, we propose a new approach to combine the estimated irradiances for each image based on the theory of evidence [22,23]. Our method consists in estimating the most probable irradiance value for each pixel, according to the predictions of each acquisition time. Furthermore, our method is more robust to noise acquisition or ghosts following the rejection of the least plausible estimates. It is thus possible to obtain a signal to noise ratio (SNR) which is almost identical across the entire irradiance dynamic range from a large image number. Unlike the last weighting methods, it is not necessary to use a noise model and the intrinsic sensor parameters to obtain an HDR image without noise. Our method is very simple to implement and requires no intervention on the part of the user.

This article is broken down into four distinct parts. After a brief presentation of the image formation model, the first one introduces the weighted average method of creating HDR images. In a given case of noise free, we indicate the best irradiance estimate with the theory of quantization. Then, we introduce our new method for creating HDR images and demonstrate, in this section, that our approach by the theory of evidence can easily use the weighting functions of the weighted average methods. Finally, we evaluate the performance of our method using simulations and real acquisition examples. In the case of linear digital camera, we demonstrate the performance of our method even though no information relating to the sensor is available. Finally, we demonstrate that our method directly remove the ghosts on a real acquisition.

A digital camera is used to convert the light flow into digital values usable by a computer [24]. In a typical image formation model, image irradiance E received by the sensor is related to scene radiance L:
                        
                           (1)
                           
                              E
                              =
                              L
                              
                                 
                                    π
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    cos
                                 
                                 
                                    4
                                 
                              
                              ϕ
                              =
                              Lk
                           
                        
                     where h is the focal length of the imaging lens, d is the diameter of its aperture and 
                        
                           ϕ
                        
                      is the angle subtended by the principal ray from the optical axis. Additional optical effects may alter this relationship but these, are calibrated separately. If the imaging system is ideal, the irradiance E expressed in units of electrons per second is converted into photoelectrons by the image sensor in proportion to the exposure time t:
                        
                           (2)
                           
                              I
                              =
                              min
                              
                                 
                                    
                                       
                                          
                                             Et
                                          
                                          
                                             g
                                          
                                       
                                       +
                                       
                                          
                                             I
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       n
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             max
                                          
                                       
                                    
                                 
                              
                           
                        
                     where g is the sensor gain which is based on ISO value, 
                        
                           
                              
                                 I
                              
                              
                                 0
                              
                           
                        
                      is a constant offset representing the black point, 
                        
                           
                              
                                 I
                              
                              
                                 max
                              
                           
                        
                      is the maximum number of electrons that can be captured and n is the signal and gain-dependent sensor noise. Numerous analog and digital processing are applied to the number of electrons I to obtain a numerical value M:
                        
                           (3)
                           
                              M
                              =
                              f
                              (
                              I
                              )
                              
                              with
                              
                              0
                              <
                              M
                              <
                              
                                 
                                    2
                                 
                                 
                                    Q
                                 
                              
                              -
                              1
                           
                        
                     where 
                        
                           f
                           (
                           )
                        
                      is a response function of the acquisition system and Q is the number of bits for quantizing information. For mono-CCDs [25], this function is linear. However, additional processing need to be added in order to obtain a color image such as demosaicing, white balance and data compression. Within the framework of our study, we consider that each image pixel has three linear and independent sensors where only the noise n can alter the measurement. To model the essential properties of noise, we treat the noise as a zero-mean random variable, the variance of which comes from three independent sources [3]:
                        
                           (4)
                           
                              Var
                              (
                              n
                              )
                              =
                              
                                 
                                    Et
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          read
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          g
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    σ
                                 
                                 
                                    ADC
                                 
                                 
                                    2
                                 
                              
                           
                        
                     where the first term represents the Poisson distribution of photon arrivals. The other terms represent the readout noise and the analog to digital conversion noise (ADC) which are independent of the scene. Image-dependent noise can be estimated from multiple or a single images [26,27]
                  

When the function 
                        
                           f
                           (
                           )
                        
                      is known, it is possible to overcome the irradiance range limitations of photographic sensors in terms of dynamic range [2,6,8] or quantization step [5,4]. The idea is to combine a series of U images where exposure time 
                        
                           
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                      or gain 
                        
                           
                              
                                 g
                              
                              
                                 u
                              
                           
                        
                      is changed at a fixed or variable ratio 
                        
                           χ
                           =
                           
                              
                                 
                                    
                                       t
                                    
                                    
                                       u
                                    
                                 
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       u
                                       +
                                       1
                                    
                                 
                              
                           
                           
                           ∀
                           u
                        
                     . For each given image u and each pixel, the aim is to estimate an irradiance value 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 u
                              
                           
                        
                      that would produce a frame of discernment 
                        
                           
                              
                                 θ
                              
                              
                                 -
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          U
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 u
                              
                           
                           =
                           
                              
                                 g
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       u
                                    
                                 
                              
                           
                           
                              
                                 f
                              
                              
                                 -
                                 1
                              
                           
                           
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 M
                              
                              
                                 u
                              
                           
                           
                           ∀
                           u
                           ,
                           (
                           
                              
                                 M
                              
                              
                                 u
                              
                           
                           ⩾
                           0
                           
                           ∧
                           
                           
                              
                                 M
                              
                              
                                 u
                              
                           
                           <
                           
                              
                                 2
                              
                              
                                 Q
                                 -
                                 1
                              
                           
                           )
                        
                      are not a over or under-exposed value. The combination of these values should limit the impact of noise n on the estimated irradiance 
                        
                           
                              
                                 E
                              
                              
                                 ^
                              
                           
                        
                     .

The traditional method (WA) combines the LDR estimated irradiance values 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 u
                              
                           
                        
                      of the frame of discernment 
                        
                           
                              
                                 θ
                              
                              
                                 -
                              
                           
                        
                      with a weighted average:
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    WA
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                       
                                    
                                    ω
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          u
                                       
                                    
                                    )
                                    ×
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          u
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          u
                                       
                                    
                                    ω
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          u
                                       
                                    
                                    )
                                 
                              
                           
                        
                     where 
                        
                           ω
                           (
                           
                              
                                 M
                              
                              
                                 u
                              
                           
                           )
                        
                      is a weighting function intended to reduce the noise and to exclude the limit values. There are several functions available in the literature and a review of weighting schemes is proposed in [13,12] for linear and logarithmic domains. In the case of noise free acquisition, the estimated irradiance is a function of the weighting function and ratio 
                        
                           χ
                        
                      between exposure times (Fig. 2
                     ). When 
                        
                           χ
                           =
                           0.5
                        
                      and 
                        
                           U
                           =
                           2
                        
                     , half estimated irradiance values are dependent on the weighting function 
                        
                           ω
                        
                     . When 
                        
                           χ
                           >
                           0.5
                        
                      and for a same U, the number of possible solution for the final estimated irradiance values is far more important. However, these values are highly dependent on the weighting function 
                        
                           ω
                        
                     . For a noise free case, the problem of the weighted average method arises from combining all the values of the frame of discernment 
                        
                           
                              
                                 θ
                              
                              
                                 -
                              
                           
                        
                     . Indeed, the theoretical noise free simulation shows that only one value is close to the real irradiance value and the use of the other values will introduce an error (Fig. 3
                     ). According to the theory of linear quantization and in the noise free case, all values of 
                        
                           
                              
                                 θ
                              
                              
                                 -
                              
                           
                        
                      are inferior or equal to the real irradiance: 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 u
                              
                           
                           ⩽
                           E
                           
                           ∀
                           u
                        
                     . Thus, the maximum estimation error is equal to the quantization step. As part of the LDR image, the maximum error is the quantum of the analog to digital conversion:
                        
                           (6)
                           
                              
                                 
                                    ∊
                                 
                                 
                                    q
                                 
                              
                              =
                              
                                 
                                    (
                                    Et
                                    /
                                    g
                                    )
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          Q
                                       
                                    
                                    -
                                    1
                                 
                              
                              
                              when
                              
                              Et
                              /
                              g
                              =
                              
                                 
                                    I
                                 
                                 
                                    max
                                 
                              
                           
                        
                     For HDR images, this error evolves depending on the real irradiance value and 
                        
                           
                              
                                 ∊
                              
                              
                                 qmin
                              
                           
                        
                      is obtained for 
                        
                           
                              
                                 t
                              
                              
                                 max
                              
                           
                        
                     . In order to reduce the quantization noise, it would be much better to use a centered quantization. It is therefore necessary to define the frame of discernment 
                        
                           
                              
                                 θ
                              
                              
                                 +
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          2
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          U
                                       
                                       
                                          +
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 u
                              
                              
                                 +
                              
                           
                           =
                           
                              
                                 g
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       u
                                    
                                 
                              
                           
                           
                              
                                 f
                              
                              
                                 -
                                 1
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 u
                              
                           
                           +
                           1
                           )
                        
                      and 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 u
                              
                              
                                 +
                              
                           
                           ⩾
                           E
                           
                           ∀
                           u
                        
                     . In the frame of discernment 
                        
                           
                              
                                 θ
                              
                              
                                 +
                              
                           
                        
                     , the nearest estimated irradiance of E is 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 max
                              
                           
                           =
                           min
                           
                              
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          +
                                       
                                    
                                 
                              
                           
                        
                     . Without noise, the optimal solution would be:
                        
                           (7)
                           
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    MM
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          max
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          min
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        
                     In free noise case, a voltage equivalent to a half quantization step may be added before the analog to digital converter to limit the quantization error to a half step [28]. In practical terms, it is not possible to work out an irradiance value estimation using this method. Indeed, the acquisition noise would reach its maximum level and, hence, HDR images would be extremely noisy.

To overcome this problem, we suggest a new approach whereby each exposure time makes a vote on the frame of discernment 
                        
                           θ
                           =
                           
                              
                                 θ
                              
                              
                                 -
                              
                           
                           ∪
                           
                              
                                 θ
                              
                              
                                 +
                              
                           
                        
                      with 
                        
                           ϒ
                        
                      possible solutions. For each pixel, each exposure time 
                        
                           
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                      defines a confidence interval 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 
                              
                              
                                 u
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          u
                                       
                                    
                                    ;
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          u
                                       
                                       
                                          +
                                       
                                    
                                 
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                        
                      to perform a vote to 
                        
                           θ
                        
                     :
                        
                           (8)
                           
                              
                                 
                                    v
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      u
                                                   
                                                
                                                
                                                ∀
                                                j
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 j
                              
                           
                        
                      denotes a singleton assumption of the frame of discernment 
                        
                           θ
                        
                      and 
                        
                           
                              
                                 v
                              
                              
                                 u
                              
                           
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                           
                        
                      stands for a possible disjunction of these singleton assumptions. Fig. 4
                      shows an example of a vote with 
                        
                           U
                           =
                           3
                        
                     . Without noise, the nearest values 
                        
                           
                              
                                 E
                              
                              
                                 ^
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 +
                              
                           
                        
                      reach the most positive vote and we achieve the same result as 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 MM
                              
                           
                        
                     . To introduce notions of uncertainty for confidence interval 
                        
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                        
                      and composite hypothesis, we suggest to use the theory of evidence [22,23] to combine all the votes 
                        
                           
                              
                                 v
                              
                              
                                 u
                              
                           
                        
                      and to determine the optimal solution for the real irradiance E. From the frame of discernment 
                        
                           θ
                        
                     , we deduce the set 
                        
                           
                              
                                 2
                              
                              
                                 θ
                              
                           
                        
                      of all 
                        
                           
                              
                                 2
                              
                              
                                 ϒ
                              
                           
                        
                      subsets A:
                        
                           (9)
                           
                              
                                 
                                    2
                                 
                                 
                                    θ
                                 
                              
                              =
                              
                                 
                                    
                                       A
                                       /
                                       A
                                       ⊆
                                       θ
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       ∅
                                       ,
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             1
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ∪
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             1
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       …
                                       ,
                                       θ
                                    
                                 
                              
                           
                        
                     This set which stands for a reference definition includes not only the singleton assumptions of 
                        
                           θ
                        
                     , but also the set of all possible disjunctions of this assumption. To distinguish the accuracy of a proposal hypothesis from an exposure time 
                        
                           
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                     , the basic probability numbers 
                        
                           
                              
                                 m
                              
                              
                                 θ
                              
                              
                                 u
                              
                           
                           (
                           ·
                           )
                        
                      is allocated to one or more subsets:
                        
                           (10)
                           
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                              
                              =
                              
                                 
                                    2
                                 
                                 
                                    θ
                                 
                              
                              →
                              [
                              0
                              ,
                              1
                              ]
                           
                        
                     and satisfies the following properties:
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      θ
                                                   
                                                
                                                (
                                                ∅
                                                )
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         A
                                                         ⊆
                                                         θ
                                                      
                                                   
                                                
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      θ
                                                   
                                                
                                                (
                                                A
                                                )
                                                =
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     The set of focal elements which are the elements A with the probability number 
                        
                           
                              
                                 m
                              
                              
                                 θ
                              
                           
                           (
                           A
                           )
                        
                      is not zero, is called the core 
                        
                           
                              
                                 N
                              
                              
                                 θ
                              
                           
                        
                     :
                        
                           (12)
                           
                              
                                 
                                    N
                                 
                                 
                                    θ
                                 
                              
                              =
                              
                                 
                                    
                                       A
                                       ∈
                                       
                                          
                                             2
                                          
                                          
                                             θ
                                          
                                       
                                       /
                                       
                                          
                                             m
                                          
                                          
                                             θ
                                          
                                       
                                       (
                                       A
                                       )
                                       >
                                       0
                                    
                                 
                              
                           
                        
                     In our study, the core is defined as follows:
                        
                           (13)
                           
                              
                                 
                                    N
                                 
                                 
                                    θ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             U
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      U
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     The contribution of the theory of evidence in relation to voting approach is used to distribute the total probability mass to a subset given by a vote 
                        
                           
                              
                                 v
                              
                              
                                 u
                              
                           
                        
                     . Thus, each exposure time 
                        
                           
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                      defines a solution:
                        
                           (14)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      θ
                                                   
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               u
                                                            
                                                         
                                                      
                                                   
                                                
                                                =
                                                ω
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      θ
                                                   
                                                   
                                                      u
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     A
                                                                  
                                                                  
                                                                     u
                                                                  
                                                               
                                                            
                                                            
                                                               ‾
                                                            
                                                         
                                                      
                                                   
                                                
                                                =
                                                1.0
                                                -
                                                ω
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           ω
                           (
                           
                              
                                 M
                              
                              
                                 u
                              
                           
                           )
                        
                      may be an adaptation of the weighting function commonly used for HDR image reconstruction. However, this function must be superior or equal to 0.5 which indicates that the interval 
                        
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                        
                      is more plausible that 
                        
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       u
                                    
                                 
                              
                              
                                 ‾
                              
                           
                        
                     , and strictly less than 1.0 to avoid zero or negative plausibility for the interval 
                        
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       u
                                    
                                 
                              
                              
                                 ‾
                              
                           
                        
                     . Fig. 5
                      shows a possible adaptation of the function used in [6]. This weight function 
                        
                           ω
                           (
                           
                              
                                 M
                              
                              
                                 u
                              
                           
                           )
                        
                      does not need to be more complex. Undeniably, the theory of evidence allows a suitable combination of mass functions to merge with the confidence interval according to exposition times 
                        
                           
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                     . This combination operator rejects too distant values as opposed to the most plausible one, and is defined as follow:
                        
                           (15)
                           
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                              
                              =
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              ⊕
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              ⊕
                              ⋯
                              ⊕
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                                 
                                    U
                                 
                              
                           
                        
                     Assuming that the sources are independent, the mass for a subset A from the fusion of two basic probability assignments is defined by:
                        
                           (16)
                           
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                              
                              (
                              A
                              )
                              =
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              ⊕
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ′
                                             
                                          
                                          ∩
                                          
                                             
                                                A
                                             
                                             
                                                ″
                                             
                                          
                                          =
                                          A
                                       
                                    
                                    
                                       
                                          m
                                       
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    ·
                                    
                                       
                                          m
                                       
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          ″
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    -
                                    K
                                 
                              
                           
                        
                     where
                        
                           (17)
                           
                              K
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ′
                                          
                                       
                                       ∩
                                       
                                          
                                             A
                                          
                                          
                                             ″
                                          
                                       
                                       =
                                       ∅
                                    
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                              )
                              ·
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    ″
                                 
                              
                              )
                           
                        
                     Unfortunately, a significant noise in the acquisition may create a conflict between votes 
                        
                           
                              
                                 v
                              
                              
                                 u
                              
                           
                        
                      and the fusion of two basic probability assignments does not exist. Fig. 6
                      shows a representation of the fusion with or without conflict. To take into account the noise in the images, we suggest to distribute all the mass on the neighbor quantization steps for a proposal made by a confidence interval 
                        
                           
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 
                              
                              
                                 u
                              
                           
                        
                     . Hence, for a pixel, each LDR image performs a series of votes on the frame of discernment 
                        
                           θ
                        
                     . The mass assigned to each of these votes is the function to the number of quantization steps in comparison with the confidence interval. The mass function 
                        
                           
                              
                                 m
                              
                              
                                 θ
                              
                              
                                 u
                              
                           
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          u
                                       
                                       
                                          +
                                          n
                                       
                                    
                                 
                              
                           
                        
                      correspond to the vote for the image u plus or minus n quantization steps in comparison with the confidence interval 
                        
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 
                              
                              
                                 u
                              
                           
                        
                     . Fig. 7
                      illustrates an example of fusion of two pixels with a multilevel voting. In this example, the votes of LDR1 and LDR2 images are contradictory, the fusion of all the votes shows that the solution is between 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 1
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 2
                              
                           
                        
                     . It is possible to define, for each value, a measure of credibility Cr or a measure of plausibility Pl, and which would be defined through the following equations:
                        
                           (18)
                           
                              
                                 
                                    
                                    
                                       
                                          Cr
                                          (
                                          A
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ⊂
                                                   A
                                                
                                             
                                          
                                          
                                             
                                                m
                                             
                                             
                                                θ
                                             
                                          
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          Pl
                                          (
                                          A
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ∩
                                                   A
                                                   ≠
                                                   ∅
                                                
                                             
                                          
                                          
                                             
                                                m
                                             
                                             
                                                θ
                                             
                                          
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     The example shown in Fig. 7 demonstrates that the plausibility of all hypotheses is always equal to 1. In other words, the plausibility measures the total belief mass that can move into A. For one shutter time 
                        
                           
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                     , the confidence associated with each interval 
                        
                           
                              
                                 A
                              
                              
                                 u
                              
                           
                        
                      is complete. So, the acquisition noise introduces an estimation error for the irradiance value and makes plausible each solution. In contrast, the credibility of a subset A is the sum of the belief mass associated with hypotheses involving A. It stands for the confidence that may be associated with the subset A if all belief mass involving A were transferred to A. If the acquisition noise is important and for one shutter time only, the probability that an irradiance estimation error occurs becomes important. In the example of Fig. 7, the credibility associated with 
                        
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                        
                      is 
                        
                           Cr
                           (
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           )
                           =
                           0.1
                        
                      and translates as the unlikelihood of having an accurate estimate. By increasing the irradiance interval, i.e. taking into account the neighboring quantization steps, the probability of an accurate estimate increases. Hence, the credibility of having an error greater than 3 quantization steps is zero in this particular example because 
                        
                           Cr
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                       
                                          +
                                          3
                                       
                                    
                                 
                              
                           
                           =
                           1
                        
                     . Each of these voting proposals may be weakened in order to take into account the relative reliability of the information provided by the LDR images. Let 
                        
                           
                              
                                 α
                              
                              
                                 u
                              
                           
                        
                      (
                        
                           
                              
                                 α
                              
                              
                                 u
                              
                           
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                        
                     ), the index of reliability associated with the image u according to his reliability, a new basic belief mass set is defined by:
                        
                           (19)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                θ
                                             
                                             
                                                u
                                                α
                                             
                                          
                                          =
                                          
                                             
                                                α
                                             
                                             
                                                u
                                             
                                          
                                          ×
                                          
                                             
                                                m
                                             
                                             
                                                θ
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         +
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          ∀
                                          
                                             
                                                A
                                             
                                             
                                                u
                                             
                                             
                                                +
                                                n
                                             
                                          
                                          
                                          ≠
                                          
                                          θ
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                θ
                                             
                                             
                                                u
                                                α
                                             
                                          
                                          =
                                          (
                                          1
                                          -
                                          
                                             
                                                α
                                             
                                             
                                                u
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                α
                                             
                                             
                                                u
                                             
                                          
                                          ×
                                          
                                             
                                                m
                                             
                                             
                                                θ
                                             
                                             
                                                u
                                             
                                          
                                          (
                                          θ
                                          )
                                       
                                    
                                 
                              
                           
                        
                     where the function 
                        
                           
                              
                                 α
                              
                              
                                 u
                              
                           
                        
                      maybe the same as the function 
                        
                           ω
                           (
                           
                              
                                 M
                              
                              
                                 u
                              
                           
                           )
                        
                      define in Eq. (14). The final outcome is depends on the functions of credibility, plausibility (Eq. (18)) or pignistic probability [29]:
                        
                           (20)
                           
                              ∀
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ∈
                              θ
                              
                              
                              P
                              (
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             
                                                A
                                                ∈
                                                θ
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⊂
                                                A
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    |
                                    A
                                    |
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                              
                              (
                              A
                              )
                           
                        
                     In this context, the ideal solution is:
                        
                           (21)
                           
                              ∀
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ∈
                              θ
                              
                              
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    ET
                                 
                              
                              =
                              
                                 
                                    max
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 F
                              
                              
                                 d
                              
                           
                        
                      is a function of Eqs. (18) and (20). In practice, and in the presence of conflict between the proposals from the exposure times 
                        
                           
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                     , the maximum plausibility provides the best result [30]. It is certainly possible to take the average or median value of the focal element for which the mass is the most important. The proposed method in [31] illustrates the implement of the algorithms of evidence theory and plausibility is used in this article for the final outcome.

For each pixel, our algorithm of high dynamic range image reconstruction was carried out in four steps:
                        
                           1.
                           Create the frame of discernment 
                                 
                                    θ
                                 
                               with U LDR images which defined 
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          u
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          u
                                       
                                       
                                          +
                                       
                                    
                                 
                              .

For each shutter time 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          u
                                       
                                    
                                 
                              :
                                 
                                    –
                                    define a confidence interval to perform a multilevel vote 
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   u
                                                
                                                
                                                   +
                                                   n
                                                
                                             
                                          
                                       ,

define a mass function 
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   θ
                                                
                                                
                                                   u
                                                
                                             
                                             
                                                
                                                   
                                                      ·
                                                   
                                                
                                             
                                          
                                        according to all the 
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   u
                                                
                                                
                                                   +
                                                   n
                                                
                                             
                                          
                                       ,

weaken in order to take into account the reliability of 
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   u
                                                
                                             
                                          
                                        with 
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   u
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            u
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                        to define the mass function 
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   θ
                                                
                                                
                                                   u
                                                   α
                                                
                                             
                                             
                                                
                                                   
                                                      ·
                                                   
                                                
                                             
                                          
                                       .

Perform the fusion of the U basis probability assignments to create 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          θ
                                       
                                       
                                          α
                                       
                                    
                                    
                                       
                                          
                                             ·
                                          
                                       
                                    
                                 
                              .

Compute the function of plausibility for each singleton assumption of 
                                 
                                    θ
                                 
                               and estimate E (Eq. (21) with 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          
                                             ·
                                          
                                       
                                    
                                    =
                                    Pl
                                    (
                                    ·
                                    )
                                 
                              ).

@&#RESULTS@&#

To evaluate the performance of our high dynamic range reconstruction method against other approaches, we performed a theoretical study of the limitations linked to the HDR acquisition. In our implementation, the function 
                        
                           
                              
                                 α
                              
                              
                                 u
                              
                           
                        
                      is defined by the Fig. 5 and the mass function value 
                        
                           
                              
                                 m
                              
                              
                                 θ
                              
                              
                                 u
                              
                           
                           
                              
                                 
                                    ·
                                 
                              
                           
                        
                      according to all the 
                        
                           
                              
                                 v
                              
                              
                                 u
                              
                              
                                 +
                                 n
                              
                           
                        
                      is defined by the Fig. 7. Then, we study these limitations on real acquisitions. To carry out the methods of HDR image reconstruction, we use a Nikon D300s single-lens reflex camera. We mounted the camera on a tripod and controlled it via a computer to avoid motion between acquisitions. In case of hand-held, images can be robustly register using a global homography computed with RANSAC [32] form sparse SURF key-point matches [33] or the method proposed in [46]. All the options for quality improvement or information compression are disabled on the camera. For these real cases, we work directly on the raw data from the sensor to limit the impact of digital processing of the final outcome. The demosaicing process in order to obtain a color image corresponds to a conversion of a matrix of four pixels (a red, two green and one blue) into a single red, green and blue pixel. The white balance is achieved by weighting factors for the three channels which are identical weigh for all the results presented in this article. The pictures are taken either indoors or outdoors. To show HDR images, we use a tone mapping algorithm [16]. Zooms on the results are presented without tone mapping to better visualize the phenomena such as noise or ghost. Clearly, the dynamic compression is very different between tone mapping algorithms and their settings. Therefore, the visualization of the noise in HDR images is highly dependent on the tone mapping algorithm. Finally, the problem of ghost-like artefact that appears when people or objects are not present on all images, is studied on a laboratory and real cases. In this last part, we demonstrate the accuracy of our method on hand-held acquisitions with selected shutter time.

To evaluate the theoretical irradiance reconstruction accuracy of the weighted average method against our approach, we perform a simulation on image acquisition. We use two weighting functions, a complex function that requires a noise model and many setting on the acquisition system [13]. This ideal weighting function should limit noise in HDR image:
                           
                              (22)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       A
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                M
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             
                                                E
                                                +
                                                2
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      D
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             read
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    D
                                 
                              
                           
                         represents the mean of the dark current noise. Because this function requires the irradiance value E, the authors propose an iterative method to estimate it. For linear camera response function [12], the second weighting function [8] is very simple and requires no additional information about the image acquisition system:
                           
                              (23)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       A
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                M
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       u
                                    
                                 
                              
                           
                        The differences between the various methods lie in the SNR measuring assessment between reference and reconstructed irradiance values:
                           
                              (24)
                              
                                 SNR
                                 =
                                 10
                                 log
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      P
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                   
                                                
                                                E
                                                
                                                   
                                                      (
                                                      p
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      P
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            E
                                                            (
                                                            p
                                                            )
                                                            -
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                            (
                                                            p
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where p is the number of pixels in the image. The simulation parameters of the acquisition system are given in Table 1
                         and correspond to a Nikon D300 camera [34]. The results are shown in Fig. 8
                         where the number of images is 
                           
                              U
                              =
                              18
                           
                         and the ratio between each acquisition is 
                           
                              χ
                              =
                              0.5
                           
                        . The first simulation corresponds to an image acquisition without noise where the only possible bias between the real and the reconstructed values is the quantization data. For this simulation, our method provides very close results to a centered quantization method and which corresponds to the best estimate. The weighting function 
                           
                              
                                 
                                    ω
                                 
                                 
                                    A
                                    1
                                 
                              
                           
                         gives a linear curve between the irradiance and the SNR value. In the best possible case, i.e. without noise, the weighting average method gives very distant results of the optimal outcome. However, these results are acceptable for a simple image viewing application. For metrological applications, the differences between the methods are very significant.

The second simulation takes into account all the parameters in Table 1 and the noise acquisition model defined by the Eq. (4). For each irradiance value, we calculate the SNR for a series of 10,000 acquisitions to smooth the curve. In a real image and at a given pixel location, it will be possible to get worse or better result. For high irradiance values (
                           
                              Log
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              >
                              -
                              5
                           
                        ), all methods give similar results and the value of the SNR indicates that no noise is visible in the HDR images. The SNR difference between the various methods is inferior or equal to 3dB, and all methods give higher values than 70dB. For very low irradiance values (
                           
                              Log
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              <
                              -
                              17
                           
                        ), all methods do not provide an accurate estimate for the real value. Between these two irradiance limits (
                           
                              -
                              17
                              <
                              Log
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              <
                              -
                              5
                           
                        ), the methods using a weighed average, taking into account the acquisition system parameters and a noise model for the weighting function, provides far more significant better results compared to a simple weighting function. However, the proposed method gives the best irradiance estimation. For this simulation, the proposed method with 
                           
                              U
                              =
                              18
                           
                         images and on a computer with an Intel Core I5-3550 processor at 3.3GHz and 8GB of memory, the average computation time for a pixel is 92μs. For a small number of images 
                           
                              U
                              =
                              9
                           
                        , our algorithm runs in 25μs for one pixel.

To confirm the theoretical limitations and to compare our method with those using a weighted average in real cases, we propose to create a ground truth HDR image [13]. For a given scene, we make a series of image acquisitions using 
                           
                              U
                              =
                              14
                           
                         exposure times 
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              =
                              5
                           
                        
                        s to 
                           
                              
                                 
                                    t
                                 
                                 
                                    14
                                 
                              
                              =
                              1
                              /
                              1600
                           
                        
                        s with 
                           
                              χ
                              =
                              0.5
                           
                         between each value. For each exposure time, 36 acquisitions are made and then averaged to reduce noise in the final LDR image.

Finally and without taking into account the low values for each pixel, we merge the 
                           
                              U
                              =
                              14
                           
                         averaged images to obtain a ground truth HDR image. The captured irradiance dynamic range of the scene is 
                           
                              -
                              17.3
                              <
                              Log
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              <
                              0
                           
                         and the Fig. 9
                         shows three different exposure times and the ground truth HDR image with a zoom on two dark parts. To compare different HDR reconstruction methods, we use an ISO value of 3200 and equivalent exposure times to the ground truth image to obtained the same irradiance dynamic range.

We compare the results of the proposed method between three other weighted average methods. The first is easy to implement and does not require additional information on the camera [8]. The second is a more recent method that requires a dark and a neutral image for each exposure time to estimate the parameters of the sensor [13]. The last method propose to use pixel data exclusively from the brightest, most well-exposed sensor possible [35]. As demonstrated by the authors, the final HDR image visual quality is far better than the one from the merging methods where the LDR images are separated by more than 3 photographic stops. As low irradiances are more difficult to estimate, Fig. 10
                         shows the results of HDR image reconstructions, for a dark area of the scene for all different methods. Despite the quality of the reference image, the irradiance value obtained for each pixel does not correspond accurately to the ones of the real scene. Therefore, the analysis of the results will be performed visually and the quantization error between the ground truth and the others methods will be computed. Moreover, and to avoid any impact on the results analysis, we did not apply a tone mapping algorithm to the images. The captured irradiance dynamic range of theses dark parts is 
                           
                              -
                              14.5
                              <
                              Log
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              <
                              -
                              9
                           
                        . These results demonstrate that the simple weighted average methods [6,8,7] do not provide a noise free estimate of the irradiance value for these dark areas. More complex methods that use a model of camera to limit the impact of noise in the irradiance reconstruction, give better quality images. Unfortunately, this increase in quality is not possible without additional information specific to each camera sensor and each setting of the acquisition, which does not permit a simple use anymore. The proposed merging algorithm in [35] provides a visual quality close to our method. Yet, the quantization error shows that for something as simple as the first methods tested, our method for HDR image reconstruction achieves better results compared to the others. This experiment confirms the theoretical results of the previous section. The quantization error histogram enables better comparisons between different methods. With the proposed method in [35], this measure shows that the acquisition noise can be modeled by Eq. (4). To reduce this noise, the authors propose to apply a spatial filtering. Because of conventional merging methods using all exposure time, errors are more important. However, the proposed method in [13] is close to the noise acquisition for a single image as the weighting function is equivalent to 
                           
                              
                                 
                                    ω
                                 
                                 
                                    A
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                           
                        . Our merging method can significantly reduce these quantization errors.

Previous results have shown the limitations linked to the different approaches be it in simulation or in ideal acquisition conditions. We now carry a large number of acquisitions with 
                           
                              χ
                              >
                              0.5
                           
                         to fully acquire the irradiance dynamic and a high accuracy. In this outdoor case, the information cannot be controlled. This scene represents the city of Poitiers taken at night and includes areas both with and without direct lighting. We carried a series of 
                           
                              U
                              =
                              18
                           
                         images for exposure times of 
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              =
                              30
                           
                        
                        s to 
                           
                              
                                 
                                    t
                                 
                                 
                                    18
                                 
                              
                              =
                              1
                              /
                              80
                           
                        
                        s with 
                           
                              χ
                              =
                              0.66
                           
                         between each image. The exposure time 
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           
                         is the longest possible with the Nikon D300s camera, we set the ISO value to 2000 in order to capture areas with low irradiance. The Fig. 11
                         shows the HDR image obtained using our method after tone mapping. The irradiance dynamic range is 
                           
                              -
                              16.1
                              <
                              Log
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              <
                              0
                           
                         and is inferior to the theoretical limit and therefore can be reconstructed. We apply the same methods of HDR image reconstruction on this series of acquisitions. Fig. 12
                         shows the results for the three methods in two dark areas of the scene without tone mapping. As explained before, in order to apply the method proposed in [13], we perform a series of a dark and a neutral image acquisitions for each exposure time to estimate the parameters of the sensor. The results confirm the theoretical limitations and the comparison with a ground truth image. The more complex weighted average method [13] provides significantly better visual results than the simplest method [8] at the expense of complexity degree of use. Without merging [35], the visual quality is comparable to the best weighting function because the acquisition noise is more significant. However, our method provides the best results for this irradiance dynamic range without additional information on the sensor or the captured image.

A major problem for HDR imaging is when the scene is not static during the sequence acquisitions, moving objects manifest themselves as ghosting artefacts in the final HDR image. To highlight this problem, we perform in the laboratory a series of acquisitions for a scene where each image has the same object at different positions (Figs. 13 and 14
                        
                        ). The ISO setting is set to 320 and the exposure times in seconds are 
                           
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             3
                                          
                                       
                                       ;
                                       
                                          
                                             1
                                          
                                          
                                             4
                                          
                                       
                                       ;
                                       
                                          
                                             1
                                          
                                          
                                             5
                                          
                                       
                                       ;
                                       
                                          
                                             1
                                          
                                          
                                             6
                                          
                                       
                                       ;
                                       
                                          
                                             1
                                          
                                          
                                             8
                                          
                                       
                                       ;
                                       
                                          
                                             1
                                          
                                          
                                             10
                                          
                                       
                                    
                                 
                              
                           
                        . By reflections and shadows, HDR image of the scene with the presence of the moving object is difficult to estimate. HDR image reconstruction methods by weighted average produce ghost-like artefacts from moving people or object between exposure times in the final HDR image (Fig. 14). To overcome this problem with these reconstruction methods, it is generally necessary to add a step to the irradiance reconstruction pipeline. Three types of methods are commonly used, the first method is to detect motions in the scene and correct them by performing a dense alignment using optical flow [36–38]. Unfortunately, the movements are often complex to determine because the acquisition speed is usually variable. The second type of methods consists in working out for each pixel coherence between each estimated irradiance values to average values and reject any outliers [21,39–41,10,42,43,20]. To operate, most of these methods require the specification of a threshold in order to choose the irradiance values without artefact. This threshold can be particularly difficult to define where the acquisition noise is important [21]. The last type of methods reconstructs the HDR image from a chosen reference image [44,45]. In the case of very HDR image, no image contains all the irradiance dynamic range for a given scene and the reference image is not sufficient to remove all the ghost-like artefacts. Therefore, and generally speaking, all these methods are presented in relatively low irradiance variations with 
                           
                              U
                              <
                              8
                           
                         images and 
                           
                              χ
                              >
                              0.5
                           
                        .

To assess the accuracy of our method compared to the state of the art, we apply our evidence theory reconstruction approach together with the method proposed in [44] to the laboratory dataset (Fig. 13). This method is automatic, no parameter needs to be set apart from the selection of a reference image. Fig. 13 shows the HDR image obtained using our method after tone mapping and Fig. 14 shows two zooms on the HDR image for both methods and the weighted average method. The irradiance dynamic range of the HDR image is 
                           
                              -
                              9.25
                              <
                              Log
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              <
                              0
                           
                        . For the method proposed in [44], the reference image is set for the exposure time 
                           
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                           
                        . Our merging method can totally remove the moving object in the final HDR image. On the contrary, the method [44] provided an HDR image where the object retains the position of the image for the reference exposure time 
                           
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                           
                        . The visual quality of these two results is equivalent, but the irradiance dynamic range is relatively low and the settings of the camera are used to limit noise.

In addition, our approach gives the possibility to provide further information by modifying the Eq. (16):
                           
                              (25)
                              
                                 
                                    
                                       m
                                    
                                    
                                       θ
                                    
                                 
                                 (
                                 A
                                 )
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 ⊕
                                 
                                    
                                       m
                                    
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                ′
                                             
                                          
                                          ∩
                                          
                                             
                                                A
                                             
                                             
                                                ″
                                             
                                          
                                          =
                                          A
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ·
                                 
                                    
                                       m
                                    
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       ″
                                    
                                 
                                 )
                              
                           
                        The reconstructed HDR image remains the same, but we get information on the fusion conflict between images: 
                           
                              
                                 
                                    m
                                 
                                 
                                    θ
                                 
                              
                              (
                              ∅
                              )
                           
                        . This conflict is most important in areas where the moving object is present in a single image (Fig. 15
                        ). It is then possible to use the ghost-like removing methods with thresholding to improve performance where necessary.

To study the performance of our method on a high irradiance dynamic range, we take a set of acquisitions for a given scene in which the information is not under control. In the instance of the first scene, 
                           
                              U
                              =
                              14
                           
                         images are used to capture the entire irradiance dynamic range of the scene with 
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              =
                              1
                              /
                              4
                           
                        
                        s to 
                           
                              
                                 
                                    t
                                 
                                 
                                    14
                                 
                              
                              =
                              1
                              /
                              1600
                           
                        
                        s with 
                           
                              χ
                              =
                              0.66
                           
                        . The ISO setting is 3200 and the captured dynamic range in this scene is 
                           
                              -
                              14.3
                              <
                              Log
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              <
                              0
                           
                        . Fig. 16
                         shows the results after tone mapping for HDR image reconstruction by weighted average [8], ghost-removing method [44] with exposure time 
                           
                              
                                 
                                    t
                                 
                                 
                                    8
                                 
                              
                           
                         as reference and our reconstruction method. Compared to the weighted average method, our method can completely eliminate the ghost-like artefact without adding step or extra information. As previously shown in the precedent paragraph, our method provides an image with very little noise despite a high ISO value. The method proposed in [44] removes the ghost-like artefact in the zoomed part from Fig. 16. However, it does not achieve a HDR image for which the irradiance dynamic range is very important. In areas of over or under exposure values of the reference image, the HDR image is not reconstructed accurately. These results are confirmed using a second acquisition set with 
                           
                              U
                              =
                              14
                           
                         images which aimed to capture the entire irradiance dynamic range of the scene with 
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              =
                              1
                           
                        s to 
                           
                              
                                 
                                    t
                                 
                                 
                                    14
                                 
                              
                              =
                              1
                              /
                              400
                           
                        
                        s and with 
                           
                              χ
                              =
                              0.66
                           
                        . The ISO setting is 2000 and the captured dynamic range in this scene is 
                           
                              -
                              14.3
                              <
                              Log
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              <
                              0
                           
                        . Fig. 17
                         shows the results after tone mapping for reconstructed HDR image with the removing ghost method [44] where the reference image is 
                           
                              
                                 
                                    t
                                 
                                 
                                    8
                                 
                              
                           
                         or 
                           
                              
                                 
                                    t
                                 
                                 
                                    12
                                 
                              
                           
                         and our reconstruction method. The results are identical for this scene, our method provides a HDR image without any ghost-like artefact and noise. For both reference exposure times, the method proposed in [44] does not efficiently reconstruct the over or under exposure areas of the reference image.

These results prove that it is possible to completely remove objects or people in motion in a series of images to keep all static objects or people. However, it may be interesting to keep a person moving in the final HDR image. To select a reference image in our method, it is possible to use the Eq. (19) to focus on an image:
                           
                              (26)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   θ
                                                
                                                
                                                   u
                                                   β
                                                
                                             
                                             =
                                             
                                                
                                                   β
                                                
                                                
                                                   u
                                                
                                             
                                             ×
                                             
                                                
                                                   m
                                                
                                                
                                                   θ
                                                
                                                
                                                   u
                                                   α
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            u
                                                         
                                                         
                                                            +
                                                            n
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             ∀
                                             
                                                
                                                   A
                                                
                                                
                                                   u
                                                
                                                
                                                   +
                                                   n
                                                
                                             
                                             
                                             ≠
                                             
                                             θ
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   θ
                                                
                                                
                                                   u
                                                   β
                                                
                                             
                                             =
                                             (
                                             1
                                             -
                                             
                                                
                                                   β
                                                
                                                
                                                   u
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   u
                                                
                                             
                                             ×
                                             
                                                
                                                   m
                                                
                                                
                                                   θ
                                                
                                                
                                                   u
                                                   α
                                                
                                             
                                             (
                                             θ
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    β
                                 
                                 
                                    u
                                 
                              
                           
                         will be close to 1 if the moving objects in image u should be favored and close to 0 to remove moving objects in image u. To study the efficiency of this approach, we use a series of acquisitions proposed by [44]. These images ware taken without a tripod and no information is available except an indication of the exposure time. To realign the acquisitions, we use the method proposed in [46] and the algorithm proposed in [6] to estimate the captor response curve 
                           
                              f
                              (
                              )
                           
                        . For this series of 
                           
                              U
                              =
                              6
                           
                         images, we chose the shutter time 
                           
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                           
                         and 
                           
                              
                                 
                                    t
                                 
                                 
                                    6
                                 
                              
                           
                         for reference, respectively 
                           
                              
                                 
                                    β
                                 
                                 
                                    4
                                 
                              
                              =
                              0.8
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    6
                                 
                              
                              =
                              0.8
                           
                        . For other shutter times, 
                           
                              
                                 
                                    β
                                 
                                 
                                    u
                                 
                              
                           
                         is set to 0.04. For the reference image 
                           
                              
                                 
                                    t
                                 
                                 
                                    4
                                 
                              
                           
                        , the results of both methods are very similar (Fig. 18
                        ). No ghost is present in both HDR images and the dynamic of the scene is reconstructed accurately. However, on our test computer, our method requires only 47s to calculate the HDR image against 597s for the one method proposed in [44]. For the reference image 
                           
                              
                                 
                                    t
                                 
                                 
                                    6
                                 
                              
                           
                        , an estimate of the HDR image is more complex because there are a lake of information on the person in motion. For both methods, artefacts appear in the mouth area of the person in motion. Strangely enough, the book of music which does not change position is not accurately reconstructed with the method in [44]. Our method comes as a leap forward as the conflict information allows to analyse the areas with potential problems (Fig. 19
                        ). Nonetheless, it is essential to have all the information about people in motion to get an HDR image without artefacts for both methods.

@&#CONCLUSION@&#

We have introduced a new approach in order to obtain HDR images from a large series of acquisitions based on the theory of evidence. The aim of our approach is to able to estimate the value of the irradiance which is the closest possible to real scenes and, thus, produce high dynamic range images without neither noise, nor ghost-like artefacts. The proposed method is user-friendly, no additional data is required except the LDR images and the exposure times, and an average user will not need to set any parameter. The accuracy assessment for our approach is based on simulations and real scene acquisitions. We drew a comparison between our method and the traditional one, and we demonstrated that our approach is very close to the ground truth. These results show that our method is robust for complicated acquisitions like night HDR. In the simplest case, our method allows a more accurate estimate of the irradiance than other ones in the literature. Finally, we obtained a good efficiency for ghost free HDR images without adding any step in our process. It is possible to remove or keep persons in motion. However, further researches are possible using the conflict information or a more complex weights of basic probability assignment. Indeed, many tools of evidence theory are not used. For more demanding applications, it is possible to add these tools and acquisition system properties to further improve the results.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cviu.2014.09.006.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

