@&#MAIN-TITLE@&#Blind audio source counting and separation of anechoic mixtures using the multichannel complex NMF framework

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           The tasks of audio source counting and separation for a stereo anechoic mixture of audio signals are addressed.


                        
                        
                           
                           A novel approach is introduced for estimating the number of sources as well as the channel mixing coefficients based on evaluating a 2-D spectrum.


                        
                        
                           
                           An extension of a single channel complex matrix factorization method to multichannel is developed to extract the individual source signals.


                        
                        
                           
                           A model order selection method is proposed to infer the optimal number of the components required for modeling each source.


                        
                        
                           
                           The separation performance improvement over the conventional methods is investigated by calculating BSS evaluation metrics.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Blind Source Separation (BSS)

Complex Non-negative Matrix Factorization (CNMF)

Binary masking

Anechoic mixture

@&#ABSTRACT@&#


               
               
                  In this paper, we address the tasks of audio source counting and separation for a stereo anechoic mixture of audio signals. This will be achieved in two stages. In the first stage, a novel approach is introduced for estimating the number of sources as well as the channel mixing coefficients. For this purpose, a 2-D spectrum is evaluated against both the phase and amplitude differences of the two channels. Hence, obtaining the peak locations of the spectrum yields the number of the sources and the corresponding channel coefficients. In the second stage, an extension of a single channel complex matrix factorization method to multichannel is developed to extract the individual source signals. We find primary estimates of the sources via binary masking and then apply the complex factorization to the complex spectrogram of each source. The obtained factors are then utilized as initial values in the complex multichannel factorization model. We also suggest a method for estimating the number of required components for modeling each source. The separation performance improvement over the conventional methods is investigated by calculating BSS evaluation metrics. The comparison is also carried out in terms of source counting and localization with the recently proposed DeMIX-Anechoic method.
               
            

@&#INTRODUCTION@&#

Most audio signals are mixtures of several sources which might be active concurrently. Separation of audio signals is required for several audio processing tasks such as speech recognition, speaker identification, and polyphonic music transcription.

When no prior information of the sources or channel mixing system is available, the task is called Blind Source Separation (BSS). When the mixing coefficients are real value gains, the mixture is termed instantaneous. However in real environments, the mixing process consists of a linear time-invariant filtering of the source signals as
                        
                           (1)
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    J
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    τ
                                    =
                                    −
                                    ∞
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    ij
                                 
                              
                              (
                              τ
                              )
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              (
                              t
                              −
                              τ
                              )
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                           
                        
                     where 
                        
                           
                              s
                           
                           
                              j
                           
                        
                        (
                        t
                        )
                     , 
                        j
                        =
                        1
                        …
                        J
                     , are the source signals and 
                        
                           
                              a
                           
                           
                              ij
                           
                        
                        (
                        τ
                        )
                      denotes the mixing filter. If the length of the filters a
                     
                        ij
                      are sufficiently smaller than the window length, (1) can be represented in the frequency domain as the following approximation:
                        
                           (2)
                           
                              
                                 
                                    X
                                 
                                 
                                    ft
                                 
                              
                              =
                              A
                              (
                              f
                              )
                              
                                 
                                    S
                                 
                                 
                                    ft
                                 
                              
                           
                        
                     where 
                        
                           
                              X
                           
                           
                              ft
                           
                        
                        =
                        
                           
                              [
                              
                                 
                                    X
                                 
                                 
                                    1
                                    ft
                                 
                              
                              
                              
                                 
                                    X
                                 
                                 
                                    2
                                    ft
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                      indicates the mixture signal complex STFT coefficients on two channels. 
                        A
                        (
                        f
                        )
                      represents the 
                        2
                        ×
                        J
                      matrix containing the channel mixing coefficients and 
                        
                           
                              S
                           
                           
                              ft
                           
                        
                        =
                        
                           
                              [
                              
                                 
                                    S
                                 
                                 
                                    1
                                    ft
                                 
                              
                              …
                              
                                 
                                    S
                                 
                                 
                                    Jft
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                      denotes the complex spectrogram coefficients of the sources. For the case of anechoic mixtures where no reflection is assumed from the objects existing in the environment, the complex valued coefficients of matrix A have frequency independent magnitudes while their phase varies with frequency depending on the microphone array arrangement and the source location w.r.t. the array. The Fourier transform of the mixing filter coefficients can be parameterized as [12]
                     
                        
                           (3)
                           
                              
                                 
                                    a
                                 
                                 
                                    ij
                                 
                              
                              (
                              f
                              )
                              =
                              
                                 
                                    κ
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    −
                                    i
                                    2
                                    π
                                    f
                                    
                                       
                                          τ
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                              
                                 
                                    κ
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          4
                                          π
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                              
                              and
                              
                              
                                 
                                    τ
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ij
                                       
                                    
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          s
                                       
                                    
                                 
                              
                           
                        
                     where r
                     
                        ij
                      specifies the distance between jth source and ith microphone and C
                     
                        s
                      is the sound propagation velocity.

In a more realistic environment, there are several paths besides the direct path from which the signals impinge on the microphones. The mixtures of this scenario are called convolutive and the A coefficients cannot be assumed frequency independent anymore in this case.

In this paper, we propose a framework for anechoic mixtures but we also apply it to the mixtures in moderate reverberant environments. We confirm the effectiveness of the model even in the presence of multipath propagation.

Many methods have been developed for blind source separation. They either work based on a known channel mixing system or they try to estimate the mixing system in advance. Most of the channel mixing estimation techniques are based on time difference of arrival (TDOA) estimation in every time–frequency (TF) cell of the STFT representation of the mixture which is followed by clustering of the obtained estimates [1]. In Yilmaz and Rickard [32], Winter et al. [31], and Saab et al. [22], a clustering algorithm is used for finding the clusters around the actual mixing vectors. Besides some drawbacks associated to the spatial aliasing issue, most of these approaches suffer from an important deficiency which is the need that the number of clusters or sources be known in advance. Moreover, the assumption of strong sparsity is an essential requirement of most of these methods. It means that there should be only one dominant active source in each TF cell of the mixture STFT representation. However, the sparsity can be violated either in the presence of noise or when the sources overlap.

Due to the above mentioned disadvantages, we do not opt for clustering based methods. Instead, we obtain a 2-D spectrum against the amplitude and phase differences of the two channels as described in Section 2. The peak locations of this spectrum correspond to the mixing coefficients. This way, we have relaxed the above mentioned sparsity assumption in the sense that we require a sufficient number of sparse TF cells for acquiring clear spectrum peaks corresponding to each source.

Independent Component Analysis (ICA) is a well-known BSS approach. Generally, ICA assumes that source signals are independent and it involves the so-called permutation problem since ICA is applied to separate frequency cells of the STFT representation. Hence, the source orders should be determined per frequency. This issue has been considered and solved in [13,23,19,25]. But ICA is just applicable to over-determined problems where the number of sensors is at least as large as the number of the sources. Under-determined mixtures are more often separated using TF masking techniques [32,21] or classical sparse approaches such as l
                     1-norm [6] or l
                     
                        p
                     -norm [27] minimization.

Recently, Non-negative Matrix Factorization (NMF) has been applied extensively to several source separation scenarios in a single channel [26,14,30,8,5] and multichannel [20,10,11,18] setting. NMF or Non-negative Tensor Factorization (NTF) is generally applied to the magnitude spectrogram domains. One of the shortcomings of these structures is that they disregard the phase information of the signal in the sense that they try to approximate the power or magnitude spectrogram of the mixture signal as a product of two non-negative matrices containing spectral components and time activations. Moreover, the number of the sources as well as components modeling each source should be known in advance.

In Kameoka et al. [15], a complex NMF model is introduced defining a mixing model in the complex-spectrogram domain. This model is able to provide a sparse representation of acoustic signals in a single-channel scenario. Utilizing this framework for the source separation task, we still need to know the model order in terms of the number of the sources and the components required for modeling each source.

In our present work, we have extended the method in Kameoka et al. [15] to the multichannel case. Our method differs from that of Sawada et al. [24,4] in the sense that they have proposed techniques for source separation in reverberant environment based on modeling the spatial covariance matrix. In Arberet et al. [4], the contribution of each source to the mixture channels in the time–frequency domain is modeled by a zero-mean Gaussian random vector with a full rank covariance matrix composed of two terms: a variance which represents the spectral properties of the source and which is modeled by a non-negative matrix factorization model and another full rank covariance matrix which encodes the spatial properties of the source contribution in the mixture. The extended complex NMF model in Sawada et al. [24] has been developed to factorize the covariance matrix and the spatial property is associated with each NMF basis. However our proposed method is directly applied to the complex spectrogram of the mixture signal, thus it involves less computation. The estimates of the number of the sources and channel mixing given by the previous stage are exploited as known parameters in our developed model. A primary estimate of each source complex spectrogram is obtained through binary masking. Then, the complex NMF approach proposed in Kameoka et al. [15] is applied for decomposing these spectrograms to the non-negative spectral components and time activation matrices along with a tensor containing the phase information. The obtained factors are then utilized as initial values of the parameters in our proposed multichannel complex NMF approach. We have also developed a scheme for estimating the number of components required for modeling each source. This is achieved through log-likelihood evaluation against different model order values and taking the knee point which can be found by using Bayesian Information Criterion (BIC) metric as the optimal order value.

The novel aspects of our proposed approach can be summarized as follows:
                        
                           •
                           We have developed a new scheme for estimating the channel mixing coefficients in the anechoic case based on a 2-D spectrum. Applying this approach, both the phase and attenuation differences between the responses of two channels are inferred for each source from the mixture complex spectrograms. Moreover, the number of the peaks emerging in the spectrum provides an estimate of the number of sources.

The complex NMF model is extended and reformulated to the multichannel case for extracting the individual source signals.

The optimal model order is chosen based on log-likelihood evaluation against different numbers of model components and applying the BIC metric as the order selection criterion.

Several algorithms have already been proposed for channel mixing system estimation for different scenarios of instantaneous, anechoic or convolutive mixtures. The common assumption of most of them is the sparsity of the audio source signals. It means that the source representations in the TF domain do not overlap. This assumption is not necessarily valid for all mixtures. Most of the mentioned methods find the channel estimates through clustering the coefficients obtained for each TF cell. As stated in Section 1, our proposed method is not clustering based and enables us to infer the number of sources as well. In the anechoic case, not only the phase difference between the signals received from two channels should be taken into account, but also the amplitude difference due to the different attenuation of the paths should be considered in the model. While most of the far-field models disregard the difference in the received signal amplitude and just consider the phase difference, we develop a 2-D spectrum for estimating both the phase and amplitude of the channel coefficients. This would be essential especially in the case where the source distances to individual microphones differs considerably.

Our goal is finding a 2-D spectrum against 
                        (
                        
                           
                              R
                           
                           
                              g
                           
                        
                        ,
                        θ
                        )
                      from which we can obtain the channel coefficients (magnitude and phase) corresponding to each source. Toward this goal, the subsequent procedures followed. First, τ
                     
                        g
                      is defined as
                        
                           (4)
                           
                              
                                 
                                    τ
                                 
                                 
                                    g
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          m
                                       
                                    
                                    sin
                                    (
                                    θ
                                    )
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          s
                                       
                                    
                                 
                              
                           
                        
                     where d
                     
                        m
                      is the distance between the microphones. θ denotes the angle of arrival of the signal impinging on the array w.r.t. the array broadside which is assumed uniformly aligned in the interval 
                        [
                        
                           −
                           π
                           /
                           2
                           
                           π
                           /
                           2
                        
                        ]
                     . In fact, τ
                     
                        g
                      determines the TDOA between the received signals of the two channels. R
                     
                        g
                      is used for inferring the ratio of the absolute values of the channel coefficients. We assign uniformly aligned values between [0 1] to R
                     
                        g
                     . Subsequently, a complex valued function 
                        
                           
                              A
                           
                           
                              g
                           
                        
                      can be defined as below:
                        
                           (5)
                           
                              
                                 
                                    A
                                 
                                 
                                    g
                                 
                              
                              (
                              
                                 
                                    R
                                 
                                 
                                    g
                                 
                              
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    g
                                 
                              
                              ,
                              f
                              )
                              =
                              
                                 
                                    R
                                 
                                 
                                    g
                                 
                              
                              exp
                              (
                              i
                              2
                              π
                              
                                 
                                    τ
                                 
                                 
                                    g
                                 
                              
                              f
                              )
                           
                        
                     
                  

We can also define a corresponding metric A
                     21 as
                        
                           (6)
                           
                              
                                 
                                    A
                                 
                                 
                                    21
                                 
                              
                              (
                              f
                              ,
                              t
                              )
                              =
                              cos
                              (
                              
                                 atan
                                 (
                                 
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                   ft
                                                
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   1
                                                   ft
                                                
                                             
                                          
                                          |
                                       
                                    
                                 
                                 )
                              
                              )
                              .
                              exp
                              (
                              i
                              (
                              ∠
                              
                                 
                                    X
                                 
                                 
                                    2
                                    ft
                                 
                              
                              −
                              ∠
                              
                                 
                                    X
                                 
                                 
                                    1
                                    ft
                                 
                              
                              )
                              )
                           
                        
                     which specifies the phase difference as well as the ratio of the magnitudes of the two channels. A
                     21 is defined to be located inside the unit circle such that it is comparable with the A
                     
                        g
                      parameter. 
                        
                           
                              X
                           
                           
                              ift
                           
                        
                     , i = 1, 2 denotes the complex valued STFT coefficients of channel i in the frequency bin f and time frame t.

The following cost function is then evaluated in each TF cell to give us an estimate of the actual amplitude and phase characteristics of the mixing system:
                        
                           (7)
                           
                              M
                              (
                              
                                 
                                    R
                                 
                                 
                                    g
                                 
                              
                              ,
                              θ
                              ,
                              f
                              ,
                              t
                              )
                              =
                              
                                 
                                    |
                                    
                                       
                                          
                                             A
                                          
                                          
                                             g
                                          
                                       
                                       −
                                       
                                          
                                             A
                                          
                                          
                                             21
                                          
                                       
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                           
                        
                     
                  

For increasing the resolution, a monotonically decreasing non-linear function in the range 
                        [
                        0
                        ,
                        1
                        ]
                      is applied to the M metric inspired from Loesch and Yang [17] which leads to sharper peaks in the derived spectrum:
                        
                           (8)
                           
                              P
                              (
                              
                                 
                                    R
                                 
                                 
                                    g
                                 
                              
                              ,
                              θ
                              ,
                              f
                              ,
                              t
                              )
                              =
                              1
                              −
                              tanh
                              (
                              α
                              M
                              (
                              
                                 
                                    R
                                 
                                 
                                    g
                                 
                              
                              ,
                              θ
                              ,
                              f
                              ,
                              t
                              )
                              )
                           
                        
                     where α indicates the non-linearity parameter. The 2-D spectrum is then derived by taking summation over all frequency bins and maximization over all time frames:
                        
                           (9)
                           
                              Γ
                              (
                              
                                 
                                    R
                                 
                                 
                                    g
                                 
                              
                              ,
                              θ
                              )
                              =
                              
                                 
                                    max
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    f
                                 
                              
                              P
                              (
                              
                                 
                                    R
                                 
                                 
                                    g
                                 
                              
                              ,
                              θ
                              ,
                              f
                              ,
                              t
                              )
                           
                        
                     
                  

Consequently, the phase and amplitude difference measures of two channels can be obtained through finding the peak locations of this 2-D spectrum. Two constraints are applied to the peak finder algorithm. First, the minimum peak distances in terms of angle of arrival 
                        (
                        θ
                        )
                      should not exceed 5°. The second constraint is imposed on minimum peak height which should not be smaller than half of the maximum peak value in the spectrum. This way, we have also achieved an estimate of the number of sources in the mixture signal according to their diverse positions which lead to separate peaks emerging in the spectrum. Notice that the peak heights are not proportional to the source signal strengths but to the number of time–frequency cells in which a source is dominant. This can be seen from (9): the derived 2-D spectrum is computed as the sum over all frequencies of values between 0 and 1, measuring agreement of data and hypothesis, and this at the time t where the source can produce the best match. This motivates our choice of threshold for the minimal peak height; implying sources should at some point in time be dominant in at least half the number of cells compared to the most dominant source. The minimal angular distance between peaks is set based on the practical consideration that sources are spatially distributed.

The inferred peak values of the 2-D spectrum will provide us with the corresponding 
                        
                           
                              θ
                           
                           
                              j
                           
                        
                      and R
                     
                        g
                     
                     
                        j
                      associated to the jth source. Subsequently, we can express the estimated channel mixing coefficients with the following form taking the first channel as the reference:
                        
                           (10)
                           
                              
                                 
                                    A
                                 
                                 
                                    est
                                 
                                 
                                    j
                                 
                              
                              (
                              f
                              )
                              =
                              
                                 
                                    [
                                    1
                                    
                                    tan
                                    (
                                    acos
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          g
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    )
                                    ·
                                    exp
                                    (
                                    i
                                    2
                                    π
                                    
                                       
                                          τ
                                       
                                       
                                          g
                                       
                                       
                                          j
                                       
                                    
                                    f
                                    )
                                    ]
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                              j
                              =
                              1
                              …
                              J
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    g
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          s
                                       
                                    
                                 
                              
                              sin
                              (
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        
                     where J indicates the total estimated number of sources.

A sufficient degree of sparseness is required for our approach to lead to the sharp peaks corresponding to the true channel coefficients. This means that there should be a sufficient number of TF cells with one dominant source in the mixture STFT.

Primary estimates of the individual source spectrograms are obtained through binary masking as explained in Section 3.1. Then, the factors of this primary source spectrograms are obtained using the complex NMF scheme proposed in Kameoka et al. [15]. These factors are then exploited as initial values in our proposed multichannel complex framework to extract the source signals. This framework is described in Section 3.2.

For constructing binary masks, the estimated channel characteristics from Section 2 are exploited in this stage. The active source in each TF cell is decided based on the inferred channel coefficients in the previous stage. The mixture STFT coefficients 
                           
                              
                                 X
                              
                              
                                 ft
                              
                           
                         are projected onto the subspace spanned by each mixing vector 
                           
                              
                                 A
                              
                              
                                 est
                              
                              
                                 j
                              
                           
                           (
                           f
                           )
                         and the source j
                        ⁎ whose projection has largest l
                        2-norm is recognized as the active source. The contribution of this source in the given TF cell is taken equal to the channel 1 coefficient, 
                           
                              
                                 S
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       ⁎
                                    
                                 
                                 ft
                              
                              
                                 bm
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 1
                                 ft
                              
                           
                         and that of the other sources is set to zero.

Then, the framework proposed in Kameoka et al. [15] is applied to each source complex spectrogram to extract the recurrent patterns of magnitude spectra and the phase estimates of the constituent components. In contrast to Kameoka et al. [15], the number of components for modeling each source is not taken predefined and is inferred through applying the BIC order selection metric to log-likelihood values calculated against a different number of components. This is discussed more explicitly in Section 4. Furthermore, we do not assume a sparse prior for time activations in the model because it might not fit to the actual behavior of the parameters.

The following generative model is assumed for the estimated source spectrogram coefficients 
                           
                              
                                 S
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       ⁎
                                    
                                 
                                 ft
                              
                              
                                 bm
                              
                           
                        :
                           
                              (11)
                              
                                 
                                    
                                       S
                                    
                                    
                                       jft
                                    
                                    
                                       bm
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       
                                          
                                             K
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       fk
                                    
                                    
                                       bm
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       kt
                                    
                                    
                                       bm
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       
                                          
                                             ϕ
                                          
                                          
                                             kft
                                          
                                          
                                             bm
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       ft
                                    
                                 
                              
                           
                        where K
                        
                           j
                         is the set of indices corresponding to the components used for modeling the jth source. In this model, the columns of the 
                           
                              
                                 W
                              
                              
                                 bm
                              
                           
                         matrix denote the magnitude spectral components and the rows of the 
                           
                              
                                 H
                              
                              
                                 bm
                              
                           
                         matrix represent the time-varying activation coefficients of these components. 
                           
                              
                                 Φ
                              
                              
                                 bm
                              
                           
                         accounts for the time-varying phase spectrum of the components. n
                        
                           ft
                         is assumed to be complex Gaussian white noise with mean 0 and variance σ
                        2. The update algorithm presented in Kameoka et al. [15] can be used for obtaining the set of unknown parameters 
                           
                              
                                 Z
                              
                              
                                 bm
                              
                           
                           =
                           {
                           
                              
                                 W
                              
                              
                                 bm
                              
                           
                           ,
                           
                              
                                 H
                              
                              
                                 bm
                              
                           
                           ,
                           
                              
                                 Φ
                              
                              
                                 bm
                              
                           
                           }
                         through maximizing the likelihood function without imposing sparsity to the 
                           
                              
                                 H
                              
                              
                                 bm
                              
                           
                         elements.

The total number of components, 
                           |
                           
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                           
                           |
                        , required for modeling source j can be inferred via evaluating the likelihood against different order values and choosing the optimal model order using the BIC metric. The factors obtained from binary masked source estimates are utilized in the next stage as initial values of the parameters.

We propose to extend the above complex factorization model to the stereo case as follows. The mixture signal is assumed to follow a similar generative model:
                           
                              (12)
                              
                                 
                                    
                                       X
                                    
                                    
                                       ft
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       fk
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       kt
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       
                                          
                                             ϕ
                                          
                                          
                                             kft
                                          
                                       
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       est
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       ft
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 j
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       K
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 1
                                 …
                                 J
                              
                           
                        where K represents the total number of components (
                           K
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                              
                           
                           |
                           
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                           
                           |
                        ). For later use, we define the vectors 
                           
                              
                                 Y
                              
                              
                                 ft
                              
                           
                         such that 
                           
                              
                                 Y
                              
                              
                                 ft
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 K
                              
                           
                           
                              
                                 W
                              
                              
                                 fk
                              
                           
                           
                              
                                 H
                              
                              
                                 kt
                              
                           
                           
                              
                                 e
                              
                              
                                 i
                                 
                                    
                                       ϕ
                                    
                                    
                                       kft
                                    
                                 
                              
                           
                           
                              
                                 A
                              
                              
                                 est
                              
                              
                                 
                                    
                                       p
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        . The idea behind this framework is that the same model components be assumed for both channels. The estimated channel coefficients account for the phase and attenuation difference between channels for individual sources. 
                           
                              
                                 n
                              
                              
                                 ft
                              
                           
                         is the vector representing the reconstruction error on two channels and is presumed with zero-mean Gaussian distribution for both channels independent from each other. Hence, the likelihood of the parameters 
                           Z
                           =
                           {
                           
                              W
                              ,
                              H
                              ,
                              Φ
                           
                           }
                         is obtained as below:
                           
                              (13)
                              
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       ft
                                    
                                 
                                 |
                                 Z
                                 )
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       i
                                       ,
                                       f
                                       ,
                                       t
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       π
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 exp
                                 (
                                 
                                    −
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ift
                                                
                                             
                                             −
                                             
                                                
                                                   Y
                                                
                                                
                                                   ift
                                                
                                             
                                          
                                          |
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     

An iterative algorithm for maximizing the likelihood function is now developed. The derivation steps can be found in Appendix A. The update relations are obtained as follows:
                           
                              (14)
                              
                                 
                                    
                                       W
                                    
                                    
                                       fk
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      kt
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      kft
                                                   
                                                
                                             
                                          
                                       
                                       Re
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ikft
                                             
                                             
                                                ⁎
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                i
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      kft
                                                   
                                                
                                             
                                          
                                          
                                             
                                                A
                                             
                                             
                                                est
                                                ,
                                                i
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      kt
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               est
                                                               ,
                                                               i
                                                            
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      kft
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       W
                                    
                                    
                                       fk
                                    
                                 
                                 ←
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             fk
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             f
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             fk
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       H
                                    
                                    
                                       kt
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             f
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      fk
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      kft
                                                   
                                                
                                             
                                          
                                       
                                       Re
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ikft
                                             
                                             
                                                ⁎
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                i
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      kft
                                                   
                                                
                                             
                                          
                                          
                                             
                                                A
                                             
                                             
                                                est
                                                ,
                                                i
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             f
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      fk
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               est
                                                               ,
                                                               i
                                                            
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      kft
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 sin
                                 (
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          kft
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                             kft
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   1
                                                   kft
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   Q
                                                
                                                
                                                   2
                                                   kft
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 cos
                                 (
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          kft
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                             kft
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   1
                                                   kft
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   Q
                                                
                                                
                                                   2
                                                   kft
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the parameters β
                        
                           kft
                        , 
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 ikft
                              
                           
                        , 
                           
                              
                                 Q
                              
                              
                                 1
                                 kft
                              
                           
                         and 
                           
                              
                                 Q
                              
                              
                                 2
                                 kft
                              
                           
                         are defined in Appendix A.

The β
                        
                           kft
                         parameter is set to 
                           
                              
                                 β
                              
                              
                                 kft
                              
                           
                           =
                           
                              
                                 W
                              
                              
                                 fk
                              
                           
                           
                              
                                 H
                              
                              
                                 kt
                              
                           
                           /
                           
                              
                                 ∑
                              
                              
                                 k
                              
                           
                           
                              
                                 W
                              
                              
                                 fk
                              
                           
                           
                              
                                 H
                              
                              
                                 kt
                              
                           
                         at each iteration.

To avoid scaling ambiguity, the columns of W are normalized. The iterative algorithm steps are executed in the following order:
                           
                              (1)
                              The initial values of the set of parameters 
                                    Z
                                  are set to those obtained via factorizing the primary source estimates 
                                    
                                       
                                          Z
                                       
                                       
                                          bm
                                       
                                    
                                 .


                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                  is updated according to (A.5) in the appendix.

The parameters 
                                    Z
                                    =
                                    {
                                    
                                       W
                                       ,
                                       H
                                       ,
                                       Φ
                                    
                                    }
                                  are updated according to Eqs. (14)–(16).


                                 
                                    β
                                  is updated.

The complex spectrogram of the individual sources is ultimately reconstructed according to the following expression:
                           
                              (17)
                              
                                 
                                    
                                       S
                                    
                                    
                                       jft
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       
                                          
                                             K
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       fk
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       kt
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       
                                          
                                             ϕ
                                          
                                          
                                             kft
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The time-domain source signals can easily be derived by applying inverse STFT operation to (17).

@&#EXPERIMENTS@&#

The mixture signal is synthetically generated using the Roomsim Toolbox [7] for a rectangular room of dimensions 6.25×3.75×2.5m and omnidirectional microphones. The source and microphone height are set to 1.1m. The position of the microphone centers in (x,y) coordinates lies at (1.56m, 1.87m). We evaluate our proposed method under 4 different experimental settings. In the first and second scenarios, we consider anechoic environments. The respective positions of the microphones and sources in the room for scenarios 1, 3 and 4 are the same and shown in Fig. 1
                     a. A different arrangement is considered in scenario 2 (Fig. 1b) accounting for the cases where the source signal may encounter a different attenuation in each channel. For scenarios 3 and 4, a moderate reverberation condition is simulated and the impulse responses are derived by assuming the reverberation times of 
                        
                           
                              T
                           
                           
                              60
                           
                        
                        =
                        50
                        
                        ms
                      and 
                        
                           
                              T
                           
                           
                              60
                           
                        
                        =
                        100
                        
                        ms
                      respectively using Campbell et al. [7]. The relation between room reverberation time and absorption coefficient of the surfaces given in Gustafsson et al. [12] is utilized for generating the impulse responses corresponding to each case.

The male and female speech signals are taken from dev2 dataset of the SiSEC׳08 “underdetermined speech and music mixtures” task [28]. The common parameter setting for all scenarios is listed in Table 1
                     .

The 2-D spectra for a single synthetic mixture of 3 male speech sources are represented in Figs. 2–4
                        
                        
                        , corresponding to scenarios 1, 2 and 4 respectively. The inferred peak locations for anechoic scenarios 1 and 2 are obtained as 
                           
                              
                                 R
                              
                              
                                 g
                                 1
                              
                           
                           =
                           [
                           0.72
                           ,
                           0.72
                           ,
                           0.72
                           ]
                        , 
                           
                              
                                 θ
                              
                              
                                 g
                                 1
                              
                           
                           =
                           [
                           20
                           °
                           ,
                           40
                           °
                           ,
                           59
                           °
                           ]
                         and 
                           
                              
                                 R
                              
                              
                                 g
                                 2
                              
                           
                           =
                           [
                           0.56
                           ,
                           0.8
                           ,
                           0.82
                           ]
                        , 
                           
                              
                                 θ
                              
                              
                                 g
                                 2
                              
                           
                           =
                           [
                           −
                           83
                           °
                           ,
                           47
                           °
                           ,
                           79
                           °
                           ]
                         which shows a near perfect matching with the actual simulated impulse responses of the channel and source directions. The true R
                        
                           g
                         values for anechoic mixtures of scenarios 1 and 2 are [0.719 0.729 0.737] and [0.553 0.819 0.833] respectively. The need for considering a dimension corresponding to the amplitude response (R
                        
                           g
                        ) in the spectrum is revealed when we deal with cases similar to scenario 2 where the microphone spacing is larger and leads to different attenuation of the source signals received at each microphone.

Adding reverberation reduces the sparsity in the TF representation hence the peaks for scenario 4 are less sharp but they are still easily detectable by our peak finding algorithm. The corresponding channel parameters are obtained as 
                           
                              
                                 R
                              
                              
                                 g
                                 4
                              
                           
                           =
                           [
                           0.68
                           ,
                           0.72
                           ,
                           0.72
                           ]
                        , 
                           
                              
                                 θ
                              
                              
                                 g
                                 4
                              
                           
                           =
                           [
                           21
                           °
                           ,
                           40
                           °
                           ,
                           59
                           °
                           ]
                        .

To measure the effectiveness of the nonlinear function applied in Eq. (8), we evaluate the 2-D spectrum for anechoic mixture of scenario 1 without applying the non-linearity. As can be seen in Fig. 5
                        , the peaks are wider w.r.t. the 2-D spectrum in Fig. 2. Obviously, sharper peaks emerge in the spectrum when non-linearity is applied.

In order to evaluate our proposed source counting method, the rate of success of the algorithm in the estimation of the true number of sources is calculated and reported in Table 2
                        . For this purpose, J sources are synthetically mixed together. This is done for J from 2 to 10. Taking the first channel as the reference, the mixing coefficient of the second channel corresponding to source j can be written as
                           
                              (18)
                              
                                 
                                    
                                       a
                                    
                                    
                                       2
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       κ
                                    
                                    
                                       j
                                    
                                 
                                 exp
                                 (
                                 
                                    i
                                    2
                                    π
                                    f
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                f
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        where f
                        
                           s
                         is the sampling frequency, 
                           
                              
                                 κ
                              
                              
                                 j
                              
                           
                         represents the relative mixing gain and δ
                        
                           j
                         denotes the relative time delay in samples. The mixing parameters are generated assuming 
                           
                              
                                 d
                              
                              
                                 m
                              
                           
                           =
                           1
                           
                           cm
                         with different relative positions of the sources and microphones and are listed in Table 3
                        . For each J, we generate 10 different mixtures by randomly selecting the original signals from speech/music sources of the dev2 dataset. The mixing parameters are obtained assuming an arrangement similar to scenario 2 with the difference that the source directions are assumed to be uniformly spaced in the interval 
                           [
                           0
                           
                           π
                           ]
                        . The results are compared with the results of the DEMIX-Anechoic method [3] which are obtained using the software provided in Arberet [2]. Like in their work, the success rate is calculated as the percentage of correct estimations out of 10 trials. As can be observed, the algorithms perform perfectly up to 5 sources and the performance of our source counting algorithm is quite comparable and sometimes better than the DEMIX-Anechoic algorithm.

To also evaluate the mixing parameter estimation performance, the mean mixing parameter error (MMPE) is calculated similar to the mean direction error (MDE) proposed in Arberet et al. [3]. Given the true mixing parameter values 
                           κ
                           =
                           [
                           
                              
                                 κ
                              
                              
                                 1
                              
                           
                           …
                           
                              
                                 κ
                              
                              
                                 J
                              
                           
                           ]
                           ,
                           δ
                           =
                           [
                           
                              
                                 δ
                              
                              
                                 1
                              
                           
                           …
                           
                              
                                 δ
                              
                              
                                 J
                              
                           
                           ]
                         and the estimated ones 
                           
                              
                                 κ
                              
                              
                                 ^
                              
                           
                           =
                           [
                           
                              
                                 
                                    
                                       κ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 1
                              
                           
                           …
                           
                              
                                 
                                    
                                       κ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 J
                              
                           
                           ]
                           ,
                           
                              
                                 δ
                              
                              
                                 ^
                              
                           
                           =
                           [
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 1
                              
                           
                           …
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 J
                              
                           
                           ]
                         the MMPE is defined for both of the amplitude and delay parameters as below:
                           
                              (19)
                              
                                 MMPE
                                 (
                                 
                                    κ
                                    ,
                                    
                                       
                                          κ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       P
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             J
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       J
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       J
                                    
                                 
                                 |
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          P
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 |
                                 MMPE
                                 (
                                 
                                    δ
                                    ,
                                    
                                       
                                          δ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       P
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             J
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       J
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       J
                                    
                                 
                                 |
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          P
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 |
                              
                           
                        where S
                        
                           J
                         is the permutation group of size J. Toward this goal, the J highest peaks of the 2-D spectrum found by the peak finder algorithm are considered as the estimated mixing coefficient values of the sources. Similarly, for DEMIX-Anechoic algorithm, we set and fix the number of sources to J. To measure the error in terms of relative precision, the relative mean mixing parameter errors (RMMPE) are defined as 
                           
                              (20)
                              
                                 RMMPE
                                 (
                                 
                                    κ
                                    ,
                                    
                                       
                                          κ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       MDE
                                       (
                                       
                                          κ
                                          ,
                                          
                                             
                                                κ
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                             j
                                             ≠
                                             
                                                
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       |
                                       
                                          
                                             
                                                κ
                                             
                                             
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                κ
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                 
                                 RMMPE
                                 (
                                 
                                    δ
                                    ,
                                    
                                       
                                          δ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       MDE
                                       (
                                       
                                          δ
                                          ,
                                          
                                             
                                                δ
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                             j
                                             ≠
                                             
                                                
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       |
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                j
                                             
                                          
                                          −
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                 
                              
                           
                        where the denominators denote the minimum distance between the true mixing parameter values. RMMPE values for amplitude and delay parameters are plotted in Fig. 6
                        a and b respectively against the number of the sources. Because of the higher resolution needed for these experiments, we have used 18,000 θ segments and 100 R
                        
                           g
                         segments for evaluating the 2-D spectrum to achieve an angular resolution of 0.01°and normalized amplitude resolution of 0.01. It can be seen that our proposed algorithm outperforms DEMIX-Anechoic method up to 6 sources in terms of delay parameter relative error and up to 7 sources in terms of amplitude parameter relative error. Adding more sources, the two algorithms show nearly the same performance.

To get an insight of the proper number of components needed for modeling each source, a model order selection scheme is implemented here. This method is applied to the primary source spectrograms given by binary masking. The initial values of the elements of 
                           
                              
                                 W
                              
                              
                                 bm
                              
                           
                         and 
                           
                              
                                 H
                              
                              
                                 bm
                              
                           
                         are drawn randomly from the absolute value of a standard Gaussian distribution plus 1 (
                           abs
                           (
                           N
                           (
                           0
                           ,
                           1
                           )
                           )
                           +
                           1
                        ). The 
                           
                              
                                 W
                              
                              
                                 bm
                              
                           
                         elements are normalized according to 14. Initial values of 
                           
                              
                                 Φ
                              
                              
                                 bm
                              
                           
                         are drawn from a uniform distribution over the interval 
                           [
                           −
                           π
                           
                           π
                           ]
                        . The update algorithm is iterated 500 times. The log-likelihood function is evaluated against a range of order values 
                           k
                           ∈
                           {
                           
                              3
                              …
                              30
                           
                           }
                        . The likelihood graphs for the mixture of 3 male and 3 female speech signals generated under scenario 1 are represented in Fig. 7
                        a and b respectively. We exploit the BIC metric defined as
                           
                              (21)
                              
                                 BIC
                                 =
                                 −
                                 2
                                 LL
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       p
                                    
                                 
                                 log
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       obs
                                    
                                 
                                 )
                              
                           
                        where LL represents the corresponding log-likelihood vector, N
                        
                           p
                         denotes the number of model parameters and N
                        
                           obs
                         is the number of observed samples associated with each value in LL. The order value corresponding to the minimum obtained BIC metric is taken as the optimal number of model components. This leads to order values of [5 6 6] and [7 8 7] for the male and female sources, respectively. For mitigating the computational burden, we do not re-execute the model order selection algorithm for each mixture in the next step. Instead, we take a fixed number of components considered for each source in our model based on the above experiments 
                           (
                           |
                           
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                           
                           |
                           =
                           8
                           ,
                           
                           j
                           =
                           1
                           …
                           J
                           )
                        .

Here, we are to evaluate the performance of our proposed source separation algorithm using the extended multichannel model. We generated 10 mixtures of 3 (male and/or female) speech signals using the impulse responses obtained through Campbell et al. [7]. The separation quality is measured by calculating the evaluation metrics including Signal to Distortion Ratio (SDR), Signal to Interference Ratio (SIR) and Signal to Artifact Ratio (SAR) [29]. The performance measures averaged over all sources and all mixtures are reported in Tables 4–7
                        
                        
                        
                         corresponding to 4 scenarios. As comparison materials, the results of binary masking and l
                        0-norm minimization algorithms are also evaluated using the reference software in Vincent et al. [28] and are listed in the tables. It can be observed that our proposed method outperforms both of the state-of-the-art methods in all evaluation metrics. The algorithm works also in moderate reverberant environments since the sparsity in the TF domain is still sufficient for pure peaks to emerge in the 2-D spectrum.

@&#DISCUSSION@&#

We now investigate to what extent the algorithm performance is still acceptable when we are to handle longer than the intended reverberation times. Toward this objective, the effectiveness is first measured in the first stage, i.e. the channel estimation and source counting, and then source separation performance is assessed against different T
                     60 values.


                     Fig. 8
                      represents the 2-D spectrum for the arrangement of Fig. 1a with 
                        
                           
                              T
                           
                           
                              60
                           
                        
                        =
                        500
                        
                        ms
                     . The proposed spectrum-based approach is apparently still applicable in highly reverberant environments for the purpose of source counting and angle of arrival estimation. The corresponding channel parameters are obtained as 
                        
                           
                              R
                           
                           
                              g
                           
                        
                        =
                        [
                        0.7
                        ,
                        0.7
                        ,
                        0.66
                        ]
                        ,
                        
                           
                              θ
                           
                           
                              g
                           
                        
                        =
                        [
                        20
                        °
                        ,
                        40
                        °
                        ,
                        59
                        °
                        ]
                      in this case. As can be observed, the peaks of the spectrum are getting wider by increasing the reverberation time but the number of the sources and source directions are obtained with the same accuracy as the moderately reverberant case according to our experimentation. To also investigate the effectiveness of the relative amplitude threshold (0.5) in this highly reverberated case, we reduce the strength of one source in the mixture of 3 sources and plot the relative peak height corresponding to that source as a function of the source strength (the attenuation applied to the signal). The result is shown in Fig. 9
                     . It can be observed that the chosen fixed threshold value (0.5) is quite effective in detecting the peak up to 12dB reduction in the source signal amplitude. From this analysis, we can state that the parameter choice will be related to the signal conditions (reverberation and SNR) in a practical deployment.

The performance of the source separation is shown in Fig. 10
                      in terms of average SDR. The average performance metrics are calculated by taking the average over all sources and all mixtures in the dev2 database (speech/music). The performance degrades when increasing the reverberation time for all of the methods. This is an expected result since there is no model for multipath propagation, but complex NMF still outperforms the other methods. Nevertheless, the satisfying results of the first stage can be exploited in a suitable framework for source separation in highly reverberant conditions. Taking reverberation into account, most of the source separation methods work based on the spatial covariance matrix modeling [4,9] and use the Expectation Maximization (EM) algorithm for maximizing the data likelihood. The EM algorithm is very sensitive to initialization. The mixing coefficients obtained in the first step could provide proper initialization for these approaches. For this purpose, we propose to use the estimated channel parameters given in (10). We have obtained the average performance metrics for the full-rank method of Duong et al. [9]. The metrics are evaluated for two different reverberation conditions (
                        
                           
                              T
                           
                           
                              60
                           
                        
                        =
                        150
                        
                        ms
                      and 
                        
                           
                              T
                           
                           
                              60
                           
                        
                        =
                        500
                        
                        ms
                     ) represented in Tables 8 and 9
                     
                      respectively. We also compare our proposed initialization scheme with the hierarchical clustering-based initialization scheme proposed in [9]. We execute 50 EM algorithm iterations and the number of clusters for hierarchical clustering is set to 30. As it can be observed, in low reverberation condition (
                        
                           
                              T
                           
                           
                              60
                           
                        
                        =
                        150
                        
                        ms
                     ), our proposed method outperforms that of Duong et al. [9] with both initialization schemes. It is also evident that our proposed initialization makes the EM algorithm to lead to better results. In higher reverberation, the full-rank method is performing better than the complex NMF approach and again better performance is achieved using our proposed initialization scheme.

@&#CONCLUSION@&#

In the first step, we developed a novel scheme for source counting and channel estimation in anechoic or moderate reverberant environments introducing a 2-D spectrum over both phase and attenuation difference between the channels.

Secondly, an extension of the complex factorization framework was developed for the purpose of source separation which uses the channel mixing coefficients estimated in previous step. The initial values of the factors are set to those obtained from primary source spectrogram estimates given by binary masking. The average BSS performance metrics shows the superiority of our algorithm over all three evaluation criteria for all different considered source separation scenarios.

We have also introduced a model order selection scheme using the BIC metric for inferring the required number of components for modeling each source. This algorithm can be applied to the primary source spectrogram estimates.

Assuming a prior distribution for the H parameters can be helpful if we set up a training procedure for obtaining the optimal values of the hyperparameters of the prior distribution and can be considered in future work for the purpose of performance improvement.

@&#ACKNOWLEDGMENTS@&#

This research was funded by the KU Leuven research Grant GOA/14/005 (CAMETRON).

We are to solve the following optimization problem:
                        
                           (A.1)
                           
                              
                                 
                                    minimize
                                 
                                 
                                    Z
                                 
                              
                              
                              f
                              (
                              Z
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ,
                                    f
                                    ,
                                    t
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ift
                                          
                                       
                                       −
                                       
                                          
                                             Y
                                          
                                          
                                             ift
                                          
                                       
                                    
                                    |
                                 
                                 
                                    2
                                 
                              
                              subject
                              
                              to
                              
                              
                                 
                                    ∑
                                 
                                 
                                    f
                                 
                              
                              
                                 
                                    W
                                 
                                 
                                    fk
                                 
                              
                              =
                              1
                              
                              (
                              k
                              =
                              1
                              …
                              K
                              )
                           
                        
                     
                  

We define the following auxiliary function with auxiliary parameters 
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        =
                        {
                        
                           
                              X
                           
                           
                              ¯
                           
                        
                        }
                      inspired from Kameoka et al. [15]
                     
                        
                           (A.2)
                           
                              
                                 
                                    f
                                 
                                 
                                    +
                                 
                              
                              (
                              Z
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ,
                                    k
                                    ,
                                    f
                                    ,
                                    t
                                 
                              
                              
                                 
                                    
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   ikft
                                                
                                             
                                             −
                                             
                                                
                                                   W
                                                
                                                
                                                   fk
                                                
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   kt
                                                
                                             
                                             
                                                
                                                   e
                                                
                                                
                                                   j
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         kft
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   est
                                                   ,
                                                   i
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          kft
                                       
                                    
                                 
                              
                           
                        
                     where β
                     
                        kft
                      can be any positive number satisfying 
                        
                           
                              ∑
                           
                           
                              k
                           
                        
                        
                           
                              β
                           
                           
                              kft
                           
                        
                        =
                        1
                     . The auxiliary function 
                        
                           
                              f
                           
                           
                              +
                           
                        
                        (
                        Z
                        ,
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        )
                      should satisfy
                        
                           (A.3)
                           
                              f
                              (
                              Z
                              )
                              =
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    +
                                 
                              
                              (
                              Z
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        
                     
                  

If the above condition is satisfied, it can be shown based on Lee and Seung [16] that 
                        f
                        (
                        Z
                        )
                      is non-increasing under the updates 
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        ←
                        
                           
                              argmin
                           
                           
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                           
                        
                        
                           
                              f
                           
                           
                              +
                           
                        
                        (
                        Z
                        ,
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        )
                      and 
                        Z
                        ←
                        
                           
                              argmin
                           
                           
                              Z
                           
                        
                        
                           
                              f
                           
                           
                              +
                           
                        
                        (
                        Z
                        ,
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        )
                     .


                     
                        
                           
                              f
                           
                           
                              +
                           
                        
                        (
                        Z
                        ,
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        )
                      is an auxiliary function for 
                        f
                        (
                        Z
                        )
                      if
                        
                           (A.4)
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ikft
                                 
                              
                              =
                              
                                 
                                    X
                                 
                                 
                                    ift
                                 
                              
                           
                        
                     
                  


                     
                        
                           
                              f
                           
                           
                              +
                           
                        
                        (
                        Z
                        ,
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        )
                      is minimized w.r.t. 
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                      when
                        
                           (A.5)
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ikft
                                 
                              
                              =
                              
                                 
                                    W
                                 
                                 
                                    fk
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    kt
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    j
                                    
                                       
                                          ϕ
                                       
                                       
                                          kft
                                       
                                    
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    est
                                    ,
                                    i
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    kft
                                 
                              
                              (
                              
                                 
                                    X
                                 
                                 
                                    ift
                                 
                              
                              −
                              
                                 
                                    Y
                                 
                                 
                                    ift
                                 
                              
                              )
                           
                        
                     
                  

Eq. (A.5) can be derived by adding the Lagrange multiplier term to the auxiliary function of Eq. (A.2):
                        
                           (A.6)
                           
                              Λ
                              (
                              
                                 
                                    X
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              λ
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    +
                                 
                              
                              (
                              Z
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    ¯
                                 
                              
                              )
                              +
                              
                                 
                                    λ
                                 
                                 
                                    ift
                                 
                              
                              (
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ikft
                                    
                                 
                                 −
                                 
                                    
                                       X
                                    
                                    
                                       ift
                                    
                                 
                              
                              )
                           
                        
                     and then taking the derivative of (A.6) w.r.t. 
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              ikft
                           
                        
                      and setting it to zero, we have
                        
                           (A.7)
                           
                              2
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ikft
                                 
                              
                              −
                              2
                              
                                 
                                    W
                                 
                                 
                                    fk
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    kt
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    j
                                    
                                       
                                          ϕ
                                       
                                       
                                          kft
                                       
                                    
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    est
                                    ,
                                    i
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              =
                              −
                              
                                 
                                    λ
                                 
                                 
                                    ift
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    kft
                                 
                              
                           
                        
                     
                  


                     
                        
                           
                              λ
                           
                           
                              ift
                           
                        
                      is obtained by summation over k on both sides of (A.7) and applying the constraint (A.4):
                        
                           (A.8)
                           
                              
                                 
                                    λ
                                 
                                 
                                    ift
                                 
                              
                              =
                              2
                              (
                              
                                 
                                    X
                                 
                                 
                                    ift
                                 
                              
                              −
                              
                                 
                                    Y
                                 
                                 
                                    ift
                                 
                              
                              )
                           
                        
                     
                  

Consequently, 
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    ¯
                                 
                              
                           
                           
                              ikft
                           
                        
                      is obtained as given by (A.5). Substituting (A.5) in the expression (A.2), we determine the minimum value of the auxiliary function which is equal to 
                        f
                        (
                        Z
                        )
                     , so condition (A.3) is satisfied.

Differentiating 
                        
                           
                              f
                           
                           
                              +
                           
                        
                        (
                        Z
                        ,
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        )
                      w.r.t. W
                     
                        fk
                      and H
                     
                        kt
                      and setting them to zero, leads to the update relations for these parameters as stated in (14) and (15).

Deriving the update relations for ϕ
                     
                        kft
                      is not as straightforward as the above parameters. The first derivative of the auxiliary function 
                        
                           
                              f
                           
                           
                              +
                           
                        
                        (
                        Z
                        ,
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        )
                      w.r.t. ϕ
                     
                        kft
                      is proportional to the following expression:
                        
                           (A.9)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          f
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    Z
                                    ,
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          ϕ
                                       
                                       
                                          kft
                                       
                                    
                                 
                              
                              ∝
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              {
                              
                                 
                                    
                                       W
                                    
                                    
                                       fk
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       kt
                                    
                                 
                                 Re
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       est
                                       ,
                                       i
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ikft
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                              
                              }
                              sin
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    kft
                                 
                              
                              )
                              +
                              {
                              
                                 
                                    
                                       W
                                    
                                    
                                       fk
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       kt
                                    
                                 
                                 Im
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       est
                                       ,
                                       i
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ikft
                                    
                                    
                                       ⁎
                                    
                                 
                                 )
                              
                              }
                              cos
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    kft
                                 
                              
                              )
                           
                        
                     
                  

Since we assumed the first channel as reference, the channel coefficient on the first channel, 
                        
                           
                              A
                           
                           
                              est
                              ,
                              1
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                           
                        
                        =
                        1
                      in accordance with (10). Thus, setting (A.9) to zero, we obtain the following update relation for ϕ
                     
                        kft
                      coefficients:
                        
                           (A.10)
                           
                              
                                 
                                    Q
                                 
                                 
                                    1
                                    kft
                                 
                              
                              =
                              Im
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                    kft
                                 
                              
                              )
                              −
                              Im
                              (
                              
                                 
                                    A
                                 
                                 
                                    est
                                    ,
                                    2
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                    kft
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              
                                 
                                    Q
                                 
                                 
                                    2
                                    kft
                                 
                              
                              =
                              Re
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                    kft
                                 
                              
                              )
                              +
                              Re
                              (
                              
                                 
                                    A
                                 
                                 
                                    est
                                    ,
                                    2
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                    kft
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              
                                 
                                    ϕ
                                 
                                 
                                    kft
                                 
                              
                              =
                              
                                 atan
                              
                              (
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                             kft
                                          
                                       
                                    
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                             kft
                                          
                                       
                                    
                                 
                              
                              )
                           
                        
                     
                  

Actually, the above solution does not result in a unique value for ϕ
                     
                        kft
                     . The unique solution is achieved by noticing the point that the second derivative of the cost function 
                        
                           
                              f
                           
                           
                              +
                           
                        
                        (
                        Z
                        ,
                        
                           
                              Z
                           
                           
                              ¯
                           
                        
                        )
                      w.r.t. ϕ
                     
                        kft
                      should be positive:
                        
                           (A.11)
                           
                              
                                 
                                    
                                       
                                          ∂
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    Z
                                    ,
                                    
                                       
                                          Z
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          ϕ
                                       
                                       
                                          kft
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ∝
                              sin
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    kft
                                 
                              
                              )
                              ·
                              {
                              Im
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                    kft
                                 
                              
                              )
                              −
                              Im
                              (
                              
                                 
                                    A
                                 
                                 
                                    est
                                    ,
                                    2
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                    kft
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              }
                              +
                              cos
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    kft
                                 
                              
                              )
                              ·
                              {
                              Re
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                    kft
                                 
                              
                              )
                              +
                              Re
                              (
                              
                                 
                                    A
                                 
                                 
                                    est
                                    ,
                                    2
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    2
                                    kft
                                 
                                 
                                    ⁎
                                 
                              
                              )
                              }
                              ≥
                              0
                           
                        
                     
                  

Satisfying the above condition will specify the unique solution inferred from (A.10). It can be implied from (A.11) that the sine and cosine of ϕ
                     
                        kft
                      should have the same signs as the nominator and denominator of (A.10) respectively. The form of the update relation stated in (16) will satisfy this.

@&#REFERENCES@&#

