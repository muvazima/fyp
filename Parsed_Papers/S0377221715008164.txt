@&#MAIN-TITLE@&#Optimal search for parameters in Monte Carlo simulation for derivative pricing

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We provide a general framework for searching parameter space in Monte Carlo simulation.


                        
                        
                           
                           We provide two online algorithms to search for suitable parameter values in simulation for pricing.


                        
                        
                           
                           This paper gives the competitive ratios of the two algorithms.


                        
                        
                           
                           We prove the optimality of the algorithms.


                        
                        
                           
                           Experimental results on the performance of the algorithms are presented and analyzed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Finance

Monte Carlo simulation

Deterministic online algorithm

Randomized online algorithm

Competitive ratio

@&#ABSTRACT@&#


               
               
                  This paper provides a novel and general framework for the problem of searching parameter space in Monte Carlo simulations. We propose a deterministic online algorithm and a randomized online algorithm to search for suitable parameter values for derivative pricing which are needed to achieve desired precisions. We also give the competitive ratios of the two algorithms and prove the optimality of the algorithms. Experimental results on the performance of the algorithms are presented and analyzed as well.
               
            

@&#INTRODUCTION@&#

Derivatives, a main category of financial instruments, play essential roles in financial markets; thus it is important to price them efficiently and accurately. However, most complex derivatives are not known to have closed-form formulas for their prices; consequently, they are priced using numerical methods such as Monte Carlo simulation. Originated from studies in physics, Monte Carlo methods have been applied in finance (Boyle, 1977), many studies of which have focused on problems of pricing derivatives via Monte Carlo methods (e.g., Belomestny, Bender, & Schoenmakers, 2009; Kimura & Shinohara, 2006). For example, some papers focus on coping with financial derivatives with early exercise opportunities, such as American options and Bermuda options (e.g.,
Bacinello, Biffis, Millossovich, 2009; 
                     Broadie and Detemple, 1996; Ibáñez, 2004; Kan, Reesor, Whitehead, and Davison, 2009; Liu, 2010; Longstaff and Schwartz, 2001; Rogers, 2002). Other studies concern methods for pricing derivatives under different assumptions for underlying assets, such as Lévy processes (e.g., Becker, 2010; Dingeç & Hörmann, 2012; Ribeiro & Webber, 2006) and Carr–Geman–Madan–Yor processes (e.g., Ballotta and Kyriakou, 2014).

Standard Monte Carlo simulation has a simple bound of 
                        
                           O
                           (
                           1
                           /
                           
                              N
                           
                           )
                        
                     for the standard error for N paths (Hull, 2009). However, when Monte Carlo simulation is combined with other approximation techniques or is used to price complicated financial instruments, analytical analysis of its convergence is difficult to obtain (e.g., Dingeç & Hörmann, 2012; Glasserman & Li, 2005; Kan et al., 2009; Liu, 2010; Longstaff & Schwartz, 2001; Miao & Lee, 2013). In addition, computing the standard error after sampling each additional path is not applicable for some approximation techniques, such as least-squared Monte Carlo (Liu, 2010; Longstaff & Schwartz, 2001), because each additional path necessitates recalculating the prices of all other paths. Aggravating the absence of analytical convergence in most simulation methods, there has been little research on general frameworks for searching for parameter values (e.g., the number of paths) in Monte Carlo simulation that are required to achieve desired precisions while minimizing running time or other computational resources.

The problem of searching for an object in an unknown environment is central to many areas of computer science and operational research; many variants of search problems have been studied (e.g., Baeza-Yates, Culberson, & Rawlins, 1993; Chrobak, Kenyon, Noga, & Young, 2008; Kao, Reif, & Tate, 1993). Online algorithms are usually adopted to deal with the problem of searching in an unknown environment as they can process the sequence of requests piece-by-piece in a serial fashion without having the entire input available from the start. Competitive analysis was developed to analyze online algorithms; the competitive ratio of an online algorithm for an optimization problem is the worst-case ratio between the cost of the solution found by the online algorithm and the cost of an optimal solution.

Viewing our problem as a problem of searching in an unknown environment, we provide a general framework for searching parameter space in Monte Carlo simulation, which is orthogonal to the previous studies in this field. Specifically, we propose two optimal online algorithms (one deterministic and one randomized) to search for suitable parameter values for derivative pricing which are needed to achieve desired precisions. We also conduct a competitive analysis of the proposed online algorithms and give the algorithm parameters that minimize the competitive ratios in order to yield the best performance; finally, the optimality of the algorithms are also proved. Furthermore, experimental results present the performance of the algorithms and show that the algorithms can be applied to the pricing of various kinds of options, i.e., vanilla call and put options, American options, and Bermudan options. The selected pricing methods and options in the experiments are for demonstration purposes; our proposed search algorithms can be applied to any effective simulation pricing method in a straightforward manner.

This paper is organized as follows. In Section 2, some preliminaries for derivative pricing are introduced. In Section 3, we describe the proposed deterministic and randomized online algorithms and provide the competitive ratios and the proofs of their optimality. In Section 4, experimental results on the performance of the algorithms are presented and analyzed. In Section 5, we conclude the paper and provide some limitations of our work and future research directions.

Derivatives are popular financial instruments, whose values depend on other more fundamental financial assets called the underlying assets. The most common underlying assets include stocks, bonds, commodities, and currencies; the most common types of derivatives are forwards, futures, options, and swaps. Hereafter, the underlying asset is assumed to be a stock and the derivative is assumed to be an option for simplicity of discussion.

Vanilla options give their owners the rights to buy or sell the underlying stocks for the exercise price X and have no other unusual features. European-style vanilla options allow holders to exercise the options only at the maturity date T with the payoff

                           
                              (1)
                              
                                 
                                    P
                                    
                                       (
                                       T
                                       )
                                    
                                    =
                                    max
                                    
                                       (
                                       θ
                                       ·
                                       
                                          (
                                          
                                             S
                                             T
                                          
                                          −
                                          X
                                          )
                                       
                                       ,
                                       0
                                       )
                                    
                                    ,
                                 
                              
                           
                        where ST
                         denotes the stock price at time T, 
                           
                              θ
                              =
                              1
                           
                        is for call options, and 
                           
                              θ
                              =
                              −
                              1
                           
                        is for put options.

American options allow holders to exercise the options prior to the maturity date T. The value to exercise an American option at time t (0 ≤ t < T) is 
                           
                              θ
                              ·
                              
                                 (
                                 
                                    S
                                    t
                                 
                                 −
                                 X
                                 )
                              
                           
                        . The holders exercise the options early if it is more beneficial than keeping them.

Bermudan options are a hybrid of American and European options, where the buyer has the right to exercise at the date of expiration, and on certain specified dates that occur between the purchase date and the maturity date.

A risk-neutral measure is heavily adopted in the pricing of financial derivatives due to the fundamental theorem of asset pricing (Schachermayer, 2009). This theorem implies that in a complete market, the price of a derivative is the discounted expected value of the future payoff under the unique risk-neutral measure. Particularly, a European-style option’s value at time 0 equals the discounted expected payoff at time T (Harrison & Pliska, 1981), i.e.,

                           
                              (2)
                              
                                 
                                    
                                       e
                                       
                                          −
                                          r
                                          T
                                       
                                    
                                    E
                                    
                                       [
                                       P
                                       
                                          (
                                          T
                                          )
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        where r is the risk-free rate.

In finance, the geometric Brownian motion is widely used to model the stock price process (e.g., Black & Scholes, 1973), which can be represented as the following differential form under the risk-neutral probability:

                           
                              (3)
                              
                                 
                                    d
                                    
                                       S
                                       t
                                    
                                    =
                                    r
                                    
                                       S
                                       t
                                    
                                    d
                                    t
                                    +
                                    σ
                                    
                                       S
                                       t
                                    
                                    d
                                    
                                       W
                                       t
                                    
                                    ,
                                 
                              
                           
                        where r is the risk-free rate, σ is the volatility of the stock prices, and the random variable dWt
                         is the standard Brownian motion. Eq. (3) has the following solution (Shreve, 2004):

                           
                              (4)
                              
                                 
                                    
                                       S
                                       t
                                    
                                    =
                                    
                                       S
                                       0
                                    
                                    
                                       e
                                       
                                          
                                             (
                                             r
                                             −
                                             
                                                σ
                                                2
                                             
                                             /
                                             2
                                             )
                                          
                                          t
                                          +
                                          σ
                                          
                                             W
                                             t
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

When Monte Carlo methods are used to price derivatives, risk-neutral valuation (Schachermayer, 2009) is usually adopted. Numerous paths are sampled to obtain the expected payoff in a risk-neutral world and then discount this payoff at the risk-free rate (see Eq. (2)). We now use the pricing of a European-style vanilla call option to demonstrate the standard procedure of Monte Carlo simulation. This option provides a payoff at time T as in Eq. (1) with 
                           
                              θ
                              =
                              1
                           
                        . Assuming the stock price follows the geometric Brownian motion in Eq. (4), the option can be priced via the following steps:

                           
                              1.
                              Sample a normal random variable WT
                                  ∼ N(0, T) and plug it into Eq. (4) to obtain ST
                                 .

Calculate the payoff 
                                    
                                       max
                                       (
                                       
                                          S
                                          T
                                       
                                       −
                                       X
                                       ,
                                       0
                                       )
                                    
                                 from the option.

Repeat steps 1 and 2 for d paths to obtain d sample values of the payoff from the option.

Calculate the mean of the sample payoffs to obtain an unbiased estimate of the expected payoff in a risk-neutral world.

Discount the expected payoff at the risk-free rate to obtain an estimate of the option price.

The precision of the above estimated price in general depends on the number of paths; it is usually measured by the standard error of the estimate (i.e., the standard deviation of the sample means’ estimates of a population mean). The standard Monte Carlo simulation has a simple bound of 
                           
                              O
                              (
                              1
                              /
                              
                                 N
                              
                              )
                           
                        for the standard error for N paths. However, when Monte Carlo simulation is combined with other approximation techniques or is used to price complicated financial instruments, analytical analysis of its convergence is difficult to obtain. Even so, for an effective simulation method, in general, the standard error should be a decreasing function of the number of paths (see Fig. 1
                        ).
                     

This section first formulates the problem in Monte Carlo simulation of finding the parameter value that yields a desired precision. For simplicity of discussion, the parameter hereafter is assumed to be the most common one: the number of paths. Algorithms for different parameters share the same methodology as long as the precision measure is a decreasing function of the parameter.

Given a desired precision goal, the search problem 
                        P
                     is defined as follows: find the least number of paths required to achieve the given precision. We call this number the 
                        goal
                      and denote it as N hereafter. In the following discussion, we provide an optimal deterministic online algorithm and an optimal randomized online algorithm for the problem.

This section describes the proposed deterministic online algorithm 
                           DA
                         for search problem 
                           P
                        . It is a deterministic geometric sweep algorithm with geometric ratio r ≥ 2, and is modified from the work of Baeza-Yates et al. (1993).


                        Fig. 2 shows an outline of Algorithm 
                           
                              DA
                              ,
                           
                        in which each iteration first runs the simulation with d paths, tests whether the desired precision has been achieved, and then updates the number of paths d with the multiplier r. The algorithm ends when the 
                           goal
                         is achieved.

We proceed to present the competitive ratio of Algorithm 
                           DA
                         with its proof.

                           Theorem 3.1
                           
                              For any fixed r ≥ 2, Algorithm 
                                    DA
                                  has the worst-case competitive ratio
                              
                                 
                                    (5)
                                    
                                       
                                          
                                             
                                                r
                                                2
                                             
                                             
                                                r
                                                −
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           

For a given 
                                 goal
                               (
                                 
                                    N
                                    ∈
                                    
                                       N
                                       +
                                    
                                 
                              ), let kbe an integer, and let δ be a real number satisfying 0 ≤ δ < 1, where k and δ are such that 
                                 
                                    N
                                    =
                                    
                                       r
                                       
                                          k
                                          +
                                          δ
                                       
                                    
                                 
                              . The worst-case competitive ratio with the 
                                 goal
                              
                              
                                 
                                    N
                                    =
                                    ⌊
                                    
                                       r
                                       k
                                    
                                    ⌋
                                    +
                                    1
                                 
                              for Algorithm 
                                 DA
                               is

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      max
                                                      
                                                         k
                                                         ≥
                                                         1
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               ⌊
                                                               
                                                                  r
                                                                  i
                                                               
                                                               ⌋
                                                            
                                                         
                                                         
                                                            ⌊
                                                            
                                                               r
                                                               k
                                                            
                                                            ⌋
                                                            +
                                                            1
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                ≤
                                             
                                             
                                                
                                                   
                                                      max
                                                      
                                                         k
                                                         ≥
                                                         1
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               r
                                                               i
                                                            
                                                         
                                                         
                                                            r
                                                            k
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      max
                                                      
                                                         k
                                                         ≥
                                                         1
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               r
                                                               
                                                                  k
                                                                  +
                                                                  2
                                                               
                                                            
                                                            −
                                                            1
                                                         
                                                         
                                                            
                                                               (
                                                               r
                                                               −
                                                               1
                                                               )
                                                            
                                                            
                                                               r
                                                               k
                                                            
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      max
                                                      
                                                         k
                                                         ≥
                                                         1
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               r
                                                               2
                                                            
                                                            −
                                                            
                                                               1
                                                               
                                                                  r
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            r
                                                            −
                                                            1
                                                         
                                                      
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Above, the numerator of the competitive ratio is the total number of paths that Algorithm 
                                 DA
                              has tried and the denominator is 
                                 goal
                               (N), the least number of paths required to achieve the precision, in the worst-case scenario. Obviously, for any fixed r, k → ∞ yields the maximum for the above ratio; thus the worst-case competitive ratio for Algorithm 
                                 DA
                               is

                                 
                                    
                                       
                                          
                                             lim
                                             
                                                k
                                                →
                                                ∞
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                   2
                                                
                                                −
                                                
                                                   1
                                                   
                                                      r
                                                      k
                                                   
                                                
                                             
                                             
                                                r
                                                −
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                r
                                                2
                                             
                                             
                                                r
                                                −
                                                1
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                              □

Recall from Theorem 3.1 that Algorithm 
                              DA
                            is a class of algorithms indexed by the parameter r. In order to obtain the best performance possible, we seek a value of r that minimizes Eq. (5).

                              Corollary 3.2
                              
                                 The unique solution of the equation 
                                 
                                    
                                       
                                          
                                             
                                                r
                                                2
                                             
                                             −
                                             2
                                             r
                                             =
                                             0
                                          
                                       
                                    
                                 
                                 for r > 1 is
                                 
                                    
                                       
                                          r
                                          *
                                       
                                       =
                                       2
                                       ,
                                    
                                 
                                 which minimizes Eq. 
                                 
                                    (5)
                                 
                                 .
                              

To minimize Eq. (5), we first define 
                                    
                                       f
                                       
                                          (
                                          r
                                          )
                                       
                                       =
                                       
                                          r
                                          2
                                       
                                       /
                                       
                                          (
                                          1
                                          −
                                          r
                                          )
                                       
                                       ,
                                    
                                 which is a continuous function. We find the minimum by taking the derivative:

                                    
                                       
                                          
                                             
                                                f
                                                ′
                                             
                                             
                                                (
                                                r
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      r
                                                      2
                                                   
                                                   −
                                                   2
                                                   r
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      r
                                                      )
                                                   
                                                   2
                                                
                                             
                                             .
                                          
                                       
                                    
                                 The unique solution for 
                                    
                                       
                                          f
                                          ′
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                       =
                                       0
                                    
                                 is 
                                    
                                       r
                                       =
                                       2
                                    
                                 .□

In this subsection, we prove the optimality of Algorithm 
                              DA
                            by showing that it achieves a lower bound for the worst-case competitive ratio for any deterministic algorithm.

                              Lemma 3.3
                              
                                 The worst-case competitive ratio for any deterministic algorithm is at least 4.
                              

Any deterministic algorithm can be defined by a sequence 
                                    
                                       
                                          s
                                          0
                                       
                                       ,
                                       
                                          s
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          s
                                          k
                                       
                                       ,
                                       …
                                       ,
                                    
                                 where sk
                                  is the number of paths tried at stage k. Let the 
                                    goal
                                  be reached at stage i. Then the worst-case competitive ratio is

                                    
                                       
                                          
                                             
                                                max
                                                
                                                   i
                                                   ≥
                                                   0
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            0
                                                         
                                                         i
                                                      
                                                      
                                                         s
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                         
                                                            i
                                                            −
                                                            1
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 The above term is lower bounded by 4, which is proved in Baeza-Yates et al. (1993).□


                                 Since the lower bound in Lemma 
                                 
                                    3.3
                                  
                                 is achieved by Algorithm 
                                       DA
                                     with
                                 
                                    
                                       r
                                       =
                                       2
                                       ,
                                    
                                 
                                 Algorithm 
                                       DA
                                     with
                                 
                                    
                                       r
                                       =
                                       2
                                    
                                 
                                 is optimal.
                              

According to Theorem 3.1, the competitive ratio of Algorithm 
                                    DA
                                  with 
                                    
                                       r
                                       =
                                       2
                                    
                                 is equal to 4. Combining this and Lemma 3.3, the claim is proved.□

We now proceed with the proposed randomized online algorithm 
                           RA
                         for problem 
                           P
                         (see Fig. 3
                        ). Algorithm 
                           RA
                        , modified from the SmartCow algorithm of Kao et al. (1993), is a randomized geometric sweep algorithm with geometric ratio r > 1. This algorithm is similar to the deterministic algorithm 
                           DA
                         except that the initial number of paths is randomly generated with a random real θ uniformly chosen from [0, 1).

The following theorem proves the competitive ratio of Algorithm 
                           RA
                        .

                           Theorem 3.5
                           
                              For any fixed r > 1, Algorithm 
                                    RA
                                  has competitive ratio
                              
                                 
                                    (6)
                                    
                                       
                                          
                                             r
                                             
                                                ln
                                                r
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           

Recall that the given 
                                 goal
                               is set to 
                                 
                                    N
                                    =
                                    
                                       r
                                       
                                          k
                                          +
                                          δ
                                       
                                    
                                    ∈
                                    
                                       N
                                       +
                                    
                                    ,
                                 
                              where k is an integer and δ is a real value satisfying 0 ≤ δ < 1.

As shown in Algorithm 
                                 RA
                              , the number of paths tried at stage 
                                 
                                    i
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    ,
                                    ⋯
                                    }
                                 
                              is 
                                 
                                    ⌊
                                    
                                       r
                                       
                                          i
                                          +
                                          θ
                                       
                                    
                                    ⌋
                                    ,
                                 
                              where θ is uniformly distributed between 0 and 1. Let m be the first stage where rm
                               ≥ rk
                              ; clearly, 
                                 
                                    m
                                    =
                                    k
                                 
                              . Let Dbe a random variable that denotes the sum of the number of paths at each stage. Since Algorithm 
                                 RA
                               may or may not achieve the desired precision at stage 
                                 
                                    m
                                    (
                                    =
                                    k
                                    )
                                    ,
                                 
                              depending on whether or not 
                                 
                                    
                                       ⌊
                                       
                                          r
                                          
                                             m
                                             +
                                             θ
                                          
                                       
                                       ⌋
                                    
                                    ≥
                                    
                                       r
                                       
                                          k
                                          +
                                          δ
                                       
                                    
                                    ,
                                 
                              we denote F as the event that Algorithm 
                                 RA
                               reaches the 
                                 goal
                               at stage m. Additionally, because 
                                 
                                    
                                       r
                                       
                                          k
                                          +
                                          δ
                                       
                                    
                                    ∈
                                    
                                       N
                                       +
                                    
                                    ,
                                 
                              
                              F is equivalent to the event that 
                                 
                                    
                                       r
                                       
                                          m
                                          +
                                          θ
                                       
                                    
                                    ≥
                                    
                                       r
                                       
                                          k
                                          +
                                          δ
                                       
                                    
                                 
                              . Then

                                 
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      D
                                                      ]
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   Prob
                                                   
                                                      (
                                                      F
                                                      )
                                                   
                                                   ×
                                                   E
                                                   
                                                      
                                                         [
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               0
                                                            
                                                            k
                                                         
                                                         
                                                            ⌊
                                                            
                                                               r
                                                               
                                                                  i
                                                                  +
                                                                  θ
                                                               
                                                            
                                                            ⌋
                                                         
                                                         |
                                                      
                                                      F
                                                      ]
                                                   
                                                   +
                                                   Prob
                                                   
                                                      (
                                                      
                                                         F
                                                         ¯
                                                      
                                                      )
                                                   
                                                   E
                                                   
                                                      
                                                         [
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               0
                                                            
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            ⌊
                                                            
                                                               r
                                                               
                                                                  i
                                                                  +
                                                                  θ
                                                               
                                                            
                                                            ⌋
                                                         
                                                         |
                                                      
                                                      
                                                         F
                                                         ¯
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                ≤
                                             
                                             
                                                
                                                   Prob
                                                   
                                                      (
                                                      F
                                                      )
                                                   
                                                   ×
                                                   E
                                                   
                                                      
                                                         [
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               0
                                                            
                                                            k
                                                         
                                                         
                                                            r
                                                            
                                                               i
                                                               +
                                                               θ
                                                            
                                                         
                                                         |
                                                      
                                                      F
                                                      ]
                                                   
                                                   +
                                                   Prob
                                                   
                                                      (
                                                      
                                                         F
                                                         ¯
                                                      
                                                      )
                                                   
                                                   E
                                                   
                                                      
                                                         [
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               0
                                                            
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            r
                                                            
                                                               i
                                                               +
                                                               θ
                                                            
                                                         
                                                         |
                                                      
                                                      
                                                         F
                                                         ¯
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   Prob
                                                   
                                                      (
                                                      F
                                                      )
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            r
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         1
                                                      
                                                      
                                                         r
                                                         −
                                                         1
                                                      
                                                   
                                                   ×
                                                   E
                                                   
                                                      
                                                         [
                                                         
                                                            r
                                                            θ
                                                         
                                                         |
                                                      
                                                      F
                                                      ]
                                                   
                                                   +
                                                   Prob
                                                   
                                                      (
                                                      
                                                         F
                                                         ¯
                                                      
                                                      )
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            r
                                                            
                                                               k
                                                               +
                                                               2
                                                            
                                                         
                                                         −
                                                         1
                                                      
                                                      
                                                         r
                                                         −
                                                         1
                                                      
                                                   
                                                   ×
                                                   E
                                                   
                                                      [
                                                      
                                                         r
                                                         θ
                                                      
                                                      |
                                                      
                                                         F
                                                         ¯
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   Prob
                                                   
                                                      (
                                                      F
                                                      )
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            r
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         1
                                                      
                                                      
                                                         r
                                                         −
                                                         1
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         r
                                                         −
                                                         
                                                            r
                                                            δ
                                                         
                                                      
                                                      
                                                         Prob
                                                         (
                                                         F
                                                         )
                                                         ln
                                                         r
                                                      
                                                   
                                                   +
                                                   Prob
                                                   
                                                      (
                                                      
                                                         F
                                                         ¯
                                                      
                                                      )
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            r
                                                            
                                                               k
                                                               +
                                                               2
                                                            
                                                         
                                                         −
                                                         1
                                                      
                                                      
                                                         r
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   ×
                                                   
                                                      
                                                         
                                                            r
                                                            δ
                                                         
                                                         −
                                                         1
                                                      
                                                      
                                                         Prob
                                                         (
                                                         
                                                            F
                                                            ¯
                                                         
                                                         )
                                                         ln
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      1
                                                      
                                                         (
                                                         r
                                                         −
                                                         1
                                                         )
                                                         ln
                                                         r
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         (
                                                         
                                                            r
                                                            
                                                               k
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                      
                                                         (
                                                         r
                                                         −
                                                         
                                                            r
                                                            δ
                                                         
                                                         )
                                                      
                                                      +
                                                      
                                                         (
                                                         
                                                            r
                                                            
                                                               k
                                                               +
                                                               2
                                                            
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                      
                                                         (
                                                         
                                                            r
                                                            δ
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      1
                                                      
                                                         (
                                                         r
                                                         −
                                                         1
                                                         )
                                                         ln
                                                         r
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         r
                                                         
                                                            k
                                                            +
                                                            2
                                                            +
                                                            δ
                                                         
                                                      
                                                      −
                                                      
                                                         r
                                                         
                                                            k
                                                            +
                                                            1
                                                            +
                                                            δ
                                                         
                                                      
                                                      −
                                                      r
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      1
                                                      
                                                         (
                                                         r
                                                         −
                                                         1
                                                         )
                                                         ln
                                                         r
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         r
                                                         
                                                            k
                                                            +
                                                            δ
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            r
                                                            2
                                                         
                                                         −
                                                         r
                                                         )
                                                      
                                                      −
                                                      
                                                         (
                                                         r
                                                         −
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      1
                                                      
                                                         ln
                                                         r
                                                      
                                                   
                                                   
                                                      (
                                                      N
                                                      r
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                ≤
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         r
                                                         
                                                            ln
                                                            r
                                                         
                                                      
                                                      )
                                                   
                                                   N
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The competitive ratio is simply the expected sum E[D] divided by N:

                                 
                                    
                                       
                                          
                                             r
                                             
                                                ln
                                                r
                                             
                                          
                                          ,
                                       
                                    
                                 
                              which is exactly the ratio claimed in the theorem.□

According to Theorem 3.5, Algorithm 
                              RA
                            has competitive ratio

                              
                                 
                                    
                                       
                                          r
                                          
                                             ln
                                             r
                                          
                                       
                                       ,
                                    
                                 
                              
                           where r is an algorithm parameter. Similar to the deterministic online algorithm in Section 3.1, we seek a value of r that minimizes Eq. (6) to obtain the best performance possible.

                              Corollary 3.6
                              
                                 The unique solution of the equation 
                                 
                                    
                                       
                                          
                                             −
                                             
                                                1
                                                
                                                   
                                                      (
                                                      ln
                                                      r
                                                      )
                                                   
                                                   2
                                                
                                             
                                             +
                                             
                                                1
                                                
                                                   ln
                                                   r
                                                
                                             
                                             =
                                             0
                                          
                                       
                                    
                                 
                                 for r > 1 is
                                 
                                    
                                       
                                          r
                                          *
                                       
                                       =
                                       e
                                       ,
                                    
                                 
                                 which minimizes Eq. 
                                 
                                    (6)
                                 
                                 .
                              

To minimize Eq. (6), we first define 
                                    
                                       f
                                       (
                                       r
                                       )
                                       =
                                       r
                                       /
                                       ln
                                       r
                                    
                                 ; f(r) is a continuous function. We find the minimum by taking the derivative:

                                    
                                       
                                          
                                             
                                                f
                                                ′
                                             
                                             
                                                (
                                                r
                                                )
                                             
                                             =
                                             
                                                
                                                   ln
                                                   (
                                                   r
                                                   )
                                                   −
                                                   1
                                                
                                                
                                                   
                                                      (
                                                      ln
                                                      r
                                                      )
                                                   
                                                   2
                                                
                                             
                                             .
                                          
                                       
                                    
                                 The unique solution for 
                                    
                                       
                                          f
                                          ′
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                       =
                                       0
                                    
                                 is 
                                    
                                       r
                                       =
                                       e
                                    
                                 .□

This subsection proves the optimality of Algorithm 
                              RA
                            by showing that it achieves a lower bound for the worst-case competitive ratio for any randomized algorithm. To prove the lower bound for randomized algorithms, we use Yao’s corollary of the von Neumann minimax principal (Yao, 1977). Particularly, we will define a probability distribution for inputs to the problem 
                              P
                           , and then lower bound the performance of any deterministic algorithm given this input distribution. Here we adopt the family of probability distribution functions suggested in Kao et al. (1993) and denote a particular distribution function by f
                           ϵ. The density function used in Kao et al. (1993) is

                              
                                 
                                    
                                       
                                          f
                                          ϵ
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      ϵ
                                                      
                                                         x
                                                         
                                                            −
                                                            (
                                                            1
                                                            +
                                                            ϵ
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      x
                                                      ≥
                                                      1
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           In addition, we use OptD(ϵ) to denote the optimal competitive ratio of any deterministic algorithm with the input distribution f
                           ϵ and OptR to denote the optimal competitive ratio for any randomized algorithm. According to Lemma 4.1 in Kao et al. (1993), our goal is to show that 
                              
                                 ℓ
                                 =
                                 
                                    lim
                                    
                                       ϵ
                                       →
                                       0
                                    
                                 
                                 OptD
                                 
                                    (
                                    ϵ
                                    )
                                 
                              
                           exists, and find a value for this limit; thus we can say that OptR ≥ ℓ.

Any deterministic algorithm can be defined by a sequence 
                              
                                 
                                    s
                                    0
                                 
                                 ,
                                 
                                    s
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    s
                                    k
                                 
                                 ,
                                 …
                                 ,
                              
                           where sk
                            is the number of paths tried at stage k. Here we assume 
                              
                                 
                                    s
                                    0
                                 
                                 =
                                 1
                              
                           for convenience. Using this notation, we prove the following lemma.

                              Lemma 3.7
                              
                                 Let algorithm
                                 
                                    X
                                 
                                 be a deterministic algorithm defined by the sequence
                                 
                                    
                                       
                                          s
                                          0
                                       
                                       ,
                                       
                                          s
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          s
                                          k
                                       
                                       ,
                                       …
                                       
                                       .
                                    
                                 
                                 For input distribution f
                                 ϵ, the expected competitive ratio of
                                 
                                    X
                                 
                                 is 
                                 
                                    
                                       
                                          
                                             
                                                ϵ
                                                
                                                   1
                                                   +
                                                   ϵ
                                                
                                             
                                             
                                                (
                                                1
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   ∞
                                                
                                                
                                                   
                                                      s
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      s
                                                      i
                                                      
                                                         (
                                                         1
                                                         +
                                                         ϵ
                                                         )
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              

The goal can be specified by defining a variable Q which is distributed according to f
                                 ϵ and represents the least number of paths that achieves the desired precision. We also define Boolean conditions Ci
                                  for 
                                    
                                       i
                                       =
                                       0
                                       ,
                                       1
                                       ,
                                       2
                                       ,
                                       ⋯
                                       ,
                                    
                                 where Ci
                                  is true when algorithm 
                                    X
                                  achieves the 
                                    goal
                                  at stage i. Formally,

                                    
                                       
                                          
                                             
                                                C
                                                i
                                             
                                             
                                             is
                                             
                                             true
                                             
                                             if
                                             
                                             and
                                             
                                             only
                                             
                                             if
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            ≤
                                                            Q
                                                            ≤
                                                            
                                                               s
                                                               0
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            when
                                                            
                                                            i
                                                            =
                                                            0
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                               
                                                                  i
                                                                  −
                                                                  1
                                                               
                                                            
                                                            <
                                                            Q
                                                            ≤
                                                            
                                                               s
                                                               i
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            when
                                                            
                                                            i
                                                            ≥
                                                            1
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 Moreover, if R is a random variable that denotes the competitive ratio achieved by algorithm 
                                    X
                                 , then

                                    
                                       (7)
                                       
                                          
                                             E
                                             
                                                [
                                                R
                                                ]
                                             
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                ∞
                                             
                                             
                                                p
                                                i
                                             
                                             E
                                             
                                                [
                                                R
                                                |
                                                
                                                   C
                                                   i
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 where 
                                    
                                       
                                          p
                                          i
                                       
                                       =
                                       Prob
                                       
                                          (
                                          
                                             C
                                             i
                                          
                                          )
                                       
                                    
                                 . When computing the expected value E[R|Ci
                                 ], there are two cases: 
                                    
                                       i
                                       =
                                       0
                                    
                                 and i ≥ 1. For 
                                    
                                       i
                                       =
                                       0
                                       ,
                                    
                                 it is obvious that 
                                    
                                       Q
                                       =
                                       1
                                    
                                 by the definition for Ci
                                 ; thus 
                                    
                                       E
                                       [
                                       R
                                       |
                                       
                                          C
                                          i
                                       
                                       ]
                                       =
                                       1
                                    
                                 . For i≥ 1, the total number of paths tried by the algorithm is

                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                i
                                             
                                             
                                                s
                                                j
                                             
                                             .
                                          
                                       
                                    
                                 So the expected competitive ratio under i ≥ 1 is given by

                                    
                                       (8)
                                       
                                          
                                             E
                                             
                                                [
                                                R
                                                |
                                                
                                                   C
                                                   i
                                                
                                                ]
                                             
                                             =
                                             E
                                             
                                                [
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      0
                                                   
                                                   i
                                                
                                                
                                                   
                                                      s
                                                      j
                                                   
                                                   Q
                                                
                                                
                                                   |
                                                
                                                
                                                   C
                                                   i
                                                
                                                ]
                                             
                                             =
                                             E
                                             
                                                [
                                                
                                                   1
                                                   Q
                                                
                                                
                                                   |
                                                
                                                
                                                   C
                                                   i
                                                
                                                ]
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                i
                                             
                                             
                                                s
                                                j
                                             
                                             .
                                          
                                       
                                    
                                 From Kao et al. (1993), we have

                                    
                                       (9)
                                       
                                          
                                             E
                                             
                                                [
                                                
                                                   1
                                                   Q
                                                
                                                
                                                   |
                                                
                                                
                                                   C
                                                   i
                                                
                                                ]
                                             
                                             =
                                             
                                                ϵ
                                                
                                                   
                                                      p
                                                      i
                                                   
                                                   
                                                      (
                                                      1
                                                      +
                                                      ϵ
                                                      )
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   s
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                   
                                                      −
                                                      (
                                                      1
                                                      +
                                                      ϵ
                                                      )
                                                   
                                                
                                                −
                                                
                                                   s
                                                   i
                                                   
                                                      −
                                                      (
                                                      1
                                                      +
                                                      ϵ
                                                      )
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 Combining Eq. (9) with Eq. (8) yields E[R|Ci
                                 ] under i ≥ 1. By Eq. (7), we have

                                    
                                       (10)
                                       
                                          
                                             
                                                
                                                   
                                                      E
                                                      [
                                                      R
                                                      ]
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         p
                                                         0
                                                      
                                                      ×
                                                      1
                                                      +
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         ∞
                                                      
                                                      
                                                         p
                                                         i
                                                      
                                                      E
                                                      
                                                         [
                                                         R
                                                         |
                                                         
                                                            C
                                                            i
                                                         
                                                         ]
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         p
                                                         0
                                                      
                                                      +
                                                      
                                                         ϵ
                                                         
                                                            1
                                                            +
                                                            ϵ
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         ∞
                                                      
                                                      
                                                         [
                                                         
                                                            (
                                                            
                                                               s
                                                               
                                                                  i
                                                                  −
                                                                  1
                                                               
                                                               
                                                                  −
                                                                  (
                                                                  1
                                                                  +
                                                                  ϵ
                                                                  )
                                                               
                                                            
                                                            −
                                                            
                                                               s
                                                               i
                                                               
                                                                  −
                                                                  (
                                                                  1
                                                                  +
                                                                  ϵ
                                                                  )
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               0
                                                            
                                                            i
                                                         
                                                         
                                                            s
                                                            j
                                                         
                                                         ]
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         p
                                                         0
                                                      
                                                      +
                                                      
                                                         ϵ
                                                         
                                                            1
                                                            +
                                                            ϵ
                                                         
                                                      
                                                      ·
                                                      
                                                         [
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            ∞
                                                         
                                                         
                                                            (
                                                            
                                                               s
                                                               
                                                                  i
                                                                  −
                                                                  1
                                                               
                                                               
                                                                  −
                                                                  (
                                                                  1
                                                                  +
                                                                  ϵ
                                                                  )
                                                               
                                                            
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  =
                                                                  0
                                                               
                                                               i
                                                            
                                                            
                                                               s
                                                               j
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            ∞
                                                         
                                                         
                                                            (
                                                            
                                                               s
                                                               i
                                                               
                                                                  −
                                                                  (
                                                                  1
                                                                  +
                                                                  ϵ
                                                                  )
                                                               
                                                            
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  =
                                                                  0
                                                               
                                                               i
                                                            
                                                            
                                                               s
                                                               j
                                                            
                                                            )
                                                         
                                                         ]
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         p
                                                         0
                                                      
                                                      +
                                                      
                                                         ϵ
                                                         
                                                            1
                                                            +
                                                            ϵ
                                                         
                                                      
                                                      ·
                                                      
                                                         [
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               0
                                                            
                                                            ∞
                                                         
                                                         
                                                            (
                                                            
                                                               s
                                                               
                                                                  i
                                                               
                                                               
                                                                  −
                                                                  (
                                                                  1
                                                                  +
                                                                  ϵ
                                                                  )
                                                               
                                                            
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  =
                                                                  0
                                                               
                                                               
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               s
                                                               j
                                                            
                                                            )
                                                         
                                                         −
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               0
                                                            
                                                            ∞
                                                         
                                                         
                                                            (
                                                            
                                                               s
                                                               i
                                                               
                                                                  −
                                                                  (
                                                                  1
                                                                  +
                                                                  ϵ
                                                                  )
                                                               
                                                            
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  =
                                                                  0
                                                               
                                                               i
                                                            
                                                            
                                                               s
                                                               j
                                                            
                                                            )
                                                         
                                                         +
                                                         1
                                                         ]
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         ϵ
                                                         
                                                            1
                                                            +
                                                            ϵ
                                                         
                                                      
                                                      
                                                         [
                                                         1
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               0
                                                            
                                                            ∞
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  s
                                                                  
                                                                     i
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               
                                                                  s
                                                                  i
                                                                  
                                                                     (
                                                                     1
                                                                     +
                                                                     ϵ
                                                                     )
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         ]
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 Equality (10) holds since 
                                    
                                       
                                          p
                                          0
                                       
                                       =
                                       0
                                    
                                 because of the continuity of f
                                 ϵ.


                                 □

We now show that Algorithm 
                              RA
                            is optimal.

                              Theorem 3.8
                              
                                 The optimal competitive ratio for any randomized algorithm is given by 
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   r
                                                   >
                                                   1
                                                
                                             
                                             
                                                {
                                                
                                                   r
                                                   
                                                      ln
                                                      r
                                                   
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                                 Since this ratio is achieved by Algorithm 
                                       RA
                                    , Algorithm 
                                       RA
                                     is optimal.
                              

Assume that the sequence 
                                    
                                       
                                          s
                                          0
                                       
                                       ,
                                       
                                          s
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          s
                                          k
                                       
                                       ,
                                       …
                                    
                                 defines the optimal deterministic algorithm for a fixed ϵ, and let OptD(ϵ) denote the competitive ratio given in Lemma 3.7.

For a fixed ϵ, to lower bound OptD(ϵ), we need only find a lower bound for

                                    
                                       (11)
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                      (
                                                      ϵ
                                                      )
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            0
                                                         
                                                         ∞
                                                      
                                                      
                                                         
                                                            s
                                                            
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            s
                                                            i
                                                            
                                                               (
                                                               1
                                                               +
                                                               ϵ
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         s
                                                         1
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         ∞
                                                      
                                                      
                                                         
                                                            s
                                                            
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         
                                                            s
                                                            i
                                                            
                                                               (
                                                               1
                                                               +
                                                               ϵ
                                                               )
                                                            
                                                         
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 Recall that 
                                    
                                       
                                          s
                                          0
                                       
                                       =
                                       1
                                    
                                 is fixed. By setting 
                                    
                                       
                                          t
                                          i
                                       
                                       =
                                       
                                          
                                             s
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          
                                             s
                                             i
                                          
                                       
                                       ,
                                    
                                 we obtain a new sequence with 
                                    
                                       
                                          t
                                          0
                                       
                                       =
                                       1
                                    
                                 . Eq. (11)can be rewritten in terms of this new sequence as

                                    
                                       
                                          
                                             
                                                s
                                                1
                                             
                                             +
                                             
                                                s
                                                1
                                                
                                                   −
                                                   ϵ
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                ∞
                                             
                                             
                                                
                                                   t
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   t
                                                   i
                                                   
                                                      (
                                                      1
                                                      +
                                                      ϵ
                                                      )
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 This is easily bounded by

                                    
                                       (12)
                                       
                                          
                                             R
                                             
                                                (
                                                ϵ
                                                )
                                             
                                             =
                                             
                                                s
                                                1
                                             
                                             +
                                             
                                                s
                                                1
                                                
                                                   −
                                                   ϵ
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                ∞
                                             
                                             
                                                
                                                   t
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   t
                                                   i
                                                   
                                                      (
                                                      1
                                                      +
                                                      ϵ
                                                      )
                                                   
                                                
                                             
                                             ≥
                                             
                                                s
                                                1
                                             
                                             +
                                             
                                                s
                                                1
                                                
                                                   −
                                                   ϵ
                                                
                                             
                                             R
                                             
                                                (
                                                ϵ
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 From Inequality (12), we have

                                    
                                       
                                          
                                             R
                                             
                                                (
                                                ϵ
                                                )
                                             
                                             ≥
                                             
                                                
                                                   s
                                                   1
                                                
                                                
                                                   1
                                                   −
                                                   
                                                      s
                                                      1
                                                      
                                                         −
                                                         ϵ
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 hence

                                    
                                       
                                          
                                             OptD
                                             
                                                (
                                                ϵ
                                                )
                                             
                                             ≥
                                             
                                                ϵ
                                                
                                                   1
                                                   +
                                                   ϵ
                                                
                                             
                                             
                                                (
                                                1
                                                +
                                                
                                                   
                                                      s
                                                      1
                                                   
                                                   
                                                      1
                                                      −
                                                      
                                                         s
                                                         1
                                                         
                                                            −
                                                            ϵ
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 By setting 
                                    
                                       
                                          s
                                          i
                                       
                                       =
                                       
                                          s
                                          1
                                          i
                                       
                                    
                                 and recalling Lemma 3.7, the geometric algorithm has exactly the competitive ratio stated as a lower bound above. So for fixed ϵ, we have

                                    
                                       
                                          
                                             OptD
                                             
                                                (
                                                ϵ
                                                )
                                             
                                             =
                                             
                                                min
                                                
                                                   r
                                                   >
                                                   1
                                                
                                             
                                             
                                                {
                                                
                                                   ϵ
                                                   
                                                      1
                                                      +
                                                      ϵ
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      r
                                                      
                                                         1
                                                         −
                                                         
                                                            r
                                                            
                                                               −
                                                               ϵ
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              

We know that OptR ≥ limϵ → 0OptD(ϵ), so we can bound OptR by

                                    
                                       (13)
                                       
                                          
                                             
                                                
                                                   OptR
                                                
                                                
                                                   ≥
                                                
                                                
                                                   
                                                      
                                                         lim
                                                         
                                                            ϵ
                                                            →
                                                            ∞
                                                         
                                                      
                                                      
                                                         min
                                                         
                                                            r
                                                            >
                                                            1
                                                         
                                                      
                                                      
                                                         {
                                                         
                                                            ϵ
                                                            
                                                               1
                                                               +
                                                               ϵ
                                                            
                                                         
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               r
                                                               
                                                                  1
                                                                  −
                                                                  
                                                                     r
                                                                     
                                                                        −
                                                                        ϵ
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         }
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         min
                                                         
                                                            r
                                                            >
                                                            1
                                                         
                                                      
                                                      
                                                         lim
                                                         
                                                            ϵ
                                                            →
                                                            ∞
                                                         
                                                      
                                                      
                                                         {
                                                         
                                                            ϵ
                                                            
                                                               1
                                                               +
                                                               ϵ
                                                            
                                                         
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               r
                                                               
                                                                  1
                                                                  −
                                                                  
                                                                     r
                                                                     
                                                                        −
                                                                        ϵ
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         }
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         min
                                                         
                                                            r
                                                            >
                                                            1
                                                         
                                                      
                                                      
                                                         {
                                                         
                                                            r
                                                            
                                                               ln
                                                               r
                                                            
                                                         
                                                         }
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 Eq. (13) is exactly the bound claimed in this theorem.□

@&#EXPERIMENTAL RESULTS@&#

In this section we present the experimental results when applying the proposed algorithms to the pricing of European-style vanilla options, American options, and Bermudan options. In the experiments, 1375 different parameter settings in total were adopted for each type of option; the stock price was 50, the strike prices ranged from 40 to 60 with a step size of 2, the maturities ranged from 1 to 5 with a step size of 1, the volatilities of the stock prices ranged from 20 to 40 percent with a step size of 5 percent, and the interest rates ranged from 2 to 6 percent with a step size of 1 percent. For all types of options, the total number of paths (i.e., the sum of the numbers of paths) tried by the algorithms were compared for various parameters and the precision was measured using the relative standard error, which divides the standard error by the estimate. The desired precision was set to 0.5 percent in the experiments. For European-style vanilla options, the option prices calculated by simulation were all verified with the theoretical values computed by the analytical Black–Scholes formula (Black & Scholes, 1973); the mean absolute errors were all lower than 0.05 percent.


                     Fig. 4
                      plots the total numbers of paths tried by the deterministic and randomized online algorithms with their optimal settings (
                        
                           r
                           =
                           2
                        
                     and 
                        
                           r
                           =
                           e
                           ,
                        
                     respectively). Note that the comparison between the total numbers of paths is equivalent to that between the competitive ratios, since the denominators of the competitive ratios (the 
                        goal
                     ) for each parameter setting are the same whether the deterministic or randomized algorithm was used. In the figure, the gray lines represent the total numbers of paths tried by the deterministic algorithm, whereas the dotted lines denote those tried by the randomized algorithm. Recall that the competitive ratios of the deterministic and randomized algorithms are 
                        
                           
                              r
                              2
                           
                           /
                           
                              (
                              r
                              −
                              1
                              )
                           
                        
                     and r/ln r, respectively; the optimal ratios of the deterministic and randomized algorithms are 4 and e ≈ 2.718, respectively. From Fig. 4, we observe that the total numbers of paths tried by the randomized algorithm are not always smaller than those tried by the deterministic one, since the competitive ratio is the worst case (maximum) over possible events of the ratio. However, in the average cases, the randomized algorithm (red line in the figure) exhibits better performance than the deterministic algorithm (blue line) for both call and put options under the 1375 different parameter settings. Note that for the call options, the average number of paths for the randomized algorithm was 365,731, whereas that for the deterministic one was 434,585; for the put options, the average number of paths for the randomized algorithm was 230,459, whereas that for the deterministic one was 263,095.

One might ask “Why do we need Algorithms 
                        DA
                      and 
                        RA
                      in Figs. 2 and 3 for parameter search; can’t we simply compute the standard error after sampling each additional path?” Indeed, for the above European-style vanilla examples, we do not need to throw away the prices from the already performed paths because each additional sample does not affect prices generated by other paths. However, for most complex derivatives pricing problems, especially for early exercisable derivatives, updating the estimate of the standard error after sampling each additional path is not applicable because sampling one additional path necessitates recalculating the prices of all other paths. For example, when we use the least-squared Monte Carlo technique to evaluate American options or Bermudan options, each additional path necessitates recalculating of the prices of all other paths since every path is included when identifying the conditional expected value of
                      continuation via regression (see the detailed algorithm in Longstaff & Schwartz, 2001). Additionally, a general convergence result for the least-squared Monte Carlo algorithm is difficult to obtain (Longstaff & Schwartz, 2001). Therefore, a general framework to search for suitable parameter values—such as the two proposed algorithm—is both useful and essential.


                     Figs. 5 and 6 present the performance when searching for the suitable numbers of paths in the least-squared Monte Carlo simulation for the pricing of American and Bermudan options. Similarly to the results in Fig. 4, in the average cases, the randomized algorithm (red lines in the both figures) yielded better performance than the deterministic algorithm (blue lines) under the 1375 different parameter settings. Note that for the American options, the average number of paths of the randomized algorithm was 58,829, whereas that of the deterministic one was 60,594; for the Bermudan options, the average number of paths of the randomized algorithm was 67,411; that of the deterministic one was 69,548.

@&#CONCLUSIONS AND FUTURE WORK@&#

This paper brings a novel and orthogonal dimension to Monte Carlo simulation methods for derivatives pricing. We provide two general and optimal online algorithms—one deterministic and one randomized—to search for the desired parameter values in Monte Carlo simulation for derivative pricing. Our experiments on various types of options and algorithms show that the proposed approach efficiently and effectively determines a suitable number of paths for pricing these options with Monte Carlo simulation within a desired precision. Furthermore, the proposed search algorithms can be applied to any effective simulation pricing method in a straightforward manner.

For future work, note that the proposed search algorithms can be applied to “effective” simulation methods only, i.e., the standard error must be a decreasing function of the searched parameter values. It would be of interest to develop search algorithms applicable without this constraint. Also, the space of only one parameter can be searched by our proposed algorithms. Therefore, it is important to develop search algorithms that can search the space of multiple parameters, since for some financial applications, there is more than one parameter related to the precision of results using Monte Carlo methods, including for instance the pricing of barrier options (e.g. Bernis, Gobet, & Kohatsu-Higa, 2003).

@&#REFERENCES@&#

