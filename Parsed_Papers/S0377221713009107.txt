@&#MAIN-TITLE@&#Scheduling with few changes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider scheduling problems where a sequence of assignments has to be determined.


                        
                        
                           
                           The goal is to minimize the costs incurred by the interplay between the assignments.


                        
                        
                           
                           We propose simple and efficient algorithms to solve those optimization problems.


                        
                        
                           
                           We also provide hardness results where such algorithms most likely do not exist.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Assignment problem

Changeover cost

Algorithm

@&#ABSTRACT@&#


               
               
                  In this work we consider scheduling problems where a sequence of assignments from products to machines – or from tasks to operators, or from workers to resources – has to be determined, with the goal of minimizing the costs (=money, manpower, and/or time) that are incurred by the interplay between those assignments. To account for the different practical requirements (e.g. few changes between different products/tasks on the same machine/operator, few production disruptions, or few changes of the same worker between different resources), we employ different objective functions that are all based on elementary combinatorial properties of the schedule matrix. We propose simple and efficient algorithms to solve the corresponding optimization problems, and provide hardness results where such algorithms most likely do not exist.
               
            

@&#INTRODUCTION@&#

In many industrial production environments, considerable costs (=money, manpower, and/or time) are incurred whenever the production is disrupted, e.g. to readjust, retool or clean the machines. Undoubtedly due to their relevance in numerous practical applications, scheduling problems that aim to minimize these costs have received a lot of attention in the literature (see e.g. Allahverdi, Ng, Cheng, & Kovalyov, 2008; Błażewicz, Ecker, Pesch, Schmidt, & We¸glarz, 2001; Brucker, 2007 and references therein). Another fundamental problem in combinatorial optimization is the assignment problem, where tasks are to be assigned to machines, such that the costs to complete all the tasks are minimized (see e.g. Ahuja, Magnanti, & Orlin, 1993; Çela, 2002; Cook, Cunningham, Pulleyblank, & Schrijver, 1998; Pentico, 2007).

In this work we consider a family of scheduling problems at the intersection of the two above-mentioned problems: We are interested in finding an entire sequence of assignments, and the costs are incurred (only) by the interplay between those assignments. More specifically, we are given a set of parts 
                        
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           }
                        
                      and a sequence of products 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 P
                              
                              
                                 ℓ
                              
                           
                        
                     , each consisting of a subset of the parts, 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           ⊆
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           }
                        
                     . There are m identical machines, and in the ith step of the production, product 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           =
                           :
                           {
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                           }
                        
                      is produced by assembling the corresponding parts 
                        
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                        
                     . For this purpose the parts 
                        
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 p
                              
                              
                                 k
                              
                           
                        
                      have to be assigned to k of the machines, and the remaining 
                        
                           m
                           -
                           k
                        
                      machines are idle. If 
                        
                           m
                           ⩾
                           n
                        
                     , then we can reserve each machine for only one particular part throughout the production and assign all occurrences of this part to this machine (this is considered an ‘ideal’ schedule). In practice however, we usually have 
                        
                           m
                           <
                           n
                        
                      (there could be as few as 
                        
                           m
                           =
                           
                              
                                 max
                              
                              
                                 i
                                 ∈
                                 [
                                 ℓ
                                 ]
                              
                           
                           |
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           |
                        
                      machines), and a schedule will necessarily be more ‘disordered’, i.e., we cannot avoid assigning different parts to the same machine in subsequent time slots, or assigning the same part to different machines during the production. Later, we will formally define four different objective functions that measure this ‘disorder’ in a schedule (see Fig. 1
                      below).

To demonstrate that our model is quite versatile, we briefly mention three concrete applications in the following. These will also serve as a plausibility check when giving the formal definitions of our objective functions. Furthermore, the examples immediately suggest natural extensions of the model, some of which will be discussed in Section 1.2.4 below.
                        Example 1
                        A chemical manufacturing plant produces various chemicals (=products), each consisting of a specific set of constituents (=parts). The constituents are supplied to the mixing and reaction stage through a number of supply pipes (=machines). Whenever a constituent on a supply pipe changes during the production, this incurs costs to retool and clean the pipe.

A pharmaceutical packaging facility bundles together different types of pills (=parts) into patient or region specific boxes (=products). The pills are stored in containers that can be hooked to the feeding holes (=machines) of the packaging unit. Costs are incurred by the manpower necessary to exchange the containers, possibly interrupting the whole production.

The last example shows that our model also captures a set of applications that are phrased in an entirely different language.
                        Example 3
                        An insurance company has a number of employees (=parts) who use the company cars (=machines) for their field work. Work is organized in hourly timeslots, and during each timeslot, only a subset of employees (=products) needs a company car. Costs are incurred by the time losses and inconveniences caused whenever two different employees are assigned the same car in directly subsequent time slots (one has to prematurely hurry back for the exchange), and also whenever the same employee has to switch and adapt to a different car.

The main contribution of this work are simple and efficient algorithms for the optimization problems arising from the above-mentioned scenarios. We also provide hardness results to identify problems where such algorithms most likely do not exist. We hope to address those hard problems (which are important for some of the mentioned applications) in future work, by providing approximation algorithms with provable guarantees.

Before stating our results, we give a formal definition of the problem outlined above.


                        Products and machines. For any two integers r and s with 
                           
                              r
                              ⩽
                              s
                           
                         we define 
                           
                              [
                              r
                              ,
                              s
                              ]
                              ≔
                              {
                              r
                              ,
                              r
                              +
                              1
                              ,
                              …
                              ,
                              s
                              }
                           
                         and 
                           
                              [
                              r
                              ]
                              ≔
                              [
                              1
                              ,
                              r
                              ]
                              =
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              r
                              }
                           
                        .

A production is a pair 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                        , where n is an integer and 
                           
                              P
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                         is a sequence of non-empty subsets of 
                           
                              [
                              n
                              ]
                           
                        , such that 
                           
                              
                                 
                                    ⋃
                                 
                                 
                                    i
                                    ∈
                                    [
                                    ℓ
                                    ]
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              =
                              [
                              n
                              ]
                           
                         (or equivalently, for every 
                           
                              p
                              ∈
                              [
                              n
                              ]
                           
                         there is some 
                           
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                         with 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                        ). As before, we refer to each of the sets 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         as a product, and to the elements of 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         as the parts of product 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         (these terms will often be used in informal discussions). Clearly, the requirement that each part appears in at least one product is just a natural way to exclude artificial complications. As before we use m to denote the number of machines.


                        Schedules. A schedule for a production 
                        
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                              ,
                              P
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                        
                        , on m machines is an 
                           
                              ℓ
                              ×
                              m
                           
                         matrix 
                           
                              σ
                           
                         with values from 
                           
                              [
                              n
                              ]
                              ∪
                              {
                              ε
                              }
                           
                         (
                           
                              ε
                           
                         is a symbolic placeholder) with the property that for every 
                           
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                         every element of 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         occurs exactly once in the ith row of 
                           
                              σ
                           
                         (so the ith row contains exactly 
                           
                              m
                              -
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                           
                         values equal to 
                           
                              ε
                           
                        ). The interpretation of an entry 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                         with 
                           
                              σ
                              (
                              i
                              ,
                              j
                              )
                              =
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         is that when producing product 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         the part p is assigned to machine j, and 
                           
                              σ
                              (
                              i
                              ,
                              j
                              )
                              =
                              ε
                           
                         means that when producing product 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         machine j is idle. We use 
                           
                              Σ
                              =
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         to denote the set of all schedules for the production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                         on m machines.

Clearly, a necessary (and sufficient) condition for the existence of a schedule for a given production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                              ,
                              P
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                        , on m machines is that 
                           
                              m
                              ⩾
                              
                                 
                                    max
                                 
                                 
                                    i
                                    ∈
                                    [
                                    ℓ
                                    ]
                                 
                              
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                           
                        .


                        Objective functions. We now define four objective functions that measure the ‘disorder’ of a schedule. The reader is invited to check that each of the objectives is meaningful for some or all of the previously mentioned applications (not all objectives are relevant for all examples, and often some objectives are more important than others). For the reader’s convenience, the following definitions are illustrated in Fig. 1.

For a production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                         and integer m, a changeover in a schedule 
                           
                              σ
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         is a triple 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              j
                              )
                           
                         with 
                           
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              σ
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              j
                              )
                              =
                              :
                              p
                              ∈
                              [
                              n
                              ]
                              ,
                              σ
                              (
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              j
                              )
                              =
                              :
                              q
                              ∈
                              [
                              n
                              ]
                              ,
                              p
                              
                              ≠
                              
                              q
                           
                        , and 
                           
                              σ
                              (
                              i
                              ,
                              j
                              )
                              =
                              ε
                           
                         for all 
                           
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              <
                              i
                              <
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                           
                        . We denote the number of changeovers in 
                           
                              σ
                           
                         by 
                           
                              
                                 
                                    N
                                 
                                 
                                    change
                                 
                              
                              (
                              σ
                              )
                           
                        .

In many applications (cf.the above examples), a changeover 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              j
                              )
                           
                         gets more relevant/more costly, if the difference 
                           
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         gets smaller (think of 
                           
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         as the available time in which the changeover has to be performed). In this work we distinguish changeovers 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              j
                              )
                           
                         with 
                           
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              =
                              1
                           
                        , which we call critical, from changeovers with 
                           
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ⩾
                              2
                           
                         (those are not critical). We denote the number of critical changeovers in 
                           
                              σ
                           
                         by 
                           
                              
                                 
                                    N
                                 
                                 
                                    crit
                                 
                              
                              (
                              σ
                              )
                           
                        .

A critical changeover on one machine may delay or interrupt the production on all m machines (as in Examples 1 and 2 above, but not in Example 3). A stop in a schedule 
                           
                              σ
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         is an index 
                           
                              i
                              ∈
                              [
                              2
                              ,
                              ℓ
                              ]
                           
                         for which there exists a critical changeover 
                           
                              (
                              i
                              -
                              1
                              ,
                              i
                              ,
                              j
                              )
                              ,
                              j
                              ∈
                              [
                              m
                              ]
                           
                        . Note that a single stop can be caused by several critical changeovers between rows 
                           
                              i
                              -
                              1
                           
                         and i. We denote the number of stops in 
                           
                              σ
                           
                         by 
                           
                              
                                 
                                    N
                                 
                                 
                                    stop
                                 
                              
                              (
                              σ
                              )
                           
                        .

A move in a schedule 
                           
                              σ
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         is a quadruple 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         with 
                           
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                              
                              ≠
                              
                              
                                 
                                    j
                                 
                                 
                                    2
                                 
                              
                              ,
                              σ
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              σ
                              (
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              :
                              p
                              ∈
                              [
                              n
                              ]
                           
                         and 
                           
                              p
                              ∉
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         for all 
                           
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              <
                              i
                              <
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                           
                        . We denote the number of moves in 
                           
                              σ
                           
                         by 
                           
                              
                                 
                                    N
                                 
                                 
                                    move
                                 
                              
                              (
                              σ
                              )
                           
                        .

For the four above-mentioned quantities we define the minimal number of changeovers, the minimal number of critical changeovers, the minimal number of stops and the minimal number of moves, by setting for 
                           
                              *
                              ∈
                              {
                              change,crit,stop,move
                              }
                           
                         (
                           
                              *
                           
                         is used as a variable representing each of the four cases)
                           
                              (1)
                              
                                 
                                    
                                       N
                                    
                                    
                                       ∗
                                    
                                    
                                       min
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       ∗
                                    
                                    
                                       min
                                    
                                 
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 ,
                                 m
                                 )
                                 ≔
                                 
                                    
                                       
                                          min
                                       
                                       
                                          σ
                                          ∈
                                          Σ
                                          (
                                          [
                                          n
                                          ]
                                          ,
                                          P
                                          ,
                                          m
                                          )
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 σ
                                 )
                                 ,
                              
                           
                        respectively. Later we will also consider combinations of these optimization goals. We remark here that minimizing the number of stops is equivalent to makespan minimization (assuming that every stop takes the same amount of time).

Clearly, for 
                           
                              m
                              ⩾
                              n
                           
                         changeovers, stops and moves can be avoided completely (we may choose a different machine for each part, and assign all occurrences of a part to the corresponding machine). We are therefore only interested in the case 
                           
                              m
                              <
                              n
                           
                         in the following.

We are now ready to state our results.


                           
                              Theorem 4
                              
                                 There is an algorithm which computes, for any production 
                                 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                       ,
                                       P
                                       =
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ℓ
                                          
                                       
                                       )
                                    
                                 
                                 , and any integer m with 
                                 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                             ∈
                                             [
                                             ℓ
                                             ]
                                          
                                       
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       ⩽
                                       m
                                       <
                                       n
                                    
                                 
                                 , the minimal number of changeovers 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 as defined in 
                                 
                                    (1)
                                  
                                 and a schedule 
                                 
                                    
                                       σ
                                       ∈
                                       Σ
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       ,
                                       m
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 in time 
                                 
                                    
                                       O
                                       (
                                       ℓ
                                       ·
                                       m
                                       )
                                    
                                 
                                 .
                              

Note that the required bounds on m in Theorem 4 are only included to avoid trivial cases as mentioned in Section 1.1.

In many applications, e.g. if m is constant, every 
                              
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 |
                              
                            is a positive fraction of m (recall that the 
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                            are all non-empty), and then the size of the input satisfies 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       [
                                       ℓ
                                       ]
                                    
                                 
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 =
                                 Θ
                                 (
                                 ℓ
                                 ·
                                 m
                                 )
                              
                           . In those cases, the claimed running time is therefore best possible. Note also that if we wish to output the computed optimal schedule 
                              
                                 σ
                              
                            as an entire 
                              
                                 ℓ
                                 ×
                                 m
                              
                            matrix, then already this requires time 
                              
                                 Θ
                                 (
                                 ℓ
                                 ·
                                 m
                                 )
                              
                           , and the given runtime bound is best possible. Nevertheless, if the input is sparse, i.e., 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       [
                                       ℓ
                                       ]
                                    
                                 
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 =
                                 o
                                 (
                                 ℓ
                                 ·
                                 m
                                 )
                              
                           , and if we either decide to output an optimal schedule 
                              
                                 σ
                              
                            in sparse form (e.g., by returning for every 
                              
                                 i
                                 ∈
                                 [
                                 ℓ
                                 ]
                              
                            and every 
                              
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                            the machine to which p is assigned) or restrict ourselves to computing only the integer 
                              
                                 
                                    
                                       N
                                    
                                    
                                       change
                                    
                                    
                                       min
                                    
                                 
                              
                            and no optimal schedule at all, then the claimed running time might not be best possible. Observe however that 
                              
                                 ℓ
                                 ·
                                 m
                                 ⩽
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   [
                                                   ℓ
                                                   ]
                                                
                                             
                                             |
                                             
                                                
                                                   P
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                            (clearly 
                              
                                 ℓ
                              
                            and n are both bounded from above by 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       [
                                       ℓ
                                       ]
                                    
                                 
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 |
                              
                           , and 
                              
                                 m
                                 <
                                 n
                              
                           ), so in any case the claimed running time is at most quadratic in the size of the input of the algorithm.

Given a production 
                              
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 )
                                 ,
                                 P
                                 =
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                              
                           , and an integer m, note that two consecutive products 
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       -
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                            contribute at least
                              
                                 (2a)
                                 
                                    
                                       max
                                    
                                    {
                                    0
                                    ,
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    -
                                    m
                                    }
                                    =
                                    :
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           to the number of critical changeovers in any schedule 
                              
                                 σ
                                 ∈
                                 Σ
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 ,
                                 m
                                 )
                              
                           . Observe also that the elements from 
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                              
                            can be assigned to the ith row of 
                              
                                 σ
                              
                            (while leaving row 
                              
                                 i
                                 -
                                 1
                              
                            unchanged) such that exactly 
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                            critical changeovers occur between rows 
                              
                                 i
                                 -
                                 1
                              
                            and i. As critical changeovers occur only between consecutive rows, repeatedly applying this observation yields a simple greedy strategy to efficiently compute a schedule with exactly 
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                            critical changeovers between rows 
                              
                                 i
                                 -
                                 1
                              
                            and i for all 
                              
                                 i
                                 ∈
                                 [
                                 2
                                 ,
                                 ℓ
                                 ]
                              
                           . It follows that the minimal number of critical changeovers 
                              
                                 
                                    
                                       N
                                    
                                    
                                       crit
                                    
                                    
                                       min
                                    
                                 
                              
                            as defined in (1) satisfies
                              
                                 (2b)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          crit
                                       
                                       
                                          min
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             [
                                             2
                                             ,
                                             ℓ
                                             ]
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                           We conclude furthermore that any schedule that minimizes the number of critical changeovers also minimizes the number of stops, and that the minimal number of stops 
                              
                                 
                                    
                                       N
                                    
                                    
                                       stop
                                    
                                    
                                       min
                                    
                                 
                              
                            as defined in (1) satisfies
                              
                                 (3)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          stop
                                       
                                       
                                          min
                                       
                                    
                                    =
                                    |
                                    {
                                    i
                                    ∈
                                    [
                                    2
                                    ,
                                    ℓ
                                    ]
                                    
                                    |
                                    
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    >
                                    m
                                    }
                                    |
                                    .
                                 
                              
                           Summarizing, critical changeovers and stops by themselves are an entirely local phenomenon (they occur only between consecutive rows of 
                              
                                 σ
                              
                           ) and can thus be trivially minimized as a primary and sole optimization goal. The following theorems show that even if we require few changeovers as a secondary optimization goal (arbitrary changeovers, not just critical ones), an optimal solution can still be computed efficiently. To state these results, we define for any production 
                              
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 )
                              
                            and integer m, and for 
                              
                                 ∗
                                 ∈
                                 {
                                 crit,stop
                                 }
                              
                           
                           
                              
                                 (4)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ∗
                                          ,change
                                       
                                       
                                          min
                                       
                                    
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          ∗
                                          ,change
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                    ≔
                                    
                                       
                                          
                                             min
                                          
                                          
                                             σ
                                             ∈
                                             Σ
                                             (
                                             [
                                             n
                                             ]
                                             ,
                                             P
                                             ,
                                             m
                                             )
                                             :
                                             
                                                
                                                   N
                                                
                                                
                                                   ∗
                                                
                                             
                                             (
                                             σ
                                             )
                                             =
                                             
                                                
                                                   N
                                                
                                                
                                                   ∗
                                                
                                                
                                                   min
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          N
                                       
                                       
                                          change
                                       
                                    
                                    (
                                    σ
                                    )
                                    .
                                 
                              
                           
                           
                              Theorem 5
                              
                                 There is an algorithm which computes, for any production 
                                 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                       ,
                                       P
                                       =
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ℓ
                                          
                                       
                                       )
                                    
                                 
                                 , and any integer m with 
                                 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                             ∈
                                             [
                                             ℓ
                                             ]
                                          
                                       
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       ⩽
                                       m
                                       <
                                       n
                                    
                                 
                                 , the number 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             crit,change
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 defined in 
                                 
                                    (4)
                                  
                                 and a schedule 
                                 
                                    
                                       σ
                                       ∈
                                       Σ
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       ,
                                       m
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             crit
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             crit
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             stop
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             stop
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 and 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             crit,change
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 in time 
                                 
                                    
                                       O
                                       (
                                       ℓ
                                       ·
                                       m
                                       )
                                    
                                 
                                 .
                              

As a consequence of the above observation that any schedule which minimizes the number of critical changeovers also minimizes the number of stops, the condition 
                              
                                 
                                    
                                       N
                                    
                                    
                                       crit
                                    
                                 
                                 (
                                 σ
                                 )
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       crit
                                    
                                    
                                       min
                                    
                                 
                              
                            mentioned in Theorem 5 directly implies the second condition 
                              
                                 
                                    
                                       N
                                    
                                    
                                       stop
                                    
                                 
                                 (
                                 σ
                                 )
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       stop
                                    
                                    
                                       min
                                    
                                 
                              
                           . Our next theorem shows that we may drop the requirement of few critical changeovers as a primary optimization goal, and only focus on stops.
                              Theorem 6
                              
                                 There is an algorithm which computes, for any production 
                                 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                       ,
                                       P
                                       =
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ℓ
                                          
                                       
                                       )
                                    
                                 
                                 , and any integer m with 
                                 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                             ∈
                                             [
                                             ℓ
                                             ]
                                          
                                       
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       ⩽
                                       m
                                       <
                                       n
                                    
                                 
                                 , the number 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             stop,change
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 defined in 
                                 
                                    (4)
                                  
                                 and a schedule 
                                 
                                    
                                       σ
                                       ∈
                                       Σ
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       ,
                                       m
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             stop
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             stop
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 and 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             stop,change
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 in time 
                                 
                                    
                                       O
                                       (
                                       ℓ
                                       ·
                                       m
                                       )
                                    
                                 
                                 .
                              

Let us emphasize here that the resulting schedule 
                              
                                 σ
                              
                            referred to in Theorems 5 and 6 contains only as many critical changeovers or as many stops, respectively, as are unavoidable (those numbers are given by (2) and (3)).

Observe that the numbers defined in (4) and referred to in Theorems 5 and 6 satisfy
                              
                                 (5)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          crit,change
                                       
                                       
                                          min
                                       
                                    
                                    ⩾
                                    
                                       
                                          N
                                       
                                       
                                          stop,change
                                       
                                       
                                          min
                                       
                                    
                                    .
                                 
                              
                           As we shall see, the algorithms referred to in Theorems 5 and 6 can be obtained by extending the algorithm from Theorem 4.

In contrast to the previously mentioned optimization goals, most likely there is no efficient algorithm that computes the minimal number of moves.
                              Theorem 7
                              
                                 Computing 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             move
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 as defined in 
                                 
                                    (1)
                                  
                                 is NP-hard.
                              

In the following we present several results about generalizations of our problem that are relevant in practice (recall the examples from the beginning).


                           Variable product order. Suppose that the order of the products 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ℓ
                                    
                                 
                              
                            in a production is not fixed, but also part of the scheduling procedure. I.e., we aim at finding a permutation 
                              
                                 π
                                 :
                                 [
                                 ℓ
                                 ]
                                 →
                                 [
                                 ℓ
                                 ]
                              
                            
                           and an assignment of the parts in each of the products 
                              
                                 
                                    
                                       P
                                    
                                    
                                       π
                                       (
                                       1
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       π
                                       (
                                       ℓ
                                       )
                                    
                                 
                              
                            (in this permuted order) to the m machines, such that the costs for the resulting schedule as defined in Section 1.1 are minimized. For changeovers, critical changeovers, stops and moves we denote the corresponding minimal quantities by 
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       change
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       crit
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       stop
                                    
                                    
                                       min
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       move
                                    
                                    
                                       min
                                    
                                 
                              
                           , respectively.

Not so surprisingly, the additional freedom of a variable product order makes each of those optimization problems hard.
                              Theorem 8
                              
                                 Computing 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             change
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             crit
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             stop
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 or 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             move
                                          
                                          
                                             min
                                          
                                       
                                    
                                  
                                 is NP-hard.
                              


                           Multiset products. All our previous results (Theorems 4–8) carry over to the generalized setting where the products 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ℓ
                                    
                                 
                              
                            in a production 
                              
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 )
                              
                            are allowed to be multisets (i.e., a part 
                              
                                 p
                                 ∈
                                 [
                                 n
                                 ]
                              
                            may occur multiple times in a product 
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 i
                                 ∈
                                 [
                                 ℓ
                                 ]
                              
                           ). This is trivially the case for the hardness results (Theorems 7 and 8). Furthermore, as we shall see, algorithms for such multiset productions having the properties claimed in Theorems 4–6 can be obtained by a simple extension of the original (non-multiset) algorithms.

@&#RELATED WORK@&#

There is a long line of research on scheduling problems that take into account costs (=money, manpower, and/or time) incurred by switching between different kinds of products on the same machine (see e.g. Allahverdi et al., 2008; Błażewicz et al., 2001, Chap. 4.4; Brucker, 2007, Chap. 9 and references therein). However, most of the existing models not only aim at minimizing these changeover or setup costs, but also production and storage costs. Moreover, they also consider production demands (amount of a certain product to be produced until a certain deadline) and storage capacity bounds. Due to this generality, almost all but the simplest optimizations problems in this setting are NP-hard, even on a single machine (Bruno & Downey, 1978; Florian, Lenstra, & Rinnooy Kan, 1980; Monma & Potts, 1989). Typically, these optimization problems can be formulated straightforwardly as integer programs (Blocher, Chand, & Sengupta, 1999; Vanderbeck, 1998). The computational effort to (approximately) solve these integer programs can often be reduced quite substantially by applying polyhedral methods to the corresponding linear programming relaxation (Magnanti & Sastry, 2002). Nevertheless, the hardness of the problem still renders large problem instances intractable.

In the following we mention several results that are based on much simpler production and scheduling models than the ones mentioned before (similar to our setting). These models are appealing through their simple combinatorial structure, which sometimes allows for efficient algorithms. In Hu, Kuo, and Ruskey (1987) the production of different products 
                           
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                         with prescribed demands is considered, with the objective of minimizing the number of changeovers from a product i to a product j with 
                           
                              i
                              >
                              j
                           
                         (no changeover is incurred if 
                           
                              i
                              ⩽
                              j
                           
                        ). The authors propose simple and efficient backward-time scheduling algorithms for this problem, both for the single and multiple machine version. Another well-known scheduling problem with changeover costs that has a strong combinatorial flavor is the following: We are given a set of tasks 
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                           
                         to be scheduled on a single machine, with an arbitrary underlying precedence order 
                           
                              ≺
                           
                         (in this case it is more natural to refer to the 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                         as tasks, rather than products). The goal is to find a permutation of the tasks that respects the given precedence order and minimizes the number of changeovers from a task 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                         to a task 
                           
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                           
                         with 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ⊀
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                           
                         (no changeover is incurred if 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ≺
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                           
                        ). In order theoretic language, the minimal achievable number of changeovers is called the jump number. For certain restricted classes, such as precedence orders 
                           
                              ≺
                           
                         that do not contain alternating cycles or that are N-free (N denotes a specific 4-element order), the jump number can be computed efficiently (Duffus, Rival, & Winkler, 1982; Rival, 1983). For other natural classes, such as orders of height 1 or interval orders (which capture the relations between sequential and overlapping time intervals), computing the jump number is NP-hard (Mitas, 1991; Pulleyblank, 1975).

The assignment problem is one of the fundamental problems in combinatorial optimization with an abundant number of applications and a long history of algorithmic improvements (see e.g. Ahuja et al., 1993; Cook et al., 1998 and references therein). In this problem we are given n tasks and n machines, and costs 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         for assigning task i to machine j. The goal is to find an assignment of the tasks to the machines (a one-to-one mapping) that minimizes the sum of the costs. The problem of finding such a minimum-cost perfect matching in a bipartite graph can be solved in time 
                           
                              O
                              (
                              
                                 
                                    n
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        . For generalizations and variations of the assignment problem (and also more applications) we refer to the surveys (Çela, 2002; Pentico, 2007). A variant that relates directly to our problem is considered in Sinha (2009), where multiple tasks may be assigned to the same machine, with a changeover penalty cost for each additional task assigned to the same machine (except the first one). If the changeover costs depend only on the machines, but not on the tasks, the problem allows a straightforward reduction to the original assignment problem (duplicate each machine n times, and add the changeover costs to the costs of the duplicate edges), giving an 
                           
                              O
                              (
                              
                                 
                                    n
                                 
                                 
                                    6
                                 
                              
                              )
                           
                         algorithm. For arbitrary changeover costs the problem is NP-hard.

Note that in our model all machines are identical, and the cost of assigning a part i to a machine j is always 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              1
                           
                         (i.e., these costs can be neglected). It would be interesting to investigate to which extent our results can be generalized to arbitrary costs 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         as in the assignment problem. In the simplest form we might want to forbid certain assignments by setting 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              ∞
                           
                        , a reasonable constraint in view of the examples mentioned above.

When finalizing this manuscript we learnt that for yet another industrial application as the ones mentioned in the beginning, similar results as described in this work have been obtained independently in Adjiashvili, Bosio, and Zemmer (submitted for publication).

In Section 2 we prove Theorem 4. In Section 3 we prove Theorems 5 and 6 (some technical and lengthy arguments in proving Theorem 5 are deferred to Appendix A). In Section 4 we describe the extensions that allow the algorithms described in the preceding sections to deal with multiset products. Finally, in Section 5 we turn to our hardness results and present the proofs of Theorems 7 and 8.

In this section we present an algorithm BuildBlocks() that has the properties claimed in Theorem 4.

Before going into any details, let us outline the underlying ideas of the algorithm in an informal way. As input the algorithm takes a production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                              ,
                              P
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                        , and an integer m (the number of machines) as specified in Theorem 4. The algorithm outputs the minimal number of changeovers 
                           
                              
                                 
                                    N
                                 
                                 
                                    change
                                 
                                 
                                    min
                                 
                              
                           
                         and a schedule 
                           
                              σ
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         with 
                           
                              
                                 
                                    N
                                 
                                 
                                    change
                                 
                              
                              (
                              σ
                              )
                              =
                              
                                 
                                    N
                                 
                                 
                                    change
                                 
                                 
                                    min
                                 
                              
                           
                        . The computation of an optimal schedule is split into two phases. In the first phase the algorithm computes a so-called pre-schedule. In the second phase an actual schedule is derived from this pre-schedule. Informally speaking, whereas a schedule describes an assignment of parts to machines, a pre-schedule only determines which parts of the same kind are to be scheduled on the same machine – those parts are grouped together to so-called blocks. On which machine each block will be scheduled, however, is only fixed during the second phase. As only parts of the same kind are grouped together to a block, changeovers can only occur between different blocks, but never within the same block. In particular, the final number of changeovers is essentially given by the number of blocks of the pre-schedule. Consequently, minimizing changeovers is equivalent to constructing a pre-schedule with the minimal number of blocks in the first phase.

The computation of a pre-schedule (with the minimal number of blocks) proceeds by successively adding for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              ℓ
                           
                         every 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         one after the other. The strategy here is to greedily extend an already existing block of p’s whenever possible (this will cause no changeover), and to create a new block of p’s only if it cannot be avoided (this will result in one changeover). The computation of a schedule from this pre-schedule also proceeds greedily by scheduling the blocks one after the other, and the way the pre-schedule is defined ensures that all blocks fit into the schedule matrix.

The following definitions make those informal ideas precise and will allow us to state the algorithm as pseudocode. For the readers’s convenience, these definitions are illustrated in Table 1
                        .


                        Empty entries of a schedule. Let 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                         be a production, m an integer, and 
                           
                              σ
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         a schedule for this production. We call an entry, a column, or the entire schedule 
                           
                              σ
                           
                         
                        empty, if the corresponding values of the matrix 
                           
                              σ
                           
                         are all equal to 
                           
                              ε
                           
                        .


                        Blocks and pre-schedules. For a production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                              ,
                              P
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                        , and some 
                           
                              p
                              ∈
                              [
                              n
                              ]
                           
                        , a block of p’s is a strictly increasing non-empty sequence of integers 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              )
                              =
                              :
                              β
                           
                         with 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                         for all 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              c
                           
                        . We define 
                           
                              start
                              (
                              β
                              )
                              ≔
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              end
                              (
                              β
                              )
                              ≔
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                           
                        , and we say that this block starts at row 
                        
                           
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         and ends at row 
                        
                           
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                           
                        . Furthermore, we say that this block occupies a slot in row i for every 
                           
                              i
                              ∈
                              [
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              ]
                           
                        .

A pre-schedule for a production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                              ,
                              P
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                        , is a family of mappings 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              =
                              (
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                         such that the following conditions hold: for every 
                           
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                         the domain of 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         is a subset of 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         and for every 
                           
                              p
                              ∈
                              dom
                              (
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         we have that 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              p
                              )
                           
                         is a block of p’s starting at row i; for every 
                           
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                         and every 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         there is exactly one block 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    
                                       
                                          ı
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              (
                              p
                              )
                           
                         of p’s that contains the entry i (note that we must have 
                           
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              ⩽
                              i
                           
                        ). We denote the number of blocks of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         by 
                           
                              |
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              |
                              ≔
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    [
                                    ℓ
                                    ]
                                 
                              
                              |
                              dom
                              (
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              |
                           
                        . We use 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ‾
                                 
                              
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    ‾
                                 
                              
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                         to denote the set of all pre-schedules for the production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                        .


                        Width, separation, naturalness. We define the width of a pre-schedule 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         
                        in the ith row, denoted 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        , as the number of blocks of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         that occupy a slot in row i. Moreover, we define the width of 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         as 
                           
                              w
                              (
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              )
                              ≔
                              
                                 
                                    max
                                 
                                 
                                    i
                                    ∈
                                    [
                                    ℓ
                                    ]
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        .

For a pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    Σ
                                 
                                 
                                    ‾
                                 
                              
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                         and integer m, we say that the ith row of 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         
                        is blocked, if 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              )
                              =
                              m
                           
                        . Let 
                           
                              β
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                           
                         be two blocks of p’s in 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         with 
                           
                              start
                              (
                              β
                              )
                              <
                              start
                              (
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        . We say that 
                           
                              β
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                           
                         are separated, if there is a blocked row i with 
                           
                              end
                              (
                              β
                              )
                              <
                              i
                              <
                              start
                              (
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        . We call row i separating for the two blocks 
                        
                           
                              β
                           
                         
                        and 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                           
                        . If for any 
                           
                              p
                              ∈
                              [
                              n
                              ]
                           
                        , any two different blocks 
                           
                              β
                              ,
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                           
                         of p’s with 
                           
                              start
                              (
                              β
                              )
                              <
                              start
                              (
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         in 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         are separated, then we call 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         
                        fully separated. Note that if 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         is fully separated, then for any 
                           
                              p
                              ∈
                              [
                              n
                              ]
                           
                        , the intervals 
                           
                              [
                              start
                              (
                              β
                              )
                              ,
                              end
                              (
                              β
                              )
                              ]
                           
                         for all blocks 
                           
                              β
                           
                         of p’s in 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         are pairwise disjoint. Furthermore, for any two blocks of p’s in such a pre-schedule, there is a separating row i, such that for all blocks of q’s that occupy a slot in row i we have 
                           
                              p
                              
                              ≠
                              
                              q
                           
                        .

For a pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              
                                 
                                    Σ
                                 
                                 
                                    ‾
                                 
                              
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                         and integer m, we say that a block 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              )
                           
                         of p’s is natural, if for every 
                           
                              k
                              ∈
                              [
                              c
                              -
                              1
                              ]
                           
                         and any two blocks 
                           
                              β
                              ,
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                           
                         of q’s, 
                           
                              p
                              
                              ≠
                              
                              q
                           
                        , with 
                           
                              end
                              (
                              β
                              )
                              <
                              start
                              (
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        , we have that 
                           
                              start
                              (
                              
                                 
                                    β
                                 
                                 
                                    ′
                                 
                              
                              )
                              ∉
                              [
                              
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              +
                              1
                              ,
                              
                                 
                                    i
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              -
                              1
                              ]
                           
                         or at least one of the rows 
                           
                              [
                              end
                              (
                              β
                              )
                              +
                              1
                              ,
                              
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              ]
                           
                         is blocked (i.e., at least one of those rows has width m). If for any 
                           
                              p
                              ∈
                              [
                              n
                              ]
                           
                        , every block of p’s in 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         is natural, then we call 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         
                        fully natural.

We emphasize here that the notions defined in the previous two paragraphs are all with respect to a fixed integer m.

The conditions of a pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         being fully separated and fully natural are particularly significant, as they imply that 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         has the minimal number of blocks (we will later prove this formally by showing that if one of the two conditions is violated, then the number of blocks of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         can be reduced by a simple exchange operation). Therefore, by computing a pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         that satisfies those conditions in the first phase, our algorithm ensures that 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         has the minimal number of blocks. As indicated before, this will allow the algorithm to derive a schedule with the minimal number of changeovers from 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         in the second phase.


                        Compatibility between pre-schedules and schedules. Let 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                              ,
                              P
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                        , be a production, m an integer, and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         and 
                           
                              σ
                           
                         be a pre-schedule and a schedule for this production, respectively. We say that 
                           
                              σ
                           
                         is block-preserving with respect to 
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                        , if for every 
                           
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                         and every 
                           
                              p
                              ∈
                              dom
                              (
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         the block 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              p
                              )
                              =
                              :
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              )
                           
                         satisfies the following condition: there is a column j in 
                           
                              σ
                           
                         with 
                           
                              σ
                              (
                              
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              ,
                              j
                              )
                              =
                              p
                           
                         for all 
                           
                              k
                              ∈
                              [
                              c
                              ]
                           
                        , and 
                           
                              σ
                              (
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              j
                              )
                              =
                              ε
                           
                         for all 
                           
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              [
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              ]
                              ⧹
                              {
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              }
                           
                        . In this case we say that the block 
                        
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              p
                              )
                           
                         
                        is scheduled in column j.

Consider now the algorithm BuildBlocks() as defined in Algorithm 1. As already indicated, the algorithm consists of two phases, given by the functions PreSchedule() and Schedule() as defined in Functions 2 and 3. In the following we explain each of those functions, thus filling in the details that were missing in the rough outline of the algorithm at the beginning of this section. As an example, we mention that running the algorithm BuildBlocks() on the production from Table 1 for 
                           
                              m
                              =
                              3
                           
                         machines yields the pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         and the schedule 
                           
                              σ
                           
                         in the table.
                           Algorithm 1
                           BuildBlocks([n],
                              P,
                              m) 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: a production 
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      )
                                                      ,
                                                      P
                                                      =
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      )
                                                   
                                                , an integer m with 
                                                   
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            i
                                                            ∈
                                                            [
                                                            ℓ
                                                            ]
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      |
                                                      ⩽
                                                      m
                                                      <
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Output: the minimal number of changeovers 
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            change
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                 and a schedule 
                                                   
                                                      σ
                                                      ∈
                                                      Σ
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      ,
                                                      m
                                                      )
                                                   
                                                 with 
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            change
                                                         
                                                      
                                                      (
                                                      σ
                                                      )
                                                      =
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            change
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             A1 
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                
                                                ≔PreSchedule
                                                
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      ,
                                                      m
                                                      )
                                                   
                                                 
                                                 /∗compute pre-schedule∗/
                                          
                                          
                                             A2 
                                                   
                                                      σ
                                                   
                                                
                                                ≔Schedule
                                                
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      ,
                                                      m
                                                      ,
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      )
                                                   
                                                 
                                                 /∗ compute schedule from pre-schedule∗/
                                          
                                          
                                             A3 return 
                                                
                                                   
                                                      (
                                                      |
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      |
                                                      -
                                                      m
                                                      ,
                                                      σ
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

PreSchedule([n],
                              P,
                              m) 
                                 
                                    
                                 
                              
                           

Schedule([n],
                              P,
                              m,
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              ) 
                                 
                                    
                                 
                              
                           

The function PreSchedule() computes a pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         by successively adding for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              ℓ
                           
                         every 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         one after the other (these are the main loops in line B3 and line B4), starting with the empty pre-schedule (cf. line B1). For every 
                           
                              p
                              ∈
                              [
                              n
                              ]
                           
                         we maintain a boolean variable 
                           
                              new
                              (
                              p
                              )
                           
                         and integer variables 
                           
                              start
                              (
                              p
                              )
                           
                         and 
                           
                              end
                              (
                              p
                              )
                           
                        . The variable 
                           
                              new
                              (
                              p
                              )
                           
                         is initially set to 
                           
                              true
                           
                         (cf. line B2), and set to 
                           
                              false
                           
                         once p has been encountered for the first time (cf. line B12). The variables 
                           
                              start
                              (
                              p
                              )
                           
                         and 
                           
                              end
                              (
                              p
                              )
                           
                         denote the start and end row of the block of p’s which was last modified. Whenever a part 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         is to be added to the pre-schedule, we first compute the set of blocked rows of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         in line B5. If the condition in line B6 is satisfied, p is added to the pre-schedule by creating a new block of p’s which starts in row i and consists only of the entry i (cf. line B7). Otherwise p is added by extending a previous block of p’s by the entry i (cf. lines B10–B11). Whereas the variable 
                           
                              end
                              (
                              p
                              )
                           
                         is updated in both cases (cf. line B13), the variable 
                           
                              start
                              (
                              p
                              )
                           
                         is only updated in the first case (creation of a new block, cf. line B8). We will argue later that the pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         computed in this fashion indeed satisfies 
                           
                              w
                              (
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                              )
                              ⩽
                              m
                           
                         and is fully separated and fully natural (for this argument the condition in line B6 will be essential; see the proof of Lemma 9 below).

The function Schedule() computes a schedule 
                           
                              σ
                           
                         from the given pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         by scheduling for 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              ℓ
                           
                        , all blocks of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         that start in row i one after the other (these are the main loops in line C4 and line C5), starting with the empty schedule (cf. line C1). We maintain variables 
                           
                              E
                              ⊆
                              [
                              m
                              ]
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              ⊆
                              [
                              m
                              ]
                              ,
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                        , where E denotes the set of empty columns of 
                           
                              σ
                           
                         (this corresponds to machines to which no part has been assigned yet) and 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           
                         the set of columns j with 
                           
                              σ
                              (
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              j
                              )
                              =
                              ε
                           
                         for all 
                           
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              [
                              i
                              ,
                              ℓ
                              ]
                           
                         (this corresponds to machines on which we can schedule an arbitrary block that starts in row i). The first m blocks encountered during the function are all scheduled on a different machine, causing no changeovers (cf. lines C6–C8). This ensures that 
                           
                              σ
                           
                         has no empty columns. All later blocks are scheduled on a previously used machine by choosing in round i an arbitrary machine from the set 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           
                         (cf. line C10). After scheduling a block of p’s in some column j (cf. lines C11–C13), j is removed from all sets 
                           
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ı
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                           
                         from the start to the end row of this block (cf. lines C14–C15). This ensures that 
                           
                              σ
                           
                         is block-preserving with respect to 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                        .

The correctness of the algorithm BuildBlocks() follows by combining Lemmas 9–11 below (cf. also line A3 and (6)). Lemmas 9 and 10 assert key properties of the results computed by the functions PreSchedule() and Schedule(), respectively. The crucial part is Lemma 11, which asserts that these properties guarantee optimality. More specifically, Lemma 11 essentially states that the two properties of a pre-schedule being fully separated and fully natural guarantee that a schedule with the minimal number of changeovers can be derived from it (as it is done in the function Schedule()). As we shall see, Lemmas 9 and 10 can be verified straightforwardly by carefully analyzing the pseudocode presented in the previous section. On the other hand, the proof of Lemma 11 is completely independent of our algorithm BuildBlocks(), and mainly relies on the abstract concepts introduced earlier (separation, naturalness, etc.).
                           Lemma 9
                           Correctness of PreSchedule()


                           
                              For any input as specified, the function P
                              re
                              S
                              chedule
                              () computes a pre-schedule 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                    ∈
                                    
                                       
                                          Σ
                                       
                                       
                                          ‾
                                       
                                    
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    )
                                 
                               
                              with 
                              
                                 
                                    w
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    ⩽
                                    m
                                 
                               
                              that is fully separated and fully natural.
                           


                              For any input as specified, the function S
                              chedule
                              () computes a block-preserving schedule 
                              
                                 
                                    σ
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                               
                              without empty columns.
                           


                              Let 
                              
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    )
                                    ,
                                    P
                                    =
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ℓ
                                       
                                    
                                    )
                                 
                              
                              , be a production, m an integer with 
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          i
                                          ∈
                                          [
                                          ℓ
                                          ]
                                       
                                    
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    ⩽
                                    m
                                    <
                                    n
                                 
                              
                              , and 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                    ∈
                                    
                                       
                                          Σ
                                       
                                       
                                          ‾
                                       
                                    
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    )
                                 
                               
                              a pre-schedule with 
                              
                                 
                                    w
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    ⩽
                                    m
                                 
                               
                              that is fully separated and fully natural. Then any block-preserving schedule 
                              
                                 
                                    σ
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                               
                              without empty columns satisfies
                              
                                 
                                    (6)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       -
                                       m
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                          
                                             min
                                          
                                       
                                       .
                                    
                                 
                              
                           


                           
                              Proof
                              Proof of Lemma 9
                              


                              For every 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       ℓ
                                    
                                  and every 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , the index i is added to exactly one block of p’s, either by creating a new block of p’s that starts in row i (cf. line B7) or by extending a block of p’s that starts in row 
                                    
                                       start
                                       (
                                       p
                                       )
                                       <
                                       i
                                    
                                  (cf. lines B10–B11). Note here that the variable 
                                    
                                       start
                                       (
                                       p
                                       )
                                    
                                  that keeps track of the start row of the block of p’s which was last modified is updated only in the first case (cf. line B8). It follows that 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is indeed a pre-schedule for the given production 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                 . Moreover, for any 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                 , the intervals 
                                    
                                       [
                                       start
                                       (
                                       β
                                       )
                                       ,
                                       end
                                       (
                                       β
                                       )
                                       ]
                                    
                                  for all blocks 
                                    
                                       β
                                    
                                  of p’s are pairwise disjoint.

After the initialization of 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  in line B1 we clearly have 
                                    
                                       w
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       =
                                       0
                                    
                                 . Now consider some fixed 
                                    
                                       i
                                       ∈
                                       [
                                       ℓ
                                       ]
                                    
                                  and 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                 . If the condition in line B6 is satisfied, the width of 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  increases by 
                                    
                                       +
                                       1
                                    
                                  in row i, otherwise the width increases by 
                                    
                                       +
                                       1
                                    
                                  in all rows 
                                    
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       +
                                       1
                                       ,
                                       i
                                       ]
                                    
                                  for 
                                    
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                    
                                  as defined in line B10. It follows that at the end of the ith iteration of the outer for-loop we have 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       =
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       |
                                    
                                 , which is at most m by the assumption 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ¯
                                                
                                             
                                             ∈
                                             [
                                             ℓ
                                             ]
                                          
                                       
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       |
                                       ⩽
                                       m
                                    
                                 . It remains to show that the width in the rows 
                                    
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       +
                                       1
                                       ,
                                       i
                                       ]
                                    
                                  in the second case above does not exceed m. By the previously mentioned disjoint-interval property and the definition in line B13 we have 
                                    
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       =
                                       end
                                       (
                                       p
                                       )
                                    
                                 , for the value of 
                                    
                                       end
                                       (
                                       p
                                       )
                                    
                                  in line B6 and line B10 (before the update in line B13). Hence, by the condition in line B6 and the definition of the set B in line B5, before adding 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                  to the pre-schedule, 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  has no blocked rows (
                                    
                                       B
                                       =
                                       ∅
                                    
                                 ) or all blocked rows occur strictly before row 
                                    
                                       end
                                       (
                                       p
                                       )
                                       +
                                       1
                                    
                                  (
                                    
                                       max
                                       B
                                       ⩽
                                       end
                                       (
                                       p
                                       )
                                    
                                 ). It follows that before adding 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                  the width of 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is at most 
                                    
                                       m
                                       -
                                       1
                                    
                                  in all rows 
                                    
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       +
                                       1
                                       ,
                                       i
                                       ]
                                       =
                                       [
                                       end
                                       (
                                       p
                                       )
                                       +
                                       1
                                       ,
                                       i
                                       ]
                                    
                                 , implying that the width is at most m after adding 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                 . We conclude that the computed pre-schedule satisfies 
                                    
                                       w
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                 .

We already observed that for any 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                 , the intervals 
                                    
                                       [
                                       start
                                       (
                                       β
                                       )
                                       ,
                                       end
                                       (
                                       β
                                       )
                                       ]
                                    
                                  for all blocks 
                                    
                                       β
                                    
                                  of p’s are pairwise disjoint. To show that 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is fully separated, we only need to show that for any two consecutive blocks 
                                    
                                       β
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  of p’s there is a blocked row i with 
                                    
                                       end
                                       (
                                       β
                                       )
                                       <
                                       i
                                       <
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 . We fix some 
                                    
                                       i
                                       ∈
                                       [
                                       ℓ
                                       ]
                                    
                                  and 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and consider the case that a new block 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  of p’s starting in row 
                                    
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       i
                                    
                                  is created during the algorithm (cf. line B7), i.e., the condition in line B6 is satisfied. We only need to consider the case that p is contained in some 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                       <
                                       i
                                    
                                 , i.e., we have 
                                    
                                       new
                                       (
                                       p
                                       )
                                       =
                                       false
                                    
                                  and the previous block 
                                    
                                       β
                                    
                                  of p’s ends at row 
                                    
                                       end
                                       (
                                       β
                                       )
                                       =
                                       end
                                       (
                                       p
                                       )
                                       <
                                       i
                                    
                                 . By the condition in line B6 and the definition of the set B in line B5, there is a blocked row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       B
                                    
                                  with 
                                    
                                       end
                                       (
                                       p
                                       )
                                       <
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . We argued above that before adding 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                  to 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  we have 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                       -
                                       1
                                    
                                 , implying that 
                                    
                                       i
                                       ∉
                                       B
                                    
                                 , i.e., 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       <
                                       i
                                    
                                 . We conclude that there is a blocked row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  with 
                                    
                                       end
                                       (
                                       β
                                       )
                                       <
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       <
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                  and that row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is separating for 
                                    
                                       β
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 . As in the course of the algorithm the width is non-decreasing in every row, it follows that row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is separating for 
                                    
                                       β
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  also in the final pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . Consequently, the computed pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is fully separated.

To prove that 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is fully natural, we proceed as follows: We fix some 
                                    
                                       i
                                       ∈
                                       [
                                       ℓ
                                       ]
                                    
                                  and 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and consider the case that an existing block 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                  of p’s is extended by the entry i (cf. lines B10–B11), i.e., the condition in line B6 is violated. We show that for any two blocks 
                                    
                                       β
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  of q’s, 
                                    
                                       p
                                       
                                       ≠
                                       
                                       q
                                    
                                 , with 
                                    
                                       end
                                       (
                                       β
                                       )
                                       <
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                  we have that 
                                    
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ∈
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       +
                                       1
                                       ,
                                       i
                                       -
                                       1
                                       ]
                                    
                                  implies that at least one of the rows 
                                    
                                       [
                                       end
                                       (
                                       β
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       ]
                                    
                                  is blocked. As argued above, before 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                  is added to the pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , the width of all rows 
                                    
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       +
                                       1
                                       ,
                                       i
                                       ]
                                    
                                  is at most 
                                    
                                       m
                                       -
                                       1
                                    
                                 . As 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ≔
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       <
                                       i
                                    
                                 , the element 
                                    
                                       q
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                  was added to the pre-schedule in a previous iteration of the outer for-loop. As all row-widths are non-decreasing in the course of the algorithm, it follows that before 
                                    
                                       q
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                  was added, the width of all rows 
                                    
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ]
                                    
                                  was at most 
                                    
                                       m
                                       -
                                       1
                                    
                                 . Nevertheless, at this point a new block 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  of q’s was created, i.e., the condition in line B6 was violated, implying that one of the rows 
                                    
                                       [
                                       end
                                       (
                                       β
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       ]
                                    
                                  must have been blocked. It follows that in the final pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , one of the rows 
                                    
                                       [
                                       end
                                       (
                                       β
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       ]
                                    
                                  is blocked as well. We conclude that 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is fully natural.□


                           
                              Proof
                              Proof of Lemma 10
                              


                              We first argue that the set 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                       
                                    
                                  in line C10 is never empty, allowing us to choose an element from it. By the definitions in lines C3, C11 and C14–C15, it follows that at the beginning of each iteration of the inner for-loop, for every 
                                    
                                       i
                                       ∈
                                       [
                                       ℓ
                                       ]
                                    
                                  we have that 
                                    
                                       |
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       ⩾
                                       m
                                       -
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , where 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                    
                                  denotes the number blocks from 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  that occupy a slot in row i and that have already been scheduled. As 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                 , the number of blocks of 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  that occupy a slot in row i is bounded by m. Therefore, the set 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                       
                                    
                                  in line C10 is never empty, as desired.

We claim that for every 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       ℓ
                                    
                                 , in the ith iteration of the outer for-loop and at the beginning of each iteration of the inner for-loop, we have that 
                                    
                                       j
                                       ∈
                                       E
                                    
                                  or 
                                    
                                       j
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                       
                                    
                                  implies that 
                                    
                                       σ
                                       (
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       j
                                       )
                                       =
                                       ε
                                    
                                  for all 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       [
                                       i
                                       ,
                                       ℓ
                                       ]
                                    
                                 . We prove the claim by induction over the number of iterations of the inner for-loop. The induction basis is easily settled by considering the initializations in lines C1–C3. For the induction step note that in the ith iteration of the outer for-loop all blocks of 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  with start row i are scheduled (cf. lines C5 and C11–C13). Each such block is scheduled in a column j that is chosen either from the set E or from the set 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             i
                                          
                                       
                                    
                                  (cf. lines C7 and C10, respectively). In the first case j is removed from E, and in both cases j is removed from 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                  for all rows 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  from the start to the end row of the current block (cf. lines C11 and C14–C15). This proves the claim.

By the above claim, before a block 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                  of p’s is scheduled in lines C12–C13, the corresponding entries 
                                    
                                       (
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       j
                                       )
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       ]
                                    
                                 , of the matrix 
                                    
                                       σ
                                    
                                  are empty, so the resulting schedule 
                                    
                                       σ
                                    
                                  is indeed block-preserving with respect to 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 .

As 
                                    
                                       
                                          
                                             ⋃
                                          
                                          
                                             i
                                             ∈
                                             [
                                             ℓ
                                             ]
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       [
                                       n
                                       ]
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  has at least n blocks, and by the assumption 
                                    
                                       m
                                       <
                                       n
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  has more blocks than 
                                    
                                       σ
                                    
                                  has columns. By the definitions in lines C2 and C6–C8, the first m of those blocks of 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  are scheduled in columns 
                                    
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       m
                                       }
                                    
                                 . We conclude that the computed schedule 
                                    
                                       σ
                                    
                                  has no empty columns.□

Our strategy for the proof of Lemma 11 is to compare the number of changeovers in two schedules by comparing the number of blocks of two corresponding pre-schedules. For this we need the following four claims. Claims 12 and 13 provide the translation between a pre-schedule and a schedule, such that the number of changeovers in the schedule is essentially given by the number of blocks of the pre-schedule. Claims 14 and 15 assert that the two conditions of a pre-schedule being fully separated and fully natural imply that the number of its blocks is minimal.
                              Claim 12
                              From pre-schedule to schedule


                              
                                 Let 
                                 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 and m be as in 
                                 
                                    Lemma 11
                                 , and let 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 be a pre-schedule with 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                  
                                 that is fully separated. Then any block-preserving schedule 
                                 
                                    
                                       σ
                                       ∈
                                       Σ
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       ,
                                       m
                                       )
                                    
                                  
                                 without empty columns satisfies 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       -
                                       m
                                    
                                 
                                 .
                              


                                 Let 
                                 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 and m be as in 
                                 
                                    Lemma 11
                                 . For any schedule 
                                 
                                    
                                       σ
                                       ∈
                                       Σ
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       ,
                                       m
                                       )
                                    
                                  
                                 there is a pre-schedule 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                  
                                 such that 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       σ
                                       )
                                       ⩾
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       -
                                       m
                                    
                                 
                                 .
                              


                                 Let 
                                 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 and m be as in 
                                 
                                    Lemma 11
                                 . For any pre-schedule 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                 
                                 , there is pre-schedule 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                  
                                 that is fully separated and fully natural and that satisfies 
                                 
                                    
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       ⩾
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                 
                                 .
                              


                                 Let 
                                 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 and m be as in 
                                 
                                    Lemma 11
                                 . For any two pre-schedules 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                  
                                 and 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                  
                                 that are both fully separated and fully natural, we have 
                                 
                                    
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       =
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                 
                                 .
                              

We fix a pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  and a schedule 
                                    
                                       σ
                                       ∈
                                       Σ
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       ,
                                       m
                                       )
                                    
                                  as in the lemma. The first equality in (6) follows immediately from Claim 12. To prove the second equality in (6) and to thus complete the proof of the lemma, we fix an arbitrary schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       Σ
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       ,
                                       m
                                       )
                                    
                                  and show that
                                    
                                       (7)
                                       
                                          
                                             
                                                N
                                             
                                             
                                                change
                                             
                                          
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ⩾
                                          
                                             
                                                N
                                             
                                             
                                                change
                                             
                                          
                                          (
                                          σ
                                          )
                                          .
                                       
                                    
                                 To do so we apply Claims 13 and 14 to 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  and conclude that there exists a pre-schedule 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  with 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                  that is fully separated and fully natural and that satisfies
                                    
                                       (8)
                                       
                                          
                                             
                                                N
                                             
                                             
                                                change
                                             
                                          
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ⩾
                                          |
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          |
                                          -
                                          m
                                          .
                                       
                                    
                                 Applying Claim 15 to 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 , and combining the first equality in (6) with (8) proves (7), as desired.□

For any 
                                    
                                       i
                                       ∈
                                       [
                                       ℓ
                                       ]
                                    
                                  and 
                                    
                                       p
                                       ∈
                                       
                                       dom
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  consider the block 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       p
                                       )
                                       =
                                       :
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                  and let j be the column of 
                                    
                                       σ
                                    
                                  in which this block is scheduled. If for all indices 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       <
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                  we have 
                                    
                                       σ
                                       (
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       j
                                       )
                                       =
                                       ε
                                    
                                 , then none of the entries 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       j
                                       )
                                       ,
                                       k
                                       ∈
                                       [
                                       c
                                       ]
                                    
                                 , causes a changeover with a preceding entry in column j (we have 
                                    
                                       σ
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       j
                                       )
                                       =
                                       p
                                    
                                  for all those entries). Otherwise consider the largest index 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       <
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                  with 
                                    
                                       σ
                                       (
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       j
                                       )
                                       
                                       ≠
                                       
                                       ε
                                    
                                 , and let 
                                    
                                       q
                                       ≔
                                       σ
                                       (
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       j
                                       )
                                    
                                 . As 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is fully separated, we must have 
                                    
                                       p
                                       
                                       ≠
                                       
                                       q
                                    
                                 , so the entries 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       j
                                       )
                                       ,
                                       k
                                       ∈
                                       [
                                       c
                                       ]
                                    
                                 , cause exactly one changeover with a preceding entry in column j. Summarizing, every block of 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is responsible for exactly one changeover in 
                                    
                                       σ
                                    
                                 , except blocks that are scheduled first in a column of 
                                    
                                       σ
                                    
                                 . As none of the m columns of 
                                    
                                       σ
                                    
                                  is empty we obtain the desired equality.□

We fix a schedule 
                                    
                                       σ
                                       ∈
                                       Σ
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       ,
                                       m
                                       )
                                    
                                  and construct a pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  with the desired properties from it. Intuitively speaking, 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is derived from 
                                    
                                       σ
                                    
                                  by grouping together all consecutive appearances of some 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                  in the same column to one block. Formally, 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       =
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ℓ
                                          
                                       
                                       )
                                    
                                  is obtained from 
                                    
                                       σ
                                    
                                  by considering, for every 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                 , every maximal strictly increasing non-empty sequence of integers 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                  such that for some column j we have 
                                    
                                       σ
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       j
                                       )
                                       =
                                       p
                                    
                                  for all 
                                    
                                       k
                                       ∈
                                       [
                                       c
                                       ]
                                    
                                  and 
                                    
                                       σ
                                       (
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       j
                                       )
                                       =
                                       ε
                                    
                                  for all 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       ]
                                       ⧹
                                       {
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       }
                                    
                                 , and by adding 
                                    
                                       p
                                       
                                       ↦
                                       
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                  to 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 .

By construction we have 
                                    
                                       w
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                 . Furthermore, denoting by d the number of non-empty columns of 
                                    
                                       σ
                                    
                                 , we have 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       -
                                       d
                                       ⩾
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       -
                                       m
                                    
                                 .□

The proof of Claim 14 is split into the following two auxiliary claims. Claims 16 and 17 assert that the number of blocks of a pre-schedule can be reduced if the pre-schedule is not fully separated or not fully natural, respectively. In fact, we shall see in the proofs that the separation and naturalness conditions are defined exactly in such a way, that if one of them is violated, then the number of blocks of the pre-schedule can be reduced by a simple exchange operation. To state these two auxiliary claims we need to introduce some notation.

For any production 
                              
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 )
                                 ,
                                 P
                                 =
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                              
                           , and any pre-schedule 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 ∈
                                 
                                    
                                       Σ
                                    
                                    
                                       ‾
                                    
                                 
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 )
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                              
                           , we define 
                              
                                 s
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                              
                            as the non-decreasing sequence of integers that contains for every 
                              
                                 i
                                 ∈
                                 [
                                 ℓ
                                 ]
                              
                            exactly 
                              
                                 |
                                 dom
                                 (
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 |
                              
                            entries equal to i (this is the number of blocks that start in row i). We define 
                              
                                 S
                                 =
                                 S
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 )
                                 ≔
                                 {
                                 s
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 |
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 ∈
                                 
                                    
                                       Σ
                                    
                                    
                                       ‾
                                    
                                 
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 )
                                 }
                              
                            as the set of all such sequences. Furthermore, we define an ordering 
                              
                                 ≺
                              
                            on the set S as follows: We order the sequences 
                              
                                 s
                                 ∈
                                 S
                              
                            lexicographically from smallest to largest; however, for sequences 
                              
                                 s
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 S
                              
                            where 
                              
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                              
                            is a prefix of s, we define 
                              
                                 s
                                 ≺
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                              
                           .
                              Claim 16
                              Improve not fully separated pre-schedule


                              
                                 Let 
                                 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 and m be as in 
                                 
                                    Lemma 11
                                 . For any pre-schedule 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                  
                                 that is not fully separated, there is a pre-schedule 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⩽
                                       m
                                       ,
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       >
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                  
                                 and 
                                 
                                    
                                       s
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ≺
                                       s
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 .
                              

We fix a pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  as in the claim and construct a pre-schedule 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  with the desired properties from it. As 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is not fully separated, there is a 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                  and two blocks 
                                    
                                       β
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  of p’s that are not separated. We assume without loss of generality that 
                                    
                                       start
                                       (
                                       β
                                       )
                                       <
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 . There are two possible reasons 
                                    
                                       β
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  are not separated: Either 
                                    
                                       end
                                       (
                                       β
                                       )
                                       <
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                  and none of the rows 
                                    
                                       [
                                       end
                                       (
                                       β
                                       )
                                       +
                                       1
                                       ,
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       -
                                       1
                                       ]
                                    
                                  is blocked (case 1); or 
                                    
                                       end
                                       (
                                       β
                                       )
                                       >
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                  (case 2). In both cases we can replace 
                                    
                                       β
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  with a single block of p’s: in case 1 by concatenating and in case 2 by interleaving the corresponding sequences. Denoting by 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  the resulting pre-schedule, we therefore have 
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       =
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       -
                                       1
                                       <
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                    
                                 . Note that the width of 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  in every row is bounded by m: In case 1 only the width of the rows 
                                    
                                       [
                                       end
                                       (
                                       β
                                       )
                                       +
                                       1
                                       ,
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       -
                                       1
                                       ]
                                    
                                  increases by 
                                    
                                       +
                                       1
                                    
                                 , but these are not blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , so their width is at most 
                                    
                                       m
                                       -
                                       1
                                    
                                  in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . In case 2 no row width increases (in fact, some row widths decrease). It follows that 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                 . Note that the sequence 
                                    
                                       s
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                  is obtained from 
                                    
                                       s
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                    
                                  by deleting one entry, implying that 
                                    
                                       s
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ≺
                                       s
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 .□


                                 Let 
                                 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 and m be as in 
                                 
                                    Lemma 11
                                 . For any pre-schedule 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                  
                                 that is not fully natural, there is a pre-schedule 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  
                                 with 
                                 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⩽
                                       m
                                       ,
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       =
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                  
                                 and 
                                 
                                    
                                       s
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ≺
                                       s
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 .
                              

We fix a pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  as in the claim and construct a pre-schedule 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  with the desired properties from it. As 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is not fully natural, there is a 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                 , a block 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                  of p’s, an integer 
                                    
                                       k
                                       ∈
                                       [
                                       c
                                       -
                                       1
                                       ]
                                    
                                  and two blocks 
                                    
                                       β
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  of q’s, 
                                    
                                       p
                                       
                                       ≠
                                       
                                       q
                                    
                                 , with 
                                    
                                       end
                                       (
                                       β
                                       )
                                       <
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                  such that 
                                    
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ∈
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                  and none of the rows 
                                    
                                       [
                                       end
                                       (
                                       β
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ]
                                    
                                  is blocked (the latter interval could e.g.be empty). We replace the blocks 
                                    
                                       β
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  by a single block by concatenating the corresponding sequences. Furthermore, we split the block 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                  into two blocks, 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                             +
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                 . Denoting by 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  the resulting pre-schedule, we therefore have 
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       =
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                    
                                 . By joining the blocks 
                                    
                                       β
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  the width increases by 
                                    
                                       +
                                       1
                                    
                                  in all rows 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             +
                                          
                                       
                                       ≔
                                       [
                                       end
                                       (
                                       β
                                       )
                                       +
                                       1
                                       ,
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       -
                                       1
                                       ]
                                    
                                 . By splitting the block 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                  the width decreases by 
                                    
                                       -
                                       1
                                    
                                  in all rows 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             -
                                          
                                       
                                       ≔
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 . As 
                                    
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ∈
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 , the rows whose width increases effectively is given by 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             +
                                          
                                       
                                       ⧹
                                       
                                          
                                             R
                                          
                                          
                                             -
                                          
                                       
                                       =
                                       [
                                       end
                                       (
                                       β
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ]
                                    
                                 , but these are not blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , so their width is at most 
                                    
                                       m
                                       -
                                       1
                                    
                                  in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . It follows that 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                 . Note that the sequence 
                                    
                                       s
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                  is obtained from 
                                    
                                       s
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                    
                                  by deleting an entry 
                                    
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                  and inserting a strictly larger entry 
                                    
                                       
                                          
                                             i
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                 , implying that 
                                    
                                       s
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       ≺
                                       s
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 .□

We fix a pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  as in Claim 14. If 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is not fully separated or not fully natural, we may repeatedly apply Claim 16 or Claim 17, respectively, and obtain a sequence of pre-schedules 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             i
                                             ⩾
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , with 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                  for all 
                                    
                                       i
                                       ⩾
                                       1
                                       ,
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       |
                                       ⩾
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       |
                                       ⩾
                                       ⋯
                                    
                                 , and 
                                    
                                       s
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ≺
                                       s
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       ≺
                                       ⋯
                                    
                                 . As the set 
                                    
                                       S
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  is finite, this sequence must terminate with a pre-schedule 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  that is fully separated and fully natural and that satisfies 
                                    
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                       ⩾
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                 .□

Before presenting the proof of Claim 15, let us briefly outline the proof strategy. First note that two pre-schedules satisfying the conditions of the claim can be quite different: E.g., for the production 
                              
                                 (
                                 [
                                 n
                                 ]
                                 ,
                                 P
                                 )
                              
                            with 
                              
                                 n
                                 =
                                 2
                              
                            and 
                              
                                 P
                                 =
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 =
                                 (
                                 {
                                 1
                                 }
                                 ,
                                 {
                                 2
                                 }
                                 ,
                                 {
                                 1
                                 }
                                 ,
                                 {
                                 2
                                 }
                                 )
                              
                            on 
                              
                                 m
                                 =
                                 1
                              
                            machine we can either form a single blocks of 1’s and two blocks of 2’s, or a single block of 2’s and two blocks of 1’s (both pre-schedules are fully separated and fully natural). To show that such pre-schedules 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                            must have the same number of blocks, we transform 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                              
                            into 
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                            by a sequence of simple exchange operations, such that the properties of being fully separated, fully natural and the number of blocks are invariant throughout. To ensure that this transformation reaches 
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                            after a finite number of exchange steps (and does not run in loops), we introduce a suitably defined distance function on pre-schedules, and perform only exchange steps that decrease the distance towards 
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                           .
                              Proof
                              Proof of Claim 15
                              


                              For any production 
                                    
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                       ,
                                       P
                                       =
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ℓ
                                          
                                       
                                       )
                                    
                                 , any pre-schedule 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  and any 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                  we define 
                                    
                                       R
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       p
                                       )
                                    
                                  as the set of all integers i for which a block of p’s in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  occupies a slot in row i. For any two pre-schedules 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                 , we define 
                                    
                                       d
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ≔
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             [
                                             n
                                             ]
                                          
                                       
                                       |
                                       R
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       p
                                       )
                                       △
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       p
                                       )
                                       |
                                    
                                 , where 
                                    
                                       △
                                    
                                  denotes the symmetric set difference.

For the reader’s convenience, the notations used in the following are illustrated in Fig. 2
                                 .

Let 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  be as in the claim. As 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is fully separated, for any 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                  the intervals 
                                    
                                       [
                                       start
                                       (
                                       β
                                       )
                                       ,
                                       end
                                       (
                                       β
                                       )
                                       ]
                                    
                                  for all blocks 
                                    
                                       β
                                    
                                  of p’s in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  are pairwise disjoint. An analogous statement holds for 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 .

If 
                                    
                                       R
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       p
                                       )
                                       =
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       p
                                       )
                                    
                                  holds for all 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                 , then by the previously mentioned disjoint-interval property we have 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  and the claim is trivially true. Otherwise, we fix some 
                                    
                                       p
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                  such that the smallest integer in 
                                    
                                       R
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       p
                                       )
                                       △
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       p
                                       )
                                    
                                  is minimal. Let 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  be this minimal row index. We assume w.l.o.g.that 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                       ∈
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       p
                                       )
                                       ⧹
                                       R
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       p
                                       )
                                    
                                 . It follows that 
                                    
                                       p
                                       ∉
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                    
                                 . Furthermore, in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  there is a block 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  of p’s that occupies a slot in row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . Let 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       <
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                       >
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  denote the entries in 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  that are closest to 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , i.e., we have 
                                    
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                       
                                       ,
                                       p
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       p
                                       ∉
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                  for 
                                    
                                       i
                                       ∈
                                       [
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 . Let 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  the blocks of p’s in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  that end or start in row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  or row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                 , respectively, i.e., we have 
                                    
                                       end
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                 . By the choice of 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  we also have
                                    
                                       (9)
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ˇ
                                             
                                          
                                          +
                                          1
                                          =
                                          
                                             
                                                ı
                                             
                                             
                                                ¯
                                             
                                          
                                          .
                                       
                                    
                                 As 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is fully separated, there must be a blocked row in 
                                    
                                       [
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 . Let 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  be the smallest 
                                    
                                       i
                                       ∈
                                       [
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                  such that row i is blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 .

Define Q and 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  as the set of those 
                                    
                                       q
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                  that satisfy 
                                    
                                       q
                                       ∉
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                       
                                    
                                  and that occupy a slot in row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  or 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 , respectively. By the choice of 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  and the above-mentioned disjoint-interval property for 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  we have 
                                    
                                       p
                                       ∉
                                       Q
                                    
                                 . Furthermore, we clearly have 
                                    
                                       p
                                       ∈
                                       
                                          
                                             Q
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       |
                                       Q
                                       |
                                       =
                                       m
                                       -
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                       
                                       |
                                    
                                  and 
                                    
                                       |
                                       
                                          
                                             Q
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       ⩽
                                       m
                                       -
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                       
                                       |
                                    
                                 . It follows that there is some 
                                    
                                       q
                                       ∈
                                       Q
                                    
                                  with 
                                    
                                       q
                                       ∉
                                       
                                          
                                             Q
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 . We fix a 
                                    
                                       q
                                       ∈
                                       [
                                       n
                                       ]
                                    
                                  with this property (q is clearly different from p).

Let 
                                    
                                       γ
                                    
                                  be the block of q’s in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  that occupies a slot in row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                 . Let 
                                    
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       <
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       >
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  denote the entries in 
                                    
                                       γ
                                    
                                  that are closest to 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                 , i.e., we have 
                                    
                                       q
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ı
                                                      
                                                      
                                                         ˇ
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       ,
                                       q
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ı
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       q
                                       ∉
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                    
                                  for 
                                    
                                       i
                                       ∈
                                       [
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 . Let 
                                    
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  be the blocks of q’s in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  that end or start in row 
                                    
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  or row 
                                    
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 , respectively, i.e., we have 
                                    
                                       end
                                       (
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  and 
                                    
                                       start
                                       (
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 .

By definition we have
                                    
                                       (10)
                                       
                                          
                                             
                                                
                                                   
                                                      ı
                                                   
                                                   
                                                      ˇ
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          <
                                          
                                             
                                                ı
                                             
                                             
                                                ̃
                                             
                                          
                                          .
                                       
                                    
                                 As 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  is fully natural we have 
                                    
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       ⩾
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  or at least one row from 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . In particular, 
                                    
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                       <
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  would imply that at least one row from 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ]
                                    
                                  is blocked. By the choice of 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  and by (10) however, we know that none of those rows is blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . It follows that
                                    
                                       (11)
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ˆ
                                             
                                          
                                          ⩾
                                          
                                             
                                                
                                                   
                                                      ı
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          .
                                       
                                    
                                 As 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  is fully natural we have 
                                    
                                       start
                                       (
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⩾
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  or at least one row from 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 . In particular, 
                                    
                                       end
                                       (
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ⩾
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  would imply that 
                                    
                                       start
                                       (
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ⩾
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                 . Observe also that as 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                  is a subset of 
                                    
                                       R
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       q
                                       )
                                    
                                 , but not of 
                                    
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       q
                                       )
                                    
                                 , the choice of 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  (and p) at the beginning of the proof implies that 
                                    
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       1
                                       ⩾
                                       
                                          
                                             ı
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , which together with (9) implies that
                                    
                                       (12)
                                       
                                          
                                             
                                                
                                                   
                                                      ı
                                                   
                                                   
                                                      ˇ
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          ⩾
                                          
                                             
                                                ı
                                             
                                             
                                                ˇ
                                             
                                          
                                          .
                                       
                                    
                                 Combining these two observations yields
                                    
                                       (13)
                                       
                                          
                                             
                                                
                                                   
                                                      ı
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          ⩾
                                          
                                             
                                                ı
                                             
                                             
                                                ˆ
                                             
                                          
                                          .
                                       
                                    
                                 Altogether we obtain
                                    
                                       (14)
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ˇ
                                             
                                          
                                          
                                             
                                                ⩽
                                             
                                             
                                                (
                                                12
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ı
                                                   
                                                   
                                                      ˇ
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                <
                                             
                                             
                                                (
                                                10
                                                )
                                             
                                          
                                          
                                             
                                                ı
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                    
                                 and
                                    
                                       (15)
                                       
                                          
                                             
                                                
                                                   
                                                      ı
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                (
                                                11
                                                )
                                                ,
                                                (
                                                13
                                                )
                                             
                                          
                                          
                                             
                                                ı
                                             
                                             
                                                ˆ
                                             
                                          
                                          .
                                       
                                    
                                 In 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , we replace the blocks 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  by a single block 
                                    
                                       β
                                    
                                  by concatenating the corresponding sequences. Furthermore, we split the block 
                                    
                                       γ
                                    
                                  into two blocks 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  with 
                                    
                                       end
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  and 
                                    
                                       start
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 . Denoting the resulting pre-schedule by 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 , we therefore have 
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       |
                                       =
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                    
                                 .

By joining the blocks 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  the width increases by 
                                    
                                       +
                                       1
                                    
                                  in all rows 
                                    
                                       [
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 . By splitting the block 
                                    
                                       γ
                                    
                                  the width decreases by 
                                    
                                       -
                                       1
                                    
                                  in all rows 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 . Using (14), (15) and the fact that none of the rows 
                                    
                                       [
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  (recall the definition of 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                 ), it follows that 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                 .

Note that row 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 , and that it is separating for the two blocks 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  of q’s. Together with the above observation that between 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  the width of every row is non-decreasing, it follows that 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  is fully separated.

We now argue that 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  is fully natural. Suppose for the sake of contradiction that 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  is not fully natural. There are two possible reasons for that: There is an 
                                    
                                       r
                                       ∈
                                       [
                                       n
                                       ]
                                       ,
                                       r
                                       
                                       ≠
                                       
                                       q
                                    
                                 , a block 
                                    
                                       λ
                                       =
                                       :
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       )
                                    
                                  or r’s and an index 
                                    
                                       k
                                       ∈
                                       [
                                       c
                                       -
                                       1
                                       ]
                                    
                                  such that 
                                    
                                       start
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       ∈
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                  and none of the rows 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  (case 1), or there is an 
                                    
                                       r
                                       ∈
                                       [
                                       n
                                       ]
                                       ,
                                       r
                                       
                                       ≠
                                       
                                       p
                                    
                                 , and two blocks 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  of r’s such that 
                                    
                                       start
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       ∈
                                       [
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                  and none of the rows 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  (case 2).

In case 1, 
                                    
                                       λ
                                    
                                  occupies a slot in row 
                                    
                                       start
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       =
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                  in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  and also in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  (recall (15)), so by the above-mentioned disjoint-interval property in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , we must have 
                                    
                                       r
                                       
                                       ≠
                                       
                                       p
                                    
                                 . We know that none of the rows 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 , and as the width in those rows is the same in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , none of those rows is blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  either. Furthermore, none of the rows 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       end
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  (recall (14) and the definition of 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                 ). We obtain that none of the rows 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . Using that 
                                    
                                       start
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       =
                                       start
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       ∈
                                       [
                                       
                                          
                                             i
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 , it follows that in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  the two blocks 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  cause 
                                    
                                       λ
                                    
                                  to violate the condition for being natural, which is a contradiction.

In case 2, as 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  must be separated in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  and also in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , and none of the rows 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  or in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , the choice of 
                                    
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  implies that 
                                    
                                       start
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       >
                                       
                                          
                                             ı
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                 , which together with (10) shows that 
                                    
                                       start
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       >
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 . Using (15) we thus have
                                    
                                       (16)
                                       
                                          start
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                ˆ
                                             
                                          
                                          )
                                          ∈
                                          [
                                          
                                             
                                                
                                                   
                                                      ı
                                                   
                                                   
                                                      ˇ
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          1
                                          ,
                                          
                                             
                                                
                                                   
                                                      ı
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          -
                                          1
                                          ]
                                          .
                                       
                                    
                                 It follows that 
                                    
                                       γ
                                    
                                  occupies a slot in row 
                                    
                                       start
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                  in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , so by the above-mentioned disjoint-interval property in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , we must have 
                                    
                                       r
                                       
                                       ≠
                                       
                                       q
                                    
                                 . Again, none of the rows 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       =
                                       end
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  or in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , and none of the rows 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             β
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       end
                                       (
                                       
                                          
                                             γ
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 , so none of the rows 
                                    
                                       [
                                       end
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             ˇ
                                          
                                       
                                       )
                                       +
                                       1
                                       ,
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ]
                                    
                                  is blocked in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . This together with (16) shows that in 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                  the two blocks 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˇ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                  cause 
                                    
                                       γ
                                    
                                  to violate the condition for being natural, again a contradiction.

We conclude that 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  is fully natural.

Summarizing, we have shown that 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             ‾
                                          
                                       
                                       (
                                       [
                                       n
                                       ]
                                       ,
                                       P
                                       )
                                    
                                  satisfies 
                                    
                                       w
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                       ⩽
                                       m
                                    
                                 , that 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  is fully separated, fully natural, and that 
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       |
                                       =
                                       |
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       |
                                    
                                 . By repeating the above construction we thus obtain a sequence of pre-schedules that all have width at most m, that are fully separated and fully natural and that all have the same number of blocks. To complete the proof it remains to argue that this sequence must terminate with the pre-schedule 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 .

To see this observe that 
                                    
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       p
                                       )
                                       △
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       p
                                       )
                                    
                                  is a proper subset of 
                                    
                                       R
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       p
                                       )
                                       △
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       p
                                       )
                                    
                                  and that the set difference is given by 
                                    
                                       [
                                       
                                          
                                             ı
                                          
                                          
                                             ˇ
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             ı
                                          
                                          
                                             ˆ
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 . Similarly, 
                                    
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       q
                                       )
                                       △
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       q
                                       )
                                    
                                  is a proper subset of 
                                    
                                       R
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       q
                                       )
                                       △
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       q
                                       )
                                    
                                  and the set difference is given by 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˇ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       1
                                       ,
                                       
                                          
                                             
                                                
                                                   ı
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       -
                                       1
                                       ]
                                    
                                 . As for all 
                                    
                                       r
                                       ∈
                                       [
                                       n
                                       ]
                                       ⧹
                                       {
                                       p
                                       ,
                                       q
                                       }
                                    
                                  the sets 
                                    
                                       R
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       r
                                       )
                                       △
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       r
                                       )
                                    
                                  and 
                                    
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       r
                                       )
                                       △
                                       R
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       r
                                       )
                                    
                                  are the same, we conclude that 
                                    
                                       d
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       <
                                       d
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 . This distance-decreasing property of the above construction is the desired termination criterion.

This completes the proof of Claim 15.□

We first consider the function PreSchedule(). Blocks of the pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         can be implemented as vectors (we only need creation of a vector and adding an element to the end of it, cf. lines B7 and B10–B11). Each 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                        , can be implemented as a set of those vectors, and the pre-schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         as a vector 
                           
                              (
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                         of those sets. All operations involving 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         and the variables 
                           
                              new
                              (
                              p
                              )
                              ,
                              start
                              (
                              p
                              )
                              ,
                              end
                              (
                              p
                              )
                              ,
                              p
                              ∈
                              [
                              n
                              ]
                           
                        , can therefore be accounted to an element in one of the sets 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                        , i.e., these operations take time 
                           
                              O
                              (
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    [
                                    ℓ
                                    ]
                                 
                              
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                              )
                              =
                              O
                              (
                              ℓ
                              ·
                              m
                              )
                           
                         (recall the assumption 
                           
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                              ⩽
                              m
                           
                        ). Observe that we do not actually need to compute the entire set of blocked rows of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         in each iteration (cf. line B5). All we need to know is whether there is a blocked row, and, if so, what the maximum blocked row is (cf. the condition in line B6). We may maintain this information by introducing counters 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                        , that keep track of the width of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ¯
                                 
                              
                           
                         in every row. Initially, we set 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              ≔
                              0
                              ,
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                        . If in the ith iteration of the outer for-loop the condition in line B6 is satisfied, we set 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              ≔
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                           
                        , otherwise we set 
                           
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          ı
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              ≔
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          ı
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              +
                              1
                           
                         for all 
                           
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              [
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              +
                              1
                              ,
                              i
                              ]
                           
                         for 
                           
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                           
                         as defined in line B10. The maximum blocked row is given by the last of the modified counter(s) which has reached the value m. If none of the counters has reached the value m, there is no blocked row. As we have 
                           
                              ℓ
                           
                         non-decreasing counters, each of which takes values from 
                           
                              [
                              0
                              ,
                              m
                              ]
                           
                        , those operations take time 
                           
                              O
                              (
                              ℓ
                              ·
                              m
                              )
                           
                         in total.

Now consider the function Schedule(). Observe that each of the operations involving the schedule 
                           
                              σ
                           
                         and the sets E and 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                        , can be accounted to one of the entries of the matrix 
                           
                              σ
                           
                        : In particular, the update operations on the sets 
                           
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ı
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              [
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              ]
                           
                        , in lines C14–C15 can be accounted to the matrix entries 
                           
                              (
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              j
                              )
                              ,
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              ∈
                              [
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    c
                                 
                              
                              ]
                           
                        , some of which have been set to p in lines C12–C13 before (as 
                           
                              σ
                           
                         is block-preserving, those entries representing one block of p’s are not considered again in the course of the algorithm). As 
                           
                              σ
                           
                         has 
                           
                              ℓ
                           
                         rows and m columns, it follows that the function takes time 
                           
                              O
                              (
                              ℓ
                              ·
                              m
                              )
                           
                        .

Summarizing, the runtime of both phases of the algorithm BuildBlocks() is bounded by 
                           
                              O
                              (
                              ℓ
                              ·
                              m
                              )
                           
                        , so this time bound also holds for the entire algorithm.

Algorithms having the properties claimed in Theorems 5 and 6 can by obtained by extending the algorithm BuildBlocks() described in Section 2.1. The extension consists of an additional pre- and post-processing phase around the algorithm BuildBlocks() as shown in Algorithm 4 below. The pre-processing functions PreProcess
                        crit() and PreProcess
                        stop() differ for the two primary optimization goals (minimizing critical changeovers or stops, respectively). The post-processing function PostProcess() is the same in both cases. We denote the resulting algorithms by BuildBlocks
                        crit() and BuildBlocks
                        stop(), respectively. During pre-processing, the given production is extended by adding certain parts to some of the products. Those auxiliary parts serve as placeholders during the operation of the original algorithm BuildBlocks() and ensure that certain solution properties arising from the additional primary optimization goals will be satisfied ‘along the way’ during the operation of BuildBlocks(). In the post-processing phase, all occurrences of those placeholder parts are removed from the resulting schedule again.
                           Algorithm 4
                           BuildBlocks
                              ∗([n],
                              P,
                              m), 
                                 
                                    ∗
                                    ∈
                                    {
                                    crit,stop
                                    }
                                 
                               
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: a production 
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      )
                                                      ,
                                                      P
                                                      =
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      )
                                                   
                                                , an integer m with 
                                                   
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            i
                                                            ∈
                                                            [
                                                            ℓ
                                                            ]
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      |
                                                      ⩽
                                                      m
                                                      <
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Output: the number 
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            ∗
                                                            ,change
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                 and a schedule 
                                                   
                                                      σ
                                                      ∈
                                                      Σ
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      ,
                                                      m
                                                      )
                                                   
                                                 with 
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      (
                                                      σ
                                                      )
                                                      =
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            ∗
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                 and
                                          
                                          
                                             
                                                 
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            change
                                                         
                                                      
                                                      (
                                                      σ
                                                      )
                                                      =
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            ∗
                                                            ,change
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ≔PreProcess
                                                ∗
                                                
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      ,
                                                      m
                                                      )
                                                   
                                                 
                                                 /∗ compute auxiliary production 
                                                
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                 ∗/
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      N
                                                      ,
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ≔BuildBlocks
                                                
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      m
                                                      )
                                                   
                                                 
                                                 /∗ minimize changeovers for 
                                                
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                 ∗/
                                          
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                
                                                ≔PostProcess
                                                
                                                   
                                                      (
                                                      P
                                                      ,
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                 
                                                 /∗ recover schedule for production 
                                                
                                                   
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      )
                                                   
                                                 ∗/
                                          
                                          
                                             
                                                return 
                                                
                                                   
                                                      (
                                                      N
                                                      ,
                                                      σ
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

We now define the pre- and post-processing functions PreProcess
                        crit(), PreProcess
                        stop() and PostProcess().

The function PreProcess
                        ∗(), 
                           
                              ∗
                              ∈
                              {
                              crit,stop
                              }
                           
                        , computes, for a given production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                              ,
                              P
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                        , and integer m, an auxiliary production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              )
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        , as follows (both productions have n parts and 
                           
                              ℓ
                           
                         products): We set 
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ≔
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                           
                         and for any 
                           
                              i
                              ∈
                              [
                              2
                              ,
                              ℓ
                              ]
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 ≔
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∪
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∪
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                   ⧹
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   if
                                                   
                                                   |
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                   ∪
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   ⩽
                                                   m
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∪
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         ∗
                                                         ,
                                                         i
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   |
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                         -
                                                         1
                                                      
                                                   
                                                   ∪
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   >
                                                   m
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    Q
                                 
                                 
                                    stop,
                                    i
                                 
                              
                              ≔
                              ∅
                           
                         and where 
                           
                              
                                 
                                    Q
                                 
                                 
                                    crit,
                                    i
                                 
                              
                           
                         is defined as follows: For any 
                           
                              p
                              ∈
                              [
                              n
                              ]
                           
                         and any 
                           
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                         we define 
                           
                              next
                              (
                              p
                              ,
                              i
                              )
                              ≔
                              min
                              {
                              
                                 
                                    ı
                                 
                                 
                                    ¯
                                 
                              
                              >
                              i
                              
                              |
                              
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          ı
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              }
                           
                         (
                           
                              next
                              (
                              p
                              ,
                              i
                              )
                           
                         is the row of the next appearance of p in the production after row i). The set 
                           
                              
                                 
                                    Q
                                 
                                 
                                    crit,
                                    i
                                 
                              
                           
                         consists of those
                           
                              (18)
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 ≔
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       -
                                       1
                                    
                                 
                                 ⧹
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 -
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       
                                          (2a)
                                       
                                    
                                 
                                 m
                                 -
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 |
                              
                           
                        elements 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                    -
                                    1
                                 
                              
                              ⧹
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         for which 
                           
                              next
                              (
                              p
                              ,
                              i
                              )
                           
                         is minimal (ties between elements 
                           
                              p
                              ,
                              q
                           
                         with 
                           
                              next
                              (
                              p
                              ,
                              i
                              )
                              =
                              next
                              (
                              q
                              ,
                              i
                              )
                           
                         are broken arbitrarily). (E.g., if 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                    -
                                    1
                                 
                              
                              ⧹
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              =
                              {
                              1
                              ,
                              2
                              ,
                              3
                              }
                              ,
                              next
                              (
                              1
                              ,
                              i
                              )
                              =
                              11
                              ,
                              next
                              (
                              2
                              ,
                              i
                              )
                              =
                              14
                              ,
                              next
                              (
                              3
                              ,
                              i
                              )
                              =
                              13
                           
                         and 
                           
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              =
                              2
                           
                        , then 
                           
                              
                                 
                                    Q
                                 
                                 
                                    crit,
                                    i
                                 
                              
                              =
                              {
                              1
                              ,
                              3
                              }
                           
                        ). The resulting set 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         in this case has cardinality
                           
                              
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 =
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 +
                                 |
                                 
                                    
                                       Q
                                    
                                    
                                       crit,
                                       i
                                    
                                 
                                 |
                                 =
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       =
                                    
                                    
                                       (
                                       18
                                       )
                                    
                                 
                                 m
                                 .
                              
                           
                        The function PostProcess() computes a schedule 
                           
                              σ
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         from a given schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              ,
                              m
                              )
                           
                         by replacing, for every 
                           
                              i
                              ∈
                              [
                              ℓ
                              ]
                           
                        , in row i of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                           
                         every value 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ⧹
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         by 
                           
                              ε
                           
                        .

As a sanity check, we can verify already at this point that the numbers returned by BuildBlocks
                        crit([n],
                        P,
                        m) and BuildBlocks
                        stop([n],
                        P,
                        m) (which are computed by BuildBlocks() for each of the two different auxiliary productions) will satisfy (5). This follows from the fact that the products defined in (17) for 
                           
                              ∗
                              =
                              crit
                           
                         are supersets of the products defined for 
                           
                              ∗
                              =
                              stop
                           
                        . In other words, when minimizing critical changeovers, more auxiliary placeholder parts are added to the original production than when minimizing stops (which makes the work for BuildBlocks() harder).

As the definition of 
                           
                              
                                 
                                    Q
                                 
                                 
                                    crit,
                                    i
                                 
                              
                           
                         is somewhat more technical than the definition of 
                           
                              
                                 
                                    Q
                                 
                                 
                                    stop,
                                    i
                                 
                              
                           
                        , proving Theorem 5 is slightly more involved than proving Theorem 6. We therefore start by proving Theorem 6, and then proceed to prove Theorem 5. As the correctness proof for the algorithm BuildBlocks
                        crit() is very much analogous to the correctness proof for the algorithm BuildBlocks
                        stop(), but somewhat technical and lengthy, it is deferred to Appendix A.

In the following proof we deduce the correctness of the algorithm BuildBlocks
                        stop() from the already shown correctness of BuildBlocks(). More specifically, we show how the addition of auxiliary parts to the production in the pre-processing phase ensures that the schedule computed by BuildBlocks() ‘automatically’ only has as many stops as are unavoidable (even though BuildBlocks() in itself neglects stops entirely). To compare the number of changeovers in an arbitrary schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ̃
                                 
                              
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         (with minimal number of stops) with the number of changeovers in 
                           
                              σ
                           
                         as returned by BuildBlocks
                        stop(), we construct an auxiliary schedule 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              ,
                              m
                              )
                           
                         with the same number of changeovers from 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ̃
                                 
                              
                           
                         and compare 
                           
                              
                                 
                                    N
                                 
                                 
                                    change
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         with 
                           
                              
                                 
                                    N
                                 
                                 
                                    change
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         for 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                           
                         as returned by BuildBlocks().
                           Proof
                           Correctness of the algorithm BuildBlocks
                              stop()


                           We first argue that the schedule 
                                 
                                    σ
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                               computed by the algorithm BuildBlocks
                              stop() satisfies 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          stop
                                       
                                    
                                    (
                                    σ
                                    )
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          stop
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                              . For any 
                                 
                                    i
                                    ∈
                                    [
                                    2
                                    ,
                                    ℓ
                                    ]
                                 
                               consider the rows 
                                 
                                    i
                                    -
                                    1
                                 
                               and i of 
                                 
                                    σ
                                 
                              . If 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    >
                                    m
                                 
                              , then the index i will clearly contribute 
                                 
                                    +
                                    1
                                 
                               to the number of stops in 
                                 
                                    σ
                                 
                              . We will show that if on the other hand 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    ⩽
                                    m
                                 
                              , then no stop occurs between rows 
                                 
                                    i
                                    -
                                    1
                                 
                               and i of 
                                 
                                    σ
                                 
                              . The claim then follows from (3). We fix an index 
                                 
                                    i
                                    ∈
                                    [
                                    2
                                    ,
                                    ℓ
                                    ]
                                 
                               with 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    ⩽
                                    m
                                 
                              . Now fix an element 
                                 
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                              . By the definition of the auxiliary production 
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               computed by the function PreProcess
                              stop(), we have 
                                 
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                               and 
                                 
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . By the definition of the algorithm BuildBlocks(), the indices 
                                 
                                    i
                                    -
                                    1
                                 
                               and i belong to the same block of p’s in the pre-schedule 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ≔PreSchedule
                              
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    m
                                    )
                                 
                               (note here that when 
                                 
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                               is added to the pre-schedule in iteration i of the outer for-loop of the function PreSchedule(), the condition in line B6 must be false as we have 
                                 
                                    end
                                    (
                                    p
                                    )
                                    =
                                    i
                                    -
                                    1
                                 
                              ). Therefore, in rows 
                                 
                                    i
                                    -
                                    1
                                 
                               and i of the schedule 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    m
                                    )
                                 
                               computed by the function Schedule
                              
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    m
                                    ,
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               and returned by the algorithm BuildBlocks(), the two values p appear in the same column j, i.e., we have 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    i
                                    -
                                    1
                                    ,
                                    j
                                    )
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    p
                                 
                              . By the definition of the function PostProcess(), we have 
                                 
                                    σ
                                    (
                                    i
                                    -
                                    1
                                    ,
                                    j
                                    )
                                    =
                                    σ
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    p
                                 
                               if 
                                 
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                              , and 
                                 
                                    σ
                                    (
                                    i
                                    -
                                    1
                                    ,
                                    j
                                    )
                                    =
                                    p
                                 
                               and 
                                 
                                    σ
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    ε
                                 
                               if 
                                 
                                    p
                                    ∉
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                              . It follows that no stop occurs between rows 
                                 
                                    i
                                    -
                                    1
                                 
                               and i of 
                                 
                                    σ
                                 
                              , proving that 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          stop
                                       
                                    
                                    (
                                    σ
                                    )
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          stop
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                              .

It remains to argue that the integer N and schedule 
                                 
                                    σ
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                               computed by the algorithm BuildBlocks
                              stop() satisfy 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          change
                                       
                                    
                                    (
                                    σ
                                    )
                                    =
                                    N
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          stop,change
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                              . To do so we fix an arbitrary schedule 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                               with 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          stop
                                       
                                    
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          stop
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                               and show that
                                 
                                    (19)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                       ⩾
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       N
                                       .
                                    
                                 
                              Clearly, every index 
                                 
                                    i
                                    ∈
                                    [
                                    2
                                    ,
                                    ℓ
                                    ]
                                 
                               with 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    >
                                    m
                                 
                               contributes 
                                 
                                    +
                                    1
                                 
                               to the number of stops in 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                              . By the assumption 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          stop
                                       
                                    
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          stop
                                       
                                       
                                          min
                                       
                                    
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                               and by (3), we have that for every index 
                                 
                                    i
                                    ∈
                                    [
                                    2
                                    ,
                                    ℓ
                                    ]
                                 
                               with 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    ⩽
                                    m
                                 
                               there is no stop between rows 
                                 
                                    i
                                    -
                                    1
                                 
                               and i of 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                              , i.e., for every 
                                 
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ⧹
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                               we have that 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                    (
                                    i
                                    -
                                    1
                                    ,
                                    j
                                    )
                                    =
                                    p
                                 
                               implies that 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    ε
                                 
                              . We may thus define a schedule 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                 
                               by inheriting the values of all non-empty entries of 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                               and by setting 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ≔
                                    p
                                 
                               for all the previously mentioned entries (where 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                    (
                                    i
                                    -
                                    1
                                    ,
                                    j
                                    )
                                    =
                                    p
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    ε
                                 
                              ). By the definition in (17) we have 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    m
                                    )
                                 
                              . Furthermore, it is easy to see that
                                 
                                    (20)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       .
                                    
                                 
                              Let 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    m
                                    )
                                 
                               be the schedule returned by the algorithm BuildBlocks
                              
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    m
                                    )
                                 
                              . As the only difference between 
                                 
                                    σ
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                               are entries 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                               that satisfy 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    p
                                    ∈
                                    [
                                    n
                                    ]
                                 
                              , 
                                 
                                    σ
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    ε
                                 
                               and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    i
                                    -
                                    1
                                    ,
                                    j
                                    )
                                    =
                                    σ
                                    (
                                    i
                                    -
                                    1
                                    ,
                                    j
                                    )
                                    =
                                    p
                                 
                              , we clearly have
                                 
                                    (21)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       σ
                                       )
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       .
                                    
                                 
                              Both 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                 
                               are schedules for the production 
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               and m machines. As N and 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                               were computed by the algorithm BuildBlocks(), we have
                                 
                                    (22)
                                    
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       ⩾
                                       
                                          
                                             N
                                          
                                          
                                             change
                                          
                                       
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       =
                                       N
                                       .
                                    
                                 
                              Combining (20)–(22) proves (19), as desired.□

As the running time of the algorithm BuildBlocks() is bounded by 
                                 
                                    O
                                    (
                                    ℓ
                                    ·
                                    m
                                    )
                                 
                               (cf. Theorem 4), we only need to show that the running time of the functions PreProcess
                              stop() and PostProcess() in Algorithm 4 is bounded by 
                                 
                                    O
                                    (
                                    ℓ
                                    ·
                                    m
                                    )
                                 
                              .

Each of the operations to compute the set unions in the definition (17) (recall that 
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          stop,
                                          i
                                       
                                    
                                    =
                                    ∅
                                 
                              ) can be accounted to an element in one of the sets 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                              . The running time of the function PreProcess
                              stop() is therefore bounded by 
                                 
                                    O
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          [
                                          ℓ
                                          ]
                                       
                                    
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    )
                                    =
                                    O
                                    (
                                    ℓ
                                    ·
                                    m
                                    )
                                 
                               (recall the assumption 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    ⩽
                                    m
                                 
                              ).

Each of the operations to compute 
                                 
                                    σ
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    ,
                                    m
                                    )
                                 
                               from the schedule 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                    ∈
                                    Σ
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    m
                                    )
                                 
                               can be accounted to one of the entries of the 
                                 
                                    ℓ
                                    ×
                                    m
                                 
                               matrix 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . The running time of the function PostProcess() is therefore bounded by 
                                 
                                    O
                                    (
                                    ℓ
                                    ·
                                    m
                                    )
                                 
                               as well. This completes the proof.□

The proof for the correctness of the algorithm BuildBlocks
                        crit() is very much analogous to the correctness proof for the algorithm BuildBlocks
                        stop() and reduces the problem to the correctness of BuildBlocks() (recall the remarks at the beginning of the previous section). The only technical obstacle is the construction of an auxiliary schedule 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              ,
                              m
                              )
                           
                         from a given, arbitrary schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ̃
                                 
                              
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         (with minimal number of critical changeovers) such that 
                           
                              
                                 
                                    N
                                 
                                 
                                    change
                                 
                              
                              (
                              
                                 
                                    σ
                                 
                                 
                                    ̃
                                 
                              
                              )
                              ⩾
                              
                                 
                                    N
                                 
                                 
                                    change
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         (which is needed for the reduction). Unlike in the previous proof, the construction of 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                           
                         from 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ̃
                                 
                              
                           
                         here proceeds stepwise by elementary column exchange operations, and involves some case distinctions as to which columns have to be exchanged (we also need to argue that these exchange operations never increase the number of changeovers). These technicalities make the proof somewhat lengthy, and we defer it to Appendix A.
                           Proof
                           Time bound for the algorithm BuildBlocks
                              crit()


                           As argued in the second proof in the previous section, the time required to compute BuildBlocks() and PostProcess() is bounded by 
                                 
                                    O
                                    (
                                    ℓ
                                    ·
                                    m
                                    )
                                 
                              . To prove the claimed runtime bound, we will show that PreProcess
                              crit() can also be computed in time 
                                 
                                    O
                                    (
                                    ℓ
                                    ·
                                    m
                                    )
                                 
                              . We can compute the sets 
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          crit,
                                          i
                                       
                                    
                                 
                               defined after (17) as follows: Initially we compute, for each 
                                 
                                    p
                                    ∈
                                    [
                                    n
                                    ]
                                 
                              , a sorted sequence 
                                 
                                    s
                                    (
                                    p
                                    )
                                 
                               consisting of all indices 
                                 
                                    i
                                    ∈
                                    [
                                    ℓ
                                    ]
                                 
                               with 
                                 
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                               (this takes time 
                                 
                                    O
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          [
                                          ℓ
                                          ]
                                       
                                    
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    )
                                    ⩽
                                    O
                                    (
                                    ℓ
                                    ·
                                    m
                                    )
                                 
                               in total). We then iterate over all 
                                 
                                    i
                                    ∈
                                    [
                                    ℓ
                                    ]
                                 
                               and maintain indices 
                                 
                                    ν
                                    (
                                    p
                                    )
                                    ,
                                    p
                                    ∈
                                    [
                                    n
                                    ]
                                 
                              , into the sequences 
                                 
                                    s
                                    (
                                    p
                                    )
                                 
                               such that 
                                 
                                    s
                                    
                                       
                                          (
                                          p
                                          )
                                       
                                       
                                          ν
                                          (
                                          p
                                          )
                                       
                                    
                                    =
                                    next
                                    (
                                    p
                                    ,
                                    i
                                    )
                                 
                              . To compute 
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          crit,
                                          i
                                       
                                    
                                 
                               for some 
                                 
                                    i
                                    ∈
                                    [
                                    2
                                    ,
                                    ℓ
                                    ]
                                 
                               with 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ∪
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    >
                                    m
                                 
                               we select from the sequence 
                                 
                                    s
                                    
                                       
                                          (
                                          p
                                          )
                                       
                                       
                                          ν
                                          (
                                          p
                                          )
                                       
                                    
                                    ,
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ⧹
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                              , exactly 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                 
                               smallest elements, using a linear-time selection algorithm. As 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    ⧹
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    ⩽
                                    m
                                 
                              , the selection step takes time 
                                 
                                    O
                                    (
                                    m
                                    )
                                 
                              , and 
                                 
                                    O
                                    (
                                    ℓ
                                    ·
                                    m
                                    )
                                 
                               in total. The total number of update operations for the indices 
                                 
                                    ν
                                    (
                                    p
                                    )
                                    ,
                                    p
                                    ∈
                                    [
                                    n
                                    ]
                                 
                              , is bounded by 
                                 
                                    O
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          [
                                          n
                                          ]
                                       
                                    
                                    |
                                    s
                                    (
                                    p
                                    )
                                    |
                                    )
                                    =
                                    O
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          [
                                          ℓ
                                          ]
                                       
                                    
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    )
                                    ⩽
                                    O
                                    (
                                    ℓ
                                    ·
                                    m
                                    )
                                 
                               (here, 
                                 
                                    |
                                    s
                                    (
                                    p
                                    )
                                    |
                                 
                               denotes the length of the sequence 
                                 
                                    s
                                    (
                                    p
                                    )
                                 
                              ). This completes the proof.□

We define a multiset production as a pair 
                        
                           (
                           [
                           n
                           ]
                           ,
                           P
                           )
                        
                     , where n is an integer and 
                        
                           P
                           =
                           (
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 P
                              
                              
                                 ℓ
                              
                           
                           )
                        
                      is a sequence of non-empty multisets of elements from 
                        
                           [
                           n
                           ]
                        
                     , such that 
                        
                           
                              
                                 ⋃
                              
                              
                                 i
                                 ∈
                                 [
                                 ℓ
                                 ]
                              
                           
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           =
                           [
                           n
                           ]
                        
                     . All other notions (schedules, etc.) introduced in Section 1.1 generalize in a straightforward way to this multiset scenario. In particular, the definitions of changeovers, critical changeovers and stops and the definitions of the objective functions in (1) and (4) remain unchanged.
                        2
                        Even though we are not concerned with it here, we remark that the definition of moves should probably be generalized in a suitable way for multiset productions. With the original definition, e.g. the ‘ideal’ schedule 
                              
                                 σ
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            has 2 moves, 
                              
                                 (
                                 1
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                            and 
                              
                                 (
                                 1
                                 ,
                                 2
                                 ,
                                 2
                                 ,
                                 1
                                 )
                              
                           .
                     
                     
                        2
                     
                  

In the original (non-multiset) problem definition the conditions 
                        
                           m
                           ⩾
                           n
                        
                      and 
                        
                           m
                           <
                           n
                        
                      distinguish the regime where changeovers can be avoided trivially from the regime where any schedule contains at least one changeover. Given a multiset production 
                        
                           (
                           [
                           n
                           ]
                           ,
                           P
                           )
                           ,
                           P
                           =
                           (
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 P
                              
                              
                                 ℓ
                              
                           
                           )
                        
                     , and an integer m, these conditions naturally generalize to 
                        
                           m
                           ⩾
                           
                              
                                 ∑
                              
                              
                                 p
                                 ∈
                                 [
                                 n
                                 ]
                              
                           
                           P
                           (
                           p
                           )
                        
                      and 
                        
                           m
                           <
                           
                              
                                 ∑
                              
                              
                                 p
                                 ∈
                                 [
                                 n
                                 ]
                              
                           
                           P
                           (
                           p
                           )
                        
                     , where 
                        
                           P
                           (
                           p
                           )
                           ≔
                           
                              
                                 max
                              
                              
                                 i
                                 ∈
                                 [
                                 ℓ
                                 ]
                              
                           
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           (
                           p
                           )
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           (
                           p
                           )
                        
                      denotes the multiplicity of p in 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                        
                     .

Algorithms that deal with multiset productions and that have the properties claimed in Theorems 4–6 can by obtained from the original (non-multiset) algorithms stated in Algorithms 1 and 4 by adding a pre- and post-processing phase around each of them as shown in Algorithm 5 below. The first and the second line in each of the large parentheses 
                           
                              {
                              }
                           
                         in Algorithm 5 describe the multiset generalizations of Algorithms 1 and 4, respectively. All parts outside of these parentheses, in particular the pre- and post-processing functions PreProcessMulti() and PostProcessMulti(), are the same in each case. We denote the resulting algorithms by BuildBlocksMulti() and BuildBlocksMulti
                        ∗(), 
                           
                              ∗
                              ∈
                              {
                              crit,stop
                              }
                           
                        .

During pre-processing, by renaming the parts the given multiset production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                         is transformed into an auxiliary (non-multiset) production 
                           
                              (
                              [
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ]
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        . In the post-processing phase, the parts in the schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                           
                         computed for the production 
                           
                              (
                              [
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ]
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         are renamed again, yielding a schedule 
                           
                              σ
                           
                         for the multiset production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                        .
                           Algorithm 5
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      B
                                                      
                                                         uild
                                                      
                                                      B
                                                      
                                                         locks
                                                      
                                                      M
                                                      
                                                         ulti
                                                      
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      ,
                                                      m
                                                      )
                                                   
                                                
                                                
                                                   
                                                      B
                                                      
                                                         uild
                                                      
                                                      B
                                                      
                                                         locks
                                                      
                                                      M
                                                      
                                                         
                                                            
                                                               ulti
                                                            
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      (
                                                      [
                                                      n
                                                      ]
                                                      ,
                                                      P
                                                      ,
                                                      m
                                                      )
                                                      ,
                                                      
                                                      ∗
                                                      ∈
                                                      {
                                                      crit,stop
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              
                                 
                                    
                                 
                              
                           

We now define the pre- and post-processing functions PreProcessMulti() and PostProcessMulti().

The function PreProcessMulti() computes, for a given multiset production 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                              ,
                              P
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                        , an auxiliary (non-multiset) production 
                           
                              (
                              [
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ]
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              )
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ℓ
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        , and a function f as follows:

We set 
                           
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ≔
                              
                                 
                                    ∑
                                 
                                 
                                    p
                                    ∈
                                    [
                                    n
                                    ]
                                 
                              
                              P
                              (
                              p
                              )
                           
                         and define f as an arbitrary bijection between the pairs 
                           
                              
                                 
                                    ⋃
                                 
                                 
                                    p
                                    ∈
                                    [
                                    n
                                    ]
                                 
                              
                              {
                              (
                              p
                              ,
                              c
                              )
                              |
                              c
                              =
                              1
                              ,
                              …
                              ,
                              P
                              (
                              p
                              )
                              }
                           
                         and the integers 
                           
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                           
                        . The function f will be used to rename the parts in 
                           
                              (
                              [
                              n
                              ]
                              ,
                              P
                              )
                           
                        . Specifically, for every 
                           
                              i
                              ∈
                              [
                              ℓ
                              ]
                              ,
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         is obtained from 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         by adding for 
                           
                              p
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         with multiplicity 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              (
                              p
                              )
                              =
                              :
                              k
                           
                         the (different!) auxiliary parts 
                           
                              f
                              (
                              p
                              ,
                              1
                              )
                              ,
                              …
                              ,
                              f
                              (
                              p
                              ,
                              k
                              )
                           
                         to 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                        . By this definition we have 
                           
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              |
                              =
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                           
                        .

The function PostProcessMulti() computes a schedule 
                           
                              σ
                              ∈
                              Σ
                              (
                              [
                              n
                              ]
                              ,
                              P
                              ,
                              m
                              )
                           
                         from a given schedule 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              Σ
                              (
                              [
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ]
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              ,
                              m
                              )
                           
                         by computing for every non-empty entry of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                           
                         with value 
                           
                              
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              [
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ]
                           
                         the pair 
                           
                              (
                              p
                              ,
                              c
                              )
                              ≔
                              
                                 
                                    f
                                 
                                 
                                    -
                                    1
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         and replacing the value 
                           
                              
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                           
                         by p.

Note that the precondition 
                           
                              m
                              <
                              
                                 
                                    ∑
                                 
                                 
                                    p
                                    ∈
                                    [
                                    n
                                    ]
                                 
                              
                              P
                              (
                              p
                              )
                           
                         of Algorithm 5 above is equivalent to 
                           
                              m
                              <
                              
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                           
                        , which is the natural precondition known for Algorithms 1 and 4 (as mentioned before, the required bounds on m are only included to avoid trivial cases).

The correctness of Algorithm 5 can be deduced from the already shown correctness of Algorithms 1 and 4. The line of argument is completely analogous to the proofs of Theorems 5 and 6 discussed earlier (recall the outline of the proofs at the beginning of Section 3.2 and 3.3). As no new ideas are needed, we omit those calculations.

The running time of Algorithm 5 is dominated by the running time of BuildBlocks() and BuildBlocks
                        ∗(), 
                           
                              ∗
                              ∈
                              {
                              crit,stop
                              }
                           
                        , which is 
                           
                              O
                              (
                              ℓ
                              ·
                              m
                              )
                           
                        . The running time of PreProcessMulti() is clearly bounded by 
                           
                              O
                              (
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    [
                                    ℓ
                                    ]
                                 
                              
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              |
                              )
                              =
                              O
                              (
                              ℓ
                              ·
                              m
                              )
                           
                        . Also the running time of PostProcessMulti() is bounded by 
                           
                              O
                              (
                              ℓ
                              ·
                              m
                              )
                           
                         (both schedule matrices 
                           
                              
                                 
                                    σ
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              σ
                           
                         have 
                           
                              ℓ
                              ·
                              m
                           
                         entries). It follows that the runtime bounds stated in Theorems 4–6 for the original (non-multiset) algorithms also hold in the multiset setting.

The following proofs of our hardness results, Theorems 7 and 8, employ reductions from the graph colorability problem and the Hamiltonian path problem.


                        
                           Proof
                           Proof of Theorem 7
                           


                           The hardness of computing 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          move
                                       
                                       
                                          min
                                       
                                    
                                 
                               follows from the fact that deciding whether a given production can be scheduled on a given number of machines with 0 moves is NP-complete. This in turn can be shown by a reduction from k
                              −Colorability, the problem to decide whether the vertices of a given graph G can be colored with a given number of k colors, subject to the constraint that no two adjacent vertices receive the same color (Garey & Johnson, 1979, GT4). Given 
                                 
                                    G
                                    =
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                               and k, we define a production 
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    )
                                    ,
                                    n
                                    =
                                    n
                                    (
                                    G
                                    ,
                                    k
                                    )
                                 
                               and 
                                 
                                    P
                                    =
                                    P
                                    (
                                    G
                                    ,
                                    k
                                    )
                                 
                              , as follows: We define the number of products as 
                                 
                                    ℓ
                                    ≔
                                    |
                                    E
                                    |
                                 
                               and the number of parts as 
                                 
                                    n
                                    ≔
                                    |
                                    V
                                    |
                                 
                              . For every edge 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                               of G, we add the product 
                                 
                                    {
                                    u
                                    ,
                                    v
                                    }
                                 
                               to P (the products can be added in arbitrary order). The claim follows by observing that G is k-colorable, if and only if 
                                 
                                    (
                                    [
                                    n
                                    (
                                    G
                                    ,
                                    k
                                    )
                                    ]
                                    ,
                                    P
                                    (
                                    G
                                    ,
                                    k
                                    )
                                    )
                                 
                               can be scheduled on k machines with 0 moves (the machines correspond to the color classes in a proper coloring).□


                        
                           Proof
                           Computing 
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          move
                                       
                                       
                                          min
                                       
                                    
                                 
                               is NP-hard.


                           The proof is analogous to the proof of Theorem 7, observing that the order of the products in the constructed production is irrelevant.□

This follows from the fact that deciding whether a given production can be scheduled (here, scheduling includes determining a product ordering) on a given number of machines with a given number of changeovers is NP-complete. This in turn can be shown by a reduction from HamiltonPath, the problem to decide whether a given graph G contains a Hamiltonian path, a path that visits every vertex of G exactly once (Garey & Johnson, 1979, GT39). Given 
                                 
                                    G
                                    =
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                              , we construct a production 
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    )
                                    ,
                                    n
                                    =
                                    n
                                    (
                                    G
                                    )
                                 
                               and 
                                 
                                    P
                                    =
                                    P
                                    (
                                    G
                                    )
                                 
                              , a number of machines 
                                 
                                    m
                                    =
                                    m
                                    (
                                    G
                                    )
                                 
                               and a threshold 
                                 
                                    k
                                    =
                                    k
                                    (
                                    G
                                    )
                                 
                               for the number of changeovers as follows.

The number of products is defined as 
                                 
                                    ℓ
                                    ≔
                                    |
                                    V
                                    |
                                 
                              . Every product 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    i
                                    ∈
                                    [
                                    ℓ
                                    ]
                                 
                              , consists of 
                                 
                                    ℓ
                                    -
                                    1
                                 
                               different elements (parts) from the ground set 
                                 
                                    [
                                    n
                                    ]
                                 
                              , where 
                                 
                                    n
                                    ≔
                                    ℓ
                                    ·
                                    (
                                    ℓ
                                    -
                                    1
                                    )
                                    -
                                    |
                                    E
                                    |
                                 
                              . The products 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    ℓ
                                 
                              , are defined inductively (first 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                 
                              , then 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                 
                               and so on) as follows: We fix an arbitrary ordering 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                               of the vertices of G. To define 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                              , we consider the vertex 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               and the set of its neighbors 
                                 
                                    N
                                    ≔
                                    {
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    
                                    |
                                    
                                    
                                       
                                          ı
                                       
                                       
                                          ¯
                                       
                                    
                                    <
                                    i
                                    ∧
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ∈
                                    E
                                    }
                                 
                               in the graph G. For every 
                                 
                                    
                                       
                                          ı
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               with 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    ∈
                                    N
                                 
                               we choose an element 
                                 
                                    p
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                 
                               (as 
                                 
                                    
                                       
                                          ı
                                       
                                       
                                          ¯
                                       
                                    
                                    <
                                    i
                                 
                               the set 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                 
                               has been defined previously) which so far occurs only once in the production (as 
                                 
                                    deg
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    )
                                    ⩽
                                    |
                                    V
                                    |
                                    -
                                    1
                                    =
                                    ℓ
                                    -
                                    1
                                 
                               and 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                ı
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    |
                                    =
                                    ℓ
                                    -
                                    1
                                 
                              , such an element can always be found), and add p to 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                               (p then occurs exactly twice in the production). We then add another 
                                 
                                    ℓ
                                    -
                                    1
                                    -
                                    |
                                    N
                                    |
                                 
                               elements from 
                                 
                                    [
                                    n
                                    ]
                                 
                               to 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                               that so far do not occur in the production (these new elements now occur exactly once). In the initial case 
                                 
                                    i
                                    =
                                    1
                                 
                               we have 
                                 
                                    N
                                    =
                                    ∅
                                 
                              , so 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                 
                               consists of an arbitrary set of 
                                 
                                    ℓ
                                    -
                                    1
                                 
                               elements from 
                                 
                                    [
                                    n
                                    ]
                                 
                              . Furthermore, we define 
                                 
                                    m
                                    ≔
                                    ℓ
                                    -
                                    1
                                 
                               and 
                                 
                                    k
                                    ≔
                                    (
                                    m
                                    -
                                    1
                                    )
                                    (
                                    ℓ
                                    -
                                    1
                                    )
                                 
                              .

Observe that for any 
                                 
                                    i
                                    ,
                                    j
                                    ∈
                                    [
                                    ℓ
                                    ]
                                    ,
                                    i
                                    
                                    ≠
                                    
                                    j
                                 
                              , the products 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          j
                                       
                                    
                                 
                               can be scheduled consecutively with either 
                                 
                                    m
                                    -
                                    1
                                 
                               or m changeovers (note that 
                                 
                                    |
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    =
                                    ℓ
                                    -
                                    1
                                    =
                                    m
                                 
                              ), where 
                                 
                                    m
                                    -
                                    1
                                 
                               changeovers can be achieved, if and only if 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                 
                               are connected by an edge in G (only then 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          j
                                       
                                    
                                 
                               have a common element, which saves a changeover). It follows that 
                                 
                                    (
                                    [
                                    n
                                    (
                                    G
                                    )
                                    ]
                                    ,
                                    P
                                    (
                                    G
                                    )
                                    )
                                 
                               can be scheduled on 
                                 
                                    m
                                    (
                                    G
                                    )
                                 
                               machines with 
                                 
                                    k
                                    (
                                    G
                                    )
                                 
                               changeovers, if and only if G contains a Hamiltonian path. This proves the claim.□

We focus on proving that computing 
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          crit
                                       
                                       
                                          min
                                       
                                    
                                 
                               is NP-hard. The proof for 
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          stop
                                       
                                       
                                          min
                                       
                                    
                                 
                               is simply obtained by exchanging critical changeovers for stops. Computing 
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          crit
                                       
                                       
                                          min
                                       
                                    
                                 
                               is NP-hard, as deciding whether a given production can be scheduled on a given number of machines with 0 critical changeovers is NP-complete. As in the previous proof, this can be shown by a reduction from HamiltonPath. For a given graph 
                                 
                                    G
                                    =
                                    (
                                    V
                                    ,
                                    E
                                    )
                                 
                              , we construct a production 
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    )
                                    ,
                                    n
                                    =
                                    n
                                    (
                                    G
                                    )
                                 
                               and 
                                 
                                    P
                                    =
                                    P
                                    (
                                    G
                                    )
                                 
                              , and a number of machines 
                                 
                                    m
                                    =
                                    m
                                    (
                                    G
                                    )
                                 
                               as follows: The production 
                                 
                                    (
                                    [
                                    n
                                    ]
                                    ,
                                    P
                                    )
                                    ,
                                    P
                                    =
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          ℓ
                                       
                                    
                                    )
                                 
                              , is defined as in the previous proof. The only difference is the definition of m, which we set to 
                                 
                                    m
                                    ≔
                                    2
                                    (
                                    ℓ
                                    -
                                    1
                                    )
                                    -
                                    1
                                 
                              . Observe that for any 
                                 
                                    i
                                    ,
                                    j
                                    ∈
                                    [
                                    ℓ
                                    ]
                                    ,
                                    i
                                    
                                    ≠
                                    
                                    j
                                 
                              , the products 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          j
                                       
                                    
                                 
                               can be scheduled consecutively without a critical changeover, if and only if 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                 
                               are connected by an edge in G (only then 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          P
                                       
                                       
                                          j
                                       
                                    
                                 
                               have a common element, which prevents a critical changeover). It follows that 
                                 
                                    (
                                    [
                                    n
                                    (
                                    G
                                    )
                                    ]
                                    ,
                                    P
                                    (
                                    G
                                    )
                                    )
                                 
                               can be scheduled on 
                                 
                                    m
                                    (
                                    G
                                    )
                                 
                               machines with 0 critical changeovers, if and only if G contains a Hamiltonian path. This completes the proof.□

@&#ACKNOWLEDGEMENT@&#

The author thanks Reto Spöhel and Peter Widmayer for their help and advice in polishing this manuscript.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2013.11.011.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

