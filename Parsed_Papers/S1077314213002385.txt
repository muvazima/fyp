@&#MAIN-TITLE@&#Suspension models for testing shape similarity methods

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce a procedure to build challenging examples for persistence algorithms.


                        
                        
                           
                           Our procedure allows us to construct models in arbitrarily high dimension.


                        
                        
                           
                           The correctness of the procedure is proved and supported with numerical tests.


                        
                        
                           
                           We provide insights regarding the need to use multidimensional measuring functions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Topological suspension

Shape similarity

Persistent homology

Filtration

Matching distance

@&#ABSTRACT@&#


               
               
                  A model based on the concept of topological suspension is constructed with the purpose of testing and comparing different shape similarity measures in computer vision and graphics. This model gives an automatic way to produce interesting shapes of arbitrarily high dimension as quality tests of algorithms that have been used in low dimensions, but are now intended for comparing multidimensional data sets. The analysis of the matching distance method is provided for one and two-parameter measuring functions on closed curves and surfaces, whose suspension is defined, respectively, on surfaces in 
                        
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        
                      and 3D objects in 
                        
                           
                              
                                 R
                              
                              
                                 4
                              
                           
                        
                     . Perspectives for applying this model to other shape descriptors used for digital images are pointed out.
               
            

@&#INTRODUCTION@&#

In this paper, we present a model based on the concept of topological suspension for testing and comparing different shape similarity measures. This model shall give an automatic way to produce interesting shapes of arbitrarily high dimension as quality tests of algorithms that have been successfully used in the lowest dimensions, but are now intended for comparing multidimensional data sets. Data of arbitrarily high dimension arise in computational dynamics, in particular in PDEs of evolutionary type as a result of Fourier series projection or of discretization of the space variable. See, for example [8,15,12] and references therein. Another example of high-dimensional data comes from considering the time index in streams of images as an additional dimension. In this way a stream of 2D images can be interpreted as a 3D image [16,19]. One of the authors of [19] is currently working on applying this principle to pattern analysis of streams of 3D images interpreted as 4D images. Such data may be huge and thus numerically challenging, but since we do not know a priori the expected output of the topology algorithm, we cannot be sure if it gives the right results. Hence, unless the data and its structure is already well-known, it may not be suitable for testing. Conversely, high-dimension examples constructed by hand are typically not very demanding from a numerical standpoint. The suspension process allows the construction of models with the desired topological characteristics in any dimension.

Let us outline this procedure which will be presented in detail in Section 2. Let M be an n-dimensional triangulated manifold representing a given shape, and let f be a continuous function on M with values in 
                        
                           R
                        
                      which measures a feature of interest of M. In papers on applications to shape comparison such a function is called measuring function (e.g. [11]), and is often interpolated from its values on vertices of a given mesh.

The topological descriptor of shapes we will focus our attention on is the homology rank invariant, one of many ways of measuring how the topology of the sublevel set changes as we pass through a critical value of the function f. This shape descriptor permits measuring the persistence or, in other words, the robustness of homology generators, thus distinguishing those which may appear due to noise in the data from structural ones. The term rank invariant was perhaps first introduced in [4] in the context of multidimensional persistence, but in case of one-dimensional persistence, the information given by the rank invariant can be graphically displayed in two equivalent ways: either as the persistence diagram 
                     [9] or as a barcode 
                     [5]. Given two different shapes M and N, and their measuring functions f and g, a distance between rank invariants is a measure of similarity between the shapes. We focused our attention on the matching distance 
                     [11] but our model carries over to any other known distance with the stability property, for instance, to the Wasserstein distance 
                     [10].

We construct a measuring function 
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           f
                        
                      on the topological suspension SM, also with values in 
                        
                           R
                        
                     , and with the property that its rank invariants are basically those of f with the homology dimension q shifted by one (Theorem 2.3). In particular, the 0-dimensional rank invariant, also called the size function 
                     [14,22] of 
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           f
                        
                      is quasi-trivial, and the one-dimensional rank invariant of 
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           f
                        
                      provides about the same information as the size function of f. Note that by iterating this construction, we can produce shapes of arbitrary dimensionality whose interesting features are shifted to the highest dimension.

Our next result is Theorem 2.5 showing the relation between the matching distances of two measuring functions and their suspensions. We then extend the construction to suspensions 
                        
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           f
                        
                      of multiparameter functions 
                        
                           f
                           :
                           M
                           →
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                     , also called multidimensional measuring functions. The multidimensional persistent homology was first introduced in [4] in the context of discrete filtrations. Its motivation is that a multifiltration may detect geometric features which separate k coordinate-wise tests cannot detect. Multidimensional 0th order rank invariants were first applied to the shape similarity analysis based on continuous measuring functions in [3]. A bridge between the discrete and continuous settings is established in [6].

Our construction was motivated by the fact that current numerical experimentation seems to suggest that in some cases, shape comparison using homology rank invariants can be reduced in practice to that of multidimensional 0th order rank invariants provided the dimension of the parameter space is increased. Our goal is not to object to this experimental assertion, but rather to indicate that the exchange of the method cannot be done blindly, that is, without knowing the shape of the object we want to study, and that it may induce a higher computational cost than computing rank invariants for higher homology dimensions.

In Section 3, the analysis of the matching distance method is provided for two-parameter measuring functions on closed curves and surfaces, whose suspension is defined, respectively, on surfaces and on 3D objects in 4D space.

In Section 4, perspectives for applying our construction to other known shape descriptors in digital imaging are suggested. We give two examples: one is the Morse descriptor introduced in [1] and another one is the method of image matching by transformation maps introduced in [13]. In applications to digital imaging, where pixels and voxels are of concern, cubical grids are the most convenient geometric structure. However, the geometric realization of the suspension is clearly easier in simplicial meshes. Nevertheless, our model can be applied to cubical grids arising in digital imaging, by using the concept of relative homology, as we show.

Appendix A contains the proofs of the main mathematical statements, which are our original results.

Since the homological rank invariants are only defined for homology with coefficients in a field 
                        
                           F
                        
                     , we will use the notation 
                        
                           
                              
                                 H
                              
                              
                                 ∗
                              
                           
                           (
                           X
                           )
                        
                      for 
                        
                           
                              
                                 H
                              
                              
                                 ∗
                              
                           
                           (
                           X
                           ;
                           F
                           )
                        
                      throughout this paper.

The suspension of a topological space X is the quotient space 
                        
                           SX
                           
                           ≔
                           
                           X
                           ×
                           [
                           -
                           1
                           ,
                           1
                           ]
                           /
                           ∼
                        
                     , where 
                        
                           ∼
                        
                      is the identification 
                        
                           (
                           x
                           ,
                           1
                           )
                           ∼
                           (
                           y
                           ,
                           1
                           )
                           
                           and
                           
                           (
                           x
                           ,
                           -
                           1
                           )
                           ∼
                           (
                           y
                           ,
                           -
                           1
                           )
                        
                      for all 
                        
                           x
                           ,
                           y
                           ∈
                           X
                        
                      
                     [20, Section 33]. This space can be visualized as a double cone over X with vertices at the parameter values 
                        
                           s
                           =
                           ±
                           1
                        
                     . It is known that S is a functor on the category of topological spaces, with its value on maps 
                        
                           F
                           :
                           X
                           →
                           Y
                        
                      given by 
                        
                           SF
                           (
                           x
                           ,
                           s
                           )
                           
                           ≔
                           
                           (
                           F
                           (
                           x
                           )
                           ,
                           s
                           )
                        
                     . This functor shifts the reduced homology dimension by one [20, Theorem 33.2], that is
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    q
                                    +
                                    1
                                 
                              
                              (
                              SX
                              )
                              ≅
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    q
                                 
                              
                              (
                              X
                              )
                              ,
                              
                              q
                              ⩾
                              -
                              1
                              .
                           
                        
                     
                  

In terms of non-reduced homology, this is equivalent to writing
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                q
                                                +
                                                1
                                             
                                          
                                          (
                                          SX
                                          )
                                          ≅
                                          
                                             
                                                H
                                             
                                             
                                                q
                                             
                                          
                                          (
                                          X
                                          )
                                          ,
                                          
                                          for
                                          
                                          q
                                          ⩾
                                          1
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          SX
                                          )
                                          ⊕
                                          F
                                          ≅
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          X
                                          )
                                          ,
                                          
                                          and
                                          
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          SX
                                          )
                                          ≅
                                          F
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Let 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ∈
                           X
                        
                     . The based suspension of the pointed space 
                        
                           (
                           X
                           ,
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           )
                        
                      is the pointed space 
                        
                           (
                           Σ
                           X
                           ,
                           (
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           0
                           )
                           )
                        
                     , where 
                        
                           Σ
                           X
                        
                      is the quotient space of SX obtained by the additional identification 
                        
                           (
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           s
                           )
                           ∼
                           (
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           0
                           )
                        
                      for all 
                        
                           s
                           ∈
                           [
                           -
                           1
                           ,
                           1
                           ]
                        
                     . Fig. 1
                     
                      shows an example of a topological space and its suspension.

Let us note that if X is a triangulable space, then its suspension SX is also triangulable, and given 
                        
                           K
                        
                      a triangulation of X we can construct 
                        
                           S
                           (
                           K
                           )
                        
                     , also called the suspension of the complex 
                        
                           K
                        
                     , as the join 
                        
                           S
                           (
                           K
                           )
                           =
                           K
                           ★
                           {
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           }
                        
                     , where 
                        
                           {
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           }
                        
                      is a complex composed of two vertices. That is, the simplices of 
                        
                           S
                           (
                           K
                           )
                        
                      are composed of every simplex 
                        
                           [
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                           ]
                        
                      of 
                        
                           K
                        
                     , as well as 
                        
                           [
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                           ]
                           
                           and
                           
                           [
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                           ]
                        
                     . The suspension 
                        
                           S
                           (
                           K
                           )
                        
                      can be seen as the union of two cones over 
                        
                           K
                        
                     , and if 
                        
                           K
                        
                      is a triangulation of X, then 
                        
                           S
                           (
                           K
                           )
                        
                      is also a triangulation of SX. In this case, it is known that 
                        
                           Σ
                           X
                        
                      is homotopy equivalent to SX 
                     [17, Section 4.3].

We now pass to measuring functions on topological spaces. In literature on Morse theory and its applications, we usually assume that 
                        
                           X
                           =
                           M
                        
                      is a connected smooth compact manifold of dimension d and that 
                        
                           f
                           :
                           M
                           →
                           R
                        
                      is a Morse function, that is, a 
                        
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        
                      function whose critical points are nondegenerate and have distinct critical values. Among other consequences, this hypothesis permits the definition of the Morse index of a critical point p of f as the dimension of the negative eigenspace of the Hessian matrix of f at p. However, in this paper we will only assume that f is of class 
                        
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        
                      unless otherwise stated. Let 
                        
                           
                              
                                 m
                              
                              
                                 0
                              
                           
                        
                      be the global minimum of f attained at 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                        
                     .

Define 
                        
                           Ef
                           :
                           M
                           ×
                           [
                           -
                           1
                           ,
                           1
                           ]
                           →
                           R
                        
                      by
                        
                           (2)
                           
                              Ef
                              (
                              x
                              ,
                              s
                              )
                              
                              ≔
                              
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                              +
                              (
                              1
                              -
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                              )
                              f
                              (
                              x
                              )
                              .
                           
                        
                     Note that Ef assumes the global minimum at the union of 
                        
                           {
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           }
                           ×
                           [
                           -
                           1
                           ,
                           1
                           ]
                        
                      with 
                        
                           M
                           ×
                           {
                           -
                           1
                           ,
                           1
                           }
                        
                     . Along each line 
                        
                           s
                           
                           ↦
                           
                           (
                           x
                           ,
                           s
                           )
                           ,
                           Ef
                        
                      assumes a maximum at 
                        
                           (
                           x
                           ,
                           0
                           )
                        
                     . By simple differential calculus, we get the following statement.
                        Proposition 2.1
                        
                           A point 
                           
                              
                                 (
                                 p
                                 ,
                                 s
                                 )
                              
                            
                           is a critical point of Ef if and only if either p is a critical point of f and 
                           
                              
                                 s
                                 =
                                 0
                              
                           
                           , or 
                           
                              
                                 s
                                 =
                                 ±
                                 1
                              
                           
                           . Moreover, if p is a nondegenerate critical point of f of Morse index 
                           
                              
                                 λ
                              
                           
                           , then 
                           
                              
                                 (
                                 p
                                 ,
                                 0
                                 )
                              
                            
                           is also a nondegenerate critical point of Ef of Morse index 
                           
                              
                                 λ
                                 +
                                 1
                              
                           
                           .
                        

Define the maps 
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           f
                           :
                           SM
                           →
                           R
                        
                     , respectively, 
                        
                           
                              
                                 Σ
                              
                              
                                 1
                              
                           
                           f
                           :
                           Σ
                           M
                           →
                           R
                        
                     , as the compositions of the inverse of the quotient map of 
                        
                           M
                           ×
                           [
                           -
                           1
                           ,
                           1
                           ]
                        
                      onto SM, respectively, 
                        
                           Σ
                           M
                        
                     , with Ef. These applications are well-defined since Ef is constant on the subsets of 
                        
                           M
                           ×
                           [
                           -
                           1
                           ,
                           1
                           ]
                        
                      which are sent to a point by quotient maps. The statement of Proposition 2.1 extends to 
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           f
                        
                      except for the non-degeneracy conditions at points on 
                        
                           {
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           }
                           ×
                           [
                           -
                           1
                           ,
                           1
                           ]
                        
                      with the critical value 
                        
                           
                              
                                 m
                              
                              
                                 0
                              
                           
                        
                     . By passing to 
                        
                           
                              
                                 Σ
                              
                              
                                 1
                              
                           
                           f
                        
                     , we gain the isolation condition for the equivalence class of 
                        
                           (
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ,
                           0
                           )
                        
                     .

Given any 
                        
                           α
                           ∈
                           R
                        
                     , we consider the sublevel sets
                        
                           
                              
                                 
                                    M
                                 
                                 
                                    α
                                 
                              
                              
                              ≔
                              
                              {
                              x
                              ∈
                              M
                              |
                              f
                              (
                              x
                              )
                              ⩽
                              α
                              }
                           
                        
                     and
                        
                           
                              
                                 
                                    (
                                    SM
                                    )
                                 
                                 
                                    α
                                 
                              
                              
                              ≔
                              
                              {
                              (
                              x
                              ,
                              s
                              )
                              ∈
                              SM
                              |
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              f
                              (
                              x
                              ,
                              s
                              )
                              ⩽
                              α
                              }
                              .
                           
                        
                     It is easy to see that 
                        
                           S
                           (
                           
                              
                                 M
                              
                              
                                 α
                              
                           
                           )
                           ⊂
                           
                              
                                 (
                                 SM
                                 )
                              
                              
                                 α
                              
                           
                        
                      but the reverse inclusion does not hold true. However, the following result holds. Proof can be found in appendix, along with other long proofs of results in this article.
                        Lemma 2.2
                        
                           The set 
                           
                              
                                 S
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                                 )
                              
                            
                           is homotopy equivalent to 
                           
                              
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                    
                                 
                              
                           
                           .
                        

We now discuss the effect of the suspension operation on rank invariants. We assume that M is triangulated so that the critical points of f are vertices of the triangulation, and in particular, that 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                        
                      is a vertex. More precisely, in practical computations, f is usually known only on vertices of a given mesh and a function 
                        
                           
                              
                                 f
                              
                              
                                 ∊
                              
                           
                        
                      is interpolated from f in such a way that its critical values occur only on vertices. The stability theorems [7,6] guarantee the existence of a distance (such as the matching distance) in which the rank invariants of f and 
                        
                           
                              
                                 f
                              
                              
                                 ∊
                              
                           
                        
                      can be made as close as desired.

Given any 
                        
                           α
                           <
                           β
                        
                      in 
                        
                           R
                        
                     , we consider the map
                        
                           
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    j
                                 
                                 
                                    (
                                    α
                                    ,
                                    β
                                    )
                                 
                              
                              )
                              :
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    α
                                 
                              
                              )
                              →
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    β
                                 
                              
                              )
                           
                        
                     induced by the inclusion map 
                        
                           
                              
                                 j
                              
                              
                                 (
                                 α
                                 ,
                                 β
                                 )
                              
                           
                           :
                           
                              
                                 M
                              
                              
                                 α
                              
                           
                           ↪
                           
                              
                                 M
                              
                              
                                 β
                              
                           
                        
                     . Recall that the qth persistent homology space of 
                        
                           (
                           M
                           ,
                           f
                           )
                        
                      at 
                        
                           (
                           α
                           ,
                           β
                           )
                        
                      is the image of 
                        
                           
                              
                                 H
                              
                              
                                 q
                              
                           
                           (
                           
                              
                                 M
                              
                              
                                 α
                              
                           
                           )
                        
                      under the map 
                        
                           
                              
                                 H
                              
                              
                                 q
                              
                           
                           (
                           
                              
                                 j
                              
                              
                                 (
                                 α
                                 ,
                                 β
                                 )
                              
                           
                           )
                        
                      and the qth rank invariant of 
                        
                           (
                           M
                           ,
                           f
                           )
                        
                      
                     at 
                     
                        
                           (
                           α
                           ,
                           β
                           )
                        
                      is the number
                        
                           (3)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    f
                                 
                                 
                                    q
                                 
                              
                              (
                              α
                              ,
                              β
                              )
                              =
                              rank
                              
                              im
                              
                              
                                 
                                    H
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    j
                                 
                                 
                                    (
                                    α
                                    ,
                                    β
                                    )
                                 
                              
                              )
                              .
                           
                        
                     
                  

The rank invariant function is 
                        
                           
                              
                                 ρ
                              
                              
                                 f
                              
                              
                                 q
                              
                           
                           :
                           
                              
                                 Δ
                              
                              
                                 +
                              
                           
                           →
                           N
                        
                      defined on
                        
                           
                              
                                 
                                    Δ
                                 
                                 
                                    +
                                 
                              
                              
                              ≔
                              
                              {
                              (
                              α
                              ,
                              β
                              )
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              |
                              α
                              <
                              β
                              }
                              .
                           
                        
                     
                  

Analogously, we define the reduced rank invariant function as the one on the reduced homologies:
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    f
                                 
                                 
                                    q
                                 
                              
                              (
                              α
                              ,
                              β
                              )
                              =
                              
                              rank
                              
                              im
                              
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    j
                                 
                                 
                                    (
                                    α
                                    ,
                                    β
                                    )
                                 
                              
                              )
                              .
                           
                        
                     
                  

Here is our first result.
                        Theorem 2.3
                        
                           Let 
                           
                              
                                 f
                                 :
                                 M
                                 →
                                 R
                              
                            
                           be a 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                            
                           function on a connected compact manifold M. For any 
                           
                              
                                 (
                                 α
                                 ,
                                 β
                                 )
                                 ∈
                                 
                                    
                                       Δ
                                    
                                    
                                       +
                                    
                                 
                              
                           
                           ,
                           
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    (
                                    α
                                    ,
                                    β
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          f
                                       
                                       
                                          q
                                       
                                    
                                    (
                                    α
                                    ,
                                    β
                                    )
                                    ,
                                    
                                    q
                                    ⩾
                                    -
                                    1
                                    .
                                 
                              
                           
                        


                           For the non-reduced rank invariant, we have
                           
                              
                                 (6)
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    (
                                    α
                                    ,
                                    β
                                    )
                                    =
                                    
                                       
                                          ρ
                                       
                                       
                                          f
                                       
                                       
                                          q
                                       
                                    
                                    (
                                    α
                                    ,
                                    β
                                    )
                                    ,
                                    
                                    q
                                    ⩾
                                    1
                                    ,
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    α
                                    ,
                                    β
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            f
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      (
                                                      α
                                                      ,
                                                      β
                                                      )
                                                   
                                                   
                                                      if
                                                      
                                                      α
                                                      <
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            f
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      (
                                                      α
                                                      ,
                                                      β
                                                      )
                                                      -
                                                      1
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           and
                           
                              
                                 (8)
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    α
                                    ,
                                    β
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      if
                                                      
                                                      α
                                                      <
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                           The same formulas hold for 
                           
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       1
                                    
                                 
                                 f
                              
                           
                           .
                        

We can use Theorem 2.3 to prove results about the matching distance between rank invariants [11]. The previous reference discusses the use of the matching distance in size theory, which is in essence the study of the 0th rank invariant. These results can be generalized in a natural and common way to the qth rank invariant. Recall the definition of a cornerpoint of the rank invariant function 
                        
                           
                              
                                 ρ
                              
                              
                                 f
                              
                           
                        
                     :
                        Definition 2.4
                        For a point 
                              
                                 p
                                 =
                                 (
                                 α
                                 ,
                                 β
                                 )
                                 ∈
                                 
                                    
                                       Δ
                                    
                                    
                                       +
                                    
                                 
                              
                           , define its multiplicity 
                           
                              
                                 μ
                                 (
                                 p
                                 )
                              
                            as the minimum, over all 
                              
                                 ∊
                                 >
                                 0
                              
                            such that 
                              
                                 α
                                 +
                                 ∊
                                 <
                                 β
                                 -
                                 ∊
                              
                           , of
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    α
                                    +
                                    ∊
                                    ,
                                    β
                                    -
                                    ∊
                                    )
                                    -
                                    
                                       
                                          ρ
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    α
                                    -
                                    ∊
                                    ,
                                    β
                                    -
                                    ∊
                                    )
                                    -
                                    
                                       
                                          ρ
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    α
                                    +
                                    ∊
                                    ,
                                    β
                                    +
                                    ∊
                                    )
                                    +
                                    
                                       
                                          ρ
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    α
                                    -
                                    ∊
                                    ,
                                    β
                                    +
                                    ∊
                                    )
                                    .
                                 
                              
                           If 
                              
                                 μ
                                 (
                                 p
                                 )
                                 >
                                 0
                              
                           , then p is called a proper cornerpoint of 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       f
                                    
                                 
                              
                           . In addition, for a vertical line r of equation 
                              
                                 x
                                 =
                                 α
                              
                           , define its multiplicity 
                           
                              
                                 μ
                                 (
                                 r
                                 )
                              
                            to be the minimum, over all 
                              
                                 ∊
                                 >
                                 0
                              
                            such that 
                              
                                 α
                                 +
                                 ∊
                                 <
                                 1
                                 /
                                 ∊
                              
                           , of
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    α
                                    +
                                    ∊
                                    ,
                                    1
                                    /
                                    ∊
                                    )
                                    -
                                    
                                       
                                          ρ
                                       
                                       
                                          f
                                       
                                    
                                    (
                                    α
                                    -
                                    ∊
                                    ,
                                    1
                                    /
                                    ∊
                                    )
                                    .
                                 
                              
                           If 
                              
                                 μ
                                 (
                                 r
                                 )
                                 >
                                 0
                              
                           , then r is called a cornerpoint at infinity of 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       f
                                    
                                 
                              
                           , and we identify it with the pair 
                              
                                 (
                                 α
                                 ,
                                 ∞
                                 )
                              
                           . The rank invariant function 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       f
                                    
                                 
                              
                            is uniquely determined by the multiset of its cornerpoints together with their multiplicities, called its persistence diagram 
                           
                              
                                 Dgm
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       f
                                    
                                 
                                 )
                              
                           .

The matching distance d between the rank invariants 
                        
                           
                              
                                 ρ
                              
                              
                                 f
                              
                           
                           
                           and
                           
                           
                              
                                 ρ
                              
                              
                                 g
                              
                           
                        
                      is the bottleneck distance between the multisets of their cornerpoints. Technical details can be found in [11, Definitions 3.4–3.6] and we do not wish to encumber this article by repeating them, but generally speaking, its definition is the following:
                        
                           
                              d
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    f
                                 
                              
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    g
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       min
                                    
                                    
                                       σ
                                    
                                 
                              
                              
                                 
                                    
                                       max
                                    
                                    
                                       p
                                       ∈
                                       Dgm
                                       (
                                       
                                          
                                             ρ
                                          
                                          
                                             f
                                          
                                       
                                       )
                                    
                                 
                              
                              δ
                              (
                              p
                              ,
                              σ
                              (
                              p
                              )
                              )
                              ,
                           
                        
                     where 
                        
                           σ
                        
                      varies among the bijections between 
                        
                           dgm
                           (
                           
                              
                                 ρ
                              
                              
                                 f
                              
                           
                           )
                           
                           and
                           
                           dgm
                           (
                           
                              
                                 ρ
                              
                              
                                 g
                              
                           
                           )
                        
                     , and where
                        
                           
                              δ
                              (
                              (
                              u
                              ,
                              v
                              )
                              ,
                              (
                              
                                 
                                    u
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    ′
                                 
                              
                              )
                              )
                              =
                              
                                 min
                              
                              
                                 
                                    
                                       
                                          max
                                       
                                       {
                                       |
                                       u
                                       -
                                       
                                          
                                             u
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       ,
                                       |
                                       v
                                       -
                                       
                                          
                                             v
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       }
                                       ,
                                       
                                          max
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                      -
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     The main idea is that 
                        
                           d
                           (
                           
                              
                                 ρ
                              
                              
                                 f
                              
                           
                           ,
                           
                              
                                 ρ
                              
                              
                                 g
                              
                           
                           )
                        
                      is the cost of the optimal bijection moving the cornerpoints of the persistence diagram of 
                        
                           
                              
                                 ρ
                              
                              
                                 f
                              
                           
                        
                      to those of 
                        
                           
                              
                                 ρ
                              
                              
                                 g
                              
                           
                        
                     . However, it also recognizes that if a cornerpoint of one or both of these persistence diagrams is close to the diagonal 
                        
                           Δ
                           
                           ≔
                           
                           {
                           (
                           α
                           ,
                           α
                           )
                           |
                           α
                           ∈
                           R
                           }
                        
                     , or cannot be matched to another cornerpoint due to differing cardinalities of the diagrams, the optimal bijection might entail moving it to the diagonal. This corresponds to smoothing out small topological noise in f or g.
                        Theorem 2.5
                        
                           Let 
                           
                              
                                 M
                                 ,
                                 N
                              
                            
                           be homeomorphic connected compact manifolds, and let 
                           
                              
                                 f
                                 :
                                 M
                                 →
                                 R
                                 
                                 and
                                 
                                 g
                                 :
                                 N
                                 →
                                 R
                              
                            
                           be 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                              
                            
                           measuring functions. Denote by 
                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                              
                            
                           the minima, respectively, of f on M and g on N. Then
                           
                              
                                 (9)
                                 
                                    d
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          g
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    )
                                    =
                                    d
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          f
                                       
                                       
                                          q
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          g
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    ,
                                    
                                    q
                                    ⩾
                                    -
                                    1
                                    .
                                 
                              
                           
                        


                           For the matching distance between non-reduced rank invariants:
                           
                              
                                 (10)
                                 
                                    d
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          g
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    )
                                    =
                                    d
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          f
                                       
                                       
                                          q
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          g
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    ,
                                    
                                    q
                                    ⩾
                                    1
                                    ,
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    d
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ⩽
                                    d
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          f
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          g
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           and
                           
                              
                                 (12)
                                 
                                    d
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          g
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    =
                                    |
                                    
                                       
                                          m
                                       
                                       
                                          0
                                       
                                    
                                    -
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    |
                                    .
                                 
                              
                           
                           Furthermore, if 
                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           , then we have
                           
                              
                                 (13)
                                 
                                    d
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          f
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          g
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      (
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            f
                                                         
                                                         
                                                            q
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            g
                                                         
                                                         
                                                            q
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      if
                                                      
                                                      q
                                                      ⩾
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      if
                                                      
                                                      q
                                                      =
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                           The same formulas hold for 
                           
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       1
                                    
                                 
                                 f
                                 
                                 and
                                 
                                 
                                    
                                       Σ
                                    
                                    
                                       1
                                    
                                 
                                 g
                              
                           
                           .
                        

From this point on, let us consider simplicial complexes 
                        
                           K
                           
                           and
                           
                           L
                        
                     , assumed to be the triangulations of homeomorphic compact connected manifolds M and N. We equip these complexes with k-dimensional measuring functions 
                        
                           φ
                           :
                           V
                           (
                           K
                           )
                           →
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           
                           and
                           
                           ψ
                           :
                           V
                           (
                           L
                           )
                           →
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                     , where 
                        
                           V
                        
                      refers to the vertex set of the complex under consideration. The functions may be obtained by sampling measuring functions 
                        
                           f
                           :
                           M
                           →
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           
                           and
                           
                           g
                           :
                           N
                           →
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      of class 
                        
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        
                     . For a complex 
                        
                           K
                        
                      equipped with a measuring function 
                        
                           φ
                           :
                           V
                           (
                           K
                           )
                           →
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                     , and a value 
                        
                           α
                           ∈
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      we further define the sublevel complex 
                        
                           
                              
                                 K
                              
                              
                                 α
                              
                           
                        
                      as the complex composed of all simplices of 
                        
                           K
                        
                      whose vertices v all verify the relation 
                        
                           φ
                           (
                           v
                           )
                           ⪯
                           α
                        
                     , where 
                        
                           ⪯
                        
                      is the usual partial order on 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                     . We shall define, for 
                        
                           φ
                           :
                           V
                           (
                           K
                           )
                           →
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                     , the measuring function 
                        
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           φ
                           =
                           (
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           
                              
                                 φ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           
                              
                                 φ
                              
                              
                                 k
                              
                           
                           )
                           :
                           V
                           (
                           S
                           (
                           K
                           )
                           )
                           →
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      on the vertices of the suspension 
                        
                           S
                           (
                           K
                           )
                           =
                           K
                           ★
                           {
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           }
                        
                     , where 
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                           (
                           v
                           )
                           =
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                           (
                           v
                           )
                        
                      for all vertices v of 
                        
                           K
                        
                     , and 
                        
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                           (
                           
                              
                                 w
                              
                              
                                 j
                              
                           
                           )
                           =
                           
                              
                                 m
                              
                              
                                 i
                                 ,
                                 0
                              
                           
                           ,
                           j
                           =
                           0
                           ,
                           1
                           ,
                           
                              
                                 m
                              
                              
                                 i
                                 ,
                                 0
                              
                           
                        
                      being the absolute minimum of 
                        
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                        
                      over 
                        
                           V
                           (
                           K
                           )
                        
                     .

We can define the rank invariants for the discrete model. Consider the map
                        
                           
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    j
                                 
                                 
                                    (
                                    α
                                    ,
                                    β
                                    )
                                 
                              
                              )
                              :
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    α
                                 
                              
                              )
                              →
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    β
                                 
                              
                              )
                           
                        
                     induced by the inclusion map 
                        
                           
                              
                                 j
                              
                              
                                 (
                                 α
                                 ,
                                 β
                                 )
                              
                           
                           :
                           
                              
                                 K
                              
                              
                                 α
                              
                           
                           ↪
                           
                              
                                 K
                              
                              
                                 β
                              
                           
                        
                     , where 
                        
                           α
                           ≺
                           β
                        
                      and where 
                        
                           
                              
                                 K
                              
                              
                                 α
                              
                           
                           
                           and
                           
                           
                              
                                 K
                              
                              
                                 β
                              
                           
                        
                      denote the supports of the sublevel complexes 
                        
                           
                              
                                 K
                              
                              
                                 α
                              
                           
                           
                           and
                           
                           
                              
                                 K
                              
                              
                                 β
                              
                           
                        
                     . We define the qth rank invariant of 
                        
                           (
                           K
                           ,
                           φ
                           )
                        
                      at 
                        
                           (
                           α
                           ,
                           β
                           )
                        
                      to be
                        
                           
                              
                                 
                                    ρ
                                 
                                 
                                    φ
                                 
                                 
                                    q
                                 
                              
                              (
                              α
                              ,
                              β
                              )
                              =
                              
                              rank
                              
                              im
                              
                              
                                 
                                    H
                                 
                                 
                                    q
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             j
                                          
                                          
                                             (
                                             α
                                             ,
                                             β
                                             )
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     As proved in [6], the rank invariant functions 
                        
                           
                              
                                 ρ
                              
                              
                                 φ
                              
                           
                        
                      are identical to the rank invariant functions 
                        
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       φ
                                    
                                    
                                       ⌝
                                    
                                 
                              
                           
                        
                     , where 
                        
                           
                              
                                 φ
                              
                              
                                 ⌝
                              
                           
                           :
                           K
                           →
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      is the axis-wise interpolation of 
                        
                           φ
                        
                     .

In [3] a foliation method was introduced to reduce the computation of multidimensional rank invariants to that of a parametrized family of rank invariants for one-dimensional measuring functions. Algorithms were then developed to allow arbitrarily precise computation of the multidimensional matching distance on a finite subset of this family. In short, for every pair 
                        
                           (
                           
                              
                                 l
                              
                              
                                 →
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 →
                              
                           
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           ×
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      where 
                        
                           
                              
                                 l
                              
                              
                                 i
                              
                           
                           >
                           0
                           ,
                           ∑
                           
                              
                                 l
                              
                              
                                 i
                              
                           
                           =
                           1
                           
                           and
                           
                           ∑
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           =
                           0
                        
                     , called an admissible pair and representing a line where 
                        
                           
                              
                                 l
                              
                              
                                 →
                              
                           
                        
                      is a unit direction vector oriented toward higher values in the partial order on 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      and where 
                        
                           
                              
                                 b
                              
                              
                                 →
                              
                           
                        
                      is a starting point, we define a reduced one-dimensional measuring function on vertices as
                        
                           
                              
                                 
                                    red
                                 
                                 
                                    (
                                    
                                       
                                          l
                                       
                                       
                                          →
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          →
                                       
                                    
                                    )
                                 
                                 
                                    φ
                                 
                              
                              (
                              v
                              )
                              =
                              
                                 
                                    
                                       min
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       k
                                    
                                 
                              
                              
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                              
                              
                                 
                                    
                                       max
                                    
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       k
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    v
                                    )
                                    -
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              .
                           
                        
                     It has been shown in [3] that if 
                        
                           α
                           ≺
                           β
                        
                      are values found on the line in 
                        
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                           ×
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                        
                      generated by 
                        
                           (
                           
                              
                                 l
                              
                              
                                 →
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 →
                              
                           
                           )
                        
                     , and more precisely, if 
                        
                           α
                           =
                           s
                           
                              
                                 l
                              
                              
                                 →
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 →
                              
                           
                           ,
                           β
                           =
                           t
                           
                              
                                 l
                              
                              
                                 →
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 →
                              
                           
                        
                     , then we have equality of rank invariants:
                        
                           
                              
                                 
                                    ρ
                                 
                                 
                                    φ
                                 
                              
                              (
                              α
                              ,
                              β
                              )
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          red
                                       
                                       
                                          (
                                          
                                             
                                                l
                                             
                                             
                                                →
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                →
                                             
                                          
                                          )
                                       
                                       
                                          φ
                                       
                                    
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                              .
                           
                        
                     This property has been used to define a k-dimensional matching distance between rank invariants:
                        
                           
                              D
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    φ
                                 
                              
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    ψ
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       sup
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             Adm
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              d
                              
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             
                                                
                                                   red
                                                
                                                
                                                   (
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         →
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         →
                                                      
                                                   
                                                   )
                                                
                                                
                                                   φ
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             ρ
                                          
                                          
                                             
                                                
                                                   red
                                                
                                                
                                                   (
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         →
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         →
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ψ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 Adm
                              
                              
                                 k
                              
                           
                        
                      is the set of admissible pairs.

It should be noted that k-parameter persistence provides more information on the structure of a shape than k separate tests using single-parameter persistence. To convince oneself of this fact, we may take a look at Fig. 3
                     . The two curves pictured cannot be distinguished by the rank invariant method using one or other of the coordinate functions. Indeed, their persistence diagrams will be identical, and the matching distance between them will be zero. However, using the reduction method, we find directions where topological properties are not born at the same point for both curves. We can therefore conclude that the 2-dimensional matching distance between their rank invariants will be positive.
                        Theorem 2.6
                        
                           Let 
                           
                              
                                 K
                                 ,
                                 L
                              
                            
                           be simplicial complexes, and let 
                           
                              
                                 φ
                                 :
                                 V
                                 (
                                 K
                                 )
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 
                                 and
                                 
                                 ψ
                                 :
                                 V
                                 (
                                 L
                                 )
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                              
                            
                           be k-dimensional measuring functions. Then
                           
                              
                                 (14)
                                 
                                    D
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          φ
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          ψ
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    )
                                    =
                                    D
                                    (
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          φ
                                       
                                       
                                          q
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          ψ
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    ,
                                    
                                    q
                                    ⩾
                                    0
                                    .
                                 
                              
                           
                        


                           For the k-dimensional matching distance between non-reduced rank invariants:
                           
                              
                                 (15)
                                 
                                    D
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          φ
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          ψ
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    )
                                    =
                                    D
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          φ
                                       
                                       
                                          q
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          ψ
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    ,
                                    
                                    q
                                    ⩾
                                    1
                                    ,
                                 
                              
                           
                           and
                           
                              
                                 (16)
                                 
                                    D
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          φ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                          ψ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ⩽
                                    D
                                    (
                                    
                                       
                                          ρ
                                       
                                       
                                          φ
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          ρ
                                       
                                       
                                          ψ
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

We believe that Theorem 2.6 is probably also true in the continuous case, that is, with manifolds 
                              
                                 M
                                 ,
                                 N
                              
                            equipped with continuous measuring functions 
                              
                                 f
                                 :
                                 M
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                                 
                                 and
                                 
                                 g
                                 :
                                 N
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                              
                           . However, the proof appears to be more complicated in this case. Since our interest is in the numerics, assuming the simplicial framework was sufficient.

The numerical examples described in this section have been produced with two-dimensional measuring functions. In this case, we note that the set of admissible pairs 
                        
                           
                              
                                 Adm
                              
                              
                                 2
                              
                           
                        
                      is the set of pairs 
                        
                           (
                           (
                           a
                           ,
                           1
                           -
                           a
                           )
                           ,
                           (
                           b
                           ,
                           -
                           b
                           )
                           )
                        
                      where 
                        
                           a
                           ∈
                           (
                           0
                           ,
                           1
                           )
                           
                           and
                           
                           b
                           ∈
                           R
                        
                     . For a measuring function 
                        
                           φ
                           :
                           V
                           (
                           K
                           )
                           →
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        
                     , we will denote the reduced one-dimensional functions 
                        
                           
                              
                                 red
                              
                              
                                 (
                                 (
                                 a
                                 ,
                                 1
                                 -
                                 a
                                 )
                                 ,
                                 (
                                 b
                                 ,
                                 -
                                 b
                                 )
                                 )
                              
                              
                                 φ
                              
                           
                        
                      by 
                        
                           
                              
                                 Φ
                              
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                           
                        
                     , and 
                        
                           
                              
                                 red
                              
                              
                                 (
                                 (
                                 a
                                 ,
                                 1
                                 -
                                 a
                                 )
                                 ,
                                 (
                                 b
                                 ,
                                 -
                                 b
                                 )
                                 )
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 φ
                              
                           
                        
                      as 
                        
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           
                              
                                 Φ
                              
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                           
                        
                     . Our examples are intended to provide experimental support for the theory described in the previous section. We have used two pairs of models, each of which are 1 or 2-dimensional simplicial complexes homeomorphic to connected and compact manifolds, as well as their simplicial suspensions as previously defined.

We have used an implementation of the algorithm of [2] to compute lower bounds for the two-dimensional matching distance between their rank invariants of various orders with decreasing error tolerance. This algorithm, given pairs 
                        
                           (
                           X
                           ,
                           φ
                           )
                           
                           and
                           
                           (
                           Y
                           ,
                           ψ
                           )
                        
                     , computes 
                        
                           d
                           (
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                              
                           
                           ,
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                              
                           
                           )
                        
                     , with 
                        
                           (
                           a
                           ,
                           b
                           )
                        
                      chosen on increasingly fine grids, until the desired tolerance 
                        
                           ∊
                        
                     , that is, the worst case error between the computed and exact 2-dimensional matching distances, is attained. Its total complexity depends on the complexity of the persistence and one-dimensional matching distance algorithms. It is known that computing persistent homology has complexity 
                        
                           O
                           (
                           
                              
                                 m
                              
                              
                                 3
                              
                           
                           )
                        
                      in the worst case, where m is the number of simplices in the complex [23]. The complexity of one-dimensional matching distance computation is 
                        
                           O
                           (
                           
                              
                                 p
                              
                              
                                 2.5
                              
                           
                           )
                        
                     , where p is the maximal number of cornerpoints allowed [11]. The grid algorithm of [2] requires in the worst case a number of computations proportional to 
                        
                           1
                           /
                           
                              
                                 ∊
                              
                              
                                 2
                              
                           
                        
                     , representing the number of grid points. Our implementation (coded in Java with help from N. Cavazza, co-author of [6] along with this paper’s authors) computes the persistence diagrams for these rank invariants using the persistent homology software JPlex [21]. In addition, constructing the suspension of a simplicial complex is linear on the number of simplices of the original complex.
                        Example 3.1
                        The contour model example is the pair of models 
                              
                                 (
                                 K
                                 ,
                                 φ
                                 )
                                 
                                 and
                                 
                                 (
                                 L
                                 ,
                                 ψ
                                 )
                              
                            shown in Fig. 4
                           , along with the persistence diagrams for 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             ψ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                              
                           . Its suspension is a two-dimensional simplicial complex embedded in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                              
                           ; sort of a simplicial version of the curve and surface seen in Fig. 1. As shown, both 
                              
                                 
                                    
                                       φ
                                    
                                    
                                       1
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       φ
                                    
                                    
                                       2
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                              
                           , take the same global minimum (in both cases 0), so we expect Eq. (13) to hold. The 2D matching distances have been computed with a tolerance 
                              
                                 ∊
                                 =
                                 0.01
                              
                           , but given the simplicity of the example their exactness is easy to show. The results of our computations can be found in the following two tables:
                              
                                 
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ρ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   q
                                                   =
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   =
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                   (
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               ψ
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.05
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.05
                                                
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                   (
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               ψ
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          0
                                          
                                             
                                                
                                                   0.05
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                   (
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               ψ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.15
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.15
                                                
                                             
                                          
                                          
                                             
                                                
                                                   d
                                                   (
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               φ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               ψ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          0
                                          
                                             
                                                
                                                   0.15
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                   (
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         φ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ψ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.15
                                                
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                   (
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         φ
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ψ
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.15
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

As seen above, 
                        
                           D
                           (
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 φ
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 ψ
                              
                              
                                 0
                              
                           
                           )
                        
                      cannot be assumed to equal 0, even if 
                        
                           
                              
                                 φ
                              
                              
                                 i
                              
                           
                           
                           and
                           
                           
                              
                                 ψ
                              
                              
                                 i
                              
                           
                        
                      take the same global minimum for 
                        
                           i
                           =
                           1
                           ,
                           2
                        
                     . We have not included the results for the reduced rank invariants for the suspended models, since they are equal to that of the non-reduced rank invariants. This is not however expected to be true in general. Fig. 5
                      further shows 
                        
                           d
                           (
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                              
                              
                                 q
                              
                           
                           ,
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                              
                              
                                 q
                              
                           
                           )
                           
                           and
                           
                           d
                           (
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       Φ
                                    
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                              
                              
                                 q
                              
                           
                           ,
                           
                              
                                 ρ
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       Ψ
                                    
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                              
                              
                                 q
                              
                           
                           )
                        
                      plotted in function of a and b, for a few interesting choices of q.
                        Example 3.2
                        The surface mesh model is shown in Fig. 6
                           . Its suspension is a three-dimensional simplicial complex embedded in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                 
                              
                           , which cannot be accurately shown without playing a video with the fourth dimension mapped to time. The measuring function 
                              
                                 φ
                                 :
                                 V
                                 (
                                 K
                                 )
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                              
                            is defined in the following way: assuming that 
                              
                                 V
                                 (
                                 K
                                 )
                                 =
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       n
                                    
                                 
                                 }
                              
                            and that c is the center of mass of K defined by taking the weighted average of the centers of each triangle, we define the principal vector
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          →
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          c
                                          )
                                          ‖
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          c
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          ‖
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          c
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 ‖
                                 ·
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                              
                            refers to the Euclidean norm. Then, let d be the line passing through c having 
                              
                                 
                                    
                                       w
                                    
                                    
                                       →
                                    
                                 
                              
                            as direction vector, and 
                              
                                 π
                              
                            be the plane passing through c having 
                              
                                 
                                    
                                       w
                                    
                                    
                                       →
                                    
                                 
                              
                            as normal vector. The function 
                              
                                 φ
                              
                            is defined as
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    1
                                    -
                                    
                                       
                                          dist
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          d
                                          )
                                       
                                       
                                          
                                             
                                                max
                                             
                                             
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                             
                                          
                                          dist
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          d
                                          )
                                       
                                    
                                 
                              
                           and
                              
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    =
                                    1
                                    -
                                    
                                       
                                          dist
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          π
                                          )
                                       
                                       
                                          
                                             
                                                max
                                             
                                             
                                                j
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                             
                                          
                                          dist
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          π
                                          )
                                       
                                    
                                    ,
                                 
                              
                           where dist refers to the Euclidean distance between a point and the line d or plane 
                              
                                 π
                              
                           . The measuring function 
                              
                                 ψ
                              
                            is defined equivalently on the vertex set 
                              
                                 V
                                 (
                                 L
                                 )
                              
                           . By the definition of the measuring functions, the absolute minima of 
                              
                                 
                                    
                                       φ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       φ
                                    
                                    
                                       2
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       2
                                    
                                 
                              
                            will all be 0. Table 1
                            shows the results of our computations. All lower bounds for the 2D matching distance are shown, in order to illustrate the comparability of results between the original and suspended models at every step in the algorithm.

Our focus in this paper is on the use of the topological suspension as a model in shape comparison by persistent homology methods. We finish with remarks showing that the main ideas can also be applied to many other topological methods in imaging with the same aim: to give an automatic way of producing examples of interesting shapes for providing quality tests of algorithms and programs that have been successfully used in low dimensions but which we now want to use with high-dimensional spaces. In this section we invite the readers to use their imagination in inventing similar models in their field of study, by pointing out examples of potential applications.

Our first example is the Morse descriptor introduced by [1] with the same aim as persistent homology, that is, to provide topological analysis and comparison of shapes. The authors directly apply their descriptors to digital images generated from photographs of hand gestures in a sign language, and to other digital objects. Rather than looking at the rank of inclusion maps of a lower sublevel set into an upper one, they consider an invariant based on the concept of the rank of the relative homology of one set modulo another. More precisely, the Morse descriptor 
                     
                        
                           
                              
                                 MD
                              
                              
                                 f
                              
                           
                           :
                           
                              
                                 Δ
                              
                              
                                 +
                              
                           
                           ×
                           N
                           →
                           N
                        
                      is defined by
                        
                           
                              
                                 
                                    MD
                                 
                                 
                                    f
                                 
                              
                              (
                              α
                              ,
                              β
                              ,
                              q
                              )
                              
                              ≔
                              
                              rank
                              
                              
                                 
                                    H
                                 
                                 
                                    q
                                 
                              
                              (
                              
                                 
                                    M
                                 
                                 
                                    β
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    α
                                 
                              
                              )
                              .
                           
                        
                     This descriptor provides somewhat different information about the shape of interest than the rank invariant studied in this paper. Indeed, it focuses on the non-trivial homology cycles remaining or created in the upper level set 
                        
                           
                              
                                 M
                              
                              
                                 β
                              
                           
                        
                      after contracting the lower level set 
                        
                           
                              
                                 M
                              
                              
                                 α
                              
                           
                        
                      to a point, while the rank invariant focuses only on the cycles of the lower level set remaining non-trivial after immersing 
                        
                           
                              
                                 M
                              
                              
                                 α
                              
                           
                        
                      to 
                        
                           
                              
                                 M
                              
                              
                                 β
                              
                           
                        
                     .

We may want to investigate data of higher dimension than the initial 2D objects studied in [1] and test results on our suspension models. The suspension functor can be applied similarly as in Section 2 by the following theorem which can be proved using the relative Mayer–Vietoris sequence [20, Exercise 2 page 145] and Lemma 2.2.
                        Theorem 4.1
                        
                           Under the terminology of Section 
                           2
                           , the isomorphism
                           
                              
                                 (17)
                                 
                                    
                                       
                                          H
                                       
                                       
                                          q
                                          +
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          (
                                          SM
                                          )
                                       
                                       
                                          β
                                       
                                    
                                    ,
                                    
                                       
                                          (
                                          SM
                                          )
                                       
                                       
                                          α
                                       
                                    
                                    )
                                    ≅
                                    
                                       
                                          H
                                       
                                       
                                          q
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          β
                                       
                                    
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          α
                                       
                                    
                                    )
                                 
                              
                           
                           holds for all 
                           
                              
                                 q
                                 ∈
                                 Z
                              
                            
                           provided that 
                           
                              
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                    
                                 
                                 
                                 ≠
                                 
                                 ∅
                              
                           
                           . If 
                           
                              
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                    
                                 
                                 =
                                 ∅
                              
                           
                           , 
                           
                              (17)
                            
                           holds for all 
                           
                              
                                 q
                                 >
                                 0
                              
                           
                           , while for 
                           
                              
                                 q
                                 =
                                 0
                                 
                                 and
                                 
                                 q
                                 =
                                 -
                                 1
                              
                            
                           we have:
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      β
                                                   
                                                
                                                ,
                                                ∅
                                                )
                                                =
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      β
                                                   
                                                
                                                )
                                                ≅
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      (
                                                      SM
                                                      )
                                                   
                                                   
                                                      β
                                                   
                                                
                                                )
                                                ⊕
                                                F
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                
                                                   
                                                      (
                                                      SM
                                                      )
                                                   
                                                   
                                                      β
                                                   
                                                
                                                ,
                                                ∅
                                                )
                                                =
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                
                                                   
                                                      (
                                                      SM
                                                      )
                                                   
                                                   
                                                      β
                                                   
                                                
                                                )
                                                ≅
                                                F
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Our next example is an image matching method presented in [13]. The method consists of estimating a transformation map between block structures (pixels, voxels, windows) of given binary images analyzed for topological correspondence, using the concept of homology of maps. The idea is to use the structure of cubical sets to represent the image data of the two compared images, respectively X and Y. One next generates the cubical chain complexes 
                        
                           C
                           (
                           X
                           )
                           
                           and
                           
                           C
                           (
                           Y
                           )
                        
                     . The authors perform experiments with three types of transformations of 2D binary images: translation, rotation, and homothety. They provide an algorithm that generates a chain map 
                        
                           φ
                           :
                           C
                           (
                           X
                           )
                           →
                           C
                           (
                           Y
                           )
                        
                      and computes the map 
                        
                           
                              
                                 H
                              
                              
                                 ∗
                              
                           
                           (
                           φ
                           )
                        
                      it induces in homology. That map carries the information on locations where important topological features (connected components or cycles) of X are carried to Y by the transformation. We believe that it is an interesting idea which has the potential of leading to algorithms for comparing shapes whose calculation time may compete with our matching distance methods.

Our model easily adapts to the described method of [13] due to the functoriality of the suspension map. Once we define the chain complexes of the suspended images SX and SY and the suspended chain map 
                        
                           S
                           φ
                           :
                           C
                           (
                           SX
                           )
                           →
                           C
                           (
                           SY
                           )
                        
                     , we get the homology map
                        
                           
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              S
                              φ
                              )
                              :
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              SX
                              )
                              →
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              SY
                              )
                              .
                           
                        
                     
                  

The only practical issue is in suitable choice of combinatorial structures. In [13,1,19], and in many other works on applications of topology to digital imaging, one uses cubical sets and cubical complexes. We refer the reader to [18, Chapter 2] for a detailed presentation of those structures as well as of the cubical homology theory. There are three main reasons behind this choice. First, it is the most appropriate for representing image pixels, voxels or, more generally, n-dimensional pixels. Second, the calculation of homology based on cubical sets is by far more efficient than that based on triangulations. Third, elementary cubes have this nice property that the product of two elementary cubes is also an elementary cube of higher dimension, while the product of two simplices is not in general a simplex. However, the suspension operation is based on contracting a subset of a cylinder to a single point (a vertex of a cone), and thus it produces a polyhedral set which is no longer a cubical set. Luckily, the efficient cubical homology algorithms may still be applied by using relative homology, thus one may avoid triangulating the suspended set. In brief, the relative homology of a pair of cubical sets gives the same information as the homology of the set obtained by contracting a subset to a single point, so the actual contraction does not need to be realized in practice. The idea is illustrated by Fig. 7
                     . More explicitly, we have the isomorphism:
                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    ∗
                                 
                              
                              (
                              SX
                              )
                              ≅
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              Σ
                              X
                              ,
                              [
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ]
                              )
                              ≅
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              X
                              ×
                              [
                              -
                              1
                              ,
                              1
                              ]
                              ,
                              [
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ]
                              )
                           
                        
                     where 
                        
                           [
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           ]
                           =
                           X
                           ×
                           {
                           -
                           1
                           ,
                           1
                           }
                           ∪
                           {
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                           }
                           ×
                           [
                           -
                           1
                           ,
                           1
                           ]
                        
                      is the equivalence class of the chosen base point 
                        
                           
                              
                                 x
                              
                              
                                 0
                              
                           
                        
                      of X under the relation defining 
                        
                           Σ
                           X
                        
                     . Given a pair of cubical sets 
                        
                           A
                           ⊂
                           X
                        
                     , we get
                        
                           (19)
                           
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              SX
                              ,
                              SA
                              )
                              ≅
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              Σ
                              X
                              ,
                              Σ
                              A
                              )
                              ≅
                              
                                 
                                    H
                                 
                                 
                                    ∗
                                 
                              
                              (
                              X
                              ×
                              [
                              -
                              1
                              ,
                              1
                              ]
                              ,
                              X
                              ×
                              {
                              -
                              1
                              ,
                              1
                              }
                              ∪
                              A
                              ×
                              [
                              -
                              1
                              ,
                              1
                              ]
                              )
                              .
                           
                        
                     Similarly, one can deal with the relative homology of sublevel sets of the suspended space.

We leave up to the reader’s imagination further examples of problems where our model can be applied. We also believe that other topological operations than the suspension might also be found to be of interest in imaging.

We now sketch, for the interested reader, proofs for some of the theorems we used in this paper. These proofs are original work by the authors.
                        Proof of Lemma 2.2
                        If 
                              
                                 α
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                              
                            is the absolute minimum of f, then we obviously have 
                              
                                 S
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                    
                                 
                              
                           .

Let 
                              
                                 EM
                                 =
                                 M
                                 ×
                                 [
                                 -
                                 1
                                 ,
                                 1
                                 ]
                                 
                                 and
                                 
                                 
                                    
                                       (
                                       EM
                                       )
                                    
                                    
                                       α
                                    
                                 
                              
                            be the sublevel set of Ef. We first assume that 
                              
                                 α
                              
                            is a regular value and construct a strong deformation 
                              
                                 h
                                 :
                                 X
                                 ×
                                 [
                                 0
                                 ,
                                 1
                                 ]
                                 →
                                 X
                              
                            of the set
                              
                                 
                                    X
                                    =
                                    
                                       
                                          (
                                          EM
                                          )
                                       
                                       
                                          α
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             M
                                             ×
                                             {
                                             -
                                             1
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                 
                              
                           onto
                              
                                 
                                    A
                                    =
                                    E
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          α
                                       
                                    
                                    )
                                    ∪
                                    
                                       
                                          
                                             M
                                             ×
                                             {
                                             -
                                             1
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                    .
                                 
                              
                           These sets are illustrated in Fig. 2. Forcingly, we must have 
                              
                                 h
                                 (
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 ,
                                 λ
                                 )
                                 =
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            for all 
                              
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 ∈
                                 A
                              
                            and all 
                              
                                 λ
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . Hence, it is enough to continuously extend h to 
                              
                                 (
                                 X
                                 ⧹
                                 A
                                 )
                                 ×
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . By the hypothesis that 
                              
                                 α
                              
                            is regular, the gradient vector field 
                              
                                 -
                                 ∇
                                 Ef
                              
                            defines a flow 
                              
                                 t
                                 
                                 ↦
                                 
                                 φ
                                 (
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 ,
                                 t
                                 )
                              
                            on 
                              
                                 
                                    
                                       X
                                       ⧹
                                       A
                                    
                                    
                                       ‾
                                    
                                 
                              
                            such that the values of Ef decrease along its trajectories. In the absence of critical points, any 
                              
                                 (
                                 x
                                 ,
                                 s
                                 )
                                 ∈
                                 
                                    
                                       X
                                       ⧹
                                       A
                                    
                                    
                                       ‾
                                    
                                 
                              
                            is sent by 
                              
                                 φ
                              
                            to A in a finite time 
                              
                                 t
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                           . By standard arguments from the dynamical systems theory, 
                              
                                 t
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                            is a continuous function of 
                              
                                 (
                                 x
                                 ,
                                 s
                                 )
                              
                           .

We extend h to 
                              
                                 (
                                 X
                                 ⧹
                                 A
                                 )
                                 ×
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                            by the formula
                              
                                 
                                    h
                                    (
                                    (
                                    x
                                    ,
                                    s
                                    )
                                    ,
                                    λ
                                    )
                                    
                                    ≔
                                    
                                    φ
                                    
                                       
                                          
                                             (
                                             x
                                             ,
                                             s
                                             )
                                             ,
                                             λ
                                             t
                                             (
                                             x
                                             ,
                                             s
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           It is easily verified that h is a strong deformation retraction of X onto A. Since, for each 
                              
                                 λ
                                 ,
                                 h
                                 (
                                 ·
                                 ,
                                 λ
                                 )
                              
                            is the identity map on 
                              
                                 M
                                 ×
                                 {
                                 -
                                 1
                                 ,
                                 1
                                 }
                                 ⊂
                                 A
                                 ,
                                 h
                              
                            extends to the deformation 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ̃
                                    
                                 
                                 :
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                    
                                 
                                 ×
                                 [
                                 0
                                 ,
                                 1
                                 ]
                                 →
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                    
                                 
                              
                            by applying the quotient map. In particular, we have the homotopy equivalence 
                              
                                 S
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                                 )
                                 ≅
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                    
                                 
                              
                            for a regular value 
                              
                                 α
                              
                           .

Now let 
                              
                                 α
                              
                            be a critical value, other than the absolute minimum 
                              
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                              
                            which is already taken care of. Since it is isolated, there exists 
                              
                                 ∊
                                 >
                                 0
                              
                            such that all values in 
                              
                                 (
                                 α
                                 ,
                                 α
                                 +
                                 ∊
                                 ]
                              
                            are regular. It is known from the classical Morse theory that 
                              
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                              
                            is a strong deformation retract of 
                              
                                 
                                    
                                       M
                                    
                                    
                                       α
                                       +
                                       ∊
                                    
                                 
                              
                           . Therefore, 
                              
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                                 ≅
                                 
                                    
                                       M
                                    
                                    
                                       α
                                       +
                                       ∊
                                    
                                 
                              
                           , hence 
                              
                                 S
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                                 )
                                 ≅
                                 S
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       α
                                       +
                                       ∊
                                    
                                 
                                 )
                              
                           . By the same argument, 
                              
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                    
                                 
                                 ≅
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                       +
                                       ∊
                                    
                                 
                              
                           . By the preceding construction, 
                              
                                 S
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       α
                                       +
                                       ∊
                                    
                                 
                                 )
                                 ≅
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                       +
                                       ∊
                                    
                                 
                              
                           . By transitivity, 
                              
                                 S
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                                 )
                                 ≅
                                 
                                    
                                       (
                                       SM
                                       )
                                    
                                    
                                       α
                                    
                                 
                              
                           .□

Eq. (5) is a consequence of (1), Lemma 2.2, and the functoriality of the suspension operation. Eq. (6) is an obvious consequence. Eq. (8) follows from the fact that 
                              
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                              
                            is the absolute minimum of the function at which a 0th order homological generator of infinite persistence is born. For proving Eq. (7), the above arguments carry over to prove the commutativity of the diagram:


                           
                              
                                 
                              
                           
                        

To complete the proof, let 
                              
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       n
                                    
                                 
                              
                            be representative vertices of a basis of 
                              
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                              
                            homology generators for 
                              
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       m
                                    
                                 
                              
                            be those of a basis for 
                              
                                 
                                    
                                       M
                                    
                                    
                                       β
                                    
                                 
                              
                           . We have
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          α
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          ⊕
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    F
                                    [
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    ]
                                    ⊕
                                    F
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    ]
                                    =
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          α
                                       
                                    
                                    )
                                    ⊕
                                    F
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          0
                                       
                                    
                                    ]
                                 
                              
                           and the same holds true for 
                              
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       β
                                    
                                 
                                 )
                              
                            with respect to 
                              
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                              
                           ’s. The conclusion is reached by carrying the presented direct sum decomposition of the spaces to the isomorphisms shown by vertical arrows in the diagram and comparing their ranks.

Since 
                              
                                 Σ
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                              
                            is homotopy equivalent to 
                              
                                 
                                    
                                       SM
                                    
                                    
                                       α
                                    
                                 
                              
                            for each 
                              
                                 α
                              
                           , the arguments carry over to 
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       1
                                    
                                 
                                 f
                              
                           .□

Eqs. (9) and (10) are direct corollaries, respectively, of (5) and (6). Now Eq. (12) derives from (8), which signifies that the rank invariant function 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       f
                                    
                                    
                                       0
                                    
                                 
                              
                            has a single cornerpoint 
                              
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 ∞
                                 )
                              
                           . Similarly, 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       g
                                    
                                    
                                       0
                                    
                                 
                              
                            has only one cornerpoint 
                              
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 ∞
                                 )
                              
                           . It follows that 
                              
                                 d
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       g
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 |
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 |
                              
                           .

To prove Eq. (11), see that from (7), the rank invariant functions 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       f
                                    
                                    
                                       1
                                    
                                 
                              
                            differ only in that the former has one cornerpoint at infinity with the value 
                              
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                              
                            which the latter does not have. Similarly, 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       g
                                    
                                    
                                       0
                                    
                                 
                              
                            has a cornerpoint 
                              
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 ∞
                                 )
                              
                            not present in 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       g
                                    
                                    
                                       1
                                    
                                 
                              
                           . Therefore, the computation of 
                              
                                 d
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            requires computing the bottleneck distance between two proper subsets of the points involved in the computation of 
                              
                                 d
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       g
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           . Eq. (11) follows. However, in the case where 
                              
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                              
                           , these two cornerpoints at infinity, differing by 0, will be matched in the optimal bijection between the sets of cornerpoints of 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       g
                                    
                                    
                                       0
                                    
                                 
                              
                            and will not influence the value of 
                              
                                 d
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       g
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           . From this, and Eqs. (10) and (12), (13) follows.□


                           
                              
                                 D
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                       
                                       φ
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                       
                                       ψ
                                    
                                 
                                 )
                              
                            is obtained as the supremum over admissible pairs of 
                              
                                 d
                                 (
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             red
                                          
                                          
                                             (
                                             
                                                
                                                   l
                                                
                                                
                                                   →
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   k
                                                
                                             
                                             φ
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       
                                          
                                             red
                                          
                                          
                                             (
                                             
                                                
                                                   l
                                                
                                                
                                                   →
                                                
                                             
                                             ,
                                             
                                                
                                                   b
                                                
                                                
                                                   →
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   k
                                                
                                             
                                             ψ
                                          
                                       
                                    
                                 
                                 )
                              
                            (with the obvious change for the reduced rank invariants). Let us fix a particular pair 
                              
                                 (
                                 
                                    
                                       l
                                    
                                    
                                       →
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       →
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       Adm
                                    
                                    
                                       k
                                    
                                 
                              
                           . It is obvious from definitions that 
                              
                                 
                                    
                                       red
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                       
                                       φ
                                    
                                 
                                 (
                                 v
                                 )
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       red
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       φ
                                    
                                 
                                 )
                                 (
                                 v
                                 )
                                 =
                                 
                                    
                                       red
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       φ
                                    
                                 
                                 (
                                 v
                                 )
                              
                            for all 
                              
                                 v
                                 ∈
                                 V
                                 (
                                 K
                                 )
                              
                           . Now, 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       red
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       φ
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ⩾
                                 
                                    
                                       red
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                       
                                       φ
                                    
                                 
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       max
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       i
                                       ,
                                       0
                                    
                                 
                                 -
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 /
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 j
                                 =
                                 0
                                 ,
                                 1
                              
                           .

However, the appearance of 
                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                              
                            in the sublevel filtration for the function 
                              
                                 
                                    
                                       red
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                       
                                       φ
                                    
                                 
                              
                            before their appearance for the function 
                              
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       red
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       φ
                                    
                                 
                                 )
                              
                            does not affect their rank invariants of order 1 or greater, which will be identical. This along with Theorem 2.5 and the application of linear interpolation to 
                              
                                 
                                    
                                       red
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       φ
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       red
                                    
                                    
                                       (
                                       
                                          
                                             l
                                          
                                          
                                             →
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             →
                                          
                                       
                                       )
                                    
                                    
                                       ψ
                                    
                                 
                              
                            allows us to show that
                              
                                 
                                    d
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         φ
                                                      
                                                   
                                                
                                                
                                                   q
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ψ
                                                      
                                                   
                                                
                                                
                                                   q
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    d
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         φ
                                                      
                                                   
                                                   )
                                                
                                                
                                                   q
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ψ
                                                      
                                                   
                                                   )
                                                
                                                
                                                   q
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    d
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         φ
                                                      
                                                   
                                                
                                                
                                                   q
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ψ
                                                      
                                                   
                                                
                                                
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    q
                                    ⩾
                                    0
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    d
                                    
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         φ
                                                      
                                                   
                                                
                                                
                                                   q
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ψ
                                                      
                                                   
                                                
                                                
                                                   q
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    d
                                    
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         φ
                                                      
                                                   
                                                   )
                                                
                                                
                                                   q
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ψ
                                                      
                                                   
                                                   )
                                                
                                                
                                                   q
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    d
                                    
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         φ
                                                      
                                                   
                                                
                                                
                                                   q
                                                
                                             
                                             ,
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ψ
                                                      
                                                   
                                                
                                                
                                                   q
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    q
                                    ⩾
                                    1
                                    ,
                                 
                              
                           and
                              
                                 
                                    d
                                    
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         φ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ψ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    =
                                    d
                                    
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         φ
                                                      
                                                   
                                                   )
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ψ
                                                      
                                                   
                                                   )
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    d
                                    
                                       
                                          
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         φ
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   ρ
                                                
                                                
                                                   
                                                      
                                                         red
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ψ
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           yielding formulas (14)–(16).□

@&#REFERENCES@&#

