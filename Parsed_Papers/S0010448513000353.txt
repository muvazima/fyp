@&#MAIN-TITLE@&#Handling missing values and unmatched features in a CBR system for hydro-generator design

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Case base is constructed based on domain ontology to improve retrieval efficiency.


                        
                        
                           
                           Case representation is proposed and cases are represented by a unified tree model.


                        
                        
                           
                           The cost function is proposed to measure the semantic difference between two cases.


                        
                        
                           
                           The similarity function is defined based on the cost function.


                        
                        
                           
                           Experiments are executed to evaluate the performance of the proposed CBR system.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

CBR

Missing value

Unmatched feature

Hydro-generator design

@&#ABSTRACT@&#


               
               
                  Hydro-generator design is a complex problem and case based reasoning (CBR) can improve its efficiency, but there are missing values and unmatched features which decrease the accuracy of CBR. In order to solve the problems brought by missing values and unmatched features, a similarity measurement is proposed by improving the edit distance which is widely used as a similarity measurement. In the proposed CBR system, the case base is constructed based on domain ontology to improve the retrieval efficiency. Then a case representation is proposed and cases are represented by a unified tree model. Next, by combining the edit distance with feature weights and the semantic meanings of case nodes, the cost function is proposed to measure the semantic difference and the conditions which make it a metric are discussed. Lastly, the similarity function is defined based on the cost function. A case study is presented to illustrate the use of the proposed CBR system, and then the experiments are executed to evaluate its performance in dealing with missing values and unmatched features respectively. The results validate that the proposed CBR system can handle missing values and unmatched features effectively.
               
            

@&#INTRODUCTION@&#

Hydro-generator design is a complex problem which consists of a rotor, stator, electromagnetic design, and so on. There are massive parameters in the process of design and the model of the hydro-generator is complicated, so plenty of domain knowledge is required in traditional design which designs the hydro-generator step by step according to design handbooks, and the design period is time-consuming. In addition, there is abundant experience which may not be in design handbooks. Case based reasoning (CBR) is useful and effective if similar design requirements take place. CBR is an approach which solves a new problem by retrieving past cases and revising their solutions. If CBR is utilized in hydro-generator design, it can avoid repeated design, save time and guarantee the design is reasonable.

There are several advantages of CBR: (1) it has a relatively small computation cost of incremental learning [1]; (2) it does not rely on statistical assumptions and its justifications are human-understandable [2]; (3) it does not require an explicit domain model in case retrieval [3], for example, the designers have no need to know about the structure of hydro-generator exactly when they use CBR to retrieve the most similar case. But as for the construction of case base or case representation, the domain model may be required.

CBR is widely used in many fields, such as fixture design [4], failure mechanisms identification [5], assembly process design [6], injection mould design [7], engine ignition system diagnosis [8], welding fixture design [9], hydraulic circuit design [10], ship structure design [11], and so on. The process of CBR is shown in Fig. 1
                     .

The CBR process contains four steps: retrieve, reuse, revise and retain, which are represented by text boxes in Fig. 1. A lot of researches have been carried out on CBR, and they emphasize on different aspects, such as the construction of the case base [12], feature selection [13], case representation [6,14], feature weighting method [15,16], revise method [6,10], and so on.

The most important step of CBR is case retrieval, and there are some problems in practical application, such as missing values and unmatched features. As for missing values, there are several approaches. Agre [17] uses the number of possible feature values to estimate the feature distance between two cases, and the distance is represented as 
                        
                           
                              
                                 dis
                              
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        
                        =
                        1
                        /
                        
                           
                              L
                           
                           
                              i
                           
                        
                        ×
                        
                           (
                           1
                           −
                           1
                           /
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                           )
                        
                     , where 
                        
                           
                              L
                           
                           
                              i
                           
                        
                      is the number of possible values of the 
                        i
                     -th feature. Gu, Tong, Aamodt [18] and Surma [19] use the following equation to calculate the distance between two case features with missing values: 
                        
                           dis
                        
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        
                        =
                        1
                     , if 
                        
                           
                              x
                           
                           
                              i
                           
                        
                      or 
                        
                           
                              y
                           
                           
                              i
                           
                        
                      is unknown. Ricci and Avesani [20] calculate the similarity according to the following equation: 
                        
                           sim
                        
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        
                        =
                        0.5
                     , if 
                        
                           
                              x
                           
                           
                              i
                           
                        
                      or 
                        
                           
                              y
                           
                           
                              i
                           
                        
                      is unknown. Hruschaka and Ebecken [21] substitute the missing values by the corresponding feature value of the most similar complete case. Zhong, Guo, Ye, etc. [22] define a “missing degree” conception based on feature weights to describe the missing grade of the feature values. According to these literatures, we can see that most of these approaches use a fixed value or an estimated value to represent the distance between two case features with missing values. However, these methods do not have a unified support model. The distance between two features with missing values can be set as 1, 0.5 or some other values in different approaches, while all these approaches are effective. Then there are two problems: one is the value range of the fixed or estimated distances between two features with missing values; and the other is that there are a number of choices, but there is no principle for designers to determine which value is suitable in practice.

In case retrieval, most of the similarity measurements are based on distance, and there are some distances, such as Euclidean distance which is represented as 
                        
                           dis
                        
                        
                           (
                           X
                           ,
                           Y
                           )
                        
                        =
                        
                           
                              
                                 [
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    dis
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                           
                           
                              1
                              /
                              2
                           
                        
                      and Manhattan distance which is 
                        
                           dis
                        
                        
                           (
                           X
                           ,
                           Y
                           )
                        
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              N
                           
                        
                        
                           |
                           
                              dis
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           |
                        
                     , where 
                        
                           dis
                        
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        
                      is the normalized distance which is represented as 
                        
                           dis
                        
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        
                        =
                        
                           |
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           −
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           |
                        
                        /
                        
                           |
                           
                              
                                 max
                              
                              
                                 i
                              
                           
                           −
                           
                              
                                 min
                              
                              
                                 i
                              
                           
                           |
                        
                     . Although these distances are different, they all require that the features of two cases should be in one-to-one correspondence. However, sometimes it needs to retrieve in different products because they are similar, while different products have different features. That is, the features of different products may not be in one-to-one correspondence. For example, supposing that product1 and product2 are similar, and one case in product1 has features A, B and C, while the other case in product2 has features A, B and D, so the features C and D are unmatched features. The conventional distances cannot be utilized directly in this situation. The unmatched features should be eliminated firstly, and then conventional distances can be utilized. However, the conventional distances only use features A and B, so some useful information is ignored.

In this study, the similarity function which is different from the conventional distances is proposed to solve the problems of missing values and unmatched features, and it is based on the edit distance which is used as a similarity measurement. This paper is structured as follows. Section 2 introduces the edit distance. Section 3 details the proposed CBR system. Firstly, the case base is constructed based on domain ontology. Then the case representation is introduced. Next, the cost function based on the edit distance is defined to measure the semantic difference between two cases, and the conditions which make it a metric are discussed. Subsequently, the similarity function is proposed based on the cost function and its calculation algorithm is introduced. In Section 4, a case study is presented and the performance evaluations for the proposed system in dealing with missing values and unmatched features are implemented respectively. Section 5 draws the conclusion.

The edit distance which is also known as Levenshtein distance [23] is utilized to describe the difference between two strings originally. It is the minimum total number of edit operations which have to be applied to edit one string into the other and the edit operations contain insertion operation, deletion operation and substitution operation. The edit distance has been extended from string to graph. The edit distance is widely used in many fields, such as relational clustering [24], document clustering [25], structural pattern classification [26], shape recognition [27], handwritten character recognition [28], image categorization [29], the matching of tree ring sequences [30], and so on.

As for string, given an alphabet 
                        V
                     , the string 
                        t
                      is composed of an ordered sequence of letters from 
                        V
                      of finite length [26], and 
                        ε
                      denotes the empty string. Then three edit operations are defined. Insertion operation 
                        
                           (
                           ε
                           →
                           v
                           )
                        
                      denotes that letter 
                        v
                      is inserted into a string. For example, transformation “beuty” to “beauty” is inserting letter “a”. Deletion operation 
                        
                           (
                           u
                           →
                           ε
                           )
                        
                      denotes letter 
                        u
                      is removed from a string, such as transformation “beauty” to “beuty”. Substitution operation 
                        
                           (
                           u
                           →
                           v
                           )
                        
                      means a letter 
                        u
                      is replaced by letter 
                        v
                     , such as transformation “beauty” to “beeuty”. The edit distance between string 
                        
                           
                              t
                           
                           
                              1
                           
                        
                      and string 
                        
                           
                              t
                           
                           
                              2
                           
                        
                      is defined as the minimum total number of insertion operations 
                        I
                     , deletion operations 
                        D
                      and substitution operations 
                        S
                     , that is, 
                        E
                        D
                        
                           (
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           )
                        
                        =
                        
                           
                              min
                           
                           
                              j
                           
                        
                        
                           [
                           I
                           
                              (
                              j
                              )
                           
                           +
                           D
                           
                              (
                              j
                              )
                           
                           +
                           S
                           
                              (
                              j
                              )
                           
                           ]
                        
                     .

The graph edit distance is similar to string edit distance. Because graph is composed of node and edge, there are 6 edit operations in the graph, which are node insertion operation 
                        
                           (
                           ε
                           →
                           v
                           )
                        
                     , node deletion operation 
                        
                           (
                           u
                           →
                           ε
                           )
                        
                     , node substitution operation 
                        
                           (
                           u
                           →
                           v
                           )
                        
                     , edge insertion operation 
                        ε
                        →
                        
                           (
                           p
                           ,
                           q
                           )
                        
                     , edge deletion operation 
                        
                           (
                           p
                           ,
                           q
                           )
                        
                        →
                        ε
                     , and edge substitution operation 
                        
                           (
                           p
                           ,
                           q
                           )
                        
                        →
                        
                           (
                           r
                           ,
                           s
                           )
                        
                     , where 
                        u
                        ,
                        v
                      denote the nodes, and 
                        
                           (
                           p
                           ,
                           q
                           )
                        
                      denotes the edge between nodes 
                        p
                      and 
                        q
                     . The graph edit distance is also defined as the minimum total number of edit operations.

In this study, the edit distance is introduced into CBR because it can measure the difference between two patterns which are not of equal length, and this advantage can be utilized to handle the problems of missing values and unmatched features.

The elements of the proposed CBR system contain three parts: (1) construction of case base; (2) case representation and (3) similarity measurement. The implementations are presented as the following.

There are abundant cases in the case base and CBR is an incremental learning approach, so the computational complexity is high if it calculates the similarities between query case and all cases in the case base in every case retrieval. A good method of organizing and storing cases would reduce the number of cases that must be matched and avoid unnecessary similarity calculations in case retrieval. Thus, it is a key problem for CBR that how to organize the abundant cases so that the retrieval is efficient, and the domain ontology is utilized to construct the case base in this study.

Domain ontology can be utilized to describe the knowledge of one specific domain, and it is composed of classes (or concepts) and a class represents a type of product. The classes in domain ontology have relationships with each other, such as the inheritance relationship. There are cases of different types of products in the case base, and the construction contains three steps: (i) identifying all the classes of products; (ii) analyzing the relationship between classes and constructing the class tree; (iii) linking cases to the class which these cases belong to. Take the hydraulic turbine for example, the structure of its case base is shown in Fig. 2
                        .

In Fig. 2, class is represented by a text box with three parts and the top part is the class name while the contents in the other two parts are hidden. The hollow arrow which represents the inheritance relationship is directed from subclass to superclass. The case is represented by a box and the case name is underlined. The domain ontology is a hydraulic turbine, and different types of hydraulic turbine products are classes. All the cases are linked to corresponding classes. Generally, all the cases are linked to leaf class. Because the child class inherits from its parent class, the cases which belong to a child class also belong to a parent class. The aim of the case base is to improve the efficiency of case retrieval. The cases are classified into different classes, so the CBR system only needs to retrieve classes which satisfy the design requirements in case retrieval. Otherwise, it has to traverse all the cases in the case base every time. It reduces the number of cases that must be matched and also reduces the chance of retrieving wrong cases by partitioning the case base.

A hydro-generator is composed of a number of components, such as a rotor and stator, and some components contain subcomponents and parts, for example, a brush is a subcomponent of a rotor. So the structure of a hydro-generator is a layered tree. In order to describe this structure clearly, all the cases are represented by trees. As the structure of hydro-generator, the case of hydro-generator should be divided into some subcases which represent components or parts, and some subcases may have their subcases. Every subcase has a set of features, so all the features are classified into different levels. Thus, the structure of a case is similar to the structure of a tree. Then all the cases are represented by a unified tree model. The tree model of the case is shown in Fig. 3
                        .

The blue text box represents the component or part of a hydro-generator, the orange circle represents a feature, and the green text box represents value. In the tree model, every blue text box is the root node of a subtree and all subtrees have the same structure. Every tree has a Class node which represents the class this component belongs to and a Description node which contains the features and its subcomponents are also taken as features. The case tree of a hydro-generator is composed of these subtrees. Due to this, the features form a layered model. The tree model in Fig. 3 has 
                           H
                         layers, and every feature has a weight, such as 
                           
                              
                                 w
                              
                              
                                 p
                                 ,
                                 q
                              
                              
                                 n
                              
                           
                        , where 
                           n
                         represents its parent component, and 
                           p
                         represents the layer where this feature is. The subcomponents also have weights. The weight is a number in the interval [0, 1], and its value depends on the structure of case tree. The sum of the weights of features and subcomponents which have a same parent node equals one. For example, components Shaft, Brush and features speed, runaway speed are all the rotor’s child nodes, so the sum of their weights equals one, that is, 
                           
                              
                                 w
                              
                              
                                 2
                                 ,
                                 1
                              
                              
                                 1
                              
                           
                           +
                           ⋯
                           +
                           
                              
                                 w
                              
                              
                                 2
                                 ,
                                 n
                              
                              
                                 1
                              
                           
                           =
                           1
                        . All the features have values. The value node is in the same layer with its feature node and it has the same weight.

The most important step in CBR is case retrieval, and its key problem is the similarity measurement. In order to solve the problems of missing values and unmatched features, the cost function and similarity function are proposed based on the edit distance, and the details are shown as follows.

The edit distance can be utilized to measure the similarity, but it can only measure the structural difference, that is, how the structures of two case trees are different from each other. The edit distance between two case trees are the number of different nodes between them. But the nodes in hydro-generator case trees have semantic meanings, that is, different nodes represent different components or features. Thus, the changes of structure would bring the changes of semantic meanings, and this is the semantic difference. The structural difference is not enough, and the semantic difference should be measured. So the cost function is proposed.

Case tree is also composed of node and edge, that is, 
                              
                                 Tree
                              
                              =
                              
                                 {
                                 V
                                 ,
                                 G
                                 }
                              
                           , where 
                              V
                            and 
                              G
                            denote the sets of nodes and edges. But there is no direction or attribute on the edge in case tree, so the edge edit operations can be ignored. Then a case tree can be represented by a set of ordered nodes which is 
                              V
                              =
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                           , where 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    m
                                 
                              
                            denote the nodes. 
                              Definition 1
                              Insertion operation 
                                    
                                       Insert
                                    
                                    
                                       (
                                       V
                                       ,
                                       v
                                       ,
                                       j
                                       )
                                    
                                 , where 
                                    V
                                  denotes the case tree, 
                                    v
                                  denotes the node to be inserted, and 
                                    j
                                  is the position where the new node to be inserted.


                           
                              Definition 2
                              Deletion operation 
                                    
                                       Delete
                                    
                                    
                                       (
                                       V
                                       ,
                                       
                                          Tree
                                       
                                       
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 , where 
                                    V
                                  denotes the case tree, 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                  represents the node to be deleted, and 
                                    
                                       Tree
                                    
                                    
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                  denotes the subtree whose root node is 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                 . If 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                  is a leaf node, then 
                                    
                                       Tree
                                    
                                    
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                 ; else, 
                                    
                                       Tree
                                    
                                    
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                  contains node 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                  and all its descendant nodes.


                           
                              Definition 3
                              Substitution operation 
                                    
                                       Substitute
                                    
                                    
                                       (
                                       V
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       v
                                       )
                                    
                                 , where 
                                    V
                                  denotes the case tree which is going to be edited, 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                  is the node to be substituted, and 
                                    v
                                  is the new node.

Compared with the edit distance, the cost function should consider two aspects. On one hand, the costs of different edit operations all equal one in the edit distance, but different edit operations may produce different costs, for example, as for a very important node, deleting it may bring more difference than substituting it. On the other hand, even if the same edit operation is executed on different nodes, the costs may be different. For example, substituting an important node would bring more difference than substituting an unimportant node. This kind of difference is called semantic difference because it depends on the semantic meanings of nodes and edit operations.

As for the first aspect, the costs of insertion operation, deletion operation and substitution operation are respectively set as 
                              I
                              ,
                              D
                              ,
                              S
                           , and 
                              I
                              ,
                              D
                              ,
                              S
                              ≥
                              1
                           . The features are assigned weights in case tree and editing different feature or value nodes may bring different costs, so the cost function should take the weights into account. Thus, a new edit operation of case tree which is weight modification is defined. The costs of edit operations can be represented by function 
                              g
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , which is 
                              
                                 (1)
                                 
                                    g
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                I
                                             
                                             
                                                
                                                   insertion
                                                
                                             
                                          
                                          
                                             
                                                D
                                                
                                                   (
                                                   n
                                                   )
                                                
                                             
                                             
                                                
                                                   deletion
                                                
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                
                                                   substitution
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   weight
                                                
                                             
                                          
                                       
                                    
                                    
                                    I
                                    ,
                                    D
                                    ,
                                    S
                                    ≥
                                    1
                                    ,
                                    
                                    n
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          ∗
                                       
                                    
                                    .
                                 
                              
                           
                        

The costs of deletion operation are 
                              D
                              
                                 (
                                 n
                                 )
                              
                           , where 
                              n
                            denotes the number of nodes to be deleted, and 
                              D
                            are the costs of deleting one node. If the node to be deleted is a leaf node, then 
                              n
                              =
                              1
                           , else, 
                              n
                            is the number of nodes of the subtree.

As for the second aspect, different types of nodes are assigned different cost coefficients. All the nodes can be classified into four types, which are class nodes, keyword nodes, feature nodes, and value nodes, and feature nodes contain subcomponent nodes. The class nodes and keyword nodes are utilized to describe the product which this case belongs to, and they are not used in similarity calculation, so the cost coefficients of them are usually set as zero. In addition, because the feature and value nodes are layered, the level of these nodes should be considered. The cost coefficient 
                              K
                            can be defined as 
                              
                                 (2)
                                 
                                    K
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                h
                                                ⋅
                                                f
                                             
                                             
                                                
                                                   feature
                                                
                                             
                                          
                                          
                                             
                                                h
                                                ⋅
                                                v
                                             
                                             
                                                
                                                   value
                                                
                                             
                                          
                                       
                                    
                                    
                                    f
                                    ,
                                    v
                                    ≥
                                    1
                                    ;
                                    
                                    h
                                    =
                                    H
                                    −
                                    t
                                    +
                                    1
                                    ;
                                    
                                    t
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    H
                                    .
                                 
                              
                           
                        

The variable 
                              h
                            represents the influence of level, 
                              H
                            is the total number of layers, and 
                              t
                            is the layer where this feature node or value node is. Apparently, the cost coefficients of upper layer nodes are bigger than those of lower layer nodes. 
                              Definition 4
                              Cost function 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 , supposing that the set of all the possible edit operation sequences which transform 
                                    
                                       
                                          
                                             Tree
                                          
                                       
                                       
                                          1
                                       
                                    
                                  into 
                                    
                                       
                                          
                                             Tree
                                          
                                       
                                       
                                          2
                                       
                                    
                                  is 
                                    
                                       editset
                                    
                                    =
                                    ⋃
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                 , where 
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                  is the 
                                    i
                                 -th edit operation sequence. 
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                Insert
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                Delete
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                Substitute
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                Weight
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             R
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 , where 
                                    
                                       
                                          
                                             Insert
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             Delete
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             Substitute
                                          
                                       
                                       
                                          i
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Weight
                                          
                                       
                                       
                                          i
                                       
                                    
                                  respectively denote four types of edit operations of 
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                 , and 
                                    
                                       
                                          R
                                       
                                       
                                          i
                                       
                                    
                                  is the sequence of these edit operations. Then the cost function is defined as 
                                    
                                       (3)
                                       
                                          
                                             Cost
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      Tree
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             →
                                             
                                                
                                                   
                                                      Tree
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                min
                                             
                                             
                                                i
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   ∑
                                                
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                
                                                   L
                                                
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   l
                                                
                                             
                                             ⋅
                                             
                                                
                                                   g
                                                
                                                
                                                   l
                                                
                                             
                                             ⋅
                                             F
                                             
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      l
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                          =
                                          
                                             
                                                min
                                             
                                             
                                                i
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             I
                                             ⋅
                                             
                                                
                                                   w
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             D
                                             ⋅
                                             
                                                
                                                   w
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             S
                                             ⋅
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                
                                                ¯
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             
                                                Δ
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          =
                                          
                                             
                                                min
                                             
                                             
                                                i
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             f
                                             ⋅
                                             
                                                
                                                   g
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             F
                                             
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             v
                                             ⋅
                                             
                                                
                                                   g
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             F
                                             
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                  where 
                                    
                                       
                                          N
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          M
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    L
                                 , and 
                                    
                                       (4)
                                       
                                          F
                                          
                                             (
                                             w
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      
                                                         insertion or deletion
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         ¯
                                                      
                                                   
                                                   
                                                      
                                                         substitution
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Δ
                                                      
                                                      w
                                                   
                                                   
                                                      
                                                         weight
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                w
                                             
                                             ¯
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   n
                                                   e
                                                   w
                                                
                                             
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   o
                                                   l
                                                   d
                                                
                                             
                                             )
                                          
                                          /
                                          2
                                          ;
                                          
                                             Δ
                                          
                                          w
                                          =
                                          
                                             |
                                             
                                                
                                                   w
                                                
                                                
                                                   n
                                                   e
                                                   w
                                                
                                             
                                             −
                                             
                                                
                                                   w
                                                
                                                
                                                   o
                                                   l
                                                   d
                                                
                                             
                                             |
                                          
                                          .
                                       
                                    
                                 
                              

The cost function is the minimum of the total costs of edit operation sequences, and that sequence is called the shortest edit path. The cost function is expanded in three versions. In the first version, 
                              
                                 
                                    K
                                 
                                 
                                    l
                                 
                              
                            denotes the cost coefficient of a node and 
                              
                                 
                                    g
                                 
                                 
                                    l
                                 
                              
                            denotes the costs of an edit operation. 
                              F
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       l
                                    
                                 
                                 )
                              
                            denotes the calculation of weight and is defined in Eq. (4). Its value depends on the type of edit operations and the cost function is expanded according to different edit operations in the second version, so 
                              F
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       l
                                    
                                 
                                 )
                              
                            is calculated according to edit operations. As for the insertion operation, 
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                            is the weight of the node which is inserted into 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    2
                                 
                              
                           ; as for the deletion operation, 
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            is the weight of the node which is deleted from 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    1
                                 
                              
                           . In substitution operation, 
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ¯
                              
                            is the average weight of the node which is substituted, and 
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ¯
                              
                              =
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       o
                                       l
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       n
                                       e
                                       w
                                    
                                 
                                 )
                              
                              /
                              2
                           , where 
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    o
                                    l
                                    d
                                 
                              
                            and 
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    n
                                    e
                                    w
                                 
                              
                            respectively denote the weights before and after the substitution. In weight modification, 
                              
                                 Δ
                              
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          4
                                       
                                    
                                 
                              
                            are the increments of a node weight, and 
                              
                                 Δ
                              
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          4
                                       
                                    
                                 
                              
                              =
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       n
                                       e
                                       w
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             4
                                          
                                       
                                    
                                    
                                       o
                                       l
                                       d
                                    
                                 
                                 |
                              
                           . In the third version, the equation is expanded according to node types.

According to the definition, there are four edit operations and two types of nodes in case tree, so there are eight different situations, such as inserting a value node, deleting a feature node, and so on. Now examples are given to illustrate the costs of different edit operations on different nodes. The class and keyword nodes are not shown in order to be simple, and this will not change the results.

Examples of edit operations on the value node are shown in Fig. 4
                           . There are three cases and they all have features “Pole height” and “Slots”, but the value nodes of feature Slots are different. In Case1, there is no value node for feature Slots, which means that it is a missing value, while in Case2, its value is 162, and in Case3, its value is 252. Thus, transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            is inserting a value node of feature Slots, 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            is deleting the value node of Slots, and 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            is substituting the value node of feature Slots. Inserting or deleting a value node would not change the weights because the features are not changed. In order to illustrate the costs of weight modification, suppose that the feature weights change in three transformations. As for insertion, 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              v
                              I
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 |
                              
                           . Transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            is deleting the value node, and the total costs are 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              v
                              D
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 |
                              
                           . 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            is substituting the value node, and the costs are 
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              v
                              S
                              ⋅
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ¯
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 |
                              
                           , where 
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ¯
                              
                              =
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              /
                              2
                           .

The examples of edit operations on the feature node are shown in Fig. 5
                            and the case trees use some features of electromagnetic design, where “FN” is the frequency and “HP” is the pole body height. There are two kinds of winding types which are lap winding and wave winding in electromagnetic design, and “TH” and “TVR” are features which are peculiar to lap winding and wave winding.

There are three cases which all have features FN and HP, and they differ with each other in one feature. Transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            is substituting feature TH with feature TVR, transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            is deleting feature TH, and transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            is inserting feature TVR. As for substitution, the features change, so the values would change and the weights may change, then the costs are 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              S
                              ⋅
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          3
                                       
                                    
                                 
                                 ¯
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ⋅
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 |
                              
                           . As for transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           , feature weights change due to the change of feature number, and the costs of weight modification are 
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    3
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ⋅
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 |
                              
                           , then the total costs are 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              D
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    3
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    3
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ⋅
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 |
                              
                           . As for 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , the weights also change, and costs of weight modification are 
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    3
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ⋅
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 |
                              
                           , then the total costs are 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              I
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    3
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    3
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ⋅
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 |
                              
                           .

To be utilized as a similarity measurement, cost function should be a metric, so it should satisfy three conditions which are non-negativity, symmetry and triangle inequality. Because the costs of edit operations and cost coefficients can be set to any possible values, the cost function would not satisfy these three conditions generally. But if the values of these variables are restricted, it can still be a metric. 
                              Theorem 1
                              
                                 The cost function satisfies the symmetry if 
                                 
                                    I
                                    =
                                    D
                                 
                                 .
                              


                           
                              Proof
                              All the possible edit operation sequences in transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                  are composed of the following five simple transformations.

(1) Supposing transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                  is inserting a feature node. The weights of features in 
                                    
                                       
                                          
                                             Tree
                                          
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Tree
                                          
                                       
                                       
                                          2
                                       
                                    
                                  are 
                                    
                                       {
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                       }
                                    
                                  and 
                                    
                                       {
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       }
                                    
                                 , where the (
                                    n
                                    +
                                    1
                                 )-th node is the inserted one. Being similar to transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             3
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                  in Fig. 5, the total costs are 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    I
                                    ⋅
                                    
                                       
                                          w
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    ⋅
                                    
                                       
                                          w
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                 , where 
                                    
                                       
                                          K
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       f
                                       +
                                       v
                                       )
                                    
                                    ,
                                    
                                    m
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    +
                                    1
                                 ; as for transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 , its shortest edit path is deleting the (
                                    n
                                    +
                                    1
                                 )-th feature node, and 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    ⋅
                                    D
                                    ⋅
                                    
                                       
                                          w
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    ⋅
                                    
                                       
                                          w
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    ⋅
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                 . Apparently, if 
                                    I
                                    =
                                    D
                                    ,
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 , so this transformation satisfies the symmetry.

(2) Supposing transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                  is inserting a value node, and the value node is the 
                                    i
                                 -th feature’s value. The weights would not change in this transformation. Being similar to 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                  in Fig. 4, the costs are 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    v
                                    I
                                    ⋅
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 ; as for 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 , the costs are 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    v
                                    D
                                    ⋅
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 . Thus, it satisfies the symmetry if 
                                    I
                                    =
                                    D
                                 .

(3) Supposing that transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                  is deleting a node. Being similar to (1) and (2), this transformation satisfies the symmetry if 
                                    I
                                    =
                                    D
                                 .

(4) Supposing transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                  is substituting the 
                                    i
                                 -th node. If it is a substitution of a feature node, then weights may change. The weights in 
                                    
                                       
                                          
                                             Tree
                                          
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Tree
                                          
                                       
                                       
                                          2
                                       
                                    
                                  are 
                                    
                                       {
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                       }
                                    
                                  and 
                                    
                                       {
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       }
                                    
                                 , then the total costs are 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    ⋅
                                    S
                                    ⋅
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    ⋅
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                 , where 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                       
                                       ¯
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    /
                                    2
                                  and 
                                    
                                       
                                          K
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          m
                                       
                                    
                                    
                                       (
                                       f
                                       +
                                       v
                                       )
                                    
                                 ; as for transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 , its shortest edit path is also substituting the 
                                    i
                                 -th node, and 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    ⋅
                                    S
                                    ⋅
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                       
                                       ¯
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    ⋅
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                 . Apparently, it satisfies the symmetry. If it is a substitution of a value node, then 
                                    
                                       
                                          K
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          m
                                       
                                    
                                    v
                                  in two transformations, so it satisfies the symmetry.

(5) Supposing transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                  is only modifying the weights. The node weights in 
                                    
                                       
                                          
                                             Tree
                                          
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Tree
                                          
                                       
                                       
                                          2
                                       
                                    
                                  are 
                                    
                                       {
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                       }
                                    
                                  and 
                                    
                                       {
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             n
                                          
                                          
                                             2
                                          
                                       
                                       }
                                    
                                 . So the costs are 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    ⋅
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                 , where 
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       f
                                       +
                                       v
                                       )
                                    
                                 ; as for transformation 
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 , its shortest edit path is also modifying the weights, so 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    ⋅
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                 . Apparently, this transformation satisfies the symmetry.

The complicated transformation is a linear combination of the above five simple transformations, so the cost function satisfies the symmetry if 
                                    I
                                    =
                                    D
                                 .□

In order to be a metric, the cost function should also satisfy the triangle inequality, which is 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              ≤
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              +
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           . Suppose that there is only one different leaf feature node between two case trees, and there are massive edit paths, but only two of them are the possible shortest paths. One is substituting the node, the other is deleting the node from 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    1
                                 
                              
                            and inserting it into 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    3
                                 
                              
                           . The two edit paths are shown in Fig. 5. For the first edit path, suppose that the different node is the 
                              i
                           -th node, then the total costs of substitution are 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              S
                              ⋅
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                                 ¯
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 |
                              
                           , where 
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                                 ¯
                              
                              =
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              /
                              2
                            and 
                              
                                 
                                    K
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    m
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              ,
                              m
                              =
                              1
                              ,
                              …
                              ,
                              n
                           . As for the second edit path, by deleting the 
                              i
                           -th value node from 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    3
                                 
                              
                            can be obtained and the costs are 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              D
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                    ,
                                    j
                                    ≠
                                    i
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       3
                                    
                                 
                                 |
                              
                           ; then by inserting the 
                              i
                           -th value node into 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    2
                                 
                              
                            can be obtained. Being similar to insertion in Fig. 5, the costs are 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              I
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                    ,
                                    j
                                    ≠
                                    i
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       3
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 |
                              
                           . Then the total costs are 
                              
                                 (5)
                                 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             3
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       D
                                       ⋅
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       I
                                       ⋅
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                          ,
                                          j
                                          ≠
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          |
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                3
                                             
                                          
                                          |
                                       
                                       +
                                       
                                          |
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                2
                                             
                                          
                                          |
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

Let 
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    3
                                 
                              
                              =
                              0
                           , then 
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                    ,
                                    j
                                    ≠
                                    i
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          3
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                    |
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          3
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                    |
                                 
                                 )
                              
                           . According to the property of the inequality, 
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          3
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                       
                                          2
                                       
                                    
                                    |
                                 
                                 )
                              
                              ≥
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 |
                              
                           , and because 
                              I
                              =
                              D
                           , 
                              
                                 (6)
                                 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             3
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    I
                                    ⋅
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          |
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                3
                                             
                                          
                                          |
                                       
                                       +
                                       
                                          |
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                2
                                             
                                          
                                          |
                                       
                                       )
                                    
                                    ≥
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    I
                                    ⋅
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                    .
                                 
                              
                           
                        

Let 
                              I
                              +
                              D
                              ≥
                              S
                           , that is, 
                              I
                              ≥
                              
                                 (
                                 S
                                 /
                                 2
                                 )
                              
                           , then 
                              
                                 (7)
                                 
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             3
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ≥
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    I
                                    ⋅
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                    ≥
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    ⋅
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    ⋅
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                    =
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    S
                                    ⋅
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                    
                                    
                                       |
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                       |
                                    
                                    =
                                    
                                       Cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

According to Eq. (7), the cost function of a leaf feature node satisfies the triangle inequality if 
                              I
                              +
                              D
                              ≥
                              S
                            and 
                              I
                              =
                              D
                           . As for a leaf value node, the weights would not change, and the cost function also satisfies the triangle inequality if 
                              I
                              +
                              D
                              ≥
                              S
                            and 
                              I
                              =
                              D
                           . As for a non-leaf node, the deletion operation of a non-leaf node corresponds to the deletion of many leaf nodes, so the costs of substitution are apparently less than the costs of deletion and insertion operations. Thus, the cost function of a non-leaf node satisfies the triangle inequality. The costs of a complicated transformation are a linear combination of the costs of editing leaf nodes and non-leaf nodes, so the following theorem can be concluded.
                              Theorem 2
                              
                                 The cost function satisfies the triangle inequality if 
                                 
                                    I
                                    +
                                    D
                                    ≥
                                    S
                                  
                                 and 
                                 
                                    I
                                    =
                                    D
                                 
                                 .
                              

According to the definition of the cost function, it is nonnegative, and apparently, 
                              
                                 Cost
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              =
                              0
                            if and only if 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    2
                                 
                              
                           . So the cost function satisfies the non-negativity, and the following deduction can be obtained.


                           Deduction: The cost function is a metric if 
                              I
                              +
                              D
                              ≥
                              S
                            and 
                              I
                              =
                              D
                           .

As a metric, the cost function can measure the costs of transforming two case trees into each other.

The cost function can measure the semantic difference of transformation, but it cannot be utilized to measure the similarity directly, and it should be improved. On one hand, the increments of feature values should be considered. For example, suppose that there are two transformations of hydro-generator cases which are 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            and 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                           . Three case trees only differ in one value node, such as the value of feature damper bar number, and the values in three case trees are 2, 4 and 8. The edit sequences are all substituting this value node, so the edit distances all equal one, and the costs are all 
                              h
                              v
                              S
                              ⋅
                              w
                           . But in the first transformation, the value changes from 2 to 4, while it changes from 2 to 8 in the second transformation, so the similarity between two cases in the first transformation is bigger, while the edit distance and cost function cannot distinguish them, that is why they cannot be utilized to measure the similarity. On the other hand, the edit distance takes no account of the number of tree nodes. For example, suppose that there are two transformations 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            and 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                           , and the edit distances of two transformations are both 2, which means that 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    2
                                 
                              
                            differ in two nodes, and so do the other two case trees. While the average node number of 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    2
                                 
                              
                            is 5 the average node number of 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    3
                                 
                              
                            and 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    4
                                 
                              
                            is 50. Apparently, the similarity between two cases in the second transformation is bigger. In order to overcome these drawbacks, the similarity function is defined based on the cost function.

As for the first aspect, the costs brought by the increments of feature values should be calculated according to value types. The feature values can be classified into four types, which are simple numerical value, interval value, fuzzy value [7] and semantic value. The costs are defined as 
                              
                                 value
                              
                              _
                              
                                 cost
                              
                              
                              
                                 (
                                 
                                    
                                       
                                          value
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          value
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           , and their numerical range is [0, 1]. The value costs of four value types are defined as follows.

(1) The value cost of a simple numerical value. If the transformation is the substitution of a value node whose type is a simple numerical value, then the value cost is defined as 
                              
                                 (8)
                                 
                                    
                                       value
                                    
                                    _
                                    
                                       cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                value
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                value
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   
                                                      value
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      value
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             |
                                          
                                       
                                       
                                          max
                                          −
                                          min
                                       
                                    
                                 
                              
                            where max and min are the maximum and minimum of this feature value.

(2) The value cost of an interval value. Supposing the type of the substituted value node is an interval value and the values in two case trees are 
                              
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                            and 
                              
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                           , then the value cost is 
                              
                                 (9)
                                 
                                    
                                       value
                                    
                                    _
                                    
                                       cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                value
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                value
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   a
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                          
                                          +
                                          
                                             |
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                             |
                                          
                                       
                                       
                                          
                                             |
                                             
                                                
                                                   a
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   a
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                             
                                             |
                                          
                                          +
                                          
                                             |
                                             
                                                
                                                   b
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                             
                                             |
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    a
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                            and 
                              
                                 
                                    a
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                            are the maximum and minimum of the lower bound, and 
                              
                                 
                                    b
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                            denote the maximum and minimum of the upper bound.

(3) The value cost of a fuzzy value. Generally, all feature values of cases in the case base are certain values, while the feature values of the query case which is from the design requirements may be fuzzy values. The design requirements are input as query conditions into the system and some conditions may be fuzzy. Take the hydro-generator for example, the query condition rated speed may be a fuzzy value, such as high, middle and low. The triangular membership function in fuzzy mathematics can be utilized to deal with the fuzzy value. Supposing that case tree 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    1
                                 
                              
                            is the case in the case base, and one of its feature values is 
                              
                                 
                                    
                                       value
                                    
                                 
                                 
                                    1
                                 
                              
                           , while 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    2
                                 
                              
                            is a query case, and its corresponding feature value is 
                              
                                 
                                    
                                       value
                                    
                                 
                                 
                                    2
                                 
                              
                            which is a fuzzy value. The steps are: (i) determining the universe and fuzzy variables; (ii) constructing the membership functions; (iii) calculating the membership degree of each fuzzy variable and checking that whether the fuzzy variable whose membership degree is the maximum equals 
                              
                                 
                                    
                                       value
                                    
                                 
                                 
                                    2
                                 
                              
                           , then 
                              
                                 (10)
                                 
                                    
                                       value
                                    
                                    _
                                    
                                       cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                value
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                value
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         if the fuzzy value of value
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         is value
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   else
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

There is another situation which is similar to this. The 
                              
                                 
                                    
                                       value
                                    
                                 
                                 
                                    1
                                 
                              
                            is a numerical value, and 
                              
                                 
                                    
                                       value
                                    
                                 
                                 
                                    2
                                 
                              
                            is an inequality which is composed of a numerical value and symbol 
                              R
                              =
                              
                                 {
                                 >
                                 ,
                                 <
                                 ,
                                 ≥
                                 ,
                                 ≤
                                 }
                              
                           . The value cost is 
                              
                                 (11)
                                 
                                    
                                       value
                                    
                                    _
                                    
                                       cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                value
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                value
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      
                                                         if value
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                
                                                   satisfies the inequality
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   else
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

(4) The value cost of semantic value. There are some semantic values in cases, such as color, material, and so on. The most popular method of dealing with semantic values is setting the value costs between different values by the experts according to their knowledge. Take the material in the design for example, the value costs are shown in Table 1
                           .

The value cost is calculated only when a substitution operation is executed on the same feature’s value nodes, in other situations, it is set as one in the calculation of similarity, that is, 
                              
                                 value
                              
                              _
                              
                                 cost
                              
                              =
                              1
                           .

As for the second aspect, the scale cost is defined by considering the number of editable tree nodes. 
                              
                                 (12)
                                 
                                    
                                       scale
                                    
                                    _
                                    
                                       cost
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    E
                                    D
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    /
                                    N
                                    ,
                                    
                                    N
                                    =
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             N
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    /
                                    2
                                 
                              
                            where 
                              E
                              D
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            denotes the edit distance between two case trees and 
                              N
                            is the average number of editable tree nodes. 
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                            are numbers of editable nodes in two case trees.

The difference between two case trees can be measured accurately by combining the value cost and scale cost with the cost function, so the similarity function is defined based on them. 
                              Definition 5
                              Similarity function 
                                    
                                       Sim
                                    
                                    
                                       (
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             1
                                          
                                       
                                       →
                                       
                                          
                                             
                                                Tree
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 , supposing that the shortest edit path which is determined by the cost function is 
                                    E
                                    =
                                    
                                       {
                                       
                                          Insert, Delete, Substitute, Weight
                                       
                                       ,
                                       R
                                       }
                                    
                                 , where Insert, Delete, Substitute and Weight denote four edit operations, and 
                                    R
                                  denotes the sequence of the edit operations. The similarity between two case trees is defined as 
                                    
                                       (13)
                                       
                                          
                                             Sim
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      Tree
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             →
                                             
                                                
                                                   
                                                      Tree
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          =
                                          exp
                                          
                                             [
                                             −
                                             α
                                             
                                                (
                                                
                                                   scale
                                                
                                                _
                                                
                                                   cost
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ⋅
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ⋅
                                                F
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                ⋅
                                                
                                                   value
                                                
                                                _
                                                
                                                   cost
                                                
                                                )
                                             
                                             ]
                                          
                                          =
                                          exp
                                          
                                             [
                                             −
                                             α
                                             
                                                (
                                                
                                                   scale
                                                
                                                _
                                                
                                                   cost
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                I
                                                ⋅
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                D
                                                ⋅
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                S
                                                ⋅
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ¯
                                                
                                                ⋅
                                                
                                                   value
                                                
                                                _
                                                
                                                   cost
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                                ⋅
                                                
                                                   Δ
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                          =
                                          exp
                                          
                                             [
                                             −
                                             α
                                             
                                                (
                                                
                                                   scale
                                                
                                                _
                                                
                                                   cost
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ⋅
                                                f
                                                ⋅
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ⋅
                                                F
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                ⋅
                                                v
                                                ⋅
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                ⋅
                                                F
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ⋅
                                                
                                                   value
                                                
                                                _
                                                
                                                   cost
                                                
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                  where 
                                    
                                       value
                                    
                                    _
                                    
                                       cost
                                    
                                  and 
                                    
                                       scale
                                    
                                    _
                                    
                                       cost
                                    
                                  can be calculated according to Eqs. (8)–(12), and other symbols have the same meanings as those in Eq. (3). The value cost is calculated only when the substitution is executed on the same feature’s value nodes, and it is set as one in other situations, so only some terms have value cost in the second and third versions of the equation. The coefficient 
                                    α
                                  is a constant and it is utilized to adjust the similarity value. The function 
                                    exp
                                    
                                       (
                                       −
                                       x
                                       )
                                    
                                  is utilized to map the costs to the range [0, 1], and because 
                                    exp
                                    
                                       (
                                       −
                                       x
                                       )
                                    
                                  is a monotone decreasing function, the smaller the costs are, the bigger the similarity is.

Now three cases in Fig. 4 are taken as the examples to show the similarity calculation. Three cases in Fig. 4 differ with each other in feature Slots value. The editable node number in 
                              
                                 
                                    
                                       Tree
                                    
                                 
                                 
                                    1
                                 
                              
                            is 
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              =
                              3
                           , and 
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                              =
                              4
                              ,
                              
                                 
                                    N
                                 
                                 
                                    3
                                 
                              
                              =
                              4
                           . Transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            is inserting a value node, so its edit distance is 
                              E
                              D
                              =
                              1
                           , and 
                              N
                              =
                              
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              /
                              2
                              =
                              3.5
                           . The costs are 
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              v
                              I
                              ⋅
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 |
                              
                           , and its value cost is one because it is not a substitution of a value node. Supposing that 
                              I
                              =
                              D
                              =
                              S
                              =
                              1
                              ,
                              f
                              =
                              2
                              ,
                              v
                              =
                              1
                              ,
                              α
                              =
                              0.1
                              ,
                              h
                              =
                              H
                              −
                              t
                              +
                              1
                              =
                              1
                              −
                              1
                              +
                              1
                              =
                              1
                           , and the weights all equal 0.5, then the similarity is 
                              
                                 Sim
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                              =
                              exp
                              
                                 [
                                 −
                                 0.1
                                 ×
                                 
                                    (
                                    1
                                    /
                                    3.5
                                    +
                                    1
                                    ×
                                    1
                                    ×
                                    1
                                    ×
                                    0.5
                                    )
                                 
                                 ]
                              
                              =
                              0.9244
                           . Transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            is deleting the same value node, and because 
                              I
                              =
                              D
                           , the similarity is same. Transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            is substituting the value node, so its edit distance also equals one. 
                              N
                              =
                              
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              /
                              2
                              =
                              4
                           , and its costs are 
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              v
                              S
                              ⋅
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ¯
                              
                              ⋅
                              
                                 value
                              
                              _
                              
                                 cost
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 f
                                 +
                                 v
                                 )
                              
                              
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 |
                              
                           . Because it is a substitution of the same feature’s value nodes, the value cost should be calculated. The maximum and minimum values of feature Slots are 468 and 144, so 
                              
                                 value
                              
                              _
                              
                                 cost
                              
                              =
                              
                                 (
                                 252
                                 −
                                 162
                                 )
                              
                              /
                              
                                 (
                                 468
                                 −
                                 144
                                 )
                              
                              =
                              0.278
                           . Then the similarity is 
                              
                                 Sim
                              
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              =
                              exp
                              
                                 [
                                 −
                                 0.1
                                 ×
                                 
                                    (
                                    1
                                    /
                                    4
                                    +
                                    1
                                    ×
                                    1
                                    ×
                                    1
                                    ×
                                    0.5
                                    ×
                                    0.278
                                    )
                                 
                                 ]
                              
                              =
                              0.9618
                           .

Now an example is presented in Fig. 6
                            to illustrate the algorithm for computing similarity.

There are two case trees in Fig. 6 and they both have features FN, HP and Slots, which are matched features. Features TVR and BVR in Case1 and feature TH in Case2 do not match each other, so they are unmatched features. Moreover, feature HP in Case1 has a missing value, so this example is representative. The algorithm of similarity calculation of transformation 
                              
                                 (
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       
                                          Tree
                                       
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            is: 
                              
                                 (i)
                                 Calculating the costs of matched features, that is, features FN, HP and Slots in two case trees. Only edit operations on a value node which are shown in Fig. 4 are required in this step. As for features FN and Slots, substituting their value nodes if values are different in two cases and only the values of Slots are different. Supposing the value cost of the value node is 
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                    , then the costs are 
                                       
                                          
                                             h
                                          
                                          
                                             3
                                          
                                       
                                       v
                                       S
                                       ⋅
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          ¯
                                       
                                       ⋅
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                    ; as for feature HP, inserting the value node and the costs are 
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       v
                                       I
                                       ⋅
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    , thus, the total costs are 
                                       
                                          
                                             h
                                          
                                          
                                             3
                                          
                                       
                                       v
                                       S
                                       ⋅
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          ¯
                                       
                                       ⋅
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       v
                                       I
                                       ⋅
                                       
                                          
                                             w
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    .

Calculating the costs of unmatched features. There are two types of unmatched features. One situation is that two cases both have unmatched features but their names are different; the other situation is that one case has more features than the other. As is shown in Fig. 6, Case1 has two unmatched features while Case2 has only one. Edit operations on feature nodes which are shown in Fig. 5 are required in this step. According to Theorem 2, the costs of substituting a feature node are less than deleting and inserting it, so as for the first situation, substitution should be operated, and as for the second situation, deletions are utilized. Another problem is which feature satisfies the first situation. For example, features TVR and BVR in Case1 can both be substituted by feature TH. The costs of all possible substitutions should be calculated and the minimum one is selected. Supposing that the costs of substituting feature TVR with feature TH are the minimum, then the edit operations are substituting feature TVR with feature TH and deleting feature BVR, and the costs are 
                                       
                                          
                                             h
                                          
                                          
                                             4
                                          
                                       
                                       
                                          (
                                          f
                                          +
                                          v
                                          )
                                       
                                       S
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   4
                                                
                                             
                                          
                                          ¯
                                       
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             5
                                          
                                       
                                       
                                          (
                                          f
                                          +
                                          v
                                          )
                                       
                                       D
                                       ⋅
                                       
                                          
                                             w
                                          
                                          
                                             5
                                          
                                          
                                             1
                                          
                                       
                                    , where 
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   4
                                                
                                             
                                          
                                          ¯
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                4
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                4
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       /
                                       2
                                    . As for the value cost, it is calculated only when a substitution is executed on the same feature’s value nodes, so there is no value cost in substituting feature TVR’s value node with feature TH’s value node.

Calculating the costs of weight modification. The weights contain feature weights and value weights, as for substitution, the weight modification is 
                                       
                                          Δ
                                       
                                       w
                                    , and as for deletion, if it is a deletion on value node, the weights do not change; if it is a deletion on a feature node, the weight modification is the weight of the deleted node. For example, as for feature node BVR, its weight modification is 
                                       
                                          
                                             w
                                          
                                          
                                             5
                                          
                                          
                                             1
                                          
                                       
                                    . So the costs of weight modification are 
                                       
                                          
                                             h
                                          
                                          
                                             5
                                          
                                       
                                       
                                          (
                                          f
                                          +
                                          v
                                          )
                                       
                                       
                                          
                                             w
                                          
                                          
                                             5
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             4
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          f
                                          +
                                          v
                                          )
                                       
                                       
                                          Δ
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                    .

Calculating the scale cost. The calculation of scale cost requires edit distance and average editable node number. The editable node numbers are 
                                       
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       9
                                     and 
                                       
                                          
                                             N
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       8
                                    , thus, 
                                       N
                                       =
                                       8.5
                                    . The edit distance is 6, and then 
                                       
                                          scale
                                       
                                       _
                                       
                                          cost
                                       
                                       =
                                       6
                                       /
                                       8.5
                                       =
                                       0.706
                                     according to Eq. (12).

Calculating the similarity. The similarity can be calculated according to Eq. (13) by using the results of the above steps. The constant 
                                       α
                                     is usually set to a value in [0, 1] to adjust the similarity value.

The similarity between two cases with missing values and unmatched features can be calculated according to the above algorithm.

@&#SUMMARY@&#

There are both links and differences among edit distance, cost function and similarity function. The edit distance is a metric, and its numerical range is 
                              
                                 [
                                 0
                                 ,
                                 +
                                 ∞
                                 )
                              
                           . It can only represent the structural difference between two case trees. The cost function is also a metric in some conditions, and its numerical range is 
                              
                                 [
                                 0
                                 ,
                                 +
                                 ∞
                                 )
                              
                           . It can be utilized to measure the semantic difference between two case trees. The similarity function is defined based on the cost function and its numerical range is [0, 1]. It can measure the similarity between two cases.

The advantage of the proposed similarity function is that it allows the structures of two cases to be different, and this can be utilized to handle missing values and unmatched features. The conventional similarity measurement requires that the features in two cases should be in one-to-one correspondence, such as Euclidean distance and Manhattan distance. As for the unmatched features in Fig. 6, the features TVR, BVR in Case1 and feature TH in Case2 should be eliminated if the conventional distances are utilized, and some useful information is ignored. The proposed similarity function can handle this problem without eliminating these features.

In this section, a case study is presented for the use of the proposed CBR system. Assume the design requirement is the electromagnetic design which includes the design of winding, stator core, and so on. The electromagnetic design is the core of hydro-generator design. According to the tree model in Fig. 3, the electromagnetic design is a subtree with no subcomponent. The keyword is the form of winding which includes lap winding and wave winding. Every case is composed of description and solution, which correspond to input and output parameters. There are 21 input and 29 output parameters, and the input ones are utilized to retrieve while the output ones are used to revise.

The interface of electromagnetic design is shown in Fig. 7
                        . As for the keyword of the class, it is “lap winding” in this case and it is utilized to find the corresponding class. Designers input the design requirements as the values of input parameters, and if a feature value is a missing value, designers input “NULL”, just as the value of feature rated revolution in Fig. 7. There are only matched features which two winding types both have in the interface, and if it is needed to input additional parameters, they can choose it in the “Add other parameters” area. As for the weights, designers write the weights in a document and browse it in the “read the weights” area and the values of edit operation costs 
                           I
                           ,
                           D
                         and 
                           S
                        , cost coefficients 
                           f
                         and 
                           v
                        , and coefficient 
                           α
                         are all written in this document.

By clicking the “Retrieve” button, the results which are ordered by similarities are listed, shown in Fig. 8
                        .

By clicking the “Show details” button, designers can check the solution of the retrieved case, and then they can revise the solution according to their knowledge. After the revision, the solution satisfies the design requirements and the revised case is retained in the case base.

A case study is presented in Section 4.1 to illustrate the proposed CBR system, and its performance in dealing with missing values would be evaluated in this section.

A method which is similar to the one used in literature [7] is adopted to do the experiments. The experiments are classified into three categories: low level design, which has no missing value; middle level design, which has one or two missing values; and high level design, which has more than two missing values. The complete case from the design requirements in Section 4.1 is utilized as the query case. There are no missing values in the cases, so some feature values of cases in the case base are eliminated randomly in middle and high level experiments.

The amount of necessary adaptation is taken as the index. All the cases have input and output parameters and the input ones are utilized to retrieve while the output ones are utilized to revise. So in the experiments, 21 input parameters are utilized to calculate the similarity and 29 output parameters are utilized to calculate the amount of necessary adaptation. In Section 4.1, the retrieved case is revised, so the amounts of necessary adaptation are calculated between the revised case and all retrieved cases, and 
                              
                                 Adaptation
                              
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          |
                                       
                                    
                                    
                                       
                                          
                                             max
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             min
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 )
                              
                              /
                              N
                           , where 
                              X
                            is the revised case, 
                              Y
                            is the retrieved case, and 
                              N
                            is the number of output features. If the 
                              i
                           -th feature value of the retrieved case is a missing value, then 
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           .

The same experiments are executed on other systems which contain a CBR system which uses the edit distance as the similarity measurement directly, conventional CBR systems (CCBR for short) which use Euclidean distance and Manhattan distance as similarity measurements. In the proposed CBR systems, 
                              I
                              =
                              D
                              =
                              1
                              ,
                              f
                              =
                              2
                            and 
                              v
                              =
                              1
                           . In order to evaluate the choice of the costs of edit operations, two proposed CBR systems with 
                              S
                            equaling to 1 and 2 are evaluated. As for conventional CBR systems, four approaches which can handle missing values are utilized.

This section consists of three groups of experiments. In the first group, the performance of all systems is evaluated by using the most similar case; the second group evaluates these systems using the most similar five cases, and the third group evaluates the performance of the proposed systems in dealing with query cases which have missing values. The details are shown as follows.

(1) The first group of experiments.

As for the first group of experiments, the most similar cases of all systems are retrieved and the results are shown in Table 2
                           , where PCBR is the proposed CBR and CCBR denotes conventional CBR. E in () denotes the Euclidean distance and M is the Manhattan distance. The number in [] means that this CCBR system uses the approach in that literature to handle missing values.

(2) The second group of experiments.

The above experiments provide the most similar case of each system, while sometimes it requires retrieving the most similar five or ten cases for designers to select in practice. Thus, the most similar five cases of each system are retrieved and evaluated in the second group of experiments. Table 3
                            presents the top five similar cases of the proposed CBR systems with 
                              S
                            equaling to 1 and 2, and Table 4
                            provides the average amount of necessary adaptation of the top five similar cases for each system.

In Table 3, every column is a list of top five similar cases in descending order of similarity.

(3) The third group of experiments.

In the above two groups of experiments, the query case is the same one which has no missing value. The third group of experiments would evaluate the performance of the proposed CBR systems in dealing with incomplete query cases. There are 21 input features in query case, and every feature value is removed in turn to form the new incomplete query cases. Then these new query cases are utilized to retrieve the most similar cases, and the retrieved results are presented in Table 5
                           .

In Table 5, every column is the retrieved results of the proposed CBR system in one level experiment. As for the results, take “No. 15 (21)” for example, “No. 15” is the retrieved case and the number in “()” is the number of incomplete query cases whose retrieved cases are case No. 15.

@&#RESULTS@&#

(1) The first group of experiments.

In Table 2, the boldface and italic fonts indicate the best results in each level. As for low and middle levels, the retrieved cases of PCBR and CCBR systems which use the approaches in literatures to handle missing values are the same and their amounts of necessary adaptation are the minimum. As for high level experiments, PCBR 
                              
                                 (
                                 S
                                 =
                                 1
                                 )
                              
                            and CCBR based on Manhattan distance which uses the approach in literatures [18,19] achieve the best results. According to the statistics, the amounts of necessary adaptation of cases No. 4, No. 15 and No. 5 are the smallest three ones in high level design. So the results of the PCBR 
                              
                                 (
                                 S
                                 =
                                 2
                                 )
                              
                            system and other CCBR systems are good even if they are not the best. As for the edit distance based system, the amounts of necessary adaptation of retrieved cases are larger than those of other systems in three levels.

On one hand, the results demonstrate that the edit distance cannot be utilized to measure the similarity directly. The edit distance can only measure the structural difference, so the number of different nodes between case No. 5 and the query case is the minimum in low level experiments, but the similarity between them is not the maximum. On the other hand, the proposed approach can handle missing values as effectively as the approaches in literatures. The results of the proposed CBR systems and some conventional CBR systems are the same because they are equivalent in this situation.

In these experiments, there is no unmatched feature and all the features are in one layer, and some approaches which can handle missing values in literatures are special cases of the proposed approach in this situation. For example, if 
                              I
                              =
                              D
                              =
                              1
                              ,
                              S
                              =
                              2
                           , and the scale cost is ignored, the proposed approach is equivalent to Manhattan distance which uses the approach in literature [20]; and if 
                              I
                              =
                              D
                              =
                              S
                              =
                              1
                           , the proposed approach degenerates to Manhattan distance which uses the approach in literature [18,19], that is why only these two methods can achieve the best results in high level design. The Euclidean distance and Manhattan distance are both special cases of Minkowski distance, which is 
                              d
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          dis
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             q
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    1
                                    /
                                    q
                                 
                              
                           . So the conventional CBR systems which use approaches in literatures are special cases of the proposed CBR system if there is no unmatched feature and all features are in one layer. The results of two proposed CBR systems in high level are different because the influence of missing values is different.

As for the costs of edit operation, their function is regulating the influence of missing values. Suppos3 that 
                              I
                              =
                              D
                              =
                              1
                           , and only 
                              S
                            can be changed. According to the theorems in Section 3.3.1, any values of 
                              I
                              ,
                              D
                            and 
                              S
                            which satisfy conditions 
                              I
                              +
                              D
                              ≥
                              S
                            and 
                              I
                              =
                              D
                            are reasonable, and then it is a problem for designers to determine which value is suitable in practice. The principle for determining the value of 
                              S
                            is presented as follows. According to Fig. 4, 
                              I
                            and 
                              D
                            are used only when there are missing values, and if there is no missing value, then only 
                              S
                            is utilized. If it is allowed to ignore the influence of missing values in the design, for example, the retrieved case is allowed to have plenty of missing values, and then 
                              S
                            should be a larger one which is equivalent to decreasing 
                              I
                            and 
                              D
                           , so that the case with missing values can have a relatively high similarity. While if it cannot ignore the influence of missing values in the design, for example, the retrieved case is not allowed to have any missing value, then 
                              S
                            should be a smaller one so that the case with missing values would have a relatively small similarity.

(2) The second group of experiments.

In the second group, the top five similar cases are retrieved and Table 3 presents the top five similar cases of two proposed CBR systems. On one hand, as for three levels of one proposed system, the five retrieved cases are not the same. With the increase of missing values, some new cases are retrieved, especially in high level experiments. For example, as for the PCBR 
                              
                                 (
                                 S
                                 =
                                 1
                                 )
                              
                            system, case No. 4 and case No. 2 are new retrieved cases in high level experiments. The reason is that there are more than two missing values in every case in the high level, so the cases in the case base change greatly. For example, in high level, the amount of necessary adaptation of case No. 4 is the minimum, while case No. 4 is a new retrieved case. On the other hand, the low and middle level retrieved results of two PCBR systems are the same, while their high level retrieved results are different. The reason is the influence of missing values is different, which has been mentioned above. There are a number of missing values in the high level, so the difference is obvious, while the number of missing values is small in the middle level, so the top five similar cases of two PCBR systems are the same.


                           Table 4 provides the average amounts of necessary adaptation of the top five similar cases for all systems in three levels, and the boldface and italic fonts indicate the best results in each level. On one hand, in low and middle levels, two PCBR systems and all CCBR systems achieve the same results. In the high level, the PCBR 
                              
                                 (
                                 S
                                 =
                                 2
                                 )
                              
                            system and the CCBR system which uses the approach in literature [20] both achieve the best results because they are equivalent. The average adaptation of the PCBR 
                              
                                 (
                                 S
                                 =
                                 1
                                 )
                              
                            system and CCBR (M) [18,19] is also good, while other systems are not that good. On the other hand, the results of CBR systems based on edit distance are the worst in three levels, so the results validate that the edit distance cannot be utilized as a similarity measurement directly again.

(3) The third group of experiments.

This group of experiments evaluates the performance of proposed CBR systems in handling query cases which have missing values. In this group, one of 21 feature values of the query case is removed in turn, so there are 21 new incomplete query cases, and then there are 21 retrieved cases in each level for one PCBR system. The results in Table 5 can be compared with those in Table 3. For example, as for the PCBR (
                              S
                              =
                              1
                           ) system in low level, the retrieved cases of 21 new query cases are all case No. 15, which is the same as that of the complete query case, so the missing value in the query case has no influence in the low level. As for the PCBR (
                              S
                              =
                              1
                           ) system in the high level, the retrieved cases of 15 incomplete query cases are the same as that of the complete query case, and the retrieved cases of the other 6 query cases are case No. 5 and case No. 15, which are both in the most similar five cases of complete query cases (as is shown in Table 3). The results of two PCBR systems in the high level are different because the values of 
                              S
                            are different.

Although not all the retrieved cases of incomplete query cases are the same as that of complete query case, the majority of them are the same. Thus, the results validate that the proposed CBR system can handle missing values effectively.

The above experiments demonstrate that the proposed approach can deal with missing values effectively, and approaches in literatures are equivalent to it in the simplest situation, but the model of hydro-generator cases is a layered tree and there may be unmatched features in case retrieval. So this group of experiments is executed to evaluate these approaches in dealing with complicated cases and unmatched features.

Assume that the design requirement is hydro-generator design and the structure of case trees in the case base is shown in Fig. 9
                           .

The structure of case trees in the case base is similar to that in Fig. 3. It has three layers and there are unmatched features among these cases. As for electromagnetic design, there are two types of windings, which are lap winding and wave winding, and their features are different. As shown in Fig. 9, the red circle denotes a feature which is peculiar to lap winding, while the blue circle is the peculiar feature for wave winding, and the green circle is the matched feature which they both have. The algorithm in Section 3.3.3 is utilized to calculate the similarity.

Eight cases are selected to do the experiments, and the winding type of six cases is lap winding, while the type of the other two cases is wave winding. There are missing values in eight cases, and the information of eight cases is shown in Table 6
                           .

The first and second rows are name and winding type of the case, and the third row denotes the number of missing values, while the fourth and the fifth rows are input and output parameter numbers.

One case is taken as the query case, and the amount of necessary adaptation is taken as the experiment index. Similarly, the input parameters are utilized to calculate the similarity, and then the output ones are utilized to calculate the amount of adaptation. This section contains two groups of experiments, and the first group evaluates the CBR systems using the most similar case, while the second group uses the most similar five cases. The details are presented as follows.

(1) The first group of experiments.

Case LDT whose winding type is lap winding is selected as the query case, and the most similar cases of two PCBR and other systems in Section 4.2 are compared. As for CCBR systems, the unmatched features should be eliminated so that features are in one-to-one correspondence and then Euclidean and Manhattan distances can be utilized. Four approaches in literatures are utilized in CCBR systems to handle missing values. In PCBR, 
                              I
                              =
                              D
                              =
                              1
                              ,
                              f
                              =
                              2
                            and 
                              v
                              =
                              1
                           . The weights of features which belong to the same parent node are equal. The results are shown in Table 7
                           , and the symbols are same as those in Table 2.

The second and the third columns are the query case and its winding type, while the fourth and fifth columns are the retrieved case and its winding type, and the last column is the amount of necessary adaptation.

(2) The second group of experiments.

In this group of experiments, the query case is also case LDT and the most similar five cases of each system are retrieved and evaluated. Table 8
                            presents the retrieved results.

The first row is the number of cases whose winding type is wave winding in the top five similar cases, and the second row is the average amount of necessary adaptation of the most similar five cases. The boldface and italic fonts indicate the best results.

@&#RESULTS@&#

(1) The first group of experiments.

On one hand, the winding type of retrieved cases of two PCBR systems and Edit Distance is lap winding which is same as that of the query case, and retrieved cases of CCBR systems are the same but its winding type is wave winding. The reason is that the unmatched features are eliminated in CCBR systems and some useful information is ignored. While the edit distance and the proposed approach can handle unmatched features, so the winding type of retrieved case is correct. Thus, the results demonstrate the correctness of the proposed CBR system. On the other hand, the adaptation amount of the proposed CBR system’s retrieved case is less than that of other methods. The results validate that the proposed CBR system is more effective than other systems in dealing with unmatched features.

(2) The second group of experiments.

This group of experiments evaluates all CBR systems using the top five similar cases. As for the number of cases whose winding type is wave winding which is different from that of the query case, the 
                              
                                 PCBR
                              
                              
                                 (
                                 S
                                 =
                                 1
                                 )
                              
                            system and CBR system based on edit distance are the best. All the CCBR systems have 2 cases, while there are only 2 cases whose winding type is wave winding (as is shown in Table 6), and the most similar case of these systems also belongs to wave winding (as is shown in Table 7), so the CCBR systems cannot handle unmatched features. As for the average amount of necessary adaptation, 
                              
                                 PCBR
                              
                              
                                 (
                                 S
                                 =
                                 2
                                 )
                              
                            system achieves the best result. Although there is one case belonging to wave winding in its top five similar cases, the most similar case of this system belongs to lap winding and the wave winding case is the fourth similar case. Thus, the results validate that the proposed CBR system can handle unmatched features effectively.

According to the results of experiments in Sections 4.2 and 4.3, we can conclude that the proposed approach can deal with missing values and unmatched features effectively. If there is only the problem of missing values and the features are in one layer, the approaches in literatures are special cases of the proposed approach. But if there are unmatched features and the features are layered, the proposed approach outperforms other approaches.

@&#CONCLUSION@&#

In order to handle the problems of missing values and unmatched features in the CBR system for hydro-generator design, this paper proposes a similarity function based on the edit distance.

The proposed CBR system contains two parts: the construction of the case base and similarity measurement. The domain ontology is utilized to construct the case base and it divides the case base into a number of subsets of cases which can improve the retrieval efficiency. Moreover, the partition of the case base can reduce the chance of retrieving wrong cases. As for the similarity measurement, the proposed methodology defines it in three steps. Firstly, the case representation is proposed and the cases are represented by a unified tree model. Secondly, the cost function which is utilized to measure the semantic difference between two case trees is defined by improving the edit distance. A new edit operation which is a weight modification is defined and the costs of different edit operations and different node types are considered in the definition of the cost function. Then the conditions which make the cost function a metric are proved. Lastly, based on the cost function, the similarity function which can measure the similarity is defined by taking the value cost and scale cost into account. The value cost is defined according to different value types and the scale cost is utilized to overcome the drawback of edit distance.

The performance of the proposed CBR system in handling missing values and unmatched features is evaluated by the experiments respectively. According to the results, we can conclude that existing approaches which can handle missing values are special cases of the proposed approach if there is only the problem of missing values and the case structure is simple. In addition, the designer can regulate the influence of missing values by adjusting the edit operation costs and the principle of determining their values is presented. If there are unmatched features, the proposed approach outperforms other approaches. So the results validate that the proposed CBR system can handle missing values and unmatched features effectively.

In summary, the advantages of the proposed CBR system are threefold; firstly, the method of constructing the case base improves the retrieval efficiency by reducing the number of cases that must be matched, and it also reduces the chance of retrieving wrong cases; secondly, the case representation can clearly describe the missing values which are missing value nodes and unmatched features that are unmatched feature nodes in case trees; thirdly, the similarity measurement can handle missing values and unmatched features effectively, and the values of the costs of edit operations can be determined by designers according to different design requirements to adjust the influence of missing values.

This paper mainly focuses on case representation and case retrieval, and case revision is not considered, so further study should emphasize it. Furthermore, inventive design is important, while CBR which dedicates to routine design can accelerate the design but creativity is limited and not stimulated. CBR is effective in routine design, but its use for inventive design is limited. Thus, future research should focus on inventive design, such as the synergy TRIZ–CBR approach proposed by Robles et al. [31], which extends the CBR method from routine design to inventive design.

@&#ACKNOWLEDGMENTS@&#

The authors are thankful for the support from the National Natural Science Foundation of China (No. 51075083), Specialized Research Fund for the Doctoral Program of Higher Education (Priority development area) (20112302130003) and the major project in a certain domain.

@&#REFERENCES@&#

