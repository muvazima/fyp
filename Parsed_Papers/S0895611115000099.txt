@&#MAIN-TITLE@&#Standard and fenestrated endograft sizing in EVAR planning: Description and validation of a semi-automated 3D software

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Advanced EVAR vascular analysis, allowing automation, robustness and customization.


                        
                        
                           
                           Advanced multimodal visualization technology allowing better planning procedures.


                        
                        
                           
                           Three modes of operation for standard and fenestrated endografts, and a free mode.


                        
                        
                           
                           Ability to handle complex, fenestrated endograft cases.


                        
                        
                           
                           Validation by comparing the agreement with an existing commercial solution.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Computerized Tomography Angiography

Abdominal aortic aneurysm

Endovascular aneurysm repair

Image segmentation

Image quantification

Vascular image analysis

Surgical planning

Software

Endograft

Stent

@&#ABSTRACT@&#


               
               
                  An abdominal aortic aneurysm (AAA) is a pathological dilation of the abdominal aorta that may lead to a rupture with fatal consequences. Endovascular aneurysm repair (EVAR) is a minimally invasive surgical procedure consisting of the deployment and fixation of a stent–graft that isolates the damaged vessel wall from blood circulation. The technique requires adequate endovascular device sizing, which may be performed by vascular analysis and quantification on Computerized Tomography Angiography (CTA) scans. This paper presents a novel 3D CTA image-based software for AAA inspection and EVAR sizing, eVida Vascular, which allows fast and accurate 3D endograft sizing for standard and fenestrated endografts. We provide a description of the system and its innovations, including the underlying vascular image analysis and visualization technology, functional modules and user interaction. Furthermore, an experimental validation of the tool is described, assessing the degree of agreement with a commercial, clinically validated software, when comparing measurements obtained for standard endograft sizing in a group of 14 patients.
               
            

@&#INTRODUCTION@&#

An abdominal aortic aneurysm (AAA) is a pathological condition consisting of an abnormal dilation of the abdominal aorta, exceeding more than 50% its normal diameter [8]. Aneurysms tend to grow, and eventually may rupture, with a high mortality rate. Elective surgery is usually performed when the diameter exceeds 5.5cm [16]. The traditional surgical approach based on an open repair, has been steadily substituted by the endovascular aneurysm repair (EVAR), a minimally invasive technique involving the deployment and fixation of a stent graft that excludes the damaged wall from circulation.

EVAR requires pre-procedural planning consisting of image-based patient anatomy assessment for endograft selection and sizing. Relevant measurements are obtained from high resolution Computerized Tomography Angiography (CTA) scans of the abdominal area, using specific vascular image analysis modules or applications [1,12]. Furthermore, it has been recently demonstrated [23] that developing 3D surgical planning technology may have an impact on the intervention outcome, due to a more accurate endograft sizing and intervention planning.

As surgical practice and device design evolve, more complicated cases are being treated endovascularly, requiring increasingly complex pre-surgical analysis, and custom stent–graft designs. In the case of AAAs, these sometimes require the provision of fenestrations (windows) for subsidiary arteries, specifically when the aneurysm extends proximally covering the infrarenal space, and preventing fixation. Due to the specificity and complexity of the analysis, innovative computational tools supporting the design of fenestrations and custom-made endografts are required. However, there is not enough clinical evidence on how these cases should be addressed [4,3,14]. Current commercial solutions for EVAR planning range from general workstations with advanced planar or curved reformattings around a centerline to specific tools for the aorta. The need to reduce costs has recently led to a strong competition to provide vascular surgeons with fast, robust, accurate and intuitive endograft sizing tools coping with all the raised issues. A few softwares have started to provide solutions for planning complex fenestrated endografts.

In this paper, we present a 3D EVAR endograft sizing tool, named eVida Vascular, first introduced in Ref. [19], which includes advanced visualization and analysis tools for managing standard as well as complex cases, including the provision of fenestrations (windows) in the endograft fabric, while providing a trade-off between automation, speed, robustness, usability, intuitiveness, and flexibility requirements. A novel semi-automatic and robust vascular analysis procedure was developed for this application, based on a prior single-click segmentation of the aortic tree, centerline extraction, including subsidiary arteries, and vessel graph analysis. The method is complemented with the ability to segment missing branches to deal with low contrast scans or severe artifacts. This vascular analysis provides the input for an intuitive visualization interface, combining 3D renderings of the aortic tree and centerlines, supporting 2D views, planar reformattings and visual cues in different synchronized layouts. It features three operation modes or workflows providing fast and accurate sizing of endografts with automatic length and diameter estimation, namely the standard AAA endograft sizing mode, the fenestrated endograft sizing mode, and a free interaction mode allowing further freedom to the surgeon in taking measurements along the aorta centerline and branches. The fenestrated module allows the interactive definition of fenestrations through symbolic stents and endograft, better representing the deployment situation in cases with large aortic neck curvatures. Such combination of features is not present in other softwares.

We provide a description of the eVida Vascular application, explaining the vascular image analysis and visualization, as well as the different modes of operation. In addition, we report a validation comparing results of eVida Vascular with those of a commercial radiology 3D workstation with an AAA sizing module, used routinely in our clinical setting, in order to establish the degree of agreement in diameter and length quantification between both tools.

The outline of the article is as follows. Section 2 presents some important background facts, including clinical facts about AAA and EVAR, image analysis technologies for EVAR planning, and existing commercial solutions. Section 3 describes a set of pre-requisites or requirements for the development of a 3D tool for endograft sizing. Section 4 describes the vascular image analysis technology developed for eVida Vascular. Section 5 details the functional modules and interface of eVida Vascular. Section 6 presents the experiments performed for validation and the results obtained. The advantages and performance of the tool are discussed in Section 7, and finally, Section 8 presents the conclusions and future work.

@&#BACKGROUND@&#

Abdominal aortic aneurysms develop between the renal and iliac arteries; they are defined as an infrarenal aortic diameter of more than 30mm [22]. AAAs are asymptomatic, and tend to grow slowly, with a rupture risk directly correlated with the diameter. AAAs exceeding a diameter of 5.5cm should be referred to a vascular surgeon for treatment [16]. Mortality rate after rupture is between 65% and 85% [13,24], causing roughly about 15,000 deaths per year in the US [7] and 8,000 deaths per year in the UK [24].

Open surgical repair by anastomosis of a synthetic conduit has been performed since the 1950s without major changes in the technique. Endovascular aneurysm repair (EVAR) is nowadays the preferred surgical procedure to treat AAAs, involving the deployment and fixation of a stent–graft inside the aorta via catheterism, which excludes the aneurysm wall from blood circulation. For correctly excluded aneurysms, the pressure exerted on the aortic wall decreases, leading to an eventual reduction in size, and, thus, decreasing the rupture risk.

Advantages of EVAR over open surgical repair include: lower perioperative morbidity and mortality, specially reduced 30-day mortality rates, and shorter recovery times, because there is no need for laparotomy and aortic cross-clamp [21]. The major EVAR complications are endoleaks, which are defined as a persistent flow into the excluded aneurysm sac due to incorrect sealing, endograft defects or breakdown, or retrograde blood flow from collateral vessels [25]. Endoleaks may cause aneurysm growth, and associated rupture risk may lead to re-intervention. Thus, lifelong surveillance is required, usually performed with Computerized Tomography Angiography (CTA) scans, at least yearly.

Complex aortic aneurysms correspond to situations where either there is not enough infrarenal space for fixation of the endograft, the so-called “landing zone”, or the aneurysm extends upwards beyond the renal arteries (suprarenal and thoraco-abdominal aortic aneurysm). They require the provision of fenestrations in the endograft, the use of branched endografts, often custom-made, or the chimney technique [11], so that the blood is allowed to flow through the subsidiary arteries. In absence of published clinical trials, results are promising thanks to the rapid evolution of the technique [11].

EVAR planning requires the quantification of diameters and lengths along the aorta and its subsidiary branches for endograft device sizing. A standard endograft is selected in the majority of cases from a set of off-the-shelf models in catalog. According to Ref. [12], aneurysm measurements are more accurate when performed using a 3D workstation, especially when tortuosity is larger. Furthermore, Kicska et al. state that an automated vessel analysis, in combination with vascular landmark identification, may significantly contribute in reducing the post-processing time.

These 3D measurements are usually based on a combination of a 3D view of the patient-specific anatomy of the aorta and supporting planar reformattings. which include basic orthogonal and oblique sections, Curved Planar Reformattings (CPRs) [10] depicting the whole lumen in a single plane, and sections along the vessel. CPRs are computed from the centerline or medial axis [2,18] of the aorta and its main branches. The challenge during centerline calculation is to obtain a regularized medial curve whose normal sections vary smoothly following the vessel path. Obtaining a segmentation of the aortic tree also provides the possibility of displaying a 3D model of the aorta, usually completed with its 3D centerline, planar reformattings as 3D textures, and visual cues.

Using the centerline as the main reference for stent–graft sizing reduces the parallax error [5]. The standard procedure consists of traversing the centerline along its length using a 3D view or a CPR reformatting, and mapping lengths between points on the centerline and diameters at given cross-sections. Care must be taken with deformations introduced by CPR views on off-centerline structures due to the curvature of the vessels. This is not usually a problem in standard endograft sizing since the aneurysm and adjacent regions are not so prone to deformations, but it is an important issue when designing fenestrations. This may lead, for example, to mistakenly conclude, based only on the curved reformation view, that a renal artery stems more proximally than the opposite [20].

Planning of fenestrated endografts (f-EVAR) is more complicated, requiring the specification of fenestrations parameters, such as height, diameter and angle. The deformations introduced by the deployment process, which tends to straighten the aorta as the endograft is being released with the catheter, add uncertainty to the design. Tools designed specifically for this task are scarce but essential for an accurate planning. Our software, eVida Vascular, tries to fill this gap by providing a specific module for fenestrated endograft planning. There is a lack of clinical evidence on how this deformation process occurs, but according to our experience, using a straight synthetic endograft model for planning could provide a reliable visual cue when planning fenestrations on tortuous aortas. All in all, complex interventions are beginning to be feasible thanks to the availability of advanced 3D EVAR planning tools.

Commercial workstations available to radiologists, usually offer a vascular module, allowing segmentation, centerline extraction and quantification of diameters and lengths with the help of 3D visualizations or planar reformattings (oblique, CPR and sections along the centerline). Some of them have a specialized module for the aorta, allowing to annotate the specific measurements for planning standard, non-fenestrated endografts. Due to the impossibility of thoroughly testing and comparing all these solutions, we describe only some of them in brief according to our knowledge based on information available at the time of writing this article.

General Electric Healthcare (Buckinghamshire, UK) provides advanced visualization and analysis tools for (T)EVAR planning in their workstations, with modules such as VesselIQ Xpress, VVI and Synchro3D. They provide features such as segmentation and centerline extraction of the aorta with bone removal, vessel tracking, 3D models, CPR mode, quantification of diameters and lengths and synchronized C-arm angle visualization. Siemens (Erlangen, Germany) syngo.CT Vascular Analysis provides advanced pre-processing tools, such as bone removal, automatic centerline extraction and anatomical labeling of the main vessels, as well as a dedicated AAA stent planning templates, guiding the user through all the necessary steps for quantification of diameters and lengths from CPR and cross-sectional views. Philips Healthcare's (Best, The Netherlands) IntelliSpace CT Advanced Vessel Analysis Stent Planning provides, in addition to the standard vessel analysis and visualization tools, presets and user-defined options to reduce stent planning time, and reporting capabilities. Vital Images, a subsidiary of Toshiba Medical Systems (Tochigi, Japan) has an Endovascular Stent Planning module (EVSP) within the Vitrea imaging software suite, which includes features such as automatic segmentation of the aorta including thrombus, automatic initialization of measurements, stent–graft worksheets and auto-report for stent sizing. TeraRecon (Foster City, CA, USA), meanwhile, has a suite called iNtuition with a specific module for endovascular planning, incorporating advanced vascular visualization, automatic centerlines and diameter quantification and reporting with stent manufacturer templates. Furthermore, they offer this solution as an internet-based service as part of their iNtuition CLOUD system.

Another set of specialized tools have appeared recently, mainly affordable solutions from small providers oriented to vascular surgeons, with an orientation similar to the one that we propose in this paper with eVida Vascular. EndoSize (Therenva SAS, Rennes, France) provides features such as semi-automatic centerline extraction and automatic diameter calculation (vessel profiling). The application guides the user through required steps like assisted measurements and device selection to finally create a report. Similar features are found in the SOVA.evar (SOVAmed GmbH, Koblenz, Germany) software, an EVAR planning plug-in for OsiriX, and 3mensio Vascular (3mensio Medical Imaging BV, Bilthoven, The Netherlands). Both include complementary CPR views and the possibility to reproduce the C-arm angle. Additionally, 3mensio Vascular provides angular and tortuosity analysis, C-arm simulation and the ability to grow centerlines for small vessels or low-contrast scans, which provides additional robustness, a feature also present in our software. The Aycan OsiriX Pro workstation (aycan Medical Systems, Rochester, NY, USA), also based on OsiriX, provides the ayVessel plugin providing generic vascular image analysis tools, which may be combined with their ayReport plugin with specific AAA sizing report templates.

Within this group, Endosize and 3mensio Vascular provide fenestrated endograft planning in their latest versions. The former allows the definition of the fenestration parameters, namely distance from proximal neck, ostium and vessel diameter and angle, and provides a symbolic representation of the endograft with the designed fenestrations. The latter, estimates auxiliary centerlines from selected ostia of target vessels, from which the fenestration parameters are calculated. In comparison, our solution uses a symbolic straight cylinder as reference for the interactive definition of fenestrations represented as virtual stents in both 2D and 3D views. This seems to represent better the real situation during endograft deployment and stent fixation, where this region of the aorta is straightened to some extent.

Some endograft manufacturers also provide tools to assist with planning and model selection. Envision Zenith Image Review from Cook Medical (Bloomington, IN, USA) provides planning capabilities using 3D views and centerline computation. EVARpro, from Medtronic (Minneapolis, MN, USA), is a solution integrating three different tools: CTeXpress for the remote transfer and storage, 3D Recon for 3D image processing, and finally StentGraftTracker for follow-up. TEVAR Sizing App, from W. L. Gore & Associates, Inc. (Flagstaff, AZ, USA), is an Apple mobile device app that allows to view and select models from their TEVAR endograft catalog, based on the measurements provided by the user (obtained from third-party software).

The design of a tool for 3D image-based endograft sizing for EVAR is based on a preliminary set of functional requirements, dealing mainly with vascular analysis, visualization, and planning capabilities, and a set of non-functional requirements, establishing the criteria for the desired application performance.

Given a CTA scan, the system is designed to assist in patient-specific AAA endograft planning through vascular image analysis steps and interactive workflows. The final resulting output is a report with a set of diameters and lengths required either for selecting an off-the-shelf endograft or for manufacturing a customized one. The system must allow a fast planning in the case of standard, non-fenestrated endografts following a well-established sequence of steps, starting from a user-selected point below the aortic neck. We additionally require supporting the design of complex fenestrated endografts (f-EVAR), allowing to establish the position (height), orientation (clockwise) and size (diameter) of the fenestrations. For fenestrated endografts, our experienced clinical team observed that a symbolic straightened endograft representation is more similar to the actual deployment configuration, where the aorta is straightened by the endograft-catheter set.

The measurement process takes a centerline reference, since it is a suitable vascular descriptor that reduces parallax errors [5]. Diameters are measured automatically at different heights along the centerline, and lengths are measured between two points along the centerline, using a 3D vascular model of the aortic tree, as well as supporting 2D reformatted planes (i.e. centerline cross-sections). The user has always the possibility of correcting the estimated diameters and lengths interactively.

Finally, the system should generate a report with the obtained measurements. Based on the measurements and available devices, an off-the-shelf endograft model may be selected; if no fit is found, manufacturing a custom, patient-specific design (for example, for fenestrated endografts) may be required. This endograft design report may then be forwarded to the device manufacturer, so that the feasibility of manufacturing the requested endograft is verified.

The design of our endograft sizing software takes into account a set of relevant non-functional requirements that may be summarized as follows:
                           
                              •
                              
                                 Accuracy: as a semi-automated vascular image analysis software, the accuracy is described in two aspects:
                                    
                                       –
                                       
                                          Automated analysis: image processing tasks must be precise enough for endograft design based on clinical requirements. These processes include the aortic tree segmentation, centerline extraction, and final diameter and length estimation at chosen points on the centerline.


                                          Endograft choice: precision of the measurements made with the system should be within the reasonable limits for an adequate endograft choice. This is difficulted by: (1) the deformations introduced in the deployment process, both in the stent and the aorta, and (2) the inter-observer variability in the measurements. For validation purposes, endograft choices must agree with those resulting from processing in commercial, equivalent workstations. Such a validation is performed in this paper.


                                 Reproducibility: ideally, different clinicians should reach identical results. In practice, during the vascular image analysis process, some interactive steps such as the selection of seed points for segmentation, may introduce intra- and inter-subject variability which needs to be controlled. This variability is higher during the posterior measurement workflow determining the precise image locations where key measurements are made. These locations correspond to identifiable anatomical landmarks, but may differ slightly from one user to another. However, some flexibility is necessary in order to allow surgeons to apply clinical criteria selecting where to take the measurements. According to Ref. [9], reasonable upper limits for inter-rater variability could be 2mm and 5mm for diameters and lengths, respectively.


                                 Speed: the system should provide interactive response times. Initial vascular image analysis may require more time, since it requires minimal or no user interaction. An upper limit of about 1min is considered to be reasonable for this task. However, the interactive measurement process should be almost immediate, taking less than a second to achieve a fluent interaction. Finally, the sizing workflow must be designed so as to minimize planning time, which is crucial for acceptance of the application.


                                 Automation: a trade-off must exist between user interaction and automation. More automation provide faster planning, and better reproducibility. Interactive steps slow down the analysis processes, but may be required to increase robustness, decrease the complexity of some algorithmic processes, or to provide additional flexibility. Ideally, algorithms would work with fixed parameters for most inputs, requiring no user fine tuning.


                                 Robustness: semi-automatic image analysis algorithms must be robust to the variability of the input CTA scans due to scanner characteristics, image appearance, and patient-specific anatomy. The system must be robust against parameter setting variability, minimizing the effect of wrong parameter values.


                                 Versatility: clinicians must be allowed to modify, if judged appropriate, the outcome of a given process. It is not infrequent that the final decision on the design depends on clinical criteria, or previous experience, i.e. for selecting the most adequate landing zone. Providing different combined interactive and visualization tools allows the clinician to verify the suitability and feasibility of the design.


                                 Ease of use: intuitive visualizations and interactive tools provide the necessary feedback so as to visualize the involved structures and design choices. Ultimately, the system must provide the surgeon with visual evidence that the measurements taken are adequate, reducing the degree of uncertainty in the design.

Vascular image analysis involves obtaining a set of 3D models and geometric and topological descriptors which make possible a straightforward measurement of lengths and diameters.

The diagram in Fig. 1
                      illustrates the vascular image analysis steps in the eVida Vascular application, which are the following:
                        
                           1.
                           
                              Aortic tree lumen segmentation: automated lumen segmentation is difficulted by non-uniform distribution of contrast agent due to the length of the vessels. The algorithm is based on a novel, 3D adaptive, seeded region growing approach. Complementary segmentation strategies have been developed to avoid leakages toward adjacent structures (such as the spine), and to overcome problems in difficult branches not segmented. After reconstruction, a 3D surface model of the aorta lumen covering the aneurysm area and relevant subsidiary arteries is obtained from the 3D region mask.


                              Centerline extraction and regularization: obtains the medial axis of the aorta and its subsidiary branches. It is the basis for most subsequent analysis and quantification processes. A distance-map-based homotopic thinning algorithm is at the core of this task. Continuity-ensuring regularization of the centerline is performed by a filtering process.


                              Vessel graph creation: a vessel graph [18] is required to analyze the topological structure and properties of the extracted vessel tree. Some subsequent operations, such as spurious branch pruning, branch identification or length estimation, are based on graph operations.


                              Diameter and length quantification: these two measurements are performed on the basis of user-selected points on the centerline: the diameter is measured over a centerline cross-section at the specified location, and the length is estimated as the distance between two points along the centerline.

Segmentation of the aortic tree lumen provides the basic elements for subsequent vascular image analysis steps, including centerline computation, and obtention of descriptors of the vascular anatomy. Lumen segmentation in contrast-enhanced images may seem a simple task. However, some difficulties arise when trying to develop a general algorithm. Among these, we can mention non-uniform contrast along the vessel tree, large dataset size involving hundreds of slices, presence of tortuous vessels with varying lengths and diameters, presence of adjacent structures, like the spine, with similar pixel intensities or image noise and artifacts.

Different extraction methods may be considered for vascular structures. For this application, centerline-based methods based on multi-scale differential or integral operators were discarded since analysis of the aortic trunk required very large kernels with poor boundary localization. Active contours and deformable models were also discarded for their computational complexity and complex parameter setting. Region growing using fixed thresholds was also unsuccessful due to the aforementioned contrast inhomogeneity.

Adaptive region-growing algorithms deal with this inhomogeneity by providing adaptive thresholds. The method based on confidence criteria described in Ref. [26] compute the mean and standard deviation of intensity values of all the pixels included in the neighborhood of the seed, introducing the inclusion criterion:


                        
                           
                              (1)
                              
                                 
                                    x
                                    →
                                 
                                 ∈
                                 S
                                 ⇔
                                 I
                                 (
                                 
                                    x
                                    →
                                 
                                 )
                                 ∈
                                 
                                    
                                       
                                          μ
                                          −
                                          k
                                          σ
                                          
                                          ,
                                          
                                          μ
                                          +
                                          k
                                          σ
                                       
                                    
                                 
                                 ,
                              
                           
                        where S is the current segmentation, μ
                        =
                        μ[I(S)] is the mean intensity value of the voxels in the segmented region S, σ
                        =
                        σ[I(S)] is the standard deviation of the intensity values of the already segmented region, and k is a scaling parameter. This approach has two disadvantages. First, we found that the empirical distribution of intensity values of the aorta lumen is asymmetric with respect to the mean or median values. Second, at each iteration, statistics are recomputed for even larger segmented regions, making the algorithm unstable and prone to segmentation leaks.

To overcome these problems, a novel adaptive region-growing approach has been developed. The inclusion criteria, based on lower and upper thresholds for voxel intensities, is re-calculated on the basis of the last B voxels included in the segmentation. This can be expressed as


                        
                           
                              (2)
                              
                                 
                                    x
                                    →
                                 
                                 ∈
                                 S
                                 ⇔
                                 I
                                 (
                                 
                                    x
                                    →
                                 
                                 )
                                 ∈
                                 
                                    
                                       
                                          
                                             μ
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                          (
                                          1
                                          −
                                          k
                                          
                                             
                                                σ
                                                ˜
                                             
                                          
                                          )
                                          
                                          ,
                                          
                                          
                                             μ
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                          (
                                          1
                                          +
                                          k
                                          
                                             
                                                σ
                                                ˜
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                        where μ
                        1/2
                        =
                        μ
                        1/2[I(S)] is the median intensity value of the current segmented region S, and 
                           
                              
                                 σ
                                 ˜
                              
                           
                           =
                           
                              
                                 σ
                                 ˜
                              
                           
                           [
                           I
                           (
                           S
                           )
                           ]
                         is the median absolute deviation (MAD) of the intensities in S. Median-based statistics are more robust against outliers. The scalar parameter k is used to control the expansion around the median value, and the buffer size B is used to control the adaptivity. A smaller buffer size will allow to better adapt to local intensity variations, but will also increase the chances of leaking into adjacent regions. Remaining holes are filled and smoother boundaries obtained by using a set of morphological image operators on the segmented regions, thus improving the overall segmentation result which is shown in Fig. 2
                        .

Two complementary algorithms have been devised for additional robustness. The first is oriented to segment missing branches (under-segmentation) while the second is used to isolate the aortic tree from adjacent structures (over-segmentation) or to enable spurious branch pruning. Missing branches may be a consequence of low contrast or severe artifacts whereas over-segmentation is usually due to intensity similarity with adjacent structures, such as the spine. Missing branches may be segmented in a semi-automatic manner by first selecting a set of points on the target branch which are further interpolated using a B-Spline. From these initial points, approximating a centerline, the adaptive region growing algorithm of Eq. (2) is used, with an additional limitation of minimum and maximum radial distances, based on local diameter estimates. Over-segmentation requires a different approach. First, the whole image is labeled, and the aortic tree main label is identified as the one containing the seed point(s). Then, a series of morphological operations are applied to this region in order to split it into different labels. Labeled regions smaller than a given size threshold are discarded and considered not to be part of the aortic tree.

The objective of the vascular image analysis stage is to obtain a collection of centerlines for estimating quantitative diameter and length measurements, positioning of support planes, such as centerline cross-sections or tangent planes, and symbolic endografts. Compared to other softwares, our application extracts the centerlines of the whole aortic tree. The analysis of centerlines also provides high-level information about the vascular topology, allowing to locate and identify branches, eliminate spurious branches or detect missing ones.

First, an initial voxel-based set of centerlines is obtained by skeletonization via distance-based homotopic thinning [15]. It is important that the source segmentation has no holes, since they would produce topological errors. This raw skeleton cannot be used directly as a reference for planning, due to its noisy nature and the presence of spurious branches and loops caused by the non-tubular local nature at some parts of the aorta and the aneurysm.

In order to enable high-level vascular analysis, such as automatic identification of branches, a vessel graph structure is created from the raw skeleton. Ideally, the vessel graph of the abdominal aorta is a tree, as shown in Fig. 4
                        . However, some vessels may appear wrongly connected in the segmentation due to their proximity (see Fig. 3
                        (a) and (c)). As a consequence, the centerline presents loops and thus, the vessel graph is no longer a tree (see Fig. 3(b) and (d)). This issue arises mainly around the thrombus region.

The algorithm for creating the vessel graph from the original skeleton is illustrated in Fig. 5
                        , it consists of the following steps:


                        
                           
                              1.
                              Label the skeleton image to identify branch-points (C
                                 =2), end-points (C
                                 <2) and bifurcation-points(C
                                 >2) based on their 26-neighborhood connectivity C (see Fig. 5).

Bifurcation and end-points are assigned to nodes on the vessel graph, and their properties, such as image location, stored in a node data structure. A visit counter N
                                 
                                    C
                                  is initialized to their C number.

Iterate through the image to find a bifurcation point or end-point that needs to be visited, i.e. Nc
                                 >0.

Follow all paths from this bifurcation/end-point to the next one, along the corresponding branch, creating edges between corresponding nodes and storing the path information in the edge data structure.

Decrease visit count of visited nodes on this iteration N
                                 
                                    C
                                 
                                 =
                                 N
                                 
                                    C
                                 
                                 −1, and mark the branches also as visited.

Loop through steps 3–5 until all bifurcation and end-points have been visited as necessary Nc
                                 =0.

Cluster adjacent bifurcation points into single bifurcations, creating a single node and eliminating linking edges.

Compute the centroid of bifurcation clusters.

Once the vessel graph is created, spurious branches may be pruned, loops removed and the centerline smoothed. Vessel branches shorter than a minimum branch length are eliminated, which may imply removal of edges and vertices in the vessel graph (see Fig. 6
                        ). On the other hand, graph loops are identified using a breadth-first-search algorithm. Then, the edge that shows the most tortuous centerline in the loop is removed in order to resolve the loop.

Centerline regularization is the final critical step. Noisy centerlines lead to overestimation of the centerline-based length measurements. Furthermore, diameter estimations based on noisy centerline cross-sections are unstable, due to considerable variation in the orientation of these normal planes, which may not intersect the real vessel section. Hence, centerlines need to be smoothed, but keeping at the same time their central nature.

A simple and fast smoothing scheme for regularization based on mean filtering of the centerline point locations was used. The smoothing window size should depend on three factors: (1) the distance between centerline points, (2) the diameter, and (3) expected tortuosity of the target vessels. An excessively large window would render centerlines that are too apart from the real center of the vessel, even outside the lumen. An excessively small window would provide noisy or jagged centerlines. In practice, the most important centerlines for EVAR planning are those corresponding to the aorta and the iliac arteries. The scale of these arteries is similar, and it was empirically found that a smoothing window of 3 point-width is adequate for most studies, assuming that the distance between centerline points is close to the slice thickness, and that this thickness is not too large (≤1mm).

Quantification for endograft planning uses the computed, regularized centerline as reference for diameter and length estimations. Length estimation between two centerline points is straightforward if there are no intermediate branches between the selected points and is performed by accumulating interpolated distances between centerline points. Since the centerline points are already interpolated by using a B-Spline curve model, we simply accumulate distances of linear segments. If a bifurcation is present, then the length estimation involves different centerline segments, and these have to be first identified by using a breadth-first-search graph algorithm. Their corresponding centerline distances are then accumulated to obtain the final length.

Diameter estimation is difficulted due to the sensitivity of the cross-section plane to irregularities in the centerline. In order to overcome this issue, we locally adjust a third-order B-Spline that interpolates neighbor centerline points at the desired location. This allows us to compute the tangent to the centerline in a robust manner, which defines the local section plane. From this section plane, section boundaries are identified by a polar ray-casting strategy, outliers removed and the final diameters obtained (max, min, average).

The eVida Vascular application consists of a full-featured multi-platform DICOM workstation with a specialized module for vascular image analysis and endograft sizing. The different functional modules of the application are described next:
                        
                           •
                           
                              Study browser: a standard DICOM browser module with full PACS connectivity and additional capabilities to load/save the current endovascular planning.


                              Diagnostic module: this module incorporates common tools to a radiology workstation. Although eVida Vascular has been specifically designed for EVAR endograft planning, many of the capabilities of the diagnostic module are part of a core, called eVida Viewer, including also many functions of the Study Browser, that can be reused and expanded for applications other than vascular endograft planning. The workstation features advanced DICOM image exploring capabilities, including advanced 2D/3D viewer layouts, multi-planar reformattings (MPR), volume render, interactive radiology tools, etc.


                              Segmentation module: this module is integrated in the diagnostic module user interface, and allows to perform the segmentation of a contrasted aorta and branches, and computing the corresponding centerlines and 3D model. After this operation, the EVAR planning module is enabled, and corresponding data loaded into it.


                              EVAR planning module: allows to perform the endovascular planning based on a set of 2D/3D visualization tools following three predefined modes of operation or workflows. The result of this module is a complete planning with the necessary measurements for endograft sizing: diameters, lengths and, for fenestrated endografts, position and size of fenestrations.


                              Report module: this module generates a report from the measurements obtained in the EVAR planning module, together with context information and representative screenshots. This may be forwarded to the device manufacturer for endograft selection or custom design.

The segmentation module is integrated in the core diagnostic module, and is accessed through a specialized toolbar in the MPR viewer layout. The segmentation starts by defining a volume of interest and a seed point. Computation of the segmentation then proceeds automatically, and the result is depicted as an overlay on the MPR views. Control parameters are hidden to the user and set to default values found to be valid for most contrast-enhanced CTA datasets.

When an over-segmentation is observed, an eraser tools allows to eliminate leaked regions. On the other hand, when segmentation is incomplete or some branches are missing, the user has the possibility of adding new seeds defining a parametric curve approximately along the vessel centerline. These seeds are used to re-run the segmentation algorithm constrained to a local area around the selected seeds, which allows to include corresponding missing branches.

The EVAR planning module consists of a specialized interface with specific views and interactive tools adequate for endograft sizing. Endograft sizing may be performed by three modes of operation or workflows. This module also includes tools to edit the centerline path interactively, to deal with difficult datasets or complex cases involving large curvatures.

Next, we describe in detail the visualization tools, as well as the workflows.

The planning tool features the generated 3D model of the aorta and corresponding centerlines, as well as the necessary layouts, views and tools to perform the planning, which include combination of 2D/3D views and planar or curved reformattings. Layouts include different views that are synchronized, by depicting the corresponding planes, references or visual cues. The most important views are the following:
                              
                                 •
                                 
                                    3D view: interactive 3D semi-transparent render of the vessel surface and centerlines, together with the possibility of rendering support planes in 3D (axial, coronal, and sagittal cross-sections). Visual cues include labeling of branches. The current position on the centerline is highlighted as a reference for error measurements.


                                    Centerline cross-sections: this is a special reformatting consisting of cross-sections along the centerline. Diameter measurements are displayed in the corresponding planes and may be modified by the user. Other types of visual cues are displayed here, such as axes of fenestrations. Slice thickness may be modified in this view, as well as in the rest of 2D views.


                                    CPR view: a Curved Planar Reformatting (CPR) of the vessels depicts a deformed view of the lumen of the aorta in a single plane along the centerline (see Fig. 7
                                    ). It is used as an alternative to the 3D view for navigating along the centerline. Cross-sections are depicted as horizontal lines in this view. Aortic branches are individually selectable, so that a curved reconstruction can be computed for each branch, allowing a straightened, true-length visualization of the selected stretch. The user has also the possibility of rotating this CPR view to cover a different angle.

Besides, a C-arm view tool has been incorporated so that the C-arm rotations during surgery can be anticipated. The software will store the C-arm rotations selected to obtain the best possible views (e.g. when stents need to be inserted).

As the planning process is carried out, visual hints, such as the diameters at different heights, are displayed as overlays on both 3D and 2D views. Furthermore, the planning includes a virtual stenting tool. This becomes important when sizing fenestrated grafts: the radiologist or vascular surgeon is able to place a straight symbolic endograft as reference and symbolic stents in either view (3D or 2D), while the tool automatically computes and displays the relevant measurement parameters for corresponding fenestrations.

The planning stage consists essentially of measuring diameters and lengths at different relevant points of the aorta in order to be able to determine the most suitable endograft design. The interface offers two assisted planning modes for standard and fenestrated endografts, respectively. Additionally, a free mode is also available to allow the clinician further freedom in the quantification process, for example, in order to deal with complex cases.

In the Standard Workflow (Fig. 8
                           ), the user is guided through the process of performing measurements at the predefined locations: aortic neck (AN), aortic bifurcation (AB), left iliac bifurcation (LIB) and right iliac bifurcation (RIB). This is performed by a step-by-step guided procedure. The user is allowed to navigate through the centerline of the corresponding branch, detected automatically, and identify the corresponding reference location. Diameters are automatically calculated at some locations, such as AN, including other reference diameters as some predefined distances (i.e. at 5, 10 and 15 mm below the AN reference point), in order to take into account the diameter variability in those regions. The user may modify interactively these diameters, depicted as overlays in the corresponding cross-sections. Lengths are automatically calculated and do not require any further interaction. Once a step is completed, the corresponding measurements (average diameters and/or lengths) are computed and included in the reporting table.

In the Fenestrated Workflow (Fig. 9
                           ), the clinician also needs to determine the appropriate position and orientation of each stent relative to the device's main body, defining the corresponding fenestrations on the device fabric. For this purpose, a symbolic endograft (straight cylinder) serves as a visual reference for angle (clock) and position (height) computations. Despite its simplicity, we found that in the absence of a real physical simulation, this represents better the deployment stage during which the aorta is straightened to a great extent. Stents for auxiliary branches, defining fenestrations, may be added for each of the aortic branches. Stents for the celiac trunk (CT), the superior mesenteric (SM) artery, and left and right renal (LR and RR, see Fig. 4) arteries are automatically placed on a supporting plane normal to the symbolic endograft, stemming from the centerline and represented in all 2D and 3D views. A time-clock widget has been added to enable accurate orientation of these stents. The scallop allowing blood flow into the celiac trunk is automatically designed once the aortic neck reference point has been defined.

Finally, the Free Workflow, includes most of the tools used in the two previous workflows, but does not impose any order in the measurement of lengths and diameters and in the provision of fenestrations, allowing additional freedom to the surgeon during the measurement workflow, for example in the management of complex cases.


                           Fig. 10
                            illustrates how the three different modes are interrelated, allowing for user input and performing automatic calculations.

In order to assess the validity and accuracy of the tool, we performed a validation comprising a set of 14 patients requiring standard endografts. We compared the results of our eVida Vascular workstation (eVV), running on a standard PC with 8GB. memory, as compared with the standard method in Donostia University Hospital, performed using the vascular module VesselIQ Xpress from General Electric (GE) running on an HP xw8400 diagnostic workstation, in order to establish the degree of agreement between the two in taking the same set of measurements for a standard endograft design.

@&#EXPERIMENTS@&#

A set of 14 patients were selected retrospectively requiring EVAR with standard endograft sizing. Corresponding CTA datasets were acquired with a GE LightSpeed VCT 64 slice CT scanner at 120 kVp. For each patient, two sizing procedures were performed by two individual raters with each planning tool, eVV and GE. In other words, four sizing procedures were completed for each patient and observer, two of them with the eVV application, and two of them with the GE application.

The following measurements were performed on each patient with each application: (1) diameter distal to lowermost renal artery, corresponding to the aortic neck (D-AN); (2) diameter 15mm below previous landmark (D-AN15); (3 and 4) diameter distal to primitive right iliac (D-RI) and left iliac (D-LI) artery, below the iliac bifurcation; (5 and 6) diameter of right iliac (D-RIB) and left iliac (D-LIB) 10mm above the bifurcation; (7) length from healthy aortic neck to aortic bifurcation (L-AN-AB) and (8 and 9) length from aortic neck to right iliac (L-AN-RIB) and left iliac (L-AN-LIB) bifurcation.

In order to measure the intra-observer variability and agreement with a single tool, we computed, for both eVV and GE tools separately, statistics based on two repeated measurements (diameter or length at a given location) on the same tool made by each observer. We computed the Intraclass Correlation Coefficient (ICC) [6], the Concordance Correlation Coefficient (CCC) [17], the bias using the mean difference, and the upper and lower limits of agreement with a confidence interval of 95%. In order to compare the agreement between both tools, we computed the same statistics, but comparing the measurements performed by each observer on both tools. Since each observer performed the same measurements twice in each patient and tool, these repeated measurements have been treated as individual patients in this work. In order to compare the limits of agreement with a clinical objective, a 2mm limit was established for diameter calculations, so that the percentage of compared measurements lying within that limit could be verified.

Even if some outliers seemed evident after taking the measurements, possibly due to measurements taken at wrong places (transcription errors were checked), we did not remove them from the calculations.

@&#RESULTS@&#

In functional terms, the plannings performed with the GE workstation and eVida Vascular led to the same endograft choice. Tables 1 and 2
                        
                         show the results of the statistics of the repeated measurements computed in the GE workstation and eVV workstation respectively. The tables show the ICC and CCC with corresponding confidence intervals of 95%. In both tables, these coefficients yield values very close to 1.0, meaning a very good intra-class correlation. Mean differences and upper and lower limits of agreement are within reasonable limits on both tools, the eVV tool showing slightly greater differences. This may be due to the additional freedom provided during the measurement stage in the eVV tool. As expected, greater discrepancies are found in the length calculations, being more influenced by outliers. The percentage of diameters within 2mm error was very good in both cases, in general close to or above 95%. In general, diameter changes from one device model to another vary around 3mm, so this is a conservative limit. Regarding length measurements, the difference between one model or another is around 20mm, which can be taken as a reference for length comparisons.


                        Table 3
                         shows the results for the comparison between both tools. Most ICCs yield values close to or above 0.9. Similar values are obtained for the CCCs except for two measurements. We found no special interpretation for these two results, since they correspond to one of the iliac arteries, and its counterpart yields good values, so we may assume they are affected by outliers. Error bias and upper and lower limits of agreement were in general slightly superior, even smaller in some measurements, to the corresponding values in Tables 1 and 2. The percentage of diameters within 2mm error ranged approximately between 75 and 80%. Taking into account the computed limits of agreement, and the presence of outliers, we can conclude that the agreement between both tools is reasonable enough, and that in the majority of situations and in absence of measurement errors, they would provide basically the same endograft choice.


                        Fig. 11
                         shows the graphical results corresponding to Table 3 for all the relevant diameter measurements. A similar conclusion may be drawn for corresponding length measurements (see Fig. 12
                        ). Figures show, for each pair of measurements, one performed with GE and the other with eVV, displayed as dots, the mean error and upper and lower limits of agreement (95% confidence interval). In these figures it is evident that the majority of the measurements are relatively close to the mean error, which is close to zero. Evident outliers, not removed in our analysis, may be seen in these plots outside the corresponding limits of agreement.

@&#DISCUSSION@&#

The eVida Vascular application, provides an agile, flexible, robust and full-featured solution for endograft sizing in EVAR. At the core of the application, a set of vascular image analysis algorithms provides the necessary automation and robustness for this application while allowing user intervention. The segmentation algorithm has been designed in order to be fast an intuitive. Generally, the user only needs to set a single seed point, a task that could be further automated, and no parameter needs to be fine tuned. This is sufficient for the majority of cases of CTA datasets, but additional mechanisms are provided, such as an automatic bone removal, an erasing tool for oversegmented regions and an additional radius-constrained segmentation tool for missing vascular targets. This allows, even in the worst case scenario, to perform a planning based on a set of centerlines obtained from an imperfect segmentation that covers the relevant vessels. In these cases, the obtention of a minimal vascular tree allows the clinicians to perform the endograft planning, even if they need to adjust all the diameters manually in the cross-section planes.

The segmentation is followed by the vascular analysis step. Even if this has a considerable complexity, no input is required from the user, after the necessary robustness and reproducibility have been verified, and the computations are performed relatively fast (in general less than a minute on a standard workstation with minimal computational requirements). Obtaining a set of smooth, accurate centerlines is a crucial step, since it determines the accuracy and stability of diameter and length measurements. The result is a 3D geometrical model obtained from the segmentation, a set of smooth centerlines, and an underlying topological representation in the form of a vessel graph. Again, in case of incorrect centerline definition, user interaction allows to rectify the automated results. This, together with the source imaging data, provides all the relevant information for the endograft sizing and choice process.

Once the segmentation and vascular analysis steps have been completed, the EVAR endograft planning can be performed. The planning views have been designed so that, at any moment, current positioning is known both in 2D or in 3D, establishing the centerline as the main reference for navigation and measurement, thus reducing possible parallax errors.

The proposed endograft design workflow modes provide the required tools for each type of planning according to the characteristics of the endograft and intended use:
                        
                           •
                           The Standard Workflow is designed for standard off-the-shelf endografts, covering approximately 90% of the cases. An agile workflow has been designed for this task, intuitive enough for the majority of vascular surgeons, following a step-by-step guided sizing procedure. The result is that a complete planning can be performed for a standard case without complications in about 3min, with only minimal training.

The Fenestrated Workflow, covers some of the features of the Standard, but incorporates the design of fenestrations. This will be used only by specialized units, such as our team at Donostia University Hospital, a reference unit for endovascular planning in the North of Spain. These users will be able to perform and deploy custom designs with fenestrations. In any case, the same philosophy of intuitiveness and rapid workflow is maintained. The design of fenestrations by means of a combination of a symbolic endograft and virtual stents is unique to this application. Due to the straightening of the abdominal aorta during the deployment process, the doctors in our team find it more reliable for the design of fenestrations, as compared with designs based on curved centerlines only. This needs to be validated by further studies, but there is a lack of evidence and consensus for this kind of interventions.

The Free Workflow is provided for those users that require a full degree of freedom, because they do not want to be constrained to the standard workflow, or because they need to analyze complex cases that have not been foreseen.

Most algorithm complexity has been hidden after their robustness and reproducibility have been verified. Thus, the workflow has been made more intuitive and versatile, with only minimal user input. A trade-off between automation and user-control has been followed for the user interface design. The user has extensive control over the results, having the possibility to discard the outputs of any of the automatic computational processes involved. A visual feedback is always provided both on the results and interactive actions performed, allowing to easily assess the suitability of the clinical decisions. Ultimately, the system provides the surgeon with visual evidence that the measurements taken are adequate, reducing the degree of uncertainty in the design.

Regarding the experiments performed, we can conclude that there is a good agreement between the two tested tools. In a standard, non-fenestrated case, they would result basically in the same endograft choice, since most of the measurement differences both for diameter and lengths would lie in the range where an identical endograft model size would be selected. In the corresponding calculations, no outliers were removed, even if we found some occasional measurements that were evidently wrong, a fact that is proven by the differences observed using the same tool twice by each observer. Removal of evident outliers would provide even better agreement between the tools. Apart from this, it is very difficult to say which tool is better for planning, since this should be expressed in terms of clinical endpoints, possibly requiring a specific clinical trial. We did not perform comparisons for fenestrated endografts, since they are special or custom designs, and there is no clinical evidence on what should be the limits of corresponding measurements.

@&#CONCLUSIONS AND FUTURE WORK@&#

We have developed a novel 3D EVAR planning tool, eVida Vascular, based on advanced vascular analysis and visualization of the aortic tree. A rapid workflow is provided by a combination of automatic image analysis tools with an interactive and easy-to-follow step-by-step interface. By using complementary and intuitive 2D and 3D vascular visualization and interaction tools, it provides the necessary feedback to the clinicians of the current planning, reducing the degree of uncertainty of the design. The user is provided with the ability of modifying the automatic calculations at any moment, providing additional control in the design.

The system is able to provide a fast, intuitive and accurate measurement of design parameters (diameters and lengths) for most standard endograft devices. It also provides the ability to manage complex cases such as those requiring the provision of fenestrated endografts, a feature not present in the majority of EVAR planning softwares. Planning of such fenestrated endografts is performed in a novel manner, with the help of a set of symbolic endograft and stents. Further freedom in the design is obtained through a free workflow mode, allowing to perform diameter and length quantification without any predefined sequence.

A validation of the tool establishing the degree of agreement with a commercial solution for standard endograft sizing has been performed. Results indicate that the tool is valid for clinical practice, showing an adequate degree of agreement between the measurements obtained by both tools, and leading to the same endograft designs, taking into account the measurement tolerance in design parameters (diameters and lengths) used to select one or another model.

Future work includes the endograft placement simulation with curved and deformable virtual stent-graft devices, and the extension of the system for planning thoracic (TAA), thoraco-abdominal aortic aneurysms (TAAA) and aortic dissections (TAD). We plan to perform a long-term clinical study in order to assess the improvements in the outcomes of interventions using this type of advanced planning, especially for fenestrated endografts where there is a lack of clinical evidence. This would validate the hypothesis that many of the negative outcomes of current EVAR practice may be due to an inadequate planning and sizing, and that the technique may be further improved by the routine use of tools such as the one proposed in this work.

The authors declare that they have no conflicts of interest.

@&#ACKNOWLEDGMENTS@&#

This development was funded by the companies eMedica S.L. and Teccon S.L., with the co-funding from the research project named “DISTANCE” (file reference numbers IG-2011/00482, IG-2012/00262, IG-2013/01008) under the INTEK-GAITEK Support Program for the Development of New Products of the Government of the Basque Country (Spain).

@&#REFERENCES@&#

